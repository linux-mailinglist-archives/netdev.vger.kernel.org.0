Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 5608448B353
	for <lists+netdev@lfdr.de>; Tue, 11 Jan 2022 18:16:46 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1344302AbiAKRQc (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Tue, 11 Jan 2022 12:16:32 -0500
Received: from mail-bn7nam10on2045.outbound.protection.outlook.com ([40.107.92.45]:52705
        "EHLO NAM10-BN7-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1343989AbiAKRPq (ORCPT <rfc822;netdev@vger.kernel.org>);
        Tue, 11 Jan 2022 12:15:46 -0500
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Jq9reMzrJrPJWi0NLvn8lPJqxzt7xr9jDkXsXnBK/Uq2VL8KHIYDIZgTSDVnWGKj1njy6i/d+QGVr2PfUZ+1U689c1XzFXcJqPKRp1x1/655cdTQORepq3WgTL+qtICQDzBMzt4Z2FuCx3ezR3D8aQfq2dlsO1U8Qg2kzqM4q1X1mVqlxNzZJgAxmdMgDKbChNPkVug1m5OJEky97Ii8kVzSpW9MWKk+tYC8cbvOxzvAM2wZuzz+lGvAJvJwX+I5FTdoT1stb69Za4hehZdNA4mlr5zyKpnY+FvP4Ab1KVTQ1dVmsOCGZH4S64zIv7jSkyVtxwwpYE9bZA9ZBDmLzA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=X1cR2BtYV8qIgaXe/OsSh91spBngEHgNdC/46S3ZZms=;
 b=OOSwhb3yOqclMSI4cY5S61nMhxCG9OhQqK9FdUPNJmz3RjsVTkBT99vwSXKg2wnx3K+ks2n6d6I0SQzIOr0fkRT1rluVLkmd9/Ogu+IWCVVzv2z2x+H+XCXpcU4jefLF2U2oSPirPIZ5I52I2L+JRmaZwrWXgnsngDLevzLdAlOo16rAV/twjtFkUtIm4UMe7Qa9IosyZlofqZ0yDwX5v8DFaO+3uJJoRsBfHoFzsisiFtcrNRqHt7ezWSmzae2bbTeactKWTZmp6auQ7LQ3Cf1wNjdEpcqq9gOPWcD+AshWGacz8Y55dbv7wrArLzPWg5AHF8fhGp1Nwh4nSmyMWQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=X1cR2BtYV8qIgaXe/OsSh91spBngEHgNdC/46S3ZZms=;
 b=qKK3Q07TeVKJsciHlLEzxFl5O1FEqSuJKMUN6l7nWyCX5/P/rDkSqT862xb0/KoNgfUkBBernuOkg+A1+O8oPk3sVQRmkeJT7nv3SmnJyxMK+TyHrj0cuWQfgLCo6SdispB+sOQHrklMkOi+S1mHS5p72nCwQvz9YkDERodS274=
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=silabs.com;
Received: from PH0PR11MB5657.namprd11.prod.outlook.com (2603:10b6:510:ee::19)
 by PH0PR11MB5609.namprd11.prod.outlook.com (2603:10b6:510:e0::24) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4867.9; Tue, 11 Jan
 2022 17:15:20 +0000
Received: from PH0PR11MB5657.namprd11.prod.outlook.com
 ([fe80::d031:da9e:71a:73e4]) by PH0PR11MB5657.namprd11.prod.outlook.com
 ([fe80::d031:da9e:71a:73e4%6]) with mapi id 15.20.4867.012; Tue, 11 Jan 2022
 17:15:20 +0000
From:   Jerome Pouiller <Jerome.Pouiller@silabs.com>
To:     linux-wireless@vger.kernel.org, netdev@vger.kernel.org,
        Kalle Valo <kvalo@codeaurora.org>
Cc:     devel@driverdev.osuosl.org, linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        "David S . Miller" <davem@davemloft.net>,
        devicetree@vger.kernel.org, Rob Herring <robh+dt@kernel.org>,
        linux-mmc@vger.kernel.org,
        =?UTF-8?q?Pali=20Roh=C3=A1r?= <pali@kernel.org>,
        Ulf Hansson <ulf.hansson@linaro.org>,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH v9 13/24] wfx: add hif_tx*.c/hif_tx*.h
Date:   Tue, 11 Jan 2022 18:14:13 +0100
Message-Id: <20220111171424.862764-14-Jerome.Pouiller@silabs.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20220111171424.862764-1-Jerome.Pouiller@silabs.com>
References: <20220111171424.862764-1-Jerome.Pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-ClientProxiedBy: SN1PR12CA0099.namprd12.prod.outlook.com
 (2603:10b6:802:21::34) To PH0PR11MB5657.namprd11.prod.outlook.com
 (2603:10b6:510:ee::19)
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: f25653c3-31b7-4b8e-c869-08d9d525f1e5
X-MS-TrafficTypeDiagnostic: PH0PR11MB5609:EE_
X-Microsoft-Antispam-PRVS: <PH0PR11MB5609D4BC5EE3EF7665958FFB93519@PH0PR11MB5609.namprd11.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:21;
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: ULfO4AdT/+UVYshoac8ySCrunRNnD+fiUuO9nWqDxNNTwW9al6+ah2yjOJVnAiDwwAZwVaLWLH9x804Ouo8M3JWD91sL0y9f5VkAQFj9R58CQVCJ5FfzReRR2kHN6YoslrQKcYyH0P21J2p3TbdEMZoriwFg/f4ydhOasTg/AgcposeO/pHuF7wFeyNxdha90d3bMewk3ogfm69jqgPPGdkxj2Tz0f36tcx9tfKvr9z3DTlpywKGQIOrNnxERPml6QocCaRFdw3oi2O44dRTYqL1rYV1WrgdmALMh2Sa2xaQmY6tAaxOsXVOVoVQi2yHMGhLpgHLvy00Fv2coqsuLfXhvckxvARYbfdtZ3D5ZRUYydcYGWlNj0+wkMdcUHl305TFs6jYB2dOvkxBmqqzAkSdaifx2E8qOh1NmX7pMIGXD09YwM5QU3zKc7lDx2+FVSEMw4KqeNfPWltUOIC5XE1W4D0W2lyUONQWfK6gU1+X4+ZJ5MkNLjnxaILdwjR5r6x0fzyY99Gc2jgMhr+In8euDcCUSynIqpFqyO98gtUhhGJmFCUbt8xonUNUazNapeR+ckuLU9vrxfUeHpCWgdxzaCTgc9PQwtkeqpTKxMPYpzV26vT/ZPLBf8S9B+DPNIetCUEg1U1GGlxjbHr/Hw==
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:PH0PR11MB5657.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(366004)(5660300002)(8676002)(36756003)(38100700002)(186003)(7416002)(66476007)(54906003)(6486002)(6916009)(6512007)(4326008)(508600001)(107886003)(66946007)(6666004)(2616005)(1076003)(8936002)(66556008)(86362001)(2906002)(6506007)(52116002)(66574015)(316002)(83380400001)(30864003);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: =?utf-8?B?NEdOQk1ialBzdmZKUDZPYkFZejY0VzhxVHREdkthM0FKYXJmY3JNVVpROExx?=
 =?utf-8?B?U2dsUllGQTRIY1ovZGpxcVlRK0pWQTAvVzN1R0NVMEQrOHlFbUlIQUoxbUZY?=
 =?utf-8?B?cHBDa2ZsTldJYWk0TTk1WXNxaVpCOFRxZWovRGM1eEIxUFpEMUdNUEpNR3g3?=
 =?utf-8?B?aUhQSnBpRG9LRkRBSG4yWlNmVGRUN2MzTlY2bFpIVUkrSnJKZGZnajJ6N1dQ?=
 =?utf-8?B?Z1p0Q3VhSnU0Z3NKcTh0L2dhd1doYWZMaE1ONDg3ZTJRM1NUM24xRXE5QUo2?=
 =?utf-8?B?aDQ0YTU2N2lROTZTS0RQL0VOWUNVWXhzM2V5QzNkd0ZRaFkrT01QUjJBSTdy?=
 =?utf-8?B?ZkpOMS9udnNhK2FwSXErRjdadWg1WHI4TjBxc3p1YjAraHNDRjhOR3IrcGw5?=
 =?utf-8?B?RXZoWklGWDdSWFRZcmZIZGNKSGdGQmJuRm95MFp2b2N4RFlPaEt4Y0VuVnlI?=
 =?utf-8?B?eFZtTFhoYmh0eXBTMitoNVB2aHh2ZWI4N09yYzcrWDhrQjlnWmFWM1NQRGhZ?=
 =?utf-8?B?NFBRQ0JBVk54elgzNC9pcEZ2V0xkV1l4MGZHM2xLZ3VSZ0xxQUdwV1REdlQz?=
 =?utf-8?B?eUVkbDk5dTBQRUxtSnpEM085WCtSS2pjSncxU1hxT0tUL1RLeUxhTldDUUJy?=
 =?utf-8?B?Rm1pV3d5bVZSNDdjR3pLd3EzanpTRTlWT3BseXF1dFpwMk1JNWZhUlVjdUor?=
 =?utf-8?B?VGtsNE1FbUdGSTU3eU9HbGpEVTBXRTRXSHVNd2haeGRKZmQzeDdmemVMTmJF?=
 =?utf-8?B?VmhBem9ZRHp6Z0tJVTVZTE1EZ0hqTlFzVy9qemFScDhjK3JjWG43MDV2dzc2?=
 =?utf-8?B?Z0JIWG9xS3FuTER0dWowVjNaVE4wZTVzRVhVcUlwWnJzeGZ1b09kS1VobWs0?=
 =?utf-8?B?d1N4RXlkeHhORkZ0NVYrNkpmWEQ4dVd0Q25CNHdvNGx4Q1ZqUzl2dy9xSDV1?=
 =?utf-8?B?LzdjME5Ra210ck5LajBVaGQ3dGEzOXlpZkovTFVsd0VHUTF5M29SYno2UXYv?=
 =?utf-8?B?Rm0zeENUWDc0ak1qbWRxQXBVZThxMHJjVDk4dk0xNTZyaVJoaXdMM1ptd2Zw?=
 =?utf-8?B?cjhZTnMyKzRYYXJiOHZMTFk1N29xd1lXLzhEZlFiSVArc1J3blpQQTIyR1ZC?=
 =?utf-8?B?aGNoS251UDRhK3lHbUcxMExIWC9XWEVlRzBxYjlySmp2ckdsK1FIL21kUmNa?=
 =?utf-8?B?Y0ZIVHp1ZGl6eGhjbkY5SHU0dHRpZFBucUJzTHdBOWw2aHZoZEN3RUpucUhq?=
 =?utf-8?B?bXl5Uk9KUzB6SE9aMHQ0dVhhak1hYnRCeTA5SGhjZnNhUUxyeDZzYTNuMDhu?=
 =?utf-8?B?SjhMVjMxdGowNGVhQTBRMXo0UytLVHJteW1VWEZ5bTRHdVAwOVlaMlVHak1i?=
 =?utf-8?B?RkNuSXNVYmtHcDk2bURRdjRMVFZaY3pXaHpJVWtWbHdOQkpqdFZKVjlpUTFT?=
 =?utf-8?B?YURQMXBBUll2WWxxSUhDVmxJbHZwQVVadUhZeUZteVloNHl3VjBWL1gxYVB4?=
 =?utf-8?B?QlFxMlY5ZWRwaUFWTzIzL2hMSzg0ZGJZd1RRMjNyZVVWU3Fscm1RVmFXU1A5?=
 =?utf-8?B?MDZTOE05aXdmTHlHWlJ4YThwZHpZbDBacWgrV0t6RjhtMHRaMk5sZlc2ZXBz?=
 =?utf-8?B?dkZhSGowenBFekM5Vmp2ZkpnSlUwSk9UeDZ2eDM2M0JsM3Vxa3lXWThFQ2xZ?=
 =?utf-8?B?K04xUzRvR3FyVDBCT0NnMDNMZnpYSGlWZVdkWVNqZWY5aWlNOFFXcmhTMEdT?=
 =?utf-8?B?eU5UMk94TUhlNGo5Y2dkekhTYW42Y1ZKQlVFRSs0NE1QTHQwNHNEODEvUm5V?=
 =?utf-8?B?aXZsKzUvRXZSQXhNMEI2M3luQTlsK1l6cDdLTHh6eXRUMVZGN2k1Znova1o5?=
 =?utf-8?B?WGpEemZOOGFoT0tJTDI0NEdnUWNTemJaRkw3WHE2Y084UmE2QjYySE9hM05B?=
 =?utf-8?B?RHBKRGxoamxqY2F2cjlQL1gybEFLbEoxaWF3aGorUXRteTkxRnlIMzF4cjNB?=
 =?utf-8?B?d0xrZVhZVVNDUUliWkhOMW0zWDZVNS9kczh6a09BYU5PR0ZmWnZqRHJnRzNt?=
 =?utf-8?B?VWwzNnpBbnI2T0NsblZLTkxKTzBuYlExb2djcnBUMjg1WEdyajhudTRacXUx?=
 =?utf-8?B?bUdWaXpheVZuYjJrcHdHSlVobzU2ZFZUazVLb2tSenZkOVdNUVdvUWhUTWgv?=
 =?utf-8?B?Wkt5SStMUStzYW5rMlVlZTcyNHl4YUhzWmRvOVoxb25mKzlXNERzS3lSNjg0?=
 =?utf-8?Q?95EIDQoLIIa8gE7yfNiRLzooSgHJX0UDEWhRyxUNvM=3D?=
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: f25653c3-31b7-4b8e-c869-08d9d525f1e5
X-MS-Exchange-CrossTenant-AuthSource: PH0PR11MB5657.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 11 Jan 2022 17:15:20.1947
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: Sg47NqexAA6kHHsn5vJz1ZZ1CYqea7Bku9H0tT0iX3M1l1ZVFfmlVapeHvFgKcRbyk3UmxrBlj7acQ3YpF4WzQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PH0PR11MB5609
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKU2ln
bmVkLW9mZi1ieTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29t
PgotLS0KIGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvaGlmX3R4LmMgICAgIHwgNDky
ICsrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvaGlm
X3R4LmggICAgIHwgIDYxICsrKwogZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9oaWZf
dHhfbWliLmMgfCAzMDggKysrKysrKysrKysrCiBkcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMv
d2Z4L2hpZl90eF9taWIuaCB8ICA0OCArKwogNCBmaWxlcyBjaGFuZ2VkLCA5MDkgaW5zZXJ0aW9u
cygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93Zngv
aGlmX3R4LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMv
d2Z4L2hpZl90eC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2ls
YWJzL3dmeC9oaWZfdHhfbWliLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC93aXJl
bGVzcy9zaWxhYnMvd2Z4L2hpZl90eF9taWIuaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3dp
cmVsZXNzL3NpbGFicy93ZngvaGlmX3R4LmMgYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMv
d2Z4L2hpZl90eC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNDBi
OTgwOGViNTExCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJz
L3dmeC9oaWZfdHguYwpAQCAtMCwwICsxLDQ5MiBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSBob3N0LXRvLWNo
aXAgY29tbWFuZHMgKGFrYSByZXF1ZXN0L2NvbmZpcm1hdGlvbikgb2YgdGhlCisgKiBoYXJkd2Fy
ZSBBUEkuCisgKgorICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9y
aWVzLCBJbmMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCisgKi8KKyNpbmNs
dWRlIDxsaW51eC9ldGhlcmRldmljZS5oPgorCisjaW5jbHVkZSAiaGlmX3R4LmgiCisjaW5jbHVk
ZSAid2Z4LmgiCisjaW5jbHVkZSAiYmguaCIKKyNpbmNsdWRlICJod2lvLmgiCisjaW5jbHVkZSAi
ZGVidWcuaCIKKyNpbmNsdWRlICJzdGEuaCIKKwordm9pZCB3ZnhfaW5pdF9oaWZfY21kKHN0cnVj
dCB3ZnhfaGlmX2NtZCAqaGlmX2NtZCkKK3sKKwlpbml0X2NvbXBsZXRpb24oJmhpZl9jbWQtPnJl
YWR5KTsKKwlpbml0X2NvbXBsZXRpb24oJmhpZl9jbWQtPmRvbmUpOworCW11dGV4X2luaXQoJmhp
Zl9jbWQtPmxvY2spOworfQorCitzdGF0aWMgdm9pZCB3ZnhfZmlsbF9oZWFkZXIoc3RydWN0IHdm
eF9oaWZfbXNnICpoaWYsIGludCBpZl9pZCwgdW5zaWduZWQgaW50IGNtZCwgc2l6ZV90IHNpemUp
Cit7CisJaWYgKGlmX2lkID09IC0xKQorCQlpZl9pZCA9IDI7CisKKwlXQVJOKGNtZCA+IDB4M2Ys
ICJpbnZhbGlkIGhhcmR3YXJlIGNvbW1hbmQgJSMuMngiLCBjbWQpOworCVdBUk4oc2l6ZSA+IDB4
RkZGLCAicmVxdWVzdGVkIGJ1ZmZlciBpcyB0b28gbGFyZ2U6ICV6dSBieXRlcyIsIHNpemUpOwor
CVdBUk4oaWZfaWQgPiAweDMsICJpbnZhbGlkIGludGVyZmFjZSBJRCAlZCIsIGlmX2lkKTsKKwor
CWhpZi0+bGVuID0gY3B1X3RvX2xlMTYoc2l6ZSArIDQpOworCWhpZi0+aWQgPSBjbWQ7CisJaGlm
LT5pbnRlcmZhY2UgPSBpZl9pZDsKK30KKworc3RhdGljIHZvaWQgKndmeF9hbGxvY19oaWYoc2l6
ZV90IGJvZHlfbGVuLCBzdHJ1Y3Qgd2Z4X2hpZl9tc2cgKipoaWYpCit7CisJKmhpZiA9IGt6YWxs
b2Moc2l6ZW9mKCpoaWYpICsgYm9keV9sZW4sIEdGUF9LRVJORUwpOworCWlmICgqaGlmKQorCQly
ZXR1cm4gKCpoaWYpLT5ib2R5OworCWVsc2UKKwkJcmV0dXJuIE5VTEw7Cit9CisKK2ludCB3Znhf
Y21kX3NlbmQoc3RydWN0IHdmeF9kZXYgKndkZXYsIHN0cnVjdCB3ZnhfaGlmX21zZyAqcmVxdWVz
dCwKKwkJIHZvaWQgKnJlcGx5LCBzaXplX3QgcmVwbHlfbGVuLCBib29sIG5vX3JlcGx5KQorewor
CWNvbnN0IGNoYXIgKm1pYl9uYW1lID0gIiI7CisJY29uc3QgY2hhciAqbWliX3NlcCA9ICIiOwor
CWludCBjbWQgPSByZXF1ZXN0LT5pZDsKKwlpbnQgdmlmID0gcmVxdWVzdC0+aW50ZXJmYWNlOwor
CWludCByZXQ7CisKKwkvKiBEbyBub3Qgd2FpdCBmb3IgYW55IHJlcGx5IGlmIGNoaXAgaXMgZnJv
emVuICovCisJaWYgKHdkZXYtPmNoaXBfZnJvemVuKQorCQlyZXR1cm4gLUVUSU1FRE9VVDsKKwor
CW11dGV4X2xvY2soJndkZXYtPmhpZl9jbWQubG9jayk7CisJV0FSTih3ZGV2LT5oaWZfY21kLmJ1
Zl9zZW5kLCAiZGF0YSBsb2NraW5nIGVycm9yIik7CisKKwkvKiBOb3RlOiBjYWxsIHRvIGNvbXBs
ZXRlKCkgYmVsb3cgaGFzIGFuIGltcGxpY2l0IG1lbW9yeSBiYXJyaWVyIHRoYXQgaG9wZWZ1bGx5
IHByb3RlY3QKKwkgKiBidWZfc2VuZAorCSAqLworCXdkZXYtPmhpZl9jbWQuYnVmX3NlbmQgPSBy
ZXF1ZXN0OworCXdkZXYtPmhpZl9jbWQuYnVmX3JlY3YgPSByZXBseTsKKwl3ZGV2LT5oaWZfY21k
Lmxlbl9yZWN2ID0gcmVwbHlfbGVuOworCWNvbXBsZXRlKCZ3ZGV2LT5oaWZfY21kLnJlYWR5KTsK
KworCXdmeF9iaF9yZXF1ZXN0X3R4KHdkZXYpOworCisJaWYgKG5vX3JlcGx5KSB7CisJCS8qIENo
aXAgd29uJ3QgcmVwbHkuIEdpdmUgZW5vdWdoIHRpbWUgdG8gdGhlIHdxIHRvIHNlbmQgdGhlIGJ1
ZmZlci4gKi8KKwkJbXNsZWVwKDEwMCk7CisJCXdkZXYtPmhpZl9jbWQuYnVmX3NlbmQgPSBOVUxM
OworCQltdXRleF91bmxvY2soJndkZXYtPmhpZl9jbWQubG9jayk7CisJCXJldHVybiAwOworCX0K
KworCWlmICh3ZGV2LT5wb2xsX2lycSkKKwkJd2Z4X2JoX3BvbGxfaXJxKHdkZXYpOworCisJcmV0
ID0gd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ3ZGV2LT5oaWZfY21kLmRvbmUsIDEgKiBI
Wik7CisJaWYgKCFyZXQpIHsKKwkJZGV2X2Vycih3ZGV2LT5kZXYsICJjaGlwIGlzIGFibm9ybWFs
bHkgbG9uZyB0byBhbnN3ZXJcbiIpOworCQlyZWluaXRfY29tcGxldGlvbigmd2Rldi0+aGlmX2Nt
ZC5yZWFkeSk7CisJCXJldCA9IHdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmd2Rldi0+aGlm
X2NtZC5kb25lLCAzICogSFopOworCX0KKwlpZiAoIXJldCkgeworCQlkZXZfZXJyKHdkZXYtPmRl
diwgImNoaXAgZGlkIG5vdCBhbnN3ZXJcbiIpOworCQl3ZnhfcGVuZGluZ19kdW1wX29sZF9mcmFt
ZXMod2RldiwgMzAwMCk7CisJCXdkZXYtPmNoaXBfZnJvemVuID0gdHJ1ZTsKKwkJcmVpbml0X2Nv
bXBsZXRpb24oJndkZXYtPmhpZl9jbWQuZG9uZSk7CisJCXJldCA9IC1FVElNRURPVVQ7CisJfSBl
bHNlIHsKKwkJcmV0ID0gd2Rldi0+aGlmX2NtZC5yZXQ7CisJfQorCisJd2Rldi0+aGlmX2NtZC5i
dWZfc2VuZCA9IE5VTEw7CisJbXV0ZXhfdW5sb2NrKCZ3ZGV2LT5oaWZfY21kLmxvY2spOworCisJ
aWYgKHJldCAmJgorCSAgICAoY21kID09IEhJRl9SRVFfSURfUkVBRF9NSUIgfHwgY21kID09IEhJ
Rl9SRVFfSURfV1JJVEVfTUlCKSkgeworCQltaWJfbmFtZSA9IHdmeF9nZXRfbWliX25hbWUoKCh1
MTYgKilyZXF1ZXN0KVsyXSk7CisJCW1pYl9zZXAgPSAiLyI7CisJfQorCWlmIChyZXQgPCAwKQor
CQlkZXZfZXJyKHdkZXYtPmRldiwgImhhcmR3YXJlIHJlcXVlc3QgJXMlcyVzICglIy4yeCkgb24g
dmlmICVkIHJldHVybmVkIGVycm9yICVkXG4iLAorCQkJd2Z4X2dldF9oaWZfbmFtZShjbWQpLCBt
aWJfc2VwLCBtaWJfbmFtZSwgY21kLCB2aWYsIHJldCk7CisJaWYgKHJldCA+IDApCisJCWRldl93
YXJuKHdkZXYtPmRldiwgImhhcmR3YXJlIHJlcXVlc3QgJXMlcyVzICglIy4yeCkgb24gdmlmICVk
IHJldHVybmVkIHN0YXR1cyAlZFxuIiwKKwkJCSB3ZnhfZ2V0X2hpZl9uYW1lKGNtZCksIG1pYl9z
ZXAsIG1pYl9uYW1lLCBjbWQsIHZpZiwgcmV0KTsKKworCXJldHVybiByZXQ7Cit9CisKKy8qIFRo
aXMgZnVuY3Rpb24gaXMgc3BlY2lhbC4gQWZ0ZXIgSElGX1JFUV9JRF9TSFVUX0RPV04sIGNoaXAg
d29uJ3QgcmVwbHkgdG8gYW55IHJlcXVlc3QgYW55bW9yZS4KKyAqIE9idmlvdXNseSwgb25seSBj
YWxsIHRoaXMgZnVuY3Rpb24gZHVyaW5nIGRldmljZSB1bnJlZ2lzdGVyLgorICovCitpbnQgd2Z4
X2hpZl9zaHV0ZG93bihzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKK3sKKwlpbnQgcmV0OworCXN0cnVj
dCB3ZnhfaGlmX21zZyAqaGlmOworCisJd2Z4X2FsbG9jX2hpZigwLCAmaGlmKTsKKwlpZiAoIWhp
ZikKKwkJcmV0dXJuIC1FTk9NRU07CisJd2Z4X2ZpbGxfaGVhZGVyKGhpZiwgLTEsIEhJRl9SRVFf
SURfU0hVVF9ET1dOLCAwKTsKKwlyZXQgPSB3ZnhfY21kX3NlbmQod2RldiwgaGlmLCBOVUxMLCAw
LCB0cnVlKTsKKwlpZiAod2Rldi0+cGRhdGEuZ3Bpb193YWtldXApCisJCWdwaW9kX3NldF92YWx1
ZSh3ZGV2LT5wZGF0YS5ncGlvX3dha2V1cCwgMCk7CisJZWxzZQorCQl3ZnhfY29udHJvbF9yZWdf
d3JpdGUod2RldiwgMCk7CisJa2ZyZWUoaGlmKTsKKwlyZXR1cm4gcmV0OworfQorCitpbnQgd2Z4
X2hpZl9jb25maWd1cmF0aW9uKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCB1OCAqY29uZiwg
c2l6ZV90IGxlbikKK3sKKwlpbnQgcmV0OworCXNpemVfdCBidWZfbGVuID0gc2l6ZW9mKHN0cnVj
dCB3ZnhfaGlmX3JlcV9jb25maWd1cmF0aW9uKSArIGxlbjsKKwlzdHJ1Y3Qgd2Z4X2hpZl9tc2cg
KmhpZjsKKwlzdHJ1Y3Qgd2Z4X2hpZl9yZXFfY29uZmlndXJhdGlvbiAqYm9keSA9IHdmeF9hbGxv
Y19oaWYoYnVmX2xlbiwgJmhpZik7CisKKwlpZiAoIWhpZikKKwkJcmV0dXJuIC1FTk9NRU07CisJ
Ym9keS0+bGVuZ3RoID0gY3B1X3RvX2xlMTYobGVuKTsKKwltZW1jcHkoYm9keS0+cGRzX2RhdGEs
IGNvbmYsIGxlbik7CisJd2Z4X2ZpbGxfaGVhZGVyKGhpZiwgLTEsIEhJRl9SRVFfSURfQ09ORklH
VVJBVElPTiwgYnVmX2xlbik7CisJcmV0ID0gd2Z4X2NtZF9zZW5kKHdkZXYsIGhpZiwgTlVMTCwg
MCwgZmFsc2UpOworCWtmcmVlKGhpZik7CisJcmV0dXJuIHJldDsKK30KKworaW50IHdmeF9oaWZf
cmVzZXQoc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgcmVzZXRfc3RhdCkKK3sKKwlpbnQgcmV0
OworCXN0cnVjdCB3ZnhfaGlmX21zZyAqaGlmOworCXN0cnVjdCB3ZnhfaGlmX3JlcV9yZXNldCAq
Ym9keSA9IHdmeF9hbGxvY19oaWYoc2l6ZW9mKCpib2R5KSwgJmhpZik7CisKKwlpZiAoIWhpZikK
KwkJcmV0dXJuIC1FTk9NRU07CisJYm9keS0+cmVzZXRfc3RhdCA9IHJlc2V0X3N0YXQ7CisJd2Z4
X2ZpbGxfaGVhZGVyKGhpZiwgd3ZpZi0+aWQsIEhJRl9SRVFfSURfUkVTRVQsIHNpemVvZigqYm9k
eSkpOworCXJldCA9IHdmeF9jbWRfc2VuZCh3dmlmLT53ZGV2LCBoaWYsIE5VTEwsIDAsIGZhbHNl
KTsKKwlrZnJlZShoaWYpOworCXJldHVybiByZXQ7Cit9CisKK2ludCB3ZnhfaGlmX3JlYWRfbWli
KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgdmlmX2lkLCB1MTYgbWliX2lkLAorCQkgICAgIHZv
aWQgKnZhbCwgc2l6ZV90IHZhbF9sZW4pCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qgd2Z4X2hpZl9t
c2cgKmhpZjsKKwlpbnQgYnVmX2xlbiA9IHNpemVvZihzdHJ1Y3Qgd2Z4X2hpZl9jbmZfcmVhZF9t
aWIpICsgdmFsX2xlbjsKKwlzdHJ1Y3Qgd2Z4X2hpZl9yZXFfcmVhZF9taWIgKmJvZHkgPSB3Znhf
YWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOworCXN0cnVjdCB3ZnhfaGlmX2NuZl9yZWFk
X21pYiAqcmVwbHkgPSBrbWFsbG9jKGJ1Zl9sZW4sIEdGUF9LRVJORUwpOworCisJaWYgKCFib2R5
IHx8ICFyZXBseSkgeworCQlyZXQgPSAtRU5PTUVNOworCQlnb3RvIG91dDsKKwl9CisJYm9keS0+
bWliX2lkID0gY3B1X3RvX2xlMTYobWliX2lkKTsKKwl3ZnhfZmlsbF9oZWFkZXIoaGlmLCB2aWZf
aWQsIEhJRl9SRVFfSURfUkVBRF9NSUIsIHNpemVvZigqYm9keSkpOworCXJldCA9IHdmeF9jbWRf
c2VuZCh3ZGV2LCBoaWYsIHJlcGx5LCBidWZfbGVuLCBmYWxzZSk7CisKKwlpZiAoIXJldCAmJiBt
aWJfaWQgIT0gbGUxNl90b19jcHUocmVwbHktPm1pYl9pZCkpIHsKKwkJZGV2X3dhcm4od2Rldi0+
ZGV2LCAiJXM6IGNvbmZpcm1hdGlvbiBtaXNtYXRjaCByZXF1ZXN0XG4iLCBfX2Z1bmNfXyk7CisJ
CXJldCA9IC1FSU87CisJfQorCWlmIChyZXQgPT0gLUVOT01FTSkKKwkJZGV2X2Vycih3ZGV2LT5k
ZXYsICJidWZmZXIgaXMgdG9vIHNtYWxsIHRvIHJlY2VpdmUgJXMgKCV6dSA8ICVkKVxuIiwKKwkJ
CXdmeF9nZXRfbWliX25hbWUobWliX2lkKSwgdmFsX2xlbiwgbGUxNl90b19jcHUocmVwbHktPmxl
bmd0aCkpOworCWlmICghcmV0KQorCQltZW1jcHkodmFsLCAmcmVwbHktPm1pYl9kYXRhLCBsZTE2
X3RvX2NwdShyZXBseS0+bGVuZ3RoKSk7CisJZWxzZQorCQltZW1zZXQodmFsLCAweEZGLCB2YWxf
bGVuKTsKK291dDoKKwlrZnJlZShoaWYpOworCWtmcmVlKHJlcGx5KTsKKwlyZXR1cm4gcmV0Owor
fQorCitpbnQgd2Z4X2hpZl93cml0ZV9taWIoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCB2aWZf
aWQsIHUxNiBtaWJfaWQsIHZvaWQgKnZhbCwgc2l6ZV90IHZhbF9sZW4pCit7CisJaW50IHJldDsK
KwlzdHJ1Y3Qgd2Z4X2hpZl9tc2cgKmhpZjsKKwlpbnQgYnVmX2xlbiA9IHNpemVvZihzdHJ1Y3Qg
d2Z4X2hpZl9yZXFfd3JpdGVfbWliKSArIHZhbF9sZW47CisJc3RydWN0IHdmeF9oaWZfcmVxX3dy
aXRlX21pYiAqYm9keSA9IHdmeF9hbGxvY19oaWYoYnVmX2xlbiwgJmhpZik7CisKKwlpZiAoIWhp
ZikKKwkJcmV0dXJuIC1FTk9NRU07CisJYm9keS0+bWliX2lkID0gY3B1X3RvX2xlMTYobWliX2lk
KTsKKwlib2R5LT5sZW5ndGggPSBjcHVfdG9fbGUxNih2YWxfbGVuKTsKKwltZW1jcHkoJmJvZHkt
Pm1pYl9kYXRhLCB2YWwsIHZhbF9sZW4pOworCXdmeF9maWxsX2hlYWRlcihoaWYsIHZpZl9pZCwg
SElGX1JFUV9JRF9XUklURV9NSUIsIGJ1Zl9sZW4pOworCXJldCA9IHdmeF9jbWRfc2VuZCh3ZGV2
LCBoaWYsIE5VTEwsIDAsIGZhbHNlKTsKKwlrZnJlZShoaWYpOworCXJldHVybiByZXQ7Cit9CisK
K2ludCB3ZnhfaGlmX3NjYW4oc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBjZmc4MDIxMV9z
Y2FuX3JlcXVlc3QgKnJlcSwKKwkJIGludCBjaGFuX3N0YXJ0X2lkeCwgaW50IGNoYW5fbnVtKQor
eworCWludCByZXQsIGk7CisJc3RydWN0IHdmeF9oaWZfbXNnICpoaWY7CisJc2l6ZV90IGJ1Zl9s
ZW4gPSBzaXplb2Yoc3RydWN0IHdmeF9oaWZfcmVxX3N0YXJ0X3NjYW5fYWx0KSArIGNoYW5fbnVt
ICogc2l6ZW9mKHU4KTsKKwlzdHJ1Y3Qgd2Z4X2hpZl9yZXFfc3RhcnRfc2Nhbl9hbHQgKmJvZHkg
PSB3ZnhfYWxsb2NfaGlmKGJ1Zl9sZW4sICZoaWYpOworCisJV0FSTihjaGFuX251bSA+IEhJRl9B
UElfTUFYX05CX0NIQU5ORUxTLCAiaW52YWxpZCBwYXJhbXMiKTsKKwlXQVJOKHJlcS0+bl9zc2lk
cyA+IEhJRl9BUElfTUFYX05CX1NTSURTLCAiaW52YWxpZCBwYXJhbXMiKTsKKworCWlmICghaGlm
KQorCQlyZXR1cm4gLUVOT01FTTsKKwlmb3IgKGkgPSAwOyBpIDwgcmVxLT5uX3NzaWRzOyBpKysp
IHsKKwkJbWVtY3B5KGJvZHktPnNzaWRfZGVmW2ldLnNzaWQsIHJlcS0+c3NpZHNbaV0uc3NpZCwg
SUVFRTgwMjExX01BWF9TU0lEX0xFTik7CisJCWJvZHktPnNzaWRfZGVmW2ldLnNzaWRfbGVuZ3Ro
ID0gY3B1X3RvX2xlMzIocmVxLT5zc2lkc1tpXS5zc2lkX2xlbik7CisJfQorCWJvZHktPm51bV9v
Zl9zc2lkcyA9IEhJRl9BUElfTUFYX05CX1NTSURTOworCWJvZHktPm1haW50YWluX2N1cnJlbnRf
YnNzID0gMTsKKwlib2R5LT5kaXNhbGxvd19wcyA9IDE7CisJYm9keS0+dHhfcG93ZXJfbGV2ZWwg
PSBjcHVfdG9fbGUzMihyZXEtPmNoYW5uZWxzW2NoYW5fc3RhcnRfaWR4XS0+bWF4X3Bvd2VyKTsK
Kwlib2R5LT5udW1fb2ZfY2hhbm5lbHMgPSBjaGFuX251bTsKKwlmb3IgKGkgPSAwOyBpIDwgY2hh
bl9udW07IGkrKykKKwkJYm9keS0+Y2hhbm5lbF9saXN0W2ldID0gcmVxLT5jaGFubmVsc1tpICsg
Y2hhbl9zdGFydF9pZHhdLT5od192YWx1ZTsKKwlpZiAocmVxLT5ub19jY2spCisJCWJvZHktPm1h
eF90cmFuc21pdF9yYXRlID0gQVBJX1JBVEVfSU5ERVhfR182TUJQUzsKKwllbHNlCisJCWJvZHkt
Pm1heF90cmFuc21pdF9yYXRlID0gQVBJX1JBVEVfSU5ERVhfQl8xTUJQUzsKKwlpZiAocmVxLT5j
aGFubmVsc1tjaGFuX3N0YXJ0X2lkeF0tPmZsYWdzICYgSUVFRTgwMjExX0NIQU5fTk9fSVIpIHsK
KwkJYm9keS0+bWluX2NoYW5uZWxfdGltZSA9IGNwdV90b19sZTMyKDUwKTsKKwkJYm9keS0+bWF4
X2NoYW5uZWxfdGltZSA9IGNwdV90b19sZTMyKDE1MCk7CisJfSBlbHNlIHsKKwkJYm9keS0+bWlu
X2NoYW5uZWxfdGltZSA9IGNwdV90b19sZTMyKDEwKTsKKwkJYm9keS0+bWF4X2NoYW5uZWxfdGlt
ZSA9IGNwdV90b19sZTMyKDUwKTsKKwkJYm9keS0+bnVtX29mX3Byb2JlX3JlcXVlc3RzID0gMjsK
KwkJYm9keS0+cHJvYmVfZGVsYXkgPSAxMDA7CisJfQorCisJd2Z4X2ZpbGxfaGVhZGVyKGhpZiwg
d3ZpZi0+aWQsIEhJRl9SRVFfSURfU1RBUlRfU0NBTiwgYnVmX2xlbik7CisJcmV0ID0gd2Z4X2Nt
ZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVlKGhpZik7CisJ
cmV0dXJuIHJldDsKK30KKworaW50IHdmeF9oaWZfc3RvcF9zY2FuKHN0cnVjdCB3ZnhfdmlmICp3
dmlmKQoreworCWludCByZXQ7CisJc3RydWN0IHdmeF9oaWZfbXNnICpoaWY7CisJLyogYm9keSBh
c3NvY2lhdGVkIHRvIEhJRl9SRVFfSURfU1RPUF9TQ0FOIGlzIGVtcHR5ICovCisJd2Z4X2FsbG9j
X2hpZigwLCAmaGlmKTsKKworCWlmICghaGlmKQorCQlyZXR1cm4gLUVOT01FTTsKKwl3ZnhfZmls
bF9oZWFkZXIoaGlmLCB3dmlmLT5pZCwgSElGX1JFUV9JRF9TVE9QX1NDQU4sIDApOworCXJldCA9
IHdmeF9jbWRfc2VuZCh3dmlmLT53ZGV2LCBoaWYsIE5VTEwsIDAsIGZhbHNlKTsKKwlrZnJlZSho
aWYpOworCXJldHVybiByZXQ7Cit9CisKK2ludCB3ZnhfaGlmX2pvaW4oc3RydWN0IHdmeF92aWYg
Knd2aWYsIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfYnNzX2NvbmYgKmNvbmYsCisJCSBzdHJ1Y3Qg
aWVlZTgwMjExX2NoYW5uZWwgKmNoYW5uZWwsIGNvbnN0IHU4ICpzc2lkLCBpbnQgc3NpZGxlbikK
K3sKKwlpbnQgcmV0OworCXN0cnVjdCB3ZnhfaGlmX21zZyAqaGlmOworCXN0cnVjdCB3ZnhfaGlm
X3JlcV9qb2luICpib2R5ID0gd2Z4X2FsbG9jX2hpZihzaXplb2YoKmJvZHkpLCAmaGlmKTsKKwor
CVdBUk5fT04oIWNvbmYtPmJlYWNvbl9pbnQpOworCVdBUk5fT04oIWNvbmYtPmJhc2ljX3JhdGVz
KTsKKwlXQVJOX09OKCFjaGFubmVsKTsKKwlXQVJOX09OKHNpemVvZihib2R5LT5zc2lkKSA8IHNz
aWRsZW4pOworCVdBUk4oIWNvbmYtPmlic3Nfam9pbmVkICYmICFzc2lkbGVuLCAiam9pbmluZyBh
biB1bmtub3duIEJTUyIpOworCWlmICghaGlmKQorCQlyZXR1cm4gLUVOT01FTTsKKwlib2R5LT5p
bmZyYXN0cnVjdHVyZV9ic3NfbW9kZSA9ICFjb25mLT5pYnNzX2pvaW5lZDsKKwlib2R5LT5zaG9y
dF9wcmVhbWJsZSA9IGNvbmYtPnVzZV9zaG9ydF9wcmVhbWJsZTsKKwlib2R5LT5wcm9iZV9mb3Jf
am9pbiA9ICEoY2hhbm5lbC0+ZmxhZ3MgJiBJRUVFODAyMTFfQ0hBTl9OT19JUik7CisJYm9keS0+
Y2hhbm5lbF9udW1iZXIgPSBjaGFubmVsLT5od192YWx1ZTsKKwlib2R5LT5iZWFjb25faW50ZXJ2
YWwgPSBjcHVfdG9fbGUzMihjb25mLT5iZWFjb25faW50KTsKKwlib2R5LT5iYXNpY19yYXRlX3Nl
dCA9IGNwdV90b19sZTMyKHdmeF9yYXRlX21hc2tfdG9faHcod3ZpZi0+d2RldiwgY29uZi0+YmFz
aWNfcmF0ZXMpKTsKKwltZW1jcHkoYm9keS0+YnNzaWQsIGNvbmYtPmJzc2lkLCBzaXplb2YoYm9k
eS0+YnNzaWQpKTsKKwlpZiAoc3NpZCkgeworCQlib2R5LT5zc2lkX2xlbmd0aCA9IGNwdV90b19s
ZTMyKHNzaWRsZW4pOworCQltZW1jcHkoYm9keS0+c3NpZCwgc3NpZCwgc3NpZGxlbik7CisJfQor
CXdmeF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZfUkVRX0lEX0pPSU4sIHNpemVvZigq
Ym9keSkpOworCXJldCA9IHdmeF9jbWRfc2VuZCh3dmlmLT53ZGV2LCBoaWYsIE5VTEwsIDAsIGZh
bHNlKTsKKwlrZnJlZShoaWYpOworCXJldHVybiByZXQ7Cit9CisKK2ludCB3ZnhfaGlmX3NldF9i
c3NfcGFyYW1zKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgYWlkLCBpbnQgYmVhY29uX2xvc3Rf
Y291bnQpCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qgd2Z4X2hpZl9tc2cgKmhpZjsKKwlzdHJ1Y3Qg
d2Z4X2hpZl9yZXFfc2V0X2Jzc19wYXJhbXMgKmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigq
Ym9keSksICZoaWYpOworCisJaWYgKCFoaWYpCisJCXJldHVybiAtRU5PTUVNOworCWJvZHktPmFp
ZCA9IGNwdV90b19sZTE2KGFpZCk7CisJYm9keS0+YmVhY29uX2xvc3RfY291bnQgPSBiZWFjb25f
bG9zdF9jb3VudDsKKwl3ZnhfZmlsbF9oZWFkZXIoaGlmLCB3dmlmLT5pZCwgSElGX1JFUV9JRF9T
RVRfQlNTX1BBUkFNUywgc2l6ZW9mKCpib2R5KSk7CisJcmV0ID0gd2Z4X2NtZF9zZW5kKHd2aWYt
PndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVlKGhpZik7CisJcmV0dXJuIHJldDsK
K30KKworaW50IHdmeF9oaWZfYWRkX2tleShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgY29uc3Qgc3Ry
dWN0IHdmeF9oaWZfcmVxX2FkZF9rZXkgKmFyZykKK3sKKwlpbnQgcmV0OworCXN0cnVjdCB3Znhf
aGlmX21zZyAqaGlmOworCS8qIEZJWE1FOiBvbmx5IHNlbmQgbmVjZXNzYXJ5IGJpdHMgKi8KKwlz
dHJ1Y3Qgd2Z4X2hpZl9yZXFfYWRkX2tleSAqYm9keSA9IHdmeF9hbGxvY19oaWYoc2l6ZW9mKCpi
b2R5KSwgJmhpZik7CisKKwlpZiAoIWhpZikKKwkJcmV0dXJuIC1FTk9NRU07CisJLyogRklYTUU6
IHN3YXAgYnl0ZXMgYXMgbmVjZXNzYXJ5IGluIGJvZHkgKi8KKwltZW1jcHkoYm9keSwgYXJnLCBz
aXplb2YoKmJvZHkpKTsKKwlpZiAod2Z4X2FwaV9vbGRlcl90aGFuKHdkZXYsIDEsIDUpKQorCQkv
KiBMZWdhY3kgZmlybXdhcmVzIGV4cGVjdCB0aGF0IGFkZF9rZXkgdG8gYmUgc2VudCBvbiByaWdo
dCBpbnRlcmZhY2UuICovCisJCXdmeF9maWxsX2hlYWRlcihoaWYsIGFyZy0+aW50X2lkLCBISUZf
UkVRX0lEX0FERF9LRVksIHNpemVvZigqYm9keSkpOworCWVsc2UKKwkJd2Z4X2ZpbGxfaGVhZGVy
KGhpZiwgLTEsIEhJRl9SRVFfSURfQUREX0tFWSwgc2l6ZW9mKCpib2R5KSk7CisJcmV0ID0gd2Z4
X2NtZF9zZW5kKHdkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVlKGhpZik7CisJcmV0
dXJuIHJldDsKK30KKworaW50IHdmeF9oaWZfcmVtb3ZlX2tleShzdHJ1Y3Qgd2Z4X2RldiAqd2Rl
diwgaW50IGlkeCkKK3sKKwlpbnQgcmV0OworCXN0cnVjdCB3ZnhfaGlmX21zZyAqaGlmOworCXN0
cnVjdCB3ZnhfaGlmX3JlcV9yZW1vdmVfa2V5ICpib2R5ID0gd2Z4X2FsbG9jX2hpZihzaXplb2Yo
KmJvZHkpLCAmaGlmKTsKKworCWlmICghaGlmKQorCQlyZXR1cm4gLUVOT01FTTsKKwlib2R5LT5l
bnRyeV9pbmRleCA9IGlkeDsKKwl3ZnhfZmlsbF9oZWFkZXIoaGlmLCAtMSwgSElGX1JFUV9JRF9S
RU1PVkVfS0VZLCBzaXplb2YoKmJvZHkpKTsKKwlyZXQgPSB3ZnhfY21kX3NlbmQod2RldiwgaGlm
LCBOVUxMLCAwLCBmYWxzZSk7CisJa2ZyZWUoaGlmKTsKKwlyZXR1cm4gcmV0OworfQorCitpbnQg
d2Z4X2hpZl9zZXRfZWRjYV9xdWV1ZV9wYXJhbXMoc3RydWN0IHdmeF92aWYgKnd2aWYsIHUxNiBx
dWV1ZSwKKwkJCQkgIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfdHhfcXVldWVfcGFyYW1zICphcmcp
Cit7CisJaW50IHJldDsKKwlzdHJ1Y3Qgd2Z4X2hpZl9tc2cgKmhpZjsKKwlzdHJ1Y3Qgd2Z4X2hp
Zl9yZXFfZWRjYV9xdWV1ZV9wYXJhbXMgKmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9k
eSksICZoaWYpOworCisJaWYgKCFib2R5KQorCQlyZXR1cm4gLUVOT01FTTsKKworCVdBUk5fT04o
YXJnLT5haWZzID4gMjU1KTsKKwlpZiAoIWhpZikKKwkJcmV0dXJuIC1FTk9NRU07CisJYm9keS0+
YWlmc24gPSBhcmctPmFpZnM7CisJYm9keS0+Y3dfbWluID0gY3B1X3RvX2xlMTYoYXJnLT5jd19t
aW4pOworCWJvZHktPmN3X21heCA9IGNwdV90b19sZTE2KGFyZy0+Y3dfbWF4KTsKKwlib2R5LT50
eF9vcF9saW1pdCA9IGNwdV90b19sZTE2KGFyZy0+dHhvcCAqIFVTRUNfUEVSX1RYT1ApOworCWJv
ZHktPnF1ZXVlX2lkID0gMyAtIHF1ZXVlOworCS8qIEFQSSAyLjAgaGFzIGNoYW5nZWQgcXVldWUg
SURzIHZhbHVlcyAqLworCWlmICh3ZnhfYXBpX29sZGVyX3RoYW4od3ZpZi0+d2RldiwgMiwgMCkg
JiYgcXVldWUgPT0gSUVFRTgwMjExX0FDX0JFKQorCQlib2R5LT5xdWV1ZV9pZCA9IEhJRl9RVUVV
RV9JRF9CQUNLR1JPVU5EOworCWlmICh3ZnhfYXBpX29sZGVyX3RoYW4od3ZpZi0+d2RldiwgMiwg
MCkgJiYgcXVldWUgPT0gSUVFRTgwMjExX0FDX0JLKQorCQlib2R5LT5xdWV1ZV9pZCA9IEhJRl9R
VUVVRV9JRF9CRVNURUZGT1JUOworCXdmeF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZf
UkVRX0lEX0VEQ0FfUVVFVUVfUEFSQU1TLCBzaXplb2YoKmJvZHkpKTsKKwlyZXQgPSB3ZnhfY21k
X3NlbmQod3ZpZi0+d2RldiwgaGlmLCBOVUxMLCAwLCBmYWxzZSk7CisJa2ZyZWUoaGlmKTsKKwly
ZXR1cm4gcmV0OworfQorCitpbnQgd2Z4X2hpZl9zZXRfcG0oc3RydWN0IHdmeF92aWYgKnd2aWYs
IGJvb2wgcHMsIGludCBkeW5hbWljX3BzX3RpbWVvdXQpCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qg
d2Z4X2hpZl9tc2cgKmhpZjsKKwlzdHJ1Y3Qgd2Z4X2hpZl9yZXFfc2V0X3BtX21vZGUgKmJvZHkg
PSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOworCisJaWYgKCFib2R5KQorCQly
ZXR1cm4gLUVOT01FTTsKKworCWlmICghaGlmKQorCQlyZXR1cm4gLUVOT01FTTsKKwlpZiAocHMp
IHsKKwkJYm9keS0+ZW50ZXJfcHNtID0gMTsKKwkJLyogRmlybXdhcmUgZG9lcyBub3Qgc3VwcG9y
dCBtb3JlIHRoYW4gMTI4bXMgKi8KKwkJYm9keS0+ZmFzdF9wc21faWRsZV9wZXJpb2QgPSBtaW4o
ZHluYW1pY19wc190aW1lb3V0ICogMiwgMjU1KTsKKwkJaWYgKGJvZHktPmZhc3RfcHNtX2lkbGVf
cGVyaW9kKQorCQkJYm9keS0+ZmFzdF9wc20gPSAxOworCX0KKwl3ZnhfZmlsbF9oZWFkZXIoaGlm
LCB3dmlmLT5pZCwgSElGX1JFUV9JRF9TRVRfUE1fTU9ERSwgc2l6ZW9mKCpib2R5KSk7CisJcmV0
ID0gd2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVl
KGhpZik7CisJcmV0dXJuIHJldDsKK30KKworaW50IHdmeF9oaWZfc3RhcnQoc3RydWN0IHdmeF92
aWYgKnd2aWYsIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfYnNzX2NvbmYgKmNvbmYsCisJCSAgY29u
c3Qgc3RydWN0IGllZWU4MDIxMV9jaGFubmVsICpjaGFubmVsKQoreworCWludCByZXQ7CisJc3Ry
dWN0IHdmeF9oaWZfbXNnICpoaWY7CisJc3RydWN0IHdmeF9oaWZfcmVxX3N0YXJ0ICpib2R5ID0g
d2Z4X2FsbG9jX2hpZihzaXplb2YoKmJvZHkpLCAmaGlmKTsKKworCVdBUk5fT04oIWNvbmYtPmJl
YWNvbl9pbnQpOworCWlmICghaGlmKQorCQlyZXR1cm4gLUVOT01FTTsKKwlib2R5LT5kdGltX3Bl
cmlvZCA9IGNvbmYtPmR0aW1fcGVyaW9kOworCWJvZHktPnNob3J0X3ByZWFtYmxlID0gY29uZi0+
dXNlX3Nob3J0X3ByZWFtYmxlOworCWJvZHktPmNoYW5uZWxfbnVtYmVyID0gY2hhbm5lbC0+aHdf
dmFsdWU7CisJYm9keS0+YmVhY29uX2ludGVydmFsID0gY3B1X3RvX2xlMzIoY29uZi0+YmVhY29u
X2ludCk7CisJYm9keS0+YmFzaWNfcmF0ZV9zZXQgPSBjcHVfdG9fbGUzMih3ZnhfcmF0ZV9tYXNr
X3RvX2h3KHd2aWYtPndkZXYsIGNvbmYtPmJhc2ljX3JhdGVzKSk7CisJYm9keS0+c3NpZF9sZW5n
dGggPSBjb25mLT5zc2lkX2xlbjsKKwltZW1jcHkoYm9keS0+c3NpZCwgY29uZi0+c3NpZCwgY29u
Zi0+c3NpZF9sZW4pOworCXdmeF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZfUkVRX0lE
X1NUQVJULCBzaXplb2YoKmJvZHkpKTsKKwlyZXQgPSB3ZnhfY21kX3NlbmQod3ZpZi0+d2Rldiwg
aGlmLCBOVUxMLCAwLCBmYWxzZSk7CisJa2ZyZWUoaGlmKTsKKwlyZXR1cm4gcmV0OworfQorCitp
bnQgd2Z4X2hpZl9iZWFjb25fdHJhbnNtaXQoc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5h
YmxlKQoreworCWludCByZXQ7CisJc3RydWN0IHdmeF9oaWZfbXNnICpoaWY7CisJc3RydWN0IHdm
eF9oaWZfcmVxX2JlYWNvbl90cmFuc21pdCAqYm9keSA9IHdmeF9hbGxvY19oaWYoc2l6ZW9mKCpi
b2R5KSwgJmhpZik7CisKKwlpZiAoIWhpZikKKwkJcmV0dXJuIC1FTk9NRU07CisJYm9keS0+ZW5h
YmxlX2JlYWNvbmluZyA9IGVuYWJsZSA/IDEgOiAwOworCXdmeF9maWxsX2hlYWRlcihoaWYsIHd2
aWYtPmlkLCBISUZfUkVRX0lEX0JFQUNPTl9UUkFOU01JVCwgc2l6ZW9mKCpib2R5KSk7CisJcmV0
ID0gd2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVl
KGhpZik7CisJcmV0dXJuIHJldDsKK30KKworaW50IHdmeF9oaWZfbWFwX2xpbmsoc3RydWN0IHdm
eF92aWYgKnd2aWYsIGJvb2wgdW5tYXAsIHU4ICptYWNfYWRkciwgaW50IHN0YV9pZCwgYm9vbCBt
ZnApCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qgd2Z4X2hpZl9tc2cgKmhpZjsKKwlzdHJ1Y3Qgd2Z4
X2hpZl9yZXFfbWFwX2xpbmsgKmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9keSksICZo
aWYpOworCisJaWYgKCFoaWYpCisJCXJldHVybiAtRU5PTUVNOworCWlmIChtYWNfYWRkcikKKwkJ
ZXRoZXJfYWRkcl9jb3B5KGJvZHktPm1hY19hZGRyLCBtYWNfYWRkcik7CisJYm9keS0+bWZwYyA9
IG1mcCA/IDEgOiAwOworCWJvZHktPnVubWFwID0gdW5tYXAgPyAxIDogMDsKKwlib2R5LT5wZWVy
X3N0YV9pZCA9IHN0YV9pZDsKKwl3ZnhfZmlsbF9oZWFkZXIoaGlmLCB3dmlmLT5pZCwgSElGX1JF
UV9JRF9NQVBfTElOSywgc2l6ZW9mKCpib2R5KSk7CisJcmV0ID0gd2Z4X2NtZF9zZW5kKHd2aWYt
PndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVlKGhpZik7CisJcmV0dXJuIHJldDsK
K30KKworaW50IHdmeF9oaWZfdXBkYXRlX2llX2JlYWNvbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwg
Y29uc3QgdTggKmllcywgc2l6ZV90IGllc19sZW4pCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qgd2Z4
X2hpZl9tc2cgKmhpZjsKKwlpbnQgYnVmX2xlbiA9IHNpemVvZihzdHJ1Y3Qgd2Z4X2hpZl9yZXFf
dXBkYXRlX2llKSArIGllc19sZW47CisJc3RydWN0IHdmeF9oaWZfcmVxX3VwZGF0ZV9pZSAqYm9k
eSA9IHdmeF9hbGxvY19oaWYoYnVmX2xlbiwgJmhpZik7CisKKwlpZiAoIWhpZikKKwkJcmV0dXJu
IC1FTk9NRU07CisJYm9keS0+YmVhY29uID0gMTsKKwlib2R5LT5udW1faWVzID0gY3B1X3RvX2xl
MTYoMSk7CisJbWVtY3B5KGJvZHktPmllLCBpZXMsIGllc19sZW4pOworCXdmeF9maWxsX2hlYWRl
cihoaWYsIHd2aWYtPmlkLCBISUZfUkVRX0lEX1VQREFURV9JRSwgYnVmX2xlbik7CisJcmV0ID0g
d2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOworCWtmcmVlKGhp
Zik7CisJcmV0dXJuIHJldDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3Np
bGFicy93ZngvaGlmX3R4LmggYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2hpZl90
eC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNzE4MTdhNjU3MWYw
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9oaWZf
dHguaApAQCAtMCwwICsxLDYxIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5ICovCisvKgorICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGhvc3QtdG8tY2hpcCBjb21t
YW5kcyAoYWthIHJlcXVlc3QvY29uZmlybWF0aW9uKSBvZiB0aGUKKyAqIGhhcmR3YXJlIEFQSS4K
KyAqCisgKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIElu
Yy4KKyAqIENvcHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KKyAqIENvcHlyaWdodCAoQykg
MjAxMCwgU1QtRXJpY3Nzb24gU0EKKyAqLworI2lmbmRlZiBXRlhfSElGX1RYX0gKKyNkZWZpbmUg
V0ZYX0hJRl9UWF9ICisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4
L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvY29tcGxldGlvbi5oPgorCitzdHJ1Y3QgaWVlZTgw
MjExX2NoYW5uZWw7CitzdHJ1Y3QgaWVlZTgwMjExX2Jzc19jb25mOworc3RydWN0IGllZWU4MDIx
MV90eF9xdWV1ZV9wYXJhbXM7CitzdHJ1Y3QgY2ZnODAyMTFfc2Nhbl9yZXF1ZXN0Oworc3RydWN0
IHdmeF9oaWZfcmVxX2FkZF9rZXk7CitzdHJ1Y3Qgd2Z4X2RldjsKK3N0cnVjdCB3ZnhfdmlmOwor
CitzdHJ1Y3Qgd2Z4X2hpZl9jbWQgeworCXN0cnVjdCBtdXRleCAgICAgICBsb2NrOworCXN0cnVj
dCBjb21wbGV0aW9uICByZWFkeTsKKwlzdHJ1Y3QgY29tcGxldGlvbiAgZG9uZTsKKwlzdHJ1Y3Qg
d2Z4X2hpZl9tc2cgKmJ1Zl9zZW5kOworCXZvaWQgICAgICAgICAgICAgICAqYnVmX3JlY3Y7CisJ
c2l6ZV90ICAgICAgICAgICAgIGxlbl9yZWN2OworCWludCAgICAgICAgICAgICAgICByZXQ7Cit9
OworCit2b2lkIHdmeF9pbml0X2hpZl9jbWQoc3RydWN0IHdmeF9oaWZfY21kICp3ZnhfaGlmX2Nt
ZCk7CitpbnQgd2Z4X2NtZF9zZW5kKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgd2Z4X2hp
Zl9tc2cgKnJlcXVlc3QsCisJCSB2b2lkICpyZXBseSwgc2l6ZV90IHJlcGx5X2xlbiwgYm9vbCBh
c3luYyk7CisKK2ludCB3ZnhfaGlmX3JlYWRfbWliKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQg
dmlmX2lkLCB1MTYgbWliX2lkLCB2b2lkICpidWYsIHNpemVfdCBidWZfc2l6ZSk7CitpbnQgd2Z4
X2hpZl93cml0ZV9taWIoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCB2aWZfaWQsIHUxNiBtaWJf
aWQsIHZvaWQgKmJ1Ziwgc2l6ZV90IGJ1Zl9zaXplKTsKK2ludCB3ZnhfaGlmX3N0YXJ0KHN0cnVj
dCB3ZnhfdmlmICp3dmlmLCBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX2Jzc19jb25mICpjb25mLAor
CQkgIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfY2hhbm5lbCAqY2hhbm5lbCk7CitpbnQgd2Z4X2hp
Zl9yZXNldChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCByZXNldF9zdGF0KTsKK2ludCB3Znhf
aGlmX2pvaW4oc3RydWN0IHdmeF92aWYgKnd2aWYsIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfYnNz
X2NvbmYgKmNvbmYsCisJCSBzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKmNoYW5uZWwsIGNvbnN0
IHU4ICpzc2lkLCBpbnQgc3NpZGxlbik7CitpbnQgd2Z4X2hpZl9tYXBfbGluayhzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgYm9vbCB1bm1hcCwgdTggKm1hY19hZGRyLCBpbnQgc3RhX2lkLCBib29sIG1m
cCk7CitpbnQgd2Z4X2hpZl9hZGRfa2V5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCBzdHJ1
Y3Qgd2Z4X2hpZl9yZXFfYWRkX2tleSAqYXJnKTsKK2ludCB3ZnhfaGlmX3JlbW92ZV9rZXkoc3Ry
dWN0IHdmeF9kZXYgKndkZXYsIGludCBpZHgpOworaW50IHdmeF9oaWZfc2V0X3BtKHN0cnVjdCB3
ZnhfdmlmICp3dmlmLCBib29sIHBzLCBpbnQgZHluYW1pY19wc190aW1lb3V0KTsKK2ludCB3Znhf
aGlmX3NldF9ic3NfcGFyYW1zKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgYWlkLCBpbnQgYmVh
Y29uX2xvc3RfY291bnQpOworaW50IHdmeF9oaWZfc2V0X2VkY2FfcXVldWVfcGFyYW1zKHN0cnVj
dCB3ZnhfdmlmICp3dmlmLCB1MTYgcXVldWUsCisJCQkJICBjb25zdCBzdHJ1Y3QgaWVlZTgwMjEx
X3R4X3F1ZXVlX3BhcmFtcyAqYXJnKTsKK2ludCB3ZnhfaGlmX2JlYWNvbl90cmFuc21pdChzdHJ1
Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBlbmFibGUpOworaW50IHdmeF9oaWZfdXBkYXRlX2llX2Jl
YWNvbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgY29uc3QgdTggKmllcywgc2l6ZV90IGllc19sZW4p
OworaW50IHdmeF9oaWZfc2NhbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgc3RydWN0IGNmZzgwMjEx
X3NjYW5fcmVxdWVzdCAqcmVxODAyMTEsCisJCSBpbnQgY2hhbl9zdGFydCwgaW50IGNoYW5fbnVt
KTsKK2ludCB3ZnhfaGlmX3N0b3Bfc2NhbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZik7CitpbnQgd2Z4
X2hpZl9jb25maWd1cmF0aW9uKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCB1OCAqY29uZiwg
c2l6ZV90IGxlbik7CitpbnQgd2Z4X2hpZl9zaHV0ZG93bihzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7
CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9o
aWZfdHhfbWliLmMgYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2hpZl90eF9taWIu
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjFjNTdkZDJiNjk3Ywot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvaGlmX3R4
X21pYi5jCkBAIC0wLDAgKzEsMzA4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMC1vbmx5CisvKgorICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGhvc3QtdG8tY2hpcCBNSUJz
IG9mIHRoZSBoYXJkd2FyZSBBUEkuCisgKgorICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNp
bGljb24gTGFib3JhdG9yaWVzLCBJbmMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNz
c29uCisgKiBDb3B5cmlnaHQgKEMpIDIwMTAsIFNULUVyaWNzc29uIFNBCisgKi8KKworI2luY2x1
ZGUgPGxpbnV4L2V0aGVyZGV2aWNlLmg+CisKKyNpbmNsdWRlICJ3ZnguaCIKKyNpbmNsdWRlICJo
aWZfdHguaCIKKyNpbmNsdWRlICJoaWZfdHhfbWliLmgiCisjaW5jbHVkZSAiaGlmX2FwaV9taWIu
aCIKKworaW50IHdmeF9oaWZfc2V0X291dHB1dF9wb3dlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwg
aW50IHZhbCkKK3sKKwlzdHJ1Y3Qgd2Z4X2hpZl9taWJfY3VycmVudF90eF9wb3dlcl9sZXZlbCBh
cmcgPSB7CisJCS5wb3dlcl9sZXZlbCA9IGNwdV90b19sZTMyKHZhbCAqIDEwKSwKKwl9OworCisJ
cmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlCX0lE
X0NVUlJFTlRfVFhfUE9XRVJfTEVWRUwsCisJCQkJICZhcmcsIHNpemVvZihhcmcpKTsKK30KKwor
aW50IHdmeF9oaWZfc2V0X2JlYWNvbl93YWtldXBfcGVyaW9kKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LAorCQkJCSAgICAgdW5zaWduZWQgaW50IGR0aW1faW50ZXJ2YWwsIHVuc2lnbmVkIGludCBsaXN0
ZW5faW50ZXJ2YWwpCit7CisJc3RydWN0IHdmeF9oaWZfbWliX2JlYWNvbl93YWtlX3VwX3Blcmlv
ZCBhcmcgPSB7CisJCS53YWtldXBfcGVyaW9kX21pbiA9IGR0aW1faW50ZXJ2YWwsCisJCS5yZWNl
aXZlX2R0aW0gPSAwLAorCQkud2FrZXVwX3BlcmlvZF9tYXggPSBsaXN0ZW5faW50ZXJ2YWwsCisJ
fTsKKworCWlmIChkdGltX2ludGVydmFsID4gMHhGRiB8fCBsaXN0ZW5faW50ZXJ2YWwgPiAweEZG
RkYpCisJCXJldHVybiAtRUlOVkFMOworCXJldHVybiB3ZnhfaGlmX3dyaXRlX21pYih3dmlmLT53
ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9CRUFDT05fV0FLRVVQX1BFUklPRCwKKwkJCQkgJmFy
Zywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgd2Z4X2hpZl9zZXRfcmNwaV9yc3NpX3RocmVzaG9s
ZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHJzc2lfdGhvbGQsIGludCByc3NpX2h5c3QpCit7
CisJc3RydWN0IHdmeF9oaWZfbWliX3JjcGlfcnNzaV90aHJlc2hvbGQgYXJnID0geworCQkucm9s
bGluZ19hdmVyYWdlX2NvdW50ID0gOCwKKwkJLmRldGVjdGlvbiA9IDEsCisJfTsKKworCWlmICgh
cnNzaV90aG9sZCAmJiAhcnNzaV9oeXN0KSB7CisJCWFyZy51cHBlcnRocmVzaCA9IDE7CisJCWFy
Zy5sb3dlcnRocmVzaCA9IDE7CisJfSBlbHNlIHsKKwkJYXJnLnVwcGVyX3RocmVzaG9sZCA9IHJz
c2lfdGhvbGQgKyByc3NpX2h5c3Q7CisJCWFyZy51cHBlcl90aHJlc2hvbGQgPSAoYXJnLnVwcGVy
X3RocmVzaG9sZCArIDExMCkgKiAyOworCQlhcmcubG93ZXJfdGhyZXNob2xkID0gcnNzaV90aG9s
ZDsKKwkJYXJnLmxvd2VyX3RocmVzaG9sZCA9IChhcmcubG93ZXJfdGhyZXNob2xkICsgMTEwKSAq
IDI7CisJfQorCisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlk
LCBISUZfTUlCX0lEX1JDUElfUlNTSV9USFJFU0hPTEQsCisJCQkJICZhcmcsIHNpemVvZihhcmcp
KTsKK30KKworaW50IHdmeF9oaWZfZ2V0X2NvdW50ZXJzX3RhYmxlKHN0cnVjdCB3ZnhfZGV2ICp3
ZGV2LCBpbnQgdmlmX2lkLAorCQkJICAgICAgIHN0cnVjdCB3ZnhfaGlmX21pYl9leHRlbmRlZF9j
b3VudF90YWJsZSAqYXJnKQoreworCWlmICh3ZnhfYXBpX29sZGVyX3RoYW4od2RldiwgMSwgMykp
IHsKKwkJLyogZXh0ZW5kZWRfY291bnRfdGFibGUgaXMgd2lkZXIgdGhhbiBjb3VudF90YWJsZSAq
LworCQltZW1zZXQoYXJnLCAweEZGLCBzaXplb2YoKmFyZykpOworCQlyZXR1cm4gd2Z4X2hpZl9y
ZWFkX21pYih3ZGV2LCB2aWZfaWQsIEhJRl9NSUJfSURfQ09VTlRFUlNfVEFCTEUsCisJCQkJICAg
IGFyZywgc2l6ZW9mKHN0cnVjdCB3ZnhfaGlmX21pYl9jb3VudF90YWJsZSkpOworCX0gZWxzZSB7
CisJCXJldHVybiB3ZnhfaGlmX3JlYWRfbWliKHdkZXYsIHZpZl9pZCwgSElGX01JQl9JRF9FWFRF
TkRFRF9DT1VOVEVSU19UQUJMRSwKKwkJCQkJYXJnLCBzaXplb2Yoc3RydWN0IHdmeF9oaWZfbWli
X2V4dGVuZGVkX2NvdW50X3RhYmxlKSk7CisJfQorfQorCitpbnQgd2Z4X2hpZl9zZXRfbWFjYWRk
cihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdTggKm1hYykKK3sKKwlzdHJ1Y3Qgd2Z4X2hpZl9taWJf
bWFjX2FkZHJlc3MgYXJnID0geyB9OworCisJaWYgKG1hYykKKwkJZXRoZXJfYWRkcl9jb3B5KGFy
Zy5tYWNfYWRkciwgbWFjKTsKKwlyZXR1cm4gd2Z4X2hpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwg
d3ZpZi0+aWQsIEhJRl9NSUJfSURfRE9UMTFfTUFDX0FERFJFU1MsCisJCQkJICZhcmcsIHNpemVv
ZihhcmcpKTsKK30KKworaW50IHdmeF9oaWZfc2V0X3J4X2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwKKwkJCSAgYm9vbCBmaWx0ZXJfYnNzaWQsIGJvb2wgZmlsdGVyX3ByYnJlcSkKK3sKKwlz
dHJ1Y3Qgd2Z4X2hpZl9taWJfcnhfZmlsdGVyIGFyZyA9IHsgfTsKKworCWlmIChmaWx0ZXJfYnNz
aWQpCisJCWFyZy5ic3NpZF9maWx0ZXIgPSAxOworCWlmICghZmlsdGVyX3ByYnJlcSkKKwkJYXJn
LmZ3ZF9wcm9iZV9yZXEgPSAxOworCXJldHVybiB3ZnhfaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2
LCB3dmlmLT5pZCwgSElGX01JQl9JRF9SWF9GSUxURVIsICZhcmcsIHNpemVvZihhcmcpKTsKK30K
KworaW50IHdmeF9oaWZfc2V0X2JlYWNvbl9maWx0ZXJfdGFibGUoc3RydWN0IHdmeF92aWYgKnd2
aWYsIGludCB0YmxfbGVuLAorCQkJCSAgICBjb25zdCBzdHJ1Y3Qgd2Z4X2hpZl9pZV90YWJsZV9l
bnRyeSAqdGJsKQoreworCWludCByZXQ7CisJc3RydWN0IHdmeF9oaWZfbWliX2Jjbl9maWx0ZXJf
dGFibGUgKmFyZzsKKwlpbnQgYnVmX2xlbiA9IHN0cnVjdF9zaXplKGFyZywgaWVfdGFibGUsIHRi
bF9sZW4pOworCisJYXJnID0ga3phbGxvYyhidWZfbGVuLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWFy
ZykKKwkJcmV0dXJuIC1FTk9NRU07CisJYXJnLT5udW1fb2ZfaW5mb19lbG10cyA9IGNwdV90b19s
ZTMyKHRibF9sZW4pOworCW1lbWNweShhcmctPmllX3RhYmxlLCB0YmwsIGZsZXhfYXJyYXlfc2l6
ZShhcmcsIGllX3RhYmxlLCB0YmxfbGVuKSk7CisJcmV0ID0gd2Z4X2hpZl93cml0ZV9taWIod3Zp
Zi0+d2Rldiwgd3ZpZi0+aWQsIEhJRl9NSUJfSURfQkVBQ09OX0ZJTFRFUl9UQUJMRSwKKwkJCQlh
cmcsIGJ1Zl9sZW4pOworCWtmcmVlKGFyZyk7CisJcmV0dXJuIHJldDsKK30KKworaW50IHdmeF9o
aWZfYmVhY29uX2ZpbHRlcl9jb250cm9sKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgZW5hYmxl
LCBpbnQgYmVhY29uX2NvdW50KQoreworCXN0cnVjdCB3ZnhfaGlmX21pYl9iY25fZmlsdGVyX2Vu
YWJsZSBhcmcgPSB7CisJCS5lbmFibGUgPSBjcHVfdG9fbGUzMihlbmFibGUpLAorCQkuYmNuX2Nv
dW50ID0gY3B1X3RvX2xlMzIoYmVhY29uX2NvdW50KSwKKwl9OworCXJldHVybiB3ZnhfaGlmX3dy
aXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9CRUFDT05fRklMVEVSX0VO
QUJMRSwKKwkJCQkgJmFyZywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgd2Z4X2hpZl9zZXRfb3Bl
cmF0aW9uYWxfbW9kZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgZW51bSB3ZnhfaGlmX29wX3Bvd2Vy
X21vZGUgbW9kZSkKK3sKKwlzdHJ1Y3Qgd2Z4X2hpZl9taWJfZ2xfb3BlcmF0aW9uYWxfcG93ZXJf
bW9kZSBhcmcgPSB7CisJCS5wb3dlcl9tb2RlID0gbW9kZSwKKwkJLnd1cF9pbmRfYWN0aXZhdGlv
biA9IDEsCisJfTsKKworCXJldHVybiB3ZnhfaGlmX3dyaXRlX21pYih3ZGV2LCAtMSwgSElGX01J
Ql9JRF9HTF9PUEVSQVRJT05BTF9QT1dFUl9NT0RFLAorCQkJCSAmYXJnLCBzaXplb2YoYXJnKSk7
Cit9CisKK2ludCB3ZnhfaGlmX3NldF90ZW1wbGF0ZV9mcmFtZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
Ziwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKKwkJCSAgICAgICB1OCBmcmFtZV90eXBlLCBpbnQgaW5p
dF9yYXRlKQoreworCXN0cnVjdCB3ZnhfaGlmX21pYl90ZW1wbGF0ZV9mcmFtZSAqYXJnOworCisJ
V0FSTihza2ItPmxlbiA+IEhJRl9BUElfTUFYX1RFTVBMQVRFX0ZSQU1FX1NJWkUsICJmcmFtZSBp
cyB0b28gYmlnIik7CisJc2tiX3B1c2goc2tiLCA0KTsKKwlhcmcgPSAoc3RydWN0IHdmeF9oaWZf
bWliX3RlbXBsYXRlX2ZyYW1lICopc2tiLT5kYXRhOworCXNrYl9wdWxsKHNrYiwgNCk7CisJYXJn
LT5pbml0X3JhdGUgPSBpbml0X3JhdGU7CisJYXJnLT5mcmFtZV90eXBlID0gZnJhbWVfdHlwZTsK
KwlhcmctPmZyYW1lX2xlbmd0aCA9IGNwdV90b19sZTE2KHNrYi0+bGVuKTsKKwlyZXR1cm4gd2Z4
X2hpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsIEhJRl9NSUJfSURfVEVNUExBVEVf
RlJBTUUsCisJCQkJIGFyZywgc2l6ZW9mKCphcmcpICsgc2tiLT5sZW4pOworfQorCitpbnQgd2Z4
X2hpZl9zZXRfbWZwKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGNhcGFibGUsIGJvb2wgcmVx
dWlyZWQpCit7CisJc3RydWN0IHdmeF9oaWZfbWliX3Byb3RlY3RlZF9tZ210X3BvbGljeSBhcmcg
PSB7IH07CisKKwlXQVJOKHJlcXVpcmVkICYmICFjYXBhYmxlLCAiaW5jb2hlcmVudCBhcmd1bWVu
dHMiKTsKKwlpZiAoY2FwYWJsZSkgeworCQlhcmcucG1mX2VuYWJsZSA9IDE7CisJCWFyZy5ob3N0
X2VuY19hdXRoX2ZyYW1lcyA9IDE7CisJfQorCWlmICghcmVxdWlyZWQpCisJCWFyZy51bnBtZl9h
bGxvd2VkID0gMTsKKwlyZXR1cm4gd2Z4X2hpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+
aWQsIEhJRl9NSUJfSURfUFJPVEVDVEVEX01HTVRfUE9MSUNZLAorCQkJCSAmYXJnLCBzaXplb2Yo
YXJnKSk7Cit9CisKK2ludCB3ZnhfaGlmX3NldF9ibG9ja19hY2tfcG9saWN5KHN0cnVjdCB3Znhf
dmlmICp3dmlmLCB1OCB0eF90aWRfcG9saWN5LCB1OCByeF90aWRfcG9saWN5KQoreworCXN0cnVj
dCB3ZnhfaGlmX21pYl9ibG9ja19hY2tfcG9saWN5IGFyZyA9IHsKKwkJLmJsb2NrX2Fja190eF90
aWRfcG9saWN5ID0gdHhfdGlkX3BvbGljeSwKKwkJLmJsb2NrX2Fja19yeF90aWRfcG9saWN5ID0g
cnhfdGlkX3BvbGljeSwKKwl9OworCisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndk
ZXYsIHd2aWYtPmlkLCBISUZfTUlCX0lEX0JMT0NLX0FDS19QT0xJQ1ksCisJCQkJICZhcmcsIHNp
emVvZihhcmcpKTsKK30KKworaW50IHdmeF9oaWZfc2V0X2Fzc29jaWF0aW9uX21vZGUoc3RydWN0
IHdmeF92aWYgKnd2aWYsIGludCBhbXBkdV9kZW5zaXR5LAorCQkJCSBib29sIGdyZWVuZmllbGQs
IGJvb2wgc2hvcnRfcHJlYW1ibGUpCit7CisJc3RydWN0IHdmeF9oaWZfbWliX3NldF9hc3NvY2lh
dGlvbl9tb2RlIGFyZyA9IHsKKwkJLnByZWFtYnR5cGVfdXNlID0gMSwKKwkJLm1vZGUgPSAxLAor
CQkuc3BhY2luZyA9IDEsCisJCS5zaG9ydF9wcmVhbWJsZSA9IHNob3J0X3ByZWFtYmxlLAorCQku
Z3JlZW5maWVsZCA9IGdyZWVuZmllbGQsCisJCS5tcGR1X3N0YXJ0X3NwYWNpbmcgPSBhbXBkdV9k
ZW5zaXR5LAorCX07CisKKwlyZXR1cm4gd2Z4X2hpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3Zp
Zi0+aWQsIEhJRl9NSUJfSURfU0VUX0FTU09DSUFUSU9OX01PREUsCisJCQkJICZhcmcsIHNpemVv
ZihhcmcpKTsKK30KKworaW50IHdmeF9oaWZfc2V0X3R4X3JhdGVfcmV0cnlfcG9saWN5KHN0cnVj
dCB3ZnhfdmlmICp3dmlmLCBpbnQgcG9saWN5X2luZGV4LCB1OCAqcmF0ZXMpCit7CisJc3RydWN0
IHdmeF9oaWZfbWliX3NldF90eF9yYXRlX3JldHJ5X3BvbGljeSAqYXJnOworCXNpemVfdCBzaXpl
ID0gc3RydWN0X3NpemUoYXJnLCB0eF9yYXRlX3JldHJ5X3BvbGljeSwgMSk7CisJaW50IHJldDsK
KworCWFyZyA9IGt6YWxsb2Moc2l6ZSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFhcmcpCisJCXJldHVy
biAtRU5PTUVNOworCWFyZy0+bnVtX3R4X3JhdGVfcG9saWNpZXMgPSAxOworCWFyZy0+dHhfcmF0
ZV9yZXRyeV9wb2xpY3lbMF0ucG9saWN5X2luZGV4ID0gcG9saWN5X2luZGV4OworCWFyZy0+dHhf
cmF0ZV9yZXRyeV9wb2xpY3lbMF0uc2hvcnRfcmV0cnlfY291bnQgPSAyNTU7CisJYXJnLT50eF9y
YXRlX3JldHJ5X3BvbGljeVswXS5sb25nX3JldHJ5X2NvdW50ID0gMjU1OworCWFyZy0+dHhfcmF0
ZV9yZXRyeV9wb2xpY3lbMF0uZmlyc3RfcmF0ZV9zZWwgPSAxOworCWFyZy0+dHhfcmF0ZV9yZXRy
eV9wb2xpY3lbMF0udGVybWluYXRlID0gMTsKKwlhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBd
LmNvdW50X2luaXQgPSAxOworCW1lbWNweSgmYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5y
YXRlcywgcmF0ZXMsCisJICAgICAgIHNpemVvZihhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBd
LnJhdGVzKSk7CisJcmV0ID0gd2Z4X2hpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQs
IEhJRl9NSUJfSURfU0VUX1RYX1JBVEVfUkVUUllfUE9MSUNZLAorCQkJCWFyZywgc2l6ZSk7CisJ
a2ZyZWUoYXJnKTsKKwlyZXR1cm4gcmV0OworfQorCitpbnQgd2Z4X2hpZl9rZWVwX2FsaXZlX3Bl
cmlvZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHBlcmlvZCkKK3sKKwlzdHJ1Y3Qgd2Z4X2hp
Zl9taWJfa2VlcF9hbGl2ZV9wZXJpb2QgYXJnID0geworCQkua2VlcF9hbGl2ZV9wZXJpb2QgPSBj
cHVfdG9fbGUxNihwZXJpb2QpLAorCX07CisKKwlyZXR1cm4gd2Z4X2hpZl93cml0ZV9taWIod3Zp
Zi0+d2Rldiwgd3ZpZi0+aWQsIEhJRl9NSUJfSURfS0VFUF9BTElWRV9QRVJJT0QsCisJCQkJICZh
cmcsIHNpemVvZihhcmcpKTsKK307CisKK2ludCB3ZnhfaGlmX3NldF9hcnBfaXB2NF9maWx0ZXIo
c3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBpZHgsIF9fYmUzMiAqYWRkcikKK3sKKwlzdHJ1Y3Qg
d2Z4X2hpZl9taWJfYXJwX2lwX2FkZHJfdGFibGUgYXJnID0geworCQkuY29uZGl0aW9uX2lkeCA9
IGlkeCwKKwkJLmFycF9lbmFibGUgPSBISUZfQVJQX05TX0ZJTFRFUklOR19ESVNBQkxFLAorCX07
CisKKwlpZiAoYWRkcikgeworCQkvKiBDYXV0aW9uOiB0eXBlIG9mIGFkZHIgaXMgX19iZTMyICov
CisJCW1lbWNweShhcmcuaXB2NF9hZGRyZXNzLCBhZGRyLCBzaXplb2YoYXJnLmlwdjRfYWRkcmVz
cykpOworCQlhcmcuYXJwX2VuYWJsZSA9IEhJRl9BUlBfTlNfRklMVEVSSU5HX0VOQUJMRTsKKwl9
CisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlC
X0lEX0FSUF9JUF9BRERSRVNTRVNfVEFCTEUsCisJCQkJICZhcmcsIHNpemVvZihhcmcpKTsKK30K
KworaW50IHdmeF9oaWZfdXNlX211bHRpX3R4X2NvbmYoc3RydWN0IHdmeF9kZXYgKndkZXYsIGJv
b2wgZW5hYmxlKQoreworCXN0cnVjdCB3ZnhfaGlmX21pYl9nbF9zZXRfbXVsdGlfbXNnIGFyZyA9
IHsKKwkJLmVuYWJsZV9tdWx0aV90eF9jb25mID0gZW5hYmxlLAorCX07CisKKwlyZXR1cm4gd2Z4
X2hpZl93cml0ZV9taWIod2RldiwgLTEsIEhJRl9NSUJfSURfR0xfU0VUX01VTFRJX01TRywgJmFy
Zywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgd2Z4X2hpZl9zZXRfdWFwc2RfaW5mbyhzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwgdW5zaWduZWQgbG9uZyB2YWwpCit7CisJc3RydWN0IHdmeF9oaWZfbWli
X3NldF91YXBzZF9pbmZvcm1hdGlvbiBhcmcgPSB7IH07CisKKwlpZiAodmFsICYgQklUKElFRUU4
MDIxMV9BQ19WTykpCisJCWFyZy50cmlnX3ZvaWNlID0gMTsKKwlpZiAodmFsICYgQklUKElFRUU4
MDIxMV9BQ19WSSkpCisJCWFyZy50cmlnX3ZpZGVvID0gMTsKKwlpZiAodmFsICYgQklUKElFRUU4
MDIxMV9BQ19CRSkpCisJCWFyZy50cmlnX2JlID0gMTsKKwlpZiAodmFsICYgQklUKElFRUU4MDIx
MV9BQ19CSykpCisJCWFyZy50cmlnX2Jja2dybmQgPSAxOworCXJldHVybiB3ZnhfaGlmX3dyaXRl
X21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9TRVRfVUFQU0RfSU5GT1JNQVRJ
T04sCisJCQkJICZhcmcsIHNpemVvZihhcmcpKTsKK30KKworaW50IHdmeF9oaWZfZXJwX3VzZV9w
cm90ZWN0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGVuYWJsZSkKK3sKKwlzdHJ1Y3Qg
d2Z4X2hpZl9taWJfbm9uX2VycF9wcm90ZWN0aW9uIGFyZyA9IHsKKwkJLnVzZV9jdHNfdG9fc2Vs
ZiA9IGVuYWJsZSwKKwl9OworCisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYs
IHd2aWYtPmlkLCBISUZfTUlCX0lEX05PTl9FUlBfUFJPVEVDVElPTiwKKwkJCQkgJmFyZywgc2l6
ZW9mKGFyZykpOworfQorCitpbnQgd2Z4X2hpZl9zbG90X3RpbWUoc3RydWN0IHdmeF92aWYgKnd2
aWYsIGludCB2YWwpCit7CisJc3RydWN0IHdmeF9oaWZfbWliX3Nsb3RfdGltZSBhcmcgPSB7CisJ
CS5zbG90X3RpbWUgPSBjcHVfdG9fbGUzMih2YWwpLAorCX07CisKKwlyZXR1cm4gd2Z4X2hpZl93
cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsIEhJRl9NSUJfSURfU0xPVF9USU1FLCAmYXJn
LCBzaXplb2YoYXJnKSk7Cit9CisKK2ludCB3ZnhfaGlmX3dlcF9kZWZhdWx0X2tleV9pZChzdHJ1
Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCkKK3sKKwlzdHJ1Y3Qgd2Z4X2hpZl9taWJfd2VwX2Rl
ZmF1bHRfa2V5X2lkIGFyZyA9IHsKKwkJLndlcF9kZWZhdWx0X2tleV9pZCA9IHZhbCwKKwl9Owor
CisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlC
X0lEX0RPVDExX1dFUF9ERUZBVUxUX0tFWV9JRCwKKwkJCQkgJmFyZywgc2l6ZW9mKGFyZykpOwor
fQorCitpbnQgd2Z4X2hpZl9ydHNfdGhyZXNob2xkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQg
dmFsKQoreworCXN0cnVjdCB3ZnhfaGlmX21pYl9kb3QxMV9ydHNfdGhyZXNob2xkIGFyZyA9IHsK
KwkJLnRocmVzaG9sZCA9IGNwdV90b19sZTMyKHZhbCA+PSAwID8gdmFsIDogMHhGRkZGKSwKKwl9
OworCisJcmV0dXJuIHdmeF9oaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZf
TUlCX0lEX0RPVDExX1JUU19USFJFU0hPTEQsCisJCQkJICZhcmcsIHNpemVvZihhcmcpKTsKK30K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvaGlmX3R4X21pYi5o
IGIvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9oaWZfdHhfbWliLmgKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5iY2Q0ZWY2YTg0OTcKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2hpZl90eF9taWIuaApAQCAt
MCwwICsxLDQ4IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICov
CisvKgorICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGhvc3QtdG8tY2hpcCBNSUJzIG9mIHRoZSBo
YXJkd2FyZSBBUEkuCisgKgorICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFi
b3JhdG9yaWVzLCBJbmMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCisgKiBD
b3B5cmlnaHQgKEMpIDIwMTAsIFNULUVyaWNzc29uIFNBCisgKi8KKyNpZm5kZWYgV0ZYX0hJRl9U
WF9NSUJfSAorI2RlZmluZSBXRlhfSElGX1RYX01JQl9ICisKKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgorCitzdHJ1Y3Qgc2tfYnVmZjsKK3N0cnVjdCB3ZnhfdmlmOworc3RydWN0IHdmeF9kZXY7
CitzdHJ1Y3Qgd2Z4X2hpZl9pZV90YWJsZV9lbnRyeTsKK3N0cnVjdCB3ZnhfaGlmX21pYl9leHRl
bmRlZF9jb3VudF90YWJsZTsKKworaW50IHdmeF9oaWZfc2V0X291dHB1dF9wb3dlcihzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCk7CitpbnQgd2Z4X2hpZl9zZXRfYmVhY29uX3dha2V1cF9w
ZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkJICAgICB1bnNpZ25lZCBpbnQgZHRpbV9p
bnRlcnZhbCwgdW5zaWduZWQgaW50IGxpc3Rlbl9pbnRlcnZhbCk7CitpbnQgd2Z4X2hpZl9zZXRf
cmNwaV9yc3NpX3RocmVzaG9sZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHJzc2lfdGhvbGQs
IGludCByc3NpX2h5c3QpOworaW50IHdmeF9oaWZfZ2V0X2NvdW50ZXJzX3RhYmxlKHN0cnVjdCB3
ZnhfZGV2ICp3ZGV2LCBpbnQgdmlmX2lkLAorCQkJICAgICAgIHN0cnVjdCB3ZnhfaGlmX21pYl9l
eHRlbmRlZF9jb3VudF90YWJsZSAqYXJnKTsKK2ludCB3ZnhfaGlmX3NldF9tYWNhZGRyKHN0cnVj
dCB3ZnhfdmlmICp3dmlmLCB1OCAqbWFjKTsKK2ludCB3ZnhfaGlmX3NldF9yeF9maWx0ZXIoc3Ry
dWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZmlsdGVyX2Jzc2lkLCBib29sIGZ3ZF9wcm9iZV9yZXEp
OworaW50IHdmeF9oaWZfc2V0X2JlYWNvbl9maWx0ZXJfdGFibGUoc3RydWN0IHdmeF92aWYgKnd2
aWYsIGludCB0YmxfbGVuLAorCQkJCSAgICBjb25zdCBzdHJ1Y3Qgd2Z4X2hpZl9pZV90YWJsZV9l
bnRyeSAqdGJsKTsKK2ludCB3ZnhfaGlmX2JlYWNvbl9maWx0ZXJfY29udHJvbChzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgaW50IGVuYWJsZSwgaW50IGJlYWNvbl9jb3VudCk7CitpbnQgd2Z4X2hpZl9z
ZXRfb3BlcmF0aW9uYWxfbW9kZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgZW51bSB3ZnhfaGlmX29w
X3Bvd2VyX21vZGUgbW9kZSk7CitpbnQgd2Z4X2hpZl9zZXRfdGVtcGxhdGVfZnJhbWUoc3RydWN0
IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZmICpza2IsCisJCQkgICAgICAgdTggZnJhbWVf
dHlwZSwgaW50IGluaXRfcmF0ZSk7CitpbnQgd2Z4X2hpZl9zZXRfbWZwKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCBib29sIGNhcGFibGUsIGJvb2wgcmVxdWlyZWQpOworaW50IHdmeF9oaWZfc2V0X2Js
b2NrX2Fja19wb2xpY3koc3RydWN0IHdmeF92aWYgKnd2aWYsIHU4IHR4X3RpZF9wb2xpY3ksIHU4
IHJ4X3RpZF9wb2xpY3kpOworaW50IHdmeF9oaWZfc2V0X2Fzc29jaWF0aW9uX21vZGUoc3RydWN0
IHdmeF92aWYgKnd2aWYsIGludCBhbXBkdV9kZW5zaXR5LAorCQkJCSBib29sIGdyZWVuZmllbGQs
IGJvb2wgc2hvcnRfcHJlYW1ibGUpOworaW50IHdmeF9oaWZfc2V0X3R4X3JhdGVfcmV0cnlfcG9s
aWN5KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgcG9saWN5X2luZGV4LCB1OCAqcmF0ZXMpOwor
aW50IHdmeF9oaWZfa2VlcF9hbGl2ZV9wZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBw
ZXJpb2QpOworaW50IHdmeF9oaWZfc2V0X2FycF9pcHY0X2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwgaW50IGlkeCwgX19iZTMyICphZGRyKTsKK2ludCB3ZnhfaGlmX3VzZV9tdWx0aV90eF9j
b25mKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBib29sIGVuYWJsZSk7CitpbnQgd2Z4X2hpZl9zZXRf
dWFwc2RfaW5mbyhzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdW5zaWduZWQgbG9uZyB2YWwpOworaW50
IHdmeF9oaWZfZXJwX3VzZV9wcm90ZWN0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGVu
YWJsZSk7CitpbnQgd2Z4X2hpZl9zbG90X3RpbWUoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCB2
YWwpOworaW50IHdmeF9oaWZfd2VwX2RlZmF1bHRfa2V5X2lkKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LCBpbnQgdmFsKTsKK2ludCB3ZnhfaGlmX3J0c190aHJlc2hvbGQoc3RydWN0IHdmeF92aWYgKnd2
aWYsIGludCB2YWwpOworCisjZW5kaWYKLS0gCjIuMzQuMQoK
