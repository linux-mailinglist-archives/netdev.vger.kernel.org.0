Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id E49445A709
	for <lists+netdev@lfdr.de>; Sat, 29 Jun 2019 00:36:44 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727065AbfF1Wgn (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 28 Jun 2019 18:36:43 -0400
Received: from mail-eopbgr70049.outbound.protection.outlook.com ([40.107.7.49]:23750
        "EHLO EUR04-HE1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727050AbfF1Wgm (ORCPT <rfc822;netdev@vger.kernel.org>);
        Fri, 28 Jun 2019 18:36:42 -0400
ARC-Seal: i=1; a=rsa-sha256; s=testarcselector01; d=microsoft.com; cv=none;
 b=Nr/UuedqFtYixJW5t94KwXFjEXCIABlhUxjO5qF0VdOlGy/unCt8u3flFKXmtAxolPipvI9QWKlntqysGOrcavVs49V+q1yx924PnFtaT7oVZ/MpIV54xb0gbcKwdU470XO2DSq1n6acnCTW/XqehakZB7/aKWgJ/jq1IYEQLqI=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=testarcselector01;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=xNRMniWY65/lc2F73zpLKp6uGZY5HyjQhnmPwN5vTh8=;
 b=p/YvZfn2wW1lMIXtz7yzYH3pY5WZYZsszDRUy6FHpUglo6FUZAXWkvKJZPI7GQh4hRayahVs9382Wif0lGTGC1TGU4OBFn5xeY7FfQhIdeHjJu49tK3pkAqz8Vyo4tBsvj7+fEOhVSaniPj45sUA4ma1I0LP836IxvuYvX9NAl4=
ARC-Authentication-Results: i=1; test.office365.com
 1;spf=none;dmarc=none;dkim=none;arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=xNRMniWY65/lc2F73zpLKp6uGZY5HyjQhnmPwN5vTh8=;
 b=pp33IdwD0Y9myO7PCLevyJ3p8Q3+8UdkhsiwHJrjWH7McTKAwJevkhxZyxLhyGzHdFL3MBRcwdTUF0ZcFOnGKsfi+gQ95zwQqq3jNyRCX7puVY/VGo36k3h7ygj/VAkDz0VctAZ63yO9xT+rXS1JzceISiAu8eozbhH/vXjepdI=
Received: from DB6PR0501MB2759.eurprd05.prod.outlook.com (10.172.227.7) by
 DB6PR0501MB2357.eurprd05.prod.outlook.com (10.168.56.24) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2008.17; Fri, 28 Jun 2019 22:36:18 +0000
Received: from DB6PR0501MB2759.eurprd05.prod.outlook.com
 ([fe80::a901:6951:59de:3278]) by DB6PR0501MB2759.eurprd05.prod.outlook.com
 ([fe80::a901:6951:59de:3278%2]) with mapi id 15.20.2008.014; Fri, 28 Jun 2019
 22:36:18 +0000
From:   Saeed Mahameed <saeedm@mellanox.com>
To:     Saeed Mahameed <saeedm@mellanox.com>,
        Leon Romanovsky <leonro@mellanox.com>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        "linux-rdma@vger.kernel.org" <linux-rdma@vger.kernel.org>,
        Bodong Wang <bodong@mellanox.com>
Subject: [PATCH mlx5-next 15/18] net/mlx5: E-Switch, Reg/unreg function
 changed event at correct stage
Thread-Topic: [PATCH mlx5-next 15/18] net/mlx5: E-Switch, Reg/unreg function
 changed event at correct stage
Thread-Index: AQHVLgHnePkHDtqN7EWIT+d5XclOCw==
Date:   Fri, 28 Jun 2019 22:36:18 +0000
Message-ID: <20190628223516.9368-16-saeedm@mellanox.com>
References: <20190628223516.9368-1-saeedm@mellanox.com>
In-Reply-To: <20190628223516.9368-1-saeedm@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.21.0
x-originating-ip: [209.116.155.178]
x-clientproxiedby: BY5PR13CA0035.namprd13.prod.outlook.com
 (2603:10b6:a03:180::48) To DB6PR0501MB2759.eurprd05.prod.outlook.com
 (2603:10a6:4:84::7)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=saeedm@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: e2dfdb5d-5aa7-4c9e-662c-08d6fc19096e
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);SRVR:DB6PR0501MB2357;
x-ms-traffictypediagnostic: DB6PR0501MB2357:
x-microsoft-antispam-prvs: <DB6PR0501MB23573B0B8250EB55E10D456DBEFC0@DB6PR0501MB2357.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:4714;
x-forefront-prvs: 00826B6158
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(4636009)(39860400002)(396003)(346002)(366004)(136003)(376002)(189003)(199004)(107886003)(6436002)(1076003)(3846002)(6116002)(256004)(66446008)(50226002)(6636002)(66066001)(53936002)(36756003)(71200400001)(71190400001)(186003)(8676002)(52116002)(4326008)(5660300002)(14444005)(26005)(6506007)(305945005)(450100002)(11346002)(446003)(478600001)(76176011)(64756008)(99286004)(386003)(102836004)(6512007)(110136005)(2906002)(316002)(66476007)(68736007)(14454004)(81166006)(486006)(86362001)(81156014)(73956011)(66946007)(2616005)(6486002)(476003)(66556008)(8936002)(25786009)(54906003)(7736002);DIR:OUT;SFP:1101;SCL:1;SRVR:DB6PR0501MB2357;H:DB6PR0501MB2759.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: 9634JsoVxvnEWwiKoBytNv08aa3HamIwhZKuivCyacKAJQX61y6WoFI9KHDbGMkfuqrGmbxh/mok/8mOa+///lwM9vUw7VVw93odSh+a+ZAZNsbbaKoLbtULd8ycHXVO7VtrXHvLuHgbBg2bRL+UNXE2gi90WEJ2sCiCxJK0AELQUvNc74mpZzRXIsnN93PNvIPZCdwtH52U6bQ9NeEHqtHDGAkYVzwjGMwY++ianTqkYjIIeRBdMitW9kBzlirZL51kMRPYuQ1xBBaXQZh2oD923zk3zh2EmEvzqPsmKxbGD//+qtLJWQyxbP66Ty+QXg+0OUAN/ybsdmJgwDj/MtRi4cCosxZeZkHF2LX17jOvFgqFGN8fMA2jdWOJlEOkYglE/s4dxKI9YPq6xSn7/YoeAe2LjTqWPhtjN72ey3Q=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e2dfdb5d-5aa7-4c9e-662c-08d6fc19096e
X-MS-Exchange-CrossTenant-originalarrivaltime: 28 Jun 2019 22:36:18.5408
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: saeedm@mellanox.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DB6PR0501MB2357
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogQm9kb25nIFdhbmcgPGJvZG9uZ0BtZWxsYW5veC5jb20+DQoNCldoZW4gZHJpdmVyIGlz
IGRvaW5nIGVzd2l0Y2ggbW9kZSBjaGFuZ2UsIGl0J3MgY3JpdGljYWwgdG8ga2VlcCBudW1iZXIN
Cm9mIGVuYWJsZWQgVkZzIHVuY2hhbmdlZC4gSG93ZXZlciwgaXQgY2FuIGJlIGNoYW5nZWQgb24g
dGhlIGZseSBvbmNlDQpmdW5jdGlvbiBjaGFuZ2VkIGV2ZW50IGlzIHJlZ2lzdGVyZWQuDQoNClRv
IHJlbW92ZSB0aGlzIHVuY2VydGFpbnR5LCBmdW5jdGlvbiBjaGFuZ2VkIGV2ZW50IHNob3VsZCBu
b3QgYmUNCnJlZ2lzdGVyZWQgYmVmb3JlIGFsbCBzZXR1cHMsIGFuZCBmaXJzdCBiZSB1bnJlZ2lz
dGVyZWQgYmVmb3JlIGFsbA0KY2xlYW51cHMuIFdyYXAgdGhpcyBmdW5jdGlvbmFsaXR5IHRvZ2V0
aGVyIHdpdGggdnBvcnQgZXZlbnQgaGFuZGxlci4NCg0KRml4ZXM6IDYxZmM4ODA4MzllNiAoIm5l
dC9tbHg1OiBFLVN3aXRjaCwgSGFuZGxlIHJlcHJlc2VudG9ycyBjcmVhdGlvbiBpbiBoYW5kbGVy
IGNvbnRleHQiKQ0KU2lnbmVkLW9mZi1ieTogQm9kb25nIFdhbmcgPGJvZG9uZ0BtZWxsYW5veC5j
b20+DQpTaWduZWQtb2ZmLWJ5OiBTYWVlZCBNYWhhbWVlZCA8c2FlZWRtQG1lbGxhbm94LmNvbT4N
Ci0tLQ0KIC4uLi9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guYyB8IDMx
ICsrKysrKysrKysrKysrLS0tLS0NCiAuLi4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29y
ZS9lc3dpdGNoLmggfCAgMSArDQogLi4uL21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoX29mZmxv
YWRzLmMgICAgIHwgMjUgKy0tLS0tLS0tLS0tLS0tDQogMyBmaWxlcyBjaGFuZ2VkLCAyNiBpbnNl
cnRpb25zKCspLCAzMSBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0
aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWxsYW5veC9tbHg1L2NvcmUvZXN3aXRjaC5jDQppbmRleCBiNGY5NmYwNGExOGIuLmIyNTZm
Mzk3ZjExMiAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUv
Y29yZS9lc3dpdGNoLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUv
Y29yZS9lc3dpdGNoLmMNCkBAIC0xNzI1LDYgKzE3MjUsMjggQEAgaW50IG1seDVfZXN3X3F1ZXJ5
X2Z1bmN0aW9ucyhzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqZGV2LCB1MzIgKm91dCwgaW50IG91dGxl
bikNCiAJcmV0dXJuIG1seDVfY21kX2V4ZWMoZGV2LCBpbiwgc2l6ZW9mKGluKSwgb3V0LCBvdXRs
ZW4pOw0KIH0NCiANCitzdGF0aWMgdm9pZCBtbHg1X2Vzd2l0Y2hfZXZlbnRfaGFuZGxlcnNfcmVn
aXN0ZXIoc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3KQ0KK3sNCisJaWYgKGVzdy0+bW9kZSA9PSBN
TFg1X0VTV0lUQ0hfTEVHQUNZKSB7DQorCQlNTFg1X05CX0lOSVQoJmVzdy0+bmIsIGVzd2l0Y2hf
dnBvcnRfZXZlbnQsIE5JQ19WUE9SVF9DSEFOR0UpOw0KKwkJbWx4NV9lcV9ub3RpZmllcl9yZWdp
c3Rlcihlc3ctPmRldiwgJmVzdy0+bmIpOw0KKwl9IGVsc2UgaWYgKG1seDVfZXN3aXRjaF9pc19m
dW5jc19oYW5kbGVyKGVzdy0+ZGV2KSkgew0KKwkJTUxYNV9OQl9JTklUKCZlc3ctPmVzd19mdW5j
cy5uYiwgbWx4NV9lc3dfZnVuY3NfY2hhbmdlZF9oYW5kbGVyLA0KKwkJCSAgICAgRVNXX0ZVTkNU
SU9OU19DSEFOR0VEKTsNCisJCW1seDVfZXFfbm90aWZpZXJfcmVnaXN0ZXIoZXN3LT5kZXYsICZl
c3ctPmVzd19mdW5jcy5uYik7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQgbWx4NV9lc3dpdGNo
X2V2ZW50X2hhbmRsZXJzX3VucmVnaXN0ZXIoc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3KQ0KK3sN
CisJaWYgKGVzdy0+bW9kZSA9PSBNTFg1X0VTV0lUQ0hfTEVHQUNZKQ0KKwkJbWx4NV9lcV9ub3Rp
Zmllcl91bnJlZ2lzdGVyKGVzdy0+ZGV2LCAmZXN3LT5uYik7DQorCWVsc2UgaWYgKG1seDVfZXN3
aXRjaF9pc19mdW5jc19oYW5kbGVyKGVzdy0+ZGV2KSkNCisJCW1seDVfZXFfbm90aWZpZXJfdW5y
ZWdpc3Rlcihlc3ctPmRldiwgJmVzdy0+ZXN3X2Z1bmNzLm5iKTsNCisNCisJZmx1c2hfd29ya3F1
ZXVlKGVzdy0+d29ya19xdWV1ZSk7DQorfQ0KKw0KIC8qIFB1YmxpYyBFLVN3aXRjaCBBUEkgKi8N
CiAjZGVmaW5lIEVTV19BTExPV0VEKGVzdykgKChlc3cpICYmIE1MWDVfRVNXSVRDSF9NQU5BR0VS
KChlc3cpLT5kZXYpKQ0KIA0KQEAgLTE3ODcsMTAgKzE4MDksNyBAQCBpbnQgbWx4NV9lc3dpdGNo
X2VuYWJsZShzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csIGludCBtb2RlKQ0KIAltbHg1X2Vzd19m
b3JfZWFjaF92Zl92cG9ydChlc3csIGksIHZwb3J0LCBlc3ctPmVzd19mdW5jcy5udW1fdmZzKQ0K
IAkJZXN3X2VuYWJsZV92cG9ydChlc3csIHZwb3J0LCBlbmFibGVkX2V2ZW50cyk7DQogDQotCWlm
IChtb2RlID09IE1MWDVfRVNXSVRDSF9MRUdBQ1kpIHsNCi0JCU1MWDVfTkJfSU5JVCgmZXN3LT5u
YiwgZXN3aXRjaF92cG9ydF9ldmVudCwgTklDX1ZQT1JUX0NIQU5HRSk7DQotCQltbHg1X2VxX25v
dGlmaWVyX3JlZ2lzdGVyKGVzdy0+ZGV2LCAmZXN3LT5uYik7DQotCX0NCisJbWx4NV9lc3dpdGNo
X2V2ZW50X2hhbmRsZXJzX3JlZ2lzdGVyKGVzdyk7DQogDQogCWVzd19pbmZvKGVzdy0+ZGV2LCAi
RW5hYmxlOiBtb2RlKCVzKSwgbnZmcyglZCksIGFjdGl2ZSB2cG9ydHMoJWQpXG4iLA0KIAkJIG1v
ZGUgPT0gTUxYNV9FU1dJVENIX0xFR0FDWSA/ICJMRUdBQ1kiIDogIk9GRkxPQURTIiwNCkBAIC0x
ODI0LDkgKzE4NDMsNyBAQCB2b2lkIG1seDVfZXN3aXRjaF9kaXNhYmxlKHN0cnVjdCBtbHg1X2Vz
d2l0Y2ggKmVzdykNCiAJCSBlc3ctPmVzd19mdW5jcy5udW1fdmZzLCBlc3ctPmVuYWJsZWRfdnBv
cnRzKTsNCiANCiAJbWNfcHJvbWlzYyA9ICZlc3ctPm1jX3Byb21pc2M7DQotDQotCWlmIChlc3ct
Pm1vZGUgPT0gTUxYNV9FU1dJVENIX0xFR0FDWSkNCi0JCW1seDVfZXFfbm90aWZpZXJfdW5yZWdp
c3Rlcihlc3ctPmRldiwgJmVzdy0+bmIpOw0KKwltbHg1X2Vzd2l0Y2hfZXZlbnRfaGFuZGxlcnNf
dW5yZWdpc3Rlcihlc3cpOw0KIA0KIAltbHg1X2Vzd19mb3JfYWxsX3Zwb3J0cyhlc3csIGksIHZw
b3J0KQ0KIAkJZXN3X2Rpc2FibGVfdnBvcnQoZXN3LCB2cG9ydCk7DQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guaCBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoLmgNCmluZGV4IDc0NDM1MmJh
ZjQzNC4uYmZjMzJiY2JmNTQ0IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guaA0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guaA0KQEAgLTUyNCw2ICs1MjQsNyBAQCBtbHg1X2Vzd2l0
Y2hfZ2V0X3Zwb3J0KHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywgdTE2IHZwb3J0X251bSk7DQog
Ym9vbCBtbHg1X2Vzd2l0Y2hfaXNfdmZfdnBvcnQoY29uc3Qgc3RydWN0IG1seDVfZXN3aXRjaCAq
ZXN3LCB1MTYgdnBvcnRfbnVtKTsNCiANCiB2b2lkIG1seDVfZXN3aXRjaF91cGRhdGVfbnVtX29m
X3ZmcyhzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csIGNvbnN0IGludCBudW1fdmZzKTsNCitpbnQg
bWx4NV9lc3dfZnVuY3NfY2hhbmdlZF9oYW5kbGVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIs
IHVuc2lnbmVkIGxvbmcgdHlwZSwgdm9pZCAqZGF0YSk7DQogDQogI2Vsc2UgIC8qIENPTkZJR19N
TFg1X0VTV0lUQ0ggKi8NCiAvKiBlc3dpdGNoIEFQSSBzdHVicyAqLw0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoX29mZmxvYWRzLmMg
Yi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZXN3aXRjaF9vZmZsb2Fk
cy5jDQppbmRleCA4MDEwZTRlYWJhOWEuLjFkNzkwZDQzZTcyOSAxMDA2NDQNCi0tLSBhL2RyaXZl
cnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoX29mZmxvYWRzLmMNCisr
KyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoX29mZmxv
YWRzLmMNCkBAIC0yMDgzLDkgKzIwODMsNyBAQCBzdGF0aWMgdm9pZCBlc3dfZnVuY3Rpb25zX2No
YW5nZWRfZXZlbnRfaGFuZGxlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQogCWtmcmVlKGhv
c3Rfd29yayk7DQogfQ0KIA0KLQ0KLXN0YXRpYyBpbnQNCi1lc3dfZnVuY3Rpb25zX2NoYW5nZWRf
ZXZlbnQoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwgdW5zaWduZWQgbG9uZyB0eXBlLCB2b2lk
ICpkYXRhKQ0KK2ludCBtbHg1X2Vzd19mdW5jc19jaGFuZ2VkX2hhbmRsZXIoc3RydWN0IG5vdGlm
aWVyX2Jsb2NrICpuYiwgdW5zaWduZWQgbG9uZyB0eXBlLCB2b2lkICpkYXRhKQ0KIHsNCiAJc3Ry
dWN0IG1seDVfZXN3X2Z1bmN0aW9ucyAqZXN3X2Z1bmNzOw0KIAlzdHJ1Y3QgbWx4NV9ob3N0X3dv
cmsgKmhvc3Rfd29yazsNCkBAIC0yMTA2LDI0ICsyMTA0LDYgQEAgZXN3X2Z1bmN0aW9uc19jaGFu
Z2VkX2V2ZW50KHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIsIHVuc2lnbmVkIGxvbmcgdHlwZSwg
dm9pZA0KIAlyZXR1cm4gTk9USUZZX09LOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBlc3dfZnVuY3Rp
b25zX2NoYW5nZWRfZXZlbnRfaW5pdChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3cpDQotew0KLQlp
ZiAobWx4NV9lc3dpdGNoX2lzX2Z1bmNzX2hhbmRsZXIoZXN3LT5kZXYpKSB7DQotCQlNTFg1X05C
X0lOSVQoJmVzdy0+ZXN3X2Z1bmNzLm5iLCBlc3dfZnVuY3Rpb25zX2NoYW5nZWRfZXZlbnQsDQot
CQkJICAgICBFU1dfRlVOQ1RJT05TX0NIQU5HRUQpOw0KLQkJbWx4NV9lcV9ub3RpZmllcl9yZWdp
c3Rlcihlc3ctPmRldiwgJmVzdy0+ZXN3X2Z1bmNzLm5iKTsNCi0JfQ0KLX0NCi0NCi1zdGF0aWMg
dm9pZCBlc3dfZnVuY3Rpb25zX2NoYW5nZWRfZXZlbnRfY2xlYW51cChzdHJ1Y3QgbWx4NV9lc3dp
dGNoICplc3cpDQotew0KLQlpZiAoIW1seDVfZXN3aXRjaF9pc19mdW5jc19oYW5kbGVyKGVzdy0+
ZGV2KSkNCi0JCXJldHVybjsNCi0NCi0JbWx4NV9lcV9ub3RpZmllcl91bnJlZ2lzdGVyKGVzdy0+
ZGV2LCAmZXN3LT5lc3dfZnVuY3MubmIpOw0KLQlmbHVzaF93b3JrcXVldWUoZXN3LT53b3JrX3F1
ZXVlKTsNCi19DQotDQogaW50IGVzd19vZmZsb2Fkc19pbml0KHN0cnVjdCBtbHg1X2Vzd2l0Y2gg
KmVzdykNCiB7DQogCWludCBlcnI7DQpAQCAtMjE0NCw4ICsyMTI0LDYgQEAgaW50IGVzd19vZmZs
b2Fkc19pbml0KHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdykNCiANCiAJZXN3X29mZmxvYWRzX2Rl
dmNvbV9pbml0KGVzdyk7DQogDQotCWVzd19mdW5jdGlvbnNfY2hhbmdlZF9ldmVudF9pbml0KGVz
dyk7DQotDQogCW1seDVfcmRtYV9lbmFibGVfcm9jZShlc3ctPmRldik7DQogDQogCXJldHVybiAw
Ow0KQEAgLTIxNzksNyArMjE1Nyw2IEBAIHN0YXRpYyBpbnQgZXN3X29mZmxvYWRzX3N0b3Aoc3Ry
dWN0IG1seDVfZXN3aXRjaCAqZXN3LA0KIA0KIHZvaWQgZXN3X29mZmxvYWRzX2NsZWFudXAoc3Ry
dWN0IG1seDVfZXN3aXRjaCAqZXN3KQ0KIHsNCi0JZXN3X2Z1bmN0aW9uc19jaGFuZ2VkX2V2ZW50
X2NsZWFudXAoZXN3KTsNCiAJbWx4NV9yZG1hX2Rpc2FibGVfcm9jZShlc3ctPmRldik7DQogCWVz
d19vZmZsb2Fkc19kZXZjb21fY2xlYW51cChlc3cpOw0KIAllc3dfb2ZmbG9hZHNfdW5sb2FkX2Fs
bF9yZXBzKGVzdyk7DQotLSANCjIuMjEuMA0KDQo=
