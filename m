Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 3837345497
	for <lists+netdev@lfdr.de>; Fri, 14 Jun 2019 08:19:00 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1725807AbfFNGS6 (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 14 Jun 2019 02:18:58 -0400
Received: from mx0b-00082601.pphosted.com ([67.231.153.30]:42314 "EHLO
        mx0b-00082601.pphosted.com" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S1725774AbfFNGS5 (ORCPT
        <rfc822;netdev@vger.kernel.org>); Fri, 14 Jun 2019 02:18:57 -0400
Received: from pps.filterd (m0109331.ppops.net [127.0.0.1])
        by mx0a-00082601.pphosted.com (8.16.0.27/8.16.0.27) with SMTP id x5E67ttf010052;
        Thu, 13 Jun 2019 23:18:23 -0700
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=fb.com; h=from : to : cc : subject
 : date : message-id : references : in-reply-to : content-type : content-id
 : content-transfer-encoding : mime-version; s=facebook;
 bh=wNz8vqp+4Wrd/WEI+MLHcUfXXZe/FQdZ3AFw1ho9YGU=;
 b=NmI2NecEBwukGrk0Xk51F2dUNsjYsAYlR1BJjTDxKCcy1IAQ3Vjn6EHDseb+shxusXTA
 garHDbKxKz0VpV372T+KN6ltUiSLioocmLr9kqQV6rKIV8qfrHhE0g5aR0FXEJ8l8xSC
 HM06mhnGo4tOtUf9ip6hqfxQQ07frqnXfbw= 
Received: from mail.thefacebook.com (mailout.thefacebook.com [199.201.64.23])
        by mx0a-00082601.pphosted.com with ESMTP id 2t43tpravk-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-SHA384 bits=256 verify=NOT);
        Thu, 13 Jun 2019 23:18:23 -0700
Received: from prn-mbx02.TheFacebook.com (2620:10d:c081:6::16) by
 prn-hub03.TheFacebook.com (2620:10d:c081:35::127) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.1.1713.5; Thu, 13 Jun 2019 23:18:22 -0700
Received: from prn-hub05.TheFacebook.com (2620:10d:c081:35::129) by
 prn-mbx02.TheFacebook.com (2620:10d:c081:6::16) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.1.1713.5; Thu, 13 Jun 2019 23:18:20 -0700
Received: from NAM04-SN1-obe.outbound.protection.outlook.com (192.168.54.28)
 by o365-in.thefacebook.com (192.168.16.29) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.1.1713.5
 via Frontend Transport; Thu, 13 Jun 2019 23:18:20 -0700
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=fb.onmicrosoft.com;
 s=selector1-fb-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=wNz8vqp+4Wrd/WEI+MLHcUfXXZe/FQdZ3AFw1ho9YGU=;
 b=XHXsRC09s2oS8LWolLGkPiyax/Tia2JVy+A4rF3o9Je6Q4xrcUTvIKqAXqaekiRvriOwndj0A1JJ/co034T2wbU4eKy2bsuWkKmhgJG5Q3LeJHzraNzFU760A17VczdDuKt3V2yKLiK8Snbwcs/zqHvpvsdHkpdQLClbEfsvsAw=
Received: from BYAPR15MB2501.namprd15.prod.outlook.com (52.135.196.11) by
 BYAPR15MB2519.namprd15.prod.outlook.com (20.179.154.156) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1987.11; Fri, 14 Jun 2019 06:18:18 +0000
Received: from BYAPR15MB2501.namprd15.prod.outlook.com
 ([fe80::60a3:8bdd:1ea2:3702]) by BYAPR15MB2501.namprd15.prod.outlook.com
 ([fe80::60a3:8bdd:1ea2:3702%7]) with mapi id 15.20.1987.012; Fri, 14 Jun 2019
 06:18:18 +0000
From:   Alexei Starovoitov <ast@fb.com>
To:     Andrii Nakryiko <andrii.nakryiko@gmail.com>,
        Alexei Starovoitov <ast@kernel.org>
CC:     "David S. Miller" <davem@davemloft.net>,
        Daniel Borkmann <daniel@iogearbox.net>,
        Jakub Kicinski <jakub.kicinski@netronome.com>,
        Edward Cree <ecree@solarflare.com>,
        john fastabend <john.fastabend@gmail.com>,
        Andrii Nakryiko <andriin@fb.com>, Jann Horn <jannh@google.com>,
        Networking <netdev@vger.kernel.org>, bpf <bpf@vger.kernel.org>,
        Kernel Team <Kernel-team@fb.com>
Subject: Re: [PATCH bpf-next 4/9] bpf: introduce bounded loops
Thread-Topic: [PATCH bpf-next 4/9] bpf: introduce bounded loops
Thread-Index: AQHVIZ9xdXjcv6PTSkCwO0c6biIlkaaaNW0AgAB5OIA=
Date:   Fri, 14 Jun 2019 06:18:18 +0000
Message-ID: <b7328982-1e08-e2bc-8e79-4e0e5828d19e@fb.com>
References: <20190613042003.3791852-1-ast@kernel.org>
 <20190613042003.3791852-5-ast@kernel.org>
 <CAEf4Bzb43AzO1+tg8n8u7KSxe1De3y4Sau4cy+=NQ-m6RCU_Gg@mail.gmail.com>
In-Reply-To: <CAEf4Bzb43AzO1+tg8n8u7KSxe1De3y4Sau4cy+=NQ-m6RCU_Gg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: MWHPR1301CA0015.namprd13.prod.outlook.com
 (2603:10b6:301:29::28) To BYAPR15MB2501.namprd15.prod.outlook.com
 (2603:10b6:a02:88::11)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [2620:10d:c090:180::1:f6f1]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 4c52f23f-d7ac-4f42-3727-08d6f090171a
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);SRVR:BYAPR15MB2519;
x-ms-traffictypediagnostic: BYAPR15MB2519:
x-ms-exchange-purlcount: 2
x-microsoft-antispam-prvs: <BYAPR15MB2519C2A7EF362BF8D3E72BC7D7EE0@BYAPR15MB2519.namprd15.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:7691;
x-forefront-prvs: 0068C7E410
x-forefront-antispam-report: SFV:NSPM;SFS:(10019020)(346002)(366004)(396003)(376002)(136003)(39860400002)(189003)(199004)(14444005)(68736007)(486006)(2616005)(53936002)(110136005)(54906003)(6436002)(6306002)(6512007)(316002)(305945005)(53946003)(229853002)(7416002)(6246003)(11346002)(8936002)(8676002)(81156014)(81166006)(6116002)(446003)(476003)(256004)(6486002)(71190400001)(7736002)(53546011)(76176011)(386003)(36756003)(31696002)(6506007)(71200400001)(52116002)(102836004)(46003)(186003)(478600001)(99286004)(25786009)(73956011)(4326008)(30864003)(31686004)(66476007)(66556008)(14454004)(64756008)(66946007)(66446008)(2906002)(966005)(5660300002)(86362001)(579004);DIR:OUT;SFP:1102;SCL:1;SRVR:BYAPR15MB2519;H:BYAPR15MB2501.namprd15.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: fb.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: UShi1IfLJuaSIJpg7Flybyp1+a9NDtVgs3bV/LuHNVpWBWCpavF3dw5hi7eDJsFQUdeBl57y139sjHJ1xLFmQYxEZUEW0yXTpeRjoui0WmMu+/9ztPK/9FUyu0ZSI0xPoaSf3IJUzO0jiNaOQfP1S2UZU9VcP+/VSEpECq4hnHmhqbX5thCc4PlIgr6ePbEsb5rQ3N+b0nGufsUlnlmI0L8TWvjMrwKUyCEFJByBL16CEPKP3mU7C6JQnqJ+03hnHJ3oXCzgA7gHsxh8MKlMdaq3F4D3ET3ux4x+Cc3xMS9GyUScWktzTKzS2rr8kADIpEJY53OTp/U65K6TNgAJLB2hB+ifyyARvi3AtkVhMneOguflKgYpD8b556xHfXmbuVB+F03p42igBYjf33nzL3lON7Eyx0TP3wsK870Y4nw=
Content-Type: text/plain; charset="utf-8"
Content-ID: <829574E5FFD2DC42890BD6AB1A1A9938@namprd15.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: 4c52f23f-d7ac-4f42-3727-08d6f090171a
X-MS-Exchange-CrossTenant-originalarrivaltime: 14 Jun 2019 06:18:18.1009
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 8ae927fe-1255-47a7-a2af-5f3a069daaa2
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ast@fb.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BYAPR15MB2519
X-OriginatorOrg: fb.com
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:,, definitions=2019-06-14_04:,,
 signatures=0
X-Proofpoint-Spam-Details: rule=fb_default_notspam policy=fb_default score=0 priorityscore=1501
 malwarescore=0 suspectscore=0 phishscore=0 bulkscore=0 spamscore=0
 clxscore=1015 lowpriorityscore=0 mlxscore=0 impostorscore=0
 mlxlogscore=999 adultscore=0 classifier=spam adjust=0 reason=mlx
 scancount=1 engine=8.0.1-1810050000 definitions=main-1906140051
X-FB-Internal: deliver
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

T24gNi8xMy8xOSA0OjA0IFBNLCBBbmRyaWkgTmFrcnlpa28gd3JvdGU6DQo+IE9uIFRodSwgSnVu
IDEzLCAyMDE5IGF0IDk6NDkgQU0gQWxleGVpIFN0YXJvdm9pdG92IDxhc3RAa2VybmVsLm9yZz4g
d3JvdGU6DQo+Pg0KPj4gQWxsb3cgdGhlIHZlcmlmaWVyIHRvIHZhbGlkYXRlIHRoZSBsb29wcyBi
eSBzaW11bGF0aW5nIHRoZWlyIGV4ZWN1dGlvbi4NCj4+IEV4aXNpdGluZyBwcm9ncmFtcyBoYXZl
IHVzZWQgJyNwcmFnbWEgdW5yb2xsJyB0byB1bnJvbGwgdGhlIGxvb3BzDQo+PiBieSB0aGUgY29t
cGlsZXIuIEluc3RlYWQgbGV0IHRoZSB2ZXJpZmllciBzaW11bGF0ZSBhbGwgaXRlcmF0aW9ucw0K
Pj4gb2YgdGhlIGxvb3AuDQo+PiBJbiBvcmRlciB0byBkbyB0aGF0IGludHJvZHVjZSBwYXJlbnRh
Z2UgY2hhaW4gb2YgYnBmX3ZlcmlmaWVyX3N0YXRlIGFuZA0KPj4gJ2JyYW5jaGVzJyBjb3VudGVy
IGZvciB0aGUgbnVtYmVyIG9mIGJyYW5jaGVzIGxlZnQgdG8gZXhwbG9yZS4NCj4+IFNlZSBtb3Jl
IGRldGFpbGVkIGFsZ29yaXRobSBkZXNjcmlwdGlvbiBpbiBicGZfdmVyaWZpZXIuaA0KPj4NCj4+
IFRoaXMgYWxnb3JpdGhtIGJvcnJvd3MgdGhlIGtleSBpZGVhIGZyb20gRWR3YXJkIENyZWUgYXBw
cm9hY2g6DQo+PiBodHRwczovL3VybGRlZmVuc2UucHJvb2Zwb2ludC5jb20vdjIvdXJsP3U9aHR0
cHMtM0FfX3BhdGNod29yay5vemxhYnMub3JnX3BhdGNoXzg3NzIyMl8mZD1Ed0lCYVEmYz01VkQw
UlR0TmxUaDN5Y2Q0MWIzTVV3JnI9aTZXb2JLeGJlRzNzbHpIU0lPeFRWdFlJSnc3cWpDRTZTMHNw
RFRLTC1KNCZtPU1lY1RaZ3BjRXdTUzg0clpGa25FSWdTYllhQzBLeXBiUnBEZEU3dVF0bDQmcz1U
WHBiLUFlbUg4WElHMUdsWUk2ZmxWbUVrWHdxcE9DWkpGeXNTRnRMYkwwJmU9DQo+PiBBZGRpdGlv
bmFsIHN0YXRlIHBydW5pbmcgaGV1cmlzdGljcyBtYWtlIHN1Y2ggYnJ1dGUgZm9yY2UgbG9vcCB3
YWxrDQo+PiBwcmFjdGljYWwgZXZlbiBmb3IgbGFyZ2UgbG9vcHMuDQo+Pg0KPj4gU2lnbmVkLW9m
Zi1ieTogQWxleGVpIFN0YXJvdm9pdG92IDxhc3RAa2VybmVsLm9yZz4NCj4+IC0tLQ0KPiANCj4g
TEdUTSwgZmV3IHN1Z2dlc3Rpb25zIGJlbG93Lg0KPiANCj4gQWNrZWQtYnk6IEFuZHJpaSBOYWty
eWlrbyA8YW5kcmlpbkBmYi5jb20+DQo+IA0KPj4gICBpbmNsdWRlL2xpbnV4L2JwZl92ZXJpZmll
ci5oIHwgIDUxICsrKysrKysrKysrKystDQo+PiAgIGtlcm5lbC9icGYvdmVyaWZpZXIuYyAgICAg
ICAgfCAxMzMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0NCj4+ICAgMiBmaWxl
cyBjaGFuZ2VkLCAxNzUgaW5zZXJ0aW9ucygrKSwgOSBkZWxldGlvbnMoLSkNCj4+DQo+PiBkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9saW51eC9icGZfdmVyaWZpZXIuaCBiL2luY2x1ZGUvbGludXgvYnBm
X3ZlcmlmaWVyLmgNCj4+IGluZGV4IDcwNGVkNzk3MTQ3Mi4uMDMwMzczNzNiNDQ3IDEwMDY0NA0K
Pj4gLS0tIGEvaW5jbHVkZS9saW51eC9icGZfdmVyaWZpZXIuaA0KPj4gKysrIGIvaW5jbHVkZS9s
aW51eC9icGZfdmVyaWZpZXIuaA0KPj4gQEAgLTE5NCw2ICsxOTQsNTMgQEAgc3RydWN0IGJwZl9m
dW5jX3N0YXRlIHsNCj4+ICAgc3RydWN0IGJwZl92ZXJpZmllcl9zdGF0ZSB7DQo+PiAgICAgICAg
ICAvKiBjYWxsIHN0YWNrIHRyYWNraW5nICovDQo+PiAgICAgICAgICBzdHJ1Y3QgYnBmX2Z1bmNf
c3RhdGUgKmZyYW1lW01BWF9DQUxMX0ZSQU1FU107DQo+PiArICAgICAgIHN0cnVjdCBicGZfdmVy
aWZpZXJfc3RhdGUgKnBhcmVudDsNCj4+ICsgICAgICAgLyoNCj4+ICsgICAgICAgICogJ2JyYW5j
aGVzJyBmaWVsZCBpcyB0aGUgbnVtYmVyIG9mIGJyYW5jaGVzIGxlZnQgdG8gZXhwbG9yZToNCj4+
ICsgICAgICAgICogMCAtIGFsbCBwb3NzaWJsZSBwYXRocyBmcm9tIHRoaXMgc3RhdGUgcmVhY2hl
ZCBicGZfZXhpdCBvcg0KPj4gKyAgICAgICAgKiB3ZXJlIHNhZmVseSBwcnVuZWQNCj4+ICsgICAg
ICAgICogMSAtIGF0IGxlYXN0IG9uZSBwYXRoIGlzIGJlaW5nIGV4cGxvcmVkLg0KPj4gKyAgICAg
ICAgKiBUaGlzIHN0YXRlIGhhc24ndCByZWFjaGVkIGJwZl9leGl0DQo+PiArICAgICAgICAqIDIg
LSBhdCBsZWFzdCB0d28gcGF0aHMgYXJlIGJlaW5nIGV4cGxvcmVkLg0KPj4gKyAgICAgICAgKiBU
aGlzIHN0YXRlIGlzIGFuIGltbWVkaWF0ZSBwYXJlbnQgb2YgdHdvIGNoaWxkcmVuLg0KPj4gKyAg
ICAgICAgKiBPbmUgaXMgZmFsbHRocm91Z2ggYnJhbmNoIHdpdGggYnJhbmNoZXM9PTEgYW5kIGFu
b3RoZXINCj4+ICsgICAgICAgICogc3RhdGUgaXMgcHVzaGVkIGludG8gc3RhY2sgKHRvIGJlIGV4
cGxvcmVkIGxhdGVyKSBhbHNvIHdpdGgNCj4+ICsgICAgICAgICogYnJhbmNoZXM9PTEuIFRoZSBw
YXJlbnQgb2YgdGhpcyBzdGF0ZSBoYXMgYnJhbmNoZXM9PTEuDQo+PiArICAgICAgICAqIFRoZSB2
ZXJpZmllciBzdGF0ZSB0cmVlIGNvbm5lY3RlZCB2aWEgJ3BhcmVudCcgcG9pbnRlciBsb29rcyBs
aWtlOg0KPj4gKyAgICAgICAgKiAxDQo+PiArICAgICAgICAqIDENCj4+ICsgICAgICAgICogMiAt
PiAxIChmaXJzdCAnaWYnIHB1c2hlZCBpbnRvIHN0YWNrKQ0KPj4gKyAgICAgICAgKiAxDQo+PiAr
ICAgICAgICAqIDIgLT4gMSAoc2Vjb25kICdpZicgcHVzaGVkIGludG8gc3RhY2spDQo+PiArICAg
ICAgICAqIDENCj4+ICsgICAgICAgICogMQ0KPj4gKyAgICAgICAgKiAxIGJwZl9leGl0Lg0KPj4g
KyAgICAgICAgKg0KPj4gKyAgICAgICAgKiBPbmNlIGRvX2NoZWNrKCkgcmVhY2hlcyBicGZfZXhp
dCwgaXQgY2FsbHMgdXBkYXRlX2JyYW5jaF9jb3VudHMoKQ0KPj4gKyAgICAgICAgKiBhbmQgdGhl
IHZlcmlmaWVyIHN0YXRlIHRyZWUgd2lsbCBsb29rOg0KPj4gKyAgICAgICAgKiAxDQo+PiArICAg
ICAgICAqIDENCj4+ICsgICAgICAgICogMiAtPiAxIChmaXJzdCAnaWYnIHB1c2hlZCBpbnRvIHN0
YWNrKQ0KPj4gKyAgICAgICAgKiAxDQo+PiArICAgICAgICAqIDEgLT4gMSAoc2Vjb25kICdpZicg
cHVzaGVkIGludG8gc3RhY2spDQo+PiArICAgICAgICAqIDANCj4+ICsgICAgICAgICogMA0KPj4g
KyAgICAgICAgKiAwIGJwZl9leGl0Lg0KPj4gKyAgICAgICAgKiBBZnRlciBwb3Bfc3RhY2soKSB0
aGUgZG9fY2hlY2soKSB3aWxsIHJlc3VtZSBhdCBzZWNvbmQgJ2lmJy4NCj4+ICsgICAgICAgICoN
Cj4+ICsgICAgICAgICogSWYgaXNfc3RhdGVfdmlzaXRlZCgpIHNlZXMgYSBzdGF0ZSB3aXRoIGJy
YW5jaGVzID4gMCBpdCBtZWFucw0KPj4gKyAgICAgICAgKiB0aGVyZSBpcyBhIGxvb3AuIElmIHN1
Y2ggc3RhdGUgaXMgZXhhY3RseSBlcXVhbCB0byB0aGUgY3VycmVudCBzdGF0ZQ0KPj4gKyAgICAg
ICAgKiBpdCdzIGFuIGluZmluaXRlIGxvb3AuIE5vdGUgc3RhdGVzX2VxdWFsKCkgY2hlY2tzIGZv
ciBzdGF0ZXMNCj4+ICsgICAgICAgICogZXF1dmFsZW5jeSwgc28gdHdvIHN0YXRlcyBiZWluZyAn
c3RhdGVzX2VxdWFsJyBkb2VzIG5vdCBtZWFuDQo+PiArICAgICAgICAqIGluZmluaXRlIGxvb3Au
IFRoZSBleGFjdCBjb21wYXJpc29uIGlzIHByb3ZpZGVkIGJ5DQo+PiArICAgICAgICAqIHN0YXRl
c19tYXliZV9sb29waW5nKCkgZnVuY3Rpb24uIEl0J3MgYSBzdHJvbmdlciBwcmUtY2hlY2sgYW5k
DQo+PiArICAgICAgICAqIG11Y2ggZmFzdGVyIHRoYW4gc3RhdGVzX2VxdWFsKCkuDQo+PiArICAg
ICAgICAqDQo+PiArICAgICAgICAqIFRoaXMgYWxnb3JpdGhtIG1heSBub3QgZmluZCBhbGwgcG9z
c2libGUgaW5maW5pdGUgbG9vcHMgb3INCj4+ICsgICAgICAgICogbG9vcCBpdGVyYXRpb24gY291
bnQgbWF5IGJlIHRvbyBoaWdoLg0KPj4gKyAgICAgICAgKiBJbiBzdWNoIGNhc2VzIEJQRl9DT01Q
TEVYSVRZX0xJTUlUX0lOU05TIGxpbWl0IGtpY2tzIGluLg0KPj4gKyAgICAgICAgKi8NCj4+ICsg
ICAgICAgdTMyIGJyYW5jaGVzOw0KPj4gICAgICAgICAgdTMyIGluc25faWR4Ow0KPj4gICAgICAg
ICAgdTMyIGN1cmZyYW1lOw0KPj4gICAgICAgICAgdTMyIGFjdGl2ZV9zcGluX2xvY2s7DQo+PiBA
QCAtMzEyLDcgKzM1OSw5IEBAIHN0cnVjdCBicGZfdmVyaWZpZXJfZW52IHsNCj4+ICAgICAgICAg
IH0gY2ZnOw0KPj4gICAgICAgICAgdTMyIHN1YnByb2dfY250Ow0KPj4gICAgICAgICAgLyogbnVt
YmVyIG9mIGluc3RydWN0aW9ucyBhbmFseXplZCBieSB0aGUgdmVyaWZpZXIgKi8NCj4+IC0gICAg
ICAgdTMyIGluc25fcHJvY2Vzc2VkOw0KPj4gKyAgICAgICB1MzIgcHJldl9pbnNuX3Byb2Nlc3Nl
ZCwgaW5zbl9wcm9jZXNzZWQ7DQo+PiArICAgICAgIC8qIG51bWJlciBvZiBqbXBzLCBjYWxscywg
ZXhpdHMgYW5hbHl6ZWQgc28gZmFyICovDQo+PiArICAgICAgIHUzMiBwcmV2X2ptcHNfcHJvY2Vz
c2VkLCBqbXBzX3Byb2Nlc3NlZDsNCj4+ICAgICAgICAgIC8qIHRvdGFsIHZlcmlmaWNhdGlvbiB0
aW1lICovDQo+PiAgICAgICAgICB1NjQgdmVyaWZpY2F0aW9uX3RpbWU7DQo+PiAgICAgICAgICAv
KiBtYXhpbXVtIG51bWJlciBvZiB2ZXJpZmllciBzdGF0ZXMga2VwdCBpbiAnYnJhbmNoaW5nJyBp
bnN0cnVjdGlvbnMgKi8NCj4+IGRpZmYgLS1naXQgYS9rZXJuZWwvYnBmL3ZlcmlmaWVyLmMgYi9r
ZXJuZWwvYnBmL3ZlcmlmaWVyLmMNCj4+IGluZGV4IGM3OWMwOTU4NmE5ZS4uNTVkNWFiNGFiODNl
IDEwMDY0NA0KPj4gLS0tIGEva2VybmVsL2JwZi92ZXJpZmllci5jDQo+PiArKysgYi9rZXJuZWwv
YnBmL3ZlcmlmaWVyLmMNCj4+IEBAIC03MjEsNiArNzIxLDggQEAgc3RhdGljIGludCBjb3B5X3Zl
cmlmaWVyX3N0YXRlKHN0cnVjdCBicGZfdmVyaWZpZXJfc3RhdGUgKmRzdF9zdGF0ZSwNCj4+ICAg
ICAgICAgIGRzdF9zdGF0ZS0+c3BlY3VsYXRpdmUgPSBzcmMtPnNwZWN1bGF0aXZlOw0KPj4gICAg
ICAgICAgZHN0X3N0YXRlLT5jdXJmcmFtZSA9IHNyYy0+Y3VyZnJhbWU7DQo+PiAgICAgICAgICBk
c3Rfc3RhdGUtPmFjdGl2ZV9zcGluX2xvY2sgPSBzcmMtPmFjdGl2ZV9zcGluX2xvY2s7DQo+PiAr
ICAgICAgIGRzdF9zdGF0ZS0+YnJhbmNoZXMgPSBzcmMtPmJyYW5jaGVzOw0KPj4gKyAgICAgICBk
c3Rfc3RhdGUtPnBhcmVudCA9IHNyYy0+cGFyZW50Ow0KPj4gICAgICAgICAgZm9yIChpID0gMDsg
aSA8PSBzcmMtPmN1cmZyYW1lOyBpKyspIHsNCj4+ICAgICAgICAgICAgICAgICAgZHN0ID0gZHN0
X3N0YXRlLT5mcmFtZVtpXTsNCj4+ICAgICAgICAgICAgICAgICAgaWYgKCFkc3QpIHsNCj4+IEBA
IC03MzYsNiArNzM4LDIzIEBAIHN0YXRpYyBpbnQgY29weV92ZXJpZmllcl9zdGF0ZShzdHJ1Y3Qg
YnBmX3ZlcmlmaWVyX3N0YXRlICpkc3Rfc3RhdGUsDQo+PiAgICAgICAgICByZXR1cm4gMDsNCj4+
ICAgfQ0KPj4NCj4+ICtzdGF0aWMgdm9pZCB1cGRhdGVfYnJhbmNoX2NvdW50cyhzdHJ1Y3QgYnBm
X3ZlcmlmaWVyX2VudiAqZW52LCBzdHJ1Y3QgYnBmX3ZlcmlmaWVyX3N0YXRlICpzdCkNCj4+ICt7
DQo+PiArICAgICAgIHdoaWxlIChzdCkgew0KPj4gKyAgICAgICAgICAgICAgIHUzMiBiciA9IC0t
c3QtPmJyYW5jaGVzOw0KPj4gKw0KPj4gKyAgICAgICAgICAgICAgIC8qIFdBUk5fT04oYnIgPiAx
KSB0ZWNobmljYWxseSBtYWtlcyBzZW5zZSBoZXJlLA0KPj4gKyAgICAgICAgICAgICAgICAqIGJ1
dCBzZWUgY29tbWVudCBpbiBwdXNoX3N0YWNrKCksIGhlbmNlOg0KPj4gKyAgICAgICAgICAgICAg
ICAqLw0KPj4gKyAgICAgICAgICAgICAgIFdBUk5fT05DRSgoaW50KWJyIDwgMCwNCj4+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgIkJVRyB1cGRhdGVfYnJhbmNoX2NvdW50czpicmFuY2hlc190
b19leHBsb3JlPSVkXG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBicik7DQo+PiAr
ICAgICAgICAgICAgICAgaWYgKGJyKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
DQo+PiArICAgICAgICAgICAgICAgc3QgPSBzdC0+cGFyZW50Ow0KPj4gKyAgICAgICB9DQo+PiAr
fQ0KPj4gKw0KPj4gICBzdGF0aWMgaW50IHBvcF9zdGFjayhzdHJ1Y3QgYnBmX3ZlcmlmaWVyX2Vu
diAqZW52LCBpbnQgKnByZXZfaW5zbl9pZHgsDQo+PiAgICAgICAgICAgICAgICAgICAgICAgaW50
ICppbnNuX2lkeCkNCj4+ICAgew0KPj4gQEAgLTc4OSw2ICs4MDgsMTggQEAgc3RhdGljIHN0cnVj
dCBicGZfdmVyaWZpZXJfc3RhdGUgKnB1c2hfc3RhY2soc3RydWN0IGJwZl92ZXJpZmllcl9lbnYg
KmVudiwNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBlbnYtPnN0YWNrX3NpemUpOw0KPj4g
ICAgICAgICAgICAgICAgICBnb3RvIGVycjsNCj4+ICAgICAgICAgIH0NCj4+ICsgICAgICAgaWYg
KGVsZW0tPnN0LnBhcmVudCkgew0KPj4gKyAgICAgICAgICAgICAgICsrZWxlbS0+c3QucGFyZW50
LT5icmFuY2hlczsNCj4+ICsgICAgICAgICAgICAgICAvKiBXQVJOX09OKGJyYW5jaGVzID4gMikg
dGVjaG5pY2FsbHkgbWFrZXMgc2Vuc2UgaGVyZSwNCj4+ICsgICAgICAgICAgICAgICAgKiBidXQN
Cj4+ICsgICAgICAgICAgICAgICAgKiAxLiBzcGVjdWxhdGl2ZSBzdGF0ZXMgd2lsbCBidW1wICdi
cmFuY2hlcycgZm9yIG5vbi1icmFuY2gNCj4+ICsgICAgICAgICAgICAgICAgKiBpbnN0cnVjdGlv
bnMNCj4+ICsgICAgICAgICAgICAgICAgKiAyLiBpc19zdGF0ZV92aXNpdGVkKCkgaGV1cmlzdGlj
cyBtYXkgZGVjaWRlIG5vdCB0byBjcmVhdGUNCj4+ICsgICAgICAgICAgICAgICAgKiBhIG5ldyBz
dGF0ZSBmb3IgYSBzZXF1ZW5jZSBvZiBicmFuY2hlcyBhbmQgYWxsIHN1Y2ggY3VycmVudA0KPj4g
KyAgICAgICAgICAgICAgICAqIGFuZCBjbG9uZWQgc3RhdGVzIHdpbGwgYmUgcG9pbnRpbmcgdG8g
YSBzaW5nbGUgcGFyZW50IHN0YXRlDQo+PiArICAgICAgICAgICAgICAgICogd2hpY2ggbWlnaHQg
aGF2ZSBsYXJnZSAnYnJhbmNoZXMnIGNvdW50Lg0KPj4gKyAgICAgICAgICAgICAgICAqLw0KPj4g
KyAgICAgICB9DQo+PiAgICAgICAgICByZXR1cm4gJmVsZW0tPnN0Ow0KPj4gICBlcnI6DQo+PiAg
ICAgICAgICBmcmVlX3ZlcmlmaWVyX3N0YXRlKGVudi0+Y3VyX3N0YXRlLCB0cnVlKTsNCj4+IEBA
IC01Njg1LDcgKzU3MTYsOCBAQCBzdGF0aWMgdm9pZCBpbml0X2V4cGxvcmVkX3N0YXRlKHN0cnVj
dCBicGZfdmVyaWZpZXJfZW52ICplbnYsIGludCBpZHgpDQo+PiAgICAqIHcgLSBuZXh0IGluc3Ry
dWN0aW9uDQo+PiAgICAqIGUgLSBlZGdlDQo+PiAgICAqLw0KPj4gLXN0YXRpYyBpbnQgcHVzaF9p
bnNuKGludCB0LCBpbnQgdywgaW50IGUsIHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYpDQo+
PiArc3RhdGljIGludCBwdXNoX2luc24oaW50IHQsIGludCB3LCBpbnQgZSwgc3RydWN0IGJwZl92
ZXJpZmllcl9lbnYgKmVudiwNCj4+ICsgICAgICAgICAgICAgICAgICAgIGJvb2wgbG9vcF9vaykN
Cj4+ICAgew0KPj4gICAgICAgICAgaW50ICppbnNuX3N0YWNrID0gZW52LT5jZmcuaW5zbl9zdGFj
azsNCj4+ICAgICAgICAgIGludCAqaW5zbl9zdGF0ZSA9IGVudi0+Y2ZnLmluc25fc3RhdGU7DQo+
PiBAQCAtNTcxNSw2ICs1NzQ3LDggQEAgc3RhdGljIGludCBwdXNoX2luc24oaW50IHQsIGludCB3
LCBpbnQgZSwgc3RydWN0IGJwZl92ZXJpZmllcl9lbnYgKmVudikNCj4+ICAgICAgICAgICAgICAg
ICAgaW5zbl9zdGFja1tlbnYtPmNmZy5jdXJfc3RhY2srK10gPSB3Ow0KPj4gICAgICAgICAgICAg
ICAgICByZXR1cm4gMTsNCj4+ICAgICAgICAgIH0gZWxzZSBpZiAoKGluc25fc3RhdGVbd10gJiAw
eEYwKSA9PSBESVNDT1ZFUkVEKSB7DQo+PiArICAgICAgICAgICAgICAgaWYgKGxvb3Bfb2sgJiYg
ZW52LT5hbGxvd19wdHJfbGVha3MpDQo+IA0KPiBhbGxvd19wdHJfbGVha3MgaXMgdXNlZCBhcyBh
IHByb3h5IGZvciBTWVNfQ0FQX0FETUlOLCByaWdodD8gTWF5YmUNCj4gaGF2ZSBleHBsaWNpdCBl
bnYtPmFsbG93X2xvb3BzIGluc3RlYWQuIFRoYXQgd291bGQgbWFrZSBtb3JlIHNlbnNlDQo+IHdo
ZW4gcmVhZGluZyBjb2RlLiBQbHVzLCBpdCB3b3VsZCBkZWNvdXBsZSBsb29wIGVuYWJsZW1lbnQg
ZnJvbQ0KPiBTWVNfQ0FQX0FETUlOLCBzbyB3b3VsZCBhbGxvdyBtb3JlIGZpbmUtZ3JhaW5lZCBj
b250cm9sLCBpZiBuZWNlc3NhcnkuDQoNClJpZ2h0LiBJIHdhcyB0aGlua2luZyBhYm91dCBzcGxp
dHRpbmcgYWxsb3dfcHRyX2xlYWtzLCBidXQNCm5vdCBpbiB0aGlzIHNldC4gQW5kIGZvciBhIGRp
ZmZlcmVudCByZWFzb24uDQpJJ2QgbGlrZSB0byBoYXZlIGFuIGFiaWxpdHkgdG8gaGF2ZSBkaWZm
ZXJlbnQgdmVyaWZpZXIgYW5hbHlzaXMgcGhhc2VzDQp0byBiZSBhdmFpbGFibGUgdmlhIHNvbWUg
c29ydCBvZiBkZWJ1ZyBhcGkgdGhhdCBpcyBub3QgcXVpdGUgdWFwaS4NClRvIGJlIGFibGUgdG8g
dXNlIHRoYXQgZnJvbSBzZWxmdGVzdHMuDQoNCg0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIDA7DQo+PiAgICAgICAgICAgICAgICAgIHZlcmJvc2VfbGluZm8oZW52LCB0LCAiJWQ6
ICIsIHQpOw0KPj4gICAgICAgICAgICAgICAgICB2ZXJib3NlX2xpbmZvKGVudiwgdywgIiVkOiAi
LCB3KTsNCj4+ICAgICAgICAgICAgICAgICAgdmVyYm9zZShlbnYsICJiYWNrLWVkZ2UgZnJvbSBp
bnNuICVkIHRvICVkXG4iLCB0LCB3KTsNCj4+IEBAIC01NzY2LDcgKzU4MDAsNyBAQCBzdGF0aWMg
aW50IGNoZWNrX2NmZyhzdHJ1Y3QgYnBmX3ZlcmlmaWVyX2VudiAqZW52KQ0KPj4gICAgICAgICAg
ICAgICAgICBpZiAob3Bjb2RlID09IEJQRl9FWElUKSB7DQo+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ290byBtYXJrX2V4cGxvcmVkOw0KPj4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYg
KG9wY29kZSA9PSBCUEZfQ0FMTCkgew0KPj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0g
cHVzaF9pbnNuKHQsIHQgKyAxLCBGQUxMVEhST1VHSCwgZW52KTsNCj4+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHJldCA9IHB1c2hfaW5zbih0LCB0ICsgMSwgRkFMTFRIUk9VR0gsIGVudiwgZmFs
c2UpOw0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gMSkNCj4+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gcGVla19zdGFjazsNCj4+ICAgICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXQgPCAwKQ0KPj4gQEAgLTU3NzUsNyArNTgwOSw4
IEBAIHN0YXRpYyBpbnQgY2hlY2tfY2ZnKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYpDQo+
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0X2V4cGxvcmVkX3N0YXRlKGVu
diwgdCArIDEpOw0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnNuc1t0XS5zcmNf
cmVnID09IEJQRl9QU0VVRE9fQ0FMTCkgew0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaW5pdF9leHBsb3JlZF9zdGF0ZShlbnYsIHQpOw0KPj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXQgPSBwdXNoX2luc24odCwgdCArIGluc25zW3RdLmltbSArIDEsIEJS
QU5DSCwgZW52KTsNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gcHVz
aF9pbnNuKHQsIHQgKyBpbnNuc1t0XS5pbW0gKyAxLCBCUkFOQ0gsDQo+PiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnYsIGZhbHNlKTsNCj4+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gMSkNCj4+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBwZWVrX3N0YWNrOw0KPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocmV0IDwgMCkNCj4+IEBAIC01Nzg4
LDcgKzU4MjMsNyBAQCBzdGF0aWMgaW50IGNoZWNrX2NmZyhzdHJ1Y3QgYnBmX3ZlcmlmaWVyX2Vu
diAqZW52KQ0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgIH0NCj4+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAvKiB1bmNvbmRpdGlvbmFsIGp1bXAgd2l0aCBzaW5nbGUgZWRnZSAqLw0KPj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHB1c2hfaW5zbih0LCB0ICsgaW5zbnNbdF0u
b2ZmICsgMSwNCj4+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGQUxM
VEhST1VHSCwgZW52KTsNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBGQUxMVEhST1VHSCwgZW52LCB0cnVlKTsNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBp
ZiAocmV0ID09IDEpDQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHBl
ZWtfc3RhY2s7DQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocmV0IDwgMCkN
Cj4+IEBAIC01ODAxLDEzICs1ODM2LDEzIEBAIHN0YXRpYyBpbnQgY2hlY2tfY2ZnKHN0cnVjdCBi
cGZfdmVyaWZpZXJfZW52ICplbnYpDQo+PiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQo+PiAg
ICAgICAgICAgICAgICAgICAgICAgICAgLyogY29uZGl0aW9uYWwganVtcCB3aXRoIHR3byBlZGdl
cyAqLw0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRfZXhwbG9yZWRfc3RhdGUoZW52
LCB0KTsNCj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHB1c2hfaW5zbih0LCB0ICsg
MSwgRkFMTFRIUk9VR0gsIGVudik7DQo+PiArICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBw
dXNoX2luc24odCwgdCArIDEsIEZBTExUSFJPVUdILCBlbnYsIHRydWUpOw0KPj4gICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gMSkNCj4+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGdvdG8gcGVla19zdGFjazsNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBl
bHNlIGlmIChyZXQgPCAwKQ0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290
byBlcnJfZnJlZTsNCj4+DQo+PiAtICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBwdXNoX2lu
c24odCwgdCArIGluc25zW3RdLm9mZiArIDEsIEJSQU5DSCwgZW52KTsNCj4+ICsgICAgICAgICAg
ICAgICAgICAgICAgIHJldCA9IHB1c2hfaW5zbih0LCB0ICsgaW5zbnNbdF0ub2ZmICsgMSwgQlJB
TkNILCBlbnYsIHRydWUpOw0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQgPT0g
MSkNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gcGVla19zdGFjazsN
Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXQgPCAwKQ0KPj4gQEAgLTU4
MTcsNyArNTg1Miw3IEBAIHN0YXRpYyBpbnQgY2hlY2tfY2ZnKHN0cnVjdCBicGZfdmVyaWZpZXJf
ZW52ICplbnYpDQo+PiAgICAgICAgICAgICAgICAgIC8qIGFsbCBvdGhlciBub24tYnJhbmNoIGlu
c3RydWN0aW9ucyB3aXRoIHNpbmdsZQ0KPj4gICAgICAgICAgICAgICAgICAgKiBmYWxsLXRocm91
Z2ggZWRnZQ0KPj4gICAgICAgICAgICAgICAgICAgKi8NCj4+IC0gICAgICAgICAgICAgICByZXQg
PSBwdXNoX2luc24odCwgdCArIDEsIEZBTExUSFJPVUdILCBlbnYpOw0KPj4gKyAgICAgICAgICAg
ICAgIHJldCA9IHB1c2hfaW5zbih0LCB0ICsgMSwgRkFMTFRIUk9VR0gsIGVudiwgZmFsc2UpOw0K
Pj4gICAgICAgICAgICAgICAgICBpZiAocmV0ID09IDEpDQo+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ290byBwZWVrX3N0YWNrOw0KPj4gICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXQg
PCAwKQ0KPj4gQEAgLTYyNTAsNiArNjI4NSw4IEBAIHN0YXRpYyB2b2lkIGNsZWFuX2xpdmVfc3Rh
dGVzKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYsIGludCBpbnNuLA0KPj4NCj4+ICAgICAg
ICAgIHNsID0gKmV4cGxvcmVkX3N0YXRlKGVudiwgaW5zbik7DQo+PiAgICAgICAgICB3aGlsZSAo
c2wpIHsNCj4+ICsgICAgICAgICAgICAgICBpZiAoc2wtPnN0YXRlLmJyYW5jaGVzKQ0KPj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBuZXh0Ow0KPj4gICAgICAgICAgICAgICAgICBpZiAo
c2wtPnN0YXRlLmluc25faWR4ICE9IGluc24gfHwNCj4+ICAgICAgICAgICAgICAgICAgICAgIHNs
LT5zdGF0ZS5jdXJmcmFtZSAhPSBjdXItPmN1cmZyYW1lKQ0KPj4gICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gbmV4dDsNCj4+IEBAIC02NjE0LDEyICs2NjUxLDMyIEBAIHN0YXRpYyBpbnQg
cHJvcGFnYXRlX2xpdmVuZXNzKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYsDQo+PiAgICAg
ICAgICByZXR1cm4gMDsNCj4+ICAgfQ0KPj4NCj4+ICtzdGF0aWMgYm9vbCBzdGF0ZXNfbWF5YmVf
bG9vcGluZyhzdHJ1Y3QgYnBmX3ZlcmlmaWVyX3N0YXRlICpvbGQsDQo+PiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgYnBmX3ZlcmlmaWVyX3N0YXRlICpjdXIpDQo+PiAr
ew0KPj4gKyAgICAgICBzdHJ1Y3QgYnBmX2Z1bmNfc3RhdGUgKmZvbGQsICpmY3VyOw0KPj4gKyAg
ICAgICBpbnQgaSwgZnIgPSBjdXItPmN1cmZyYW1lOw0KPj4gKw0KPj4gKyAgICAgICBpZiAob2xk
LT5jdXJmcmFtZSAhPSBmcikNCj4+ICsgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQo+PiAr
DQo+PiArICAgICAgIGZvbGQgPSBvbGQtPmZyYW1lW2ZyXTsNCj4+ICsgICAgICAgZmN1ciA9IGN1
ci0+ZnJhbWVbZnJdOw0KPj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgTUFYX0JQRl9SRUc7IGkr
KykNCj4+ICsgICAgICAgICAgICAgICBpZiAobWVtY21wKCZmb2xkLT5yZWdzW2ldLCAmZmN1ci0+
cmVnc1tpXSwNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldG9mKHN0cnVjdCBi
cGZfcmVnX3N0YXRlLCBwYXJlbnQpKSkNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsNCj4+ICsgICAgICAgcmV0dXJuIHRydWU7DQo+PiArfQ0KPj4gKw0KPj4gKw0KPj4g
ICBzdGF0aWMgaW50IGlzX3N0YXRlX3Zpc2l0ZWQoc3RydWN0IGJwZl92ZXJpZmllcl9lbnYgKmVu
diwgaW50IGluc25faWR4KQ0KPj4gICB7DQo+PiAgICAgICAgICBzdHJ1Y3QgYnBmX3ZlcmlmaWVy
X3N0YXRlX2xpc3QgKm5ld19zbDsNCj4+ICAgICAgICAgIHN0cnVjdCBicGZfdmVyaWZpZXJfc3Rh
dGVfbGlzdCAqc2wsICoqcHByZXY7DQo+PiAgICAgICAgICBzdHJ1Y3QgYnBmX3ZlcmlmaWVyX3N0
YXRlICpjdXIgPSBlbnYtPmN1cl9zdGF0ZSwgKm5ldzsNCj4+ICAgICAgICAgIGludCBpLCBqLCBl
cnIsIHN0YXRlc19jbnQgPSAwOw0KPj4gKyAgICAgICBib29sIGFkZF9uZXdfc3RhdGUgPSBmYWxz
ZTsNCj4+DQo+PiAgICAgICAgICBpZiAoIWVudi0+aW5zbl9hdXhfZGF0YVtpbnNuX2lkeF0ucHJ1
bmVfcG9pbnQpDQo+PiAgICAgICAgICAgICAgICAgIC8qIHRoaXMgJ2luc25faWR4JyBpbnN0cnVj
dGlvbiB3YXNuJ3QgbWFya2VkLCBzbyB3ZSB3aWxsIG5vdA0KPj4gQEAgLTY2MjcsNiArNjY4NCwx
OCBAQCBzdGF0aWMgaW50IGlzX3N0YXRlX3Zpc2l0ZWQoc3RydWN0IGJwZl92ZXJpZmllcl9lbnYg
KmVudiwgaW50IGluc25faWR4KQ0KPj4gICAgICAgICAgICAgICAgICAgKi8NCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIDA7DQo+Pg0KPj4gKyAgICAgICAvKiBicGYgcHJvZ3MgdHlwaWNhbGx5
IGhhdmUgcHJ1bmluZyBwb2ludCBldmVyeSA0IGluc3RydWN0aW9ucw0KPj4gKyAgICAgICAgKiBo
dHRwOi8vdmdlci5rZXJuZWwub3JnL2JwZmNvbmYyMDE5Lmh0bWwjc2Vzc2lvbi0xDQo+PiArICAg
ICAgICAqIERvIG5vdCBhZGQgbmV3IHN0YXRlIGZvciBmdXR1cmUgcHJ1bmluZyBpZiB0aGUgdmVy
aWZpZXIgaGFzbid0IHNlZW4NCj4+ICsgICAgICAgICogYXQgbGVhc3QgMiBqdW1wcyBhbmQgYXQg
bGVhc3QgOCBpbnN0cnVjdGlvbnMuDQo+PiArICAgICAgICAqIFRoaXMgaGV1cmlzdGljcyBoZWxw
cyBkZWNyZWFzZSAndG90YWxfc3RhdGVzJyBhbmQgJ3BlYWtfc3RhdGVzJyBtZXRyaWMuDQo+PiAr
ICAgICAgICAqIEluIHRlc3RzIHRoYXQgYW1vdW50cyB0byB1cCB0byA1MCUgcmVkdWN0aW9uIGlu
dG8gdG90YWwgdmVyaWZpZXINCj4+ICsgICAgICAgICogbWVtb3J5IGNvbnN1bXB0aW9uIGFuZCAy
MCUgdmVyaWZpZXIgdGltZSBzcGVlZHVwLg0KPj4gKyAgICAgICAgKi8NCj4+ICsgICAgICAgaWYg
KGVudi0+am1wc19wcm9jZXNzZWQgLSBlbnYtPnByZXZfam1wc19wcm9jZXNzZWQgPj0gMiAmJg0K
Pj4gKyAgICAgICAgICAgZW52LT5pbnNuX3Byb2Nlc3NlZCAtIGVudi0+cHJldl9pbnNuX3Byb2Nl
c3NlZCA+PSA4KQ0KPj4gKyAgICAgICAgICAgICAgIGFkZF9uZXdfc3RhdGUgPSB0cnVlOw0KPiAN
Cj4gbml0OiB0cml2aWFsIGlmLCB3aHkgbm90Og0KDQpiZWNhdXNlIEkgZG9uJ3QgbGlrZSBzdWNo
IHN0eWxlLg0KDQo+IGFkZF9uZXdfc3RhdGUgPSBlbnYtPmptcHNfcHJvY2Vzc2VkIC0gZW52LT5w
cmV2X2ptcHNfcHJvY2Vzc2VkID49IDIgJiYNCj4gICAgICAgICAgICAgICAgICBlbnYtPmluc25f
cHJvY2Vzc2VkIC0gZW52LT5wcmV2X2luc25fcHJvY2Vzc2VkID49IDg7DQo+IA0KPj4gKw0KPj4g
ICAgICAgICAgcHByZXYgPSBleHBsb3JlZF9zdGF0ZShlbnYsIGluc25faWR4KTsNCj4+ICAgICAg
ICAgIHNsID0gKnBwcmV2Ow0KPj4NCj4+IEBAIC02NjM2LDYgKzY3MDUsMzAgQEAgc3RhdGljIGlu
dCBpc19zdGF0ZV92aXNpdGVkKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYsIGludCBpbnNu
X2lkeCkNCj4+ICAgICAgICAgICAgICAgICAgc3RhdGVzX2NudCsrOw0KPj4gICAgICAgICAgICAg
ICAgICBpZiAoc2wtPnN0YXRlLmluc25faWR4ICE9IGluc25faWR4KQ0KPj4gICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gbmV4dDsNCj4+ICsgICAgICAgICAgICAgICBpZiAoc2wtPnN0YXRl
LmJyYW5jaGVzKSB7DQo+PiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGVzX21heWJl
X2xvb3BpbmcoJnNsLT5zdGF0ZSwgY3VyKSAmJg0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0YXRlc19lcXVhbChlbnYsICZzbC0+c3RhdGUsIGN1cikpIHsNCj4+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdmVyYm9zZV9saW5mbyhlbnYsIGluc25faWR4LCAiOyAiKTsN
Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyYm9zZShlbnYsICJpbmZpbml0
ZSBsb29wIGRldGVjdGVkIGF0IGluc24gJWRcbiIsIGluc25faWR4KTsNCj4+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArICAgICAgICAgICAgICAg
ICAgICAgICB9DQo+PiArICAgICAgICAgICAgICAgICAgICAgICAvKiBpZiB0aGUgdmVyaWZpZXIg
aXMgcHJvY2Vzc2luZyBhIGxvb3AsIGF2b2lkIGFkZGluZyBuZXcgc3RhdGUNCj4+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAqIHRvbyBvZnRlbiwgc2luY2UgZGlmZmVyZW50IGxvb3AgaXRlcmF0
aW9ucyBoYXZlIGRpc3RpbmN0DQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgKiBzdGF0ZXMg
YW5kIG1heSBub3QgaGVscCBmdXR1cmUgcHJ1bmluZy4NCj4+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAqIFRoaXMgdGhyZXNob2xkIHNob3VsZG4ndCBiZSB0b28gbG93IHRvIG1ha2Ugc3VyZSB0
aGF0DQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgKiBhIGxvb3Agd2l0aCBsYXJnZSBib3Vu
ZCB3aWxsIGJlIHJlamVjdGVkIHF1aWNrbHkuDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAg
KiBUaGUgbW9zdCBhYnVzaXZlIGxvb3Agd2lsbCBiZToNCj4+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAqIHIxICs9IDENCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIGlmIHIxIDwgMTAw
MDAwMCBnb3RvIHBjLTINCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIDFNIGluc25fcHJv
Y3NzZWQgbGltaXQgLyAxMDAgPT0gMTBrIHBlYWsgc3RhdGVzLg0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICogVGhpcyB0aHJlc2hvbGQgc2hvdWxkbid0IGJlIHRvbyBoaWdoIGVpdGhlciwg
c2luY2Ugc3RhdGVzDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgKiBhdCB0aGUgZW5kIG9m
IHRoZSBsb29wIGFyZSBsaWtlbHkgdG8gYmUgdXNlZnVsIGluIHBydW5pbmcuDQo+PiArICAgICAg
ICAgICAgICAgICAgICAgICAgKi8NCj4+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnYt
PmptcHNfcHJvY2Vzc2VkIC0gZW52LT5wcmV2X2ptcHNfcHJvY2Vzc2VkIDwgMjAgJiYNCj4+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICBlbnYtPmluc25fcHJvY2Vzc2VkIC0gZW52LT5wcmV2
X2luc25fcHJvY2Vzc2VkIDwgMTAwKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBhZGRfbmV3X3N0YXRlID0gZmFsc2U7DQo+IA0KPiBzYW1lIGFzIGFib3ZlDQo+IA0KPj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBtaXNzOw0KPj4gKyAgICAgICAgICAgICAgIH0NCj4+
ICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlc19lcXVhbChlbnYsICZzbC0+c3RhdGUsIGN1cikp
IHsNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBzbC0+aGl0X2NudCsrOw0KPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgIC8qIHJlYWNoZWQgZXF1aXZhbGVudCByZWdpc3Rlci9zdGFjayBz
dGF0ZSwNCj4+IEBAIC02NjUzLDcgKzY3NDYsMTUgQEAgc3RhdGljIGludCBpc19zdGF0ZV92aXNp
dGVkKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYsIGludCBpbnNuX2lkeCkNCj4+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnI7DQo+PiAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIDE7DQo+PiAgICAgICAgICAgICAgICAgIH0NCj4+IC0gICAgICAg
ICAgICAgICBzbC0+bWlzc19jbnQrKzsNCj4+ICttaXNzOg0KPj4gKyAgICAgICAgICAgICAgIC8q
IHdoZW4gbmV3IHN0YXRlIGlzIG5vdCBnb2luZyB0byBiZSBhZGRlZCBkbyBub3QgaW5jcmVhc2Ug
bWlzcyBjb3VudC4NCj4+ICsgICAgICAgICAgICAgICAgKiBPdGhlcndpc2Ugc2V2ZXJhbCBsb29w
IGl0ZXJhdGlvbnMgd2lsbCByZW1vdmUgdGhlIHN0YXRlDQo+PiArICAgICAgICAgICAgICAgICog
cmVjb3JkZWQgZWFybGllci4gVGhlIGdvYWwgb2YgdGhlc2UgaGV1cmlzdGljcyBpcyB0byBoYXZl
DQo+PiArICAgICAgICAgICAgICAgICogc3RhdGVzIGZyb20gc29tZSBpdGVyYXRpb25zIG9mIHRo
ZSBsb29wIChzb21lIGluIHRoZSBiZWdpbm5pbmcNCj4+ICsgICAgICAgICAgICAgICAgKiBhbmQg
c29tZSBhdCB0aGUgZW5kKSB0byBoZWxwIHBydW5pbmcuDQo+PiArICAgICAgICAgICAgICAgICov
DQo+PiArICAgICAgICAgICAgICAgaWYgKGFkZF9uZXdfc3RhdGUpDQo+PiArICAgICAgICAgICAg
ICAgICAgICAgICBzbC0+bWlzc19jbnQrKzsNCj4+ICAgICAgICAgICAgICAgICAgLyogaGV1cmlz
dGljIHRvIGRldGVybWluZSB3aGV0aGVyIHRoaXMgc3RhdGUgaXMgYmVuZWZpY2lhbA0KPj4gICAg
ICAgICAgICAgICAgICAgKiB0byBrZWVwIGNoZWNraW5nIGZyb20gc3RhdGUgZXF1aXZhbGVuY2Ug
cG9pbnQgb2Ygdmlldy4NCj4+ICAgICAgICAgICAgICAgICAgICogSGlnaGVyIG51bWJlcnMgaW5j
cmVhc2UgbWF4X3N0YXRlc19wZXJfaW5zbiBhbmQgdmVyaWZpY2F0aW9uIHRpbWUsDQo+PiBAQCAt
NjY2NSw2ICs2NzY2LDExIEBAIHN0YXRpYyBpbnQgaXNfc3RhdGVfdmlzaXRlZChzdHJ1Y3QgYnBm
X3ZlcmlmaWVyX2VudiAqZW52LCBpbnQgaW5zbl9pZHgpDQo+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICovDQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgKnBwcmV2ID0gc2wtPm5leHQ7
DQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNsLT5zdGF0ZS5mcmFtZVswXS0+cmVn
c1swXS5saXZlICYgUkVHX0xJVkVfRE9ORSkgew0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1MzIgYnIgPSBzbC0+c3RhdGUuYnJhbmNoZXM7DQo+PiArDQo+PiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFdBUk5fT05DRShiciwNCj4+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICJCVUcgbGl2ZV9kb25lIGJ1dCBicmFuY2hlc190b19l
eHBsb3JlICVkXG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYnIpOw0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJlZV92ZXJpZmll
cl9zdGF0ZSgmc2wtPnN0YXRlLCBmYWxzZSk7DQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBrZnJlZShzbCk7DQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBl
bnYtPnBlYWtfc3RhdGVzLS07DQo+PiBAQCAtNjY5MCw2ICs2Nzk2LDkgQEAgc3RhdGljIGludCBp
c19zdGF0ZV92aXNpdGVkKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYsIGludCBpbnNuX2lk
eCkNCj4+ICAgICAgICAgIGlmICghZW52LT5hbGxvd19wdHJfbGVha3MgJiYgc3RhdGVzX2NudCA+
IEJQRl9DT01QTEVYSVRZX0xJTUlUX1NUQVRFUykNCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IDA7DQo+Pg0KPj4gKyAgICAgICBpZiAoIWFkZF9uZXdfc3RhdGUpDQo+PiArICAgICAgICAgICAg
ICAgcmV0dXJuIDA7DQo+PiArDQo+PiAgICAgICAgICAvKiB0aGVyZSB3ZXJlIG5vIGVxdWl2YWxl
bnQgc3RhdGVzLCByZW1lbWJlciBjdXJyZW50IG9uZS4NCj4+ICAgICAgICAgICAqIHRlY2huaWNh
bGx5IHRoZSBjdXJyZW50IHN0YXRlIGlzIG5vdCBwcm92ZW4gdG8gYmUgc2FmZSB5ZXQsDQo+PiAg
ICAgICAgICAgKiBidXQgaXQgd2lsbCBlaXRoZXIgcmVhY2ggb3V0ZXIgbW9zdCBicGZfZXhpdCAo
d2hpY2ggbWVhbnMgaXQncyBzYWZlKQ0KPj4gQEAgLTY3MDIsNiArNjgxMSw4IEBAIHN0YXRpYyBp
bnQgaXNfc3RhdGVfdmlzaXRlZChzdHJ1Y3QgYnBmX3ZlcmlmaWVyX2VudiAqZW52LCBpbnQgaW5z
bl9pZHgpDQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPj4gICAgICAgICAg
ZW52LT50b3RhbF9zdGF0ZXMrKzsNCj4+ICAgICAgICAgIGVudi0+cGVha19zdGF0ZXMrKzsNCj4+
ICsgICAgICAgZW52LT5wcmV2X2ptcHNfcHJvY2Vzc2VkID0gZW52LT5qbXBzX3Byb2Nlc3NlZDsN
Cj4+ICsgICAgICAgZW52LT5wcmV2X2luc25fcHJvY2Vzc2VkID0gZW52LT5pbnNuX3Byb2Nlc3Nl
ZDsNCj4+DQo+PiAgICAgICAgICAvKiBhZGQgbmV3IHN0YXRlIHRvIHRoZSBoZWFkIG9mIGxpbmtl
ZCBsaXN0ICovDQo+PiAgICAgICAgICBuZXcgPSAmbmV3X3NsLT5zdGF0ZTsNCj4+IEBAIC02NzEy
LDYgKzY4MjMsOSBAQCBzdGF0aWMgaW50IGlzX3N0YXRlX3Zpc2l0ZWQoc3RydWN0IGJwZl92ZXJp
Zmllcl9lbnYgKmVudiwgaW50IGluc25faWR4KQ0KPiANCj4gRmV3IGxpbmVzIGFib3ZlIHRoaXMg
dGhlcmUgaXMgY29tbWVudCBzdGF0aW5nICIgU2luY2UgdGhlcmUgYXJlIG5vDQo+IGxvb3BzIC4u
LiIsIGNhbiB5b3UgcGxlYXNlIGZpeCBpdD8NCj4gDQo+PiAgICAgICAgICAgICAgICAgIHJldHVy
biBlcnI7DQo+PiAgICAgICAgICB9DQo+PiAgICAgICAgICBuZXctPmluc25faWR4ID0gaW5zbl9p
ZHg7DQo+PiArICAgICAgIFdBUk5fT05DRShuZXctPmJyYW5jaGVzICE9IDEsDQo+PiArICAgICAg
ICAgICAgICAgICAiQlVHIGlzX3N0YXRlX3Zpc2l0ZWQ6YnJhbmNoZXNfdG9fZXhwbG9yZT0lZCBp
bnNuICVkXG4iLCBuZXctPmJyYW5jaGVzLCBpbnNuX2lkeCk7DQo+PiArICAgICAgIGN1ci0+cGFy
ZW50ID0gbmV3Ow0KPj4gICAgICAgICAgbmV3X3NsLT5uZXh0ID0gKmV4cGxvcmVkX3N0YXRlKGVu
diwgaW5zbl9pZHgpOw0KPj4gICAgICAgICAgKmV4cGxvcmVkX3N0YXRlKGVudiwgaW5zbl9pZHgp
ID0gbmV3X3NsOw0KPj4gICAgICAgICAgLyogY29ubmVjdCBuZXcgc3RhdGUgdG8gcGFyZW50YWdl
IGNoYWluLiBDdXJyZW50IGZyYW1lIG5lZWRzIGFsbA0KPj4gQEAgLTY3OTgsNiArNjkxMiw3IEBA
IHN0YXRpYyBpbnQgZG9fY2hlY2soc3RydWN0IGJwZl92ZXJpZmllcl9lbnYgKmVudikNCj4+ICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+PiAgICAgICAgICBzdGF0ZS0+Y3VyZnJh
bWUgPSAwOw0KPj4gICAgICAgICAgc3RhdGUtPnNwZWN1bGF0aXZlID0gZmFsc2U7DQo+PiArICAg
ICAgIHN0YXRlLT5icmFuY2hlcyA9IDE7DQo+PiAgICAgICAgICBzdGF0ZS0+ZnJhbWVbMF0gPSBr
emFsbG9jKHNpemVvZihzdHJ1Y3QgYnBmX2Z1bmNfc3RhdGUpLCBHRlBfS0VSTkVMKTsNCj4+ICAg
ICAgICAgIGlmICghc3RhdGUtPmZyYW1lWzBdKSB7DQo+PiAgICAgICAgICAgICAgICAgIGtmcmVl
KHN0YXRlKTsNCj4+IEBAIC03MDA0LDYgKzcxMTksNyBAQCBzdGF0aWMgaW50IGRvX2NoZWNrKHN0
cnVjdCBicGZfdmVyaWZpZXJfZW52ICplbnYpDQo+PiAgICAgICAgICAgICAgICAgIH0gZWxzZSBp
ZiAoY2xhc3MgPT0gQlBGX0pNUCB8fCBjbGFzcyA9PSBCUEZfSk1QMzIpIHsNCj4+ICAgICAgICAg
ICAgICAgICAgICAgICAgICB1OCBvcGNvZGUgPSBCUEZfT1AoaW5zbi0+Y29kZSk7DQo+Pg0KPj4g
KyAgICAgICAgICAgICAgICAgICAgICAgZW52LT5qbXBzX3Byb2Nlc3NlZCsrOw0KPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgIGlmIChvcGNvZGUgPT0gQlBGX0NBTEwpIHsNCj4+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCUEZfU1JDKGluc24tPmNvZGUpICE9IEJQRl9L
IHx8DQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zbi0+b2ZmICE9
IDAgfHwNCj4+IEBAIC03MDg5LDYgKzcyMDUsNyBAQCBzdGF0aWMgaW50IGRvX2NoZWNrKHN0cnVj
dCBicGZfdmVyaWZpZXJfZW52ICplbnYpDQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoZXJyKQ0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gZXJyOw0KPj4gICBwcm9jZXNzX2JwZl9leGl0Og0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1cGRhdGVfYnJhbmNoX2NvdW50cyhlbnYsIGVudi0+Y3VyX3N0YXRl
KTsNCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IHBvcF9zdGFjayhl
bnYsICZlbnYtPnByZXZfaW5zbl9pZHgsDQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJmVudi0+aW5zbl9pZHgpOw0KPj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKGVyciA8IDApIHsNCj4+IC0tDQo+PiAyLjIwLjANCj4+DQoN
Cg==
