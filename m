Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id B75D3262ADA
	for <lists+netdev@lfdr.de>; Wed,  9 Sep 2020 10:47:26 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728458AbgIIIp3 (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Wed, 9 Sep 2020 04:45:29 -0400
Received: from mail2.skidata.com ([91.230.2.91]:51879 "EHLO mail2.skidata.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1725864AbgIIIp1 (ORCPT <rfc822;netdev@vger.kernel.org>);
        Wed, 9 Sep 2020 04:45:27 -0400
X-Greylist: delayed 429 seconds by postgrey-1.27 at vger.kernel.org; Wed, 09 Sep 2020 04:45:26 EDT
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=skidata.com; i=@skidata.com; q=dns/txt; s=selector1;
  t=1599641126; x=1631177126;
  h=date:from:to:cc:subject:message-id:references:
   mime-version:content-transfer-encoding:in-reply-to;
  bh=0VBb0bHRXNQpbCV91/27hjREOsnq6qzD0/A7qkkwmOU=;
  b=sSk16iEbhp+uzuR1ItM3q1XyHADMT2PChRr5K6okWaD+MAQkHw0DStW4
   /j067YwMeLEDa/Q9uXVVW30FKBvdKl9IJuwlu7JDCtVP+i9s6Z9xd1aOg
   7dGctiRjvuDgMD+LlzZeEgS8KzKW2oTq2ArUNhe31OHlaqulqwKQEatWC
   EQ4G/aALKOQWVagMkSYcRy3S7CwSHB76GW0DJ449xTml5jLrS9Z/eAUBi
   ZUjMMi4Z3sw9S/RGEY9w24o/ILfI8mX6nmOdiZxBypGE1QdUKz3I4aLK3
   tMaC/apYgJFZsD/VtIHfi5ClJAR6GNe6vn1c6n2+ht8Kqha6dqL2gAQSA
   g==;
IronPort-SDR: uJBjDDuAcril0fVDPLynefyKl1WcUkoZ4NXteUyd3BR72h3Y/YgaW3YvxjldUpO0AOzp1esmez
 3aXdduvZuWU+fOpPV2mj1wLrvbpXAsUAOCDpHNsDp0IFSz4qxsWvGjG7sGszABKn5Ulmc4fS9s
 7RA8O5XHdBaILxv8JzLf+C0o0NSAWRhoDN54CAeE3fPfHRbeMYYaczFFUeuw2lP1DS4R9zaAo6
 PXHHHL0zGLnVeE9fF7m+82PuLz5bxZEd5AEGmgV9LlkTT9YcHTf/wzX9moZ8Nt8UM00DDH2GET
 xkI=
X-IronPort-AV: E=Sophos;i="5.76,409,1592863200"; 
   d="scan'208";a="2664305"
Date:   Wed, 9 Sep 2020 10:38:13 +0200
From:   Richard Leitner <richard.leitner@skidata.com>
To:     Marek Vasut <marex@denx.de>
CC:     Andrew Lunn <andrew@lunn.ch>, <netdev@vger.kernel.org>,
        Christoph Niedermaier <cniedermaier@dh-electronics.com>,
        "David S . Miller" <davem@davemloft.net>,
        NXP Linux Team <linux-imx@nxp.com>,
        Shawn Guo <shawnguo@kernel.org>
Subject: Re: [PATCH] net: fec: Fix PHY init after phy_reset_after_clk_enable()
Message-ID: <20200909083813.GI81961@pcleri>
References: <20200903210011.GD3112546@lunn.ch>
 <b6397b39-c897-6e0a-6bf7-b6b24908de1a@denx.de>
 <20200903215331.GG3112546@lunn.ch>
 <02ce2afb-7b9f-ba35-63a5-7496c7a39e6e@denx.de>
 <20200903220847.GI3112546@lunn.ch>
 <c67eb631-a16d-0b52-c2f8-92d017e39258@denx.de>
 <20200904140245.GO3112546@lunn.ch>
 <b305a989-d9c3-f02a-6935-81c6bcc084c5@denx.de>
 <20200904190228.GG81961@pcleri>
 <dce19310-edbd-e26b-77cd-f03f3350a477@denx.de>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <dce19310-edbd-e26b-77cd-f03f3350a477@denx.de>
X-Originating-IP: [192.168.111.252]
X-ClientProxiedBy: sdex4srv.skidata.net (192.168.111.82) To
 sdex5srv.skidata.net (192.168.111.83)
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

On Fri, Sep 04, 2020 at 09:23:26PM +0200, Marek Vasut wrote:
> On 9/4/20 9:02 PM, Richard Leitner wrote:
> > On Fri, Sep 04, 2020 at 05:26:14PM +0200, Marek Vasut wrote:
> >> On 9/4/20 4:02 PM, Andrew Lunn wrote:
> >>> On Fri, Sep 04, 2020 at 12:45:44AM +0200, Marek Vasut wrote:
> >>>> On 9/4/20 12:08 AM, Andrew Lunn wrote:
> >>>>>>> b4 am 20200903043947.3272453-1-f.fainelli@gmail.com
> >>>>>>
> >>>>>> That might be a fix for the long run, but I doubt there's any chance to
> >>>>>> backport it all to stable, is there ?
> >>>>>
> >>>>> No. For stable we need something simpler.
> >>>>
> >>>> Like this patch ?
> >>>
> >>> Yes.
> >>>
> >>> But i would like to see a Tested-By: or similar from Richard
> >>> Leitner. Why does the current code work for his system? Does your
> >>> change break it?
> >>
> >> I have the IRQ line connected and described in DT. The reset clears the
> >> IRQ settings done by the SMSC PHY driver. The PHY works fine if I use
> >> polling, because then even if no IRQs are generated by the PHY, the PHY
> >> framework reads the status updates from the PHY periodically and the
> >> default settings of the PHY somehow work (even if they are slightly
> >> incorrect). I suspect that's how Richard had it working.
> > 
> > I have different PHYs on different PCBs in use, but IIRC none of them
> > has the IRQ line defined in the DT.
> > I will take a look at it, test your patch and give feedback ASAP.
> > Unfortunately it's unlikely that this will be before monday ðŸ˜•
> > Hope that's ok.
> 
> That's totally fine, thanks !

Hi, sorry for the delay.
I've applied the patch to our kernel and did some basic tests on
different custom imx6 PCBs. As everything seems to work fine for our
"non-irq configuration" please feel free to add

Tested-by: Richard Leitner <richard.leitner@skidata.com>

regards;rl
