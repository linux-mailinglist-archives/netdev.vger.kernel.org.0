Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 8538548B36A
	for <lists+netdev@lfdr.de>; Tue, 11 Jan 2022 18:17:17 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1344059AbiAKRQx (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Tue, 11 Jan 2022 12:16:53 -0500
Received: from mail-bn7nam10on2071.outbound.protection.outlook.com ([40.107.92.71]:12352
        "EHLO NAM10-BN7-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1344039AbiAKRP4 (ORCPT <rfc822;netdev@vger.kernel.org>);
        Tue, 11 Jan 2022 12:15:56 -0500
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=hJ5iOlxsffQAq0xKI5vB/TMeto53UfocOl+aEh6ehW1Xfhj0F9NmwNGcD1rJk532JU4Ly5rLqICZgPGapGZ/ejRgrR49r3sCDkmvUmRjikG/ZbNS02DiZ1qsSBVikRxS/KGv8o/GnoP7lU7yMIhUXZiSMezP6pAIIvFsLqp1fnrNqDZFlhA4RNxS93mAUw2VLXkmxmeg2OnEF0UX6oVDH/w6mXTWdv5fpDPwcDecMLwMyc3fMgkDCc5A20olmbP/w56jww400Yk/s/y4qqAj/SLsgLYYUhYYAz7h55WeB63jb0Gec5hoXinZ1onFDs8+FoJlgRe3YqxVKi/mGKDNCA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=agYhQSBs++Ak7M32ShDWmx0yNm/dBZK6RRiiP4B5OdU=;
 b=F6McZFawR6LOADD6a1fN2McD8gJI2fNsUaHeGMR3eMDuGvXzz1WTUdP+sUudoFhGKsHT70utRigEM+lZe9q1HVWw8ATg+M9OZbdsVyBFDz7W4s5ZGcJLivlHyGKuAyDpzmw9EQFQDLK3hZEZR//O9tO04eCa88qS1MT7VNTLwO+yfD9tKKHZwatag4pHjmazw8UBahyLJF2XSzXCDAb7JNJfCncIhh3dUQvOtk52l/LrtsAxiP6I7VuIfBNPh9SBZI6UUK32CUXpn2wVmFwYj0U4JtJOQUDyqHnh4st2wGoQBTSMihTPBjXgwEiIMBtoIlZo1AH0zw5t2SBFYMXoGg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=agYhQSBs++Ak7M32ShDWmx0yNm/dBZK6RRiiP4B5OdU=;
 b=OhIQLyFp7PgzdXw9d++RwMEcpb1dMM+nrjpRzoVGwGlzWpqgkOiAIR/5aauDIC0X/1kELoeGyRFTMh7t+IKlArJe2DWtJQH7kZt3/sPFyYrHh8doM+JJx/8s1N74d2htKk3/XTgSJd5sc7Pai8h097JSC+pF2iAx0Mcy9dupFs4=
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=silabs.com;
Received: from PH0PR11MB5657.namprd11.prod.outlook.com (2603:10b6:510:ee::19)
 by PH0PR11MB5641.namprd11.prod.outlook.com (2603:10b6:510:d6::9) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4888.9; Tue, 11 Jan
 2022 17:15:49 +0000
Received: from PH0PR11MB5657.namprd11.prod.outlook.com
 ([fe80::d031:da9e:71a:73e4]) by PH0PR11MB5657.namprd11.prod.outlook.com
 ([fe80::d031:da9e:71a:73e4%6]) with mapi id 15.20.4867.012; Tue, 11 Jan 2022
 17:15:48 +0000
From:   Jerome Pouiller <Jerome.Pouiller@silabs.com>
To:     linux-wireless@vger.kernel.org, netdev@vger.kernel.org,
        Kalle Valo <kvalo@codeaurora.org>
Cc:     devel@driverdev.osuosl.org, linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        "David S . Miller" <davem@davemloft.net>,
        devicetree@vger.kernel.org, Rob Herring <robh+dt@kernel.org>,
        linux-mmc@vger.kernel.org,
        =?UTF-8?q?Pali=20Roh=C3=A1r?= <pali@kernel.org>,
        Ulf Hansson <ulf.hansson@linaro.org>,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH v9 23/24] wfx: remove from the staging area
Date:   Tue, 11 Jan 2022 18:14:23 +0100
Message-Id: <20220111171424.862764-24-Jerome.Pouiller@silabs.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20220111171424.862764-1-Jerome.Pouiller@silabs.com>
References: <20220111171424.862764-1-Jerome.Pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-ClientProxiedBy: SN1PR12CA0099.namprd12.prod.outlook.com
 (2603:10b6:802:21::34) To PH0PR11MB5657.namprd11.prod.outlook.com
 (2603:10b6:510:ee::19)
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: e8d77c31-981e-4072-cad5-08d9d52601e3
X-MS-TrafficTypeDiagnostic: PH0PR11MB5641:EE_
X-Microsoft-Antispam-PRVS: <PH0PR11MB5641754501AB923C8CC19FFE93519@PH0PR11MB5641.namprd11.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:5236;
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: 7ChH3YTfYfvmhEobsdPW2wWUxPJXUlPDi2hJi+G+3sOnsIlUTSrH0uUPzSpx5PzvOC8jGU1tUp4kiaFo5jMiet7D9BGPkinrb0O8GBeBykE1GtxcQmfv6okx6M6OFPNjPYjbNHw69mk9sRDYDUsF0ZsGgF3O/DRBBpr/aqX1L3/L7+8k67xopdsj6Y9ECTvkmxYLUd90URufJshr4w2De7t8dbjnHHVLOEMwJY2UvbOtKDgDrAMAnQKDIA1pZcsQVMew4sxeRY4JF5l/f9XtMO8dcfc1Ssl0MVFR/XpQCWQzhnwrUROEC4PXtGInH3q7xCUrIZiBXKzuAp2RbnZk6GqBv8VGZdfZflZdMpx9piXeG7Hv0USmRRXi+FQhfexsMj8pKuUVNQqFMhRy9+likQ8my0GaPzlGp6AgiQdrg9zzKU9VloJ9fR/+KkmBe2SVx7SnEfnI/BSV+EVcOQDWpbjdwJTlj+RAwVpl/LUwUC8wuTdPz28HumY6UO+JW8unt7wiizKo/nv5PIYgzHDzSHreLCzhElq8ICzuEKmARFT+7FJNLubxSVy+PJJs/RC1RiLvkEeoOJ7p3ClL/byW7gcDoOpgKRJ5hl0pbRtkpl76i5ClkuOLrz8ZdChAxp8s8YbAMPW5pAn+5llxoJ836+pLhCmZl2V2uwVR1oBitjp9FUGjilSTKf+i1EwmxUjU8mRMFDgJtBXISb2EaacCIDJo0BftBUYqw1Z1HKrPkFakx7qlGEhLa8SO7n+uAsrpdxWGEhDUoPK/DPEL4RMViw==
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:PH0PR11MB5657.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(366004)(966005)(7416002)(8936002)(38100700002)(66574015)(30864003)(6666004)(186003)(6506007)(107886003)(8676002)(83380400001)(6512007)(66946007)(316002)(1076003)(66556008)(6916009)(5660300002)(2906002)(54906003)(508600001)(66476007)(52116002)(84970400001)(86362001)(4326008)(6486002)(36756003)(2616005)(21314003)(559001)(579004);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: =?utf-8?B?SjcvczFNeVNiYTEwVXVMSGJadGJtUTFnS0MvbHRvd0lkVGo4WUxkUm5CbWRZ?=
 =?utf-8?B?RWE0ZUpRa1VHRFhnMXRUWE1ZR2pxekJUZmtHZHkyb0dhd0dNQzE3SUo1S3lk?=
 =?utf-8?B?TVU2eXJvTzljaXRyYkpDbmZoVGZSWE55K3AzSCs4aUprNmsyOE85SXBTZWhp?=
 =?utf-8?B?RnJMTGdrRGpGVU10OGEyemhKOWd3TzZBZHZsYnNlakpERGRZdzZqMG9OdTZM?=
 =?utf-8?B?bDllSStjdWlSNFdqUjdmV2gvaEZISTRRcGJjMGxQV2dxVDM5ZllVUkw2djdT?=
 =?utf-8?B?SVF6RWZlM2pZYm8xS2hib3RnQyt4N2d3WUw2ZnlHa0thUWFmTGhucm50Sm9L?=
 =?utf-8?B?ZTdvK2t3OHBBSG1uOVBsT0RCVzF5WUR4SHp5SW5ZNTdxaUlzZEg4WkdjOGM1?=
 =?utf-8?B?MEtta0Y3WkpxOTNldFU3Um1aQldUZE0yVk11MlBkbnJhUkp1eUoyR0Nob3hK?=
 =?utf-8?B?WDRBYlY5MVNEWlVjcmgvSkdxV3NxVmVpZFpHbU1FREpScmpmU3VBd2R6MURO?=
 =?utf-8?B?VHRxNmlzeUJ2dkdDRkEvcEdDVVZKRitVNHZjeU9CV3FJMzZZcVdUWU5CMVNw?=
 =?utf-8?B?aVBXajVtWUhyQjJjRHF6bXZ3V2g3QUlOQWI5akdwckFRSHh4cE1KT3RFdWZ5?=
 =?utf-8?B?UmxjWnJBWkRjc3RwTlBJRXN0WDV0c2dJc0tEc3ZjYzFYOEtEcHFSTzh1RWhZ?=
 =?utf-8?B?Vy82TGVIaEt3MUNwRkk4SVR2eGpKTzB0V3N5eHk3NkE4N0orY2FlWVNMTnQv?=
 =?utf-8?B?b0xnbzJiK1grNmpEWkdCMzYzelhBZUJwSzgzRkVvZkpSanFCclVqMlpqNHgx?=
 =?utf-8?B?ciswblpqM0x0RXlaTFdqSmdjTzNhc2RrRVYvZk1SMTVqS0dMMVpQYXcyWUlD?=
 =?utf-8?B?c01BcElpNWRPbmZDSDJFUWdaOHVWdUFCeElwWHNrd0hWTXBWUlpjeUNpbCsy?=
 =?utf-8?B?cnUxb041aU5Xb0tQcjJzZ3B5MWpMeHo0bFVVM3lmQ0c1U3U4YlZaWHkrYzZC?=
 =?utf-8?B?dkdhdEx6R2xHSnBneENqQmZKYlUyQWwvSDJPNHdWZUxRbU8wcHNwSXVsQ2U3?=
 =?utf-8?B?bnJmU05mZXkvTGVQeHpPSkJ1T3pqZVZXOTA0UDFZUlVuaS93L2tnM3lOMkJk?=
 =?utf-8?B?dU4wTjVmOU53enZSYjFjQ1RoQ04yQUlmcElBMkdHaFAxT3EvSDc4dXVrZ0ww?=
 =?utf-8?B?eDZzU1gxYmRUUGVnWVhVRGc5eWF1WE5NcVdKbkVHWUpHOFBmOHFCUXFHQVE1?=
 =?utf-8?B?a3FWVXJSR1NVQ1llRzM0aURWR0JCRjVtSGRMSHlFYnFrUXltOEUveWNvT2VO?=
 =?utf-8?B?Vm5ybTliWUVKN28zY2g2WE1MVThxVGxKOWZoeUwzSno5Mjcrd1gwQS9Nbis5?=
 =?utf-8?B?ZTlwa1IxMDV1K09aeWMzOEszL3NxU0JtdWlWYzh5M3NIZnY1MmpaeEYwS2N5?=
 =?utf-8?B?cTcyZGRESmNDK1pHSUNqbGtqTGFUcURneVdSZmE1ZnhycWhDaUI1WWFoKzFv?=
 =?utf-8?B?QUEzaUFGUG5PUDNod2pCUWJ4MzlBTG1mL01SU3g1YnovME9UVTJadEpYVE5H?=
 =?utf-8?B?by9ndkRxdlhjYlBYRUYwMWp0bTZKeVJKYncyZGloWitUT2tSS2lmSUF4NWRK?=
 =?utf-8?B?Wm9zb0g0SkNOK0dlVGMvVTNwOE9LSGJCV2NOVGR0NS8wdWhEcFlDdGJiS2VG?=
 =?utf-8?B?MU5XeEkrYUJHWFNDcjRMU0VNWUdZaHU2TitTOFdOMTcrb1ZlOTl6cDF1Wmw0?=
 =?utf-8?B?aVg1NXN2VCtuMnlVNTY2NFV4QzVPRFlHWXpuTXlwaFN1eEdiZ3dGN2JKZG5n?=
 =?utf-8?B?TWUxWlRKVVRVRGFjWkZoMURFK2Q1d255STU0SmpFWHJ1MjFDRlo0dzNsRmh3?=
 =?utf-8?B?eTAwdW52eGhXbE5yWGVvWkcyaUZOWDhHRG9lRW5NOVJaWjlHN2NaNWwvTVZw?=
 =?utf-8?B?K2FHWG00Y2phdVJWaTBDQ0tQMGlLczViZU1iTTh1WDhacFVKOHhuN2lnRFRS?=
 =?utf-8?B?dG5mcUU5NmNmamlDbjl0ZlptTk8yWnR3by9WTkNDQ3d4WjF6Y1lKQnIwOU1S?=
 =?utf-8?B?ZzNQZ3ZoUldnek1pRWpSYTVtcE5UdGUzU1VnMFUzdGp5K2FvOEtQZTF2clVz?=
 =?utf-8?B?bVZYUWUvci9DYWNOc2VIWEZMT0VSZE5iUkVBazg3S2lxMG0wZ2p5S0hmRjl6?=
 =?utf-8?B?WHFzVXMzZzlXcXR2Z2VSNFg0TnFuZnlpbnJGZjJRdUpmdm1FM01uVUJqWVQ2?=
 =?utf-8?Q?y+l/sIe76KeM2EpBGYMckMjFc/Gj9TF+cDVXKoBLbw=3D?=
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e8d77c31-981e-4072-cad5-08d9d52601e3
X-MS-Exchange-CrossTenant-AuthSource: PH0PR11MB5657.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 11 Jan 2022 17:15:48.8081
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: BmEihKrV0KF1ym/yKhNINOyJiY7gHJeML9TQQgpnjF0A9EqTeL3YsXzNeCTbQr3fimOzWq5Owdt+5KpCmm/r8g==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PH0PR11MB5641
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKU2ln
bmVkLW9mZi1ieTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29t
PgotLS0KIC4uLi9iaW5kaW5ncy9uZXQvd2lyZWxlc3Mvc2lsYWJzLHdmeC55YW1sICAgICB8IDEy
NSAtLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvS2NvbmZpZyAgICAgICAgICAgICAgICAgICB8ICAg
OCAtCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L01ha2VmaWxlICAgICAgICAgICAgICAgICAgfCAgMjUg
LQogZHJpdmVycy9zdGFnaW5nL3dmeC9iaC5jICAgICAgICAgICAgICAgICAgICAgIHwgMzMwIC0t
LS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvYmguaCAgICAgICAgICAgICAgICAgICAgICB8ICAz
MyAtCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L2J1cy5oICAgICAgICAgICAgICAgICAgICAgfCAgMzgg
LQogZHJpdmVycy9zdGFnaW5nL3dmeC9idXNfc2Rpby5jICAgICAgICAgICAgICAgIHwgMjcyIC0t
LS0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9idXNfc3BpLmMgICAgICAgICAgICAgICAgIHwgMjcx
IC0tLS0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3J4LmMgICAgICAgICAgICAgICAgIHwg
IDk0IC0tCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L2RhdGFfcnguaCAgICAgICAgICAgICAgICAgfCAg
MTggLQogZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmMgICAgICAgICAgICAgICAgIHwgNTk2
IC0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV90eC5oICAgICAgICAgICAg
ICAgICB8ICA2OCAtLQogZHJpdmVycy9zdGFnaW5nL3dmeC9kZWJ1Zy5jICAgICAgICAgICAgICAg
ICAgIHwgMzY1IC0tLS0tLS0tCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L2RlYnVnLmggICAgICAgICAg
ICAgICAgICAgfCAgMTkgLQogZHJpdmVycy9zdGFnaW5nL3dmeC9md2lvLmMgICAgICAgICAgICAg
ICAgICAgIHwgNDA1IC0tLS0tLS0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9md2lvLmggICAgICAg
ICAgICAgICAgICAgIHwgIDE1IC0KIGRyaXZlcnMvc3RhZ2luZy93ZngvaGlmX2FwaV9jbWQuaCAg
ICAgICAgICAgICB8IDU1NSAtLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvaGlmX2Fw
aV9nZW5lcmFsLmggICAgICAgICB8IDI2MiAtLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvaGlm
X2FwaV9taWIuaCAgICAgICAgICAgICB8IDM0NiAtLS0tLS0tLQogZHJpdmVycy9zdGFnaW5nL3dm
eC9oaWZfcnguYyAgICAgICAgICAgICAgICAgIHwgNDE2IC0tLS0tLS0tLQogZHJpdmVycy9zdGFn
aW5nL3dmeC9oaWZfcnguaCAgICAgICAgICAgICAgICAgIHwgIDE3IC0KIGRyaXZlcnMvc3RhZ2lu
Zy93ZngvaGlmX3R4LmMgICAgICAgICAgICAgICAgICB8IDUxMyAtLS0tLS0tLS0tLQogZHJpdmVy
cy9zdGFnaW5nL3dmeC9oaWZfdHguaCAgICAgICAgICAgICAgICAgIHwgIDYwIC0tCiBkcml2ZXJz
L3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuYyAgICAgICAgICAgICAgfCAzMjQgLS0tLS0tLQogZHJp
dmVycy9zdGFnaW5nL3dmeC9oaWZfdHhfbWliLmggICAgICAgICAgICAgIHwgIDQ5IC0tCiBkcml2
ZXJzL3N0YWdpbmcvd2Z4L2h3aW8uYyAgICAgICAgICAgICAgICAgICAgfCAzNTIgLS0tLS0tLS0K
IGRyaXZlcnMvc3RhZ2luZy93ZngvaHdpby5oICAgICAgICAgICAgICAgICAgICB8ICA3NSAtLQog
ZHJpdmVycy9zdGFnaW5nL3dmeC9rZXkuYyAgICAgICAgICAgICAgICAgICAgIHwgMjQxIC0tLS0t
CiBkcml2ZXJzL3N0YWdpbmcvd2Z4L2tleS5oICAgICAgICAgICAgICAgICAgICAgfCAgMjAgLQog
ZHJpdmVycy9zdGFnaW5nL3dmeC9tYWluLmMgICAgICAgICAgICAgICAgICAgIHwgNTA2IC0tLS0t
LS0tLS0tCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L21haW4uaCAgICAgICAgICAgICAgICAgICAgfCAg
NDMgLQogZHJpdmVycy9zdGFnaW5nL3dmeC9xdWV1ZS5jICAgICAgICAgICAgICAgICAgIHwgMzA3
IC0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvcXVldWUuaCAgICAgICAgICAgICAgICAgICB8
ICA0NSAtCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L3NjYW4uYyAgICAgICAgICAgICAgICAgICAgfCAx
NDkgLS0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmggICAgICAgICAgICAgICAgICAgIHwg
IDIyIC0KIGRyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMgICAgICAgICAgICAgICAgICAgICB8IDgz
MyAtLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmggICAgICAgICAg
ICAgICAgICAgICB8ICA3MyAtLQogZHJpdmVycy9zdGFnaW5nL3dmeC90cmFjZXMuaCAgICAgICAg
ICAgICAgICAgIHwgNTAxIC0tLS0tLS0tLS0tCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L3dmeC5oICAg
ICAgICAgICAgICAgICAgICAgfCAxNjQgLS0tLQogMzkgZmlsZXMgY2hhbmdlZCwgODU1NSBkZWxl
dGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L0RvY3VtZW50
YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9uZXQvd2lyZWxlc3Mvc2lsYWJzLHdmeC55YW1sCiBk
ZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9LY29uZmlnCiBkZWxldGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9NYWtlZmlsZQogZGVsZXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvc3RhZ2luZy93ZngvYmguYwogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3Rh
Z2luZy93ZngvYmguaAogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93ZngvYnVz
LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2J1c19zZGlvLmMKIGRl
bGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2J1c19zcGkuYwogZGVsZXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV9yeC5jCiBkZWxldGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3J4LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL3N0YWdpbmcvd2Z4L2RhdGFfdHguYwogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3Rh
Z2luZy93ZngvZGF0YV90eC5oCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dm
eC9kZWJ1Zy5jCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9kZWJ1Zy5o
CiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9md2lvLmMKIGRlbGV0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2Z3aW8uaAogZGVsZXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvc3RhZ2luZy93ZngvaGlmX2FwaV9jbWQuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvc3RhZ2luZy93ZngvaGlmX2FwaV9nZW5lcmFsLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl9hcGlfbWliLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL3N0YWdpbmcvd2Z4L2hpZl9yeC5jCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFn
aW5nL3dmeC9oaWZfcnguaAogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93Zngv
aGlmX3R4LmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eC5o
CiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfdHhfbWliLmMKIGRl
bGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuaAogZGVsZXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93ZngvaHdpby5jCiBkZWxldGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9od2lvLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L3N0YWdpbmcvd2Z4L2tleS5jCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dm
eC9rZXkuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93ZngvbWFpbi5jCiBk
ZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9tYWluLmgKIGRlbGV0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L3F1ZXVlLmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL3N0YWdpbmcvd2Z4L3F1ZXVlLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0
YWdpbmcvd2Z4L3NjYW4uYwogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93Zngv
c2Nhbi5oCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYwogZGVs
ZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmgKIGRlbGV0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L3RyYWNlcy5oCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9zdGFnaW5nL3dmeC93ZnguaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93Zngv
RG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL25ldC93aXJlbGVzcy9zaWxhYnMsd2Z4
LnlhbWwgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5k
aW5ncy9uZXQvd2lyZWxlc3Mvc2lsYWJzLHdmeC55YW1sCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCA1MTBlZGQxMmVkMTkuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0YWdpbmcv
d2Z4L0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9uZXQvd2lyZWxlc3Mvc2lsYWJz
LHdmeC55YW1sCisrKyAvZGV2L251bGwKQEAgLTEsMTI1ICswLDAgQEAKLSMgU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IChHUEwtMi4wLW9ubHkgT1IgQlNELTItQ2xhdXNlKQotIyBDb3B5cmlnaHQg
KGMpIDIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0lWUFNTCAxLjIKLS0tLQotCi0k
aWQ6IGh0dHA6Ly9kZXZpY2V0cmVlLm9yZy9zY2hlbWFzL25ldC93aXJlbGVzcy9zaWxhYnMsd2Z4
LnlhbWwjCi0kc2NoZW1hOiBodHRwOi8vZGV2aWNldHJlZS5vcmcvbWV0YS1zY2hlbWFzL2NvcmUu
eWFtbCMKLQotdGl0bGU6IFNpbGljb24gTGFicyBXRnh4eCBkZXZpY2V0cmVlIGJpbmRpbmdzCi0K
LW1haW50YWluZXJzOgotICAtIErDqXLDtG1lIFBvdWlsbGVyIDxqZXJvbWUucG91aWxsZXJAc2ls
YWJzLmNvbT4KLQotZGVzY3JpcHRpb246Ci0gIFRoZSBXRnh4eCBjaGlwIHNlcmllcyBjYW4gYmUg
Y29ubmVjdGVkIHZpYSBTUEkgb3IgdmlhIFNESU8uCi0KLSAgRm9yIFNESU8nOicKLQotICAgIFRo
ZSBkcml2ZXIgaXMgYWJsZSB0byBkZXRlY3QgYSBXRnh4eCBjaGlwIG9uIFNESU8gYnVzIGJ5IG1h
dGNoaW5nIGl0cyBWZW5kb3IKLSAgICBJRCBhbmQgUHJvZHVjdCBJRC4gSG93ZXZlciwgZHJpdmVy
IHdpbGwgb25seSBwcm92aWRlIGxpbWl0ZWQgZmVhdHVyZXMgaW4KLSAgICB0aGlzIGNhc2UuIFRo
dXMgZGVjbGFyaW5nIFdGeHh4IGNoaXAgaW4gZGV2aWNlIHRyZWUgaXMgcmVjb21tZW5kZWQgKGFu
ZCBtYXkKLSAgICBiZWNvbWUgbWFuZGF0b3J5IGluIHRoZSBmdXR1cmUpLgotCi0gICAgSW4gYWRk
aXRpb24sIGl0IGlzIHJlY29tbWVuZGVkIHRvIGRlY2xhcmUgYSBtbWMtcHdyc2VxIG9uIFNESU8g
aG9zdCBhYm92ZQotICAgIFdGeC4gV2l0aG91dCBpdCwgeW91IG1heSBlbmNvdW50ZXIgaXNzdWVz
IHdpdGggd2FybSBib290LiBUaGUgbW1jLXB3cnNlcQotICAgIHNob3VsZCBiZSBjb21wYXRpYmxl
IHdpdGggbW1jLXB3cnNlcS1zaW1wbGUuIFBsZWFzZSBjb25zdWx0Ci0gICAgRG9jdW1lbnRhdGlv
bi9kZXZpY2V0cmVlL2JpbmRpbmdzL21tYy9tbWMtcHdyc2VxLXNpbXBsZS55YW1sIGZvciBtb3Jl
Ci0gICAgaW5mb3JtYXRpb24uCi0KLSAgRm9yIFNQSSc6JwotCi0gICAgSW4gYWRkIG9mIHRoZSBw
cm9wZXJ0aWVzIGJlbG93LCBwbGVhc2UgY29uc3VsdAotICAgIERvY3VtZW50YXRpb24vZGV2aWNl
dHJlZS9iaW5kaW5ncy9zcGkvc3BpLWNvbnRyb2xsZXIueWFtbCBmb3Igb3B0aW9uYWwgU1BJCi0g
ICAgcmVsYXRlZCBwcm9wZXJ0aWVzLgotCi0gIE5vdGUgdGhhdCBpbiBhZGQgb2YgdGhlIHByb3Bl
cnRpZXMgYmVsb3csIHRoZSBXRnggZHJpdmVyIGFsc28gc3VwcG9ydHMKLSAgYG1hYy1hZGRyZXNz
YCBhbmQgYGxvY2FsLW1hYy1hZGRyZXNzYCBhcyBkZXNjcmliZWQgaW4KLSAgRG9jdW1lbnRhdGlv
bi9kZXZpY2V0cmVlL2JpbmRpbmdzL25ldC9ldGhlcm5ldC50eHQKLQotcHJvcGVydGllczoKLSAg
Y29tcGF0aWJsZToKLSAgICBjb25zdDogc2lsYWJzLHdmMjAwCi0gIHJlZzoKLSAgICBkZXNjcmlw
dGlvbjoKLSAgICAgIFdoZW4gdXNlZCBvbiBTRElPIGJ1cywgPHJlZz4gbXVzdCBiZSBzZXQgdG8g
MS4gV2hlbiB1c2VkIG9uIFNQSSBidXMsIGl0IGlzCi0gICAgICB0aGUgY2hpcCBzZWxlY3QgYWRk
cmVzcyBvZiB0aGUgZGV2aWNlIGFzIGRlZmluZWQgaW4gdGhlIFNQSSBkZXZpY2VzCi0gICAgICBi
aW5kaW5ncy4KLSAgICBtYXhJdGVtczogMQotICBzcGktbWF4LWZyZXF1ZW5jeToKLSAgICBkZXNj
cmlwdGlvbjogKFNQSSBvbmx5KSBNYXhpbXVtIFNQSSBjbG9ja2luZyBzcGVlZCBvZiBkZXZpY2Ug
aW4gSHouCi0gICAgbWF4SXRlbXM6IDEKLSAgaW50ZXJydXB0czoKLSAgICBkZXNjcmlwdGlvbjog
VGhlIGludGVycnVwdCBsaW5lLiBUcmlnZ2VycyBJUlFfVFlQRV9MRVZFTF9ISUdIIGFuZAotICAg
ICAgSVJRX1RZUEVfRURHRV9SSVNJTkcgYXJlIGJvdGggc3VwcG9ydGVkIGJ5IHRoZSBjaGlwIGFu
ZCB0aGUgZHJpdmVyLiBXaGVuCi0gICAgICBTUEkgaXMgdXNlZCwgdGhpcyBwcm9wZXJ0eSBpcyBy
ZXF1aXJlZC4gV2hlbiBTRElPIGlzIHVzZWQsIHRoZSAiaW4tYmFuZCIKLSAgICAgIGludGVycnVw
dCBwcm92aWRlZCBieSB0aGUgU0RJTyBidXMgaXMgdXNlZCB1bmxlc3MgYW4gaW50ZXJydXB0IGlz
IGRlZmluZWQKLSAgICAgIGluIHRoZSBEZXZpY2UgVHJlZS4KLSAgICBtYXhJdGVtczogMQotICBy
ZXNldC1ncGlvczoKLSAgICBkZXNjcmlwdGlvbjogKFNQSSBvbmx5KSBQaGFuZGxlIG9mIGdwaW8g
dGhhdCB3aWxsIGJlIHVzZWQgdG8gcmVzZXQgY2hpcAotICAgICAgZHVyaW5nIHByb2JlLiBXaXRo
b3V0IHRoaXMgcHJvcGVydHksIHlvdSBtYXkgZW5jb3VudGVyIGlzc3VlcyB3aXRoIHdhcm0KLSAg
ICAgIGJvb3QuIChGb3IgbGVnYWN5IHB1cnBvc2UsIHRoZSBncGlvIGluIGludmVydGVkIHdoZW4g
Y29tcGF0aWJsZSA9PQotICAgICAgInNpbGFicyx3Zngtc3BpIikKLQotICAgICAgRm9yIFNESU8s
IHRoZSByZXNldCBncGlvIHNob3VsZCBkZWNsYXJlZCB1c2luZyBhIG1tYy1wd3JzZXEuCi0gICAg
bWF4SXRlbXM6IDEKLSAgd2FrZXVwLWdwaW9zOgotICAgIGRlc2NyaXB0aW9uOiBQaGFuZGxlIG9m
IGdwaW8gdGhhdCB3aWxsIGJlIHVzZWQgdG8gd2FrZS11cCBjaGlwLiBXaXRob3V0IHRoaXMKLSAg
ICAgIHByb3BlcnR5LCBkcml2ZXIgd2lsbCBkaXNhYmxlIG1vc3Qgb2YgcG93ZXIgc2F2aW5nIGZl
YXR1cmVzLgotICAgIG1heEl0ZW1zOiAxCi0gIGNvbmZpZy1maWxlOgotICAgIGRlc2NyaXB0aW9u
OiBVc2UgYW4gYWx0ZXJuYXRpdmUgZmlsZSBhcyBQRFMuIERlZmF1bHQgaXMgYHdmMjAwLnBkc2Au
IE9ubHkKLSAgICAgIG5lY2Vzc2FyeSBmb3IgZGV2ZWxvcG1lbnQvZGVidWcgcHVycG9zZS4KLSAg
ICBtYXhJdGVtczogMQotCi1yZXF1aXJlZDoKLSAgLSBjb21wYXRpYmxlCi0gIC0gcmVnCi0KLWV4
YW1wbGVzOgotICAtIHwKLSAgICAjaW5jbHVkZSA8ZHQtYmluZGluZ3MvZ3Bpby9ncGlvLmg+Ci0g
ICAgI2luY2x1ZGUgPGR0LWJpbmRpbmdzL2ludGVycnVwdC1jb250cm9sbGVyL2lycS5oPgotCi0g
ICAgc3BpMCB7Ci0gICAgICAgICNhZGRyZXNzLWNlbGxzID0gPDE+OwotICAgICAgICAjc2l6ZS1j
ZWxscyA9IDwwPjsKLQotICAgICAgICB3ZnhAMCB7Ci0gICAgICAgICAgICBjb21wYXRpYmxlID0g
InNpbGFicyx3ZjIwMCI7Ci0gICAgICAgICAgICBwaW5jdHJsLW5hbWVzID0gImRlZmF1bHQiOwot
ICAgICAgICAgICAgcGluY3RybC0wID0gPCZ3ZnhfaXJxICZ3ZnhfZ3Bpb3M+OwotICAgICAgICAg
ICAgcmVnID0gPDA+OwotICAgICAgICAgICAgaW50ZXJydXB0cy1leHRlbmRlZCA9IDwmZ3BpbyAx
NiBJUlFfVFlQRV9FREdFX1JJU0lORz47Ci0gICAgICAgICAgICB3YWtldXAtZ3Bpb3MgPSA8Jmdw
aW8gMTIgR1BJT19BQ1RJVkVfSElHSD47Ci0gICAgICAgICAgICByZXNldC1ncGlvcyA9IDwmZ3Bp
byAxMyBHUElPX0FDVElWRV9MT1c+OwotICAgICAgICAgICAgc3BpLW1heC1mcmVxdWVuY3kgPSA8
NDIwMDAwMDA+OwotICAgICAgICB9OwotICAgIH07Ci0KLSAgLSB8Ci0gICAgI2luY2x1ZGUgPGR0
LWJpbmRpbmdzL2dwaW8vZ3Bpby5oPgotICAgICNpbmNsdWRlIDxkdC1iaW5kaW5ncy9pbnRlcnJ1
cHQtY29udHJvbGxlci9pcnEuaD4KLQotICAgIHdmeF9wd3JzZXE6IHdmeF9wd3JzZXEgewotICAg
ICAgICBjb21wYXRpYmxlID0gIm1tYy1wd3JzZXEtc2ltcGxlIjsKLSAgICAgICAgcGluY3RybC1u
YW1lcyA9ICJkZWZhdWx0IjsKLSAgICAgICAgcGluY3RybC0wID0gPCZ3ZnhfcmVzZXQ+OwotICAg
ICAgICByZXNldC1ncGlvcyA9IDwmZ3BpbyAxMyBHUElPX0FDVElWRV9MT1c+OwotICAgIH07Ci0K
LSAgICBtbWMwIHsKLSAgICAgICAgbW1jLXB3cnNlcSA9IDwmd2Z4X3B3cnNlcT47Ci0gICAgICAg
ICNhZGRyZXNzLWNlbGxzID0gPDE+OwotICAgICAgICAjc2l6ZS1jZWxscyA9IDwwPjsKLQotICAg
ICAgICBtbWNAMSB7Ci0gICAgICAgICAgICBjb21wYXRpYmxlID0gInNpbGFicyx3ZjIwMCI7Ci0g
ICAgICAgICAgICBwaW5jdHJsLW5hbWVzID0gImRlZmF1bHQiOwotICAgICAgICAgICAgcGluY3Ry
bC0wID0gPCZ3Znhfd2FrZXVwPjsKLSAgICAgICAgICAgIHJlZyA9IDwxPjsKLSAgICAgICAgICAg
IHdha2V1cC1ncGlvcyA9IDwmZ3BpbyAxMiBHUElPX0FDVElWRV9ISUdIPjsKLSAgICAgICAgfTsK
LSAgICB9OwotLi4uCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L0tjb25maWcgYi9k
cml2ZXJzL3N0YWdpbmcvd2Z4L0tjb25maWcKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDgzZWU0ZDBjYThjNi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvS2Nv
bmZpZworKysgL2Rldi9udWxsCkBAIC0xLDggKzAsMCBAQAotY29uZmlnIFdGWAotCXRyaXN0YXRl
ICJTaWxpY29uIExhYnMgd2lyZWxlc3MgY2hpcHMgV0YyMDAgYW5kIGZ1cnRoZXIiCi0JZGVwZW5k
cyBvbiBNQUM4MDIxMQotCWRlcGVuZHMgb24gTU1DIHx8ICFNTUMgIyBkbyBub3QgYWxsb3cgV0ZY
PXkgaWYgTU1DPW0KLQlkZXBlbmRzIG9uIChTUEkgfHwgTU1DKQotCWhlbHAKLQkgIFRoaXMgaXMg
YSBkcml2ZXIgZm9yIFNpbGljb25zIExhYnMgV0Z4eHggc2VyaWVzIChXRjIwMCBhbmQgZnVydGhl
cikKLQkgIGNoaXBzZXRzLiBUaGlzIGNoaXAgY2FuIGJlIGZvdW5kIG9uIFNQSSBvciBTRElPIGJ1
c2VzLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9NYWtlZmlsZSBiL2RyaXZlcnMv
c3RhZ2luZy93ZngvTWFrZWZpbGUKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDBlMGNj
OTgyY2VhYi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvTWFrZWZpbGUK
KysrIC9kZXYvbnVsbApAQCAtMSwyNSArMCwwIEBACi0jIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wCi0KLSMgTmVjZXNzYXJ5IGZvciBDUkVBVEVfVFJBQ0VfUE9JTlRTCi1DRkxBR1Nf
ZGVidWcubyA9IC1JJChzcmMpCi0KLXdmeC15IDo9IFwKLQliaC5vIFwKLQlod2lvLm8gXAotCWZ3
aW8ubyBcCi0JaGlmX3R4X21pYi5vIFwKLQloaWZfdHgubyBcCi0JaGlmX3J4Lm8gXAotCXF1ZXVl
Lm8gXAotCWRhdGFfdHgubyBcCi0JZGF0YV9yeC5vIFwKLQlzY2FuLm8gXAotCXN0YS5vIFwKLQlr
ZXkubyBcCi0JbWFpbi5vIFwKLQlzdGEubyBcCi0JZGVidWcubwotd2Z4LSQoQ09ORklHX1NQSSkg
Kz0gYnVzX3NwaS5vCi13ZngtJChzdWJzdCBtLHksJChDT05GSUdfTU1DKSkgKz0gYnVzX3NkaW8u
bwotCi1vYmotJChDT05GSUdfV0ZYKSArPSB3ZngubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFn
aW5nL3dmeC9iaC5jIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9iaC5jCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCBhMGY5ZDFiNTMwMTkuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0
YWdpbmcvd2Z4L2JoLmMKKysrIC9kZXYvbnVsbApAQCAtMSwzMzAgKzAsMCBAQAotLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQotLyoKLSAqIEludGVycnVwdCBib3R0b20g
aGFsZiAoQkgpLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9y
YXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0j
aW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1lci5oPgotI2luY2x1ZGUgPG5ldC9tYWM4MDIxMS5o
PgotCi0jaW5jbHVkZSAiYmguaCIKLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJod2lvLmgi
Ci0jaW5jbHVkZSAidHJhY2VzLmgiCi0jaW5jbHVkZSAiaGlmX3J4LmgiCi0jaW5jbHVkZSAiaGlm
X2FwaV9jbWQuaCIKLQotc3RhdGljIHZvaWQgZGV2aWNlX3dha2V1cChzdHJ1Y3Qgd2Z4X2RldiAq
d2RldikKLXsKLQlpbnQgbWF4X3JldHJ5ID0gMzsKLQotCWlmICghd2Rldi0+cGRhdGEuZ3Bpb193
YWtldXApCi0JCXJldHVybjsKLQlpZiAoZ3Bpb2RfZ2V0X3ZhbHVlX2NhbnNsZWVwKHdkZXYtPnBk
YXRhLmdwaW9fd2FrZXVwKSA+IDApCi0JCXJldHVybjsKLQotCWlmICh3ZnhfYXBpX29sZGVyX3Ro
YW4od2RldiwgMSwgNCkpIHsKLQkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKHdkZXYtPnBkYXRh
LmdwaW9fd2FrZXVwLCAxKTsKLQkJaWYgKCFjb21wbGV0aW9uX2RvbmUoJndkZXYtPmhpZi5jdHJs
X3JlYWR5KSkKLQkJCXVzbGVlcF9yYW5nZSgyMDAwLCAyNTAwKTsKLQkJcmV0dXJuOwotCX0KLQlm
b3IgKDs7KSB7Ci0JCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcCh3ZGV2LT5wZGF0YS5ncGlvX3dh
a2V1cCwgMSk7Ci0JCS8qIGNvbXBsZXRpb24uaCBkb2VzIG5vdCBwcm92aWRlIGFueSBmdW5jdGlv
biB0byB3YWl0Ci0JCSAqIGNvbXBsZXRpb24gd2l0aG91dCBjb25zdW1lIGl0IChhIGtpbmQgb2YK
LQkJICogd2FpdF9mb3JfY29tcGxldGlvbl9kb25lX3RpbWVvdXQoKSkuIFNvIHdlIGhhdmUgdG8g
ZW11bGF0ZQotCQkgKiBpdC4KLQkJICovCi0JCWlmICh3YWl0X2Zvcl9jb21wbGV0aW9uX3RpbWVv
dXQoJndkZXYtPmhpZi5jdHJsX3JlYWR5LAotCQkJCQkJbXNlY3NfdG9famlmZmllcygyKSkpIHsK
LQkJCWNvbXBsZXRlKCZ3ZGV2LT5oaWYuY3RybF9yZWFkeSk7Ci0JCQlyZXR1cm47Ci0JCX0gZWxz
ZSBpZiAobWF4X3JldHJ5LS0gPiAwKSB7Ci0JCQkvKiBPbGRlciBmaXJtd2FyZXMgaGF2ZSBhIHJh
Y2UgaW4gc2xlZXAvd2FrZS11cCBwcm9jZXNzLgotCQkJICogUmVkbyB0aGUgcHJvY2VzcyBpcyBz
dWZmaWNpZW50IHRvIHVuZnJlZXplIHRoZQotCQkJICogY2hpcC4KLQkJCSAqLwotCQkJZGV2X2Vy
cih3ZGV2LT5kZXYsICJ0aW1lb3V0IHdoaWxlIHdha2UgdXAgY2hpcFxuIik7Ci0JCQlncGlvZF9z
ZXRfdmFsdWVfY2Fuc2xlZXAod2Rldi0+cGRhdGEuZ3Bpb193YWtldXAsIDApOwotCQkJdXNsZWVw
X3JhbmdlKDIwMDAsIDI1MDApOwotCQl9IGVsc2UgewotCQkJZGV2X2Vycih3ZGV2LT5kZXYsICJt
YXggd2FrZS11cCByZXRyaWVzIHJlYWNoZWRcbiIpOwotCQkJcmV0dXJuOwotCQl9Ci0JfQotfQot
Ci1zdGF0aWMgdm9pZCBkZXZpY2VfcmVsZWFzZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKLXsKLQlp
ZiAoIXdkZXYtPnBkYXRhLmdwaW9fd2FrZXVwKQotCQlyZXR1cm47Ci0KLQlncGlvZF9zZXRfdmFs
dWVfY2Fuc2xlZXAod2Rldi0+cGRhdGEuZ3Bpb193YWtldXAsIDApOwotfQotCi1zdGF0aWMgaW50
IHJ4X2hlbHBlcihzdHJ1Y3Qgd2Z4X2RldiAqd2Rldiwgc2l6ZV90IHJlYWRfbGVuLCBpbnQgKmlz
X2NuZikKLXsKLQlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCXN0cnVjdCBoaWZfbXNnICpoaWY7Ci0J
c2l6ZV90IGFsbG9jX2xlbjsKLQlzaXplX3QgY29tcHV0ZWRfbGVuOwotCWludCByZWxlYXNlX2Nv
dW50OwotCWludCBwaWdneWJhY2sgPSAwOwotCi0JV0FSTihyZWFkX2xlbiA+IHJvdW5kX2Rvd24o
MHhGRkYsIDIpICogc2l6ZW9mKHUxNiksCi0JICAgICAiJXM6IHJlcXVlc3QgZXhjZWVkIHRoZSBj
aGlwIGNhcGFiaWxpdHkiLCBfX2Z1bmNfXyk7Ci0KLQkvKiBBZGQgMiB0byB0YWtlIGludG8gYWNj
b3VudCBwaWdneWJhY2sgc2l6ZSAqLwotCWFsbG9jX2xlbiA9IHdkZXYtPmh3YnVzX29wcy0+YWxp
Z25fc2l6ZSh3ZGV2LT5od2J1c19wcml2LCByZWFkX2xlbiArIDIpOwotCXNrYiA9IGRldl9hbGxv
Y19za2IoYWxsb2NfbGVuKTsKLQlpZiAoIXNrYikKLQkJcmV0dXJuIC1FTk9NRU07Ci0KLQlpZiAo
d2Z4X2RhdGFfcmVhZCh3ZGV2LCBza2ItPmRhdGEsIGFsbG9jX2xlbikpCi0JCWdvdG8gZXJyOwot
Ci0JcGlnZ3liYWNrID0gbGUxNl90b19jcHVwKChfX2xlMTYgKikoc2tiLT5kYXRhICsgYWxsb2Nf
bGVuIC0gMikpOwotCV90cmFjZV9waWdneWJhY2socGlnZ3liYWNrLCBmYWxzZSk7Ci0KLQloaWYg
PSAoc3RydWN0IGhpZl9tc2cgKilza2ItPmRhdGE7Ci0JV0FSTihoaWYtPmVuY3J5cHRlZCAmIDB4
MywgImVuY3J5cHRpb24gaXMgdW5zdXBwb3J0ZWQiKTsKLQlpZiAoV0FSTihyZWFkX2xlbiA8IHNp
emVvZihzdHJ1Y3QgaGlmX21zZyksICJjb3JydXB0ZWQgcmVhZCIpKQotCQlnb3RvIGVycjsKLQlj
b21wdXRlZF9sZW4gPSBsZTE2X3RvX2NwdShoaWYtPmxlbik7Ci0JY29tcHV0ZWRfbGVuID0gcm91
bmRfdXAoY29tcHV0ZWRfbGVuLCAyKTsKLQlpZiAoY29tcHV0ZWRfbGVuICE9IHJlYWRfbGVuKSB7
Ci0JCWRldl9lcnIod2Rldi0+ZGV2LCAiaW5jb25zaXN0ZW50IG1lc3NhZ2UgbGVuZ3RoOiAlenUg
IT0gJXp1XG4iLAotCQkJY29tcHV0ZWRfbGVuLCByZWFkX2xlbik7Ci0JCXByaW50X2hleF9kdW1w
KEtFUk5fSU5GTywgImhpZjogIiwgRFVNUF9QUkVGSVhfT0ZGU0VULCAxNiwgMSwKLQkJCSAgICAg
ICBoaWYsIHJlYWRfbGVuLCB0cnVlKTsKLQkJZ290byBlcnI7Ci0JfQotCi0JaWYgKCEoaGlmLT5p
ZCAmIEhJRl9JRF9JU19JTkRJQ0FUSU9OKSkgewotCQkoKmlzX2NuZikrKzsKLQkJaWYgKGhpZi0+
aWQgPT0gSElGX0NORl9JRF9NVUxUSV9UUkFOU01JVCkKLQkJCXJlbGVhc2VfY291bnQgPSAoKHN0
cnVjdCBoaWZfY25mX211bHRpX3RyYW5zbWl0ICopaGlmLT5ib2R5KS0+bnVtX3R4X2NvbmZzOwot
CQllbHNlCi0JCQlyZWxlYXNlX2NvdW50ID0gMTsKLQkJV0FSTih3ZGV2LT5oaWYudHhfYnVmZmVy
c191c2VkIDwgcmVsZWFzZV9jb3VudCwgImNvcnJ1cHRlZCBidWZmZXIgY291bnRlciIpOwotCQl3
ZGV2LT5oaWYudHhfYnVmZmVyc191c2VkIC09IHJlbGVhc2VfY291bnQ7Ci0JfQotCV90cmFjZV9o
aWZfcmVjdihoaWYsIHdkZXYtPmhpZi50eF9idWZmZXJzX3VzZWQpOwotCi0JaWYgKGhpZi0+aWQg
IT0gSElGX0lORF9JRF9FWENFUFRJT04gJiYgaGlmLT5pZCAhPSBISUZfSU5EX0lEX0VSUk9SKSB7
Ci0JCWlmIChoaWYtPnNlcW51bSAhPSB3ZGV2LT5oaWYucnhfc2VxbnVtKQotCQkJZGV2X3dhcm4o
d2Rldi0+ZGV2LCAid3JvbmcgbWVzc2FnZSBzZXF1ZW5jZTogJWQgIT0gJWRcbiIsCi0JCQkJIGhp
Zi0+c2VxbnVtLCB3ZGV2LT5oaWYucnhfc2VxbnVtKTsKLQkJd2Rldi0+aGlmLnJ4X3NlcW51bSA9
IChoaWYtPnNlcW51bSArIDEpICUgKEhJRl9DT1VOVEVSX01BWCArIDEpOwotCX0KLQotCXNrYl9w
dXQoc2tiLCBsZTE2X3RvX2NwdShoaWYtPmxlbikpOwotCS8qIHdmeF9oYW5kbGVfcnggdGFrZXMg
Y2FyZSBvbiBTS0IgbGl2ZXRpbWUgKi8KLQl3ZnhfaGFuZGxlX3J4KHdkZXYsIHNrYik7Ci0JaWYg
KCF3ZGV2LT5oaWYudHhfYnVmZmVyc191c2VkKQotCQl3YWtlX3VwKCZ3ZGV2LT5oaWYudHhfYnVm
ZmVyc19lbXB0eSk7Ci0KLQlyZXR1cm4gcGlnZ3liYWNrOwotCi1lcnI6Ci0JaWYgKHNrYikKLQkJ
ZGV2X2tmcmVlX3NrYihza2IpOwotCXJldHVybiAtRUlPOwotfQotCi1zdGF0aWMgaW50IGJoX3dv
cmtfcngoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBtYXhfbXNnLCBpbnQgKm51bV9jbmYpCi17
Ci0Jc2l6ZV90IGxlbjsKLQlpbnQgaTsKLQlpbnQgY3RybF9yZWcsIHBpZ2d5YmFjazsKLQotCXBp
Z2d5YmFjayA9IDA7Ci0JZm9yIChpID0gMDsgaSA8IG1heF9tc2c7IGkrKykgewotCQlpZiAocGln
Z3liYWNrICYgQ1RSTF9ORVhUX0xFTl9NQVNLKQotCQkJY3RybF9yZWcgPSBwaWdneWJhY2s7Ci0J
CWVsc2UgaWYgKHRyeV93YWl0X2Zvcl9jb21wbGV0aW9uKCZ3ZGV2LT5oaWYuY3RybF9yZWFkeSkp
Ci0JCQljdHJsX3JlZyA9IGF0b21pY194Y2hnKCZ3ZGV2LT5oaWYuY3RybF9yZWcsIDApOwotCQll
bHNlCi0JCQljdHJsX3JlZyA9IDA7Ci0JCWlmICghKGN0cmxfcmVnICYgQ1RSTF9ORVhUX0xFTl9N
QVNLKSkKLQkJCXJldHVybiBpOwotCQkvKiBjdHJsX3JlZyB1bml0cyBhcmUgMTZiaXRzIHdvcmRz
ICovCi0JCWxlbiA9IChjdHJsX3JlZyAmIENUUkxfTkVYVF9MRU5fTUFTSykgKiAyOwotCQlwaWdn
eWJhY2sgPSByeF9oZWxwZXIod2RldiwgbGVuLCBudW1fY25mKTsKLQkJaWYgKHBpZ2d5YmFjayA8
IDApCi0JCQlyZXR1cm4gaTsKLQkJaWYgKCEocGlnZ3liYWNrICYgQ1RSTF9XTEFOX1JFQURZKSkK
LQkJCWRldl9lcnIod2Rldi0+ZGV2LCAidW5leHBlY3RlZCBwaWdneWJhY2sgdmFsdWU6IHJlYWR5
IGJpdCBub3Qgc2V0OiAlMDR4XG4iLAotCQkJCXBpZ2d5YmFjayk7Ci0JfQotCWlmIChwaWdneWJh
Y2sgJiBDVFJMX05FWFRfTEVOX01BU0spIHsKLQkJY3RybF9yZWcgPSBhdG9taWNfeGNoZygmd2Rl
di0+aGlmLmN0cmxfcmVnLCBwaWdneWJhY2spOwotCQljb21wbGV0ZSgmd2Rldi0+aGlmLmN0cmxf
cmVhZHkpOwotCQlpZiAoY3RybF9yZWcpCi0JCQlkZXZfZXJyKHdkZXYtPmRldiwgInVuZXhwZWN0
ZWQgSVJRIGhhcHBlbmVkOiAlMDR4LyUwNHhcbiIsCi0JCQkJY3RybF9yZWcsIHBpZ2d5YmFjayk7
Ci0JfQotCXJldHVybiBpOwotfQotCi1zdGF0aWMgdm9pZCB0eF9oZWxwZXIoc3RydWN0IHdmeF9k
ZXYgKndkZXYsIHN0cnVjdCBoaWZfbXNnICpoaWYpCi17Ci0JaW50IHJldDsKLQl2b2lkICpkYXRh
OwotCWJvb2wgaXNfZW5jcnlwdGVkID0gZmFsc2U7Ci0Jc2l6ZV90IGxlbiA9IGxlMTZfdG9fY3B1
KGhpZi0+bGVuKTsKLQotCVdBUk4obGVuIDwgc2l6ZW9mKCpoaWYpLCAidHJ5IHRvIHNlbmQgY29y
cnVwdGVkIGRhdGEiKTsKLQotCWhpZi0+c2VxbnVtID0gd2Rldi0+aGlmLnR4X3NlcW51bTsKLQl3
ZGV2LT5oaWYudHhfc2VxbnVtID0gKHdkZXYtPmhpZi50eF9zZXFudW0gKyAxKSAlIChISUZfQ09V
TlRFUl9NQVggKyAxKTsKLQotCWRhdGEgPSBoaWY7Ci0JV0FSTihsZW4gPiB3ZGV2LT5od19jYXBz
LnNpemVfaW5wX2NoX2J1ZiwKLQkgICAgICIlczogcmVxdWVzdCBleGNlZWQgdGhlIGNoaXAgY2Fw
YWJpbGl0eTogJXp1ID4gJWRcbiIsIF9fZnVuY19fLAotCSAgICAgbGVuLCB3ZGV2LT5od19jYXBz
LnNpemVfaW5wX2NoX2J1Zik7Ci0JbGVuID0gd2Rldi0+aHdidXNfb3BzLT5hbGlnbl9zaXplKHdk
ZXYtPmh3YnVzX3ByaXYsIGxlbik7Ci0JcmV0ID0gd2Z4X2RhdGFfd3JpdGUod2RldiwgZGF0YSwg
bGVuKTsKLQlpZiAocmV0KQotCQlnb3RvIGVuZDsKLQotCXdkZXYtPmhpZi50eF9idWZmZXJzX3Vz
ZWQrKzsKLQlfdHJhY2VfaGlmX3NlbmQoaGlmLCB3ZGV2LT5oaWYudHhfYnVmZmVyc191c2VkKTsK
LWVuZDoKLQlpZiAoaXNfZW5jcnlwdGVkKQotCQlrZnJlZShkYXRhKTsKLX0KLQotc3RhdGljIGlu
dCBiaF93b3JrX3R4KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgbWF4X21zZykKLXsKLQlzdHJ1
Y3QgaGlmX21zZyAqaGlmOwotCWludCBpOwotCi0JZm9yIChpID0gMDsgaSA8IG1heF9tc2c7IGkr
KykgewotCQloaWYgPSBOVUxMOwotCQlpZiAod2Rldi0+aGlmLnR4X2J1ZmZlcnNfdXNlZCA8IHdk
ZXYtPmh3X2NhcHMubnVtX2lucF9jaF9idWZzKSB7Ci0JCQlpZiAodHJ5X3dhaXRfZm9yX2NvbXBs
ZXRpb24oJndkZXYtPmhpZl9jbWQucmVhZHkpKSB7Ci0JCQkJV0FSTighbXV0ZXhfaXNfbG9ja2Vk
KCZ3ZGV2LT5oaWZfY21kLmxvY2spLCAiZGF0YSBsb2NraW5nIGVycm9yIik7Ci0JCQkJaGlmID0g
d2Rldi0+aGlmX2NtZC5idWZfc2VuZDsKLQkJCX0gZWxzZSB7Ci0JCQkJaGlmID0gd2Z4X3R4X3F1
ZXVlc19nZXQod2Rldik7Ci0JCQl9Ci0JCX0KLQkJaWYgKCFoaWYpCi0JCQlyZXR1cm4gaTsKLQkJ
dHhfaGVscGVyKHdkZXYsIGhpZik7Ci0JfQotCXJldHVybiBpOwotfQotCi0vKiBJbiBTRElPIG1v
ZGUsIGl0IGlzIG5lY2Vzc2FyeSB0byBtYWtlIGFuIGFjY2VzcyB0byBhIHJlZ2lzdGVyIHRvIGFj
a25vd2xlZGdlCi0gKiBsYXN0IHJlY2VpdmVkIG1lc3NhZ2UuIEl0IGNvdWxkIGJlIHBvc3NpYmxl
IHRvIHJlc3RyaWN0IHRoaXMgYWNrbm93bGVkZ2UgdG8KLSAqIFNESU8gbW9kZSBhbmQgb25seSBp
ZiBsYXN0IG9wZXJhdGlvbiB3YXMgcnguCi0gKi8KLXN0YXRpYyB2b2lkIGFja19zZGlvX2RhdGEo
c3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JdTMyIGNmZ19yZWc7Ci0KLQljb25maWdfcmVnX3Jl
YWQod2RldiwgJmNmZ19yZWcpOwotCWlmIChjZmdfcmVnICYgMHhGRikgewotCQlkZXZfd2Fybih3
ZGV2LT5kZXYsICJjaGlwIHJlcG9ydHMgZXJyb3JzOiAlMDJ4XG4iLAotCQkJIGNmZ19yZWcgJiAw
eEZGKTsKLQkJY29uZmlnX3JlZ193cml0ZV9iaXRzKHdkZXYsIDB4RkYsIDB4MDApOwotCX0KLX0K
LQotc3RhdGljIHZvaWQgYmhfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCi17Ci0Jc3Ry
dWN0IHdmeF9kZXYgKndkZXYgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IHdmeF9kZXYsIGhp
Zi5iaCk7Ci0JaW50IHN0YXRzX3JlcSA9IDAsIHN0YXRzX2NuZiA9IDAsIHN0YXRzX2luZCA9IDA7
Ci0JYm9vbCByZWxlYXNlX2NoaXAgPSBmYWxzZSwgbGFzdF9vcF9pc19yeCA9IGZhbHNlOwotCWlu
dCBudW1fdHgsIG51bV9yeDsKLQotCWRldmljZV93YWtldXAod2Rldik7Ci0JZG8gewotCQludW1f
dHggPSBiaF93b3JrX3R4KHdkZXYsIDMyKTsKLQkJc3RhdHNfcmVxICs9IG51bV90eDsKLQkJaWYg
KG51bV90eCkKLQkJCWxhc3Rfb3BfaXNfcnggPSBmYWxzZTsKLQkJbnVtX3J4ID0gYmhfd29ya19y
eCh3ZGV2LCAzMiwgJnN0YXRzX2NuZik7Ci0JCXN0YXRzX2luZCArPSBudW1fcng7Ci0JCWlmIChu
dW1fcngpCi0JCQlsYXN0X29wX2lzX3J4ID0gdHJ1ZTsKLQl9IHdoaWxlIChudW1fcnggfHwgbnVt
X3R4KTsKLQlzdGF0c19pbmQgLT0gc3RhdHNfY25mOwotCi0JaWYgKGxhc3Rfb3BfaXNfcngpCi0J
CWFja19zZGlvX2RhdGEod2Rldik7Ci0JaWYgKCF3ZGV2LT5oaWYudHhfYnVmZmVyc191c2VkICYm
ICF3b3JrX3BlbmRpbmcod29yaykpIHsKLQkJZGV2aWNlX3JlbGVhc2Uod2Rldik7Ci0JCXJlbGVh
c2VfY2hpcCA9IHRydWU7Ci0JfQotCV90cmFjZV9iaF9zdGF0cyhzdGF0c19pbmQsIHN0YXRzX3Jl
cSwgc3RhdHNfY25mLAotCQkJd2Rldi0+aGlmLnR4X2J1ZmZlcnNfdXNlZCwgcmVsZWFzZV9jaGlw
KTsKLX0KLQotLyogQW4gSVJRIGZyb20gY2hpcCBkaWQgb2NjdXIgKi8KLXZvaWQgd2Z4X2JoX3Jl
cXVlc3Rfcngoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JdTMyIGN1ciwgcHJldjsKLQotCWNv
bnRyb2xfcmVnX3JlYWQod2RldiwgJmN1cik7Ci0JcHJldiA9IGF0b21pY194Y2hnKCZ3ZGV2LT5o
aWYuY3RybF9yZWcsIGN1cik7Ci0JY29tcGxldGUoJndkZXYtPmhpZi5jdHJsX3JlYWR5KTsKLQlx
dWV1ZV93b3JrKHN5c3RlbV9oaWdocHJpX3dxLCAmd2Rldi0+aGlmLmJoKTsKLQotCWlmICghKGN1
ciAmIENUUkxfTkVYVF9MRU5fTUFTSykpCi0JCWRldl9lcnIod2Rldi0+ZGV2LCAidW5leHBlY3Rl
ZCBjb250cm9sIHJlZ2lzdGVyIHZhbHVlOiBsZW5ndGggZmllbGQgaXMgMDogJTA0eFxuIiwKLQkJ
CWN1cik7Ci0JaWYgKHByZXYgIT0gMCkKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICJyZWNlaXZlZCBJ
UlEgYnV0IHByZXZpb3VzIGRhdGEgd2FzIG5vdCAoeWV0KSByZWFkOiAlMDR4LyUwNHhcbiIsCi0J
CQlwcmV2LCBjdXIpOwotfQotCi0vKiBEcml2ZXIgd2FudCB0byBzZW5kIGRhdGEgKi8KLXZvaWQg
d2Z4X2JoX3JlcXVlc3RfdHgoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JcXVldWVfd29yayhz
eXN0ZW1faGlnaHByaV93cSwgJndkZXYtPmhpZi5iaCk7Ci19Ci0KLS8qIElmIElSUSBpcyBub3Qg
YXZhaWxhYmxlLCB0aGlzIGZ1bmN0aW9uIGFsbG93IHRvIG1hbnVhbGx5IHBvbGwgdGhlIGNvbnRy
b2wKLSAqIHJlZ2lzdGVyIGFuZCBzaW11bGF0ZSBhbiBJUlEgYWhlbiBhbiBldmVudCBoYXBwZW5l
ZC4KLSAqCi0gKiBOb3RlIHRoYXQgdGhlIGRldmljZSBoYXMgYSBidWc6IElmIGFuIElSUSByYWlz
ZSB3aGlsZSBob3N0IHJlYWQgY29udHJvbAotICogcmVnaXN0ZXIsIHRoZSBJUlEgaXMgbG9zdC4g
U28sIHVzZSB0aGlzIGZ1bmN0aW9uIGNhcmVmdWxseSAob25seSBkdWluZwotICogZGV2aWNlIGlu
aXRpYWxpc2F0aW9uKS4KLSAqLwotdm9pZCB3ZnhfYmhfcG9sbF9pcnEoc3RydWN0IHdmeF9kZXYg
KndkZXYpCi17Ci0Ja3RpbWVfdCBub3csIHN0YXJ0OwotCXUzMiByZWc7Ci0KLQlXQVJOKCF3ZGV2
LT5wb2xsX2lycSwgInVuZXhwZWN0ZWQgSVJRIHBvbGxpbmcgY2FuIG1hc2sgSVJRIik7Ci0Jc3Rh
cnQgPSBrdGltZV9nZXQoKTsKLQlmb3IgKDs7KSB7Ci0JCWNvbnRyb2xfcmVnX3JlYWQod2Rldiwg
JnJlZyk7Ci0JCW5vdyA9IGt0aW1lX2dldCgpOwotCQlpZiAocmVnICYgMHhGRkYpCi0JCQlicmVh
azsKLQkJaWYgKGt0aW1lX2FmdGVyKG5vdywga3RpbWVfYWRkX21zKHN0YXJ0LCAxMDAwKSkpIHsK
LQkJCWRldl9lcnIod2Rldi0+ZGV2LCAidGltZSBvdXQgd2hpbGUgcG9sbGluZyBjb250cm9sIHJl
Z2lzdGVyXG4iKTsKLQkJCXJldHVybjsKLQkJfQotCQl1ZGVsYXkoMjAwKTsKLQl9Ci0Jd2Z4X2Jo
X3JlcXVlc3Rfcngod2Rldik7Ci19Ci0KLXZvaWQgd2Z4X2JoX3JlZ2lzdGVyKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2KQotewotCUlOSVRfV09SSygmd2Rldi0+aGlmLmJoLCBiaF93b3JrKTsKLQlpbml0
X2NvbXBsZXRpb24oJndkZXYtPmhpZi5jdHJsX3JlYWR5KTsKLQlpbml0X3dhaXRxdWV1ZV9oZWFk
KCZ3ZGV2LT5oaWYudHhfYnVmZmVyc19lbXB0eSk7Ci19Ci0KLXZvaWQgd2Z4X2JoX3VucmVnaXN0
ZXIoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JZmx1c2hfd29yaygmd2Rldi0+aGlmLmJoKTsK
LX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvYmguaCBiL2RyaXZlcnMvc3RhZ2lu
Zy93ZngvYmguaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNmMxMjFjZTRkZDNmLi4w
MDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9iaC5oCisrKyAvZGV2L251bGwK
QEAgLTEsMzMgKzAsMCBAQAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25s
eSAqLwotLyoKLSAqIEludGVycnVwdCBib3R0b20gaGFsZiAoQkgpLgotICoKLSAqIENvcHlyaWdo
dCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0
IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0jaWZuZGVmIFdGWF9CSF9ICi0jZGVmaW5lIFdG
WF9CSF9ICi0KLSNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KLSNpbmNsdWRlIDxsaW51eC93YWl0
Lmg+Ci0jaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+Ci0KLXN0cnVjdCB3ZnhfZGV2OwotCi1z
dHJ1Y3Qgd2Z4X2hpZiB7Ci0Jc3RydWN0IHdvcmtfc3RydWN0IGJoOwotCXN0cnVjdCBjb21wbGV0
aW9uIGN0cmxfcmVhZHk7Ci0Jd2FpdF9xdWV1ZV9oZWFkX3QgdHhfYnVmZmVyc19lbXB0eTsKLQlh
dG9taWNfdCBjdHJsX3JlZzsKLQlpbnQgcnhfc2VxbnVtOwotCWludCB0eF9zZXFudW07Ci0JaW50
IHR4X2J1ZmZlcnNfdXNlZDsKLX07Ci0KLXZvaWQgd2Z4X2JoX3JlZ2lzdGVyKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2KTsKLXZvaWQgd2Z4X2JoX3VucmVnaXN0ZXIoc3RydWN0IHdmeF9kZXYgKndkZXYp
Owotdm9pZCB3ZnhfYmhfcmVxdWVzdF9yeChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7Ci12b2lkIHdm
eF9iaF9yZXF1ZXN0X3R4KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLXZvaWQgd2Z4X2JoX3BvbGxf
aXJxKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJz
L3N0YWdpbmcvd2Z4L2J1cy5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9idXMuaApkZWxldGVkIGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggY2EwNGIzZGE2MjA0Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJp
dmVycy9zdGFnaW5nL3dmeC9idXMuaAorKysgL2Rldi9udWxsCkBAIC0xLDM4ICswLDAgQEAKLS8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KLS8qCi0gKiBDb21tb24g
YnVzIGFic3RyYWN0aW9uIGxheWVyLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBT
aWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmlj
c3NvbgotICovCi0jaWZuZGVmIFdGWF9CVVNfSAotI2RlZmluZSBXRlhfQlVTX0gKLQotI2luY2x1
ZGUgPGxpbnV4L21tYy9zZGlvX2Z1bmMuaD4KLSNpbmNsdWRlIDxsaW51eC9zcGkvc3BpLmg+Ci0K
LSNkZWZpbmUgV0ZYX1JFR19DT05GSUcgICAgICAgIDB4MAotI2RlZmluZSBXRlhfUkVHX0NPTlRS
T0wgICAgICAgMHgxCi0jZGVmaW5lIFdGWF9SRUdfSU5fT1VUX1FVRVVFICAweDIKLSNkZWZpbmUg
V0ZYX1JFR19BSEJfRFBPUlQgICAgIDB4MwotI2RlZmluZSBXRlhfUkVHX0JBU0VfQUREUiAgICAg
MHg0Ci0jZGVmaW5lIFdGWF9SRUdfU1JBTV9EUE9SVCAgICAweDUKLSNkZWZpbmUgV0ZYX1JFR19T
RVRfR0VOX1JfVyAgIDB4NgotI2RlZmluZSBXRlhfUkVHX0ZSQU1FX09VVCAgICAgMHg3Ci0KLXN0
cnVjdCBod2J1c19vcHMgewotCWludCAoKmNvcHlfZnJvbV9pbykodm9pZCAqYnVzX3ByaXYsIHVu
c2lnbmVkIGludCBhZGRyLAotCQkJICAgIHZvaWQgKmRzdCwgc2l6ZV90IGNvdW50KTsKLQlpbnQg
KCpjb3B5X3RvX2lvKSh2b2lkICpidXNfcHJpdiwgdW5zaWduZWQgaW50IGFkZHIsCi0JCQkgIGNv
bnN0IHZvaWQgKnNyYywgc2l6ZV90IGNvdW50KTsKLQlpbnQgKCppcnFfc3Vic2NyaWJlKSh2b2lk
ICpidXNfcHJpdik7Ci0JaW50ICgqaXJxX3Vuc3Vic2NyaWJlKSh2b2lkICpidXNfcHJpdik7Ci0J
dm9pZCAoKmxvY2spKHZvaWQgKmJ1c19wcml2KTsKLQl2b2lkICgqdW5sb2NrKSh2b2lkICpidXNf
cHJpdik7Ci0Jc2l6ZV90ICgqYWxpZ25fc2l6ZSkodm9pZCAqYnVzX3ByaXYsIHNpemVfdCBzaXpl
KTsKLX07Ci0KLWV4dGVybiBzdHJ1Y3Qgc2Rpb19kcml2ZXIgd2Z4X3NkaW9fZHJpdmVyOwotZXh0
ZXJuIHN0cnVjdCBzcGlfZHJpdmVyIHdmeF9zcGlfZHJpdmVyOwotCi0jZW5kaWYKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvYnVzX3NkaW8uYyBiL2RyaXZlcnMvc3RhZ2luZy93Zngv
YnVzX3NkaW8uYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggYTY3MDE3NmJhMDZmLi4w
MDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9idXNfc2Rpby5jCisrKyAvZGV2
L251bGwKQEAgLTEsMjcyICswLDAgQEAKLS8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wLW9ubHkKLS8qCi0gKiBTRElPIGludGVyZmFjZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIEluYy4KLSAqIENvcHlyaWdodCAoYykgMjAx
MCwgU1QtRXJpY3Nzb24KLSAqLwotI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgotI2luY2x1ZGUg
PGxpbnV4L21tYy9zZGlvLmg+Ci0jaW5jbHVkZSA8bGludXgvbW1jL3NkaW9fZnVuYy5oPgotI2lu
Y2x1ZGUgPGxpbnV4L21tYy9jYXJkLmg+Ci0jaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+Ci0j
aW5jbHVkZSA8bGludXgvb2ZfaXJxLmg+Ci0jaW5jbHVkZSA8bGludXgvaXJxLmg+Ci0KLSNpbmNs
dWRlICJidXMuaCIKLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJod2lvLmgiCi0jaW5jbHVk
ZSAibWFpbi5oIgotI2luY2x1ZGUgImJoLmgiCi0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgd2Z4X3Bs
YXRmb3JtX2RhdGEgd2Z4X3NkaW9fcGRhdGEgPSB7Ci0JLmZpbGVfZncgPSAid2ZtX3dmMjAwIiwK
LQkuZmlsZV9wZHMgPSAid2YyMDAucGRzIiwKLX07Ci0KLXN0cnVjdCB3Znhfc2Rpb19wcml2IHsK
LQlzdHJ1Y3Qgc2Rpb19mdW5jICpmdW5jOwotCXN0cnVjdCB3ZnhfZGV2ICpjb3JlOwotCXU4IGJ1
Zl9pZF90eDsKLQl1OCBidWZfaWRfcng7Ci0JaW50IG9mX2lycTsKLX07Ci0KLXN0YXRpYyBpbnQg
d2Z4X3NkaW9fY29weV9mcm9tX2lvKHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCByZWdfaWQsCi0J
CQkJIHZvaWQgKmRzdCwgc2l6ZV90IGNvdW50KQotewotCXN0cnVjdCB3Znhfc2Rpb19wcml2ICpi
dXMgPSBwcml2OwotCXVuc2lnbmVkIGludCBzZGlvX2FkZHIgPSByZWdfaWQgPDwgMjsKLQlpbnQg
cmV0OwotCi0JV0FSTihyZWdfaWQgPiA3LCAiY2hpcCBvbmx5IGhhcyA3IHJlZ2lzdGVycyIpOwot
CVdBUk4oKCh1aW50cHRyX3QpZHN0KSAmIDMsICJ1bmFsaWduZWQgYnVmZmVyIHNpemUiKTsKLQlX
QVJOKGNvdW50ICYgMywgInVuYWxpZ25lZCBidWZmZXIgYWRkcmVzcyIpOwotCi0JLyogVXNlIHF1
ZXVlIG1vZGUgYnVmZmVycyAqLwotCWlmIChyZWdfaWQgPT0gV0ZYX1JFR19JTl9PVVRfUVVFVUUp
Ci0JCXNkaW9fYWRkciB8PSAoYnVzLT5idWZfaWRfcnggKyAxKSA8PCA3OwotCXJldCA9IHNkaW9f
bWVtY3B5X2Zyb21pbyhidXMtPmZ1bmMsIGRzdCwgc2Rpb19hZGRyLCBjb3VudCk7Ci0JaWYgKCFy
ZXQgJiYgcmVnX2lkID09IFdGWF9SRUdfSU5fT1VUX1FVRVVFKQotCQlidXMtPmJ1Zl9pZF9yeCA9
IChidXMtPmJ1Zl9pZF9yeCArIDEpICUgNDsKLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBp
bnQgd2Z4X3NkaW9fY29weV90b19pbyh2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgcmVnX2lkLAot
CQkJICAgICAgIGNvbnN0IHZvaWQgKnNyYywgc2l6ZV90IGNvdW50KQotewotCXN0cnVjdCB3Znhf
c2Rpb19wcml2ICpidXMgPSBwcml2OwotCXVuc2lnbmVkIGludCBzZGlvX2FkZHIgPSByZWdfaWQg
PDwgMjsKLQlpbnQgcmV0OwotCi0JV0FSTihyZWdfaWQgPiA3LCAiY2hpcCBvbmx5IGhhcyA3IHJl
Z2lzdGVycyIpOwotCVdBUk4oKCh1aW50cHRyX3Qpc3JjKSAmIDMsICJ1bmFsaWduZWQgYnVmZmVy
IHNpemUiKTsKLQlXQVJOKGNvdW50ICYgMywgInVuYWxpZ25lZCBidWZmZXIgYWRkcmVzcyIpOwot
Ci0JLyogVXNlIHF1ZXVlIG1vZGUgYnVmZmVycyAqLwotCWlmIChyZWdfaWQgPT0gV0ZYX1JFR19J
Tl9PVVRfUVVFVUUpCi0JCXNkaW9fYWRkciB8PSBidXMtPmJ1Zl9pZF90eCA8PCA3OwotCS8qIEZJ
WE1FOiBkaXNjYXJkcyAnY29uc3QnIHF1YWxpZmllciBmb3Igc3JjICovCi0JcmV0ID0gc2Rpb19t
ZW1jcHlfdG9pbyhidXMtPmZ1bmMsIHNkaW9fYWRkciwgKHZvaWQgKilzcmMsIGNvdW50KTsKLQlp
ZiAoIXJldCAmJiByZWdfaWQgPT0gV0ZYX1JFR19JTl9PVVRfUVVFVUUpCi0JCWJ1cy0+YnVmX2lk
X3R4ID0gKGJ1cy0+YnVmX2lkX3R4ICsgMSkgJSAzMjsKLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0
YXRpYyB2b2lkIHdmeF9zZGlvX2xvY2sodm9pZCAqcHJpdikKLXsKLQlzdHJ1Y3Qgd2Z4X3NkaW9f
cHJpdiAqYnVzID0gcHJpdjsKLQotCXNkaW9fY2xhaW1faG9zdChidXMtPmZ1bmMpOwotfQotCi1z
dGF0aWMgdm9pZCB3Znhfc2Rpb191bmxvY2sodm9pZCAqcHJpdikKLXsKLQlzdHJ1Y3Qgd2Z4X3Nk
aW9fcHJpdiAqYnVzID0gcHJpdjsKLQotCXNkaW9fcmVsZWFzZV9ob3N0KGJ1cy0+ZnVuYyk7Ci19
Ci0KLXN0YXRpYyB2b2lkIHdmeF9zZGlvX2lycV9oYW5kbGVyKHN0cnVjdCBzZGlvX2Z1bmMgKmZ1
bmMpCi17Ci0Jc3RydWN0IHdmeF9zZGlvX3ByaXYgKmJ1cyA9IHNkaW9fZ2V0X2RydmRhdGEoZnVu
Yyk7Ci0KLQl3ZnhfYmhfcmVxdWVzdF9yeChidXMtPmNvcmUpOwotfQotCi1zdGF0aWMgaXJxcmV0
dXJuX3Qgd2Z4X3NkaW9faXJxX2hhbmRsZXJfZXh0KGludCBpcnEsIHZvaWQgKnByaXYpCi17Ci0J
c3RydWN0IHdmeF9zZGlvX3ByaXYgKmJ1cyA9IHByaXY7Ci0KLQlzZGlvX2NsYWltX2hvc3QoYnVz
LT5mdW5jKTsKLQl3ZnhfYmhfcmVxdWVzdF9yeChidXMtPmNvcmUpOwotCXNkaW9fcmVsZWFzZV9o
b3N0KGJ1cy0+ZnVuYyk7Ci0JcmV0dXJuIElSUV9IQU5ETEVEOwotfQotCi1zdGF0aWMgaW50IHdm
eF9zZGlvX2lycV9zdWJzY3JpYmUodm9pZCAqcHJpdikKLXsKLQlzdHJ1Y3Qgd2Z4X3NkaW9fcHJp
diAqYnVzID0gcHJpdjsKLQl1MzIgZmxhZ3M7Ci0JaW50IHJldDsKLQl1OCBjY2NyOwotCi0JaWYg
KCFidXMtPm9mX2lycSkgewotCQlzZGlvX2NsYWltX2hvc3QoYnVzLT5mdW5jKTsKLQkJcmV0ID0g
c2Rpb19jbGFpbV9pcnEoYnVzLT5mdW5jLCB3Znhfc2Rpb19pcnFfaGFuZGxlcik7Ci0JCXNkaW9f
cmVsZWFzZV9ob3N0KGJ1cy0+ZnVuYyk7Ci0JCXJldHVybiByZXQ7Ci0JfQotCi0JZmxhZ3MgPSBp
cnFfZ2V0X3RyaWdnZXJfdHlwZShidXMtPm9mX2lycSk7Ci0JaWYgKCFmbGFncykKLQkJZmxhZ3Mg
PSBJUlFGX1RSSUdHRVJfSElHSDsKLQlmbGFncyB8PSBJUlFGX09ORVNIT1Q7Ci0JcmV0ID0gZGV2
bV9yZXF1ZXN0X3RocmVhZGVkX2lycSgmYnVzLT5mdW5jLT5kZXYsIGJ1cy0+b2ZfaXJxLCBOVUxM
LAotCQkJCQl3Znhfc2Rpb19pcnFfaGFuZGxlcl9leHQsIGZsYWdzLAotCQkJCQkid2Z4IiwgYnVz
KTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCXNkaW9fY2xhaW1faG9zdChidXMtPmZ1bmMp
OwotCWNjY3IgPSBzZGlvX2YwX3JlYWRiKGJ1cy0+ZnVuYywgU0RJT19DQ0NSX0lFTngsIE5VTEwp
OwotCWNjY3IgfD0gQklUKDApOwotCWNjY3IgfD0gQklUKGJ1cy0+ZnVuYy0+bnVtKTsKLQlzZGlv
X2YwX3dyaXRlYihidXMtPmZ1bmMsIGNjY3IsIFNESU9fQ0NDUl9JRU54LCBOVUxMKTsKLQlzZGlv
X3JlbGVhc2VfaG9zdChidXMtPmZ1bmMpOwotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHdm
eF9zZGlvX2lycV91bnN1YnNjcmliZSh2b2lkICpwcml2KQotewotCXN0cnVjdCB3Znhfc2Rpb19w
cml2ICpidXMgPSBwcml2OwotCWludCByZXQ7Ci0KLQlpZiAoYnVzLT5vZl9pcnEpCi0JCWRldm1f
ZnJlZV9pcnEoJmJ1cy0+ZnVuYy0+ZGV2LCBidXMtPm9mX2lycSwgYnVzKTsKLQlzZGlvX2NsYWlt
X2hvc3QoYnVzLT5mdW5jKTsKLQlyZXQgPSBzZGlvX3JlbGVhc2VfaXJxKGJ1cy0+ZnVuYyk7Ci0J
c2Rpb19yZWxlYXNlX2hvc3QoYnVzLT5mdW5jKTsKLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMg
c2l6ZV90IHdmeF9zZGlvX2FsaWduX3NpemUodm9pZCAqcHJpdiwgc2l6ZV90IHNpemUpCi17Ci0J
c3RydWN0IHdmeF9zZGlvX3ByaXYgKmJ1cyA9IHByaXY7Ci0KLQlyZXR1cm4gc2Rpb19hbGlnbl9z
aXplKGJ1cy0+ZnVuYywgc2l6ZSk7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgaHdidXNfb3Bz
IHdmeF9zZGlvX2h3YnVzX29wcyA9IHsKLQkuY29weV9mcm9tX2lvID0gd2Z4X3NkaW9fY29weV9m
cm9tX2lvLAotCS5jb3B5X3RvX2lvID0gd2Z4X3NkaW9fY29weV90b19pbywKLQkuaXJxX3N1YnNj
cmliZSA9IHdmeF9zZGlvX2lycV9zdWJzY3JpYmUsCi0JLmlycV91bnN1YnNjcmliZSA9IHdmeF9z
ZGlvX2lycV91bnN1YnNjcmliZSwKLQkubG9jawkJCT0gd2Z4X3NkaW9fbG9jaywKLQkudW5sb2Nr
CQkJPSB3Znhfc2Rpb191bmxvY2ssCi0JLmFsaWduX3NpemUJCT0gd2Z4X3NkaW9fYWxpZ25fc2l6
ZSwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHdmeF9zZGlvX29mX21h
dGNoW10gPSB7Ci0JeyAuY29tcGF0aWJsZSA9ICJzaWxhYnMsd2Z4LXNkaW8iIH0sCi0JeyAuY29t
cGF0aWJsZSA9ICJzaWxhYnMsd2YyMDAiIH0sCi0JeyB9LAotfTsKLU1PRFVMRV9ERVZJQ0VfVEFC
TEUob2YsIHdmeF9zZGlvX29mX21hdGNoKTsKLQotc3RhdGljIGludCB3Znhfc2Rpb19wcm9iZShz
dHJ1Y3Qgc2Rpb19mdW5jICpmdW5jLAotCQkJICBjb25zdCBzdHJ1Y3Qgc2Rpb19kZXZpY2VfaWQg
KmlkKQotewotCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAgPSBmdW5jLT5kZXYub2Zfbm9kZTsKLQlz
dHJ1Y3Qgd2Z4X3NkaW9fcHJpdiAqYnVzOwotCWludCByZXQ7Ci0KLQlpZiAoZnVuYy0+bnVtICE9
IDEpIHsKLQkJZGV2X2VycigmZnVuYy0+ZGV2LCAiU0RJTyBmdW5jdGlvbiBudW1iZXIgaXMgJWQg
d2hpbGUgaXQgc2hvdWxkIGFsd2F5cyBiZSAxICh1bnN1cHBvcnRlZCBjaGlwPylcbiIsCi0JCQlm
dW5jLT5udW0pOwotCQlyZXR1cm4gLUVOT0RFVjsKLQl9Ci0KLQlidXMgPSBkZXZtX2t6YWxsb2Mo
JmZ1bmMtPmRldiwgc2l6ZW9mKCpidXMpLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWJ1cykKLQkJcmV0
dXJuIC1FTk9NRU07Ci0KLQlpZiAobnApIHsKLQkJaWYgKCFvZl9tYXRjaF9ub2RlKHdmeF9zZGlv
X29mX21hdGNoLCBucCkpIHsKLQkJCWRldl93YXJuKCZmdW5jLT5kZXYsICJubyBjb21wYXRpYmxl
IGRldmljZSBmb3VuZCBpbiBEVFxuIik7Ci0JCQlyZXR1cm4gLUVOT0RFVjsKLQkJfQotCQlidXMt
Pm9mX2lycSA9IGlycV9vZl9wYXJzZV9hbmRfbWFwKG5wLCAwKTsKLQl9IGVsc2UgewotCQlkZXZf
d2FybigmZnVuYy0+ZGV2LAotCQkJICJkZXZpY2UgaXMgbm90IGRlY2xhcmVkIGluIERULCBmZWF0
dXJlcyB3aWxsIGJlIGxpbWl0ZWRcbiIpOwotCQkvKiBGSVhNRTogaWdub3JlIFZJRC9QSUQgYW5k
IG9ubHkgcmVseSBvbiBkZXZpY2UgdHJlZSAqLwotCQkvLyByZXR1cm4gLUVOT0RFVjsKLQl9Ci0K
LQlidXMtPmZ1bmMgPSBmdW5jOwotCXNkaW9fc2V0X2RydmRhdGEoZnVuYywgYnVzKTsKLQlmdW5j
LT5jYXJkLT5xdWlya3MgfD0gTU1DX1FVSVJLX0xFTklFTlRfRk4wIHwKLQkJCSAgICAgIE1NQ19R
VUlSS19CTEtTWl9GT1JfQllURV9NT0RFIHwKLQkJCSAgICAgIE1NQ19RVUlSS19CUk9LRU5fQllU
RV9NT0RFXzUxMjsKLQotCXNkaW9fY2xhaW1faG9zdChmdW5jKTsKLQlyZXQgPSBzZGlvX2VuYWJs
ZV9mdW5jKGZ1bmMpOwotCS8qIEJsb2NrIG9mIDY0IGJ5dGVzIGlzIG1vcmUgZWZmaWNpZW50IHRo
YW4gNTEyQiBmb3IgZnJhbWUgc2l6ZXMgPCA0ayAqLwotCXNkaW9fc2V0X2Jsb2NrX3NpemUoZnVu
YywgNjQpOwotCXNkaW9fcmVsZWFzZV9ob3N0KGZ1bmMpOwotCWlmIChyZXQpCi0JCWdvdG8gZXJy
MDsKLQotCWJ1cy0+Y29yZSA9IHdmeF9pbml0X2NvbW1vbigmZnVuYy0+ZGV2LCAmd2Z4X3NkaW9f
cGRhdGEsCi0JCQkJICAgICZ3Znhfc2Rpb19od2J1c19vcHMsIGJ1cyk7Ci0JaWYgKCFidXMtPmNv
cmUpIHsKLQkJcmV0ID0gLUVJTzsKLQkJZ290byBlcnIxOwotCX0KLQotCXJldCA9IHdmeF9wcm9i
ZShidXMtPmNvcmUpOwotCWlmIChyZXQpCi0JCWdvdG8gZXJyMTsKLQotCXJldHVybiAwOwotCi1l
cnIxOgotCXNkaW9fY2xhaW1faG9zdChmdW5jKTsKLQlzZGlvX2Rpc2FibGVfZnVuYyhmdW5jKTsK
LQlzZGlvX3JlbGVhc2VfaG9zdChmdW5jKTsKLWVycjA6Ci0JcmV0dXJuIHJldDsKLX0KLQotc3Rh
dGljIHZvaWQgd2Z4X3NkaW9fcmVtb3ZlKHN0cnVjdCBzZGlvX2Z1bmMgKmZ1bmMpCi17Ci0Jc3Ry
dWN0IHdmeF9zZGlvX3ByaXYgKmJ1cyA9IHNkaW9fZ2V0X2RydmRhdGEoZnVuYyk7Ci0KLQl3Znhf
cmVsZWFzZShidXMtPmNvcmUpOwotCXNkaW9fY2xhaW1faG9zdChmdW5jKTsKLQlzZGlvX2Rpc2Fi
bGVfZnVuYyhmdW5jKTsKLQlzZGlvX3JlbGVhc2VfaG9zdChmdW5jKTsKLX0KLQotI2RlZmluZSBT
RElPX1ZFTkRPUl9JRF9TSUxBQlMgICAgICAgIDB4MDAwMAotI2RlZmluZSBTRElPX0RFVklDRV9J
RF9TSUxBQlNfV0YyMDAgIDB4MTAwMAotc3RhdGljIGNvbnN0IHN0cnVjdCBzZGlvX2RldmljZV9p
ZCB3Znhfc2Rpb19pZHNbXSA9IHsKLQl7IFNESU9fREVWSUNFKFNESU9fVkVORE9SX0lEX1NJTEFC
UywgU0RJT19ERVZJQ0VfSURfU0lMQUJTX1dGMjAwKSB9LAotCS8qIEZJWE1FOiBpZ25vcmUgVklE
L1BJRCBhbmQgb25seSByZWx5IG9uIGRldmljZSB0cmVlICovCi0JLy8geyBTRElPX0RFVklDRShT
RElPX0FOWV9JRCwgU0RJT19BTllfSUQpIH0sCi0JeyB9LAotfTsKLU1PRFVMRV9ERVZJQ0VfVEFC
TEUoc2Rpbywgd2Z4X3NkaW9faWRzKTsKLQotc3RydWN0IHNkaW9fZHJpdmVyIHdmeF9zZGlvX2Ry
aXZlciA9IHsKLQkubmFtZSA9ICJ3Zngtc2RpbyIsCi0JLmlkX3RhYmxlID0gd2Z4X3NkaW9faWRz
LAotCS5wcm9iZSA9IHdmeF9zZGlvX3Byb2JlLAotCS5yZW1vdmUgPSB3Znhfc2Rpb19yZW1vdmUs
Ci0JLmRydiA9IHsKLQkJLm93bmVyID0gVEhJU19NT0RVTEUsCi0JCS5vZl9tYXRjaF90YWJsZSA9
IHdmeF9zZGlvX29mX21hdGNoLAotCX0KLX07CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
d2Z4L2J1c19zcGkuYyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvYnVzX3NwaS5jCmRlbGV0ZWQgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCA1NWZmY2Q3YzQyZTIuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2
ZXJzL3N0YWdpbmcvd2Z4L2J1c19zcGkuYworKysgL2Rldi9udWxsCkBAIC0xLDI3MSArMCwwIEBA
Ci0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Ci0vKgotICogU1BJIGlu
dGVyZmFjZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0
b3JpZXMsIEluYy4KLSAqIENvcHlyaWdodCAoYykgMjAxMSwgU2FncmFkIEluYy4KLSAqIENvcHly
aWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KLSAqLwotI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
PgotI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+Ci0jaW5jbHVkZSA8bGludXgvZ3Bpby9jb25zdW1l
ci5oPgotI2luY2x1ZGUgPGxpbnV4L3NwaS9zcGkuaD4KLSNpbmNsdWRlIDxsaW51eC9pbnRlcnJ1
cHQuaD4KLSNpbmNsdWRlIDxsaW51eC9pcnEuaD4KLSNpbmNsdWRlIDxsaW51eC9vZi5oPgotCi0j
aW5jbHVkZSAiYnVzLmgiCi0jaW5jbHVkZSAid2Z4LmgiCi0jaW5jbHVkZSAiaHdpby5oIgotI2lu
Y2x1ZGUgIm1haW4uaCIKLSNpbmNsdWRlICJiaC5oIgotCi0jZGVmaW5lIFNFVF9XUklURSAweDdG
RkYgICAgICAgIC8qIHVzYWdlOiBhbmQgb3BlcmF0aW9uICovCi0jZGVmaW5lIFNFVF9SRUFEIDB4
ODAwMCAgICAgICAgIC8qIHVzYWdlOiBvciBvcGVyYXRpb24gKi8KLQotI2RlZmluZSBXRlhfUkVT
RVRfSU5WRVJURUQgMQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IHdmeF9wbGF0Zm9ybV9kYXRhIHdm
eF9zcGlfcGRhdGEgPSB7Ci0JLmZpbGVfZncgPSAid2ZtX3dmMjAwIiwKLQkuZmlsZV9wZHMgPSAi
d2YyMDAucGRzIiwKLQkudXNlX3Jpc2luZ19jbGsgPSB0cnVlLAotfTsKLQotc3RydWN0IHdmeF9z
cGlfcHJpdiB7Ci0Jc3RydWN0IHNwaV9kZXZpY2UgKmZ1bmM7Ci0Jc3RydWN0IHdmeF9kZXYgKmNv
cmU7Ci0Jc3RydWN0IGdwaW9fZGVzYyAqZ3Bpb19yZXNldDsKLQlib29sIG5lZWRfc3dhYjsKLX07
Ci0KLS8qIFRoZSBjaGlwIHJlYWRzIDE2Yml0cyBvZiBkYXRhIGF0IHRpbWUgYW5kIHBsYWNlIHRo
ZW0gZGlyZWN0bHkgaW50byAobGl0dGxlCi0gKiBlbmRpYW4pIENQVSByZWdpc3Rlci4gU28sIHRo
ZSBjaGlwIGV4cGVjdHMgYnl0ZXMgb3JkZXIgdG8gYmUgIkIxIEIwIEIzIEIyIgotICogKHdoaWxl
IExFIGlzICJCMCBCMSBCMiBCMyIgYW5kIEJFIGlzICJCMyBCMiBCMSBCMCIpCi0gKgotICogQSBs
aXR0bGUgZW5kaWFuIGhvc3Qgd2l0aCBiaXRzX3Blcl93b3JkID09IDE2IHNob3VsZCBkbyB0aGUg
cmlnaHQgam9iCi0gKiBuYXRpdmVseS4gVGhlIGNvZGUgYmVsb3cgdG8gc3VwcG9ydCBiaWcgZW5k
aWFuIGhvc3QgYW5kIGNvbW1vbmx5IHVzZWQgU1BJCi0gKiA4Yml0cy4KLSAqLwotc3RhdGljIGlu
dCB3Znhfc3BpX2NvcHlfZnJvbV9pbyh2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgYWRkciwKLQkJ
CQl2b2lkICpkc3QsIHNpemVfdCBjb3VudCkKLXsKLQlzdHJ1Y3Qgd2Z4X3NwaV9wcml2ICpidXMg
PSBwcml2OwotCXUxNiByZWdhZGRyID0gKGFkZHIgPDwgMTIpIHwgKGNvdW50IC8gMikgfCBTRVRf
UkVBRDsKLQlzdHJ1Y3Qgc3BpX21lc3NhZ2UgICAgICBtOwotCXN0cnVjdCBzcGlfdHJhbnNmZXIg
ICAgIHRfYWRkciA9IHsKLQkJLnR4X2J1ZiAgICAgICAgID0gJnJlZ2FkZHIsCi0JCS5sZW4gICAg
ICAgICAgICA9IHNpemVvZihyZWdhZGRyKSwKLQl9OwotCXN0cnVjdCBzcGlfdHJhbnNmZXIgICAg
IHRfbXNnID0gewotCQkucnhfYnVmICAgICAgICAgPSBkc3QsCi0JCS5sZW4gICAgICAgICAgICA9
IGNvdW50LAotCX07Ci0JdTE2ICpkc3QxNiA9IGRzdDsKLQlpbnQgcmV0LCBpOwotCi0JV0FSTihj
b3VudCAlIDIsICJidWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMiIpOwotCi0JY3B1
X3RvX2xlMTZzKCZyZWdhZGRyKTsKLQlpZiAoYnVzLT5uZWVkX3N3YWIpCi0JCXN3YWIxNnMoJnJl
Z2FkZHIpOwotCi0Jc3BpX21lc3NhZ2VfaW5pdCgmbSk7Ci0Jc3BpX21lc3NhZ2VfYWRkX3RhaWwo
JnRfYWRkciwgJm0pOwotCXNwaV9tZXNzYWdlX2FkZF90YWlsKCZ0X21zZywgJm0pOwotCXJldCA9
IHNwaV9zeW5jKGJ1cy0+ZnVuYywgJm0pOwotCi0JaWYgKGJ1cy0+bmVlZF9zd2FiICYmIGFkZHIg
PT0gV0ZYX1JFR19DT05GSUcpCi0JCWZvciAoaSA9IDA7IGkgPCBjb3VudCAvIDI7IGkrKykKLQkJ
CXN3YWIxNnMoJmRzdDE2W2ldKTsKLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IHdmeF9z
cGlfY29weV90b19pbyh2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgYWRkciwKLQkJCSAgICAgIGNv
bnN0IHZvaWQgKnNyYywgc2l6ZV90IGNvdW50KQotewotCXN0cnVjdCB3Znhfc3BpX3ByaXYgKmJ1
cyA9IHByaXY7Ci0JdTE2IHJlZ2FkZHIgPSAoYWRkciA8PCAxMikgfCAoY291bnQgLyAyKTsKLQkv
KiBGSVhNRTogdXNlIGEgYm91bmNlIGJ1ZmZlciAqLwotCXUxNiAqc3JjMTYgPSAodm9pZCAqKXNy
YzsKLQlpbnQgcmV0LCBpOwotCXN0cnVjdCBzcGlfbWVzc2FnZSAgICAgIG07Ci0Jc3RydWN0IHNw
aV90cmFuc2ZlciAgICAgdF9hZGRyID0gewotCQkudHhfYnVmICAgICAgICAgPSAmcmVnYWRkciwK
LQkJLmxlbiAgICAgICAgICAgID0gc2l6ZW9mKHJlZ2FkZHIpLAotCX07Ci0Jc3RydWN0IHNwaV90
cmFuc2ZlciAgICAgdF9tc2cgPSB7Ci0JCS50eF9idWYgICAgICAgICA9IHNyYywKLQkJLmxlbiAg
ICAgICAgICAgID0gY291bnQsCi0JfTsKLQotCVdBUk4oY291bnQgJSAyLCAiYnVmZmVyIHNpemUg
bXVzdCBiZSBhIG11bHRpcGxlIG9mIDIiKTsKLQlXQVJOKHJlZ2FkZHIgJiBTRVRfUkVBRCwgImJh
ZCBhZGRyIG9yIHNpemUgb3ZlcmZsb3ciKTsKLQotCWNwdV90b19sZTE2cygmcmVnYWRkcik7Ci0K
LQkvKiBSZWdpc3RlciBhZGRyZXNzIGFuZCBDT05GSUcgY29udGVudCBhbHdheXMgdXNlIDE2Yml0
IGJpZyBlbmRpYW4KLQkgKiAoIkJBREMiIG9yZGVyKQotCSAqLwotCWlmIChidXMtPm5lZWRfc3dh
YikKLQkJc3dhYjE2cygmcmVnYWRkcik7Ci0JaWYgKGJ1cy0+bmVlZF9zd2FiICYmIGFkZHIgPT0g
V0ZYX1JFR19DT05GSUcpCi0JCWZvciAoaSA9IDA7IGkgPCBjb3VudCAvIDI7IGkrKykKLQkJCXN3
YWIxNnMoJnNyYzE2W2ldKTsKLQotCXNwaV9tZXNzYWdlX2luaXQoJm0pOwotCXNwaV9tZXNzYWdl
X2FkZF90YWlsKCZ0X2FkZHIsICZtKTsKLQlzcGlfbWVzc2FnZV9hZGRfdGFpbCgmdF9tc2csICZt
KTsKLQlyZXQgPSBzcGlfc3luYyhidXMtPmZ1bmMsICZtKTsKLQotCWlmIChidXMtPm5lZWRfc3dh
YiAmJiBhZGRyID09IFdGWF9SRUdfQ09ORklHKQotCQlmb3IgKGkgPSAwOyBpIDwgY291bnQgLyAy
OyBpKyspCi0JCQlzd2FiMTZzKCZzcmMxNltpXSk7Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGlj
IHZvaWQgd2Z4X3NwaV9sb2NrKHZvaWQgKnByaXYpCi17Ci19Ci0KLXN0YXRpYyB2b2lkIHdmeF9z
cGlfdW5sb2NrKHZvaWQgKnByaXYpCi17Ci19Ci0KLXN0YXRpYyBpcnFyZXR1cm5fdCB3Znhfc3Bp
X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKnByaXYpCi17Ci0Jc3RydWN0IHdmeF9zcGlfcHJp
diAqYnVzID0gcHJpdjsKLQotCXdmeF9iaF9yZXF1ZXN0X3J4KGJ1cy0+Y29yZSk7Ci0JcmV0dXJu
IElSUV9IQU5ETEVEOwotfQotCi1zdGF0aWMgaW50IHdmeF9zcGlfaXJxX3N1YnNjcmliZSh2b2lk
ICpwcml2KQotewotCXN0cnVjdCB3Znhfc3BpX3ByaXYgKmJ1cyA9IHByaXY7Ci0JdTMyIGZsYWdz
OwotCi0JZmxhZ3MgPSBpcnFfZ2V0X3RyaWdnZXJfdHlwZShidXMtPmZ1bmMtPmlycSk7Ci0JaWYg
KCFmbGFncykKLQkJZmxhZ3MgPSBJUlFGX1RSSUdHRVJfSElHSDsKLQlmbGFncyB8PSBJUlFGX09O
RVNIT1Q7Ci0JcmV0dXJuIGRldm1fcmVxdWVzdF90aHJlYWRlZF9pcnEoJmJ1cy0+ZnVuYy0+ZGV2
LCBidXMtPmZ1bmMtPmlycSwgTlVMTCwKLQkJCQkJIHdmeF9zcGlfaXJxX2hhbmRsZXIsIElSUUZf
T05FU0hPVCwKLQkJCQkJICJ3ZngiLCBidXMpOwotfQotCi1zdGF0aWMgaW50IHdmeF9zcGlfaXJx
X3Vuc3Vic2NyaWJlKHZvaWQgKnByaXYpCi17Ci0Jc3RydWN0IHdmeF9zcGlfcHJpdiAqYnVzID0g
cHJpdjsKLQotCWRldm1fZnJlZV9pcnEoJmJ1cy0+ZnVuYy0+ZGV2LCBidXMtPmZ1bmMtPmlycSwg
YnVzKTsKLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHNpemVfdCB3Znhfc3BpX2FsaWduX3NpemUo
dm9pZCAqcHJpdiwgc2l6ZV90IHNpemUpCi17Ci0JLyogTW9zdCBvZiBTUEkgY29udHJvbGxlcnMg
YXZvaWQgRE1BIGlmIGJ1ZmZlciBzaXplIGlzIG5vdCAzMmJpdCBhbGlnbmVkCi0JICovCi0JcmV0
dXJuIEFMSUdOKHNpemUsIDQpOwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGh3YnVzX29wcyB3
Znhfc3BpX2h3YnVzX29wcyA9IHsKLQkuY29weV9mcm9tX2lvID0gd2Z4X3NwaV9jb3B5X2Zyb21f
aW8sCi0JLmNvcHlfdG9faW8gPSB3Znhfc3BpX2NvcHlfdG9faW8sCi0JLmlycV9zdWJzY3JpYmUg
PSB3Znhfc3BpX2lycV9zdWJzY3JpYmUsCi0JLmlycV91bnN1YnNjcmliZSA9IHdmeF9zcGlfaXJx
X3Vuc3Vic2NyaWJlLAotCS5sb2NrCQkJPSB3Znhfc3BpX2xvY2ssCi0JLnVubG9jawkJCT0gd2Z4
X3NwaV91bmxvY2ssCi0JLmFsaWduX3NpemUJCT0gd2Z4X3NwaV9hbGlnbl9zaXplLAotfTsKLQot
c3RhdGljIGludCB3Znhfc3BpX3Byb2JlKHN0cnVjdCBzcGlfZGV2aWNlICpmdW5jKQotewotCXN0
cnVjdCB3Znhfc3BpX3ByaXYgKmJ1czsKLQlpbnQgcmV0OwotCi0JaWYgKCFmdW5jLT5iaXRzX3Bl
cl93b3JkKQotCQlmdW5jLT5iaXRzX3Blcl93b3JkID0gMTY7Ci0JcmV0ID0gc3BpX3NldHVwKGZ1
bmMpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0JLyogVHJhY2UgYmVsb3cgaXMgYWxzbyBk
aXNwbGF5ZWQgYnkgc3BpX3NldHVwKCkgaWYgY29tcGlsZWQgd2l0aCBERUJVRyAqLwotCWRldl9k
YmcoJmZ1bmMtPmRldiwgIlNQSSBwYXJhbXM6IENTPSVkLCBtb2RlPSVkIGJpdHMvd29yZD0lZCBz
cGVlZD0lZFxuIiwKLQkJZnVuYy0+Y2hpcF9zZWxlY3QsIGZ1bmMtPm1vZGUsIGZ1bmMtPmJpdHNf
cGVyX3dvcmQsCi0JCWZ1bmMtPm1heF9zcGVlZF9oeik7Ci0JaWYgKGZ1bmMtPmJpdHNfcGVyX3dv
cmQgIT0gMTYgJiYgZnVuYy0+Yml0c19wZXJfd29yZCAhPSA4KQotCQlkZXZfd2FybigmZnVuYy0+
ZGV2LCAidW51c3VhbCBiaXRzL3dvcmQgdmFsdWU6ICVkXG4iLAotCQkJIGZ1bmMtPmJpdHNfcGVy
X3dvcmQpOwotCWlmIChmdW5jLT5tYXhfc3BlZWRfaHogPiA1MDAwMDAwMCkKLQkJZGV2X3dhcm4o
JmZ1bmMtPmRldiwgIiVkSHogaXMgYSB2ZXJ5IGhpZ2ggc3BlZWRcbiIsCi0JCQkgZnVuYy0+bWF4
X3NwZWVkX2h6KTsKLQotCWJ1cyA9IGRldm1fa3phbGxvYygmZnVuYy0+ZGV2LCBzaXplb2YoKmJ1
cyksIEdGUF9LRVJORUwpOwotCWlmICghYnVzKQotCQlyZXR1cm4gLUVOT01FTTsKLQlidXMtPmZ1
bmMgPSBmdW5jOwotCWlmIChmdW5jLT5iaXRzX3Blcl93b3JkID09IDggfHwgSVNfRU5BQkxFRChD
T05GSUdfQ1BVX0JJR19FTkRJQU4pKQotCQlidXMtPm5lZWRfc3dhYiA9IHRydWU7Ci0Jc3BpX3Nl
dF9kcnZkYXRhKGZ1bmMsIGJ1cyk7Ci0KLQlidXMtPmdwaW9fcmVzZXQgPSBkZXZtX2dwaW9kX2dl
dF9vcHRpb25hbCgmZnVuYy0+ZGV2LCAicmVzZXQiLAotCQkJCQkJICBHUElPRF9PVVRfTE9XKTsK
LQlpZiAoSVNfRVJSKGJ1cy0+Z3Bpb19yZXNldCkpCi0JCXJldHVybiBQVFJfRVJSKGJ1cy0+Z3Bp
b19yZXNldCk7Ci0JaWYgKCFidXMtPmdwaW9fcmVzZXQpIHsKLQkJZGV2X3dhcm4oJmZ1bmMtPmRl
diwKLQkJCSAiZ3BpbyByZXNldCBpcyBub3QgZGVmaW5lZCwgdHJ5aW5nIHRvIGxvYWQgZmlybXdh
cmUgYW55d2F5XG4iKTsKLQl9IGVsc2UgewotCQlncGlvZF9zZXRfY29uc3VtZXJfbmFtZShidXMt
PmdwaW9fcmVzZXQsICJ3ZnggcmVzZXQiKTsKLQkJaWYgKHNwaV9nZXRfZGV2aWNlX2lkKGZ1bmMp
LT5kcml2ZXJfZGF0YSAmIFdGWF9SRVNFVF9JTlZFUlRFRCkKLQkJCWdwaW9kX3RvZ2dsZV9hY3Rp
dmVfbG93KGJ1cy0+Z3Bpb19yZXNldCk7Ci0JCWdwaW9kX3NldF92YWx1ZV9jYW5zbGVlcChidXMt
PmdwaW9fcmVzZXQsIDEpOwotCQl1c2xlZXBfcmFuZ2UoMTAwLCAxNTApOwotCQlncGlvZF9zZXRf
dmFsdWVfY2Fuc2xlZXAoYnVzLT5ncGlvX3Jlc2V0LCAwKTsKLQkJdXNsZWVwX3JhbmdlKDIwMDAs
IDI1MDApOwotCX0KLQotCWJ1cy0+Y29yZSA9IHdmeF9pbml0X2NvbW1vbigmZnVuYy0+ZGV2LCAm
d2Z4X3NwaV9wZGF0YSwKLQkJCQkgICAgJndmeF9zcGlfaHdidXNfb3BzLCBidXMpOwotCWlmICgh
YnVzLT5jb3JlKQotCQlyZXR1cm4gLUVJTzsKLQotCXJldHVybiB3ZnhfcHJvYmUoYnVzLT5jb3Jl
KTsKLX0KLQotc3RhdGljIGludCB3Znhfc3BpX3JlbW92ZShzdHJ1Y3Qgc3BpX2RldmljZSAqZnVu
YykKLXsKLQlzdHJ1Y3Qgd2Z4X3NwaV9wcml2ICpidXMgPSBzcGlfZ2V0X2RydmRhdGEoZnVuYyk7
Ci0KLQl3ZnhfcmVsZWFzZShidXMtPmNvcmUpOwotCXJldHVybiAwOwotfQotCi0vKiBGb3IgZHlu
YW1pYyBkcml2ZXIgYmluZGluZywga2VybmVsIGRvZXMgbm90IHVzZSBPRiB0byBtYXRjaCBkcml2
ZXIuIEl0IG9ubHkKLSAqIHVzZSBtb2RhbGlhcyBhbmQgbW9kYWxpYXMgaXMgYSBjb3B5IG9mICdj
b21wYXRpYmxlJyBEVCBub2RlIHdpdGggdmVuZG9yCi0gKiBzdHJpcHBlZC4KLSAqLwotc3RhdGlj
IGNvbnN0IHN0cnVjdCBzcGlfZGV2aWNlX2lkIHdmeF9zcGlfaWRbXSA9IHsKLQl7ICJ3Zngtc3Bp
IiwgV0ZYX1JFU0VUX0lOVkVSVEVEIH0sCi0JeyAid2YyMDAiLCAwIH0sCi0JeyB9LAotfTsKLU1P
RFVMRV9ERVZJQ0VfVEFCTEUoc3BpLCB3Znhfc3BpX2lkKTsKLQotI2lmZGVmIENPTkZJR19PRgot
c3RhdGljIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgd2Z4X3NwaV9vZl9tYXRjaFtdID0gewot
CXsgLmNvbXBhdGlibGUgPSAic2lsYWJzLHdmeC1zcGkiLCAuZGF0YSA9ICh2b2lkICopV0ZYX1JF
U0VUX0lOVkVSVEVEIH0sCi0JeyAuY29tcGF0aWJsZSA9ICJzaWxhYnMsd2YyMDAiIH0sCi0JeyB9
LAotfTsKLU1PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIHdmeF9zcGlfb2ZfbWF0Y2gpOwotI2VuZGlm
Ci0KLXN0cnVjdCBzcGlfZHJpdmVyIHdmeF9zcGlfZHJpdmVyID0gewotCS5kcml2ZXIgPSB7Ci0J
CS5uYW1lID0gIndmeC1zcGkiLAotCQkub2ZfbWF0Y2hfdGFibGUgPSBvZl9tYXRjaF9wdHIod2Z4
X3NwaV9vZl9tYXRjaCksCi0JfSwKLQkuaWRfdGFibGUgPSB3Znhfc3BpX2lkLAotCS5wcm9iZSA9
IHdmeF9zcGlfcHJvYmUsCi0JLnJlbW92ZSA9IHdmeF9zcGlfcmVtb3ZlLAotfTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV9yeC5jIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9k
YXRhX3J4LmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGJmYzM5NjFiN2I4OS4uMDAw
MDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV9yeC5jCisrKyAvZGV2L251
bGwKQEAgLTEsOTQgKzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seQotLyoKLSAqIERhdGEgcmVjZWl2aW5nIGltcGxlbWVudGF0aW9uLgotICoKLSAqIENvcHly
aWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJp
Z2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0jaW5jbHVkZSA8bGludXgvZXRoZXJkZXZp
Y2UuaD4KLSNpbmNsdWRlIDxuZXQvbWFjODAyMTEuaD4KLQotI2luY2x1ZGUgImRhdGFfcnguaCIK
LSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJiaC5oIgotI2luY2x1ZGUgInN0YS5oIgotCi1z
dGF0aWMgdm9pZCB3ZnhfcnhfaGFuZGxlX2JhKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qg
aWVlZTgwMjExX21nbXQgKm1nbXQpCi17Ci0JaW50IHBhcmFtcywgdGlkOwotCi0JaWYgKHdmeF9h
cGlfb2xkZXJfdGhhbih3dmlmLT53ZGV2LCAzLCA2KSkKLQkJcmV0dXJuOwotCi0Jc3dpdGNoICht
Z210LT51LmFjdGlvbi51LmFkZGJhX3JlcS5hY3Rpb25fY29kZSkgewotCWNhc2UgV0xBTl9BQ1RJ
T05fQUREQkFfUkVROgotCQlwYXJhbXMgPSBsZTE2X3RvX2NwdShtZ210LT51LmFjdGlvbi51LmFk
ZGJhX3JlcS5jYXBhYik7Ci0JCXRpZCA9IChwYXJhbXMgJiBJRUVFODAyMTFfQUREQkFfUEFSQU1f
VElEX01BU0spID4+IDI7Ci0JCWllZWU4MDIxMV9zdGFydF9yeF9iYV9zZXNzaW9uX29mZmwod3Zp
Zi0+dmlmLCBtZ210LT5zYSwgdGlkKTsKLQkJYnJlYWs7Ci0JY2FzZSBXTEFOX0FDVElPTl9ERUxC
QToKLQkJcGFyYW1zID0gbGUxNl90b19jcHUobWdtdC0+dS5hY3Rpb24udS5kZWxiYS5wYXJhbXMp
OwotCQl0aWQgPSAocGFyYW1zICYgIElFRUU4MDIxMV9ERUxCQV9QQVJBTV9USURfTUFTSykgPj4g
MTI7Ci0JCWllZWU4MDIxMV9zdG9wX3J4X2JhX3Nlc3Npb25fb2ZmbCh3dmlmLT52aWYsIG1nbXQt
PnNhLCB0aWQpOwotCQlicmVhazsKLQl9Ci19Ci0KLXZvaWQgd2Z4X3J4X2NiKHN0cnVjdCB3Znhf
dmlmICp3dmlmLAotCSAgICAgICBjb25zdCBzdHJ1Y3QgaGlmX2luZF9yeCAqYXJnLCBzdHJ1Y3Qg
c2tfYnVmZiAqc2tiKQotewotCXN0cnVjdCBpZWVlODAyMTFfcnhfc3RhdHVzICpoZHIgPSBJRUVF
ODAyMTFfU0tCX1JYQ0Ioc2tiKTsKLQlzdHJ1Y3QgaWVlZTgwMjExX2hkciAqZnJhbWUgPSAoc3Ry
dWN0IGllZWU4MDIxMV9oZHIgKilza2ItPmRhdGE7Ci0Jc3RydWN0IGllZWU4MDIxMV9tZ210ICpt
Z210ID0gKHN0cnVjdCBpZWVlODAyMTFfbWdtdCAqKXNrYi0+ZGF0YTsKLQotCW1lbXNldChoZHIs
IDAsIHNpemVvZigqaGRyKSk7Ci0KLQlpZiAoYXJnLT5zdGF0dXMgPT0gSElGX1NUQVRVU19SWF9G
QUlMX01JQykKLQkJaGRyLT5mbGFnIHw9IFJYX0ZMQUdfTU1JQ19FUlJPUiB8IFJYX0ZMQUdfSVZf
U1RSSVBQRUQ7Ci0JZWxzZSBpZiAoYXJnLT5zdGF0dXMpCi0JCWdvdG8gZHJvcDsKLQotCWlmIChz
a2ItPmxlbiA8IHNpemVvZihzdHJ1Y3QgaWVlZTgwMjExX3BzcG9sbCkpIHsKLQkJZGV2X3dhcm4o
d3ZpZi0+d2Rldi0+ZGV2LCAibWFsZm9ybWVkIFNEVSByZWNlaXZlZFxuIik7Ci0JCWdvdG8gZHJv
cDsKLQl9Ci0KLQloZHItPmJhbmQgPSBOTDgwMjExX0JBTkRfMkdIWjsKLQloZHItPmZyZXEgPSBp
ZWVlODAyMTFfY2hhbm5lbF90b19mcmVxdWVuY3koYXJnLT5jaGFubmVsX251bWJlciwKLQkJCQkJ
CSAgIGhkci0+YmFuZCk7Ci0KLQlpZiAoYXJnLT5yeGVkX3JhdGUgPj0gMTQpIHsKLQkJaGRyLT5l
bmNvZGluZyA9IFJYX0VOQ19IVDsKLQkJaGRyLT5yYXRlX2lkeCA9IGFyZy0+cnhlZF9yYXRlIC0g
MTQ7Ci0JfSBlbHNlIGlmIChhcmctPnJ4ZWRfcmF0ZSA+PSA0KSB7Ci0JCWhkci0+cmF0ZV9pZHgg
PSBhcmctPnJ4ZWRfcmF0ZSAtIDI7Ci0JfSBlbHNlIHsKLQkJaGRyLT5yYXRlX2lkeCA9IGFyZy0+
cnhlZF9yYXRlOwotCX0KLQotCWlmICghYXJnLT5yY3BpX3Jzc2kpIHsKLQkJaGRyLT5mbGFnIHw9
IFJYX0ZMQUdfTk9fU0lHTkFMX1ZBTDsKLQkJZGV2X2luZm8od3ZpZi0+d2Rldi0+ZGV2LCAicmVj
ZWl2ZWQgZnJhbWUgd2l0aG91dCBSU1NJIGRhdGFcbiIpOwotCX0KLQloZHItPnNpZ25hbCA9IGFy
Zy0+cmNwaV9yc3NpIC8gMiAtIDExMDsKLQloZHItPmFudGVubmEgPSAwOwotCi0JaWYgKGFyZy0+
ZW5jcnlwKQotCQloZHItPmZsYWcgfD0gUlhfRkxBR19ERUNSWVBURUQ7Ci0KLQkvKiBCbG9jayBh
Y2sgbmVnb3RpYXRpb24gaXMgb2ZmbG9hZGVkIGJ5IHRoZSBmaXJtd2FyZS4gSG93ZXZlciwKLQkg
KiByZS1vcmRlcmluZyBtdXN0IGJlIGRvbmUgYnkgdGhlIG1hYzgwMjExLgotCSAqLwotCWlmIChp
ZWVlODAyMTFfaXNfYWN0aW9uKGZyYW1lLT5mcmFtZV9jb250cm9sKSAmJgotCSAgICBtZ210LT51
LmFjdGlvbi5jYXRlZ29yeSA9PSBXTEFOX0NBVEVHT1JZX0JBQ0sgJiYKLQkgICAgc2tiLT5sZW4g
PiBJRUVFODAyMTFfTUlOX0FDVElPTl9TSVpFKSB7Ci0JCXdmeF9yeF9oYW5kbGVfYmEod3ZpZiwg
bWdtdCk7Ci0JCWdvdG8gZHJvcDsKLQl9Ci0KLQlpZWVlODAyMTFfcnhfaXJxc2FmZSh3dmlmLT53
ZGV2LT5odywgc2tiKTsKLQlyZXR1cm47Ci0KLWRyb3A6Ci0JZGV2X2tmcmVlX3NrYihza2IpOwot
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3J4LmggYi9kcml2ZXJzL3N0
YWdpbmcvd2Z4L2RhdGFfcnguaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggODRkMGUz
YzA1MDdiLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3J4LmgK
KysrIC9kZXYvbnVsbApAQCAtMSwxOCArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMC1vbmx5ICovCi0vKgotICogRGF0YSByZWNlaXZpbmcgaW1wbGVtZW50YXRpb24u
Ci0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJ
bmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKi8KLSNpZm5kZWYgV0ZY
X0RBVEFfUlhfSAotI2RlZmluZSBXRlhfREFUQV9SWF9ICi0KLXN0cnVjdCB3ZnhfdmlmOwotc3Ry
dWN0IHNrX2J1ZmY7Ci1zdHJ1Y3QgaGlmX2luZF9yeDsKLQotdm9pZCB3ZnhfcnhfY2Ioc3RydWN0
IHdmeF92aWYgKnd2aWYsCi0JICAgICAgIGNvbnN0IHN0cnVjdCBoaWZfaW5kX3J4ICphcmcsIHN0
cnVjdCBza19idWZmICpza2IpOwotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2lu
Zy93ZngvZGF0YV90eC5jIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmMKZGVsZXRlZCBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDA1MmExOTE2MWRjNS4uMDAwMDAwMDAwMDAwCi0tLSBhL2Ry
aXZlcnMvc3RhZ2luZy93ZngvZGF0YV90eC5jCisrKyAvZGV2L251bGwKQEAgLTEsNTk2ICswLDAg
QEAKLS8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKLS8qCi0gKiBEYXRh
IHRyYW5zbWl0dGluZyBpbXBsZW1lbnRhdGlvbi4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTct
MjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIEluYy4KLSAqIENvcHlyaWdodCAoYykgMjAxMCwg
U1QtRXJpY3Nzb24KLSAqLwotI2luY2x1ZGUgPG5ldC9tYWM4MDIxMS5oPgotI2luY2x1ZGUgPGxp
bnV4L2V0aGVyZGV2aWNlLmg+Ci0KLSNpbmNsdWRlICJkYXRhX3R4LmgiCi0jaW5jbHVkZSAid2Z4
LmgiCi0jaW5jbHVkZSAiYmguaCIKLSNpbmNsdWRlICJzdGEuaCIKLSNpbmNsdWRlICJxdWV1ZS5o
IgotI2luY2x1ZGUgImRlYnVnLmgiCi0jaW5jbHVkZSAidHJhY2VzLmgiCi0jaW5jbHVkZSAiaGlm
X3R4X21pYi5oIgotCi1zdGF0aWMgaW50IHdmeF9nZXRfaHdfcmF0ZShzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiwKLQkJCSAgIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfdHhfcmF0ZSAqcmF0ZSkKLXsKLQlz
dHJ1Y3QgaWVlZTgwMjExX3N1cHBvcnRlZF9iYW5kICpiYW5kOwotCi0JaWYgKHJhdGUtPmlkeCA8
IDApCi0JCXJldHVybiAtMTsKLQlpZiAocmF0ZS0+ZmxhZ3MgJiBJRUVFODAyMTFfVFhfUkNfTUNT
KSB7Ci0JCWlmIChyYXRlLT5pZHggPiA3KSB7Ci0JCQlXQVJOKDEsICJ3cm9uZyByYXRlLT5pZHgg
dmFsdWU6ICVkIiwgcmF0ZS0+aWR4KTsKLQkJCXJldHVybiAtMTsKLQkJfQotCQlyZXR1cm4gcmF0
ZS0+aWR4ICsgMTQ7Ci0JfQotCS8qIFRoZSBkZXZpY2Ugb25seSBzdXBwb3J0IDJHSHosIGVsc2Ug
YmFuZCBpbmZvcm1hdGlvbiBzaG91bGQgYmUKLQkgKiByZXRyaWV2ZWQgZnJvbSBpZWVlODAyMTFf
dHhfaW5mbwotCSAqLwotCWJhbmQgPSB3ZGV2LT5ody0+d2lwaHktPmJhbmRzW05MODAyMTFfQkFO
RF8yR0haXTsKLQlpZiAocmF0ZS0+aWR4ID49IGJhbmQtPm5fYml0cmF0ZXMpIHsKLQkJV0FSTigx
LCAid3JvbmcgcmF0ZS0+aWR4IHZhbHVlOiAlZCIsIHJhdGUtPmlkeCk7Ci0JCXJldHVybiAtMTsK
LQl9Ci0JcmV0dXJuIGJhbmQtPmJpdHJhdGVzW3JhdGUtPmlkeF0uaHdfdmFsdWU7Ci19Ci0KLS8q
IFRYIHBvbGljeSBjYWNoZSBpbXBsZW1lbnRhdGlvbiAqLwotCi1zdGF0aWMgdm9pZCB3ZnhfdHhf
cG9saWN5X2J1aWxkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgdHhfcG9saWN5ICpwb2xp
Y3ksCi0JCQkJc3RydWN0IGllZWU4MDIxMV90eF9yYXRlICpyYXRlcykKLXsKLQlzdHJ1Y3Qgd2Z4
X2RldiAqd2RldiA9IHd2aWYtPndkZXY7Ci0JaW50IGksIHJhdGVpZDsKLQl1OCBjb3VudDsKLQot
CVdBUk4ocmF0ZXNbMF0uaWR4IDwgMCwgImludmFsaWQgcmF0ZSBwb2xpY3kiKTsKLQltZW1zZXQo
cG9saWN5LCAwLCBzaXplb2YoKnBvbGljeSkpOwotCWZvciAoaSA9IDA7IGkgPCBJRUVFODAyMTFf
VFhfTUFYX1JBVEVTOyArK2kpIHsKLQkJaWYgKHJhdGVzW2ldLmlkeCA8IDApCi0JCQlicmVhazsK
LQkJV0FSTl9PTihyYXRlc1tpXS5jb3VudCA+IDE1KTsKLQkJcmF0ZWlkID0gd2Z4X2dldF9od19y
YXRlKHdkZXYsICZyYXRlc1tpXSk7Ci0JCS8qIFBhY2sgdHdvIHZhbHVlcyBpbiBlYWNoIGJ5dGUg
b2YgcG9saWN5LT5yYXRlcyAqLwotCQljb3VudCA9IHJhdGVzW2ldLmNvdW50OwotCQlpZiAocmF0
ZWlkICUgMikKLQkJCWNvdW50IDw8PSA0OwotCQlwb2xpY3ktPnJhdGVzW3JhdGVpZCAvIDJdIHw9
IGNvdW50OwotCX0KLX0KLQotc3RhdGljIGJvb2wgdHhfcG9saWN5X2lzX2VxdWFsKGNvbnN0IHN0
cnVjdCB0eF9wb2xpY3kgKmEsCi0JCQkgICAgICAgY29uc3Qgc3RydWN0IHR4X3BvbGljeSAqYikK
LXsKLQlyZXR1cm4gIW1lbWNtcChhLT5yYXRlcywgYi0+cmF0ZXMsIHNpemVvZihhLT5yYXRlcykp
OwotfQotCi1zdGF0aWMgaW50IHdmeF90eF9wb2xpY3lfZmluZChzdHJ1Y3QgdHhfcG9saWN5X2Nh
Y2hlICpjYWNoZSwKLQkJCSAgICAgIHN0cnVjdCB0eF9wb2xpY3kgKndhbnRlZCkKLXsKLQlzdHJ1
Y3QgdHhfcG9saWN5ICppdDsKLQotCWxpc3RfZm9yX2VhY2hfZW50cnkoaXQsICZjYWNoZS0+dXNl
ZCwgbGluaykKLQkJaWYgKHR4X3BvbGljeV9pc19lcXVhbCh3YW50ZWQsIGl0KSkKLQkJCXJldHVy
biBpdCAtIGNhY2hlLT5jYWNoZTsKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGl0LCAmY2FjaGUtPmZy
ZWUsIGxpbmspCi0JCWlmICh0eF9wb2xpY3lfaXNfZXF1YWwod2FudGVkLCBpdCkpCi0JCQlyZXR1
cm4gaXQgLSBjYWNoZS0+Y2FjaGU7Ci0JcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgdm9pZCB3Znhf
dHhfcG9saWN5X3VzZShzdHJ1Y3QgdHhfcG9saWN5X2NhY2hlICpjYWNoZSwKLQkJCSAgICAgIHN0
cnVjdCB0eF9wb2xpY3kgKmVudHJ5KQotewotCSsrZW50cnktPnVzYWdlX2NvdW50OwotCWxpc3Rf
bW92ZSgmZW50cnktPmxpbmssICZjYWNoZS0+dXNlZCk7Ci19Ci0KLXN0YXRpYyBpbnQgd2Z4X3R4
X3BvbGljeV9yZWxlYXNlKHN0cnVjdCB0eF9wb2xpY3lfY2FjaGUgKmNhY2hlLAotCQkJCSBzdHJ1
Y3QgdHhfcG9saWN5ICplbnRyeSkKLXsKLQlpbnQgcmV0ID0gLS1lbnRyeS0+dXNhZ2VfY291bnQ7
Ci0KLQlpZiAoIXJldCkKLQkJbGlzdF9tb3ZlKCZlbnRyeS0+bGluaywgJmNhY2hlLT5mcmVlKTsK
LQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IHdmeF90eF9wb2xpY3lfZ2V0KHN0cnVjdCB3
ZnhfdmlmICp3dmlmLAotCQkJICAgICBzdHJ1Y3QgaWVlZTgwMjExX3R4X3JhdGUgKnJhdGVzLCBi
b29sICpyZW5ldykKLXsKLQlpbnQgaWR4OwotCXN0cnVjdCB0eF9wb2xpY3lfY2FjaGUgKmNhY2hl
ID0gJnd2aWYtPnR4X3BvbGljeV9jYWNoZTsKLQlzdHJ1Y3QgdHhfcG9saWN5IHdhbnRlZDsKLQlz
dHJ1Y3QgdHhfcG9saWN5ICplbnRyeTsKLQotCXdmeF90eF9wb2xpY3lfYnVpbGQod3ZpZiwgJndh
bnRlZCwgcmF0ZXMpOwotCi0Jc3Bpbl9sb2NrX2JoKCZjYWNoZS0+bG9jayk7Ci0JaWYgKGxpc3Rf
ZW1wdHkoJmNhY2hlLT5mcmVlKSkgewotCQlXQVJOKDEsICJ1bmFibGUgdG8gZ2V0IGEgdmFsaWQg
VHggcG9saWN5Iik7Ci0JCXNwaW5fdW5sb2NrX2JoKCZjYWNoZS0+bG9jayk7Ci0JCXJldHVybiBI
SUZfVFhfUkVUUllfUE9MSUNZX0lOVkFMSUQ7Ci0JfQotCWlkeCA9IHdmeF90eF9wb2xpY3lfZmlu
ZChjYWNoZSwgJndhbnRlZCk7Ci0JaWYgKGlkeCA+PSAwKSB7Ci0JCSpyZW5ldyA9IGZhbHNlOwot
CX0gZWxzZSB7Ci0JCS8qIElmIHBvbGljeSBpcyBub3QgZm91bmQgY3JlYXRlIGEgbmV3IG9uZSB1
c2luZyB0aGUgb2xkZXN0Ci0JCSAqIGVudHJ5IGluICJmcmVlIiBsaXN0Ci0JCSAqLwotCQkqcmVu
ZXcgPSB0cnVlOwotCQllbnRyeSA9IGxpc3RfZW50cnkoY2FjaGUtPmZyZWUucHJldiwgc3RydWN0
IHR4X3BvbGljeSwgbGluayk7Ci0JCW1lbWNweShlbnRyeS0+cmF0ZXMsIHdhbnRlZC5yYXRlcywg
c2l6ZW9mKGVudHJ5LT5yYXRlcykpOwotCQllbnRyeS0+dXBsb2FkZWQgPSBmYWxzZTsKLQkJZW50
cnktPnVzYWdlX2NvdW50ID0gMDsKLQkJaWR4ID0gZW50cnkgLSBjYWNoZS0+Y2FjaGU7Ci0JfQot
CXdmeF90eF9wb2xpY3lfdXNlKGNhY2hlLCAmY2FjaGUtPmNhY2hlW2lkeF0pOwotCWlmIChsaXN0
X2VtcHR5KCZjYWNoZS0+ZnJlZSkpCi0JCWllZWU4MDIxMV9zdG9wX3F1ZXVlcyh3dmlmLT53ZGV2
LT5odyk7Ci0Jc3Bpbl91bmxvY2tfYmgoJmNhY2hlLT5sb2NrKTsKLQlyZXR1cm4gaWR4OwotfQot
Ci1zdGF0aWMgdm9pZCB3ZnhfdHhfcG9saWN5X3B1dChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50
IGlkeCkKLXsKLQlpbnQgdXNhZ2UsIGxvY2tlZDsKLQlzdHJ1Y3QgdHhfcG9saWN5X2NhY2hlICpj
YWNoZSA9ICZ3dmlmLT50eF9wb2xpY3lfY2FjaGU7Ci0KLQlpZiAoaWR4ID09IEhJRl9UWF9SRVRS
WV9QT0xJQ1lfSU5WQUxJRCkKLQkJcmV0dXJuOwotCXNwaW5fbG9ja19iaCgmY2FjaGUtPmxvY2sp
OwotCWxvY2tlZCA9IGxpc3RfZW1wdHkoJmNhY2hlLT5mcmVlKTsKLQl1c2FnZSA9IHdmeF90eF9w
b2xpY3lfcmVsZWFzZShjYWNoZSwgJmNhY2hlLT5jYWNoZVtpZHhdKTsKLQlpZiAobG9ja2VkICYm
ICF1c2FnZSkKLQkJaWVlZTgwMjExX3dha2VfcXVldWVzKHd2aWYtPndkZXYtPmh3KTsKLQlzcGlu
X3VubG9ja19iaCgmY2FjaGUtPmxvY2spOwotfQotCi1zdGF0aWMgaW50IHdmeF90eF9wb2xpY3lf
dXBsb2FkKHN0cnVjdCB3ZnhfdmlmICp3dmlmKQotewotCXN0cnVjdCB0eF9wb2xpY3kgKnBvbGlj
aWVzID0gd3ZpZi0+dHhfcG9saWN5X2NhY2hlLmNhY2hlOwotCXU4IHRtcF9yYXRlc1sxMl07Ci0J
aW50IGksIGlzX3VzZWQ7Ci0KLQlkbyB7Ci0JCXNwaW5fbG9ja19iaCgmd3ZpZi0+dHhfcG9saWN5
X2NhY2hlLmxvY2spOwotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRSh3dmlmLT50eF9wb2xp
Y3lfY2FjaGUuY2FjaGUpOyArK2kpIHsKLQkJCWlzX3VzZWQgPSBtZW16Y21wKHBvbGljaWVzW2ld
LnJhdGVzLAotCQkJCQkgIHNpemVvZihwb2xpY2llc1tpXS5yYXRlcykpOwotCQkJaWYgKCFwb2xp
Y2llc1tpXS51cGxvYWRlZCAmJiBpc191c2VkKQotCQkJCWJyZWFrOwotCQl9Ci0JCWlmIChpIDwg
QVJSQVlfU0laRSh3dmlmLT50eF9wb2xpY3lfY2FjaGUuY2FjaGUpKSB7Ci0JCQlwb2xpY2llc1tp
XS51cGxvYWRlZCA9IHRydWU7Ci0JCQltZW1jcHkodG1wX3JhdGVzLCBwb2xpY2llc1tpXS5yYXRl
cywgc2l6ZW9mKHRtcF9yYXRlcykpOwotCQkJc3Bpbl91bmxvY2tfYmgoJnd2aWYtPnR4X3BvbGlj
eV9jYWNoZS5sb2NrKTsKLQkJCWhpZl9zZXRfdHhfcmF0ZV9yZXRyeV9wb2xpY3kod3ZpZiwgaSwg
dG1wX3JhdGVzKTsKLQkJfSBlbHNlIHsKLQkJCXNwaW5fdW5sb2NrX2JoKCZ3dmlmLT50eF9wb2xp
Y3lfY2FjaGUubG9jayk7Ci0JCX0KLQl9IHdoaWxlIChpIDwgQVJSQVlfU0laRSh3dmlmLT50eF9w
b2xpY3lfY2FjaGUuY2FjaGUpKTsKLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB3ZnhfdHhfcG9saWN5
X3VwbG9hZF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKLXsKLQlzdHJ1Y3Qgd2Z4X3Zp
ZiAqd3ZpZiA9Ci0JCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3Qgd2Z4X3ZpZiwgdHhfcG9saWN5
X3VwbG9hZF93b3JrKTsKLQotCXdmeF90eF9wb2xpY3lfdXBsb2FkKHd2aWYpOwotCXdmeF90eF91
bmxvY2sod3ZpZi0+d2Rldik7Ci19Ci0KLXZvaWQgd2Z4X3R4X3BvbGljeV9pbml0KHN0cnVjdCB3
ZnhfdmlmICp3dmlmKQotewotCXN0cnVjdCB0eF9wb2xpY3lfY2FjaGUgKmNhY2hlID0gJnd2aWYt
PnR4X3BvbGljeV9jYWNoZTsKLQlpbnQgaTsKLQotCW1lbXNldChjYWNoZSwgMCwgc2l6ZW9mKCpj
YWNoZSkpOwotCi0Jc3Bpbl9sb2NrX2luaXQoJmNhY2hlLT5sb2NrKTsKLQlJTklUX0xJU1RfSEVB
RCgmY2FjaGUtPnVzZWQpOwotCUlOSVRfTElTVF9IRUFEKCZjYWNoZS0+ZnJlZSk7Ci0KLQlmb3Ig
KGkgPSAwOyBpIDwgQVJSQVlfU0laRShjYWNoZS0+Y2FjaGUpOyArK2kpCi0JCWxpc3RfYWRkKCZj
YWNoZS0+Y2FjaGVbaV0ubGluaywgJmNhY2hlLT5mcmVlKTsKLX0KLQotLyogVHggaW1wbGVtZW50
YXRpb24gKi8KLQotc3RhdGljIGJvb2wgaWVlZTgwMjExX2lzX2FjdGlvbl9iYWNrKHN0cnVjdCBp
ZWVlODAyMTFfaGRyICpoZHIpCi17Ci0Jc3RydWN0IGllZWU4MDIxMV9tZ210ICptZ210ID0gKHN0
cnVjdCBpZWVlODAyMTFfbWdtdCAqKWhkcjsKLQotCWlmICghaWVlZTgwMjExX2lzX2FjdGlvbiht
Z210LT5mcmFtZV9jb250cm9sKSkKLQkJcmV0dXJuIGZhbHNlOwotCWlmIChtZ210LT51LmFjdGlv
bi5jYXRlZ29yeSAhPSBXTEFOX0NBVEVHT1JZX0JBQ0spCi0JCXJldHVybiBmYWxzZTsKLQlyZXR1
cm4gdHJ1ZTsKLX0KLQotc3RhdGljIHU4IHdmeF90eF9nZXRfbGlua19pZChzdHJ1Y3Qgd2Z4X3Zp
ZiAqd3ZpZiwgc3RydWN0IGllZWU4MDIxMV9zdGEgKnN0YSwKLQkJCSAgICAgc3RydWN0IGllZWU4
MDIxMV9oZHIgKmhkcikKLXsKLQlzdHJ1Y3Qgd2Z4X3N0YV9wcml2ICpzdGFfcHJpdiA9Ci0JCXN0
YSA/IChzdHJ1Y3Qgd2Z4X3N0YV9wcml2ICopJnN0YS0+ZHJ2X3ByaXYgOiBOVUxMOwotCWNvbnN0
IHU4ICpkYSA9IGllZWU4MDIxMV9nZXRfREEoaGRyKTsKLQotCWlmIChzdGFfcHJpdiAmJiBzdGFf
cHJpdi0+bGlua19pZCkKLQkJcmV0dXJuIHN0YV9wcml2LT5saW5rX2lkOwotCWlmICh3dmlmLT52
aWYtPnR5cGUgIT0gTkw4MDIxMV9JRlRZUEVfQVApCi0JCXJldHVybiAwOwotCWlmIChpc19tdWx0
aWNhc3RfZXRoZXJfYWRkcihkYSkpCi0JCXJldHVybiAwOwotCXJldHVybiBISUZfTElOS19JRF9O
T1RfQVNTT0NJQVRFRDsKLX0KLQotc3RhdGljIHZvaWQgd2Z4X3R4X2ZpeHVwX3JhdGVzKHN0cnVj
dCBpZWVlODAyMTFfdHhfcmF0ZSAqcmF0ZXMpCi17Ci0JaW50IGk7Ci0JYm9vbCBmaW5pc2hlZDsK
LQotCS8qIEZpcm13YXJlIGlzIG5vdCBhYmxlIHRvIG1peCByYXRlcyB3aXRoIGRpZmZlcmVudCBm
bGFncyAqLwotCWZvciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfVFhfTUFYX1JBVEVTOyBpKyspIHsK
LQkJaWYgKHJhdGVzWzBdLmZsYWdzICYgSUVFRTgwMjExX1RYX1JDX1NIT1JUX0dJKQotCQkJcmF0
ZXNbaV0uZmxhZ3MgfD0gSUVFRTgwMjExX1RYX1JDX1NIT1JUX0dJOwotCQlpZiAoIShyYXRlc1sw
XS5mbGFncyAmIElFRUU4MDIxMV9UWF9SQ19TSE9SVF9HSSkpCi0JCQlyYXRlc1tpXS5mbGFncyAm
PSB+SUVFRTgwMjExX1RYX1JDX1NIT1JUX0dJOwotCQlpZiAoIShyYXRlc1swXS5mbGFncyAmIElF
RUU4MDIxMV9UWF9SQ19VU0VfUlRTX0NUUykpCi0JCQlyYXRlc1tpXS5mbGFncyAmPSB+SUVFRTgw
MjExX1RYX1JDX1VTRV9SVFNfQ1RTOwotCX0KLQotCS8qIFNvcnQgcmF0ZXMgYW5kIHJlbW92ZSBk
dXBsaWNhdGVzICovCi0JZG8gewotCQlmaW5pc2hlZCA9IHRydWU7Ci0JCWZvciAoaSA9IDA7IGkg
PCBJRUVFODAyMTFfVFhfTUFYX1JBVEVTIC0gMTsgaSsrKSB7Ci0JCQlpZiAocmF0ZXNbaSArIDFd
LmlkeCA9PSByYXRlc1tpXS5pZHggJiYKLQkJCSAgICByYXRlc1tpXS5pZHggIT0gLTEpIHsKLQkJ
CQlyYXRlc1tpXS5jb3VudCArPSByYXRlc1tpICsgMV0uY291bnQ7Ci0JCQkJaWYgKHJhdGVzW2ld
LmNvdW50ID4gMTUpCi0JCQkJCXJhdGVzW2ldLmNvdW50ID0gMTU7Ci0JCQkJcmF0ZXNbaSArIDFd
LmlkeCA9IC0xOwotCQkJCXJhdGVzW2kgKyAxXS5jb3VudCA9IDA7Ci0KLQkJCQlmaW5pc2hlZCA9
IGZhbHNlOwotCQkJfQotCQkJaWYgKHJhdGVzW2kgKyAxXS5pZHggPiByYXRlc1tpXS5pZHgpIHsK
LQkJCQlzd2FwKHJhdGVzW2kgKyAxXSwgcmF0ZXNbaV0pOwotCQkJCWZpbmlzaGVkID0gZmFsc2U7
Ci0JCQl9Ci0JCX0KLQl9IHdoaWxlICghZmluaXNoZWQpOwotCS8qIEVuc3VyZSB0aGF0IE1DUzAg
b3IgMU1icHMgaXMgcHJlc2VudCBhdCB0aGUgZW5kIG9mIHRoZSByZXRyeSBsaXN0ICovCi0JZm9y
IChpID0gMDsgaSA8IElFRUU4MDIxMV9UWF9NQVhfUkFURVM7IGkrKykgewotCQlpZiAocmF0ZXNb
aV0uaWR4ID09IDApCi0JCQlicmVhazsKLQkJaWYgKHJhdGVzW2ldLmlkeCA9PSAtMSkgewotCQkJ
cmF0ZXNbaV0uaWR4ID0gMDsKLQkJCXJhdGVzW2ldLmNvdW50ID0gODsgLyogPT0gaHctPm1heF9y
YXRlX3RyaWVzICovCi0JCQlyYXRlc1tpXS5mbGFncyA9IHJhdGVzW2kgLSAxXS5mbGFncyAmCi0J
CQkJCSBJRUVFODAyMTFfVFhfUkNfTUNTOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0JLyogQWxsIHJl
dHJpZXMgdXNlIGxvbmcgR0kgKi8KLQlmb3IgKGkgPSAxOyBpIDwgSUVFRTgwMjExX1RYX01BWF9S
QVRFUzsgaSsrKQotCQlyYXRlc1tpXS5mbGFncyAmPSB+SUVFRTgwMjExX1RYX1JDX1NIT1JUX0dJ
OwotfQotCi1zdGF0aWMgdTggd2Z4X3R4X2dldF9yZXRyeV9wb2xpY3lfaWQoc3RydWN0IHdmeF92
aWYgKnd2aWYsCi0JCQkJICAgICBzdHJ1Y3QgaWVlZTgwMjExX3R4X2luZm8gKnR4X2luZm8pCi17
Ci0JYm9vbCB0eF9wb2xpY3lfcmVuZXcgPSBmYWxzZTsKLQl1OCByZXQ7Ci0KLQlyZXQgPSB3Znhf
dHhfcG9saWN5X2dldCh3dmlmLCB0eF9pbmZvLT5kcml2ZXJfcmF0ZXMsICZ0eF9wb2xpY3lfcmVu
ZXcpOwotCWlmIChyZXQgPT0gSElGX1RYX1JFVFJZX1BPTElDWV9JTlZBTElEKQotCQlkZXZfd2Fy
bih3dmlmLT53ZGV2LT5kZXYsICJ1bmFibGUgdG8gZ2V0IGEgdmFsaWQgVHggcG9saWN5Iik7Ci0K
LQlpZiAodHhfcG9saWN5X3JlbmV3KSB7Ci0JCXdmeF90eF9sb2NrKHd2aWYtPndkZXYpOwotCQlp
ZiAoIXNjaGVkdWxlX3dvcmsoJnd2aWYtPnR4X3BvbGljeV91cGxvYWRfd29yaykpCi0JCQl3Znhf
dHhfdW5sb2NrKHd2aWYtPndkZXYpOwotCX0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50
IHdmeF90eF9nZXRfZnJhbWVfZm9ybWF0KHN0cnVjdCBpZWVlODAyMTFfdHhfaW5mbyAqdHhfaW5m
bykKLXsKLQlpZiAoISh0eF9pbmZvLT5kcml2ZXJfcmF0ZXNbMF0uZmxhZ3MgJiBJRUVFODAyMTFf
VFhfUkNfTUNTKSkKLQkJcmV0dXJuIEhJRl9GUkFNRV9GT1JNQVRfTk9OX0hUOwotCWVsc2UgaWYg
KCEodHhfaW5mby0+ZHJpdmVyX3JhdGVzWzBdLmZsYWdzICYgSUVFRTgwMjExX1RYX1JDX0dSRUVO
X0ZJRUxEKSkKLQkJcmV0dXJuIEhJRl9GUkFNRV9GT1JNQVRfTUlYRURfRk9STUFUX0hUOwotCWVs
c2UKLQkJcmV0dXJuIEhJRl9GUkFNRV9GT1JNQVRfR0ZfSFRfMTFOOwotfQotCi1zdGF0aWMgaW50
IHdmeF90eF9nZXRfaWN2X2xlbihzdHJ1Y3QgaWVlZTgwMjExX2tleV9jb25mICpod19rZXkpCi17
Ci0JaW50IG1pY19zcGFjZTsKLQotCWlmICghaHdfa2V5KQotCQlyZXR1cm4gMDsKLQlpZiAoaHdf
a2V5LT5jaXBoZXIgPT0gV0xBTl9DSVBIRVJfU1VJVEVfQUVTX0NNQUMpCi0JCXJldHVybiAwOwot
CW1pY19zcGFjZSA9IChod19rZXktPmNpcGhlciA9PSBXTEFOX0NJUEhFUl9TVUlURV9US0lQKSA/
IDggOiAwOwotCXJldHVybiBod19rZXktPmljdl9sZW4gKyBtaWNfc3BhY2U7Ci19Ci0KLXN0YXRp
YyBpbnQgd2Z4X3R4X2lubmVyKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgaWVlZTgwMjEx
X3N0YSAqc3RhLAotCQkJc3RydWN0IHNrX2J1ZmYgKnNrYikKLXsKLQlzdHJ1Y3QgaGlmX21zZyAq
aGlmX21zZzsKLQlzdHJ1Y3QgaGlmX3JlcV90eCAqcmVxOwotCXN0cnVjdCB3ZnhfdHhfcHJpdiAq
dHhfcHJpdjsKLQlzdHJ1Y3QgaWVlZTgwMjExX3R4X2luZm8gKnR4X2luZm8gPSBJRUVFODAyMTFf
U0tCX0NCKHNrYik7Ci0Jc3RydWN0IGllZWU4MDIxMV9rZXlfY29uZiAqaHdfa2V5ID0gdHhfaW5m
by0+Y29udHJvbC5od19rZXk7Ci0Jc3RydWN0IGllZWU4MDIxMV9oZHIgKmhkciA9IChzdHJ1Y3Qg
aWVlZTgwMjExX2hkciAqKXNrYi0+ZGF0YTsKLQlpbnQgcXVldWVfaWQgPSBza2JfZ2V0X3F1ZXVl
X21hcHBpbmcoc2tiKTsKLQlzaXplX3Qgb2Zmc2V0ID0gKHNpemVfdClza2ItPmRhdGEgJiAzOwot
CWludCB3bXNnX2xlbiA9IHNpemVvZihzdHJ1Y3QgaGlmX21zZykgKwotCQkJc2l6ZW9mKHN0cnVj
dCBoaWZfcmVxX3R4KSArIG9mZnNldDsKLQotCVdBUk4ocXVldWVfaWQgPj0gSUVFRTgwMjExX05V
TV9BQ1MsICJ1bnN1cHBvcnRlZCBxdWV1ZV9pZCIpOwotCXdmeF90eF9maXh1cF9yYXRlcyh0eF9p
bmZvLT5kcml2ZXJfcmF0ZXMpOwotCi0JLyogRnJvbSBub3cgdHhfaW5mby0+Y29udHJvbCBpcyB1
bnVzYWJsZSAqLwotCW1lbXNldCh0eF9pbmZvLT5yYXRlX2RyaXZlcl9kYXRhLCAwLCBzaXplb2Yo
c3RydWN0IHdmeF90eF9wcml2KSk7Ci0JLyogRmlsbCB0eF9wcml2ICovCi0JdHhfcHJpdiA9IChz
dHJ1Y3Qgd2Z4X3R4X3ByaXYgKil0eF9pbmZvLT5yYXRlX2RyaXZlcl9kYXRhOwotCXR4X3ByaXYt
Pmljdl9zaXplID0gd2Z4X3R4X2dldF9pY3ZfbGVuKGh3X2tleSk7Ci0KLQkvKiBGaWxsIGhpZl9t
c2cgKi8KLQlXQVJOKHNrYl9oZWFkcm9vbShza2IpIDwgd21zZ19sZW4sICJub3QgZW5vdWdoIHNw
YWNlIGluIHNrYiIpOwotCVdBUk4ob2Zmc2V0ICYgMSwgImF0dGVtcHQgdG8gdHJhbnNtaXQgYW4g
dW5hbGlnbmVkIGZyYW1lIik7Ci0Jc2tiX3B1dChza2IsIHR4X3ByaXYtPmljdl9zaXplKTsKLQlz
a2JfcHVzaChza2IsIHdtc2dfbGVuKTsKLQltZW1zZXQoc2tiLT5kYXRhLCAwLCB3bXNnX2xlbik7
Ci0JaGlmX21zZyA9IChzdHJ1Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKLQloaWZfbXNnLT5sZW4g
PSBjcHVfdG9fbGUxNihza2ItPmxlbik7Ci0JaGlmX21zZy0+aWQgPSBISUZfUkVRX0lEX1RYOwot
CWhpZl9tc2ctPmludGVyZmFjZSA9IHd2aWYtPmlkOwotCWlmIChza2ItPmxlbiA+IHd2aWYtPndk
ZXYtPmh3X2NhcHMuc2l6ZV9pbnBfY2hfYnVmKSB7Ci0JCWRldl93YXJuKHd2aWYtPndkZXYtPmRl
diwKLQkJCSAicmVxdWVzdGVkIGZyYW1lIHNpemUgKCVkKSBpcyBsYXJnZXIgdGhhbiBtYXhpbXVt
IHN1cHBvcnRlZCAoJWQpXG4iLAotCQkJIHNrYi0+bGVuLCB3dmlmLT53ZGV2LT5od19jYXBzLnNp
emVfaW5wX2NoX2J1Zik7Ci0JCXNrYl9wdWxsKHNrYiwgd21zZ19sZW4pOwotCQlyZXR1cm4gLUVJ
TzsKLQl9Ci0KLQkvKiBGaWxsIHR4IHJlcXVlc3QgKi8KLQlyZXEgPSAoc3RydWN0IGhpZl9yZXFf
dHggKiloaWZfbXNnLT5ib2R5OwotCS8qIHBhY2tldF9pZCBqdXN0IG5lZWQgdG8gYmUgdW5pcXVl
IG9uIGRldmljZS4gMzJiaXRzIGFyZSBtb3JlIHRoYW4KLQkgKiBuZWNlc3NhcnkgZm9yIHRoYXQg
dGFzaywgc28gd2UgdGFlIGFkdmFudGFnZSBvZiBpdCB0byBhZGQgc29tZSBleHRyYQotCSAqIGRh
dGEgZm9yIGRlYnVnLgotCSAqLwotCXJlcS0+cGFja2V0X2lkID0gYXRvbWljX2FkZF9yZXR1cm4o
MSwgJnd2aWYtPndkZXYtPnBhY2tldF9pZCkgJiAweEZGRkY7Ci0JcmVxLT5wYWNrZXRfaWQgfD0g
SUVFRTgwMjExX1NFUV9UT19TTihsZTE2X3RvX2NwdShoZHItPnNlcV9jdHJsKSkgPDwgMTY7Ci0J
cmVxLT5wYWNrZXRfaWQgfD0gcXVldWVfaWQgPDwgMjg7Ci0KLQlyZXEtPmZjX29mZnNldCA9IG9m
ZnNldDsKLQkvKiBRdWV1ZSBpbmRleCBhcmUgaW52ZXJ0ZWQgYmV0d2VlbiBmaXJtd2FyZSBhbmQg
TGludXggKi8KLQlyZXEtPnF1ZXVlX2lkID0gMyAtIHF1ZXVlX2lkOwotCXJlcS0+cGVlcl9zdGFf
aWQgPSB3ZnhfdHhfZ2V0X2xpbmtfaWQod3ZpZiwgc3RhLCBoZHIpOwotCXJlcS0+cmV0cnlfcG9s
aWN5X2luZGV4ID0gd2Z4X3R4X2dldF9yZXRyeV9wb2xpY3lfaWQod3ZpZiwgdHhfaW5mbyk7Ci0J
cmVxLT5mcmFtZV9mb3JtYXQgPSB3ZnhfdHhfZ2V0X2ZyYW1lX2Zvcm1hdCh0eF9pbmZvKTsKLQlp
ZiAodHhfaW5mby0+ZHJpdmVyX3JhdGVzWzBdLmZsYWdzICYgSUVFRTgwMjExX1RYX1JDX1NIT1JU
X0dJKQotCQlyZXEtPnNob3J0X2dpID0gMTsKLQlpZiAodHhfaW5mby0+ZmxhZ3MgJiBJRUVFODAy
MTFfVFhfQ1RMX1NFTkRfQUZURVJfRFRJTSkKLQkJcmVxLT5hZnRlcl9kdGltID0gMTsKLQotCS8q
IEF1eGlsaWFyeSBvcGVyYXRpb25zICovCi0Jd2Z4X3R4X3F1ZXVlc19wdXQod3ZpZiwgc2tiKTsK
LQlpZiAodHhfaW5mby0+ZmxhZ3MgJiBJRUVFODAyMTFfVFhfQ1RMX1NFTkRfQUZURVJfRFRJTSkK
LQkJc2NoZWR1bGVfd29yaygmd3ZpZi0+dXBkYXRlX3RpbV93b3JrKTsKLQl3ZnhfYmhfcmVxdWVz
dF90eCh3dmlmLT53ZGV2KTsKLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB3ZnhfdHgoc3RydWN0IGll
ZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdHhfY29udHJvbCAqY29udHJvbCwKLQkg
ICAgc3RydWN0IHNrX2J1ZmYgKnNrYikKLXsKLQlzdHJ1Y3Qgd2Z4X2RldiAqd2RldiA9IGh3LT5w
cml2OwotCXN0cnVjdCB3ZnhfdmlmICp3dmlmOwotCXN0cnVjdCBpZWVlODAyMTFfc3RhICpzdGEg
PSBjb250cm9sID8gY29udHJvbC0+c3RhIDogTlVMTDsKLQlzdHJ1Y3QgaWVlZTgwMjExX3R4X2lu
Zm8gKnR4X2luZm8gPSBJRUVFODAyMTFfU0tCX0NCKHNrYik7Ci0Jc3RydWN0IGllZWU4MDIxMV9o
ZHIgKmhkciA9IChzdHJ1Y3QgaWVlZTgwMjExX2hkciAqKXNrYi0+ZGF0YTsKLQlzaXplX3QgZHJp
dmVyX2RhdGFfcm9vbSA9IHNpemVvZl9maWVsZChzdHJ1Y3QgaWVlZTgwMjExX3R4X2luZm8sCi0J
CQkJCSAgICAgICByYXRlX2RyaXZlcl9kYXRhKTsKLQotCWNvbXBpbGV0aW1lX2Fzc2VydChzaXpl
b2Yoc3RydWN0IHdmeF90eF9wcml2KSA8PSBkcml2ZXJfZGF0YV9yb29tLAotCQkJICAgInN0cnVj
dCB0eF9wcml2IGlzIHRvbyBsYXJnZSIpOwotCVdBUk4oc2tiLT5uZXh0IHx8IHNrYi0+cHJldiwg
InNrYiBpcyBhbHJlYWR5IG1lbWJlciBvZiBhIGxpc3QiKTsKLQkvKiBjb250cm9sLnZpZiBjYW4g
YmUgTlVMTCBmb3IgaW5qZWN0ZWQgZnJhbWVzICovCi0JaWYgKHR4X2luZm8tPmNvbnRyb2wudmlm
KQotCQl3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICopdHhfaW5mby0+Y29udHJvbC52aWYtPmRydl9w
cml2OwotCWVsc2UKLQkJd3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCBOVUxMKTsKLQlpZiAoV0FS
Tl9PTighd3ZpZikpCi0JCWdvdG8gZHJvcDsKLQkvKiBCZWNhdXNlIG9mIFRYX0FNUERVX1NFVFVQ
X0lOX0hXLCBtYWM4MDIxMSBkb2VzIG5vdCB0cnkgdG8gc2VuZCBhbnkKLQkgKiBCbG9ja0FjayBz
ZXNzaW9uIG1hbmFnZW1lbnQgZnJhbWUuIFRoZSBjaGVjayBiZWxvdyBleGlzdCBqdXN0IGluIGNh
c2UuCi0JICovCi0JaWYgKGllZWU4MDIxMV9pc19hY3Rpb25fYmFjayhoZHIpKSB7Ci0JCWRldl9p
bmZvKHdkZXYtPmRldiwgImRyb3AgQkEgYWN0aW9uXG4iKTsKLQkJZ290byBkcm9wOwotCX0KLQlp
ZiAod2Z4X3R4X2lubmVyKHd2aWYsIHN0YSwgc2tiKSkKLQkJZ290byBkcm9wOwotCi0JcmV0dXJu
OwotCi1kcm9wOgotCWllZWU4MDIxMV90eF9zdGF0dXNfaXJxc2FmZSh3ZGV2LT5odywgc2tiKTsK
LX0KLQotc3RhdGljIHZvaWQgd2Z4X3NrYl9kdG9yKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1
Y3Qgc2tfYnVmZiAqc2tiKQotewotCXN0cnVjdCBoaWZfbXNnICpoaWYgPSAoc3RydWN0IGhpZl9t
c2cgKilza2ItPmRhdGE7Ci0Jc3RydWN0IGhpZl9yZXFfdHggKnJlcSA9IChzdHJ1Y3QgaGlmX3Jl
cV90eCAqKWhpZi0+Ym9keTsKLQl1bnNpZ25lZCBpbnQgb2Zmc2V0ID0gc2l6ZW9mKHN0cnVjdCBo
aWZfbXNnKSArCi0JCQkgICAgICBzaXplb2Yoc3RydWN0IGhpZl9yZXFfdHgpICsKLQkJCSAgICAg
IHJlcS0+ZmNfb2Zmc2V0OwotCi0JaWYgKCF3dmlmKSB7Ci0JCXByX3dhcm4oIiVzOiB2aWYgYXNz
b2NpYXRlZCB3aXRoIHRoZSBza2IgZG9lcyBub3QgZXhpc3QgYW55bW9yZVxuIiwgX19mdW5jX18p
OwotCQlyZXR1cm47Ci0JfQotCXdmeF90eF9wb2xpY3lfcHV0KHd2aWYsIHJlcS0+cmV0cnlfcG9s
aWN5X2luZGV4KTsKLQlza2JfcHVsbChza2IsIG9mZnNldCk7Ci0JaWVlZTgwMjExX3R4X3N0YXR1
c19pcnFzYWZlKHd2aWYtPndkZXYtPmh3LCBza2IpOwotfQotCi1zdGF0aWMgdm9pZCB3ZnhfdHhf
ZmlsbF9yYXRlcyhzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwKLQkJCSAgICAgIHN0cnVjdCBpZWVlODAy
MTFfdHhfaW5mbyAqdHhfaW5mbywKLQkJCSAgICAgIGNvbnN0IHN0cnVjdCBoaWZfY25mX3R4ICph
cmcpCi17Ci0Jc3RydWN0IGllZWU4MDIxMV90eF9yYXRlICpyYXRlOwotCWludCB0eF9jb3VudDsK
LQlpbnQgaTsKLQotCXR4X2NvdW50ID0gYXJnLT5hY2tfZmFpbHVyZXM7Ci0JaWYgKCFhcmctPnN0
YXR1cyB8fCBhcmctPmFja19mYWlsdXJlcykKLQkJdHhfY291bnQgKz0gMTsgLyogQWxzbyByZXBv
cnQgc3VjY2VzcyAqLwotCWZvciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfVFhfTUFYX1JBVEVTOyBp
KyspIHsKLQkJcmF0ZSA9ICZ0eF9pbmZvLT5zdGF0dXMucmF0ZXNbaV07Ci0JCWlmIChyYXRlLT5p
ZHggPCAwKQotCQkJYnJlYWs7Ci0JCWlmICh0eF9jb3VudCA8IHJhdGUtPmNvdW50ICYmCi0JCSAg
ICBhcmctPnN0YXR1cyA9PSBISUZfU1RBVFVTX1RYX0ZBSUxfUkVUUklFUyAmJgotCQkgICAgYXJn
LT5hY2tfZmFpbHVyZXMpCi0JCQlkZXZfZGJnKHdkZXYtPmRldiwgImFsbCByZXRyaWVzIHdlcmUg
bm90IGNvbnN1bWVkOiAlZCAhPSAlZFxuIiwKLQkJCQlyYXRlLT5jb3VudCwgdHhfY291bnQpOwot
CQlpZiAodHhfY291bnQgPD0gcmF0ZS0+Y291bnQgJiYgdHhfY291bnQgJiYKLQkJICAgIGFyZy0+
dHhlZF9yYXRlICE9IHdmeF9nZXRfaHdfcmF0ZSh3ZGV2LCByYXRlKSkKLQkJCWRldl9kYmcod2Rl
di0+ZGV2LCAiaW5jb25zaXN0ZW50IHR4X2luZm8gcmF0ZXM6ICVkICE9ICVkXG4iLAotCQkJCWFy
Zy0+dHhlZF9yYXRlLCB3ZnhfZ2V0X2h3X3JhdGUod2RldiwgcmF0ZSkpOwotCQlpZiAodHhfY291
bnQgPiByYXRlLT5jb3VudCkgewotCQkJdHhfY291bnQgLT0gcmF0ZS0+Y291bnQ7Ci0JCX0gZWxz
ZSBpZiAoIXR4X2NvdW50KSB7Ci0JCQlyYXRlLT5jb3VudCA9IDA7Ci0JCQlyYXRlLT5pZHggPSAt
MTsKLQkJfSBlbHNlIHsKLQkJCXJhdGUtPmNvdW50ID0gdHhfY291bnQ7Ci0JCQl0eF9jb3VudCA9
IDA7Ci0JCX0KLQl9Ci0JaWYgKHR4X2NvdW50KQotCQlkZXZfZGJnKHdkZXYtPmRldiwgIiVkIG1v
cmUgcmV0cmllcyB0aGFuIGV4cGVjdGVkXG4iLCB0eF9jb3VudCk7Ci19Ci0KLXZvaWQgd2Z4X3R4
X2NvbmZpcm1fY2Ioc3RydWN0IHdmeF9kZXYgKndkZXYsIGNvbnN0IHN0cnVjdCBoaWZfY25mX3R4
ICphcmcpCi17Ci0JY29uc3Qgc3RydWN0IHdmeF90eF9wcml2ICp0eF9wcml2OwotCXN0cnVjdCBp
ZWVlODAyMTFfdHhfaW5mbyAqdHhfaW5mbzsKLQlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZjsKLQlzdHJ1
Y3Qgc2tfYnVmZiAqc2tiOwotCi0Jc2tiID0gd2Z4X3BlbmRpbmdfZ2V0KHdkZXYsIGFyZy0+cGFj
a2V0X2lkKTsKLQlpZiAoIXNrYikgewotCQlkZXZfd2Fybih3ZGV2LT5kZXYsICJyZWNlaXZlZCB1
bmtub3duIHBhY2tldF9pZCAoJSMuOHgpIGZyb20gY2hpcFxuIiwKLQkJCSBhcmctPnBhY2tldF9p
ZCk7Ci0JCXJldHVybjsKLQl9Ci0JdHhfaW5mbyA9IElFRUU4MDIxMV9TS0JfQ0Ioc2tiKTsKLQl0
eF9wcml2ID0gd2Z4X3NrYl90eF9wcml2KHNrYik7Ci0Jd3ZpZiA9IHdkZXZfdG9fd3ZpZih3ZGV2
LCAoKHN0cnVjdCBoaWZfbXNnICopc2tiLT5kYXRhKS0+aW50ZXJmYWNlKTsKLQlXQVJOX09OKCF3
dmlmKTsKLQlpZiAoIXd2aWYpCi0JCXJldHVybjsKLQotCS8qIE5vdGUgdGhhdCB3ZnhfcGVuZGlu
Z19nZXRfcGt0X3VzX2RlbGF5KCkgZ2V0IGRhdGEgZnJvbSB0eF9pbmZvICovCi0JX3RyYWNlX3R4
X3N0YXRzKGFyZywgc2tiLCB3ZnhfcGVuZGluZ19nZXRfcGt0X3VzX2RlbGF5KHdkZXYsIHNrYikp
OwotCXdmeF90eF9maWxsX3JhdGVzKHdkZXYsIHR4X2luZm8sIGFyZyk7Ci0Jc2tiX3RyaW0oc2ti
LCBza2ItPmxlbiAtIHR4X3ByaXYtPmljdl9zaXplKTsKLQotCS8qIEZyb20gbm93LCB5b3UgY2Fu
IHRvdWNoIHRvIHR4X2luZm8tPnN0YXR1cywgYnV0IGRvIG5vdCB0b3VjaCB0bwotCSAqIHR4X3By
aXYgYW55bW9yZQotCSAqLwotCS8qIEZJWE1FOiB1c2UgaWVlZTgwMjExX3R4X2luZm9fY2xlYXJf
c3RhdHVzKCkgKi8KLQltZW1zZXQodHhfaW5mby0+cmF0ZV9kcml2ZXJfZGF0YSwgMCwgc2l6ZW9m
KHR4X2luZm8tPnJhdGVfZHJpdmVyX2RhdGEpKTsKLQltZW1zZXQodHhfaW5mby0+cGFkLCAwLCBz
aXplb2YodHhfaW5mby0+cGFkKSk7Ci0KLQlpZiAoIWFyZy0+c3RhdHVzKSB7Ci0JCXR4X2luZm8t
PnN0YXR1cy50eF90aW1lID0KLQkJCWxlMzJfdG9fY3B1KGFyZy0+bWVkaWFfZGVsYXkpIC0KLQkJ
CWxlMzJfdG9fY3B1KGFyZy0+dHhfcXVldWVfZGVsYXkpOwotCQlpZiAodHhfaW5mby0+ZmxhZ3Mg
JiBJRUVFODAyMTFfVFhfQ1RMX05PX0FDSykKLQkJCXR4X2luZm8tPmZsYWdzIHw9IElFRUU4MDIx
MV9UWF9TVEFUX05PQUNLX1RSQU5TTUlUVEVEOwotCQllbHNlCi0JCQl0eF9pbmZvLT5mbGFncyB8
PSBJRUVFODAyMTFfVFhfU1RBVF9BQ0s7Ci0JfSBlbHNlIGlmIChhcmctPnN0YXR1cyA9PSBISUZf
U1RBVFVTX1RYX0ZBSUxfUkVRVUVVRSkgewotCQlXQVJOKCFhcmctPnJlcXVldWUsICJpbmNvaGVy
ZW50IHN0YXR1cyBhbmQgcmVzdWx0X2ZsYWdzIik7Ci0JCWlmICh0eF9pbmZvLT5mbGFncyAmIElF
RUU4MDIxMV9UWF9DVExfU0VORF9BRlRFUl9EVElNKSB7Ci0JCQl3dmlmLT5hZnRlcl9kdGltX3R4
X2FsbG93ZWQgPSBmYWxzZTsgLyogRFRJTSBwZXJpb2QgZWxhcHNlZCAqLwotCQkJc2NoZWR1bGVf
d29yaygmd3ZpZi0+dXBkYXRlX3RpbV93b3JrKTsKLQkJfQotCQl0eF9pbmZvLT5mbGFncyB8PSBJ
RUVFODAyMTFfVFhfU1RBVF9UWF9GSUxURVJFRDsKLQl9Ci0Jd2Z4X3NrYl9kdG9yKHd2aWYsIHNr
Yik7Ci19Ci0KLXN0YXRpYyB2b2lkIHdmeF9mbHVzaF92aWYoc3RydWN0IHdmeF92aWYgKnd2aWYs
IHUzMiBxdWV1ZXMsCi0JCQkgIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpCi17Ci0Jc3Ry
dWN0IHdmeF9xdWV1ZSAqcXVldWU7Ci0JaW50IGk7Ci0KLQlmb3IgKGkgPSAwOyBpIDwgSUVFRTgw
MjExX05VTV9BQ1M7IGkrKykgewotCQlpZiAoIShCSVQoaSkgJiBxdWV1ZXMpKQotCQkJY29udGlu
dWU7Ci0JCXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVlW2ldOwotCQlpZiAoZHJvcHBlZCkKLQkJCXdm
eF90eF9xdWV1ZV9kcm9wKHd2aWYsIHF1ZXVlLCBkcm9wcGVkKTsKLQl9Ci0JaWYgKHd2aWYtPndk
ZXYtPmNoaXBfZnJvemVuKQotCQlyZXR1cm47Ci0JZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9O
VU1fQUNTOyBpKyspIHsKLQkJaWYgKCEoQklUKGkpICYgcXVldWVzKSkKLQkJCWNvbnRpbnVlOwot
CQlxdWV1ZSA9ICZ3dmlmLT50eF9xdWV1ZVtpXTsKLQkJaWYgKHdhaXRfZXZlbnRfdGltZW91dCh3
dmlmLT53ZGV2LT50eF9kZXF1ZXVlLAotCQkJCSAgICAgICB3ZnhfdHhfcXVldWVfZW1wdHkod3Zp
ZiwgcXVldWUpLAotCQkJCSAgICAgICBtc2Vjc190b19qaWZmaWVzKDEwMDApKSA8PSAwKQotCQkJ
ZGV2X3dhcm4od3ZpZi0+d2Rldi0+ZGV2LAotCQkJCSAiZnJhbWVzIHF1ZXVlZCB3aGlsZSBmbHVz
aGluZyB0eCBxdWV1ZXM/Iik7Ci0JfQotfQotCi12b2lkIHdmeF9mbHVzaChzdHJ1Y3QgaWVlZTgw
MjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKLQkgICAgICAgdTMyIHF1ZXVl
cywgYm9vbCBkcm9wKQotewotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gaHctPnByaXY7Ci0Jc3Ry
dWN0IHNrX2J1ZmZfaGVhZCBkcm9wcGVkOwotCXN0cnVjdCB3ZnhfdmlmICp3dmlmOwotCXN0cnVj
dCBoaWZfbXNnICpoaWY7Ci0Jc3RydWN0IHNrX2J1ZmYgKnNrYjsKLQotCXNrYl9xdWV1ZV9oZWFk
X2luaXQoJmRyb3BwZWQpOwotCWlmICh2aWYpIHsKLQkJd3ZpZiA9IChzdHJ1Y3Qgd2Z4X3ZpZiAq
KXZpZi0+ZHJ2X3ByaXY7Ci0JCXdmeF9mbHVzaF92aWYod3ZpZiwgcXVldWVzLCBkcm9wID8gJmRy
b3BwZWQgOiBOVUxMKTsKLQl9IGVsc2UgewotCQl3dmlmID0gTlVMTDsKLQkJd2hpbGUgKCh3dmlm
ID0gd3ZpZl9pdGVyYXRlKHdkZXYsIHd2aWYpKSAhPSBOVUxMKQotCQkJd2Z4X2ZsdXNoX3ZpZih3
dmlmLCBxdWV1ZXMsIGRyb3AgPyAmZHJvcHBlZCA6IE5VTEwpOwotCX0KLQl3ZnhfdHhfZmx1c2go
d2Rldik7Ci0JaWYgKHdkZXYtPmNoaXBfZnJvemVuKQotCQl3ZnhfcGVuZGluZ19kcm9wKHdkZXYs
ICZkcm9wcGVkKTsKLQl3aGlsZSAoKHNrYiA9IHNrYl9kZXF1ZXVlKCZkcm9wcGVkKSkgIT0gTlVM
TCkgewotCQloaWYgPSAoc3RydWN0IGhpZl9tc2cgKilza2ItPmRhdGE7Ci0JCXd2aWYgPSB3ZGV2
X3RvX3d2aWYod2RldiwgaGlmLT5pbnRlcmZhY2UpOwotCQlpZWVlODAyMTFfdHhfaW5mb19jbGVh
cl9zdGF0dXMoSUVFRTgwMjExX1NLQl9DQihza2IpKTsKLQkJd2Z4X3NrYl9kdG9yKHd2aWYsIHNr
Yik7Ci0JfQotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmggYi9k
cml2ZXJzL3N0YWdpbmcvd2Z4L2RhdGFfdHguaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMTU1OTBhOGZhZWZlLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9k
YXRhX3R4LmgKKysrIC9kZXYvbnVsbApAQCAtMSw2OCArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCi0vKgotICogRGF0YSB0cmFuc21pdHRpbmcgaW1w
bGVtZW50YXRpb24uCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFi
b3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKi8K
LSNpZm5kZWYgV0ZYX0RBVEFfVFhfSAotI2RlZmluZSBXRlhfREFUQV9UWF9ICi0KLSNpbmNsdWRl
IDxsaW51eC9saXN0Lmg+Ci0jaW5jbHVkZSA8bmV0L21hYzgwMjExLmg+Ci0KLSNpbmNsdWRlICJo
aWZfYXBpX2NtZC5oIgotI2luY2x1ZGUgImhpZl9hcGlfbWliLmgiCi0KLXN0cnVjdCB3ZnhfdHhf
cHJpdjsKLXN0cnVjdCB3ZnhfZGV2Owotc3RydWN0IHdmeF92aWY7Ci0KLXN0cnVjdCB0eF9wb2xp
Y3kgewotCXN0cnVjdCBsaXN0X2hlYWQgbGluazsKLQlpbnQgdXNhZ2VfY291bnQ7Ci0JdTggcmF0
ZXNbMTJdOwotCWJvb2wgdXBsb2FkZWQ7Ci19OwotCi1zdHJ1Y3QgdHhfcG9saWN5X2NhY2hlIHsK
LQlzdHJ1Y3QgdHhfcG9saWN5IGNhY2hlW0hJRl9UWF9SRVRSWV9QT0xJQ1lfTUFYXTsKLQkvKiBG
SVhNRTogdXNlIGEgdHJlZXMgYW5kIGRyb3AgaGFzaCBmcm9tIHR4X3BvbGljeSAqLwotCXN0cnVj
dCBsaXN0X2hlYWQgdXNlZDsKLQlzdHJ1Y3QgbGlzdF9oZWFkIGZyZWU7Ci0Jc3BpbmxvY2tfdCBs
b2NrOwotfTsKLQotc3RydWN0IHdmeF90eF9wcml2IHsKLQlrdGltZV90IHhtaXRfdGltZXN0YW1w
OwotCXVuc2lnbmVkIGNoYXIgaWN2X3NpemU7Ci19OwotCi12b2lkIHdmeF90eF9wb2xpY3lfaW5p
dChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZik7Ci12b2lkIHdmeF90eF9wb2xpY3lfdXBsb2FkX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKTsKLQotdm9pZCB3ZnhfdHgoc3RydWN0IGllZWU4MDIx
MV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdHhfY29udHJvbCAqY29udHJvbCwKLQkgICAgc3Ry
dWN0IHNrX2J1ZmYgKnNrYik7Ci12b2lkIHdmeF90eF9jb25maXJtX2NiKHN0cnVjdCB3ZnhfZGV2
ICp3ZGV2LCBjb25zdCBzdHJ1Y3QgaGlmX2NuZl90eCAqYXJnKTsKLXZvaWQgd2Z4X2ZsdXNoKHN0
cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLAotCSAgICAg
ICB1MzIgcXVldWVzLCBib29sIGRyb3ApOwotCi1zdGF0aWMgaW5saW5lIHN0cnVjdCB3ZnhfdHhf
cHJpdiAqd2Z4X3NrYl90eF9wcml2KHN0cnVjdCBza19idWZmICpza2IpCi17Ci0Jc3RydWN0IGll
ZWU4MDIxMV90eF9pbmZvICp0eF9pbmZvOwotCi0JaWYgKCFza2IpCi0JCXJldHVybiBOVUxMOwot
CXR4X2luZm8gPSBJRUVFODAyMTFfU0tCX0NCKHNrYik7Ci0JcmV0dXJuIChzdHJ1Y3Qgd2Z4X3R4
X3ByaXYgKil0eF9pbmZvLT5yYXRlX2RyaXZlcl9kYXRhOwotfQotCi1zdGF0aWMgaW5saW5lIHN0
cnVjdCBoaWZfcmVxX3R4ICp3Znhfc2tiX3R4cmVxKHN0cnVjdCBza19idWZmICpza2IpCi17Ci0J
c3RydWN0IGhpZl9tc2cgKmhpZiA9IChzdHJ1Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKLQlzdHJ1
Y3QgaGlmX3JlcV90eCAqcmVxID0gKHN0cnVjdCBoaWZfcmVxX3R4ICopaGlmLT5ib2R5OwotCi0J
cmV0dXJuIHJlcTsKLX0KLQotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4
L2RlYnVnLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2RlYnVnLmMKZGVsZXRlZCBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDlmOTMyNjhhMzIwMi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3Rh
Z2luZy93ZngvZGVidWcuYworKysgL2Rldi9udWxsCkBAIC0xLDM2NSArMCwwIEBACi0vLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Ci0vKgotICogRGVidWdmcyBpbnRlcmZh
Y2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVz
LCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKi8KLSNpbmNsdWRl
IDxsaW51eC9kZWJ1Z2ZzLmg+Ci0jaW5jbHVkZSA8bGludXgvc2VxX2ZpbGUuaD4KLSNpbmNsdWRl
IDxsaW51eC9jcmMzMi5oPgotCi0jaW5jbHVkZSAiZGVidWcuaCIKLSNpbmNsdWRlICJ3ZnguaCIK
LSNpbmNsdWRlICJzdGEuaCIKLSNpbmNsdWRlICJtYWluLmgiCi0jaW5jbHVkZSAiaGlmX3R4Lmgi
Ci0jaW5jbHVkZSAiaGlmX3R4X21pYi5oIgotCi0jZGVmaW5lIENSRUFURV9UUkFDRV9QT0lOVFMK
LSNpbmNsdWRlICJ0cmFjZXMuaCIKLQotc3RhdGljIGNvbnN0IHN0cnVjdCB0cmFjZV9wcmludF9m
bGFncyBoaWZfbXNnX3ByaW50X21hcFtdID0gewotCWhpZl9tc2dfbGlzdCwKLX07Ci0KLXN0YXRp
YyBjb25zdCBzdHJ1Y3QgdHJhY2VfcHJpbnRfZmxhZ3MgaGlmX21pYl9wcmludF9tYXBbXSA9IHsK
LQloaWZfbWliX2xpc3QsCi19OwotCi1zdGF0aWMgY29uc3Qgc3RydWN0IHRyYWNlX3ByaW50X2Zs
YWdzIHdmeF9yZWdfcHJpbnRfbWFwW10gPSB7Ci0Jd2Z4X3JlZ19saXN0LAotfTsKLQotc3RhdGlj
IGNvbnN0IGNoYXIgKmdldF9zeW1ib2wodW5zaWduZWQgbG9uZyB2YWwsCi0JCQkgICAgICBjb25z
dCBzdHJ1Y3QgdHJhY2VfcHJpbnRfZmxhZ3MgKnN5bWJvbF9hcnJheSkKLXsKLQlpbnQgaTsKLQot
CWZvciAoaSA9IDA7IHN5bWJvbF9hcnJheVtpXS5tYXNrICE9IC0xOyBpKyspIHsKLQkJaWYgKHZh
bCA9PSBzeW1ib2xfYXJyYXlbaV0ubWFzaykKLQkJCXJldHVybiBzeW1ib2xfYXJyYXlbaV0ubmFt
ZTsKLQl9Ci0KLQlyZXR1cm4gInVua25vd24iOwotfQotCi1jb25zdCBjaGFyICpnZXRfaGlmX25h
bWUodW5zaWduZWQgbG9uZyBpZCkKLXsKLQlyZXR1cm4gZ2V0X3N5bWJvbChpZCwgaGlmX21zZ19w
cmludF9tYXApOwotfQotCi1jb25zdCBjaGFyICpnZXRfbWliX25hbWUodW5zaWduZWQgbG9uZyBp
ZCkKLXsKLQlyZXR1cm4gZ2V0X3N5bWJvbChpZCwgaGlmX21pYl9wcmludF9tYXApOwotfQotCi1j
b25zdCBjaGFyICpnZXRfcmVnX25hbWUodW5zaWduZWQgbG9uZyBpZCkKLXsKLQlyZXR1cm4gZ2V0
X3N5bWJvbChpZCwgd2Z4X3JlZ19wcmludF9tYXApOwotfQotCi1zdGF0aWMgaW50IHdmeF9jb3Vu
dGVyc19zaG93KHN0cnVjdCBzZXFfZmlsZSAqc2VxLCB2b2lkICp2KQotewotCWludCByZXQsIGk7
Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYgPSBzZXEtPnByaXZhdGU7Ci0Jc3RydWN0IGhpZl9taWJf
ZXh0ZW5kZWRfY291bnRfdGFibGUgY291bnRlcnNbM107Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShjb3VudGVycyk7IGkrKykgewotCQlyZXQgPSBoaWZfZ2V0X2NvdW50ZXJzX3RhYmxl
KHdkZXYsIGksIGNvdW50ZXJzICsgaSk7Ci0JCWlmIChyZXQgPCAwKQotCQkJcmV0dXJuIHJldDsK
LQkJaWYgKHJldCA+IDApCi0JCQlyZXR1cm4gLUVJTzsKLQl9Ci0KLQlzZXFfcHJpbnRmKHNlcSwg
IiUtMjRzICUxMnMgJTEycyAlMTJzXG4iLAotCQkgICAiIiwgImdsb2JhbCIsICJpZmFjZSAwIiwg
ImlmYWNlIDEiKTsKLQotI2RlZmluZSBQVVRfQ09VTlRFUihuYW1lKSBcCi0Jc2VxX3ByaW50Zihz
ZXEsICIlLTI0cyAlMTJkICUxMmQgJTEyZFxuIiwgI25hbWUsIFwKLQkJICAgbGUzMl90b19jcHUo
Y291bnRlcnNbMl0uY291bnRfIyNuYW1lKSwgXAotCQkgICBsZTMyX3RvX2NwdShjb3VudGVyc1sw
XS5jb3VudF8jI25hbWUpLCBcCi0JCSAgIGxlMzJfdG9fY3B1KGNvdW50ZXJzWzFdLmNvdW50XyMj
bmFtZSkpCi0KLQlQVVRfQ09VTlRFUih0eF9mcmFtZXMpOwotCVBVVF9DT1VOVEVSKHR4X2ZyYW1l
c19tdWx0aWNhc3QpOwotCVBVVF9DT1VOVEVSKHR4X2ZyYW1lc19zdWNjZXNzKTsKLQlQVVRfQ09V
TlRFUih0eF9mcmFtZXNfcmV0cmllZCk7Ci0JUFVUX0NPVU5URVIodHhfZnJhbWVzX211bHRpX3Jl
dHJpZWQpOwotCVBVVF9DT1VOVEVSKHR4X2ZyYW1lc19mYWlsZWQpOwotCi0JUFVUX0NPVU5URVIo
YWNrX2ZhaWxlZCk7Ci0JUFVUX0NPVU5URVIocnRzX3N1Y2Nlc3MpOwotCVBVVF9DT1VOVEVSKHJ0
c19mYWlsZWQpOwotCi0JUFVUX0NPVU5URVIocnhfZnJhbWVzKTsKLQlQVVRfQ09VTlRFUihyeF9m
cmFtZXNfbXVsdGljYXN0KTsKLQlQVVRfQ09VTlRFUihyeF9mcmFtZXNfc3VjY2Vzcyk7Ci0JUFVU
X0NPVU5URVIocnhfZnJhbWVzX2ZhaWxlZCk7Ci0JUFVUX0NPVU5URVIoZHJvcF9wbGNwKTsKLQlQ
VVRfQ09VTlRFUihkcm9wX2Zjcyk7Ci0JUFVUX0NPVU5URVIoZHJvcF9ub19rZXkpOwotCVBVVF9D
T1VOVEVSKGRyb3BfZGVjcnlwdGlvbik7Ci0JUFVUX0NPVU5URVIoZHJvcF90a2lwX21pYyk7Ci0J
UFVUX0NPVU5URVIoZHJvcF9iaXBfbWljKTsKLQlQVVRfQ09VTlRFUihkcm9wX2NtYWNfaWN2KTsK
LQlQVVRfQ09VTlRFUihkcm9wX2NtYWNfcmVwbGF5KTsKLQlQVVRfQ09VTlRFUihkcm9wX2NjbXBf
cmVwbGF5KTsKLQlQVVRfQ09VTlRFUihkcm9wX2R1cGxpY2F0ZSk7Ci0KLQlQVVRfQ09VTlRFUihy
eF9iY25fbWlzcyk7Ci0JUFVUX0NPVU5URVIocnhfYmNuX3N1Y2Nlc3MpOwotCVBVVF9DT1VOVEVS
KHJ4X2Jjbl9kdGltKTsKLQlQVVRfQ09VTlRFUihyeF9iY25fZHRpbV9haWQwX2Nscik7Ci0JUFVU
X0NPVU5URVIocnhfYmNuX2R0aW1fYWlkMF9zZXQpOwotCi0jdW5kZWYgUFVUX0NPVU5URVIKLQot
CWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNvdW50ZXJzWzBdLnJlc2VydmVkKTsgaSsrKQot
CQlzZXFfcHJpbnRmKHNlcSwgInJlc2VydmVkWyUwMmRdJTEycyAlMTJkICUxMmQgJTEyZFxuIiwg
aSwgIiIsCi0JCQkgICBsZTMyX3RvX2NwdShjb3VudGVyc1syXS5yZXNlcnZlZFtpXSksCi0JCQkg
ICBsZTMyX3RvX2NwdShjb3VudGVyc1swXS5yZXNlcnZlZFtpXSksCi0JCQkgICBsZTMyX3RvX2Nw
dShjb3VudGVyc1sxXS5yZXNlcnZlZFtpXSkpOwotCi0JcmV0dXJuIDA7Ci19Ci1ERUZJTkVfU0hP
V19BVFRSSUJVVEUod2Z4X2NvdW50ZXJzKTsKLQotc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBj
aGFubmVsX25hbWVzW10gPSB7Ci0JWzBdID0gIjFNIiwKLQlbMV0gPSAiMk0iLAotCVsyXSA9ICI1
LjVNIiwKLQlbM10gPSAiMTFNIiwKLQkvKiBFbnRyaWVzIDQgYW5kIDUgZG9lcyBub3QgZXhpc3Qg
Ki8KLQlbNl0gPSAiNk0iLAotCVs3XSA9ICI5TSIsCi0JWzhdID0gIjEyTSIsCi0JWzldID0gIjE4
TSIsCi0JWzEwXSA9ICIyNE0iLAotCVsxMV0gPSAiMzZNIiwKLQlbMTJdID0gIjQ4TSIsCi0JWzEz
XSA9ICI1NE0iLAotCVsxNF0gPSAiTUNTMCIsCi0JWzE1XSA9ICJNQ1MxIiwKLQlbMTZdID0gIk1D
UzIiLAotCVsxN10gPSAiTUNTMyIsCi0JWzE4XSA9ICJNQ1M0IiwKLQlbMTldID0gIk1DUzUiLAot
CVsyMF0gPSAiTUNTNiIsCi0JWzIxXSA9ICJNQ1M3IiwKLX07Ci0KLXN0YXRpYyBpbnQgd2Z4X3J4
X3N0YXRzX3Nob3coc3RydWN0IHNlcV9maWxlICpzZXEsIHZvaWQgKnYpCi17Ci0Jc3RydWN0IHdm
eF9kZXYgKndkZXYgPSBzZXEtPnByaXZhdGU7Ci0Jc3RydWN0IGhpZl9yeF9zdGF0cyAqc3QgPSAm
d2Rldi0+cnhfc3RhdHM7Ci0JaW50IGk7Ci0KLQltdXRleF9sb2NrKCZ3ZGV2LT5yeF9zdGF0c19s
b2NrKTsKLQlzZXFfcHJpbnRmKHNlcSwgIlRpbWVzdGFtcDogJWR1c1xuIiwgc3QtPmRhdGUpOwot
CXNlcV9wcmludGYoc2VxLCAiTG93IHBvd2VyIGNsb2NrOiBmcmVxdWVuY3kgJXVIeiwgZXh0ZXJu
YWwgJXNcbiIsCi0JCSAgIGxlMzJfdG9fY3B1KHN0LT5wd3JfY2xrX2ZyZXEpLAotCQkgICBzdC0+
aXNfZXh0X3B3cl9jbGsgPyAieWVzIiA6ICJubyIpOwotCXNlcV9wcmludGYoc2VxLAotCQkgICAi
TnVtLiBvZiBmcmFtZXM6ICVkLCBQRVIgKHgxMGU0KTogJWQsIFRocm91Z2hwdXQ6ICVkS2Jwcy9z
XG4iLAotCQkgICBzdC0+bmJfcnhfZnJhbWUsIHN0LT5wZXJfdG90YWwsIHN0LT50aHJvdWdocHV0
KTsKLQlzZXFfcHV0cyhzZXEsICIgICAgICAgTnVtLiBvZiAgICAgIFBFUiAgICAgUlNTSSAgICAg
IFNOUiAgICAgIENGT1xuIik7Ci0Jc2VxX3B1dHMoc2VxLCAiICAgICAgICBmcmFtZXMgICh4MTBl
NCkgICAgKGRCbSkgICAgIChkQikgICAgKGtIeilcbiIpOwotCWZvciAoaSA9IDA7IGkgPCBBUlJB
WV9TSVpFKGNoYW5uZWxfbmFtZXMpOyBpKyspIHsKLQkJaWYgKGNoYW5uZWxfbmFtZXNbaV0pCi0J
CQlzZXFfcHJpbnRmKHNlcSwgIiU1cyAlOGQgJThkICU4ZCAlOGQgJThkXG4iLAotCQkJCSAgIGNo
YW5uZWxfbmFtZXNbaV0sCi0JCQkJICAgbGUzMl90b19jcHUoc3QtPm5iX3J4X2J5X3JhdGVbaV0p
LAotCQkJCSAgIGxlMTZfdG9fY3B1KHN0LT5wZXJbaV0pLAotCQkJCSAgIChzMTYpbGUxNl90b19j
cHUoc3QtPnJzc2lbaV0pIC8gMTAwLAotCQkJCSAgIChzMTYpbGUxNl90b19jcHUoc3QtPnNucltp
XSkgLyAxMDAsCi0JCQkJICAgKHMxNilsZTE2X3RvX2NwdShzdC0+Y2ZvW2ldKSk7Ci0JfQotCW11
dGV4X3VubG9jaygmd2Rldi0+cnhfc3RhdHNfbG9jayk7Ci0KLQlyZXR1cm4gMDsKLX0KLURFRklO
RV9TSE9XX0FUVFJJQlVURSh3Znhfcnhfc3RhdHMpOwotCi1zdGF0aWMgaW50IHdmeF90eF9wb3dl
cl9sb29wX3Nob3coc3RydWN0IHNlcV9maWxlICpzZXEsIHZvaWQgKnYpCi17Ci0Jc3RydWN0IHdm
eF9kZXYgKndkZXYgPSBzZXEtPnByaXZhdGU7Ci0Jc3RydWN0IGhpZl90eF9wb3dlcl9sb29wX2lu
Zm8gKnN0ID0gJndkZXYtPnR4X3Bvd2VyX2xvb3BfaW5mbzsKLQlpbnQgdG1wOwotCi0JbXV0ZXhf
bG9jaygmd2Rldi0+dHhfcG93ZXJfbG9vcF9pbmZvX2xvY2spOwotCXRtcCA9IGxlMTZfdG9fY3B1
KHN0LT50eF9nYWluX2RpZyk7Ci0Jc2VxX3ByaW50ZihzZXEsICJUeCBnYWluIGRpZ2l0YWw6ICVk
XG4iLCB0bXApOwotCXRtcCA9IGxlMTZfdG9fY3B1KHN0LT50eF9nYWluX3BhKTsKLQlzZXFfcHJp
bnRmKHNlcSwgIlR4IGdhaW4gUEE6ICVkXG4iLCB0bXApOwotCXRtcCA9IChzMTYpbGUxNl90b19j
cHUoc3QtPnRhcmdldF9wb3V0KTsKLQlzZXFfcHJpbnRmKHNlcSwgIlRhcmdldCBQb3V0OiAlZC4l
MDJkIGRCbVxuIiwgdG1wIC8gNCwgKHRtcCAlIDQpICogMjUpOwotCXRtcCA9IChzMTYpbGUxNl90
b19jcHUoc3QtPnBfZXN0aW1hdGlvbik7Ci0Jc2VxX3ByaW50ZihzZXEsICJGRU0gUG91dDogJWQu
JTAyZCBkQm1cbiIsIHRtcCAvIDQsICh0bXAgJSA0KSAqIDI1KTsKLQl0bXAgPSBsZTE2X3RvX2Nw
dShzdC0+dnBkZXQpOwotCXNlcV9wcmludGYoc2VxLCAiVnBkZXQ6ICVkIG1WXG4iLCB0bXApOwot
CXNlcV9wcmludGYoc2VxLCAiTWVhc3VyZSBpbmRleDogJWRcbiIsIHN0LT5tZWFzdXJlbWVudF9p
bmRleCk7Ci0JbXV0ZXhfdW5sb2NrKCZ3ZGV2LT50eF9wb3dlcl9sb29wX2luZm9fbG9jayk7Ci0K
LQlyZXR1cm4gMDsKLX0KLURFRklORV9TSE9XX0FUVFJJQlVURSh3ZnhfdHhfcG93ZXJfbG9vcCk7
Ci0KLXN0YXRpYyBzc2l6ZV90IHdmeF9zZW5kX3Bkc193cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
LQkJCQkgIGNvbnN0IGNoYXIgX191c2VyICp1c2VyX2J1ZiwKLQkJCQkgIHNpemVfdCBjb3VudCwg
bG9mZl90ICpwcG9zKQotewotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gZmlsZS0+cHJpdmF0ZV9k
YXRhOwotCWNoYXIgKmJ1ZjsKLQlpbnQgcmV0OwotCi0JaWYgKCpwcG9zICE9IDApIHsKLQkJZGV2
X2RiZyh3ZGV2LT5kZXYsICJQRFMgZGF0YSBtdXN0IGJlIHdyaXR0ZW4gaW4gb25lIHRyYW5zYWN0
aW9uIik7Ci0JCXJldHVybiAtRUJVU1k7Ci0JfQotCWJ1ZiA9IG1lbWR1cF91c2VyKHVzZXJfYnVm
LCBjb3VudCk7Ci0JaWYgKElTX0VSUihidWYpKQotCQlyZXR1cm4gUFRSX0VSUihidWYpOwotCSpw
cG9zID0gKnBwb3MgKyBjb3VudDsKLQlyZXQgPSB3Znhfc2VuZF9wZHMod2RldiwgYnVmLCBjb3Vu
dCk7Ci0Ja2ZyZWUoYnVmKTsKLQlpZiAocmV0IDwgMCkKLQkJcmV0dXJuIHJldDsKLQlyZXR1cm4g
Y291bnQ7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIHdmeF9zZW5k
X3Bkc19mb3BzID0gewotCS5vcGVuID0gc2ltcGxlX29wZW4sCi0JLndyaXRlID0gd2Z4X3NlbmRf
cGRzX3dyaXRlLAotfTsKLQotc3RydWN0IGRiZ2ZzX2hpZl9tc2cgewotCXN0cnVjdCB3ZnhfZGV2
ICp3ZGV2OwotCXN0cnVjdCBjb21wbGV0aW9uIGNvbXBsZXRlOwotCXU4IHJlcGx5WzEwMjRdOwot
CWludCByZXQ7Ci19OwotCi1zdGF0aWMgc3NpemVfdCB3Znhfc2VuZF9oaWZfbXNnX3dyaXRlKHN0
cnVjdCBmaWxlICpmaWxlLAotCQkJCSAgICAgIGNvbnN0IGNoYXIgX191c2VyICp1c2VyX2J1ZiwK
LQkJCQkgICAgICBzaXplX3QgY291bnQsIGxvZmZfdCAqcHBvcykKLXsKLQlzdHJ1Y3QgZGJnZnNf
aGlmX21zZyAqY29udGV4dCA9IGZpbGUtPnByaXZhdGVfZGF0YTsKLQlzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiA9IGNvbnRleHQtPndkZXY7Ci0Jc3RydWN0IGhpZl9tc2cgKnJlcXVlc3Q7Ci0KLQlpZiAo
Y29tcGxldGlvbl9kb25lKCZjb250ZXh0LT5jb21wbGV0ZSkpIHsKLQkJZGV2X2RiZyh3ZGV2LT5k
ZXYsICJyZWFkIHByZXZpb3VzIHJlc3VsdCBiZWZvcmUgc3RhcnQgYSBuZXcgb25lXG4iKTsKLQkJ
cmV0dXJuIC1FQlVTWTsKLQl9Ci0JaWYgKGNvdW50IDwgc2l6ZW9mKHN0cnVjdCBoaWZfbXNnKSkK
LQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQkvKiB3ZnhfY21kX3NlbmQoKSBjaGVja3MgdGhhdCByZXBs
eSBidWZmZXIgaXMgd2lkZSBlbm91Z2gsIGJ1dCBkb2VzIG5vdAotCSAqIHJldHVybiBwcmVjaXNl
IGxlbmd0aCByZWFkLiBVc2VyIGhhdmUgdG8ga25vdyBob3cgbWFueSBieXRlcyBzaG91bGQKLQkg
KiBiZSByZWFkLiBGaWxsaW5nIHJlcGx5IGJ1ZmZlciB3aXRoIGEgbWVtb3J5IHBhdHRlcm4gbWF5
IGhlbHAgdXNlci4KLQkgKi8KLQltZW1zZXQoY29udGV4dC0+cmVwbHksIDB4RkYsIHNpemVvZihj
b250ZXh0LT5yZXBseSkpOwotCXJlcXVlc3QgPSBtZW1kdXBfdXNlcih1c2VyX2J1ZiwgY291bnQp
OwotCWlmIChJU19FUlIocmVxdWVzdCkpCi0JCXJldHVybiBQVFJfRVJSKHJlcXVlc3QpOwotCWlm
IChsZTE2X3RvX2NwdShyZXF1ZXN0LT5sZW4pICE9IGNvdW50KSB7Ci0JCWtmcmVlKHJlcXVlc3Qp
OwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0JY29udGV4dC0+cmV0ID0gd2Z4X2NtZF9zZW5kKHdk
ZXYsIHJlcXVlc3QsIGNvbnRleHQtPnJlcGx5LAotCQkJCSAgICBzaXplb2YoY29udGV4dC0+cmVw
bHkpLCBmYWxzZSk7Ci0KLQlrZnJlZShyZXF1ZXN0KTsKLQljb21wbGV0ZSgmY29udGV4dC0+Y29t
cGxldGUpOwotCXJldHVybiBjb3VudDsKLX0KLQotc3RhdGljIHNzaXplX3Qgd2Z4X3NlbmRfaGlm
X21zZ19yZWFkKHN0cnVjdCBmaWxlICpmaWxlLCBjaGFyIF9fdXNlciAqdXNlcl9idWYsCi0JCQkJ
ICAgICBzaXplX3QgY291bnQsIGxvZmZfdCAqcHBvcykKLXsKLQlzdHJ1Y3QgZGJnZnNfaGlmX21z
ZyAqY29udGV4dCA9IGZpbGUtPnByaXZhdGVfZGF0YTsKLQlpbnQgcmV0OwotCi0JaWYgKGNvdW50
ID4gc2l6ZW9mKGNvbnRleHQtPnJlcGx5KSkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JcmV0ID0gd2Fp
dF9mb3JfY29tcGxldGlvbl9pbnRlcnJ1cHRpYmxlKCZjb250ZXh0LT5jb21wbGV0ZSk7Ci0JaWYg
KHJldCkKLQkJcmV0dXJuIHJldDsKLQlpZiAoY29udGV4dC0+cmV0IDwgMCkKLQkJcmV0dXJuIGNv
bnRleHQtPnJldDsKLQkvKiBCZSBjYXJlZnVsLCB3cml0ZSgpIGlzIHdhaXRpbmcgZm9yIGEgZnVs
bCBtZXNzYWdlIHdoaWxlIHJlYWQoKQotCSAqIG9ubHkgcmV0dXJucyBhIHBheWxvYWQKLQkgKi8K
LQlpZiAoY29weV90b191c2VyKHVzZXJfYnVmLCBjb250ZXh0LT5yZXBseSwgY291bnQpKQotCQly
ZXR1cm4gLUVGQVVMVDsKLQotCXJldHVybiBjb3VudDsKLX0KLQotc3RhdGljIGludCB3Znhfc2Vu
ZF9oaWZfbXNnX29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCi17
Ci0Jc3RydWN0IGRiZ2ZzX2hpZl9tc2cgKmNvbnRleHQgPSBremFsbG9jKHNpemVvZigqY29udGV4
dCksIEdGUF9LRVJORUwpOwotCi0JaWYgKCFjb250ZXh0KQotCQlyZXR1cm4gLUVOT01FTTsKLQlj
b250ZXh0LT53ZGV2ID0gaW5vZGUtPmlfcHJpdmF0ZTsKLQlpbml0X2NvbXBsZXRpb24oJmNvbnRl
eHQtPmNvbXBsZXRlKTsKLQlmaWxlLT5wcml2YXRlX2RhdGEgPSBjb250ZXh0OwotCXJldHVybiAw
OwotfQotCi1zdGF0aWMgaW50IHdmeF9zZW5kX2hpZl9tc2dfcmVsZWFzZShzdHJ1Y3QgaW5vZGUg
Kmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKLXsKLQlzdHJ1Y3QgZGJnZnNfaGlmX21zZyAqY29u
dGV4dCA9IGZpbGUtPnByaXZhdGVfZGF0YTsKLQotCWtmcmVlKGNvbnRleHQpOwotCXJldHVybiAw
OwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyB3Znhfc2VuZF9oaWZf
bXNnX2ZvcHMgPSB7Ci0JLm9wZW4gPSB3Znhfc2VuZF9oaWZfbXNnX29wZW4sCi0JLnJlbGVhc2Ug
PSB3Znhfc2VuZF9oaWZfbXNnX3JlbGVhc2UsCi0JLndyaXRlID0gd2Z4X3NlbmRfaGlmX21zZ193
cml0ZSwKLQkucmVhZCA9IHdmeF9zZW5kX2hpZl9tc2dfcmVhZCwKLX07Ci0KLXN0YXRpYyBpbnQg
d2Z4X3BzX3RpbWVvdXRfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCi17Ci0Jc3RydWN0IHdmeF9k
ZXYgKndkZXYgPSAoc3RydWN0IHdmeF9kZXYgKilkYXRhOwotCXN0cnVjdCB3ZnhfdmlmICp3dmlm
OwotCi0Jd2Rldi0+Zm9yY2VfcHNfdGltZW91dCA9IHZhbDsKLQl3dmlmID0gTlVMTDsKLQl3aGls
ZSAoKHd2aWYgPSB3dmlmX2l0ZXJhdGUod2Rldiwgd3ZpZikpICE9IE5VTEwpCi0JCXdmeF91cGRh
dGVfcG0od3ZpZik7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgd2Z4X3BzX3RpbWVvdXRf
Z2V0KHZvaWQgKmRhdGEsIHU2NCAqdmFsKQotewotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gKHN0
cnVjdCB3ZnhfZGV2ICopZGF0YTsKLQotCSp2YWwgPSB3ZGV2LT5mb3JjZV9wc190aW1lb3V0Owot
CXJldHVybiAwOwotfQotCi1ERUZJTkVfREVCVUdGU19BVFRSSUJVVEUod2Z4X3BzX3RpbWVvdXRf
Zm9wcywgd2Z4X3BzX3RpbWVvdXRfZ2V0LCB3ZnhfcHNfdGltZW91dF9zZXQsICIlbGxkXG4iKTsK
LQotaW50IHdmeF9kZWJ1Z19pbml0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KQotewotCXN0cnVjdCBk
ZW50cnkgKmQ7Ci0KLQlkID0gZGVidWdmc19jcmVhdGVfZGlyKCJ3ZngiLCB3ZGV2LT5ody0+d2lw
aHktPmRlYnVnZnNkaXIpOwotCWRlYnVnZnNfY3JlYXRlX2ZpbGUoImNvdW50ZXJzIiwgMDQ0NCwg
ZCwgd2RldiwgJndmeF9jb3VudGVyc19mb3BzKTsKLQlkZWJ1Z2ZzX2NyZWF0ZV9maWxlKCJyeF9z
dGF0cyIsIDA0NDQsIGQsIHdkZXYsICZ3Znhfcnhfc3RhdHNfZm9wcyk7Ci0JZGVidWdmc19jcmVh
dGVfZmlsZSgidHhfcG93ZXJfbG9vcCIsIDA0NDQsIGQsIHdkZXYsCi0JCQkgICAgJndmeF90eF9w
b3dlcl9sb29wX2ZvcHMpOwotCWRlYnVnZnNfY3JlYXRlX2ZpbGUoInNlbmRfcGRzIiwgMDIwMCwg
ZCwgd2RldiwgJndmeF9zZW5kX3Bkc19mb3BzKTsKLQlkZWJ1Z2ZzX2NyZWF0ZV9maWxlKCJzZW5k
X2hpZl9tc2ciLCAwNjAwLCBkLCB3ZGV2LAotCQkJICAgICZ3Znhfc2VuZF9oaWZfbXNnX2ZvcHMp
OwotCWRlYnVnZnNfY3JlYXRlX2ZpbGUoInBzX3RpbWVvdXQiLCAwNjAwLCBkLCB3ZGV2LCAmd2Z4
X3BzX3RpbWVvdXRfZm9wcyk7Ci0KLQlyZXR1cm4gMDsKLX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
c3RhZ2luZy93ZngvZGVidWcuaCBiL2RyaXZlcnMvc3RhZ2luZy93ZngvZGVidWcuaApkZWxldGVk
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNGI5YzQ5YTlmZmZiLi4wMDAwMDAwMDAwMDAKLS0tIGEv
ZHJpdmVycy9zdGFnaW5nL3dmeC9kZWJ1Zy5oCisrKyAvZGV2L251bGwKQEAgLTEsMTkgKzAsMCBA
QAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwotLyoKLSAqIERl
YnVnZnMgaW50ZXJmYWNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE5LCBTaWxpY29u
IExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDExLCBTVC1Fcmljc3Nvbgot
ICovCi0jaWZuZGVmIFdGWF9ERUJVR19ICi0jZGVmaW5lIFdGWF9ERUJVR19ICi0KLXN0cnVjdCB3
ZnhfZGV2OwotCi1pbnQgd2Z4X2RlYnVnX2luaXQoc3RydWN0IHdmeF9kZXYgKndkZXYpOwotCi1j
b25zdCBjaGFyICpnZXRfaGlmX25hbWUodW5zaWduZWQgbG9uZyBpZCk7Ci1jb25zdCBjaGFyICpn
ZXRfbWliX25hbWUodW5zaWduZWQgbG9uZyBpZCk7Ci1jb25zdCBjaGFyICpnZXRfcmVnX25hbWUo
dW5zaWduZWQgbG9uZyBpZCk7Ci0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5n
L3dmeC9md2lvLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2Z3aW8uYwpkZWxldGVkIGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggOThhOTM5MWIyYmVlLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9z
dGFnaW5nL3dmeC9md2lvLmMKKysrIC9kZXYvbnVsbApAQCAtMSw0MDUgKzAsMCBAQAotLy8gU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQotLyoKLSAqIEZpcm13YXJlIGxvYWRp
bmcuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVz
LCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKi8KLSNpbmNsdWRl
IDxsaW51eC9maXJtd2FyZS5oPgotI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KLSNpbmNsdWRlIDxs
aW51eC9tbS5oPgotI2luY2x1ZGUgPGxpbnV4L2JpdGZpZWxkLmg+Ci0KLSNpbmNsdWRlICJmd2lv
LmgiCi0jaW5jbHVkZSAid2Z4LmgiCi0jaW5jbHVkZSAiaHdpby5oIgotCi0vKiBBZGRyZXNzZXMg
YmVsb3cgYXJlIGluIFNSQU0gYXJlYSAqLwotI2RlZmluZSBXRlhfRE5MRF9GSUZPICAgICAgICAg
ICAgIDB4MDkwMDQwMDAKLSNkZWZpbmUgICAgIEROTERfQkxPQ0tfU0laRSAgICAgICAgICAgMHgw
NDAwCi0jZGVmaW5lICAgICBETkxEX0ZJRk9fU0laRSAgICAgICAgICAgIDB4ODAwMCAvKiAoMzIg
KiBETkxEX0JMT0NLX1NJWkUpICovCi0vKiBEb3dubG9hZCBDb250cm9sIEFyZWEgKERDQSkgKi8K
LSNkZWZpbmUgV0ZYX0RDQV9JTUFHRV9TSVpFICAgICAgICAweDA5MDBDMDAwCi0jZGVmaW5lIFdG
WF9EQ0FfUFVUICAgICAgICAgICAgICAgMHgwOTAwQzAwNAotI2RlZmluZSBXRlhfRENBX0dFVCAg
ICAgICAgICAgICAgIDB4MDkwMEMwMDgKLSNkZWZpbmUgV0ZYX0RDQV9IT1NUX1NUQVRVUyAgICAg
ICAweDA5MDBDMDBDCi0jZGVmaW5lICAgICBIT1NUX1JFQURZICAgICAgICAgICAgICAgIDB4ODc2
NTQzMjEKLSNkZWZpbmUgICAgIEhPU1RfSU5GT19SRUFEICAgICAgICAgICAgMHhBNzUzQkQ5OQot
I2RlZmluZSAgICAgSE9TVF9VUExPQURfUEVORElORyAgICAgICAweEFCQ0REQ0JBCi0jZGVmaW5l
ICAgICBIT1NUX1VQTE9BRF9DT01QTEVURSAgICAgIDB4RDRDNjRBOTkKLSNkZWZpbmUgICAgIEhP
U1RfT0tfVE9fSlVNUCAgICAgICAgICAgMHgxNzRGQzg4MgotI2RlZmluZSBXRlhfRENBX05DUF9T
VEFUVVMgICAgICAgIDB4MDkwMEMwMTAKLSNkZWZpbmUgICAgIE5DUF9OT1RfUkVBRFkgICAgICAg
ICAgICAgMHgxMjM0NTY3OAotI2RlZmluZSAgICAgTkNQX1JFQURZICAgICAgICAgICAgICAgICAw
eDg3NjU0MzIxCi0jZGVmaW5lICAgICBOQ1BfSU5GT19SRUFEWSAgICAgICAgICAgIDB4QkQ1M0VG
OTkKLSNkZWZpbmUgICAgIE5DUF9ET1dOTE9BRF9QRU5ESU5HICAgICAgMHhBQkNERENCQQotI2Rl
ZmluZSAgICAgTkNQX0RPV05MT0FEX0NPTVBMRVRFICAgICAweENBRkVGRUNBCi0jZGVmaW5lICAg
ICBOQ1BfQVVUSF9PSyAgICAgICAgICAgICAgIDB4RDRDNjRBOTkKLSNkZWZpbmUgICAgIE5DUF9B
VVRIX0ZBSUwgICAgICAgICAgICAgMHgxNzRGQzg4MgotI2RlZmluZSAgICAgTkNQX1BVQl9LRVlf
UkRZICAgICAgICAgICAweDdBQjQxRDE5Ci0jZGVmaW5lIFdGWF9EQ0FfRldfU0lHTkFUVVJFICAg
ICAgMHgwOTAwQzAxNAotI2RlZmluZSAgICAgRldfU0lHTkFUVVJFX1NJWkUgICAgICAgICAweDQw
Ci0jZGVmaW5lIFdGWF9EQ0FfRldfSEFTSCAgICAgICAgICAgMHgwOTAwQzA1NAotI2RlZmluZSAg
ICAgRldfSEFTSF9TSVpFICAgICAgICAgICAgICAweDA4Ci0jZGVmaW5lIFdGWF9EQ0FfRldfVkVS
U0lPTiAgICAgICAgMHgwOTAwQzA1QwotI2RlZmluZSAgICAgRldfVkVSU0lPTl9TSVpFICAgICAg
ICAgICAweDA0Ci0jZGVmaW5lIFdGWF9EQ0FfUkVTRVJWRUQgICAgICAgICAgMHgwOTAwQzA2MAot
I2RlZmluZSAgICAgRENBX1JFU0VSVkVEX1NJWkUgICAgICAgICAweDIwCi0jZGVmaW5lIFdGWF9T
VEFUVVNfSU5GTyAgICAgICAgICAgMHgwOTAwQzA4MAotI2RlZmluZSBXRlhfQk9PVExPQURFUl9M
QUJFTCAgICAgIDB4MDkwMEMwODQKLSNkZWZpbmUgICAgIEJPT1RMT0FERVJfTEFCRUxfU0laRSAg
ICAgMHgzQwotI2RlZmluZSBXRlhfUFRFX0lORk8gICAgICAgICAgICAgIDB4MDkwMEMwQzAKLSNk
ZWZpbmUgICAgIFBURV9JTkZPX0tFWVNFVF9JRFggICAgICAgMHgwRAotI2RlZmluZSAgICAgUFRF
X0lORk9fU0laRSAgICAgICAgICAgICAweDEwCi0jZGVmaW5lIFdGWF9FUlJfSU5GTyAgICAgICAg
ICAgICAgMHgwOTAwQzBEMAotI2RlZmluZSAgICAgRVJSX0lOVkFMSURfU0VDX1RZUEUgICAgICAw
eDA1Ci0jZGVmaW5lICAgICBFUlJfU0lHX1ZFUklGX0ZBSUxFRCAgICAgIDB4MEYKLSNkZWZpbmUg
ICAgIEVSUl9BRVNfQ1RSTF9LRVkgICAgICAgICAgMHgxMAotI2RlZmluZSAgICAgRVJSX0VDQ19Q
VUJfS0VZICAgICAgICAgICAweDExCi0jZGVmaW5lICAgICBFUlJfTUFDX0tFWSAgICAgICAgICAg
ICAgIDB4MTgKLQotI2RlZmluZSBEQ0FfVElNRU9VVCAgNTAgLyogbWlsbGlzZWNvbmRzICovCi0j
ZGVmaW5lIFdBS0VVUF9USU1FT1VUIDIwMCAvKiBtaWxsaXNlY29uZHMgKi8KLQotc3RhdGljIGNv
bnN0IGNoYXIgKiBjb25zdCBmd2lvX2Vycm9yc1tdID0gewotCVtFUlJfSU5WQUxJRF9TRUNfVFlQ
RV0gPSAiSW52YWxpZCBzZWN0aW9uIHR5cGUgb3Igd3JvbmcgZW5jcnlwdGlvbiIsCi0JW0VSUl9T
SUdfVkVSSUZfRkFJTEVEXSA9ICJTaWduYXR1cmUgdmVyaWZpY2F0aW9uIGZhaWxlZCIsCi0JW0VS
Ul9BRVNfQ1RSTF9LRVldID0gIkFFUyBjb250cm9sIGtleSBub3QgaW5pdGlhbGl6ZWQiLAotCVtF
UlJfRUNDX1BVQl9LRVldID0gIkVDQyBwdWJsaWMga2V5IG5vdCBpbml0aWFsaXplZCIsCi0JW0VS
Ul9NQUNfS0VZXSA9ICJNQUMga2V5IG5vdCBpbml0aWFsaXplZCIsCi19OwotCi0vKiByZXF1ZXN0
X2Zpcm13YXJlKCkgYWxsb2NhdGUgZGF0YSB1c2luZyB2bWFsbG9jKCkuIEl0IGlzIG5vdCBjb21w
YXRpYmxlIHdpdGgKLSAqIHVuZGVybHlpbmcgaGFyZHdhcmUgdGhhdCB1c2UgRE1BLiBGdW5jdGlv
biBiZWxvdyBkZXRlY3QgdGhpcyBjYXNlIGFuZAotICogYWxsb2NhdGUgYSBib3VuY2UgYnVmZmVy
IGlmIG5lY2Vzc2FyeS4KLSAqCi0gKiBOb3RpY2UgdGhhdCwgaW4gZG91YnQsIHlvdSBjYW4gZW5h
YmxlIENPTkZJR19ERUJVR19TRyB0byBhc2sga2VybmVsIHRvCi0gKiBkZXRlY3QgdGhpcyBwcm9i
bGVtIGF0IHJ1bnRpbWUgIChlbHNlLCBrZXJuZWwgc2lsZW50bHkgZmFpbCkuCi0gKgotICogTk9U
RTogaXQgbWF5IGFsc28gYmUgcG9zc2libGUgdG8gdXNlICdwYWdlcycgZnJvbSBzdHJ1Y3QgZmly
bXdhcmUgYW5kIGF2b2lkCi0gKiBib3VuY2UgYnVmZmVyCi0gKi8KLXN0YXRpYyBpbnQgc3JhbV93
cml0ZV9kbWFfc2FmZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIGFkZHIsIGNvbnN0IHU4ICpi
dWYsCi0JCQkgICAgICAgc2l6ZV90IGxlbikKLXsKLQlpbnQgcmV0OwotCWNvbnN0IHU4ICp0bXA7
Ci0KLQlpZiAoIXZpcnRfYWRkcl92YWxpZChidWYpKSB7Ci0JCXRtcCA9IGttZW1kdXAoYnVmLCBs
ZW4sIEdGUF9LRVJORUwpOwotCQlpZiAoIXRtcCkKLQkJCXJldHVybiAtRU5PTUVNOwotCX0gZWxz
ZSB7Ci0JCXRtcCA9IGJ1ZjsKLQl9Ci0JcmV0ID0gc3JhbV9idWZfd3JpdGUod2RldiwgYWRkciwg
dG1wLCBsZW4pOwotCWlmICh0bXAgIT0gYnVmKQotCQlrZnJlZSh0bXApOwotCXJldHVybiByZXQ7
Ci19Ci0KLXN0YXRpYyBpbnQgZ2V0X2Zpcm13YXJlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIg
a2V5c2V0X2NoaXAsCi0JCQljb25zdCBzdHJ1Y3QgZmlybXdhcmUgKipmdywgaW50ICpmaWxlX29m
ZnNldCkKLXsKLQlpbnQga2V5c2V0X2ZpbGU7Ci0JY2hhciBmaWxlbmFtZVsyNTZdOwotCWNvbnN0
IGNoYXIgKmRhdGE7Ci0JaW50IHJldDsKLQotCXNucHJpbnRmKGZpbGVuYW1lLCBzaXplb2YoZmls
ZW5hbWUpLCAiJXNfJTAyWC5zZWMiLAotCQkgd2Rldi0+cGRhdGEuZmlsZV9mdywga2V5c2V0X2No
aXApOwotCXJldCA9IGZpcm13YXJlX3JlcXVlc3Rfbm93YXJuKGZ3LCBmaWxlbmFtZSwgd2Rldi0+
ZGV2KTsKLQlpZiAocmV0KSB7Ci0JCWRldl9pbmZvKHdkZXYtPmRldiwgImNhbid0IGxvYWQgJXMs
IGZhbGxpbmcgYmFjayB0byAlcy5zZWNcbiIsCi0JCQkgZmlsZW5hbWUsIHdkZXYtPnBkYXRhLmZp
bGVfZncpOwotCQlzbnByaW50ZihmaWxlbmFtZSwgc2l6ZW9mKGZpbGVuYW1lKSwgIiVzLnNlYyIs
Ci0JCQkgd2Rldi0+cGRhdGEuZmlsZV9mdyk7Ci0JCXJldCA9IHJlcXVlc3RfZmlybXdhcmUoZncs
IGZpbGVuYW1lLCB3ZGV2LT5kZXYpOwotCQlpZiAocmV0KSB7Ci0JCQlkZXZfZXJyKHdkZXYtPmRl
diwgImNhbid0IGxvYWQgJXNcbiIsIGZpbGVuYW1lKTsKLQkJCSpmdyA9IE5VTEw7Ci0JCQlyZXR1
cm4gcmV0OwotCQl9Ci0JfQotCi0JZGF0YSA9ICgqZncpLT5kYXRhOwotCWlmIChtZW1jbXAoZGF0
YSwgIktFWVNFVCIsIDYpICE9IDApIHsKLQkJLyogTGVnYWN5IGZpcm13YXJlIGZvcm1hdCAqLwot
CQkqZmlsZV9vZmZzZXQgPSAwOwotCQlrZXlzZXRfZmlsZSA9IDB4OTA7Ci0JfSBlbHNlIHsKLQkJ
KmZpbGVfb2Zmc2V0ID0gODsKLQkJa2V5c2V0X2ZpbGUgPSAoaGV4X3RvX2JpbihkYXRhWzZdKSAq
IDE2KSB8IGhleF90b19iaW4oZGF0YVs3XSk7Ci0JCWlmIChrZXlzZXRfZmlsZSA8IDApIHsKLQkJ
CWRldl9lcnIod2Rldi0+ZGV2LCAiJXMgY29ycnVwdGVkXG4iLCBmaWxlbmFtZSk7Ci0JCQlyZWxl
YXNlX2Zpcm13YXJlKCpmdyk7Ci0JCQkqZncgPSBOVUxMOwotCQkJcmV0dXJuIC1FSU5WQUw7Ci0J
CX0KLQl9Ci0JaWYgKGtleXNldF9maWxlICE9IGtleXNldF9jaGlwKSB7Ci0JCWRldl9lcnIod2Rl
di0+ZGV2LCAiZmlybXdhcmUga2V5c2V0IGlzIGluY29tcGF0aWJsZSB3aXRoIGNoaXAgKGZpbGU6
IDB4JTAyWCwgY2hpcDogMHglMDJYKVxuIiwKLQkJCWtleXNldF9maWxlLCBrZXlzZXRfY2hpcCk7
Ci0JCXJlbGVhc2VfZmlybXdhcmUoKmZ3KTsKLQkJKmZ3ID0gTlVMTDsKLQkJcmV0dXJuIC1FTk9E
RVY7Ci0JfQotCXdkZXYtPmtleXNldCA9IGtleXNldF9maWxlOwotCXJldHVybiAwOwotfQotCi1z
dGF0aWMgaW50IHdhaXRfbmNwX3N0YXR1cyhzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIHN0YXR1
cykKLXsKLQlrdGltZV90IG5vdywgc3RhcnQ7Ci0JdTMyIHJlZzsKLQlpbnQgcmV0OwotCi0Jc3Rh
cnQgPSBrdGltZV9nZXQoKTsKLQlmb3IgKDs7KSB7Ci0JCXJldCA9IHNyYW1fcmVnX3JlYWQod2Rl
diwgV0ZYX0RDQV9OQ1BfU1RBVFVTLCAmcmVnKTsKLQkJaWYgKHJldCA8IDApCi0JCQlyZXR1cm4g
LUVJTzsKLQkJbm93ID0ga3RpbWVfZ2V0KCk7Ci0JCWlmIChyZWcgPT0gc3RhdHVzKQotCQkJYnJl
YWs7Ci0JCWlmIChrdGltZV9hZnRlcihub3csIGt0aW1lX2FkZF9tcyhzdGFydCwgRENBX1RJTUVP
VVQpKSkKLQkJCXJldHVybiAtRVRJTUVET1VUOwotCX0KLQlpZiAoa3RpbWVfY29tcGFyZShub3cs
IHN0YXJ0KSkKLQkJZGV2X2RiZyh3ZGV2LT5kZXYsICJjaGlwIGFuc3dlciBhZnRlciAlbGxkdXNc
biIsCi0JCQlrdGltZV91c19kZWx0YShub3csIHN0YXJ0KSk7Ci0JZWxzZQotCQlkZXZfZGJnKHdk
ZXYtPmRldiwgImNoaXAgYW5zd2VyIGltbWVkaWF0ZWx5XG4iKTsKLQlyZXR1cm4gMDsKLX0KLQot
c3RhdGljIGludCB1cGxvYWRfZmlybXdhcmUoc3RydWN0IHdmeF9kZXYgKndkZXYsIGNvbnN0IHU4
ICpkYXRhLCBzaXplX3QgbGVuKQotewotCWludCByZXQ7Ci0JdTMyIG9mZnMsIGJ5dGVzX2RvbmUg
PSAwOwotCWt0aW1lX3Qgbm93LCBzdGFydDsKLQotCWlmIChsZW4gJSBETkxEX0JMT0NLX1NJWkUp
IHsKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICJmaXJtd2FyZSBzaXplIGlzIG5vdCBhbGlnbmVkLiBC
dWZmZXIgb3ZlcnJ1biB3aWxsIG9jY3VyXG4iKTsKLQkJcmV0dXJuIC1FSU87Ci0JfQotCW9mZnMg
PSAwOwotCXdoaWxlIChvZmZzIDwgbGVuKSB7Ci0JCXN0YXJ0ID0ga3RpbWVfZ2V0KCk7Ci0JCWZv
ciAoOzspIHsKLQkJCW5vdyA9IGt0aW1lX2dldCgpOwotCQkJaWYgKG9mZnMgKyBETkxEX0JMT0NL
X1NJWkUgLSBieXRlc19kb25lIDwgRE5MRF9GSUZPX1NJWkUpCi0JCQkJYnJlYWs7Ci0JCQlpZiAo
a3RpbWVfYWZ0ZXIobm93LCBrdGltZV9hZGRfbXMoc3RhcnQsIERDQV9USU1FT1VUKSkpCi0JCQkJ
cmV0dXJuIC1FVElNRURPVVQ7Ci0JCQlyZXQgPSBzcmFtX3JlZ19yZWFkKHdkZXYsIFdGWF9EQ0Ff
R0VULCAmYnl0ZXNfZG9uZSk7Ci0JCQlpZiAocmV0IDwgMCkKLQkJCQlyZXR1cm4gcmV0OwotCQl9
Ci0JCWlmIChrdGltZV9jb21wYXJlKG5vdywgc3RhcnQpKQotCQkJZGV2X2RiZyh3ZGV2LT5kZXYs
ICJhbnN3ZXIgYWZ0ZXIgJWxsZHVzXG4iLAotCQkJCWt0aW1lX3VzX2RlbHRhKG5vdywgc3RhcnQp
KTsKLQotCQlyZXQgPSBzcmFtX3dyaXRlX2RtYV9zYWZlKHdkZXYsIFdGWF9ETkxEX0ZJRk8gKwot
CQkJCQkgIChvZmZzICUgRE5MRF9GSUZPX1NJWkUpLAotCQkJCQkgIGRhdGEgKyBvZmZzLCBETkxE
X0JMT0NLX1NJWkUpOwotCQlpZiAocmV0IDwgMCkKLQkJCXJldHVybiByZXQ7Ci0KLQkJLyogVGhl
IGRldmljZSBzZWVtcyB0byBub3Qgc3VwcG9ydCB3cml0aW5nIDAgaW4gdGhpcyByZWdpc3Rlcgot
CQkgKiBkdXJpbmcgZmlyc3QgbG9vcAotCQkgKi8KLQkJb2ZmcyArPSBETkxEX0JMT0NLX1NJWkU7
Ci0JCXJldCA9IHNyYW1fcmVnX3dyaXRlKHdkZXYsIFdGWF9EQ0FfUFVULCBvZmZzKTsKLQkJaWYg
KHJldCA8IDApCi0JCQlyZXR1cm4gcmV0OwotCX0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZv
aWQgcHJpbnRfYm9vdF9zdGF0dXMoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JdTMyIHJlZzsK
LQotCXNyYW1fcmVnX3JlYWQod2RldiwgV0ZYX1NUQVRVU19JTkZPLCAmcmVnKTsKLQlpZiAocmVn
ID09IDB4MTIzNDU2NzgpCi0JCXJldHVybjsKLQlzcmFtX3JlZ19yZWFkKHdkZXYsIFdGWF9FUlJf
SU5GTywgJnJlZyk7Ci0JaWYgKHJlZyA8IEFSUkFZX1NJWkUoZndpb19lcnJvcnMpICYmIGZ3aW9f
ZXJyb3JzW3JlZ10pCi0JCWRldl9pbmZvKHdkZXYtPmRldiwgInNlY3VyZSBib290OiAlc1xuIiwg
Zndpb19lcnJvcnNbcmVnXSk7Ci0JZWxzZQotCQlkZXZfaW5mbyh3ZGV2LT5kZXYsICJzZWN1cmUg
Ym9vdDogRXJyb3IgJSMwMnhcbiIsIHJlZyk7Ci19Ci0KLXN0YXRpYyBpbnQgbG9hZF9maXJtd2Fy
ZV9zZWN1cmUoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JY29uc3Qgc3RydWN0IGZpcm13YXJl
ICpmdyA9IE5VTEw7Ci0JaW50IGhlYWRlcl9zaXplOwotCWludCBmd19vZmZzZXQ7Ci0Ja3RpbWVf
dCBzdGFydDsKLQl1OCAqYnVmOwotCWludCByZXQ7Ci0KLQlCVUlMRF9CVUdfT04oUFRFX0lORk9f
U0laRSA+IEJPT1RMT0FERVJfTEFCRUxfU0laRSk7Ci0JYnVmID0ga21hbGxvYyhCT09UTE9BREVS
X0xBQkVMX1NJWkUgKyAxLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWJ1ZikKLQkJcmV0dXJuIC1FTk9N
RU07Ci0KLQlzcmFtX3JlZ193cml0ZSh3ZGV2LCBXRlhfRENBX0hPU1RfU1RBVFVTLCBIT1NUX1JF
QURZKTsKLQlyZXQgPSB3YWl0X25jcF9zdGF0dXMod2RldiwgTkNQX0lORk9fUkVBRFkpOwotCWlm
IChyZXQpCi0JCWdvdG8gZXJyb3I7Ci0KLQlzcmFtX2J1Zl9yZWFkKHdkZXYsIFdGWF9CT09UTE9B
REVSX0xBQkVMLCBidWYsIEJPT1RMT0FERVJfTEFCRUxfU0laRSk7Ci0JYnVmW0JPT1RMT0FERVJf
TEFCRUxfU0laRV0gPSAwOwotCWRldl9kYmcod2Rldi0+ZGV2LCAiYm9vdGxvYWRlcjogXCIlc1wi
XG4iLCBidWYpOwotCi0Jc3JhbV9idWZfcmVhZCh3ZGV2LCBXRlhfUFRFX0lORk8sIGJ1ZiwgUFRF
X0lORk9fU0laRSk7Ci0JcmV0ID0gZ2V0X2Zpcm13YXJlKHdkZXYsIGJ1ZltQVEVfSU5GT19LRVlT
RVRfSURYXSwgJmZ3LCAmZndfb2Zmc2V0KTsKLQlpZiAocmV0KQotCQlnb3RvIGVycm9yOwotCWhl
YWRlcl9zaXplID0gZndfb2Zmc2V0ICsgRldfU0lHTkFUVVJFX1NJWkUgKyBGV19IQVNIX1NJWkU7
Ci0KLQlzcmFtX3JlZ193cml0ZSh3ZGV2LCBXRlhfRENBX0hPU1RfU1RBVFVTLCBIT1NUX0lORk9f
UkVBRCk7Ci0JcmV0ID0gd2FpdF9uY3Bfc3RhdHVzKHdkZXYsIE5DUF9SRUFEWSk7Ci0JaWYgKHJl
dCkKLQkJZ290byBlcnJvcjsKLQotCXNyYW1fcmVnX3dyaXRlKHdkZXYsIFdGWF9ETkxEX0ZJRk8s
IDB4RkZGRkZGRkYpOyAvKiBGaWZvIGluaXQgKi8KLQlzcmFtX3dyaXRlX2RtYV9zYWZlKHdkZXYs
IFdGWF9EQ0FfRldfVkVSU0lPTiwgIlx4MDFceDAwXHgwMFx4MDAiLAotCQkJICAgIEZXX1ZFUlNJ
T05fU0laRSk7Ci0Jc3JhbV93cml0ZV9kbWFfc2FmZSh3ZGV2LCBXRlhfRENBX0ZXX1NJR05BVFVS
RSwgZnctPmRhdGEgKyBmd19vZmZzZXQsCi0JCQkgICAgRldfU0lHTkFUVVJFX1NJWkUpOwotCXNy
YW1fd3JpdGVfZG1hX3NhZmUod2RldiwgV0ZYX0RDQV9GV19IQVNILAotCQkJICAgIGZ3LT5kYXRh
ICsgZndfb2Zmc2V0ICsgRldfU0lHTkFUVVJFX1NJWkUsCi0JCQkgICAgRldfSEFTSF9TSVpFKTsK
LQlzcmFtX3JlZ193cml0ZSh3ZGV2LCBXRlhfRENBX0lNQUdFX1NJWkUsIGZ3LT5zaXplIC0gaGVh
ZGVyX3NpemUpOwotCXNyYW1fcmVnX3dyaXRlKHdkZXYsIFdGWF9EQ0FfSE9TVF9TVEFUVVMsIEhP
U1RfVVBMT0FEX1BFTkRJTkcpOwotCXJldCA9IHdhaXRfbmNwX3N0YXR1cyh3ZGV2LCBOQ1BfRE9X
TkxPQURfUEVORElORyk7Ci0JaWYgKHJldCkKLQkJZ290byBlcnJvcjsKLQotCXN0YXJ0ID0ga3Rp
bWVfZ2V0KCk7Ci0JcmV0ID0gdXBsb2FkX2Zpcm13YXJlKHdkZXYsIGZ3LT5kYXRhICsgaGVhZGVy
X3NpemUsCi0JCQkgICAgICBmdy0+c2l6ZSAtIGhlYWRlcl9zaXplKTsKLQlpZiAocmV0KQotCQln
b3RvIGVycm9yOwotCWRldl9kYmcod2Rldi0+ZGV2LCAiZmlybXdhcmUgbG9hZCBhZnRlciAlbGxk
dXNcbiIsCi0JCWt0aW1lX3VzX2RlbHRhKGt0aW1lX2dldCgpLCBzdGFydCkpOwotCi0Jc3JhbV9y
ZWdfd3JpdGUod2RldiwgV0ZYX0RDQV9IT1NUX1NUQVRVUywgSE9TVF9VUExPQURfQ09NUExFVEUp
OwotCXJldCA9IHdhaXRfbmNwX3N0YXR1cyh3ZGV2LCBOQ1BfQVVUSF9PSyk7Ci0JLyogTGVnYWN5
IFJPTSBzdXBwb3J0ICovCi0JaWYgKHJldCA8IDApCi0JCXJldCA9IHdhaXRfbmNwX3N0YXR1cyh3
ZGV2LCBOQ1BfUFVCX0tFWV9SRFkpOwotCWlmIChyZXQgPCAwKQotCQlnb3RvIGVycm9yOwotCXNy
YW1fcmVnX3dyaXRlKHdkZXYsIFdGWF9EQ0FfSE9TVF9TVEFUVVMsIEhPU1RfT0tfVE9fSlVNUCk7
Ci0KLWVycm9yOgotCWtmcmVlKGJ1Zik7Ci0JaWYgKGZ3KQotCQlyZWxlYXNlX2Zpcm13YXJlKGZ3
KTsKLQlpZiAocmV0KQotCQlwcmludF9ib290X3N0YXR1cyh3ZGV2KTsKLQlyZXR1cm4gcmV0Owot
fQotCi1zdGF0aWMgaW50IGluaXRfZ3ByKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KQotewotCWludCBy
ZXQsIGk7Ci0Jc3RhdGljIGNvbnN0IHN0cnVjdCB7Ci0JCWludCBpbmRleDsKLQkJdTMyIHZhbHVl
OwotCX0gZ3ByX2luaXRbXSA9IHsKLQkJeyAweDA3LCAweDIwODc3NSB9LAotCQl7IDB4MDgsIDB4
MkVDMDIwIH0sCi0JCXsgMHgwOSwgMHgzQzNDM0MgfSwKLQkJeyAweDBCLCAweDMyMkM0NCB9LAot
CQl7IDB4MEMsIDB4QTA2NDk3IH0sCi0JfTsKLQotCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpF
KGdwcl9pbml0KTsgaSsrKSB7Ci0JCXJldCA9IGlncHJfcmVnX3dyaXRlKHdkZXYsIGdwcl9pbml0
W2ldLmluZGV4LAotCQkJCSAgICAgZ3ByX2luaXRbaV0udmFsdWUpOwotCQlpZiAocmV0IDwgMCkK
LQkJCXJldHVybiByZXQ7Ci0JCWRldl9kYmcod2Rldi0+ZGV2LCAiICBpbmRleCAlMDJ4OiAlMDh4
XG4iLAotCQkJZ3ByX2luaXRbaV0uaW5kZXgsIGdwcl9pbml0W2ldLnZhbHVlKTsKLQl9Ci0JcmV0
dXJuIDA7Ci19Ci0KLWludCB3ZnhfaW5pdF9kZXZpY2Uoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17
Ci0JaW50IHJldDsKLQlpbnQgaHdfcmV2aXNpb24sIGh3X3R5cGU7Ci0JaW50IHdha2V1cF90aW1l
b3V0ID0gNTA7IC8qIG1zICovCi0Ja3RpbWVfdCBub3csIHN0YXJ0OwotCXUzMiByZWc7Ci0KLQly
ZWcgPSBDRkdfRElSRUNUX0FDQ0VTU19NT0RFIHwgQ0ZHX0NQVV9SRVNFVCB8IENGR19CWVRFX09S
REVSX0FCQ0Q7Ci0JaWYgKHdkZXYtPnBkYXRhLnVzZV9yaXNpbmdfY2xrKQotCQlyZWcgfD0gQ0ZH
X0NMS19SSVNFX0VER0U7Ci0JcmV0ID0gY29uZmlnX3JlZ193cml0ZSh3ZGV2LCByZWcpOwotCWlm
IChyZXQgPCAwKSB7Ci0JCWRldl9lcnIod2Rldi0+ZGV2LCAiYnVzIHJldHVybmVkIGFuIGVycm9y
IGR1cmluZyBmaXJzdCB3cml0ZSBhY2Nlc3MuIEhvc3QgY29uZmlndXJhdGlvbiBlcnJvcj9cbiIp
OwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0KLQlyZXQgPSBjb25maWdfcmVnX3JlYWQod2RldiwgJnJl
Zyk7Ci0JaWYgKHJldCA8IDApIHsKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICJidXMgcmV0dXJuZWQg
YW4gZXJyb3IgZHVyaW5nIGZpcnN0IHJlYWQgYWNjZXNzLiBCdXMgY29uZmlndXJhdGlvbiBlcnJv
cj9cbiIpOwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0JaWYgKHJlZyA9PSAwIHx8IHJlZyA9PSB+MCkg
ewotCQlkZXZfZXJyKHdkZXYtPmRldiwgImNoaXAgbXV0ZS4gQnVzIGNvbmZpZ3VyYXRpb24gZXJy
b3Igb3IgY2hpcCB3YXNuJ3QgcmVzZXQ/XG4iKTsKLQkJcmV0dXJuIC1FSU87Ci0JfQotCWRldl9k
Ymcod2Rldi0+ZGV2LCAiaW5pdGlhbCBjb25maWcgcmVnaXN0ZXIgdmFsdWU6ICUwOHhcbiIsIHJl
Zyk7Ci0KLQlod19yZXZpc2lvbiA9IEZJRUxEX0dFVChDRkdfREVWSUNFX0lEX01BSk9SLCByZWcp
OwotCWlmIChod19yZXZpc2lvbiA9PSAwKSB7Ci0JCWRldl9lcnIod2Rldi0+ZGV2LCAiYmFkIGhh
cmR3YXJlIHJldmlzaW9uIG51bWJlcjogJWRcbiIsCi0JCQlod19yZXZpc2lvbik7Ci0JCXJldHVy
biAtRU5PREVWOwotCX0KLQlod190eXBlID0gRklFTERfR0VUKENGR19ERVZJQ0VfSURfVFlQRSwg
cmVnKTsKLQlpZiAoaHdfdHlwZSA9PSAxKSB7Ci0JCWRldl9ub3RpY2Uod2Rldi0+ZGV2LCAiZGV2
ZWxvcG1lbnQgaGFyZHdhcmUgZGV0ZWN0ZWRcbiIpOwotCQl3YWtldXBfdGltZW91dCA9IDIwMDA7
Ci0JfQotCi0JcmV0ID0gaW5pdF9ncHIod2Rldik7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiBy
ZXQ7Ci0KLQlyZXQgPSBjb250cm9sX3JlZ193cml0ZSh3ZGV2LCBDVFJMX1dMQU5fV0FLRVVQKTsK
LQlpZiAocmV0IDwgMCkKLQkJcmV0dXJuIC1FSU87Ci0Jc3RhcnQgPSBrdGltZV9nZXQoKTsKLQlm
b3IgKDs7KSB7Ci0JCXJldCA9IGNvbnRyb2xfcmVnX3JlYWQod2RldiwgJnJlZyk7Ci0JCW5vdyA9
IGt0aW1lX2dldCgpOwotCQlpZiAocmVnICYgQ1RSTF9XTEFOX1JFQURZKQotCQkJYnJlYWs7Ci0J
CWlmIChrdGltZV9hZnRlcihub3csIGt0aW1lX2FkZF9tcyhzdGFydCwgd2FrZXVwX3RpbWVvdXQp
KSkgewotCQkJZGV2X2Vycih3ZGV2LT5kZXYsICJjaGlwIGRpZG4ndCB3YWtlIHVwLiBDaGlwIHdh
c24ndCByZXNldD9cbiIpOwotCQkJcmV0dXJuIC1FVElNRURPVVQ7Ci0JCX0KLQl9Ci0JZGV2X2Ri
Zyh3ZGV2LT5kZXYsICJjaGlwIHdha2UgdXAgYWZ0ZXIgJWxsZHVzXG4iLAotCQlrdGltZV91c19k
ZWx0YShub3csIHN0YXJ0KSk7Ci0KLQlyZXQgPSBjb25maWdfcmVnX3dyaXRlX2JpdHMod2Rldiwg
Q0ZHX0NQVV9SRVNFVCwgMCk7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiByZXQ7Ci0JcmV0ID0g
bG9hZF9maXJtd2FyZV9zZWN1cmUod2Rldik7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiByZXQ7
Ci0JcmV0dXJuIGNvbmZpZ19yZWdfd3JpdGVfYml0cyh3ZGV2LAotCQkJCSAgICAgQ0ZHX0RJUkVD
VF9BQ0NFU1NfTU9ERSB8Ci0JCQkJICAgICBDRkdfSVJRX0VOQUJMRV9EQVRBIHwKLQkJCQkgICAg
IENGR19JUlFfRU5BQkxFX1dSRFksCi0JCQkJICAgICBDRkdfSVJRX0VOQUJMRV9EQVRBKTsKLX0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvZndpby5oIGIvZHJpdmVycy9zdGFnaW5n
L3dmeC9md2lvLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGVlZWE2MTIxMGVjYS4u
MDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvZndpby5oCisrKyAvZGV2L251
bGwKQEAgLTEsMTUgKzAsMCBAQAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seSAqLwotLyoKLSAqIEZpcm13YXJlIGxvYWRpbmcuCi0gKgotICogQ29weXJpZ2h0IChjKSAy
MDE3LTIwMTksIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MTAsIFNULUVyaWNzc29uCi0gKi8KLSNpZm5kZWYgV0ZYX0ZXSU9fSAotI2RlZmluZSBXRlhfRldJ
T19ICi0KLXN0cnVjdCB3ZnhfZGV2OwotCi1pbnQgd2Z4X2luaXRfZGV2aWNlKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2KTsKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hp
Zl9hcGlfY21kLmggYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl9hcGlfY21kLmgKZGVsZXRlZCBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IGIwYWExM2IyM2E1MS4uMDAwMDAwMDAwMDAwCi0tLSBhL2Ry
aXZlcnMvc3RhZ2luZy93ZngvaGlmX2FwaV9jbWQuaAorKysgL2Rldi9udWxsCkBAIC0xLDU1NSAr
MCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMCAqLwotLyoKLSAq
IFdGMjAwIGhhcmR3YXJlIGludGVyZmFjZSBkZWZpbml0aW9ucwotICoKLSAqIENvcHlyaWdodCAo
YykgMjAxOC0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcyBJbmMuCi0gKi8KLQotI2lmbmRlZiBX
RlhfSElGX0FQSV9DTURfSAotI2RlZmluZSBXRlhfSElGX0FQSV9DTURfSAotCi0jaW5jbHVkZSA8
bGludXgvaWVlZTgwMjExLmg+Ci0KLSNpbmNsdWRlICJoaWZfYXBpX2dlbmVyYWwuaCIKLQotZW51
bSBoaWZfcmVxdWVzdHNfaWRzIHsKLQlISUZfUkVRX0lEX1JFU0VUICAgICAgICAgICAgICAgID0g
MHgwYSwKLQlISUZfUkVRX0lEX1JFQURfTUlCICAgICAgICAgICAgID0gMHgwNSwKLQlISUZfUkVR
X0lEX1dSSVRFX01JQiAgICAgICAgICAgID0gMHgwNiwKLQlISUZfUkVRX0lEX1NUQVJUX1NDQU4g
ICAgICAgICAgID0gMHgwNywKLQlISUZfUkVRX0lEX1NUT1BfU0NBTiAgICAgICAgICAgID0gMHgw
OCwKLQlISUZfUkVRX0lEX1RYICAgICAgICAgICAgICAgICAgID0gMHgwNCwKLQlISUZfUkVRX0lE
X0pPSU4gICAgICAgICAgICAgICAgID0gMHgwYiwKLQlISUZfUkVRX0lEX1NFVF9QTV9NT0RFICAg
ICAgICAgID0gMHgxMCwKLQlISUZfUkVRX0lEX1NFVF9CU1NfUEFSQU1TICAgICAgID0gMHgxMSwK
LQlISUZfUkVRX0lEX0FERF9LRVkgICAgICAgICAgICAgID0gMHgwYywKLQlISUZfUkVRX0lEX1JF
TU9WRV9LRVkgICAgICAgICAgID0gMHgwZCwKLQlISUZfUkVRX0lEX0VEQ0FfUVVFVUVfUEFSQU1T
ICAgID0gMHgxMywKLQlISUZfUkVRX0lEX1NUQVJUICAgICAgICAgICAgICAgID0gMHgxNywKLQlI
SUZfUkVRX0lEX0JFQUNPTl9UUkFOU01JVCAgICAgID0gMHgxOCwKLQlISUZfUkVRX0lEX1VQREFU
RV9JRSAgICAgICAgICAgID0gMHgxYiwKLQlISUZfUkVRX0lEX01BUF9MSU5LICAgICAgICAgICAg
ID0gMHgxYywKLX07Ci0KLWVudW0gaGlmX2NvbmZpcm1hdGlvbnNfaWRzIHsKLQlISUZfQ05GX0lE
X1JFU0VUICAgICAgICAgICAgICAgID0gMHgwYSwKLQlISUZfQ05GX0lEX1JFQURfTUlCICAgICAg
ICAgICAgID0gMHgwNSwKLQlISUZfQ05GX0lEX1dSSVRFX01JQiAgICAgICAgICAgID0gMHgwNiwK
LQlISUZfQ05GX0lEX1NUQVJUX1NDQU4gICAgICAgICAgID0gMHgwNywKLQlISUZfQ05GX0lEX1NU
T1BfU0NBTiAgICAgICAgICAgID0gMHgwOCwKLQlISUZfQ05GX0lEX1RYICAgICAgICAgICAgICAg
ICAgID0gMHgwNCwKLQlISUZfQ05GX0lEX01VTFRJX1RSQU5TTUlUICAgICAgID0gMHgxZSwKLQlI
SUZfQ05GX0lEX0pPSU4gICAgICAgICAgICAgICAgID0gMHgwYiwKLQlISUZfQ05GX0lEX1NFVF9Q
TV9NT0RFICAgICAgICAgID0gMHgxMCwKLQlISUZfQ05GX0lEX1NFVF9CU1NfUEFSQU1TICAgICAg
ID0gMHgxMSwKLQlISUZfQ05GX0lEX0FERF9LRVkgICAgICAgICAgICAgID0gMHgwYywKLQlISUZf
Q05GX0lEX1JFTU9WRV9LRVkgICAgICAgICAgID0gMHgwZCwKLQlISUZfQ05GX0lEX0VEQ0FfUVVF
VUVfUEFSQU1TICAgID0gMHgxMywKLQlISUZfQ05GX0lEX1NUQVJUICAgICAgICAgICAgICAgID0g
MHgxNywKLQlISUZfQ05GX0lEX0JFQUNPTl9UUkFOU01JVCAgICAgID0gMHgxOCwKLQlISUZfQ05G
X0lEX1VQREFURV9JRSAgICAgICAgICAgID0gMHgxYiwKLQlISUZfQ05GX0lEX01BUF9MSU5LICAg
ICAgICAgICAgID0gMHgxYywKLX07Ci0KLWVudW0gaGlmX2luZGljYXRpb25zX2lkcyB7Ci0JSElG
X0lORF9JRF9SWCAgICAgICAgICAgICAgICAgICA9IDB4ODQsCi0JSElGX0lORF9JRF9TQ0FOX0NN
UEwgICAgICAgICAgICA9IDB4ODYsCi0JSElGX0lORF9JRF9KT0lOX0NPTVBMRVRFICAgICAgICA9
IDB4OGYsCi0JSElGX0lORF9JRF9TRVRfUE1fTU9ERV9DTVBMICAgICA9IDB4ODksCi0JSElGX0lO
RF9JRF9TVVNQRU5EX1JFU1VNRV9UWCAgICA9IDB4OGMsCi0JSElGX0lORF9JRF9FVkVOVCAgICAg
ICAgICAgICAgICA9IDB4ODUKLX07Ci0KLXN0cnVjdCBoaWZfcmVxX3Jlc2V0IHsKLQl1OCAgICAg
cmVzZXRfc3RhdDoxOwotCXU4ICAgICByZXNldF9hbGxfaW50OjE7Ci0JdTggICAgIHJlc2VydmVk
MTo2OwotCXU4ICAgICByZXNlcnZlZDJbM107Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2Nu
Zl9yZXNldCB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfcmVx
X3JlYWRfbWliIHsKLQlfX2xlMTYgbWliX2lkOwotCV9fbGUxNiByZXNlcnZlZDsKLX0gX19wYWNr
ZWQ7Ci0KLXN0cnVjdCBoaWZfY25mX3JlYWRfbWliIHsKLQlfX2xlMzIgc3RhdHVzOwotCV9fbGUx
NiBtaWJfaWQ7Ci0JX19sZTE2IGxlbmd0aDsKLQl1OCAgICAgbWliX2RhdGFbXTsKLX0gX19wYWNr
ZWQ7Ci0KLXN0cnVjdCBoaWZfcmVxX3dyaXRlX21pYiB7Ci0JX19sZTE2IG1pYl9pZDsKLQlfX2xl
MTYgbGVuZ3RoOwotCXU4ICAgICBtaWJfZGF0YVtdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhp
Zl9jbmZfd3JpdGVfbWliIHsKLQlfX2xlMzIgc3RhdHVzOwotfSBfX3BhY2tlZDsKLQotc3RydWN0
IGhpZl9yZXFfdXBkYXRlX2llIHsKLQl1OCAgICAgYmVhY29uOjE7Ci0JdTggICAgIHByb2JlX3Jl
c3A6MTsKLQl1OCAgICAgcHJvYmVfcmVxOjE7Ci0JdTggICAgIHJlc2VydmVkMTo1OwotCXU4ICAg
ICByZXNlcnZlZDI7Ci0JX19sZTE2IG51bV9pZXM7Ci0JdTggICAgIGllW107Ci19IF9fcGFja2Vk
OwotCi1zdHJ1Y3QgaGlmX2NuZl91cGRhdGVfaWUgewotCV9fbGUzMiBzdGF0dXM7Ci19IF9fcGFj
a2VkOwotCi1zdHJ1Y3QgaGlmX3NzaWRfZGVmIHsKLQlfX2xlMzIgc3NpZF9sZW5ndGg7Ci0JdTgg
ICAgIHNzaWRbSUVFRTgwMjExX01BWF9TU0lEX0xFTl07Ci19IF9fcGFja2VkOwotCi0jZGVmaW5l
IEhJRl9BUElfTUFYX05CX1NTSURTICAgICAgICAgICAgICAgICAgICAgICAgICAgMgotI2RlZmlu
ZSBISUZfQVBJX01BWF9OQl9DSEFOTkVMUyAgICAgICAgICAgICAgICAgICAgICAgMTQKLQotc3Ry
dWN0IGhpZl9yZXFfc3RhcnRfc2Nhbl9hbHQgewotCXU4ICAgICBiYW5kOwotCXU4ICAgICBtYWlu
dGFpbl9jdXJyZW50X2JzczoxOwotCXU4ICAgICBwZXJpb2RpYzoxOwotCXU4ICAgICByZXNlcnZl
ZDE6NjsKLQl1OCAgICAgZGlzYWxsb3dfcHM6MTsKLQl1OCAgICAgcmVzZXJ2ZWQyOjE7Ci0JdTgg
ICAgIHNob3J0X3ByZWFtYmxlOjE7Ci0JdTggICAgIHJlc2VydmVkMzo1OwotCXU4ICAgICBtYXhf
dHJhbnNtaXRfcmF0ZTsKLQlfX2xlMTYgcGVyaW9kaWNfaW50ZXJ2YWw7Ci0JdTggICAgIHJlc2Vy
dmVkNDsKLQlzOCAgICAgcGVyaW9kaWNfcnNzaV90aHI7Ci0JdTggICAgIG51bV9vZl9wcm9iZV9y
ZXF1ZXN0czsKLQl1OCAgICAgcHJvYmVfZGVsYXk7Ci0JdTggICAgIG51bV9vZl9zc2lkczsKLQl1
OCAgICAgbnVtX29mX2NoYW5uZWxzOwotCV9fbGUzMiBtaW5fY2hhbm5lbF90aW1lOwotCV9fbGUz
MiBtYXhfY2hhbm5lbF90aW1lOwotCV9fbGUzMiB0eF9wb3dlcl9sZXZlbDsgLyogc2lnbmVkIHZh
bHVlICovCi0Jc3RydWN0IGhpZl9zc2lkX2RlZiBzc2lkX2RlZltISUZfQVBJX01BWF9OQl9TU0lE
U107Ci0JdTggICAgIGNoYW5uZWxfbGlzdFtdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9j
bmZfc3RhcnRfc2NhbiB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBo
aWZfY25mX3N0b3Bfc2NhbiB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLWVudW0g
aGlmX3BtX21vZGVfc3RhdHVzIHsKLQlISUZfUE1fTU9ERV9BQ1RJVkUgICAgICAgICAgICAgICAg
ICAgICAgICAgPSAweDAsCi0JSElGX1BNX01PREVfUFMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgID0gMHgxLAotCUhJRl9QTV9NT0RFX1VOREVURVJNSU5FRCAgICAgICAgICAgICAgICAgICA9
IDB4MgotfTsKLQotc3RydWN0IGhpZl9pbmRfc2Nhbl9jbXBsIHsKLQlfX2xlMzIgc3RhdHVzOwot
CXU4ICAgICBwbV9tb2RlOwotCXU4ICAgICBudW1fY2hhbm5lbHNfY29tcGxldGVkOwotCV9fbGUx
NiByZXNlcnZlZDsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX3F1ZXVlX2lkIHsKLQlISUZfUVVF
VUVfSURfQkFDS0dST1VORCAgICAgICAgICAgICAgICAgICAgPSAweDAsCi0JSElGX1FVRVVFX0lE
X0JFU1RFRkZPUlQgICAgICAgICAgICAgICAgICAgID0gMHgxLAotCUhJRl9RVUVVRV9JRF9WSURF
TyAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MiwKLQlISUZfUVVFVUVfSURfVk9JQ0UgICAg
ICAgICAgICAgICAgICAgICAgICAgPSAweDMKLX07Ci0KLWVudW0gaGlmX2ZyYW1lX2Zvcm1hdCB7
Ci0JSElGX0ZSQU1FX0ZPUk1BVF9OT05fSFQgICAgICAgICAgICAgICAgICAgID0gMHgwLAotCUhJ
Rl9GUkFNRV9GT1JNQVRfTUlYRURfRk9STUFUX0hUICAgICAgICAgICA9IDB4MSwKLQlISUZfRlJB
TUVfRk9STUFUX0dGX0hUXzExTiAgICAgICAgICAgICAgICAgPSAweDIKLX07Ci0KLXN0cnVjdCBo
aWZfcmVxX3R4IHsKLQkvKiBwYWNrZXRfaWQgaXMgbm90IGludGVycHJldGVkIGJ5IHRoZSBkZXZp
Y2UsIHNvIGl0IGlzIG5vdCBuZWNlc3NhcnkgdG8KLQkgKiBkZWNsYXJlIGl0IGxpdHRsZSBlbmRp
YW4KLQkgKi8KLQl1MzIgICAgcGFja2V0X2lkOwotCXU4ICAgICBtYXhfdHhfcmF0ZTsKLQl1OCAg
ICAgcXVldWVfaWQ6MjsKLQl1OCAgICAgcGVlcl9zdGFfaWQ6NDsKLQl1OCAgICAgcmVzZXJ2ZWQx
OjI7Ci0JdTggICAgIG1vcmU6MTsKLQl1OCAgICAgZmNfb2Zmc2V0OjM7Ci0JdTggICAgIGFmdGVy
X2R0aW06MTsKLQl1OCAgICAgcmVzZXJ2ZWQyOjM7Ci0JdTggICAgIHN0YXJ0X2V4cDoxOwotCXU4
ICAgICByZXNlcnZlZDM6MzsKLQl1OCAgICAgcmV0cnlfcG9saWN5X2luZGV4OjQ7Ci0JX19sZTMy
IHJlc2VydmVkNDsKLQlfX2xlMzIgZXhwaXJlX3RpbWU7Ci0JdTggICAgIGZyYW1lX2Zvcm1hdDo0
OwotCXU4ICAgICBmZWNfY29kaW5nOjE7Ci0JdTggICAgIHNob3J0X2dpOjE7Ci0JdTggICAgIHJl
c2VydmVkNToxOwotCXU4ICAgICBzdGJjOjE7Ci0JdTggICAgIHJlc2VydmVkNjsKLQl1OCAgICAg
YWdncmVnYXRpb246MTsKLQl1OCAgICAgcmVzZXJ2ZWQ3Ojc7Ci0JdTggICAgIHJlc2VydmVkODsK
LQl1OCAgICAgZnJhbWVbXTsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX3Fvc19hY2twbGN5IHsK
LQlISUZfUU9TX0FDS1BMQ1lfTk9STUFMICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgwLAot
CUhJRl9RT1NfQUNLUExDWV9UWE5PQUNLICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEsCi0J
SElGX1FPU19BQ0tQTENZX05PRVhQQUNLICAgICAgICAgICAgICAgICAgICAgICA9IDB4MiwKLQlI
SUZfUU9TX0FDS1BMQ1lfQkxDS0FDSyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzCi19Owot
Ci1zdHJ1Y3QgaGlmX2NuZl90eCB7Ci0JX19sZTMyIHN0YXR1czsKLQkvKiBwYWNrZXRfaWQgaXMg
Y29waWVkIGZyb20gc3RydWN0IGhpZl9yZXFfdHggd2l0aG91dCBiZWVuIGludGVycHJldGVkCi0J
ICogYnkgdGhlIGRldmljZSwgc28gaXQgaXMgbm90IG5lY2Vzc2FyeSB0byBkZWNsYXJlIGl0IGxp
dHRsZSBlbmRpYW4KLQkgKi8KLQl1MzIgICAgcGFja2V0X2lkOwotCXU4ICAgICB0eGVkX3JhdGU7
Ci0JdTggICAgIGFja19mYWlsdXJlczsKLQl1OCAgICAgYWdncjoxOwotCXU4ICAgICByZXF1ZXVl
OjE7Ci0JdTggICAgIGFja19wb2xpY3k6MjsKLQl1OCAgICAgdHhvcF9saW1pdDoxOwotCXU4ICAg
ICByZXNlcnZlZDE6MzsKLQl1OCAgICAgcmVzZXJ2ZWQyOwotCV9fbGUzMiBtZWRpYV9kZWxheTsK
LQlfX2xlMzIgdHhfcXVldWVfZGVsYXk7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2NuZl9t
dWx0aV90cmFuc21pdCB7Ci0JdTggICAgIG51bV90eF9jb25mczsKLQl1OCAgICAgcmVzZXJ2ZWRb
M107Ci0Jc3RydWN0IGhpZl9jbmZfdHggdHhfY29uZl9wYXlsb2FkW107Ci19IF9fcGFja2VkOwot
Ci1lbnVtIGhpZl9yaV9mbGFnc19lbmNyeXB0IHsKLQlISUZfUklfRkxBR1NfVU5FTkNSWVBURUQg
ICAgICAgICAgICAgICAgICAgPSAweDAsCi0JSElGX1JJX0ZMQUdTX1dFUF9FTkNSWVBURUQgICAg
ICAgICAgICAgICAgID0gMHgxLAotCUhJRl9SSV9GTEFHU19US0lQX0VOQ1JZUFRFRCAgICAgICAg
ICAgICAgICA9IDB4MiwKLQlISUZfUklfRkxBR1NfQUVTX0VOQ1JZUFRFRCAgICAgICAgICAgICAg
ICAgPSAweDMsCi0JSElGX1JJX0ZMQUdTX1dBUElfRU5DUllQVEVEICAgICAgICAgICAgICAgID0g
MHg0Ci19OwotCi1zdHJ1Y3QgaGlmX2luZF9yeCB7Ci0JX19sZTMyIHN0YXR1czsKLQl1OCAgICAg
Y2hhbm5lbF9udW1iZXI7Ci0JdTggICAgIHJlc2VydmVkMTsKLQl1OCAgICAgcnhlZF9yYXRlOwot
CXU4ICAgICByY3BpX3Jzc2k7Ci0JdTggICAgIGVuY3J5cDozOwotCXU4ICAgICBpbl9hZ2dyOjE7
Ci0JdTggICAgIGZpcnN0X2FnZ3I6MTsKLQl1OCAgICAgbGFzdF9hZ2dyOjE7Ci0JdTggICAgIGRl
ZnJhZzoxOwotCXU4ICAgICBiZWFjb246MTsKLQl1OCAgICAgdGltOjE7Ci0JdTggICAgIGJpdG1h
cDoxOwotCXU4ICAgICBtYXRjaF9zc2lkOjE7Ci0JdTggICAgIG1hdGNoX2Jzc2lkOjE7Ci0JdTgg
ICAgIG1vcmU6MTsKLQl1OCAgICAgcmVzZXJ2ZWQyOjE7Ci0JdTggICAgIGh0OjE7Ci0JdTggICAg
IHN0YmM6MTsKLQl1OCAgICAgbWF0Y2hfdWNfYWRkcjoxOwotCXU4ICAgICBtYXRjaF9tY19hZGRy
OjE7Ci0JdTggICAgIG1hdGNoX2JjX2FkZHI6MTsKLQl1OCAgICAga2V5X3R5cGU6MTsKLQl1OCAg
ICAga2V5X2luZGV4OjQ7Ci0JdTggICAgIHJlc2VydmVkMzoxOwotCXU4ICAgICBwZWVyX3N0YV9p
ZDo0OwotCXU4ICAgICByZXNlcnZlZDQ6MjsKLQl1OCAgICAgcmVzZXJ2ZWQ1OjE7Ci0JdTggICAg
IGZyYW1lW107Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX3JlcV9lZGNhX3F1ZXVlX3BhcmFt
cyB7Ci0JdTggICAgIHF1ZXVlX2lkOwotCXU4ICAgICByZXNlcnZlZDE7Ci0JdTggICAgIGFpZnNu
OwotCXU4ICAgICByZXNlcnZlZDI7Ci0JX19sZTE2IGN3X21pbjsKLQlfX2xlMTYgY3dfbWF4Owot
CV9fbGUxNiB0eF9vcF9saW1pdDsKLQlfX2xlMTYgYWxsb3dlZF9tZWRpdW1fdGltZTsKLQlfX2xl
MzIgcmVzZXJ2ZWQzOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9jbmZfZWRjYV9xdWV1ZV9w
YXJhbXMgewotCV9fbGUzMiBzdGF0dXM7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX3JlcV9q
b2luIHsKLQl1OCAgICAgaW5mcmFzdHJ1Y3R1cmVfYnNzX21vZGU6MTsKLQl1OCAgICAgcmVzZXJ2
ZWQxOjc7Ci0JdTggICAgIGJhbmQ7Ci0JdTggICAgIGNoYW5uZWxfbnVtYmVyOwotCXU4ICAgICBy
ZXNlcnZlZDI7Ci0JdTggICAgIGJzc2lkW0VUSF9BTEVOXTsKLQlfX2xlMTYgYXRpbV93aW5kb3c7
Ci0JdTggICAgIHNob3J0X3ByZWFtYmxlOjE7Ci0JdTggICAgIHJlc2VydmVkMzo3OwotCXU4ICAg
ICBwcm9iZV9mb3Jfam9pbjsKLQl1OCAgICAgcmVzZXJ2ZWQ0OwotCXU4ICAgICByZXNlcnZlZDU6
MjsKLQl1OCAgICAgZm9yY2Vfbm9fYmVhY29uOjE7Ci0JdTggICAgIGZvcmNlX3dpdGhfaW5kOjE7
Ci0JdTggICAgIHJlc2VydmVkNjo0OwotCV9fbGUzMiBzc2lkX2xlbmd0aDsKLQl1OCAgICAgc3Np
ZFtJRUVFODAyMTFfTUFYX1NTSURfTEVOXTsKLQlfX2xlMzIgYmVhY29uX2ludGVydmFsOwotCV9f
bGUzMiBiYXNpY19yYXRlX3NldDsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfY25mX2pvaW4g
ewotCV9fbGUzMiBzdGF0dXM7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2luZF9qb2luX2Nv
bXBsZXRlIHsKLQlfX2xlMzIgc3RhdHVzOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9yZXFf
c2V0X2Jzc19wYXJhbXMgewotCXU4ICAgICBsb3N0X2NvdW50X29ubHk6MTsKLQl1OCAgICAgcmVz
ZXJ2ZWQ6NzsKLQl1OCAgICAgYmVhY29uX2xvc3RfY291bnQ7Ci0JX19sZTE2IGFpZDsKLQlfX2xl
MzIgb3BlcmF0aW9uYWxfcmF0ZV9zZXQ7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2NuZl9z
ZXRfYnNzX3BhcmFtcyB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBo
aWZfcmVxX3NldF9wbV9tb2RlIHsKLQl1OCAgICAgZW50ZXJfcHNtOjE7Ci0JdTggICAgIHJlc2Vy
dmVkOjY7Ci0JdTggICAgIGZhc3RfcHNtOjE7Ci0JdTggICAgIGZhc3RfcHNtX2lkbGVfcGVyaW9k
OwotCXU4ICAgICBhcF9wc21fY2hhbmdlX3BlcmlvZDsKLQl1OCAgICAgbWluX2F1dG9fcHNfcG9s
bF9wZXJpb2Q7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2NuZl9zZXRfcG1fbW9kZSB7Ci0J
X19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfaW5kX3NldF9wbV9tb2Rl
X2NtcGwgewotCV9fbGUzMiBzdGF0dXM7Ci0JdTggICAgIHBtX21vZGU7Ci0JdTggICAgIHJlc2Vy
dmVkWzNdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9yZXFfc3RhcnQgewotCXU4ICAgICBt
b2RlOwotCXU4ICAgICBiYW5kOwotCXU4ICAgICBjaGFubmVsX251bWJlcjsKLQl1OCAgICAgcmVz
ZXJ2ZWQxOwotCV9fbGUzMiByZXNlcnZlZDI7Ci0JX19sZTMyIGJlYWNvbl9pbnRlcnZhbDsKLQl1
OCAgICAgZHRpbV9wZXJpb2Q7Ci0JdTggICAgIHNob3J0X3ByZWFtYmxlOjE7Ci0JdTggICAgIHJl
c2VydmVkMzo3OwotCXU4ICAgICByZXNlcnZlZDQ7Ci0JdTggICAgIHNzaWRfbGVuZ3RoOwotCXU4
ICAgICBzc2lkW0lFRUU4MDIxMV9NQVhfU1NJRF9MRU5dOwotCV9fbGUzMiBiYXNpY19yYXRlX3Nl
dDsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfY25mX3N0YXJ0IHsKLQlfX2xlMzIgc3RhdHVz
OwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9yZXFfYmVhY29uX3RyYW5zbWl0IHsKLQl1OCAg
ICAgZW5hYmxlX2JlYWNvbmluZzsKLQl1OCAgICAgcmVzZXJ2ZWRbM107Ci19IF9fcGFja2VkOwot
Ci1zdHJ1Y3QgaGlmX2NuZl9iZWFjb25fdHJhbnNtaXQgewotCV9fbGUzMiBzdGF0dXM7Ci19IF9f
cGFja2VkOwotCi0jZGVmaW5lIEhJRl9MSU5LX0lEX01BWCAgICAgICAgICAgIDE0Ci0jZGVmaW5l
IEhJRl9MSU5LX0lEX05PVF9BU1NPQ0lBVEVEIChISUZfTElOS19JRF9NQVggKyAxKQotCi1zdHJ1
Y3QgaGlmX3JlcV9tYXBfbGluayB7Ci0JdTggICAgIG1hY19hZGRyW0VUSF9BTEVOXTsKLQl1OCAg
ICAgdW5tYXA6MTsKLQl1OCAgICAgbWZwYzoxOwotCXU4ICAgICByZXNlcnZlZDo2OwotCXU4ICAg
ICBwZWVyX3N0YV9pZDsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfY25mX21hcF9saW5rIHsK
LQlfX2xlMzIgc3RhdHVzOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9pbmRfc3VzcGVuZF9y
ZXN1bWVfdHggewotCXU4ICAgICByZXN1bWU6MTsKLQl1OCAgICAgcmVzZXJ2ZWQxOjI7Ci0JdTgg
ICAgIGJjX21jX29ubHk6MTsKLQl1OCAgICAgcmVzZXJ2ZWQyOjQ7Ci0JdTggICAgIHJlc2VydmVk
MzsKLQlfX2xlMTYgcGVlcl9zdGFfc2V0OwotfSBfX3BhY2tlZDsKLQotCi0jZGVmaW5lIE1BWF9L
RVlfRU5UUklFUyAgICAgICAgIDI0Ci0jZGVmaW5lIEhJRl9BUElfV0VQX0tFWV9EQVRBX1NJWkUg
ICAgICAgICAgICAgICAgICAgICAgIDE2Ci0jZGVmaW5lIEhJRl9BUElfVEtJUF9LRVlfREFUQV9T
SVpFICAgICAgICAgICAgICAgICAgICAgIDE2Ci0jZGVmaW5lIEhJRl9BUElfUlhfTUlDX0tFWV9T
SVpFICAgICAgICAgICAgICAgICAgICAgICAgIDgKLSNkZWZpbmUgSElGX0FQSV9UWF9NSUNfS0VZ
X1NJWkUgICAgICAgICAgICAgICAgICAgICAgICAgOAotI2RlZmluZSBISUZfQVBJX0FFU19LRVlf
REFUQV9TSVpFICAgICAgICAgICAgICAgICAgICAgICAxNgotI2RlZmluZSBISUZfQVBJX1dBUElf
S0VZX0RBVEFfU0laRSAgICAgICAgICAgICAgICAgICAgICAxNgotI2RlZmluZSBISUZfQVBJX01J
Q19LRVlfREFUQV9TSVpFICAgICAgICAgICAgICAgICAgICAgICAxNgotI2RlZmluZSBISUZfQVBJ
X0lHVEtfS0VZX0RBVEFfU0laRSAgICAgICAgICAgICAgICAgICAgICAxNgotI2RlZmluZSBISUZf
QVBJX1JYX1NFUVVFTkNFX0NPVU5URVJfU0laRSAgICAgICAgICAgICAgICA4Ci0jZGVmaW5lIEhJ
Rl9BUElfSVBOX1NJWkUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDgKLQotZW51bSBo
aWZfa2V5X3R5cGUgewotCUhJRl9LRVlfVFlQRV9XRVBfREVGQVVMVCAgICAgICAgICAgICAgICAg
ICA9IDB4MCwKLQlISUZfS0VZX1RZUEVfV0VQX1BBSVJXSVNFICAgICAgICAgICAgICAgICAgPSAw
eDEsCi0JSElGX0tFWV9UWVBFX1RLSVBfR1JPVVAgICAgICAgICAgICAgICAgICAgID0gMHgyLAot
CUhJRl9LRVlfVFlQRV9US0lQX1BBSVJXSVNFICAgICAgICAgICAgICAgICA9IDB4MywKLQlISUZf
S0VZX1RZUEVfQUVTX0dST1VQICAgICAgICAgICAgICAgICAgICAgPSAweDQsCi0JSElGX0tFWV9U
WVBFX0FFU19QQUlSV0lTRSAgICAgICAgICAgICAgICAgID0gMHg1LAotCUhJRl9LRVlfVFlQRV9X
QVBJX0dST1VQICAgICAgICAgICAgICAgICAgICA9IDB4NiwKLQlISUZfS0VZX1RZUEVfV0FQSV9Q
QUlSV0lTRSAgICAgICAgICAgICAgICAgPSAweDcsCi0JSElGX0tFWV9UWVBFX0lHVEtfR1JPVVAg
ICAgICAgICAgICAgICAgICAgID0gMHg4LAotCUhJRl9LRVlfVFlQRV9OT05FICAgICAgICAgICAg
ICAgICAgICAgICAgICA9IDB4OQotfTsKLQotc3RydWN0IGhpZl93ZXBfcGFpcndpc2Vfa2V5IHsK
LQl1OCAgICAgcGVlcl9hZGRyZXNzW0VUSF9BTEVOXTsKLQl1OCAgICAgcmVzZXJ2ZWQ7Ci0JdTgg
ICAgIGtleV9sZW5ndGg7Ci0JdTggICAgIGtleV9kYXRhW0hJRl9BUElfV0VQX0tFWV9EQVRBX1NJ
WkVdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl93ZXBfZ3JvdXBfa2V5IHsKLQl1OCAgICAg
a2V5X2lkOwotCXU4ICAgICBrZXlfbGVuZ3RoOwotCXU4ICAgICByZXNlcnZlZFsyXTsKLQl1OCAg
ICAga2V5X2RhdGFbSElGX0FQSV9XRVBfS0VZX0RBVEFfU0laRV07Ci19IF9fcGFja2VkOwotCi1z
dHJ1Y3QgaGlmX3RraXBfcGFpcndpc2Vfa2V5IHsKLQl1OCAgICAgcGVlcl9hZGRyZXNzW0VUSF9B
TEVOXTsKLQl1OCAgICAgcmVzZXJ2ZWRbMl07Ci0JdTggICAgIHRraXBfa2V5X2RhdGFbSElGX0FQ
SV9US0lQX0tFWV9EQVRBX1NJWkVdOwotCXU4ICAgICByeF9taWNfa2V5W0hJRl9BUElfUlhfTUlD
X0tFWV9TSVpFXTsKLQl1OCAgICAgdHhfbWljX2tleVtISUZfQVBJX1RYX01JQ19LRVlfU0laRV07
Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX3RraXBfZ3JvdXBfa2V5IHsKLQl1OCAgICAgdGtp
cF9rZXlfZGF0YVtISUZfQVBJX1RLSVBfS0VZX0RBVEFfU0laRV07Ci0JdTggICAgIHJ4X21pY19r
ZXlbSElGX0FQSV9SWF9NSUNfS0VZX1NJWkVdOwotCXU4ICAgICBrZXlfaWQ7Ci0JdTggICAgIHJl
c2VydmVkWzNdOwotCXU4ICAgICByeF9zZXF1ZW5jZV9jb3VudGVyW0hJRl9BUElfUlhfU0VRVUVO
Q0VfQ09VTlRFUl9TSVpFXTsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfYWVzX3BhaXJ3aXNl
X2tleSB7Ci0JdTggICAgIHBlZXJfYWRkcmVzc1tFVEhfQUxFTl07Ci0JdTggICAgIHJlc2VydmVk
WzJdOwotCXU4ICAgICBhZXNfa2V5X2RhdGFbSElGX0FQSV9BRVNfS0VZX0RBVEFfU0laRV07Ci19
IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2Flc19ncm91cF9rZXkgewotCXU4ICAgICBhZXNfa2V5
X2RhdGFbSElGX0FQSV9BRVNfS0VZX0RBVEFfU0laRV07Ci0JdTggICAgIGtleV9pZDsKLQl1OCAg
ICAgcmVzZXJ2ZWRbM107Ci0JdTggICAgIHJ4X3NlcXVlbmNlX2NvdW50ZXJbSElGX0FQSV9SWF9T
RVFVRU5DRV9DT1VOVEVSX1NJWkVdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl93YXBpX3Bh
aXJ3aXNlX2tleSB7Ci0JdTggICAgIHBlZXJfYWRkcmVzc1tFVEhfQUxFTl07Ci0JdTggICAgIGtl
eV9pZDsKLQl1OCAgICAgcmVzZXJ2ZWQ7Ci0JdTggICAgIHdhcGlfa2V5X2RhdGFbSElGX0FQSV9X
QVBJX0tFWV9EQVRBX1NJWkVdOwotCXU4ICAgICBtaWNfa2V5X2RhdGFbSElGX0FQSV9NSUNfS0VZ
X0RBVEFfU0laRV07Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX3dhcGlfZ3JvdXBfa2V5IHsK
LQl1OCAgICAgd2FwaV9rZXlfZGF0YVtISUZfQVBJX1dBUElfS0VZX0RBVEFfU0laRV07Ci0JdTgg
ICAgIG1pY19rZXlfZGF0YVtISUZfQVBJX01JQ19LRVlfREFUQV9TSVpFXTsKLQl1OCAgICAga2V5
X2lkOwotCXU4ICAgICByZXNlcnZlZFszXTsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfaWd0
a19ncm91cF9rZXkgewotCXU4ICAgICBpZ3RrX2tleV9kYXRhW0hJRl9BUElfSUdUS19LRVlfREFU
QV9TSVpFXTsKLQl1OCAgICAga2V5X2lkOwotCXU4ICAgICByZXNlcnZlZFszXTsKLQl1OCAgICAg
aXBuW0hJRl9BUElfSVBOX1NJWkVdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9yZXFfYWRk
X2tleSB7Ci0JdTggICAgIHR5cGU7Ci0JdTggICAgIGVudHJ5X2luZGV4OwotCXU4ICAgICBpbnRf
aWQ6MjsKLQl1OCAgICAgcmVzZXJ2ZWQxOjY7Ci0JdTggICAgIHJlc2VydmVkMjsKLQl1bmlvbiB7
Ci0JCXN0cnVjdCBoaWZfd2VwX3BhaXJ3aXNlX2tleSAgd2VwX3BhaXJ3aXNlX2tleTsKLQkJc3Ry
dWN0IGhpZl93ZXBfZ3JvdXBfa2V5ICAgICB3ZXBfZ3JvdXBfa2V5OwotCQlzdHJ1Y3QgaGlmX3Rr
aXBfcGFpcndpc2Vfa2V5IHRraXBfcGFpcndpc2Vfa2V5OwotCQlzdHJ1Y3QgaGlmX3RraXBfZ3Jv
dXBfa2V5ICAgIHRraXBfZ3JvdXBfa2V5OwotCQlzdHJ1Y3QgaGlmX2Flc19wYWlyd2lzZV9rZXkg
IGFlc19wYWlyd2lzZV9rZXk7Ci0JCXN0cnVjdCBoaWZfYWVzX2dyb3VwX2tleSAgICAgYWVzX2dy
b3VwX2tleTsKLQkJc3RydWN0IGhpZl93YXBpX3BhaXJ3aXNlX2tleSB3YXBpX3BhaXJ3aXNlX2tl
eTsKLQkJc3RydWN0IGhpZl93YXBpX2dyb3VwX2tleSAgICB3YXBpX2dyb3VwX2tleTsKLQkJc3Ry
dWN0IGhpZl9pZ3RrX2dyb3VwX2tleSAgICBpZ3RrX2dyb3VwX2tleTsKLQl9IGtleTsKLX0gX19w
YWNrZWQ7Ci0KLXN0cnVjdCBoaWZfY25mX2FkZF9rZXkgewotCV9fbGUzMiBzdGF0dXM7Ci19IF9f
cGFja2VkOwotCi1zdHJ1Y3QgaGlmX3JlcV9yZW1vdmVfa2V5IHsKLQl1OCAgICAgZW50cnlfaW5k
ZXg7Ci0JdTggICAgIHJlc2VydmVkWzNdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9jbmZf
cmVtb3ZlX2tleSB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX2V2
ZW50X2luZCB7Ci0JSElGX0VWRU5UX0lORF9CU1NMT1NUICAgICAgICAgICAgICAgICAgICAgID0g
MHgxLAotCUhJRl9FVkVOVF9JTkRfQlNTUkVHQUlORUQgICAgICAgICAgICAgICAgICA9IDB4MiwK
LQlISUZfRVZFTlRfSU5EX1JDUElfUlNTSSAgICAgICAgICAgICAgICAgICAgPSAweDMsCi0JSElG
X0VWRU5UX0lORF9QU19NT0RFX0VSUk9SICAgICAgICAgICAgICAgID0gMHg0LAotCUhJRl9FVkVO
VF9JTkRfSU5BQ1RJVklUWSAgICAgICAgICAgICAgICAgICA9IDB4NQotfTsKLQotZW51bSBoaWZf
cHNfbW9kZV9lcnJvciB7Ci0JSElGX1BTX0VSUk9SX05PX0VSUk9SICAgICAgICAgICAgICAgICAg
ICAgID0gMCwKLQlISUZfUFNfRVJST1JfQVBfTk9UX1JFU1BfVE9fUE9MTCAgICAgICAgICAgPSAx
LAotCUhJRl9QU19FUlJPUl9BUF9OT1RfUkVTUF9UT19VQVBTRF9UUklHR0VSICA9IDIsCi0JSElG
X1BTX0VSUk9SX0FQX1NFTlRfVU5JQ0FTVF9JTl9ET1pFICAgICAgID0gMywKLQlISUZfUFNfRVJS
T1JfQVBfTk9fREFUQV9BRlRFUl9USU0gICAgICAgICAgPSA0Ci19OwotCi1zdHJ1Y3QgaGlmX2lu
ZF9ldmVudCB7Ci0JX19sZTMyIGV2ZW50X2lkOwotCXVuaW9uIHsKLQkJdTggICAgIHJjcGlfcnNz
aTsKLQkJX19sZTMyIHBzX21vZGVfZXJyb3I7Ci0JCV9fbGUzMiBwZWVyX3N0YV9zZXQ7Ci0JfSBl
dmVudF9kYXRhOwotfSBfX3BhY2tlZDsKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0
YWdpbmcvd2Z4L2hpZl9hcGlfZ2VuZXJhbC5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfYXBp
X2dlbmVyYWwuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNWY3NGY4MjliN2RmLi4w
MDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfYXBpX2dlbmVyYWwuaAor
KysgL2Rldi9udWxsCkBAIC0xLDI2MiArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogQXBhY2hlLTIuMCAqLwotLyoKLSAqIFdGMjAwIGhhcmR3YXJlIGludGVyZmFjZSBkZWZpbml0
aW9ucwotICoKLSAqIENvcHlyaWdodCAoYykgMjAxOC0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmll
cyBJbmMuCi0gKi8KLQotI2lmbmRlZiBXRlhfSElGX0FQSV9HRU5FUkFMX0gKLSNkZWZpbmUgV0ZY
X0hJRl9BUElfR0VORVJBTF9ICi0KLSNpZmRlZiBfX0tFUk5FTF9fCi0jaW5jbHVkZSA8bGludXgv
dHlwZXMuaD4KLSNpbmNsdWRlIDxsaW51eC9pZl9ldGhlci5oPgotI2Vsc2UKLSNpbmNsdWRlIDxu
ZXQvZXRoZXJuZXQuaD4KLSNpbmNsdWRlIDxzdGRpbnQuaD4KLSNkZWZpbmUgX19wYWNrZWQgX19h
dHRyaWJ1dGVfXygoX19wYWNrZWRfXykpCi0jZW5kaWYKLQotI2RlZmluZSBISUZfSURfSVNfSU5E
SUNBVElPTiAgICAgIDB4ODAKLSNkZWZpbmUgSElGX0NPVU5URVJfTUFYICAgICAgICAgICA3Ci0K
LXN0cnVjdCBoaWZfbXNnIHsKLQlfX2xlMTYgbGVuOwotCXU4ICAgICBpZDsKLQl1OCAgICAgcmVz
ZXJ2ZWQ6MTsKLQl1OCAgICAgaW50ZXJmYWNlOjI7Ci0JdTggICAgIHNlcW51bTozOwotCXU4ICAg
ICBlbmNyeXB0ZWQ6MjsKLQl1OCAgICAgYm9keVtdOwotfSBfX3BhY2tlZDsKLQotZW51bSBoaWZf
Z2VuZXJhbF9yZXF1ZXN0c19pZHMgewotCUhJRl9SRVFfSURfQ09ORklHVVJBVElPTiAgICAgICAg
PSAweDA5LAotCUhJRl9SRVFfSURfQ09OVFJPTF9HUElPICAgICAgICAgPSAweDI2LAotCUhJRl9S
RVFfSURfU0VUX1NMX01BQ19LRVkgICAgICAgPSAweDI3LAotCUhJRl9SRVFfSURfU0xfRVhDSEFO
R0VfUFVCX0tFWVMgPSAweDI4LAotCUhJRl9SRVFfSURfU0xfQ09ORklHVVJFICAgICAgICAgPSAw
eDI5LAotCUhJRl9SRVFfSURfUFJFVkVOVF9ST0xMQkFDSyAgICAgPSAweDJhLAotCUhJRl9SRVFf
SURfUFRBX1NFVFRJTkdTICAgICAgICAgPSAweDJiLAotCUhJRl9SRVFfSURfUFRBX1BSSU9SSVRZ
ICAgICAgICAgPSAweDJjLAotCUhJRl9SRVFfSURfUFRBX1NUQVRFICAgICAgICAgICAgPSAweDJk
LAotCUhJRl9SRVFfSURfU0hVVF9ET1dOICAgICAgICAgICAgPSAweDMyLAotfTsKLQotZW51bSBo
aWZfZ2VuZXJhbF9jb25maXJtYXRpb25zX2lkcyB7Ci0JSElGX0NORl9JRF9DT05GSUdVUkFUSU9O
ICAgICAgICA9IDB4MDksCi0JSElGX0NORl9JRF9DT05UUk9MX0dQSU8gICAgICAgICA9IDB4MjYs
Ci0JSElGX0NORl9JRF9TRVRfU0xfTUFDX0tFWSAgICAgICA9IDB4MjcsCi0JSElGX0NORl9JRF9T
TF9FWENIQU5HRV9QVUJfS0VZUyA9IDB4MjgsCi0JSElGX0NORl9JRF9TTF9DT05GSUdVUkUgICAg
ICAgICA9IDB4MjksCi0JSElGX0NORl9JRF9QUkVWRU5UX1JPTExCQUNLICAgICA9IDB4MmEsCi0J
SElGX0NORl9JRF9QVEFfU0VUVElOR1MgICAgICAgICA9IDB4MmIsCi0JSElGX0NORl9JRF9QVEFf
UFJJT1JJVFkgICAgICAgICA9IDB4MmMsCi0JSElGX0NORl9JRF9QVEFfU1RBVEUgICAgICAgICAg
ICA9IDB4MmQsCi0JSElGX0NORl9JRF9TSFVUX0RPV04gICAgICAgICAgICA9IDB4MzIsCi19Owot
Ci1lbnVtIGhpZl9nZW5lcmFsX2luZGljYXRpb25zX2lkcyB7Ci0JSElGX0lORF9JRF9FWENFUFRJ
T04gICAgICAgICAgICA9IDB4ZTAsCi0JSElGX0lORF9JRF9TVEFSVFVQICAgICAgICAgICAgICA9
IDB4ZTEsCi0JSElGX0lORF9JRF9XQUtFVVAgICAgICAgICAgICAgICA9IDB4ZTIsCi0JSElGX0lO
RF9JRF9HRU5FUklDICAgICAgICAgICAgICA9IDB4ZTMsCi0JSElGX0lORF9JRF9FUlJPUiAgICAg
ICAgICAgICAgICA9IDB4ZTQsCi0JSElGX0lORF9JRF9TTF9FWENIQU5HRV9QVUJfS0VZUyA9IDB4
ZTUKLX07Ci0KLSNkZWZpbmUgSElGX1NUQVRVU19TVUNDRVNTICAgICAgICAgICAgICAgICAgICAg
ICAgIChjcHVfdG9fbGUzMigweDAwMDApKQotI2RlZmluZSBISUZfU1RBVFVTX0ZBSUwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKGNwdV90b19sZTMyKDB4MDAwMSkpCi0jZGVmaW5lIEhJRl9T
VEFUVVNfSU5WQUxJRF9QQVJBTUVURVIgICAgICAgICAgICAgICAoY3B1X3RvX2xlMzIoMHgwMDAy
KSkKLSNkZWZpbmUgSElGX1NUQVRVU19XQVJOSU5HICAgICAgICAgICAgICAgICAgICAgICAgIChj
cHVfdG9fbGUzMigweDAwMDMpKQotI2RlZmluZSBISUZfU1RBVFVTX1VOS05PV05fUkVRVUVTVCAg
ICAgICAgICAgICAgICAgKGNwdV90b19sZTMyKDB4MDAwNCkpCi0jZGVmaW5lIEhJRl9TVEFUVVNf
UlhfRkFJTF9ERUNSWVBUICAgICAgICAgICAgICAgICAoY3B1X3RvX2xlMzIoMHgwMDEwKSkKLSNk
ZWZpbmUgSElGX1NUQVRVU19SWF9GQUlMX01JQyAgICAgICAgICAgICAgICAgICAgIChjcHVfdG9f
bGUzMigweDAwMTEpKQotI2RlZmluZSBISUZfU1RBVFVTX1JYX0ZBSUxfTk9fS0VZICAgICAgICAg
ICAgICAgICAgKGNwdV90b19sZTMyKDB4MDAxMikpCi0jZGVmaW5lIEhJRl9TVEFUVVNfVFhfRkFJ
TF9SRVRSSUVTICAgICAgICAgICAgICAgICAoY3B1X3RvX2xlMzIoMHgwMDEzKSkKLSNkZWZpbmUg
SElGX1NUQVRVU19UWF9GQUlMX1RJTUVPVVQgICAgICAgICAgICAgICAgIChjcHVfdG9fbGUzMigw
eDAwMTQpKQotI2RlZmluZSBISUZfU1RBVFVTX1RYX0ZBSUxfUkVRVUVVRSAgICAgICAgICAgICAg
ICAgKGNwdV90b19sZTMyKDB4MDAxNSkpCi0jZGVmaW5lIEhJRl9TVEFUVVNfUkVGVVNFRCAgICAg
ICAgICAgICAgICAgICAgICAgICAoY3B1X3RvX2xlMzIoMHgwMDE2KSkKLSNkZWZpbmUgSElGX1NU
QVRVU19CVVNZICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjcHVfdG9fbGUzMigweDAwMTcp
KQotI2RlZmluZSBISUZfU1RBVFVTX1NMS19TRVRfS0VZX1NVQ0NFU1MgICAgICAgICAgICAgKGNw
dV90b19sZTMyKDB4MDA1QSkpCi0jZGVmaW5lIEhJRl9TVEFUVVNfU0xLX1NFVF9LRVlfQUxSRUFE
WV9CVVJORUQgICAgICAoY3B1X3RvX2xlMzIoMHgwMDZCKSkKLSNkZWZpbmUgSElGX1NUQVRVU19T
TEtfU0VUX0tFWV9ESVNBTExPV0VEX01PREUgICAgIChjcHVfdG9fbGUzMigweDAwN0MpKQotI2Rl
ZmluZSBISUZfU1RBVFVTX1NMS19TRVRfS0VZX1VOS05PV05fTU9ERSAgICAgICAgKGNwdV90b19s
ZTMyKDB4MDA4RCkpCi0jZGVmaW5lIEhJRl9TVEFUVVNfU0xLX05FR09fU1VDQ0VTUyAgICAgICAg
ICAgICAgICAoY3B1X3RvX2xlMzIoMHgwMDlFKSkKLSNkZWZpbmUgSElGX1NUQVRVU19TTEtfTkVH
T19GQUlMRUQgICAgICAgICAgICAgICAgIChjcHVfdG9fbGUzMigweDAwQUYpKQotI2RlZmluZSBI
SUZfU1RBVFVTX1JPTExCQUNLX1NVQ0NFU1MgICAgICAgICAgICAgICAgKGNwdV90b19sZTMyKDB4
MTIzNCkpCi0jZGVmaW5lIEhJRl9TVEFUVVNfUk9MTEJBQ0tfRkFJTCAgICAgICAgICAgICAgICAg
ICAoY3B1X3RvX2xlMzIoMHgxMjU2KSkKLQotZW51bSBoaWZfYXBpX3JhdGVfaW5kZXggewotCUFQ
SV9SQVRFX0lOREVYX0JfMU1CUFMgICAgID0gMCwKLQlBUElfUkFURV9JTkRFWF9CXzJNQlBTICAg
ICA9IDEsCi0JQVBJX1JBVEVfSU5ERVhfQl81UDVNQlBTICAgPSAyLAotCUFQSV9SQVRFX0lOREVY
X0JfMTFNQlBTICAgID0gMywKLQlBUElfUkFURV9JTkRFWF9QQkNDXzIyTUJQUyA9IDQsCi0JQVBJ
X1JBVEVfSU5ERVhfUEJDQ18zM01CUFMgPSA1LAotCUFQSV9SQVRFX0lOREVYX0dfNk1CUFMgICAg
ID0gNiwKLQlBUElfUkFURV9JTkRFWF9HXzlNQlBTICAgICA9IDcsCi0JQVBJX1JBVEVfSU5ERVhf
R18xMk1CUFMgICAgPSA4LAotCUFQSV9SQVRFX0lOREVYX0dfMThNQlBTICAgID0gOSwKLQlBUElf
UkFURV9JTkRFWF9HXzI0TUJQUyAgICA9IDEwLAotCUFQSV9SQVRFX0lOREVYX0dfMzZNQlBTICAg
ID0gMTEsCi0JQVBJX1JBVEVfSU5ERVhfR180OE1CUFMgICAgPSAxMiwKLQlBUElfUkFURV9JTkRF
WF9HXzU0TUJQUyAgICA9IDEzLAotCUFQSV9SQVRFX0lOREVYX05fNlA1TUJQUyAgID0gMTQsCi0J
QVBJX1JBVEVfSU5ERVhfTl8xM01CUFMgICAgPSAxNSwKLQlBUElfUkFURV9JTkRFWF9OXzE5UDVN
QlBTICA9IDE2LAotCUFQSV9SQVRFX0lOREVYX05fMjZNQlBTICAgID0gMTcsCi0JQVBJX1JBVEVf
SU5ERVhfTl8zOU1CUFMgICAgPSAxOCwKLQlBUElfUkFURV9JTkRFWF9OXzUyTUJQUyAgICA9IDE5
LAotCUFQSV9SQVRFX0lOREVYX05fNThQNU1CUFMgID0gMjAsCi0JQVBJX1JBVEVfSU5ERVhfTl82
NU1CUFMgICAgPSAyMSwKLQlBUElfUkFURV9OVU1fRU5UUklFUyAgICAgICA9IDIyCi19OwotCi1z
dHJ1Y3QgaGlmX2luZF9zdGFydHVwIHsKLQkvKiBBcyB0aGUgb3RoZXJzLCB0aGlzIHN0cnVjdCBp
cyBpbnRlcnByZXRlZCBhcyBsaXR0bGUgZW5kaWFuIGJ5IHRoZQotCSAqIGRldmljZS4gSG93ZXZl
ciwgdGhpcyBzdHJ1Y3QgaXMgYWxzbyB1c2VkIGJ5IHRoZSBkcml2ZXIuIFdlIHByZWZlciB0bwot
CSAqIGRlY2xhcmUgaXQgaW4gbmF0aXZlIG9yZGVyIGFuZCBkb2luZyBieXRlIHN3YXAgb24gcmVj
ZXB0aW9uLgotCSAqLwotCV9fbGUzMiBzdGF0dXM7Ci0JdTE2ICAgIGhhcmR3YXJlX2lkOwotCXU4
ICAgICBvcG5bMTRdOwotCXU4ICAgICB1aWRbOF07Ci0JdTE2ICAgIG51bV9pbnBfY2hfYnVmczsK
LQl1MTYgICAgc2l6ZV9pbnBfY2hfYnVmOwotCXU4ICAgICBudW1fbGlua3NfYXA7Ci0JdTggICAg
IG51bV9pbnRlcmZhY2VzOwotCXU4ICAgICBtYWNfYWRkclsyXVtFVEhfQUxFTl07Ci0JdTggICAg
IGFwaV92ZXJzaW9uX21pbm9yOwotCXU4ICAgICBhcGlfdmVyc2lvbl9tYWpvcjsKLQl1OCAgICAg
bGlua19tb2RlOjI7Ci0JdTggICAgIHJlc2VydmVkMTo2OwotCXU4ICAgICByZXNlcnZlZDI7Ci0J
dTggICAgIHJlc2VydmVkMzsKLQl1OCAgICAgcmVzZXJ2ZWQ0OwotCXU4ICAgICBmaXJtd2FyZV9i
dWlsZDsKLQl1OCAgICAgZmlybXdhcmVfbWlub3I7Ci0JdTggICAgIGZpcm13YXJlX21ham9yOwot
CXU4ICAgICBmaXJtd2FyZV90eXBlOwotCXU4ICAgICBkaXNhYmxlZF9jaGFubmVsX2xpc3RbMl07
Ci0JdTggICAgIHJlZ2lvbl9zZWxfbW9kZTo0OwotCXU4ICAgICByZXNlcnZlZDU6NDsKLQl1OCAg
ICAgcGh5MV9yZWdpb246MzsKLQl1OCAgICAgcGh5MF9yZWdpb246MzsKLQl1OCAgICAgb3RwX3Bo
eV92ZXI6MjsKLQl1MzIgICAgc3VwcG9ydGVkX3JhdGVfbWFzazsKLQl1OCAgICAgZmlybXdhcmVf
bGFiZWxbMTI4XTsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfaW5kX3dha2V1cCB7Ci19IF9f
cGFja2VkOwotCi1zdHJ1Y3QgaGlmX3JlcV9jb25maWd1cmF0aW9uIHsKLQlfX2xlMTYgbGVuZ3Ro
OwotCXU4ICAgICBwZHNfZGF0YVtdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9jbmZfY29u
ZmlndXJhdGlvbiB7Ci0JX19sZTMyIHN0YXR1czsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX2dw
aW9fbW9kZSB7Ci0JSElGX0dQSU9fTU9ERV9EMCAgICAgICA9IDB4MCwKLQlISUZfR1BJT19NT0RF
X0QxICAgICAgID0gMHgxLAotCUhJRl9HUElPX01PREVfT0QwICAgICAgPSAweDIsCi0JSElGX0dQ
SU9fTU9ERV9PRDEgICAgICA9IDB4MywKLQlISUZfR1BJT19NT0RFX1RSSVNUQVRFID0gMHg0LAot
CUhJRl9HUElPX01PREVfVE9HR0xFICAgPSAweDUsCi0JSElGX0dQSU9fTU9ERV9SRUFEICAgICA9
IDB4NgotfTsKLQotc3RydWN0IGhpZl9yZXFfY29udHJvbF9ncGlvIHsKLQl1OCAgICAgZ3Bpb19s
YWJlbDsKLQl1OCAgICAgZ3Bpb19tb2RlOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9jbmZf
Y29udHJvbF9ncGlvIHsKLQlfX2xlMzIgc3RhdHVzOwotCV9fbGUzMiB2YWx1ZTsKLX0gX19wYWNr
ZWQ7Ci0KLWVudW0gaGlmX2dlbmVyaWNfaW5kaWNhdGlvbl90eXBlIHsKLQlISUZfR0VORVJJQ19J
TkRJQ0FUSU9OX1RZUEVfUkFXICAgICAgICAgICAgICAgID0gMHgwLAotCUhJRl9HRU5FUklDX0lO
RElDQVRJT05fVFlQRV9TVFJJTkcgICAgICAgICAgICAgPSAweDEsCi0JSElGX0dFTkVSSUNfSU5E
SUNBVElPTl9UWVBFX1JYX1NUQVRTICAgICAgICAgICA9IDB4MiwKLQlISUZfR0VORVJJQ19JTkRJ
Q0FUSU9OX1RZUEVfVFhfUE9XRVJfTE9PUF9JTkZPID0gMHgzLAotfTsKLQotc3RydWN0IGhpZl9y
eF9zdGF0cyB7Ci0JX19sZTMyIG5iX3J4X2ZyYW1lOwotCV9fbGUzMiBuYl9jcmNfZnJhbWU7Ci0J
X19sZTMyIHBlcl90b3RhbDsKLQlfX2xlMzIgdGhyb3VnaHB1dDsKLQlfX2xlMzIgbmJfcnhfYnlf
cmF0ZVtBUElfUkFURV9OVU1fRU5UUklFU107Ci0JX19sZTE2IHBlcltBUElfUkFURV9OVU1fRU5U
UklFU107Ci0JX19sZTE2IHNucltBUElfUkFURV9OVU1fRU5UUklFU107ICAvKiBzaWduZWQgdmFs
dWUgKi8KLQlfX2xlMTYgcnNzaVtBUElfUkFURV9OVU1fRU5UUklFU107IC8qIHNpZ25lZCB2YWx1
ZSAqLwotCV9fbGUxNiBjZm9bQVBJX1JBVEVfTlVNX0VOVFJJRVNdOyAgLyogc2lnbmVkIHZhbHVl
ICovCi0JX19sZTMyIGRhdGU7Ci0JX19sZTMyIHB3cl9jbGtfZnJlcTsKLQl1OCAgICAgaXNfZXh0
X3B3cl9jbGs7Ci0JczggICAgIGN1cnJlbnRfdGVtcDsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBo
aWZfdHhfcG93ZXJfbG9vcF9pbmZvIHsKLQlfX2xlMTYgdHhfZ2Fpbl9kaWc7Ci0JX19sZTE2IHR4
X2dhaW5fcGE7Ci0JX19sZTE2IHRhcmdldF9wb3V0OyAvKiBzaWduZWQgdmFsdWUgKi8KLQlfX2xl
MTYgcF9lc3RpbWF0aW9uOyAvKiBzaWduZWQgdmFsdWUgKi8KLQlfX2xlMTYgdnBkZXQ7Ci0JdTgg
ICAgIG1lYXN1cmVtZW50X2luZGV4OwotCXU4ICAgICByZXNlcnZlZDsKLX0gX19wYWNrZWQ7Ci0K
LXN0cnVjdCBoaWZfaW5kX2dlbmVyaWMgewotCV9fbGUzMiB0eXBlOwotCXVuaW9uIHsKLQkJc3Ry
dWN0IGhpZl9yeF9zdGF0cyByeF9zdGF0czsKLQkJc3RydWN0IGhpZl90eF9wb3dlcl9sb29wX2lu
Zm8gdHhfcG93ZXJfbG9vcF9pbmZvOwotCX0gZGF0YTsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlm
X2Vycm9yIHsKLQlISUZfRVJST1JfRklSTVdBUkVfUk9MTEJBQ0sgICAgICAgICAgID0gMHgwMCwK
LQlISUZfRVJST1JfRklSTVdBUkVfREVCVUdfRU5BQkxFRCAgICAgID0gMHgwMSwKLQlISUZfRVJS
T1JfU0xLX09VVERBVEVEX1NFU1NJT05fS0VZICAgID0gMHgwMiwKLQlISUZfRVJST1JfU0xLX1NF
U1NJT05fS0VZICAgICAgICAgICAgID0gMHgwMywKLQlISUZfRVJST1JfT09SX1ZPTFRBR0UgICAg
ICAgICAgICAgICAgID0gMHgwNCwKLQlISUZfRVJST1JfUERTX1BBWUxPQUQgICAgICAgICAgICAg
ICAgID0gMHgwNSwKLQlISUZfRVJST1JfT09SX1RFTVBFUkFUVVJFICAgICAgICAgICAgID0gMHgw
NiwKLQlISUZfRVJST1JfU0xLX1JFUV9EVVJJTkdfS0VZX0VYQ0hBTkdFID0gMHgwNywKLQlISUZf
RVJST1JfU0xLX01VTFRJX1RYX1VOU1VQUE9SVEVEICAgID0gMHgwOCwKLQlISUZfRVJST1JfU0xL
X09WRVJGTE9XICAgICAgICAgICAgICAgID0gMHgwOSwKLQlISUZfRVJST1JfU0xLX0RFQ1JZUFRJ
T04gICAgICAgICAgICAgID0gMHgwYSwKLQlISUZfRVJST1JfU0xLX1dST05HX0VOQ1JZUFRJT05f
U1RBVEUgID0gMHgwYiwKLQlISUZfRVJST1JfSElGX0JVU19GUkVRVUVOQ1lfVE9PX0xPVyAgID0g
MHgwYywKLQlISUZfRVJST1JfSElGX1JYX0RBVEFfVE9PX0xBUkdFICAgICAgID0gMHgwZSwKLQlI
SUZfRVJST1JfSElGX1RYX1FVRVVFX0ZVTEwgICAgICAgICAgID0gMHgwZCwKLQlISUZfRVJST1Jf
SElGX0JVUyAgICAgICAgICAgICAgICAgICAgID0gMHgwZiwKLQlISUZfRVJST1JfUERTX1RFU1RG
RUFUVVJFICAgICAgICAgICAgID0gMHgxMCwKLQlISUZfRVJST1JfU0xLX1VOQ09ORklHVVJFRCAg
ICAgICAgICAgID0gMHgxMSwKLX07Ci0KLXN0cnVjdCBoaWZfaW5kX2Vycm9yIHsKLQlfX2xlMzIg
dHlwZTsKLQl1OCAgICAgZGF0YVtdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9pbmRfZXhj
ZXB0aW9uIHsKLQlfX2xlMzIgdHlwZTsKLQl1OCAgICAgZGF0YVtdOwotfSBfX3BhY2tlZDsKLQot
ZW51bSBoaWZfc2VjdXJlX2xpbmtfc3RhdGUgewotCVNFQ19MSU5LX1VOQVZBSUxBQkxFID0gMHgw
LAotCVNFQ19MSU5LX1JFU0VSVkVEICAgID0gMHgxLAotCVNFQ19MSU5LX0VWQUwgICAgICAgID0g
MHgyLAotCVNFQ19MSU5LX0VORk9SQ0VEICAgID0gMHgzCi19OwotCi0jZW5kaWYKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX2FwaV9taWIuaCBiL2RyaXZlcnMvc3RhZ2luZy93
ZngvaGlmX2FwaV9taWIuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggZGE1MzRmMjQ0
NzU3Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfYXBpX21pYi5o
CisrKyAvZGV2L251bGwKQEAgLTEsMzQ2ICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBBcGFjaGUtMi4wICovCi0vKgotICogV0YyMDAgaGFyZHdhcmUgaW50ZXJmYWNlIGRlZmlu
aXRpb25zCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE4LTIwMjAsIFNpbGljb24gTGFib3JhdG9y
aWVzIEluYy4KLSAqLwotCi0jaWZuZGVmIFdGWF9ISUZfQVBJX01JQl9ICi0jZGVmaW5lIFdGWF9I
SUZfQVBJX01JQl9ICi0KLSNpbmNsdWRlICJoaWZfYXBpX2dlbmVyYWwuaCIKLQotI2RlZmluZSBI
SUZfQVBJX0lQVjRfQUREUkVTU19TSVpFIDQKLSNkZWZpbmUgSElGX0FQSV9JUFY2X0FERFJFU1Nf
U0laRSAxNgotCi1lbnVtIGhpZl9taWJfaWRzIHsKLQlISUZfTUlCX0lEX0dMX09QRVJBVElPTkFM
X1BPV0VSX01PREUgICAgICAgID0gMHgyMDAwLAotCUhJRl9NSUJfSURfR0xfQkxPQ0tfQUNLX0lO
Rk8gICAgICAgICAgICAgICAgPSAweDIwMDEsCi0JSElGX01JQl9JRF9HTF9TRVRfTVVMVElfTVNH
ICAgICAgICAgICAgICAgICA9IDB4MjAwMiwKLQlISUZfTUlCX0lEX0NDQV9DT05GSUcgICAgICAg
ICAgICAgICAgICAgICAgID0gMHgyMDAzLAotCUhJRl9NSUJfSURfRVRIRVJUWVBFX0RBVEFGUkFN
RV9DT05ESVRJT04gICAgPSAweDIwMTAsCi0JSElGX01JQl9JRF9QT1JUX0RBVEFGUkFNRV9DT05E
SVRJT04gICAgICAgICA9IDB4MjAxMSwKLQlISUZfTUlCX0lEX01BR0lDX0RBVEFGUkFNRV9DT05E
SVRJT04gICAgICAgID0gMHgyMDEyLAotCUhJRl9NSUJfSURfTUFDX0FERFJfREFUQUZSQU1FX0NP
TkRJVElPTiAgICAgPSAweDIwMTMsCi0JSElGX01JQl9JRF9JUFY0X0FERFJfREFUQUZSQU1FX0NP
TkRJVElPTiAgICA9IDB4MjAxNCwKLQlISUZfTUlCX0lEX0lQVjZfQUREUl9EQVRBRlJBTUVfQ09O
RElUSU9OICAgID0gMHgyMDE1LAotCUhJRl9NSUJfSURfVUNfTUNfQkNfREFUQUZSQU1FX0NPTkRJ
VElPTiAgICAgPSAweDIwMTYsCi0JSElGX01JQl9JRF9DT05GSUdfREFUQV9GSUxURVIgICAgICAg
ICAgICAgICA9IDB4MjAxNywKLQlISUZfTUlCX0lEX1NFVF9EQVRBX0ZJTFRFUklORyAgICAgICAg
ICAgICAgID0gMHgyMDE4LAotCUhJRl9NSUJfSURfQVJQX0lQX0FERFJFU1NFU19UQUJMRSAgICAg
ICAgICAgPSAweDIwMTksCi0JSElGX01JQl9JRF9OU19JUF9BRERSRVNTRVNfVEFCTEUgICAgICAg
ICAgICA9IDB4MjAxQSwKLQlISUZfTUlCX0lEX1JYX0ZJTFRFUiAgICAgICAgICAgICAgICAgICAg
ICAgID0gMHgyMDFCLAotCUhJRl9NSUJfSURfQkVBQ09OX0ZJTFRFUl9UQUJMRSAgICAgICAgICAg
ICAgPSAweDIwMUMsCi0JSElGX01JQl9JRF9CRUFDT05fRklMVEVSX0VOQUJMRSAgICAgICAgICAg
ICA9IDB4MjAxRCwKLQlISUZfTUlCX0lEX0dSUF9TRVFfQ09VTlRFUiAgICAgICAgICAgICAgICAg
ID0gMHgyMDMwLAotCUhJRl9NSUJfSURfVFNGX0NPVU5URVIgICAgICAgICAgICAgICAgICAgICAg
PSAweDIwMzEsCi0JSElGX01JQl9JRF9TVEFUSVNUSUNTX1RBQkxFICAgICAgICAgICAgICAgICA9
IDB4MjAzMiwKLQlISUZfTUlCX0lEX0NPVU5URVJTX1RBQkxFICAgICAgICAgICAgICAgICAgID0g
MHgyMDMzLAotCUhJRl9NSUJfSURfTUFYX1RYX1BPV0VSX0xFVkVMICAgICAgICAgICAgICAgPSAw
eDIwMzQsCi0JSElGX01JQl9JRF9FWFRFTkRFRF9DT1VOVEVSU19UQUJMRSAgICAgICAgICA9IDB4
MjAzNSwKLQlISUZfTUlCX0lEX0RPVDExX01BQ19BRERSRVNTICAgICAgICAgICAgICAgID0gMHgy
MDQwLAotCUhJRl9NSUJfSURfRE9UMTFfTUFYX1RSQU5TTUlUX01TRFVfTElGRVRJTUUgPSAweDIw
NDEsCi0JSElGX01JQl9JRF9ET1QxMV9NQVhfUkVDRUlWRV9MSUZFVElNRSAgICAgICA9IDB4MjA0
MiwKLQlISUZfTUlCX0lEX0RPVDExX1dFUF9ERUZBVUxUX0tFWV9JRCAgICAgICAgID0gMHgyMDQz
LAotCUhJRl9NSUJfSURfRE9UMTFfUlRTX1RIUkVTSE9MRCAgICAgICAgICAgICAgPSAweDIwNDQs
Ci0JSElGX01JQl9JRF9TTE9UX1RJTUUgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjA0NSwK
LQlISUZfTUlCX0lEX0NVUlJFTlRfVFhfUE9XRVJfTEVWRUwgICAgICAgICAgID0gMHgyMDQ2LAot
CUhJRl9NSUJfSURfTk9OX0VSUF9QUk9URUNUSU9OICAgICAgICAgICAgICAgPSAweDIwNDcsCi0J
SElGX01JQl9JRF9URU1QTEFURV9GUkFNRSAgICAgICAgICAgICAgICAgICA9IDB4MjA0OCwKLQlI
SUZfTUlCX0lEX0JFQUNPTl9XQUtFVVBfUEVSSU9EICAgICAgICAgICAgID0gMHgyMDQ5LAotCUhJ
Rl9NSUJfSURfUkNQSV9SU1NJX1RIUkVTSE9MRCAgICAgICAgICAgICAgPSAweDIwNEEsCi0JSElG
X01JQl9JRF9CTE9DS19BQ0tfUE9MSUNZICAgICAgICAgICAgICAgICA9IDB4MjA0QiwKLQlISUZf
TUlCX0lEX09WRVJSSURFX0lOVEVSTkFMX1RYX1JBVEUgICAgICAgID0gMHgyMDRDLAotCUhJRl9N
SUJfSURfU0VUX0FTU09DSUFUSU9OX01PREUgICAgICAgICAgICAgPSAweDIwNEQsCi0JSElGX01J
Ql9JRF9TRVRfVUFQU0RfSU5GT1JNQVRJT04gICAgICAgICAgICA9IDB4MjA0RSwKLQlISUZfTUlC
X0lEX1NFVF9UWF9SQVRFX1JFVFJZX1BPTElDWSAgICAgICAgID0gMHgyMDRGLAotCUhJRl9NSUJf
SURfUFJPVEVDVEVEX01HTVRfUE9MSUNZICAgICAgICAgICAgPSAweDIwNTAsCi0JSElGX01JQl9J
RF9TRVRfSFRfUFJPVEVDVElPTiAgICAgICAgICAgICAgICA9IDB4MjA1MSwKLQlISUZfTUlCX0lE
X0tFRVBfQUxJVkVfUEVSSU9EICAgICAgICAgICAgICAgID0gMHgyMDUyLAotCUhJRl9NSUJfSURf
QVJQX0tFRVBfQUxJVkVfUEVSSU9EICAgICAgICAgICAgPSAweDIwNTMsCi0JSElGX01JQl9JRF9J
TkFDVElWSVRZX1RJTUVSICAgICAgICAgICAgICAgICA9IDB4MjA1NCwKLQlISUZfTUlCX0lEX0lO
VEVSRkFDRV9QUk9URUNUSU9OICAgICAgICAgICAgID0gMHgyMDU1LAotCUhJRl9NSUJfSURfQkVB
Q09OX1NUQVRTICAgICAgICAgICAgICAgICAgICAgPSAweDIwNTYsCi19OwotCi1lbnVtIGhpZl9v
cF9wb3dlcl9tb2RlIHsKLQlISUZfT1BfUE9XRVJfTU9ERV9BQ1RJVkUgICAgPSAweDAsCi0JSElG
X09QX1BPV0VSX01PREVfRE9aRSAgICAgID0gMHgxLAotCUhJRl9PUF9QT1dFUl9NT0RFX1FVSUVT
Q0VOVCA9IDB4MgotfTsKLQotc3RydWN0IGhpZl9taWJfZ2xfb3BlcmF0aW9uYWxfcG93ZXJfbW9k
ZSB7Ci0JdTggICAgIHBvd2VyX21vZGU6NDsKLQl1OCAgICAgcmVzZXJ2ZWQxOjM7Ci0JdTggICAg
IHd1cF9pbmRfYWN0aXZhdGlvbjoxOwotCXU4ICAgICByZXNlcnZlZDJbM107Ci19IF9fcGFja2Vk
OwotCi1zdHJ1Y3QgaGlmX21pYl9nbF9zZXRfbXVsdGlfbXNnIHsKLQl1OCAgICAgZW5hYmxlX211
bHRpX3R4X2NvbmY6MTsKLQl1OCAgICAgcmVzZXJ2ZWQxOjc7Ci0JdTggICAgIHJlc2VydmVkMlsz
XTsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX2FycF9uc19mcmFtZV90cmVhdG1lbnQgewotCUhJ
Rl9BUlBfTlNfRklMVEVSSU5HX0RJU0FCTEUgPSAweDAsCi0JSElGX0FSUF9OU19GSUxURVJJTkdf
RU5BQkxFICA9IDB4MSwKLQlISUZfQVJQX05TX1JFUExZX0VOQUJMRSAgICAgID0gMHgyCi19Owot
Ci1zdHJ1Y3QgaGlmX21pYl9hcnBfaXBfYWRkcl90YWJsZSB7Ci0JdTggICAgIGNvbmRpdGlvbl9p
ZHg7Ci0JdTggICAgIGFycF9lbmFibGU7Ci0JdTggICAgIHJlc2VydmVkWzJdOwotCXU4ICAgICBp
cHY0X2FkZHJlc3NbSElGX0FQSV9JUFY0X0FERFJFU1NfU0laRV07Ci19IF9fcGFja2VkOwotCi1z
dHJ1Y3QgaGlmX21pYl9yeF9maWx0ZXIgewotCXU4ICAgICByZXNlcnZlZDE6MTsKLQl1OCAgICAg
YnNzaWRfZmlsdGVyOjE7Ci0JdTggICAgIHJlc2VydmVkMjoxOwotCXU4ICAgICBmd2RfcHJvYmVf
cmVxOjE7Ci0JdTggICAgIGtlZXBfYWxpdmVfZmlsdGVyOjE7Ci0JdTggICAgIHJlc2VydmVkMzoz
OwotCXU4ICAgICByZXNlcnZlZDRbM107Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3QgaGlmX2llX3Rh
YmxlX2VudHJ5IHsKLQl1OCAgICAgaWVfaWQ7Ci0JdTggICAgIGhhc19jaGFuZ2VkOjE7Ci0JdTgg
ICAgIG5vX2xvbmdlcjoxOwotCXU4ICAgICBoYXNfYXBwZWFyZWQ6MTsKLQl1OCAgICAgcmVzZXJ2
ZWQ6MTsKLQl1OCAgICAgbnVtX21hdGNoX2RhdGE6NDsKLQl1OCAgICAgb3VpWzNdOwotCXU4ICAg
ICBtYXRjaF9kYXRhWzNdOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9taWJfYmNuX2ZpbHRl
cl90YWJsZSB7Ci0JX19sZTMyIG51bV9vZl9pbmZvX2VsbXRzOwotCXN0cnVjdCBoaWZfaWVfdGFi
bGVfZW50cnkgaWVfdGFibGVbXTsKLX0gX19wYWNrZWQ7Ci0KLWVudW0gaGlmX2JlYWNvbl9maWx0
ZXIgewotCUhJRl9CRUFDT05fRklMVEVSX0RJU0FCTEUgID0gMHgwLAotCUhJRl9CRUFDT05fRklM
VEVSX0VOQUJMRSAgID0gMHgxLAotCUhJRl9CRUFDT05fRklMVEVSX0FVVE9fRVJQID0gMHgyCi19
OwotCi1zdHJ1Y3QgaGlmX21pYl9iY25fZmlsdGVyX2VuYWJsZSB7Ci0JX19sZTMyIGVuYWJsZTsK
LQlfX2xlMzIgYmNuX2NvdW50OwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9taWJfZXh0ZW5k
ZWRfY291bnRfdGFibGUgewotCV9fbGUzMiBjb3VudF9kcm9wX3BsY3A7Ci0JX19sZTMyIGNvdW50
X2Ryb3BfZmNzOwotCV9fbGUzMiBjb3VudF90eF9mcmFtZXM7Ci0JX19sZTMyIGNvdW50X3J4X2Zy
YW1lczsKLQlfX2xlMzIgY291bnRfcnhfZnJhbWVzX2ZhaWxlZDsKLQlfX2xlMzIgY291bnRfZHJv
cF9kZWNyeXB0aW9uOwotCV9fbGUzMiBjb3VudF9kcm9wX3RraXBfbWljOwotCV9fbGUzMiBjb3Vu
dF9kcm9wX25vX2tleTsKLQlfX2xlMzIgY291bnRfdHhfZnJhbWVzX211bHRpY2FzdDsKLQlfX2xl
MzIgY291bnRfdHhfZnJhbWVzX3N1Y2Nlc3M7Ci0JX19sZTMyIGNvdW50X3R4X2ZyYW1lc19mYWls
ZWQ7Ci0JX19sZTMyIGNvdW50X3R4X2ZyYW1lc19yZXRyaWVkOwotCV9fbGUzMiBjb3VudF90eF9m
cmFtZXNfbXVsdGlfcmV0cmllZDsKLQlfX2xlMzIgY291bnRfZHJvcF9kdXBsaWNhdGU7Ci0JX19s
ZTMyIGNvdW50X3J0c19zdWNjZXNzOwotCV9fbGUzMiBjb3VudF9ydHNfZmFpbGVkOwotCV9fbGUz
MiBjb3VudF9hY2tfZmFpbGVkOwotCV9fbGUzMiBjb3VudF9yeF9mcmFtZXNfbXVsdGljYXN0Owot
CV9fbGUzMiBjb3VudF9yeF9mcmFtZXNfc3VjY2VzczsKLQlfX2xlMzIgY291bnRfZHJvcF9jbWFj
X2ljdjsKLQlfX2xlMzIgY291bnRfZHJvcF9jbWFjX3JlcGxheTsKLQlfX2xlMzIgY291bnRfZHJv
cF9jY21wX3JlcGxheTsKLQlfX2xlMzIgY291bnRfZHJvcF9iaXBfbWljOwotCV9fbGUzMiBjb3Vu
dF9yeF9iY25fc3VjY2VzczsKLQlfX2xlMzIgY291bnRfcnhfYmNuX21pc3M7Ci0JX19sZTMyIGNv
dW50X3J4X2Jjbl9kdGltOwotCV9fbGUzMiBjb3VudF9yeF9iY25fZHRpbV9haWQwX2NscjsKLQlf
X2xlMzIgY291bnRfcnhfYmNuX2R0aW1fYWlkMF9zZXQ7Ci0JX19sZTMyIHJlc2VydmVkWzEyXTsK
LX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfbWliX2NvdW50X3RhYmxlIHsKLQlfX2xlMzIgY291
bnRfZHJvcF9wbGNwOwotCV9fbGUzMiBjb3VudF9kcm9wX2ZjczsKLQlfX2xlMzIgY291bnRfdHhf
ZnJhbWVzOwotCV9fbGUzMiBjb3VudF9yeF9mcmFtZXM7Ci0JX19sZTMyIGNvdW50X3J4X2ZyYW1l
c19mYWlsZWQ7Ci0JX19sZTMyIGNvdW50X2Ryb3BfZGVjcnlwdGlvbjsKLQlfX2xlMzIgY291bnRf
ZHJvcF90a2lwX21pYzsKLQlfX2xlMzIgY291bnRfZHJvcF9ub19rZXk7Ci0JX19sZTMyIGNvdW50
X3R4X2ZyYW1lc19tdWx0aWNhc3Q7Ci0JX19sZTMyIGNvdW50X3R4X2ZyYW1lc19zdWNjZXNzOwot
CV9fbGUzMiBjb3VudF90eF9mcmFtZXNfZmFpbGVkOwotCV9fbGUzMiBjb3VudF90eF9mcmFtZXNf
cmV0cmllZDsKLQlfX2xlMzIgY291bnRfdHhfZnJhbWVzX211bHRpX3JldHJpZWQ7Ci0JX19sZTMy
IGNvdW50X2Ryb3BfZHVwbGljYXRlOwotCV9fbGUzMiBjb3VudF9ydHNfc3VjY2VzczsKLQlfX2xl
MzIgY291bnRfcnRzX2ZhaWxlZDsKLQlfX2xlMzIgY291bnRfYWNrX2ZhaWxlZDsKLQlfX2xlMzIg
Y291bnRfcnhfZnJhbWVzX211bHRpY2FzdDsKLQlfX2xlMzIgY291bnRfcnhfZnJhbWVzX3N1Y2Nl
c3M7Ci0JX19sZTMyIGNvdW50X2Ryb3BfY21hY19pY3Y7Ci0JX19sZTMyIGNvdW50X2Ryb3BfY21h
Y19yZXBsYXk7Ci0JX19sZTMyIGNvdW50X2Ryb3BfY2NtcF9yZXBsYXk7Ci0JX19sZTMyIGNvdW50
X2Ryb3BfYmlwX21pYzsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfbWliX21hY19hZGRyZXNz
IHsKLQl1OCAgICAgbWFjX2FkZHJbRVRIX0FMRU5dOwotCV9fbGUxNiByZXNlcnZlZDsKLX0gX19w
YWNrZWQ7Ci0KLXN0cnVjdCBoaWZfbWliX3dlcF9kZWZhdWx0X2tleV9pZCB7Ci0JdTggICAgIHdl
cF9kZWZhdWx0X2tleV9pZDsKLQl1OCAgICAgcmVzZXJ2ZWRbM107Ci19IF9fcGFja2VkOwotCi1z
dHJ1Y3QgaGlmX21pYl9kb3QxMV9ydHNfdGhyZXNob2xkIHsKLQlfX2xlMzIgdGhyZXNob2xkOwot
fSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9taWJfc2xvdF90aW1lIHsKLQlfX2xlMzIgc2xvdF90
aW1lOwotfSBfX3BhY2tlZDsKLQotc3RydWN0IGhpZl9taWJfY3VycmVudF90eF9wb3dlcl9sZXZl
bCB7Ci0JX19sZTMyIHBvd2VyX2xldmVsOyAvKiBzaWduZWQgdmFsdWUgKi8KLX0gX19wYWNrZWQ7
Ci0KLXN0cnVjdCBoaWZfbWliX25vbl9lcnBfcHJvdGVjdGlvbiB7Ci0JdTggICAgIHVzZV9jdHNf
dG9fc2VsZjoxOwotCXU4ICAgICByZXNlcnZlZDE6NzsKLQl1OCAgICAgcmVzZXJ2ZWQyWzNdOwot
fSBfX3BhY2tlZDsKLQotZW51bSBoaWZfdG1wbHQgewotCUhJRl9UTVBMVF9QUkJSRVEgPSAweDAs
Ci0JSElGX1RNUExUX0JDTiAgICA9IDB4MSwKLQlISUZfVE1QTFRfTlVMTCAgID0gMHgyLAotCUhJ
Rl9UTVBMVF9RT1NOVUwgPSAweDMsCi0JSElGX1RNUExUX1BTUE9MTCA9IDB4NCwKLQlISUZfVE1Q
TFRfUFJCUkVTID0gMHg1LAotCUhJRl9UTVBMVF9BUlAgICAgPSAweDYsCi0JSElGX1RNUExUX05B
ICAgICA9IDB4NwotfTsKLQotI2RlZmluZSBISUZfQVBJX01BWF9URU1QTEFURV9GUkFNRV9TSVpF
IDcwMAotCi1zdHJ1Y3QgaGlmX21pYl90ZW1wbGF0ZV9mcmFtZSB7Ci0JdTggICAgIGZyYW1lX3R5
cGU7Ci0JdTggICAgIGluaXRfcmF0ZTo3OwotCXU4ICAgICBtb2RlOjE7Ci0JX19sZTE2IGZyYW1l
X2xlbmd0aDsKLQl1OCAgICAgZnJhbWVbXTsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVjdCBoaWZfbWli
X2JlYWNvbl93YWtlX3VwX3BlcmlvZCB7Ci0JdTggICAgIHdha2V1cF9wZXJpb2RfbWluOwotCXU4
ICAgICByZWNlaXZlX2R0aW06MTsKLQl1OCAgICAgcmVzZXJ2ZWQxOjc7Ci0JdTggICAgIHdha2V1
cF9wZXJpb2RfbWF4OwotCXU4ICAgICByZXNlcnZlZDI7Ci19IF9fcGFja2VkOwotCi1zdHJ1Y3Qg
aGlmX21pYl9yY3BpX3Jzc2lfdGhyZXNob2xkIHsKLQl1OCAgICAgZGV0ZWN0aW9uOjE7Ci0JdTgg
ICAgIHJjcGlfcnNzaToxOwotCXU4ICAgICB1cHBlcnRocmVzaDoxOwotCXU4ICAgICBsb3dlcnRo
cmVzaDoxOwotCXU4ICAgICByZXNlcnZlZDo0OwotCXU4ICAgICBsb3dlcl90aHJlc2hvbGQ7Ci0J
dTggICAgIHVwcGVyX3RocmVzaG9sZDsKLQl1OCAgICAgcm9sbGluZ19hdmVyYWdlX2NvdW50Owot
fSBfX3BhY2tlZDsKLQotI2RlZmluZSBERUZBVUxUX0JBX01BWF9SWF9CVUZGRVJfU0laRSAxNgot
Ci1zdHJ1Y3QgaGlmX21pYl9ibG9ja19hY2tfcG9saWN5IHsKLQl1OCAgICAgYmxvY2tfYWNrX3R4
X3RpZF9wb2xpY3k7Ci0JdTggICAgIHJlc2VydmVkMTsKLQl1OCAgICAgYmxvY2tfYWNrX3J4X3Rp
ZF9wb2xpY3k7Ci0JdTggICAgIGJsb2NrX2Fja19yeF9tYXhfYnVmZmVyX3NpemU7Ci19IF9fcGFj
a2VkOwotCi1lbnVtIGhpZl9tcGR1X3N0YXJ0X3NwYWNpbmcgewotCUhJRl9NUERVX1NUQVJUX1NQ
QUNJTkdfTk9fUkVTVFJJQyA9IDB4MCwKLQlISUZfTVBEVV9TVEFSVF9TUEFDSU5HX1FVQVJURVIg
ICAgPSAweDEsCi0JSElGX01QRFVfU1RBUlRfU1BBQ0lOR19IQUxGICAgICAgID0gMHgyLAotCUhJ
Rl9NUERVX1NUQVJUX1NQQUNJTkdfT05FICAgICAgICA9IDB4MywKLQlISUZfTVBEVV9TVEFSVF9T
UEFDSU5HX1RXTyAgICAgICAgPSAweDQsCi0JSElGX01QRFVfU1RBUlRfU1BBQ0lOR19GT1VSICAg
ICAgID0gMHg1LAotCUhJRl9NUERVX1NUQVJUX1NQQUNJTkdfRUlHSFQgICAgICA9IDB4NiwKLQlI
SUZfTVBEVV9TVEFSVF9TUEFDSU5HX1NJWFRFRU4gICAgPSAweDcKLX07Ci0KLXN0cnVjdCBoaWZf
bWliX3NldF9hc3NvY2lhdGlvbl9tb2RlIHsKLQl1OCAgICAgcHJlYW1idHlwZV91c2U6MTsKLQl1
OCAgICAgbW9kZToxOwotCXU4ICAgICByYXRlc2V0OjE7Ci0JdTggICAgIHNwYWNpbmc6MTsKLQl1
OCAgICAgcmVzZXJ2ZWQxOjQ7Ci0JdTggICAgIHNob3J0X3ByZWFtYmxlOjE7Ci0JdTggICAgIHJl
c2VydmVkMjo3OwotCXU4ICAgICBncmVlbmZpZWxkOjE7Ci0JdTggICAgIHJlc2VydmVkMzo3Owot
CXU4ICAgICBtcGR1X3N0YXJ0X3NwYWNpbmc7Ci0JX19sZTMyIGJhc2ljX3JhdGVfc2V0OwotfSBf
X3BhY2tlZDsKLQotc3RydWN0IGhpZl9taWJfc2V0X3VhcHNkX2luZm9ybWF0aW9uIHsKLQl1OCAg
ICAgdHJpZ19iY2tncm5kOjE7Ci0JdTggICAgIHRyaWdfYmU6MTsKLQl1OCAgICAgdHJpZ192aWRl
bzoxOwotCXU4ICAgICB0cmlnX3ZvaWNlOjE7Ci0JdTggICAgIHJlc2VydmVkMTo0OwotCXU4ICAg
ICBkZWxpdl9iY2tncm5kOjE7Ci0JdTggICAgIGRlbGl2X2JlOjE7Ci0JdTggICAgIGRlbGl2X3Zp
ZGVvOjE7Ci0JdTggICAgIGRlbGl2X3ZvaWNlOjE7Ci0JdTggICAgIHJlc2VydmVkMjo0OwotCV9f
bGUxNiBtaW5fYXV0b190cmlnZ2VyX2ludGVydmFsOwotCV9fbGUxNiBtYXhfYXV0b190cmlnZ2Vy
X2ludGVydmFsOwotCV9fbGUxNiBhdXRvX3RyaWdnZXJfc3RlcDsKLX0gX19wYWNrZWQ7Ci0KLXN0
cnVjdCBoaWZfdHhfcmF0ZV9yZXRyeV9wb2xpY3kgewotCXU4ICAgICBwb2xpY3lfaW5kZXg7Ci0J
dTggICAgIHNob3J0X3JldHJ5X2NvdW50OwotCXU4ICAgICBsb25nX3JldHJ5X2NvdW50OwotCXU4
ICAgICBmaXJzdF9yYXRlX3NlbDoyOwotCXU4ICAgICB0ZXJtaW5hdGU6MTsKLQl1OCAgICAgY291
bnRfaW5pdDoxOwotCXU4ICAgICByZXNlcnZlZDE6NDsKLQl1OCAgICAgcmF0ZV9yZWNvdmVyeV9j
b3VudDsKLQl1OCAgICAgcmVzZXJ2ZWQyWzNdOwotCXU4ICAgICByYXRlc1sxMl07Ci19IF9fcGFj
a2VkOwotCi0jZGVmaW5lIEhJRl9UWF9SRVRSWV9QT0xJQ1lfTUFYICAgICAxNQotI2RlZmluZSBI
SUZfVFhfUkVUUllfUE9MSUNZX0lOVkFMSUQgSElGX1RYX1JFVFJZX1BPTElDWV9NQVgKLQotc3Ry
dWN0IGhpZl9taWJfc2V0X3R4X3JhdGVfcmV0cnlfcG9saWN5IHsKLQl1OCAgICAgbnVtX3R4X3Jh
dGVfcG9saWNpZXM7Ci0JdTggICAgIHJlc2VydmVkWzNdOwotCXN0cnVjdCBoaWZfdHhfcmF0ZV9y
ZXRyeV9wb2xpY3kgdHhfcmF0ZV9yZXRyeV9wb2xpY3lbXTsKLX0gX19wYWNrZWQ7Ci0KLXN0cnVj
dCBoaWZfbWliX3Byb3RlY3RlZF9tZ210X3BvbGljeSB7Ci0JdTggICAgIHBtZl9lbmFibGU6MTsK
LQl1OCAgICAgdW5wbWZfYWxsb3dlZDoxOwotCXU4ICAgICBob3N0X2VuY19hdXRoX2ZyYW1lczox
OwotCXU4ICAgICByZXNlcnZlZDE6NTsKLQl1OCAgICAgcmVzZXJ2ZWQyWzNdOwotfSBfX3BhY2tl
ZDsKLQotc3RydWN0IGhpZl9taWJfa2VlcF9hbGl2ZV9wZXJpb2QgewotCV9fbGUxNiBrZWVwX2Fs
aXZlX3BlcmlvZDsKLQl1OCAgICAgcmVzZXJ2ZWRbMl07Ci19IF9fcGFja2VkOwotCi0jZW5kaWYK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3J4LmMgYi9kcml2ZXJzL3N0YWdp
bmcvd2Z4L2hpZl9yeC5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA2OTYzYjU0ZDU1
OTMuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl9yeC5jCisrKyAv
ZGV2L251bGwKQEAgLTEsNDE2ICswLDAgQEAKLS8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wLW9ubHkKLS8qCi0gKiBIYW5kbGluZyBvZiB0aGUgY2hpcC10by1ob3N0IGV2ZW50cyAo
YWthIGluZGljYXRpb25zKSBvZiB0aGUgaGFyZHdhcmUgQVBJLgotICoKLSAqIENvcHlyaWdodCAo
YykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChj
KSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0jaW5jbHVkZSA8bGludXgvc2tidWZmLmg+Ci0jaW5j
bHVkZSA8bGludXgvZXRoZXJkZXZpY2UuaD4KLQotI2luY2x1ZGUgImhpZl9yeC5oIgotI2luY2x1
ZGUgIndmeC5oIgotI2luY2x1ZGUgInNjYW4uaCIKLSNpbmNsdWRlICJiaC5oIgotI2luY2x1ZGUg
InN0YS5oIgotI2luY2x1ZGUgImRhdGFfcnguaCIKLSNpbmNsdWRlICJoaWZfYXBpX2NtZC5oIgot
Ci1zdGF0aWMgaW50IGhpZl9nZW5lcmljX2NvbmZpcm0oc3RydWN0IHdmeF9kZXYgKndkZXYsCi0J
CQkgICAgICAgY29uc3Qgc3RydWN0IGhpZl9tc2cgKmhpZiwgY29uc3Qgdm9pZCAqYnVmKQotewot
CS8qIEFsbCBjb25maXJtIG1lc3NhZ2VzIHN0YXJ0IHdpdGggc3RhdHVzICovCi0JaW50IHN0YXR1
cyA9IGxlMzJfdG9fY3B1cCgoX19sZTMyICopYnVmKTsKLQlpbnQgY21kID0gaGlmLT5pZDsKLQlp
bnQgbGVuID0gbGUxNl90b19jcHUoaGlmLT5sZW4pIC0gNDsgLyogZHJvcCBoZWFkZXIgKi8KLQot
CVdBUk4oIW11dGV4X2lzX2xvY2tlZCgmd2Rldi0+aGlmX2NtZC5sb2NrKSwgImRhdGEgbG9ja2lu
ZyBlcnJvciIpOwotCi0JaWYgKCF3ZGV2LT5oaWZfY21kLmJ1Zl9zZW5kKSB7Ci0JCWRldl93YXJu
KHdkZXYtPmRldiwgInVuZXhwZWN0ZWQgY29uZmlybWF0aW9uOiAweCUuMnhcbiIsIGNtZCk7Ci0J
CXJldHVybiAtRUlOVkFMOwotCX0KLQotCWlmIChjbWQgIT0gd2Rldi0+aGlmX2NtZC5idWZfc2Vu
ZC0+aWQpIHsKLQkJZGV2X3dhcm4od2Rldi0+ZGV2LAotCQkJICJjaGlwIHJlc3BvbnNlIG1pc21h
dGNoIHJlcXVlc3Q6IDB4JS4yeCB2cyAweCUuMnhcbiIsCi0JCQkgY21kLCB3ZGV2LT5oaWZfY21k
LmJ1Zl9zZW5kLT5pZCk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KLQotCWlmICh3ZGV2LT5oaWZf
Y21kLmJ1Zl9yZWN2KSB7Ci0JCWlmICh3ZGV2LT5oaWZfY21kLmxlbl9yZWN2ID49IGxlbiAmJiBs
ZW4gPiAwKQotCQkJbWVtY3B5KHdkZXYtPmhpZl9jbWQuYnVmX3JlY3YsIGJ1ZiwgbGVuKTsKLQkJ
ZWxzZQotCQkJc3RhdHVzID0gLUVJTzsKLQl9Ci0Jd2Rldi0+aGlmX2NtZC5yZXQgPSBzdGF0dXM7
Ci0KLQljb21wbGV0ZSgmd2Rldi0+aGlmX2NtZC5kb25lKTsKLQlyZXR1cm4gc3RhdHVzOwotfQot
Ci1zdGF0aWMgaW50IGhpZl90eF9jb25maXJtKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJICBj
b25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBjb25zdCB2b2lkICpidWYpCi17Ci0JY29uc3Qgc3Ry
dWN0IGhpZl9jbmZfdHggKmJvZHkgPSBidWY7Ci0KLQl3ZnhfdHhfY29uZmlybV9jYih3ZGV2LCBi
b2R5KTsKLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBoaWZfbXVsdGlfdHhfY29uZmlybShz
dHJ1Y3Qgd2Z4X2RldiAqd2RldiwKLQkJCQljb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBjb25z
dCB2b2lkICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGhpZl9jbmZfbXVsdGlfdHJhbnNtaXQgKmJv
ZHkgPSBidWY7Ci0JaW50IGk7Ci0KLQlXQVJOKGJvZHktPm51bV90eF9jb25mcyA8PSAwLCAiY29y
cnVwdGVkIG1lc3NhZ2UiKTsKLQlmb3IgKGkgPSAwOyBpIDwgYm9keS0+bnVtX3R4X2NvbmZzOyBp
KyspCi0JCXdmeF90eF9jb25maXJtX2NiKHdkZXYsICZib2R5LT50eF9jb25mX3BheWxvYWRbaV0p
OwotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IGhpZl9zdGFydHVwX2luZGljYXRpb24oc3Ry
dWN0IHdmeF9kZXYgKndkZXYsCi0JCQkJICBjb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBjb25z
dCB2b2lkICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGhpZl9pbmRfc3RhcnR1cCAqYm9keSA9IGJ1
ZjsKLQotCWlmIChib2R5LT5zdGF0dXMgfHwgYm9keS0+ZmlybXdhcmVfdHlwZSA+IDQpIHsKLQkJ
ZGV2X2Vycih3ZGV2LT5kZXYsICJyZWNlaXZlZCBpbnZhbGlkIHN0YXJ0dXAgaW5kaWNhdGlvbiIp
OwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0JbWVtY3B5KCZ3ZGV2LT5od19jYXBzLCBib2R5LCBz
aXplb2Yoc3RydWN0IGhpZl9pbmRfc3RhcnR1cCkpOwotCWxlMTZfdG9fY3B1cygoX19sZTE2ICop
JndkZXYtPmh3X2NhcHMuaGFyZHdhcmVfaWQpOwotCWxlMTZfdG9fY3B1cygoX19sZTE2ICopJndk
ZXYtPmh3X2NhcHMubnVtX2lucF9jaF9idWZzKTsKLQlsZTE2X3RvX2NwdXMoKF9fbGUxNiAqKSZ3
ZGV2LT5od19jYXBzLnNpemVfaW5wX2NoX2J1Zik7Ci0JbGUzMl90b19jcHVzKChfX2xlMzIgKikm
d2Rldi0+aHdfY2Fwcy5zdXBwb3J0ZWRfcmF0ZV9tYXNrKTsKLQotCWNvbXBsZXRlKCZ3ZGV2LT5m
aXJtd2FyZV9yZWFkeSk7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaGlmX3dha2V1cF9p
bmRpY2F0aW9uKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJCSBjb25zdCBzdHJ1Y3QgaGlmX21z
ZyAqaGlmLCBjb25zdCB2b2lkICpidWYpCi17Ci0JaWYgKCF3ZGV2LT5wZGF0YS5ncGlvX3dha2V1
cCB8fAotCSAgICBncGlvZF9nZXRfdmFsdWUod2Rldi0+cGRhdGEuZ3Bpb193YWtldXApID09IDAp
IHsKLQkJZGV2X3dhcm4od2Rldi0+ZGV2LCAidW5leHBlY3RlZCB3YWtlLXVwIGluZGljYXRpb25c
biIpOwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaGlm
X3JlY2VpdmVfaW5kaWNhdGlvbihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwKLQkJCQkgIGNvbnN0IHN0
cnVjdCBoaWZfbXNnICpoaWYsCi0JCQkJICBjb25zdCB2b2lkICpidWYsIHN0cnVjdCBza19idWZm
ICpza2IpCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSB3ZGV2X3RvX3d2aWYod2RldiwgaGlm
LT5pbnRlcmZhY2UpOwotCWNvbnN0IHN0cnVjdCBoaWZfaW5kX3J4ICpib2R5ID0gYnVmOwotCi0J
aWYgKCF3dmlmKSB7Ci0JCWRldl93YXJuKHdkZXYtPmRldiwgIiVzOiBpZ25vcmUgcnggZGF0YSBm
b3Igbm9uLWV4aXN0ZW50IHZpZiAlZFxuIiwKLQkJCSBfX2Z1bmNfXywgaGlmLT5pbnRlcmZhY2Up
OwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0Jc2tiX3B1bGwoc2tiLCBzaXplb2Yoc3RydWN0IGhpZl9t
c2cpICsgc2l6ZW9mKHN0cnVjdCBoaWZfaW5kX3J4KSk7Ci0Jd2Z4X3J4X2NiKHd2aWYsIGJvZHks
IHNrYik7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBoaWZfZXZlbnRfaW5kaWNhdGlv
bihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwKLQkJCQljb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBj
b25zdCB2b2lkICpidWYpCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSB3ZGV2X3RvX3d2aWYo
d2RldiwgaGlmLT5pbnRlcmZhY2UpOwotCWNvbnN0IHN0cnVjdCBoaWZfaW5kX2V2ZW50ICpib2R5
ID0gYnVmOwotCWludCB0eXBlID0gbGUzMl90b19jcHUoYm9keS0+ZXZlbnRfaWQpOwotCi0JaWYg
KCF3dmlmKSB7Ci0JCWRldl93YXJuKHdkZXYtPmRldiwgIiVzOiByZWNlaXZlZCBldmVudCBmb3Ig
bm9uLWV4aXN0ZW50IHZpZlxuIiwgX19mdW5jX18pOwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0KLQlz
d2l0Y2ggKHR5cGUpIHsKLQljYXNlIEhJRl9FVkVOVF9JTkRfUkNQSV9SU1NJOgotCQl3ZnhfZXZl
bnRfcmVwb3J0X3Jzc2kod3ZpZiwgYm9keS0+ZXZlbnRfZGF0YS5yY3BpX3Jzc2kpOwotCQlicmVh
azsKLQljYXNlIEhJRl9FVkVOVF9JTkRfQlNTTE9TVDoKLQkJc2NoZWR1bGVfZGVsYXllZF93b3Jr
KCZ3dmlmLT5iZWFjb25fbG9zc193b3JrLCAwKTsKLQkJYnJlYWs7Ci0JY2FzZSBISUZfRVZFTlRf
SU5EX0JTU1JFR0FJTkVEOgotCQljYW5jZWxfZGVsYXllZF93b3JrKCZ3dmlmLT5iZWFjb25fbG9z
c193b3JrKTsKLQkJZGV2X2RiZyh3ZGV2LT5kZXYsICJpZ25vcmUgQlNTUkVHQUlORUQgaW5kaWNh
dGlvblxuIik7Ci0JCWJyZWFrOwotCWNhc2UgSElGX0VWRU5UX0lORF9QU19NT0RFX0VSUk9SOgot
CQlkZXZfd2Fybih3ZGV2LT5kZXYsICJlcnJvciB3aGlsZSBwcm9jZXNzaW5nIHBvd2VyIHNhdmUg
cmVxdWVzdDogJWRcbiIsCi0JCQkgbGUzMl90b19jcHUoYm9keS0+ZXZlbnRfZGF0YS5wc19tb2Rl
X2Vycm9yKSk7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCWRldl93YXJuKHdkZXYtPmRldiwgInVu
aGFuZGxlZCBldmVudCBpbmRpY2F0aW9uOiAlLjJ4XG4iLAotCQkJIHR5cGUpOwotCQlicmVhazsK
LQl9Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaGlmX3BtX21vZGVfY29tcGxldGVfaW5k
aWNhdGlvbihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwKLQkJCQkJICAgY29uc3Qgc3RydWN0IGhpZl9t
c2cgKmhpZiwKLQkJCQkJICAgY29uc3Qgdm9pZCAqYnVmKQotewotCXN0cnVjdCB3ZnhfdmlmICp3
dmlmID0gd2Rldl90b193dmlmKHdkZXYsIGhpZi0+aW50ZXJmYWNlKTsKLQotCWlmICghd3ZpZikg
ewotCQlkZXZfd2Fybih3ZGV2LT5kZXYsICIlczogcmVjZWl2ZWQgZXZlbnQgZm9yIG5vbi1leGlz
dGVudCB2aWZcbiIsIF9fZnVuY19fKTsKLQkJcmV0dXJuIC1FSU87Ci0JfQotCWNvbXBsZXRlKCZ3
dmlmLT5zZXRfcG1fbW9kZV9jb21wbGV0ZSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGlu
dCBoaWZfc2Nhbl9jb21wbGV0ZV9pbmRpY2F0aW9uKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJ
CQljb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLAotCQkJCQljb25zdCB2b2lkICpidWYpCi17Ci0J
c3RydWN0IHdmeF92aWYgKnd2aWYgPSB3ZGV2X3RvX3d2aWYod2RldiwgaGlmLT5pbnRlcmZhY2Up
OwotCWNvbnN0IHN0cnVjdCBoaWZfaW5kX3NjYW5fY21wbCAqYm9keSA9IGJ1ZjsKLQotCWlmICgh
d3ZpZikgewotCQlkZXZfd2Fybih3ZGV2LT5kZXYsICIlczogcmVjZWl2ZWQgZXZlbnQgZm9yIG5v
bi1leGlzdGVudCB2aWZcbiIsIF9fZnVuY19fKTsKLQkJcmV0dXJuIC1FSU87Ci0JfQotCi0Jd2Z4
X3NjYW5fY29tcGxldGUod3ZpZiwgYm9keS0+bnVtX2NoYW5uZWxzX2NvbXBsZXRlZCk7Ci0KLQly
ZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBoaWZfam9pbl9jb21wbGV0ZV9pbmRpY2F0aW9uKHN0
cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJCQljb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLAotCQkJ
CQljb25zdCB2b2lkICpidWYpCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSB3ZGV2X3RvX3d2
aWYod2RldiwgaGlmLT5pbnRlcmZhY2UpOwotCi0JaWYgKCF3dmlmKSB7Ci0JCWRldl93YXJuKHdk
ZXYtPmRldiwgIiVzOiByZWNlaXZlZCBldmVudCBmb3Igbm9uLWV4aXN0ZW50IHZpZlxuIiwgX19m
dW5jX18pOwotCQlyZXR1cm4gLUVJTzsKLQl9Ci0JZGV2X3dhcm4od2Rldi0+ZGV2LCAidW5hdHRl
bmRlZCBKb2luQ29tcGxldGVJbmRcbiIpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQg
aGlmX3N1c3BlbmRfcmVzdW1lX2luZGljYXRpb24oc3RydWN0IHdmeF9kZXYgKndkZXYsCi0JCQkJ
CSBjb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLAotCQkJCQkgY29uc3Qgdm9pZCAqYnVmKQotewot
CWNvbnN0IHN0cnVjdCBoaWZfaW5kX3N1c3BlbmRfcmVzdW1lX3R4ICpib2R5ID0gYnVmOwotCXN0
cnVjdCB3ZnhfdmlmICp3dmlmOwotCi0JaWYgKGJvZHktPmJjX21jX29ubHkpIHsKLQkJd3ZpZiA9
IHdkZXZfdG9fd3ZpZih3ZGV2LCBoaWYtPmludGVyZmFjZSk7Ci0JCWlmICghd3ZpZikgewotCQkJ
ZGV2X3dhcm4od2Rldi0+ZGV2LCAiJXM6IHJlY2VpdmVkIGV2ZW50IGZvciBub24tZXhpc3RlbnQg
dmlmXG4iLCBfX2Z1bmNfXyk7Ci0JCQlyZXR1cm4gLUVJTzsKLQkJfQotCQlpZiAoYm9keS0+cmVz
dW1lKQotCQkJd2Z4X3N1c3BlbmRfcmVzdW1lX21jKHd2aWYsIFNUQV9OT1RJRllfQVdBS0UpOwot
CQllbHNlCi0JCQl3Znhfc3VzcGVuZF9yZXN1bWVfbWMod3ZpZiwgU1RBX05PVElGWV9TTEVFUCk7
Ci0JfSBlbHNlIHsKLQkJV0FSTihib2R5LT5wZWVyX3N0YV9zZXQsICJtaXN1bmRlcnN0b29kIGlu
ZGljYXRpb24iKTsKLQkJV0FSTihoaWYtPmludGVyZmFjZSAhPSAyLCAibWlzdW5kZXJzdG9vZCBp
bmRpY2F0aW9uIik7Ci0JCWlmIChib2R5LT5yZXN1bWUpCi0JCQl3Znhfc3VzcGVuZF9ob3RfZGV2
KHdkZXYsIFNUQV9OT1RJRllfQVdBS0UpOwotCQllbHNlCi0JCQl3Znhfc3VzcGVuZF9ob3RfZGV2
KHdkZXYsIFNUQV9OT1RJRllfU0xFRVApOwotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMg
aW50IGhpZl9nZW5lcmljX2luZGljYXRpb24oc3RydWN0IHdmeF9kZXYgKndkZXYsCi0JCQkJICBj
b25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBjb25zdCB2b2lkICpidWYpCi17Ci0JY29uc3Qgc3Ry
dWN0IGhpZl9pbmRfZ2VuZXJpYyAqYm9keSA9IGJ1ZjsKLQlpbnQgdHlwZSA9IGxlMzJfdG9fY3B1
KGJvZHktPnR5cGUpOwotCi0Jc3dpdGNoICh0eXBlKSB7Ci0JY2FzZSBISUZfR0VORVJJQ19JTkRJ
Q0FUSU9OX1RZUEVfUkFXOgotCQlyZXR1cm4gMDsKLQljYXNlIEhJRl9HRU5FUklDX0lORElDQVRJ
T05fVFlQRV9TVFJJTkc6Ci0JCWRldl9pbmZvKHdkZXYtPmRldiwgImZpcm13YXJlIHNheXM6ICVz
XG4iLCAoY2hhciAqKSZib2R5LT5kYXRhKTsKLQkJcmV0dXJuIDA7Ci0JY2FzZSBISUZfR0VORVJJ
Q19JTkRJQ0FUSU9OX1RZUEVfUlhfU1RBVFM6Ci0JCW11dGV4X2xvY2soJndkZXYtPnJ4X3N0YXRz
X2xvY2spOwotCQkvKiBPbGRlciBmaXJtd2FyZSBzZW5kIGEgZ2VuZXJpYyBpbmRpY2F0aW9uIGJl
c2lkZSBSeFN0YXRzICovCi0JCWlmICghd2Z4X2FwaV9vbGRlcl90aGFuKHdkZXYsIDEsIDQpKQot
CQkJZGV2X2luZm8od2Rldi0+ZGV2LCAiUnggdGVzdCBvbmdvaW5nLiBUZW1wZXJhdHVyZTogJWQg
ZGVncmVlcyBDXG4iLAotCQkJCSBib2R5LT5kYXRhLnJ4X3N0YXRzLmN1cnJlbnRfdGVtcCk7Ci0J
CW1lbWNweSgmd2Rldi0+cnhfc3RhdHMsICZib2R5LT5kYXRhLnJ4X3N0YXRzLAotCQkgICAgICAg
c2l6ZW9mKHdkZXYtPnJ4X3N0YXRzKSk7Ci0JCW11dGV4X3VubG9jaygmd2Rldi0+cnhfc3RhdHNf
bG9jayk7Ci0JCXJldHVybiAwOwotCWNhc2UgSElGX0dFTkVSSUNfSU5ESUNBVElPTl9UWVBFX1RY
X1BPV0VSX0xPT1BfSU5GTzoKLQkJbXV0ZXhfbG9jaygmd2Rldi0+dHhfcG93ZXJfbG9vcF9pbmZv
X2xvY2spOwotCQltZW1jcHkoJndkZXYtPnR4X3Bvd2VyX2xvb3BfaW5mbywKLQkJICAgICAgICZi
b2R5LT5kYXRhLnR4X3Bvd2VyX2xvb3BfaW5mbywKLQkJICAgICAgIHNpemVvZih3ZGV2LT50eF9w
b3dlcl9sb29wX2luZm8pKTsKLQkJbXV0ZXhfdW5sb2NrKCZ3ZGV2LT50eF9wb3dlcl9sb29wX2lu
Zm9fbG9jayk7Ci0JCXJldHVybiAwOwotCWRlZmF1bHQ6Ci0JCWRldl9lcnIod2Rldi0+ZGV2LCAi
Z2VuZXJpY19pbmRpY2F0aW9uOiB1bmtub3duIGluZGljYXRpb24gdHlwZTogJSMuOHhcbiIsCi0J
CQl0eXBlKTsKLQkJcmV0dXJuIC1FSU87Ci0JfQotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IHsK
LQlpbnQgdmFsOwotCWNvbnN0IGNoYXIgKnN0cjsKLQlib29sIGhhc19wYXJhbTsKLX0gaGlmX2Vy
cm9yc1tdID0gewotCXsgSElGX0VSUk9SX0ZJUk1XQVJFX1JPTExCQUNLLAotCQkicm9sbGJhY2sg
c3RhdHVzIiB9LAotCXsgSElGX0VSUk9SX0ZJUk1XQVJFX0RFQlVHX0VOQUJMRUQsCi0JCSJkZWJ1
ZyBmZWF0dXJlIGVuYWJsZWQiIH0sCi0JeyBISUZfRVJST1JfUERTX1BBWUxPQUQsCi0JCSJQRFMg
dmVyc2lvbiBpcyBub3Qgc3VwcG9ydGVkIiB9LAotCXsgSElGX0VSUk9SX1BEU19URVNURkVBVFVS
RSwKLQkJIlBEUyBhc2sgZm9yIGFuIHVua25vd24gdGVzdCBtb2RlIiB9LAotCXsgSElGX0VSUk9S
X09PUl9WT0xUQUdFLAotCQkib3V0LW9mLXJhbmdlIHBvd2VyIHN1cHBseSB2b2x0YWdlIiwgdHJ1
ZSB9LAotCXsgSElGX0VSUk9SX09PUl9URU1QRVJBVFVSRSwKLQkJIm91dC1vZi1yYW5nZSB0ZW1w
ZXJhdHVyZSIsIHRydWUgfSwKLQl7IEhJRl9FUlJPUl9TTEtfUkVRX0RVUklOR19LRVlfRVhDSEFO
R0UsCi0JCSJzZWN1cmUgbGluayBkb2VzIG5vdCBleHBlY3QgcmVxdWVzdCBkdXJpbmcga2V5IGV4
Y2hhbmdlIiB9LAotCXsgSElGX0VSUk9SX1NMS19TRVNTSU9OX0tFWSwKLQkJInNlY3VyZSBsaW5r
IHNlc3Npb24ga2V5IGlzIGludmFsaWQiIH0sCi0JeyBISUZfRVJST1JfU0xLX09WRVJGTE9XLAot
CQkic2VjdXJlIGxpbmsgb3ZlcmZsb3ciIH0sCi0JeyBISUZfRVJST1JfU0xLX1dST05HX0VOQ1JZ
UFRJT05fU1RBVEUsCi0JCSJzZWN1cmUgbGluayBtZXNzYWdlcyBsaXN0IGRvZXMgbm90IG1hdGNo
IG1lc3NhZ2UgZW5jcnlwdGlvbiIgfSwKLQl7IEhJRl9FUlJPUl9TTEtfVU5DT05GSUdVUkVELAot
CQkic2VjdXJlIGxpbmsgbm90IHlldCBjb25maWd1cmVkIiB9LAotCXsgSElGX0VSUk9SX0hJRl9C
VVNfRlJFUVVFTkNZX1RPT19MT1csCi0JCSJidXMgY2xvY2sgaXMgdG9vIHNsb3cgKDwxa0h6KSIg
fSwKLQl7IEhJRl9FUlJPUl9ISUZfUlhfREFUQV9UT09fTEFSR0UsCi0JCSJISUYgbWVzc2FnZSB0
b28gbGFyZ2UiIH0sCi0JLyogRm9sbG93aW5nIGVycm9ycyBvbmx5IGV4aXN0cyBpbiBvbGQgZmly
bXdhcmUgdmVyc2lvbnM6ICovCi0JeyBISUZfRVJST1JfSElGX1RYX1FVRVVFX0ZVTEwsCi0JCSJI
SUYgbWVzc2FnZXMgcXVldWUgaXMgZnVsbCIgfSwKLQl7IEhJRl9FUlJPUl9ISUZfQlVTLAotCQki
SElGIGJ1cyIgfSwKLQl7IEhJRl9FUlJPUl9TTEtfTVVMVElfVFhfVU5TVVBQT1JURUQsCi0JCSJz
ZWN1cmUgbGluayBkb2VzIG5vdCBzdXBwb3J0IG11bHRpLXR4IGNvbmZpcm1hdGlvbnMiIH0sCi0J
eyBISUZfRVJST1JfU0xLX09VVERBVEVEX1NFU1NJT05fS0VZLAotCQkic2VjdXJlIGxpbmsgc2Vz
c2lvbiBrZXkgaXMgb3V0ZGF0ZWQiIH0sCi0JeyBISUZfRVJST1JfU0xLX0RFQ1JZUFRJT04sCi0J
CSJzZWN1cmUgbGluayBwYXJhbXMgKG5vbmNlIG9yIHRhZykgbWlzbWF0Y2giIH0sCi19OwotCi1z
dGF0aWMgaW50IGhpZl9lcnJvcl9pbmRpY2F0aW9uKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJ
CWNvbnN0IHN0cnVjdCBoaWZfbXNnICpoaWYsIGNvbnN0IHZvaWQgKmJ1ZikKLXsKLQljb25zdCBz
dHJ1Y3QgaGlmX2luZF9lcnJvciAqYm9keSA9IGJ1ZjsKLQlpbnQgdHlwZSA9IGxlMzJfdG9fY3B1
KGJvZHktPnR5cGUpOwotCWludCBwYXJhbSA9IChzOClib2R5LT5kYXRhWzBdOwotCWludCBpOwot
Ci0JZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoaGlmX2Vycm9ycyk7IGkrKykKLQkJaWYgKHR5
cGUgPT0gaGlmX2Vycm9yc1tpXS52YWwpCi0JCQlicmVhazsKLQlpZiAoaSA8IEFSUkFZX1NJWkUo
aGlmX2Vycm9ycykpCi0JCWlmIChoaWZfZXJyb3JzW2ldLmhhc19wYXJhbSkKLQkJCWRldl9lcnIo
d2Rldi0+ZGV2LCAiYXN5bmNocm9ub3VzIGVycm9yOiAlczogJWRcbiIsCi0JCQkJaGlmX2Vycm9y
c1tpXS5zdHIsIHBhcmFtKTsKLQkJZWxzZQotCQkJZGV2X2Vycih3ZGV2LT5kZXYsICJhc3luY2hy
b25vdXMgZXJyb3I6ICVzXG4iLAotCQkJCWhpZl9lcnJvcnNbaV0uc3RyKTsKLQllbHNlCi0JCWRl
dl9lcnIod2Rldi0+ZGV2LCAiYXN5bmNocm9ub3VzIGVycm9yOiB1bmtub3duOiAlMDh4XG4iLCB0
eXBlKTsKLQlwcmludF9oZXhfZHVtcChLRVJOX0lORk8sICJoaWY6ICIsIERVTVBfUFJFRklYX09G
RlNFVCwKLQkJICAgICAgIDE2LCAxLCBoaWYsIGxlMTZfdG9fY3B1KGhpZi0+bGVuKSwgZmFsc2Up
OwotCXdkZXYtPmNoaXBfZnJvemVuID0gdHJ1ZTsKLQotCXJldHVybiAwOwotfTsKLQotc3RhdGlj
IGludCBoaWZfZXhjZXB0aW9uX2luZGljYXRpb24oc3RydWN0IHdmeF9kZXYgKndkZXYsCi0JCQkJ
ICAgIGNvbnN0IHN0cnVjdCBoaWZfbXNnICpoaWYsIGNvbnN0IHZvaWQgKmJ1ZikKLXsKLQljb25z
dCBzdHJ1Y3QgaGlmX2luZF9leGNlcHRpb24gKmJvZHkgPSBidWY7Ci0JaW50IHR5cGUgPSBsZTMy
X3RvX2NwdShib2R5LT50eXBlKTsKLQotCWlmICh0eXBlID09IDQpCi0JCWRldl9lcnIod2Rldi0+
ZGV2LCAiZmlybXdhcmUgYXNzZXJ0ICVkXG4iLAotCQkJbGUzMl90b19jcHVwKChfX2xlMzIgKili
b2R5LT5kYXRhKSk7Ci0JZWxzZQotCQlkZXZfZXJyKHdkZXYtPmRldiwgImZpcm13YXJlIGV4Y2Vw
dGlvblxuIik7Ci0JcHJpbnRfaGV4X2R1bXAoS0VSTl9JTkZPLCAiaGlmOiAiLCBEVU1QX1BSRUZJ
WF9PRkZTRVQsCi0JCSAgICAgICAxNiwgMSwgaGlmLCBsZTE2X3RvX2NwdShoaWYtPmxlbiksIGZh
bHNlKTsKLQl3ZGV2LT5jaGlwX2Zyb3plbiA9IHRydWU7Ci0KLQlyZXR1cm4gLTE7Ci19Ci0KLXN0
YXRpYyBjb25zdCBzdHJ1Y3QgewotCWludCBtc2dfaWQ7Ci0JaW50ICgqaGFuZGxlcikoc3RydWN0
IHdmeF9kZXYgKndkZXYsCi0JCSAgICAgICBjb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBjb25z
dCB2b2lkICpidWYpOwotfSBoaWZfaGFuZGxlcnNbXSA9IHsKLQkvKiBDb25maXJtYXRpb25zICov
Ci0JeyBISUZfQ05GX0lEX1RYLCAgICAgICAgICAgICAgICAgICBoaWZfdHhfY29uZmlybSB9LAot
CXsgSElGX0NORl9JRF9NVUxUSV9UUkFOU01JVCwgICAgICAgaGlmX211bHRpX3R4X2NvbmZpcm0g
fSwKLQkvKiBJbmRpY2F0aW9ucyAqLwotCXsgSElGX0lORF9JRF9TVEFSVFVQLCAgICAgICAgICAg
ICAgaGlmX3N0YXJ0dXBfaW5kaWNhdGlvbiB9LAotCXsgSElGX0lORF9JRF9XQUtFVVAsICAgICAg
ICAgICAgICAgaGlmX3dha2V1cF9pbmRpY2F0aW9uIH0sCi0JeyBISUZfSU5EX0lEX0pPSU5fQ09N
UExFVEUsICAgICAgICBoaWZfam9pbl9jb21wbGV0ZV9pbmRpY2F0aW9uIH0sCi0JeyBISUZfSU5E
X0lEX1NFVF9QTV9NT0RFX0NNUEwsICAgICBoaWZfcG1fbW9kZV9jb21wbGV0ZV9pbmRpY2F0aW9u
IH0sCi0JeyBISUZfSU5EX0lEX1NDQU5fQ01QTCwgICAgICAgICAgICBoaWZfc2Nhbl9jb21wbGV0
ZV9pbmRpY2F0aW9uIH0sCi0JeyBISUZfSU5EX0lEX1NVU1BFTkRfUkVTVU1FX1RYLCAgICBoaWZf
c3VzcGVuZF9yZXN1bWVfaW5kaWNhdGlvbiB9LAotCXsgSElGX0lORF9JRF9FVkVOVCwgICAgICAg
ICAgICAgICAgaGlmX2V2ZW50X2luZGljYXRpb24gfSwKLQl7IEhJRl9JTkRfSURfR0VORVJJQywg
ICAgICAgICAgICAgIGhpZl9nZW5lcmljX2luZGljYXRpb24gfSwKLQl7IEhJRl9JTkRfSURfRVJS
T1IsICAgICAgICAgICAgICAgIGhpZl9lcnJvcl9pbmRpY2F0aW9uIH0sCi0JeyBISUZfSU5EX0lE
X0VYQ0VQVElPTiwgICAgICAgICAgICBoaWZfZXhjZXB0aW9uX2luZGljYXRpb24gfSwKLQkvKiBG
SVhNRTogYWxsb2NhdGUgc2tiX3AgZnJvbSBoaWZfcmVjZWl2ZV9pbmRpY2F0aW9uIGFuZCBtYWtl
IGl0IGdlbmVyaWMgKi8KLQkvL3sgSElGX0lORF9JRF9SWCwgICAgICAgICAgICAgICAgIGhpZl9y
ZWNlaXZlX2luZGljYXRpb24gfSwKLX07Ci0KLXZvaWQgd2Z4X2hhbmRsZV9yeChzdHJ1Y3Qgd2Z4
X2RldiAqd2Rldiwgc3RydWN0IHNrX2J1ZmYgKnNrYikKLXsKLQlpbnQgaTsKLQljb25zdCBzdHJ1
Y3QgaGlmX21zZyAqaGlmID0gKGNvbnN0IHN0cnVjdCBoaWZfbXNnICopc2tiLT5kYXRhOwotCWlu
dCBoaWZfaWQgPSBoaWYtPmlkOwotCi0JaWYgKGhpZl9pZCA9PSBISUZfSU5EX0lEX1JYKSB7Ci0J
CS8qIGhpZl9yZWNlaXZlX2luZGljYXRpb24gdGFrZSBjYXJlIG9mIHNrYiBsaWZldGltZSAqLwot
CQloaWZfcmVjZWl2ZV9pbmRpY2F0aW9uKHdkZXYsIGhpZiwgaGlmLT5ib2R5LCBza2IpOwotCQly
ZXR1cm47Ci0JfQotCS8qIE5vdGU6IG11dGV4X2lzX2xvY2sgY2F1c2UgYW4gaW1wbGljaXQgbWVt
b3J5IGJhcnJpZXIgdGhhdCBwcm90ZWN0Ci0JICogYnVmX3NlbmQKLQkgKi8KLQlpZiAobXV0ZXhf
aXNfbG9ja2VkKCZ3ZGV2LT5oaWZfY21kLmxvY2spICYmCi0JICAgIHdkZXYtPmhpZl9jbWQuYnVm
X3NlbmQgJiYKLQkgICAgd2Rldi0+aGlmX2NtZC5idWZfc2VuZC0+aWQgPT0gaGlmX2lkKSB7Ci0J
CWhpZl9nZW5lcmljX2NvbmZpcm0od2RldiwgaGlmLCBoaWYtPmJvZHkpOwotCQlnb3RvIGZyZWU7
Ci0JfQotCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGhpZl9oYW5kbGVycyk7IGkrKykgewot
CQlpZiAoaGlmX2hhbmRsZXJzW2ldLm1zZ19pZCA9PSBoaWZfaWQpIHsKLQkJCWlmIChoaWZfaGFu
ZGxlcnNbaV0uaGFuZGxlcikKLQkJCQloaWZfaGFuZGxlcnNbaV0uaGFuZGxlcih3ZGV2LCBoaWYs
IGhpZi0+Ym9keSk7Ci0JCQlnb3RvIGZyZWU7Ci0JCX0KLQl9Ci0JaWYgKGhpZl9pZCAmIDB4ODAp
Ci0JCWRldl9lcnIod2Rldi0+ZGV2LCAidW5zdXBwb3J0ZWQgSElGIGluZGljYXRpb246IElEICUw
MnhcbiIsCi0JCQloaWZfaWQpOwotCWVsc2UKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICJ1bmV4cGVj
dGVkIEhJRiBjb25maXJtYXRpb246IElEICUwMnhcbiIsCi0JCQloaWZfaWQpOwotZnJlZToKLQlk
ZXZfa2ZyZWVfc2tiKHNrYik7Ci19CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hp
Zl9yeC5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfcnguaApkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggOTY1NDNiODFmYTc3Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFn
aW5nL3dmeC9oaWZfcnguaAorKysgL2Rldi9udWxsCkBAIC0xLDE3ICswLDAgQEAKLS8qIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KLS8qCi0gKiBIYW5kbGluZyBvZiB0
aGUgY2hpcC10by1ob3N0IGV2ZW50cyAoYWthIGluZGljYXRpb25zKSBvZiB0aGUgaGFyZHdhcmUg
QVBJLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE5LCBTaWxpY29uIExhYm9yYXRvcmll
cywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICogQ29weXJpZ2h0
IChDKSAyMDEwLCBTVC1Fcmljc3NvbiBTQQotICovCi0jaWZuZGVmIFdGWF9ISUZfUlhfSAotI2Rl
ZmluZSBXRlhfSElGX1JYX0gKLQotc3RydWN0IHdmeF9kZXY7Ci1zdHJ1Y3Qgc2tfYnVmZjsKLQot
dm9pZCB3ZnhfaGFuZGxlX3J4KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tfYnVmZiAq
c2tiKTsKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eC5j
IGIvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfdHguYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMmZkOGJiZDM2ZTI1Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dm
eC9oaWZfdHguYworKysgL2Rldi9udWxsCkBAIC0xLDUxMyArMCwwIEBACi0vLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Ci0vKgotICogSW1wbGVtZW50YXRpb24gb2YgdGhl
IGhvc3QtdG8tY2hpcCBjb21tYW5kcyAoYWthIHJlcXVlc3QvY29uZmlybWF0aW9uKSBvZiB0aGUK
LSAqIGhhcmR3YXJlIEFQSS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNv
biBMYWJvcmF0b3JpZXMsIEluYy4KLSAqIENvcHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24K
LSAqLwotI2luY2x1ZGUgPGxpbnV4L2V0aGVyZGV2aWNlLmg+Ci0KLSNpbmNsdWRlICJoaWZfdHgu
aCIKLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJiaC5oIgotI2luY2x1ZGUgImh3aW8uaCIK
LSNpbmNsdWRlICJkZWJ1Zy5oIgotI2luY2x1ZGUgInN0YS5oIgotCi12b2lkIHdmeF9pbml0X2hp
Zl9jbWQoc3RydWN0IHdmeF9oaWZfY21kICpoaWZfY21kKQotewotCWluaXRfY29tcGxldGlvbigm
aGlmX2NtZC0+cmVhZHkpOwotCWluaXRfY29tcGxldGlvbigmaGlmX2NtZC0+ZG9uZSk7Ci0JbXV0
ZXhfaW5pdCgmaGlmX2NtZC0+bG9jayk7Ci19Ci0KLXN0YXRpYyB2b2lkIHdmeF9maWxsX2hlYWRl
cihzdHJ1Y3QgaGlmX21zZyAqaGlmLCBpbnQgaWZfaWQsCi0JCQkgICAgdW5zaWduZWQgaW50IGNt
ZCwgc2l6ZV90IHNpemUpCi17Ci0JaWYgKGlmX2lkID09IC0xKQotCQlpZl9pZCA9IDI7Ci0KLQlX
QVJOKGNtZCA+IDB4M2YsICJpbnZhbGlkIGhhcmR3YXJlIGNvbW1hbmQgJSMuMngiLCBjbWQpOwot
CVdBUk4oc2l6ZSA+IDB4RkZGLCAicmVxdWVzdGVkIGJ1ZmZlciBpcyB0b28gbGFyZ2U6ICV6dSBi
eXRlcyIsIHNpemUpOwotCVdBUk4oaWZfaWQgPiAweDMsICJpbnZhbGlkIGludGVyZmFjZSBJRCAl
ZCIsIGlmX2lkKTsKLQotCWhpZi0+bGVuID0gY3B1X3RvX2xlMTYoc2l6ZSArIDQpOwotCWhpZi0+
aWQgPSBjbWQ7Ci0JaGlmLT5pbnRlcmZhY2UgPSBpZl9pZDsKLX0KLQotc3RhdGljIHZvaWQgKndm
eF9hbGxvY19oaWYoc2l6ZV90IGJvZHlfbGVuLCBzdHJ1Y3QgaGlmX21zZyAqKmhpZikKLXsKLQkq
aGlmID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGhpZl9tc2cpICsgYm9keV9sZW4sIEdGUF9LRVJO
RUwpOwotCWlmICgqaGlmKQotCQlyZXR1cm4gKCpoaWYpLT5ib2R5OwotCWVsc2UKLQkJcmV0dXJu
IE5VTEw7Ci19Ci0KLWludCB3ZnhfY21kX3NlbmQoc3RydWN0IHdmeF9kZXYgKndkZXYsIHN0cnVj
dCBoaWZfbXNnICpyZXF1ZXN0LAotCQkgdm9pZCAqcmVwbHksIHNpemVfdCByZXBseV9sZW4sIGJv
b2wgbm9fcmVwbHkpCi17Ci0JY29uc3QgY2hhciAqbWliX25hbWUgPSAiIjsKLQljb25zdCBjaGFy
ICptaWJfc2VwID0gIiI7Ci0JaW50IGNtZCA9IHJlcXVlc3QtPmlkOwotCWludCB2aWYgPSByZXF1
ZXN0LT5pbnRlcmZhY2U7Ci0JaW50IHJldDsKLQotCS8qIERvIG5vdCB3YWl0IGZvciBhbnkgcmVw
bHkgaWYgY2hpcCBpcyBmcm96ZW4gKi8KLQlpZiAod2Rldi0+Y2hpcF9mcm96ZW4pCi0JCXJldHVy
biAtRVRJTUVET1VUOwotCi0JbXV0ZXhfbG9jaygmd2Rldi0+aGlmX2NtZC5sb2NrKTsKLQlXQVJO
KHdkZXYtPmhpZl9jbWQuYnVmX3NlbmQsICJkYXRhIGxvY2tpbmcgZXJyb3IiKTsKLQotCS8qIE5v
dGU6IGNhbGwgdG8gY29tcGxldGUoKSBiZWxvdyBoYXMgYW4gaW1wbGljaXQgbWVtb3J5IGJhcnJp
ZXIgdGhhdAotCSAqIGhvcGVmdWxseSBwcm90ZWN0IGJ1Zl9zZW5kCi0JICovCi0Jd2Rldi0+aGlm
X2NtZC5idWZfc2VuZCA9IHJlcXVlc3Q7Ci0Jd2Rldi0+aGlmX2NtZC5idWZfcmVjdiA9IHJlcGx5
OwotCXdkZXYtPmhpZl9jbWQubGVuX3JlY3YgPSByZXBseV9sZW47Ci0JY29tcGxldGUoJndkZXYt
PmhpZl9jbWQucmVhZHkpOwotCi0Jd2Z4X2JoX3JlcXVlc3RfdHgod2Rldik7Ci0KLQlpZiAobm9f
cmVwbHkpIHsKLQkJLyogQ2hpcCB3b24ndCByZXBseS4gR2l2ZSBlbm91Z2ggdGltZSB0byB0aGUg
d3EgdG8gc2VuZCB0aGUKLQkJICogYnVmZmVyLgotCQkgKi8KLQkJbXNsZWVwKDEwMCk7Ci0JCXdk
ZXYtPmhpZl9jbWQuYnVmX3NlbmQgPSBOVUxMOwotCQltdXRleF91bmxvY2soJndkZXYtPmhpZl9j
bWQubG9jayk7Ci0JCXJldHVybiAwOwotCX0KLQotCWlmICh3ZGV2LT5wb2xsX2lycSkKLQkJd2Z4
X2JoX3BvbGxfaXJxKHdkZXYpOwotCi0JcmV0ID0gd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0
KCZ3ZGV2LT5oaWZfY21kLmRvbmUsIDEgKiBIWik7Ci0JaWYgKCFyZXQpIHsKLQkJZGV2X2Vycih3
ZGV2LT5kZXYsICJjaGlwIGlzIGFibm9ybWFsbHkgbG9uZyB0byBhbnN3ZXJcbiIpOwotCQlyZWlu
aXRfY29tcGxldGlvbigmd2Rldi0+aGlmX2NtZC5yZWFkeSk7Ci0JCXJldCA9IHdhaXRfZm9yX2Nv
bXBsZXRpb25fdGltZW91dCgmd2Rldi0+aGlmX2NtZC5kb25lLCAzICogSFopOwotCX0KLQlpZiAo
IXJldCkgewotCQlkZXZfZXJyKHdkZXYtPmRldiwgImNoaXAgZGlkIG5vdCBhbnN3ZXJcbiIpOwot
CQl3ZnhfcGVuZGluZ19kdW1wX29sZF9mcmFtZXMod2RldiwgMzAwMCk7Ci0JCXdkZXYtPmNoaXBf
ZnJvemVuID0gdHJ1ZTsKLQkJcmVpbml0X2NvbXBsZXRpb24oJndkZXYtPmhpZl9jbWQuZG9uZSk7
Ci0JCXJldCA9IC1FVElNRURPVVQ7Ci0JfSBlbHNlIHsKLQkJcmV0ID0gd2Rldi0+aGlmX2NtZC5y
ZXQ7Ci0JfQotCi0Jd2Rldi0+aGlmX2NtZC5idWZfc2VuZCA9IE5VTEw7Ci0JbXV0ZXhfdW5sb2Nr
KCZ3ZGV2LT5oaWZfY21kLmxvY2spOwotCi0JaWYgKHJldCAmJgotCSAgICAoY21kID09IEhJRl9S
RVFfSURfUkVBRF9NSUIgfHwgY21kID09IEhJRl9SRVFfSURfV1JJVEVfTUlCKSkgewotCQltaWJf
bmFtZSA9IGdldF9taWJfbmFtZSgoKHUxNiAqKXJlcXVlc3QpWzJdKTsKLQkJbWliX3NlcCA9ICIv
IjsKLQl9Ci0JaWYgKHJldCA8IDApCi0JCWRldl9lcnIod2Rldi0+ZGV2LCAiaGFyZHdhcmUgcmVx
dWVzdCAlcyVzJXMgKCUjLjJ4KSBvbiB2aWYgJWQgcmV0dXJuZWQgZXJyb3IgJWRcbiIsCi0JCQln
ZXRfaGlmX25hbWUoY21kKSwgbWliX3NlcCwgbWliX25hbWUsIGNtZCwgdmlmLCByZXQpOwotCWlm
IChyZXQgPiAwKQotCQlkZXZfd2Fybih3ZGV2LT5kZXYsICJoYXJkd2FyZSByZXF1ZXN0ICVzJXMl
cyAoJSMuMngpIG9uIHZpZiAlZCByZXR1cm5lZCBzdGF0dXMgJWRcbiIsCi0JCQkgZ2V0X2hpZl9u
YW1lKGNtZCksIG1pYl9zZXAsIG1pYl9uYW1lLCBjbWQsIHZpZiwgcmV0KTsKLQotCXJldHVybiBy
ZXQ7Ci19Ci0KLS8qIFRoaXMgZnVuY3Rpb24gaXMgc3BlY2lhbC4gQWZ0ZXIgSElGX1JFUV9JRF9T
SFVUX0RPV04sIGNoaXAgd29uJ3QgcmVwbHkgdG8gYW55Ci0gKiByZXF1ZXN0IGFueW1vcmUuIE9i
dmlvdXNseSwgb25seSBjYWxsIHRoaXMgZnVuY3Rpb24gZHVyaW5nIGRldmljZSB1bnJlZ2lzdGVy
LgotICovCi1pbnQgaGlmX3NodXRkb3duKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KQotewotCWludCBy
ZXQ7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQotCXdmeF9hbGxvY19oaWYoMCwgJmhpZik7Ci0J
aWYgKCFoaWYpCi0JCXJldHVybiAtRU5PTUVNOwotCXdmeF9maWxsX2hlYWRlcihoaWYsIC0xLCBI
SUZfUkVRX0lEX1NIVVRfRE9XTiwgMCk7Ci0JcmV0ID0gd2Z4X2NtZF9zZW5kKHdkZXYsIGhpZiwg
TlVMTCwgMCwgdHJ1ZSk7Ci0JaWYgKHdkZXYtPnBkYXRhLmdwaW9fd2FrZXVwKQotCQlncGlvZF9z
ZXRfdmFsdWUod2Rldi0+cGRhdGEuZ3Bpb193YWtldXAsIDApOwotCWVsc2UKLQkJY29udHJvbF9y
ZWdfd3JpdGUod2RldiwgMCk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQg
aGlmX2NvbmZpZ3VyYXRpb24oc3RydWN0IHdmeF9kZXYgKndkZXYsIGNvbnN0IHU4ICpjb25mLCBz
aXplX3QgbGVuKQotewotCWludCByZXQ7Ci0Jc2l6ZV90IGJ1Zl9sZW4gPSBzaXplb2Yoc3RydWN0
IGhpZl9yZXFfY29uZmlndXJhdGlvbikgKyBsZW47Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQlz
dHJ1Y3QgaGlmX3JlcV9jb25maWd1cmF0aW9uICpib2R5ID0gd2Z4X2FsbG9jX2hpZihidWZfbGVu
LCAmaGlmKTsKLQotCWlmICghaGlmKQotCQlyZXR1cm4gLUVOT01FTTsKLQlib2R5LT5sZW5ndGgg
PSBjcHVfdG9fbGUxNihsZW4pOwotCW1lbWNweShib2R5LT5wZHNfZGF0YSwgY29uZiwgbGVuKTsK
LQl3ZnhfZmlsbF9oZWFkZXIoaGlmLCAtMSwgSElGX1JFUV9JRF9DT05GSUdVUkFUSU9OLCBidWZf
bGVuKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod2RldiwgaGlmLCBOVUxMLCAwLCBmYWxzZSk7Ci0J
a2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQgaGlmX3Jlc2V0KHN0cnVjdCB3Znhf
dmlmICp3dmlmLCBib29sIHJlc2V0X3N0YXQpCi17Ci0JaW50IHJldDsKLQlzdHJ1Y3QgaGlmX21z
ZyAqaGlmOwotCXN0cnVjdCBoaWZfcmVxX3Jlc2V0ICpib2R5ID0gd2Z4X2FsbG9jX2hpZihzaXpl
b2YoKmJvZHkpLCAmaGlmKTsKLQotCWlmICghaGlmKQotCQlyZXR1cm4gLUVOT01FTTsKLQlib2R5
LT5yZXNldF9zdGF0ID0gcmVzZXRfc3RhdDsKLQl3ZnhfZmlsbF9oZWFkZXIoaGlmLCB3dmlmLT5p
ZCwgSElGX1JFUV9JRF9SRVNFVCwgc2l6ZW9mKCpib2R5KSk7Ci0JcmV0ID0gd2Z4X2NtZF9zZW5k
KHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOwotCWtmcmVlKGhpZik7Ci0JcmV0dXJu
IHJldDsKLX0KLQotaW50IGhpZl9yZWFkX21pYihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHZp
Zl9pZCwgdTE2IG1pYl9pZCwKLQkJIHZvaWQgKnZhbCwgc2l6ZV90IHZhbF9sZW4pCi17Ci0JaW50
IHJldDsKLQlzdHJ1Y3QgaGlmX21zZyAqaGlmOwotCWludCBidWZfbGVuID0gc2l6ZW9mKHN0cnVj
dCBoaWZfY25mX3JlYWRfbWliKSArIHZhbF9sZW47Ci0Jc3RydWN0IGhpZl9yZXFfcmVhZF9taWIg
KmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOwotCXN0cnVjdCBoaWZf
Y25mX3JlYWRfbWliICpyZXBseSA9IGttYWxsb2MoYnVmX2xlbiwgR0ZQX0tFUk5FTCk7Ci0KLQlp
ZiAoIWJvZHkgfHwgIXJlcGx5KSB7Ci0JCXJldCA9IC1FTk9NRU07Ci0JCWdvdG8gb3V0OwotCX0K
LQlib2R5LT5taWJfaWQgPSBjcHVfdG9fbGUxNihtaWJfaWQpOwotCXdmeF9maWxsX2hlYWRlciho
aWYsIHZpZl9pZCwgSElGX1JFUV9JRF9SRUFEX01JQiwgc2l6ZW9mKCpib2R5KSk7Ci0JcmV0ID0g
d2Z4X2NtZF9zZW5kKHdkZXYsIGhpZiwgcmVwbHksIGJ1Zl9sZW4sIGZhbHNlKTsKLQotCWlmICgh
cmV0ICYmIG1pYl9pZCAhPSBsZTE2X3RvX2NwdShyZXBseS0+bWliX2lkKSkgewotCQlkZXZfd2Fy
bih3ZGV2LT5kZXYsICIlczogY29uZmlybWF0aW9uIG1pc21hdGNoIHJlcXVlc3RcbiIsCi0JCQkg
X19mdW5jX18pOwotCQlyZXQgPSAtRUlPOwotCX0KLQlpZiAocmV0ID09IC1FTk9NRU0pCi0JCWRl
dl9lcnIod2Rldi0+ZGV2LCAiYnVmZmVyIGlzIHRvbyBzbWFsbCB0byByZWNlaXZlICVzICglenUg
PCAlZClcbiIsCi0JCQlnZXRfbWliX25hbWUobWliX2lkKSwgdmFsX2xlbiwKLQkJCWxlMTZfdG9f
Y3B1KHJlcGx5LT5sZW5ndGgpKTsKLQlpZiAoIXJldCkKLQkJbWVtY3B5KHZhbCwgJnJlcGx5LT5t
aWJfZGF0YSwgbGUxNl90b19jcHUocmVwbHktPmxlbmd0aCkpOwotCWVsc2UKLQkJbWVtc2V0KHZh
bCwgMHhGRiwgdmFsX2xlbik7Ci1vdXQ6Ci0Ja2ZyZWUoaGlmKTsKLQlrZnJlZShyZXBseSk7Ci0J
cmV0dXJuIHJldDsKLX0KLQotaW50IGhpZl93cml0ZV9taWIoc3RydWN0IHdmeF9kZXYgKndkZXYs
IGludCB2aWZfaWQsIHUxNiBtaWJfaWQsCi0JCSAgdm9pZCAqdmFsLCBzaXplX3QgdmFsX2xlbikK
LXsKLQlpbnQgcmV0OwotCXN0cnVjdCBoaWZfbXNnICpoaWY7Ci0JaW50IGJ1Zl9sZW4gPSBzaXpl
b2Yoc3RydWN0IGhpZl9yZXFfd3JpdGVfbWliKSArIHZhbF9sZW47Ci0Jc3RydWN0IGhpZl9yZXFf
d3JpdGVfbWliICpib2R5ID0gd2Z4X2FsbG9jX2hpZihidWZfbGVuLCAmaGlmKTsKLQotCWlmICgh
aGlmKQotCQlyZXR1cm4gLUVOT01FTTsKLQlib2R5LT5taWJfaWQgPSBjcHVfdG9fbGUxNihtaWJf
aWQpOwotCWJvZHktPmxlbmd0aCA9IGNwdV90b19sZTE2KHZhbF9sZW4pOwotCW1lbWNweSgmYm9k
eS0+bWliX2RhdGEsIHZhbCwgdmFsX2xlbik7Ci0Jd2Z4X2ZpbGxfaGVhZGVyKGhpZiwgdmlmX2lk
LCBISUZfUkVRX0lEX1dSSVRFX01JQiwgYnVmX2xlbik7Ci0JcmV0ID0gd2Z4X2NtZF9zZW5kKHdk
ZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOwotCWtmcmVlKGhpZik7Ci0JcmV0dXJuIHJldDsKLX0K
LQotaW50IGhpZl9zY2FuKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgY2ZnODAyMTFfc2Nh
bl9yZXF1ZXN0ICpyZXEsCi0JICAgICBpbnQgY2hhbl9zdGFydF9pZHgsIGludCBjaGFuX251bSkK
LXsKLQlpbnQgcmV0LCBpOwotCXN0cnVjdCBoaWZfbXNnICpoaWY7Ci0Jc2l6ZV90IGJ1Zl9sZW4g
PQotCQlzaXplb2Yoc3RydWN0IGhpZl9yZXFfc3RhcnRfc2Nhbl9hbHQpICsgY2hhbl9udW0gKiBz
aXplb2YodTgpOwotCXN0cnVjdCBoaWZfcmVxX3N0YXJ0X3NjYW5fYWx0ICpib2R5ID0gd2Z4X2Fs
bG9jX2hpZihidWZfbGVuLCAmaGlmKTsKLQotCVdBUk4oY2hhbl9udW0gPiBISUZfQVBJX01BWF9O
Ql9DSEFOTkVMUywgImludmFsaWQgcGFyYW1zIik7Ci0JV0FSTihyZXEtPm5fc3NpZHMgPiBISUZf
QVBJX01BWF9OQl9TU0lEUywgImludmFsaWQgcGFyYW1zIik7Ci0KLQlpZiAoIWhpZikKLQkJcmV0
dXJuIC1FTk9NRU07Ci0JZm9yIChpID0gMDsgaSA8IHJlcS0+bl9zc2lkczsgaSsrKSB7Ci0JCW1l
bWNweShib2R5LT5zc2lkX2RlZltpXS5zc2lkLCByZXEtPnNzaWRzW2ldLnNzaWQsCi0JCSAgICAg
ICBJRUVFODAyMTFfTUFYX1NTSURfTEVOKTsKLQkJYm9keS0+c3NpZF9kZWZbaV0uc3NpZF9sZW5n
dGggPQotCQkJY3B1X3RvX2xlMzIocmVxLT5zc2lkc1tpXS5zc2lkX2xlbik7Ci0JfQotCWJvZHkt
Pm51bV9vZl9zc2lkcyA9IEhJRl9BUElfTUFYX05CX1NTSURTOwotCWJvZHktPm1haW50YWluX2N1
cnJlbnRfYnNzID0gMTsKLQlib2R5LT5kaXNhbGxvd19wcyA9IDE7Ci0JYm9keS0+dHhfcG93ZXJf
bGV2ZWwgPQotCQljcHVfdG9fbGUzMihyZXEtPmNoYW5uZWxzW2NoYW5fc3RhcnRfaWR4XS0+bWF4
X3Bvd2VyKTsKLQlib2R5LT5udW1fb2ZfY2hhbm5lbHMgPSBjaGFuX251bTsKLQlmb3IgKGkgPSAw
OyBpIDwgY2hhbl9udW07IGkrKykKLQkJYm9keS0+Y2hhbm5lbF9saXN0W2ldID0KLQkJCXJlcS0+
Y2hhbm5lbHNbaSArIGNoYW5fc3RhcnRfaWR4XS0+aHdfdmFsdWU7Ci0JaWYgKHJlcS0+bm9fY2Nr
KQotCQlib2R5LT5tYXhfdHJhbnNtaXRfcmF0ZSA9IEFQSV9SQVRFX0lOREVYX0dfNk1CUFM7Ci0J
ZWxzZQotCQlib2R5LT5tYXhfdHJhbnNtaXRfcmF0ZSA9IEFQSV9SQVRFX0lOREVYX0JfMU1CUFM7
Ci0JaWYgKHJlcS0+Y2hhbm5lbHNbY2hhbl9zdGFydF9pZHhdLT5mbGFncyAmIElFRUU4MDIxMV9D
SEFOX05PX0lSKSB7Ci0JCWJvZHktPm1pbl9jaGFubmVsX3RpbWUgPSBjcHVfdG9fbGUzMig1MCk7
Ci0JCWJvZHktPm1heF9jaGFubmVsX3RpbWUgPSBjcHVfdG9fbGUzMigxNTApOwotCX0gZWxzZSB7
Ci0JCWJvZHktPm1pbl9jaGFubmVsX3RpbWUgPSBjcHVfdG9fbGUzMigxMCk7Ci0JCWJvZHktPm1h
eF9jaGFubmVsX3RpbWUgPSBjcHVfdG9fbGUzMig1MCk7Ci0JCWJvZHktPm51bV9vZl9wcm9iZV9y
ZXF1ZXN0cyA9IDI7Ci0JCWJvZHktPnByb2JlX2RlbGF5ID0gMTAwOwotCX0KLQotCXdmeF9maWxs
X2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZfUkVRX0lEX1NUQVJUX1NDQU4sIGJ1Zl9sZW4pOwot
CXJldCA9IHdmeF9jbWRfc2VuZCh3dmlmLT53ZGV2LCBoaWYsIE5VTEwsIDAsIGZhbHNlKTsKLQlr
ZnJlZShoaWYpOwotCXJldHVybiByZXQ7Ci19Ci0KLWludCBoaWZfc3RvcF9zY2FuKHN0cnVjdCB3
ZnhfdmlmICp3dmlmKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQkvKiBi
b2R5IGFzc29jaWF0ZWQgdG8gSElGX1JFUV9JRF9TVE9QX1NDQU4gaXMgZW1wdHkgKi8KLQl3Znhf
YWxsb2NfaGlmKDAsICZoaWYpOwotCi0JaWYgKCFoaWYpCi0JCXJldHVybiAtRU5PTUVNOwotCXdm
eF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZfUkVRX0lEX1NUT1BfU0NBTiwgMCk7Ci0J
cmV0ID0gd2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOwotCWtm
cmVlKGhpZik7Ci0JcmV0dXJuIHJldDsKLX0KLQotaW50IGhpZl9qb2luKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX2Jzc19jb25mICpjb25mLAotCSAgICAgc3Ry
dWN0IGllZWU4MDIxMV9jaGFubmVsICpjaGFubmVsLCBjb25zdCB1OCAqc3NpZCwgaW50IHNzaWRs
ZW4pCi17Ci0JaW50IHJldDsKLQlzdHJ1Y3QgaGlmX21zZyAqaGlmOwotCXN0cnVjdCBoaWZfcmVx
X2pvaW4gKmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOwotCi0JV0FS
Tl9PTighY29uZi0+YmVhY29uX2ludCk7Ci0JV0FSTl9PTighY29uZi0+YmFzaWNfcmF0ZXMpOwot
CVdBUk5fT04oc2l6ZW9mKGJvZHktPnNzaWQpIDwgc3NpZGxlbik7Ci0JV0FSTighY29uZi0+aWJz
c19qb2luZWQgJiYgIXNzaWRsZW4sICJqb2luaW5nIGFuIHVua25vd24gQlNTIik7Ci0JaWYgKCFo
aWYpCi0JCXJldHVybiAtRU5PTUVNOwotCWJvZHktPmluZnJhc3RydWN0dXJlX2Jzc19tb2RlID0g
IWNvbmYtPmlic3Nfam9pbmVkOwotCWJvZHktPnNob3J0X3ByZWFtYmxlID0gY29uZi0+dXNlX3No
b3J0X3ByZWFtYmxlOwotCWJvZHktPnByb2JlX2Zvcl9qb2luID0gIShjaGFubmVsLT5mbGFncyAm
IElFRUU4MDIxMV9DSEFOX05PX0lSKTsKLQlib2R5LT5jaGFubmVsX251bWJlciA9IGNoYW5uZWwt
Pmh3X3ZhbHVlOwotCWJvZHktPmJlYWNvbl9pbnRlcnZhbCA9IGNwdV90b19sZTMyKGNvbmYtPmJl
YWNvbl9pbnQpOwotCWJvZHktPmJhc2ljX3JhdGVfc2V0ID0KLQkJY3B1X3RvX2xlMzIod2Z4X3Jh
dGVfbWFza190b19odyh3dmlmLT53ZGV2LCBjb25mLT5iYXNpY19yYXRlcykpOwotCW1lbWNweShi
b2R5LT5ic3NpZCwgY29uZi0+YnNzaWQsIHNpemVvZihib2R5LT5ic3NpZCkpOwotCWlmIChzc2lk
KSB7Ci0JCWJvZHktPnNzaWRfbGVuZ3RoID0gY3B1X3RvX2xlMzIoc3NpZGxlbik7Ci0JCW1lbWNw
eShib2R5LT5zc2lkLCBzc2lkLCBzc2lkbGVuKTsKLQl9Ci0Jd2Z4X2ZpbGxfaGVhZGVyKGhpZiwg
d3ZpZi0+aWQsIEhJRl9SRVFfSURfSk9JTiwgc2l6ZW9mKCpib2R5KSk7Ci0JcmV0ID0gd2Z4X2Nt
ZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2UpOwotCWtmcmVlKGhpZik7Ci0J
cmV0dXJuIHJldDsKLX0KLQotaW50IGhpZl9zZXRfYnNzX3BhcmFtcyhzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwgaW50IGFpZCwgaW50IGJlYWNvbl9sb3N0X2NvdW50KQotewotCWludCByZXQ7Ci0Jc3Ry
dWN0IGhpZl9tc2cgKmhpZjsKLQlzdHJ1Y3QgaGlmX3JlcV9zZXRfYnNzX3BhcmFtcyAqYm9keSA9
Ci0JCXdmeF9hbGxvY19oaWYoc2l6ZW9mKCpib2R5KSwgJmhpZik7Ci0KLQlpZiAoIWhpZikKLQkJ
cmV0dXJuIC1FTk9NRU07Ci0JYm9keS0+YWlkID0gY3B1X3RvX2xlMTYoYWlkKTsKLQlib2R5LT5i
ZWFjb25fbG9zdF9jb3VudCA9IGJlYWNvbl9sb3N0X2NvdW50OwotCXdmeF9maWxsX2hlYWRlciho
aWYsIHd2aWYtPmlkLCBISUZfUkVRX0lEX1NFVF9CU1NfUEFSQU1TLAotCQkJc2l6ZW9mKCpib2R5
KSk7Ci0JcmV0ID0gd2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwgZmFsc2Up
OwotCWtmcmVlKGhpZik7Ci0JcmV0dXJuIHJldDsKLX0KLQotaW50IGhpZl9hZGRfa2V5KHN0cnVj
dCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCBzdHJ1Y3QgaGlmX3JlcV9hZGRfa2V5ICphcmcpCi17Ci0J
aW50IHJldDsKLQlzdHJ1Y3QgaGlmX21zZyAqaGlmOwotCS8qIEZJWE1FOiBvbmx5IHNlbmQgbmVj
ZXNzYXJ5IGJpdHMgKi8KLQlzdHJ1Y3QgaGlmX3JlcV9hZGRfa2V5ICpib2R5ID0gd2Z4X2FsbG9j
X2hpZihzaXplb2YoKmJvZHkpLCAmaGlmKTsKLQotCWlmICghaGlmKQotCQlyZXR1cm4gLUVOT01F
TTsKLQkvKiBGSVhNRTogc3dhcCBieXRlcyBhcyBuZWNlc3NhcnkgaW4gYm9keSAqLwotCW1lbWNw
eShib2R5LCBhcmcsIHNpemVvZigqYm9keSkpOwotCWlmICh3ZnhfYXBpX29sZGVyX3RoYW4od2Rl
diwgMSwgNSkpCi0JCS8qIExlZ2FjeSBmaXJtd2FyZXMgZXhwZWN0IHRoYXQgYWRkX2tleSB0byBi
ZSBzZW50IG9uIHJpZ2h0Ci0JCSAqIGludGVyZmFjZS4KLQkJICovCi0JCXdmeF9maWxsX2hlYWRl
cihoaWYsIGFyZy0+aW50X2lkLCBISUZfUkVRX0lEX0FERF9LRVksCi0JCQkJc2l6ZW9mKCpib2R5
KSk7Ci0JZWxzZQotCQl3ZnhfZmlsbF9oZWFkZXIoaGlmLCAtMSwgSElGX1JFUV9JRF9BRERfS0VZ
LCBzaXplb2YoKmJvZHkpKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod2RldiwgaGlmLCBOVUxMLCAw
LCBmYWxzZSk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQgaGlmX3JlbW92
ZV9rZXkoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBpZHgpCi17Ci0JaW50IHJldDsKLQlzdHJ1
Y3QgaGlmX21zZyAqaGlmOwotCXN0cnVjdCBoaWZfcmVxX3JlbW92ZV9rZXkgKmJvZHkgPSB3Znhf
YWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOwotCi0JaWYgKCFoaWYpCi0JCXJldHVybiAt
RU5PTUVNOwotCWJvZHktPmVudHJ5X2luZGV4ID0gaWR4OwotCXdmeF9maWxsX2hlYWRlcihoaWYs
IC0xLCBISUZfUkVRX0lEX1JFTU9WRV9LRVksIHNpemVvZigqYm9keSkpOwotCXJldCA9IHdmeF9j
bWRfc2VuZCh3ZGV2LCBoaWYsIE5VTEwsIDAsIGZhbHNlKTsKLQlrZnJlZShoaWYpOwotCXJldHVy
biByZXQ7Ci19Ci0KLWludCBoaWZfc2V0X2VkY2FfcXVldWVfcGFyYW1zKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCB1MTYgcXVldWUsCi0JCQkgICAgICBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX3R4X3F1
ZXVlX3BhcmFtcyAqYXJnKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQlz
dHJ1Y3QgaGlmX3JlcV9lZGNhX3F1ZXVlX3BhcmFtcyAqYm9keSA9IHdmeF9hbGxvY19oaWYoc2l6
ZW9mKCpib2R5KSwKLQkJCQkJCQkgICAgICAgJmhpZik7Ci0KLQlpZiAoIWJvZHkpCi0JCXJldHVy
biAtRU5PTUVNOwotCi0JV0FSTl9PTihhcmctPmFpZnMgPiAyNTUpOwotCWlmICghaGlmKQotCQly
ZXR1cm4gLUVOT01FTTsKLQlib2R5LT5haWZzbiA9IGFyZy0+YWlmczsKLQlib2R5LT5jd19taW4g
PSBjcHVfdG9fbGUxNihhcmctPmN3X21pbik7Ci0JYm9keS0+Y3dfbWF4ID0gY3B1X3RvX2xlMTYo
YXJnLT5jd19tYXgpOwotCWJvZHktPnR4X29wX2xpbWl0ID0gY3B1X3RvX2xlMTYoYXJnLT50eG9w
ICogVVNFQ19QRVJfVFhPUCk7Ci0JYm9keS0+cXVldWVfaWQgPSAzIC0gcXVldWU7Ci0JLyogQVBJ
IDIuMCBoYXMgY2hhbmdlZCBxdWV1ZSBJRHMgdmFsdWVzICovCi0JaWYgKHdmeF9hcGlfb2xkZXJf
dGhhbih3dmlmLT53ZGV2LCAyLCAwKSAmJiBxdWV1ZSA9PSBJRUVFODAyMTFfQUNfQkUpCi0JCWJv
ZHktPnF1ZXVlX2lkID0gSElGX1FVRVVFX0lEX0JBQ0tHUk9VTkQ7Ci0JaWYgKHdmeF9hcGlfb2xk
ZXJfdGhhbih3dmlmLT53ZGV2LCAyLCAwKSAmJiBxdWV1ZSA9PSBJRUVFODAyMTFfQUNfQkspCi0J
CWJvZHktPnF1ZXVlX2lkID0gSElGX1FVRVVFX0lEX0JFU1RFRkZPUlQ7Ci0Jd2Z4X2ZpbGxfaGVh
ZGVyKGhpZiwgd3ZpZi0+aWQsIEhJRl9SRVFfSURfRURDQV9RVUVVRV9QQVJBTVMsCi0JCQlzaXpl
b2YoKmJvZHkpKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod3ZpZi0+d2RldiwgaGlmLCBOVUxMLCAw
LCBmYWxzZSk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQgaGlmX3NldF9w
bShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBwcywgaW50IGR5bmFtaWNfcHNfdGltZW91dCkK
LXsKLQlpbnQgcmV0OwotCXN0cnVjdCBoaWZfbXNnICpoaWY7Ci0Jc3RydWN0IGhpZl9yZXFfc2V0
X3BtX21vZGUgKmJvZHkgPSB3ZnhfYWxsb2NfaGlmKHNpemVvZigqYm9keSksICZoaWYpOwotCi0J
aWYgKCFib2R5KQotCQlyZXR1cm4gLUVOT01FTTsKLQotCWlmICghaGlmKQotCQlyZXR1cm4gLUVO
T01FTTsKLQlpZiAocHMpIHsKLQkJYm9keS0+ZW50ZXJfcHNtID0gMTsKLQkJLyogRmlybXdhcmUg
ZG9lcyBub3Qgc3VwcG9ydCBtb3JlIHRoYW4gMTI4bXMgKi8KLQkJYm9keS0+ZmFzdF9wc21faWRs
ZV9wZXJpb2QgPSBtaW4oZHluYW1pY19wc190aW1lb3V0ICogMiwgMjU1KTsKLQkJaWYgKGJvZHkt
PmZhc3RfcHNtX2lkbGVfcGVyaW9kKQotCQkJYm9keS0+ZmFzdF9wc20gPSAxOwotCX0KLQl3Znhf
ZmlsbF9oZWFkZXIoaGlmLCB3dmlmLT5pZCwgSElGX1JFUV9JRF9TRVRfUE1fTU9ERSwgc2l6ZW9m
KCpib2R5KSk7Ci0JcmV0ID0gd2Z4X2NtZF9zZW5kKHd2aWYtPndkZXYsIGhpZiwgTlVMTCwgMCwg
ZmFsc2UpOwotCWtmcmVlKGhpZik7Ci0JcmV0dXJuIHJldDsKLX0KLQotaW50IGhpZl9zdGFydChz
dHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgY29uc3Qgc3RydWN0IGllZWU4MDIxMV9ic3NfY29uZiAqY29u
ZiwKLQkgICAgICBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKmNoYW5uZWwpCi17Ci0J
aW50IHJldDsKLQlzdHJ1Y3QgaGlmX21zZyAqaGlmOwotCXN0cnVjdCBoaWZfcmVxX3N0YXJ0ICpi
b2R5ID0gd2Z4X2FsbG9jX2hpZihzaXplb2YoKmJvZHkpLCAmaGlmKTsKLQotCVdBUk5fT04oIWNv
bmYtPmJlYWNvbl9pbnQpOwotCWlmICghaGlmKQotCQlyZXR1cm4gLUVOT01FTTsKLQlib2R5LT5k
dGltX3BlcmlvZCA9IGNvbmYtPmR0aW1fcGVyaW9kOwotCWJvZHktPnNob3J0X3ByZWFtYmxlID0g
Y29uZi0+dXNlX3Nob3J0X3ByZWFtYmxlOwotCWJvZHktPmNoYW5uZWxfbnVtYmVyID0gY2hhbm5l
bC0+aHdfdmFsdWU7Ci0JYm9keS0+YmVhY29uX2ludGVydmFsID0gY3B1X3RvX2xlMzIoY29uZi0+
YmVhY29uX2ludCk7Ci0JYm9keS0+YmFzaWNfcmF0ZV9zZXQgPQotCQljcHVfdG9fbGUzMih3Znhf
cmF0ZV9tYXNrX3RvX2h3KHd2aWYtPndkZXYsIGNvbmYtPmJhc2ljX3JhdGVzKSk7Ci0JYm9keS0+
c3NpZF9sZW5ndGggPSBjb25mLT5zc2lkX2xlbjsKLQltZW1jcHkoYm9keS0+c3NpZCwgY29uZi0+
c3NpZCwgY29uZi0+c3NpZF9sZW4pOwotCXdmeF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBI
SUZfUkVRX0lEX1NUQVJULCBzaXplb2YoKmJvZHkpKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod3Zp
Zi0+d2RldiwgaGlmLCBOVUxMLCAwLCBmYWxzZSk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0
OwotfQotCi1pbnQgaGlmX2JlYWNvbl90cmFuc21pdChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9v
bCBlbmFibGUpCi17Ci0JaW50IHJldDsKLQlzdHJ1Y3QgaGlmX21zZyAqaGlmOwotCXN0cnVjdCBo
aWZfcmVxX2JlYWNvbl90cmFuc21pdCAqYm9keSA9IHdmeF9hbGxvY19oaWYoc2l6ZW9mKCpib2R5
KSwKLQkJCQkJCQkgICAgICZoaWYpOwotCi0JaWYgKCFoaWYpCi0JCXJldHVybiAtRU5PTUVNOwot
CWJvZHktPmVuYWJsZV9iZWFjb25pbmcgPSBlbmFibGUgPyAxIDogMDsKLQl3ZnhfZmlsbF9oZWFk
ZXIoaGlmLCB3dmlmLT5pZCwgSElGX1JFUV9JRF9CRUFDT05fVFJBTlNNSVQsCi0JCQlzaXplb2Yo
KmJvZHkpKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod3ZpZi0+d2RldiwgaGlmLCBOVUxMLCAwLCBm
YWxzZSk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQgaGlmX21hcF9saW5r
KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIHVubWFwLCB1OCAqbWFjX2FkZHIsIGludCBzdGFf
aWQsIGJvb2wgbWZwKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQlzdHJ1
Y3QgaGlmX3JlcV9tYXBfbGluayAqYm9keSA9IHdmeF9hbGxvY19oaWYoc2l6ZW9mKCpib2R5KSwg
JmhpZik7Ci0KLQlpZiAoIWhpZikKLQkJcmV0dXJuIC1FTk9NRU07Ci0JaWYgKG1hY19hZGRyKQot
CQlldGhlcl9hZGRyX2NvcHkoYm9keS0+bWFjX2FkZHIsIG1hY19hZGRyKTsKLQlib2R5LT5tZnBj
ID0gbWZwID8gMSA6IDA7Ci0JYm9keS0+dW5tYXAgPSB1bm1hcCA/IDEgOiAwOwotCWJvZHktPnBl
ZXJfc3RhX2lkID0gc3RhX2lkOwotCXdmeF9maWxsX2hlYWRlcihoaWYsIHd2aWYtPmlkLCBISUZf
UkVRX0lEX01BUF9MSU5LLCBzaXplb2YoKmJvZHkpKTsKLQlyZXQgPSB3ZnhfY21kX3NlbmQod3Zp
Zi0+d2RldiwgaGlmLCBOVUxMLCAwLCBmYWxzZSk7Ci0Ja2ZyZWUoaGlmKTsKLQlyZXR1cm4gcmV0
OwotfQotCi1pbnQgaGlmX3VwZGF0ZV9pZV9iZWFjb24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGNv
bnN0IHU4ICppZXMsIHNpemVfdCBpZXNfbGVuKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhpZl9t
c2cgKmhpZjsKLQlpbnQgYnVmX2xlbiA9IHNpemVvZihzdHJ1Y3QgaGlmX3JlcV91cGRhdGVfaWUp
ICsgaWVzX2xlbjsKLQlzdHJ1Y3QgaGlmX3JlcV91cGRhdGVfaWUgKmJvZHkgPSB3ZnhfYWxsb2Nf
aGlmKGJ1Zl9sZW4sICZoaWYpOwotCi0JaWYgKCFoaWYpCi0JCXJldHVybiAtRU5PTUVNOwotCWJv
ZHktPmJlYWNvbiA9IDE7Ci0JYm9keS0+bnVtX2llcyA9IGNwdV90b19sZTE2KDEpOwotCW1lbWNw
eShib2R5LT5pZSwgaWVzLCBpZXNfbGVuKTsKLQl3ZnhfZmlsbF9oZWFkZXIoaGlmLCB3dmlmLT5p
ZCwgSElGX1JFUV9JRF9VUERBVEVfSUUsIGJ1Zl9sZW4pOwotCXJldCA9IHdmeF9jbWRfc2VuZCh3
dmlmLT53ZGV2LCBoaWYsIE5VTEwsIDAsIGZhbHNlKTsKLQlrZnJlZShoaWYpOwotCXJldHVybiBy
ZXQ7Ci19CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eC5oIGIvZHJpdmVy
cy9zdGFnaW5nL3dmeC9oaWZfdHguaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggZTU3
ZWFiZGNmYTc3Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfdHgu
aAorKysgL2Rldi9udWxsCkBAIC0xLDYwICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wLW9ubHkgKi8KLS8qCi0gKiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgaG9zdC10
by1jaGlwIGNvbW1hbmRzIChha2EgcmVxdWVzdC9jb25maXJtYXRpb24pIG9mIHRoZQotICogaGFy
ZHdhcmUgQVBJLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9y
YXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICogQ29w
eXJpZ2h0IChDKSAyMDEwLCBTVC1Fcmljc3NvbiBTQQotICovCi0jaWZuZGVmIFdGWF9ISUZfVFhf
SAotI2RlZmluZSBXRlhfSElGX1RYX0gKLQotc3RydWN0IGllZWU4MDIxMV9jaGFubmVsOwotc3Ry
dWN0IGllZWU4MDIxMV9ic3NfY29uZjsKLXN0cnVjdCBpZWVlODAyMTFfdHhfcXVldWVfcGFyYW1z
Owotc3RydWN0IGNmZzgwMjExX3NjYW5fcmVxdWVzdDsKLXN0cnVjdCBoaWZfcmVxX2FkZF9rZXk7
Ci1zdHJ1Y3Qgd2Z4X2RldjsKLXN0cnVjdCB3ZnhfdmlmOwotCi1zdHJ1Y3Qgd2Z4X2hpZl9jbWQg
ewotCXN0cnVjdCBtdXRleCAgICAgIGxvY2s7Ci0Jc3RydWN0IGNvbXBsZXRpb24gcmVhZHk7Ci0J
c3RydWN0IGNvbXBsZXRpb24gZG9uZTsKLQlzdHJ1Y3QgaGlmX21zZyAgICAqYnVmX3NlbmQ7Ci0J
dm9pZCAgICAgICAgICAgICAgKmJ1Zl9yZWN2OwotCXNpemVfdCAgICAgICAgICAgIGxlbl9yZWN2
OwotCWludCAgICAgICAgICAgICAgIHJldDsKLX07Ci0KLXZvaWQgd2Z4X2luaXRfaGlmX2NtZChz
dHJ1Y3Qgd2Z4X2hpZl9jbWQgKndmeF9oaWZfY21kKTsKLWludCB3ZnhfY21kX3NlbmQoc3RydWN0
IHdmeF9kZXYgKndkZXYsIHN0cnVjdCBoaWZfbXNnICpyZXF1ZXN0LAotCQkgdm9pZCAqcmVwbHks
IHNpemVfdCByZXBseV9sZW4sIGJvb2wgYXN5bmMpOwotCi1pbnQgaGlmX3NodXRkb3duKHN0cnVj
dCB3ZnhfZGV2ICp3ZGV2KTsKLWludCBoaWZfY29uZmlndXJhdGlvbihzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiwgY29uc3QgdTggKmNvbmYsIHNpemVfdCBsZW4pOwotaW50IGhpZl9yZXNldChzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwgYm9vbCByZXNldF9zdGF0KTsKLWludCBoaWZfcmVhZF9taWIoc3RydWN0
IHdmeF9kZXYgKndkZXYsIGludCB2aWZfaWQsIHUxNiBtaWJfaWQsCi0JCSB2b2lkICpidWYsIHNp
emVfdCBidWZfc2l6ZSk7Ci1pbnQgaGlmX3dyaXRlX21pYihzdHJ1Y3Qgd2Z4X2RldiAqd2Rldiwg
aW50IHZpZl9pZCwgdTE2IG1pYl9pZCwKLQkJICB2b2lkICpidWYsIHNpemVfdCBidWZfc2l6ZSk7
Ci1pbnQgaGlmX3NjYW4oc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBjZmc4MDIxMV9zY2Fu
X3JlcXVlc3QgKnJlcTgwMjExLAotCSAgICAgaW50IGNoYW5fc3RhcnQsIGludCBjaGFuX251bSk7
Ci1pbnQgaGlmX3N0b3Bfc2NhbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZik7Ci1pbnQgaGlmX2pvaW4o
c3RydWN0IHdmeF92aWYgKnd2aWYsIGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfYnNzX2NvbmYgKmNv
bmYsCi0JICAgICBzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKmNoYW5uZWwsIGNvbnN0IHU4ICpz
c2lkLCBpbnQgc3NpZGxlbik7Ci1pbnQgaGlmX3NldF9wbShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwg
Ym9vbCBwcywgaW50IGR5bmFtaWNfcHNfdGltZW91dCk7Ci1pbnQgaGlmX3NldF9ic3NfcGFyYW1z
KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgYWlkLCBpbnQgYmVhY29uX2xvc3RfY291bnQpOwot
aW50IGhpZl9hZGRfa2V5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCBzdHJ1Y3QgaGlmX3Jl
cV9hZGRfa2V5ICphcmcpOwotaW50IGhpZl9yZW1vdmVfa2V5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2
LCBpbnQgaWR4KTsKLWludCBoaWZfc2V0X2VkY2FfcXVldWVfcGFyYW1zKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCB1MTYgcXVldWUsCi0JCQkgICAgICBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX3R4X3F1
ZXVlX3BhcmFtcyAqYXJnKTsKLWludCBoaWZfc3RhcnQoc3RydWN0IHdmeF92aWYgKnd2aWYsIGNv
bnN0IHN0cnVjdCBpZWVlODAyMTFfYnNzX2NvbmYgKmNvbmYsCi0JICAgICAgY29uc3Qgc3RydWN0
IGllZWU4MDIxMV9jaGFubmVsICpjaGFubmVsKTsKLWludCBoaWZfYmVhY29uX3RyYW5zbWl0KHN0
cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGVuYWJsZSk7Ci1pbnQgaGlmX21hcF9saW5rKHN0cnVj
dCB3ZnhfdmlmICp3dmlmLAotCQkgYm9vbCB1bm1hcCwgdTggKm1hY19hZGRyLCBpbnQgc3RhX2lk
LCBib29sIG1mcCk7Ci1pbnQgaGlmX3VwZGF0ZV9pZV9iZWFjb24oc3RydWN0IHdmeF92aWYgKnd2
aWYsIGNvbnN0IHU4ICppZXMsIHNpemVfdCBpZXNfbGVuKTsKLQotI2VuZGlmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuYyBiL2RyaXZlcnMvc3RhZ2luZy93Zngv
aGlmX3R4X21pYi5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA5N2U5NjFlNmJjZjYu
LjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuYworKysg
L2Rldi9udWxsCkBAIC0xLDMyNCArMCwwIEBACi0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5Ci0vKgotICogSW1wbGVtZW50YXRpb24gb2YgdGhlIGhvc3QtdG8tY2hpcCBN
SUJzIG9mIHRoZSBoYXJkd2FyZSBBUEkuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAs
IFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVy
aWNzc29uCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTAsIFNULUVyaWNzc29uIFNBCi0gKi8KLQotI2lu
Y2x1ZGUgPGxpbnV4L2V0aGVyZGV2aWNlLmg+Ci0KLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRl
ICJoaWZfdHguaCIKLSNpbmNsdWRlICJoaWZfdHhfbWliLmgiCi0jaW5jbHVkZSAiaGlmX2FwaV9t
aWIuaCIKLQotaW50IGhpZl9zZXRfb3V0cHV0X3Bvd2VyKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBp
bnQgdmFsKQotewotCXN0cnVjdCBoaWZfbWliX2N1cnJlbnRfdHhfcG93ZXJfbGV2ZWwgYXJnID0g
ewotCQkucG93ZXJfbGV2ZWwgPSBjcHVfdG9fbGUzMih2YWwgKiAxMCksCi0JfTsKLQotCXJldHVy
biBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lE
X0NVUlJFTlRfVFhfUE9XRVJfTEVWRUwsCi0JCQkgICAgICZhcmcsIHNpemVvZihhcmcpKTsKLX0K
LQotaW50IGhpZl9zZXRfYmVhY29uX3dha2V1cF9wZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYs
Ci0JCQkJIHVuc2lnbmVkIGludCBkdGltX2ludGVydmFsLAotCQkJCSB1bnNpZ25lZCBpbnQgbGlz
dGVuX2ludGVydmFsKQotewotCXN0cnVjdCBoaWZfbWliX2JlYWNvbl93YWtlX3VwX3BlcmlvZCBh
cmcgPSB7Ci0JCS53YWtldXBfcGVyaW9kX21pbiA9IGR0aW1faW50ZXJ2YWwsCi0JCS5yZWNlaXZl
X2R0aW0gPSAwLAotCQkud2FrZXVwX3BlcmlvZF9tYXggPSBsaXN0ZW5faW50ZXJ2YWwsCi0JfTsK
LQotCWlmIChkdGltX2ludGVydmFsID4gMHhGRiB8fCBsaXN0ZW5faW50ZXJ2YWwgPiAweEZGRkYp
Ci0JCXJldHVybiAtRUlOVkFMOwotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2
aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lEX0JFQUNPTl9XQUtFVVBfUEVSSU9ELAotCQkJICAg
ICAmYXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLWludCBoaWZfc2V0X3JjcGlfcnNzaV90aHJlc2hv
bGQoc3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkJaW50IHJzc2lfdGhvbGQsIGludCByc3NpX2h5
c3QpCi17Ci0Jc3RydWN0IGhpZl9taWJfcmNwaV9yc3NpX3RocmVzaG9sZCBhcmcgPSB7Ci0JCS5y
b2xsaW5nX2F2ZXJhZ2VfY291bnQgPSA4LAotCQkuZGV0ZWN0aW9uID0gMSwKLQl9OwotCi0JaWYg
KCFyc3NpX3Rob2xkICYmICFyc3NpX2h5c3QpIHsKLQkJYXJnLnVwcGVydGhyZXNoID0gMTsKLQkJ
YXJnLmxvd2VydGhyZXNoID0gMTsKLQl9IGVsc2UgewotCQlhcmcudXBwZXJfdGhyZXNob2xkID0g
cnNzaV90aG9sZCArIHJzc2lfaHlzdDsKLQkJYXJnLnVwcGVyX3RocmVzaG9sZCA9IChhcmcudXBw
ZXJfdGhyZXNob2xkICsgMTEwKSAqIDI7Ci0JCWFyZy5sb3dlcl90aHJlc2hvbGQgPSByc3NpX3Ro
b2xkOwotCQlhcmcubG93ZXJfdGhyZXNob2xkID0gKGFyZy5sb3dlcl90aHJlc2hvbGQgKyAxMTAp
ICogMjsKLQl9Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwK
LQkJCSAgICAgSElGX01JQl9JRF9SQ1BJX1JTU0lfVEhSRVNIT0xELCAmYXJnLCBzaXplb2YoYXJn
KSk7Ci19Ci0KLWludCBoaWZfZ2V0X2NvdW50ZXJzX3RhYmxlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2
LCBpbnQgdmlmX2lkLAotCQkJICAgc3RydWN0IGhpZl9taWJfZXh0ZW5kZWRfY291bnRfdGFibGUg
KmFyZykKLXsKLQlpZiAod2Z4X2FwaV9vbGRlcl90aGFuKHdkZXYsIDEsIDMpKSB7Ci0JCS8qIGV4
dGVuZGVkX2NvdW50X3RhYmxlIGlzIHdpZGVyIHRoYW4gY291bnRfdGFibGUgKi8KLQkJbWVtc2V0
KGFyZywgMHhGRiwgc2l6ZW9mKCphcmcpKTsKLQkJcmV0dXJuIGhpZl9yZWFkX21pYih3ZGV2LCB2
aWZfaWQsIEhJRl9NSUJfSURfQ09VTlRFUlNfVEFCTEUsCi0JCQkJICAgIGFyZywgc2l6ZW9mKHN0
cnVjdCBoaWZfbWliX2NvdW50X3RhYmxlKSk7Ci0JfSBlbHNlIHsKLQkJcmV0dXJuIGhpZl9yZWFk
X21pYih3ZGV2LCB2aWZfaWQsCi0JCQkJICAgIEhJRl9NSUJfSURfRVhURU5ERURfQ09VTlRFUlNf
VEFCTEUsIGFyZywKLQkJCQkgICAgc2l6ZW9mKHN0cnVjdCBoaWZfbWliX2V4dGVuZGVkX2NvdW50
X3RhYmxlKSk7Ci0JfQotfQotCi1pbnQgaGlmX3NldF9tYWNhZGRyKHN0cnVjdCB3ZnhfdmlmICp3
dmlmLCB1OCAqbWFjKQotewotCXN0cnVjdCBoaWZfbWliX21hY19hZGRyZXNzIGFyZyA9IHsgfTsK
LQotCWlmIChtYWMpCi0JCWV0aGVyX2FkZHJfY29weShhcmcubWFjX2FkZHIsIG1hYyk7Ci0JcmV0
dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsIEhJRl9NSUJfSURfRE9UMTFf
TUFDX0FERFJFU1MsCi0JCQkgICAgICZhcmcsIHNpemVvZihhcmcpKTsKLX0KLQotaW50IGhpZl9z
ZXRfcnhfZmlsdGVyKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAotCQkgICAgICBib29sIGZpbHRlcl9i
c3NpZCwgYm9vbCBmaWx0ZXJfcHJicmVxKQotewotCXN0cnVjdCBoaWZfbWliX3J4X2ZpbHRlciBh
cmcgPSB7IH07Ci0KLQlpZiAoZmlsdGVyX2Jzc2lkKQotCQlhcmcuYnNzaWRfZmlsdGVyID0gMTsK
LQlpZiAoIWZpbHRlcl9wcmJyZXEpCi0JCWFyZy5md2RfcHJvYmVfcmVxID0gMTsKLQlyZXR1cm4g
aGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9SWF9GSUxURVIs
Ci0JCQkgICAgICZhcmcsIHNpemVvZihhcmcpKTsKLX0KLQotaW50IGhpZl9zZXRfYmVhY29uX2Zp
bHRlcl90YWJsZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHRibF9sZW4sCi0JCQkJY29uc3Qg
c3RydWN0IGhpZl9pZV90YWJsZV9lbnRyeSAqdGJsKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhp
Zl9taWJfYmNuX2ZpbHRlcl90YWJsZSAqYXJnOwotCWludCBidWZfbGVuID0gc3RydWN0X3NpemUo
YXJnLCBpZV90YWJsZSwgdGJsX2xlbik7Ci0KLQlhcmcgPSBremFsbG9jKGJ1Zl9sZW4sIEdGUF9L
RVJORUwpOwotCWlmICghYXJnKQotCQlyZXR1cm4gLUVOT01FTTsKLQlhcmctPm51bV9vZl9pbmZv
X2VsbXRzID0gY3B1X3RvX2xlMzIodGJsX2xlbik7Ci0JbWVtY3B5KGFyZy0+aWVfdGFibGUsIHRi
bCwgZmxleF9hcnJheV9zaXplKGFyZywgaWVfdGFibGUsIHRibF9sZW4pKTsKLQlyZXQgPSBoaWZf
d3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgIEhJRl9NSUJfSURfQkVBQ09O
X0ZJTFRFUl9UQUJMRSwgYXJnLCBidWZfbGVuKTsKLQlrZnJlZShhcmcpOwotCXJldHVybiByZXQ7
Ci19Ci0KLWludCBoaWZfYmVhY29uX2ZpbHRlcl9jb250cm9sKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LAotCQkJICAgICAgaW50IGVuYWJsZSwgaW50IGJlYWNvbl9jb3VudCkKLXsKLQlzdHJ1Y3QgaGlm
X21pYl9iY25fZmlsdGVyX2VuYWJsZSBhcmcgPSB7Ci0JCS5lbmFibGUgPSBjcHVfdG9fbGUzMihl
bmFibGUpLAotCQkuYmNuX2NvdW50ID0gY3B1X3RvX2xlMzIoYmVhY29uX2NvdW50KSwKLQl9Owot
CXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBISUZf
TUlCX0lEX0JFQUNPTl9GSUxURVJfRU5BQkxFLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7
Ci19Ci0KLWludCBoaWZfc2V0X29wZXJhdGlvbmFsX21vZGUoc3RydWN0IHdmeF9kZXYgKndkZXYs
IGVudW0gaGlmX29wX3Bvd2VyX21vZGUgbW9kZSkKLXsKLQlzdHJ1Y3QgaGlmX21pYl9nbF9vcGVy
YXRpb25hbF9wb3dlcl9tb2RlIGFyZyA9IHsKLQkJLnBvd2VyX21vZGUgPSBtb2RlLAotCQkud3Vw
X2luZF9hY3RpdmF0aW9uID0gMSwKLQl9OwotCi0JcmV0dXJuIGhpZl93cml0ZV9taWIod2Rldiwg
LTEsIEhJRl9NSUJfSURfR0xfT1BFUkFUSU9OQUxfUE9XRVJfTU9ERSwKLQkJCSAgICAgJmFyZywg
c2l6ZW9mKGFyZykpOwotfQotCi1pbnQgaGlmX3NldF90ZW1wbGF0ZV9mcmFtZShzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKLQkJCSAgIHU4IGZyYW1lX3R5cGUsIGlu
dCBpbml0X3JhdGUpCi17Ci0Jc3RydWN0IGhpZl9taWJfdGVtcGxhdGVfZnJhbWUgKmFyZzsKLQot
CVdBUk4oc2tiLT5sZW4gPiBISUZfQVBJX01BWF9URU1QTEFURV9GUkFNRV9TSVpFLCAiZnJhbWUg
aXMgdG9vIGJpZyIpOwotCXNrYl9wdXNoKHNrYiwgNCk7Ci0JYXJnID0gKHN0cnVjdCBoaWZfbWli
X3RlbXBsYXRlX2ZyYW1lICopc2tiLT5kYXRhOwotCXNrYl9wdWxsKHNrYiwgNCk7Ci0JYXJnLT5p
bml0X3JhdGUgPSBpbml0X3JhdGU7Ci0JYXJnLT5mcmFtZV90eXBlID0gZnJhbWVfdHlwZTsKLQlh
cmctPmZyYW1lX2xlbmd0aCA9IGNwdV90b19sZTE2KHNrYi0+bGVuKTsKLQlyZXR1cm4gaGlmX3dy
aXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9URU1QTEFURV9GUkFNRSwK
LQkJCSAgICAgYXJnLCBzaXplb2YoKmFyZykgKyBza2ItPmxlbik7Ci19Ci0KLWludCBoaWZfc2V0
X21mcChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBjYXBhYmxlLCBib29sIHJlcXVpcmVkKQot
ewotCXN0cnVjdCBoaWZfbWliX3Byb3RlY3RlZF9tZ210X3BvbGljeSBhcmcgPSB7IH07Ci0KLQlX
QVJOKHJlcXVpcmVkICYmICFjYXBhYmxlLCAiaW5jb2hlcmVudCBhcmd1bWVudHMiKTsKLQlpZiAo
Y2FwYWJsZSkgewotCQlhcmcucG1mX2VuYWJsZSA9IDE7Ci0JCWFyZy5ob3N0X2VuY19hdXRoX2Zy
YW1lcyA9IDE7Ci0JfQotCWlmICghcmVxdWlyZWQpCi0JCWFyZy51bnBtZl9hbGxvd2VkID0gMTsK
LQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKLQkJCSAgICAgSElG
X01JQl9JRF9QUk9URUNURURfTUdNVF9QT0xJQ1ksCi0JCQkgICAgICZhcmcsIHNpemVvZihhcmcp
KTsKLX0KLQotaW50IGhpZl9zZXRfYmxvY2tfYWNrX3BvbGljeShzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwKLQkJCSAgICAgdTggdHhfdGlkX3BvbGljeSwgdTggcnhfdGlkX3BvbGljeSkKLXsKLQlzdHJ1
Y3QgaGlmX21pYl9ibG9ja19hY2tfcG9saWN5IGFyZyA9IHsKLQkJLmJsb2NrX2Fja190eF90aWRf
cG9saWN5ID0gdHhfdGlkX3BvbGljeSwKLQkJLmJsb2NrX2Fja19yeF90aWRfcG9saWN5ID0gcnhf
dGlkX3BvbGljeSwKLQl9OwotCi0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3Zp
Zi0+aWQsIEhJRl9NSUJfSURfQkxPQ0tfQUNLX1BPTElDWSwKLQkJCSAgICAgJmFyZywgc2l6ZW9m
KGFyZykpOwotfQotCi1pbnQgaGlmX3NldF9hc3NvY2lhdGlvbl9tb2RlKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCBpbnQgYW1wZHVfZGVuc2l0eSwKLQkJCSAgICAgYm9vbCBncmVlbmZpZWxkLCBib29s
IHNob3J0X3ByZWFtYmxlKQotewotCXN0cnVjdCBoaWZfbWliX3NldF9hc3NvY2lhdGlvbl9tb2Rl
IGFyZyA9IHsKLQkJLnByZWFtYnR5cGVfdXNlID0gMSwKLQkJLm1vZGUgPSAxLAotCQkuc3BhY2lu
ZyA9IDEsCi0JCS5zaG9ydF9wcmVhbWJsZSA9IHNob3J0X3ByZWFtYmxlLAotCQkuZ3JlZW5maWVs
ZCA9IGdyZWVuZmllbGQsCi0JCS5tcGR1X3N0YXJ0X3NwYWNpbmcgPSBhbXBkdV9kZW5zaXR5LAot
CX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKLQkJCSAg
ICAgSElGX01JQl9JRF9TRVRfQVNTT0NJQVRJT05fTU9ERSwgJmFyZywgc2l6ZW9mKGFyZykpOwot
fQotCi1pbnQgaGlmX3NldF90eF9yYXRlX3JldHJ5X3BvbGljeShzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwKLQkJCQkgaW50IHBvbGljeV9pbmRleCwgdTggKnJhdGVzKQotewotCXN0cnVjdCBoaWZfbWli
X3NldF90eF9yYXRlX3JldHJ5X3BvbGljeSAqYXJnOwotCXNpemVfdCBzaXplID0gc3RydWN0X3Np
emUoYXJnLCB0eF9yYXRlX3JldHJ5X3BvbGljeSwgMSk7Ci0JaW50IHJldDsKLQotCWFyZyA9IGt6
YWxsb2Moc2l6ZSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFhcmcpCi0JCXJldHVybiAtRU5PTUVNOwot
CWFyZy0+bnVtX3R4X3JhdGVfcG9saWNpZXMgPSAxOwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xp
Y3lbMF0ucG9saWN5X2luZGV4ID0gcG9saWN5X2luZGV4OwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9w
b2xpY3lbMF0uc2hvcnRfcmV0cnlfY291bnQgPSAyNTU7Ci0JYXJnLT50eF9yYXRlX3JldHJ5X3Bv
bGljeVswXS5sb25nX3JldHJ5X2NvdW50ID0gMjU1OwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xp
Y3lbMF0uZmlyc3RfcmF0ZV9zZWwgPSAxOwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0u
dGVybWluYXRlID0gMTsKLQlhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBdLmNvdW50X2luaXQg
PSAxOwotCW1lbWNweSgmYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5yYXRlcywgcmF0ZXMs
Ci0JICAgICAgIHNpemVvZihhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBdLnJhdGVzKSk7Ci0J
cmV0ID0gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKLQkJCSAgICBISUZfTUlC
X0lEX1NFVF9UWF9SQVRFX1JFVFJZX1BPTElDWSwgYXJnLCBzaXplKTsKLQlrZnJlZShhcmcpOwot
CXJldHVybiByZXQ7Ci19Ci0KLWludCBoaWZfa2VlcF9hbGl2ZV9wZXJpb2Qoc3RydWN0IHdmeF92
aWYgKnd2aWYsIGludCBwZXJpb2QpCi17Ci0Jc3RydWN0IGhpZl9taWJfa2VlcF9hbGl2ZV9wZXJp
b2QgYXJnID0gewotCQkua2VlcF9hbGl2ZV9wZXJpb2QgPSBjcHVfdG9fbGUxNihwZXJpb2QpLAot
CX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01J
Ql9JRF9LRUVQX0FMSVZFX1BFUklPRCwKLQkJCSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOwotfTsK
LQotaW50IGhpZl9zZXRfYXJwX2lwdjRfZmlsdGVyKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQg
aWR4LCBfX2JlMzIgKmFkZHIpCi17Ci0Jc3RydWN0IGhpZl9taWJfYXJwX2lwX2FkZHJfdGFibGUg
YXJnID0gewotCQkuY29uZGl0aW9uX2lkeCA9IGlkeCwKLQkJLmFycF9lbmFibGUgPSBISUZfQVJQ
X05TX0ZJTFRFUklOR19ESVNBQkxFLAotCX07Ci0KLQlpZiAoYWRkcikgewotCQkvKiBDYXV0aW9u
OiB0eXBlIG9mIGFkZHIgaXMgX19iZTMyICovCi0JCW1lbWNweShhcmcuaXB2NF9hZGRyZXNzLCBh
ZGRyLCBzaXplb2YoYXJnLmlwdjRfYWRkcmVzcykpOwotCQlhcmcuYXJwX2VuYWJsZSA9IEhJRl9B
UlBfTlNfRklMVEVSSU5HX0VOQUJMRTsKLQl9Ci0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+
d2Rldiwgd3ZpZi0+aWQsCi0JCQkgICAgIEhJRl9NSUJfSURfQVJQX0lQX0FERFJFU1NFU19UQUJM
RSwKLQkJCSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOwotfQotCi1pbnQgaGlmX3VzZV9tdWx0aV90
eF9jb25mKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBib29sIGVuYWJsZSkKLXsKLQlzdHJ1Y3QgaGlm
X21pYl9nbF9zZXRfbXVsdGlfbXNnIGFyZyA9IHsKLQkJLmVuYWJsZV9tdWx0aV90eF9jb25mID0g
ZW5hYmxlLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3ZGV2LCAtMSwgSElGX01JQl9J
RF9HTF9TRVRfTVVMVElfTVNHLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLWlu
dCBoaWZfc2V0X3VhcHNkX2luZm8oc3RydWN0IHdmeF92aWYgKnd2aWYsIHVuc2lnbmVkIGxvbmcg
dmFsKQotewotCXN0cnVjdCBoaWZfbWliX3NldF91YXBzZF9pbmZvcm1hdGlvbiBhcmcgPSB7IH07
Ci0KLQlpZiAodmFsICYgQklUKElFRUU4MDIxMV9BQ19WTykpCi0JCWFyZy50cmlnX3ZvaWNlID0g
MTsKLQlpZiAodmFsICYgQklUKElFRUU4MDIxMV9BQ19WSSkpCi0JCWFyZy50cmlnX3ZpZGVvID0g
MTsKLQlpZiAodmFsICYgQklUKElFRUU4MDIxMV9BQ19CRSkpCi0JCWFyZy50cmlnX2JlID0gMTsK
LQlpZiAodmFsICYgQklUKElFRUU4MDIxMV9BQ19CSykpCi0JCWFyZy50cmlnX2Jja2dybmQgPSAx
OwotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBI
SUZfTUlCX0lEX1NFVF9VQVBTRF9JTkZPUk1BVElPTiwKLQkJCSAgICAgJmFyZywgc2l6ZW9mKGFy
ZykpOwotfQotCi1pbnQgaGlmX2VycF91c2VfcHJvdGVjdGlvbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwgYm9vbCBlbmFibGUpCi17Ci0Jc3RydWN0IGhpZl9taWJfbm9uX2VycF9wcm90ZWN0aW9uIGFy
ZyA9IHsKLQkJLnVzZV9jdHNfdG9fc2VsZiA9IGVuYWJsZSwKLQl9OwotCi0JcmV0dXJuIGhpZl93
cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCi0JCQkgICAgIEhJRl9NSUJfSURfTk9OX0VS
UF9QUk9URUNUSU9OLCAmYXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLWludCBoaWZfc2xvdF90aW1l
KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgdmFsKQotewotCXN0cnVjdCBoaWZfbWliX3Nsb3Rf
dGltZSBhcmcgPSB7Ci0JCS5zbG90X3RpbWUgPSBjcHVfdG9fbGUzMih2YWwpLAotCX07Ci0KLQly
ZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9TTE9U
X1RJTUUsCi0JCQkgICAgICZhcmcsIHNpemVvZihhcmcpKTsKLX0KLQotaW50IGhpZl93ZXBfZGVm
YXVsdF9rZXlfaWQoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCB2YWwpCi17Ci0Jc3RydWN0IGhp
Zl9taWJfd2VwX2RlZmF1bHRfa2V5X2lkIGFyZyA9IHsKLQkJLndlcF9kZWZhdWx0X2tleV9pZCA9
IHZhbCwKLQl9OwotCi0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQs
Ci0JCQkgICAgIEhJRl9NSUJfSURfRE9UMTFfV0VQX0RFRkFVTFRfS0VZX0lELAotCQkJICAgICAm
YXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLWludCBoaWZfcnRzX3RocmVzaG9sZChzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgaW50IHZhbCkKLXsKLQlzdHJ1Y3QgaGlmX21pYl9kb3QxMV9ydHNfdGhyZXNo
b2xkIGFyZyA9IHsKLQkJLnRocmVzaG9sZCA9IGNwdV90b19sZTMyKHZhbCA+PSAwID8gdmFsIDog
MHhGRkZGKSwKLQl9OwotCi0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+
aWQsCi0JCQkgICAgIEhJRl9NSUJfSURfRE9UMTFfUlRTX1RIUkVTSE9MRCwgJmFyZywgc2l6ZW9m
KGFyZykpOwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfdHhfbWliLmgg
Yi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMmEzYjg0ODY4ZWU0Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5n
L3dmeC9oaWZfdHhfbWliLmgKKysrIC9kZXYvbnVsbApAQCAtMSw0OSArMCwwIEBACi0vKiBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCi0vKgotICogSW1wbGVtZW50YXRp
b24gb2YgdGhlIGhvc3QtdG8tY2hpcCBNSUJzIG9mIHRoZSBoYXJkd2FyZSBBUEkuCi0gKgotICog
Q29weXJpZ2h0IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBD
b3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTAsIFNU
LUVyaWNzc29uIFNBCi0gKi8KLSNpZm5kZWYgV0ZYX0hJRl9UWF9NSUJfSAotI2RlZmluZSBXRlhf
SElGX1RYX01JQl9ICi0KLXN0cnVjdCB3ZnhfdmlmOwotc3RydWN0IHNrX2J1ZmY7Ci0KLWludCBo
aWZfc2V0X291dHB1dF9wb3dlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCk7Ci1pbnQg
aGlmX3NldF9iZWFjb25fd2FrZXVwX3BlcmlvZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKLQkJCQkg
dW5zaWduZWQgaW50IGR0aW1faW50ZXJ2YWwsCi0JCQkJIHVuc2lnbmVkIGludCBsaXN0ZW5faW50
ZXJ2YWwpOwotaW50IGhpZl9zZXRfcmNwaV9yc3NpX3RocmVzaG9sZChzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwKLQkJCQlpbnQgcnNzaV90aG9sZCwgaW50IHJzc2lfaHlzdCk7Ci1pbnQgaGlmX2dldF9j
b3VudGVyc190YWJsZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHZpZl9pZCwKLQkJCSAgIHN0
cnVjdCBoaWZfbWliX2V4dGVuZGVkX2NvdW50X3RhYmxlICphcmcpOwotaW50IGhpZl9zZXRfbWFj
YWRkcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdTggKm1hYyk7Ci1pbnQgaGlmX3NldF9yeF9maWx0
ZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCSAgICAgIGJvb2wgZmlsdGVyX2Jzc2lkLCBib29s
IGZ3ZF9wcm9iZV9yZXEpOwotaW50IGhpZl9zZXRfYmVhY29uX2ZpbHRlcl90YWJsZShzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwgaW50IHRibF9sZW4sCi0JCQkJY29uc3Qgc3RydWN0IGhpZl9pZV90YWJs
ZV9lbnRyeSAqdGJsKTsKLWludCBoaWZfYmVhY29uX2ZpbHRlcl9jb250cm9sKHN0cnVjdCB3Znhf
dmlmICp3dmlmLAotCQkJICAgICAgaW50IGVuYWJsZSwgaW50IGJlYWNvbl9jb3VudCk7Ci1pbnQg
aGlmX3NldF9vcGVyYXRpb25hbF9tb2RlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBlbnVtIGhpZl9v
cF9wb3dlcl9tb2RlIG1vZGUpOwotaW50IGhpZl9zZXRfdGVtcGxhdGVfZnJhbWUoc3RydWN0IHdm
eF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZmICpza2IsCi0JCQkgICB1OCBmcmFtZV90eXBlLCBp
bnQgaW5pdF9yYXRlKTsKLWludCBoaWZfc2V0X21mcChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9v
bCBjYXBhYmxlLCBib29sIHJlcXVpcmVkKTsKLWludCBoaWZfc2V0X2Jsb2NrX2Fja19wb2xpY3ko
c3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkgICAgIHU4IHR4X3RpZF9wb2xpY3ksIHU4IHJ4X3Rp
ZF9wb2xpY3kpOwotaW50IGhpZl9zZXRfYXNzb2NpYXRpb25fbW9kZShzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwgaW50IGFtcGR1X2RlbnNpdHksCi0JCQkgICAgIGJvb2wgZ3JlZW5maWVsZCwgYm9vbCBz
aG9ydF9wcmVhbWJsZSk7Ci1pbnQgaGlmX3NldF90eF9yYXRlX3JldHJ5X3BvbGljeShzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwKLQkJCQkgaW50IHBvbGljeV9pbmRleCwgdTggKnJhdGVzKTsKLWludCBo
aWZfa2VlcF9hbGl2ZV9wZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBwZXJpb2QpOwot
aW50IGhpZl9zZXRfYXJwX2lwdjRfZmlsdGVyKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgaWR4
LCBfX2JlMzIgKmFkZHIpOwotaW50IGhpZl91c2VfbXVsdGlfdHhfY29uZihzdHJ1Y3Qgd2Z4X2Rl
diAqd2RldiwgYm9vbCBlbmFibGUpOwotaW50IGhpZl9zZXRfdWFwc2RfaW5mbyhzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgdW5zaWduZWQgbG9uZyB2YWwpOwotaW50IGhpZl9lcnBfdXNlX3Byb3RlY3Rp
b24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlKTsKLWludCBoaWZfc2xvdF90aW1l
KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgdmFsKTsKLWludCBoaWZfd2VwX2RlZmF1bHRfa2V5
X2lkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgdmFsKTsKLWludCBoaWZfcnRzX3RocmVzaG9s
ZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCk7Ci0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9zdGFnaW5nL3dmeC9od2lvLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2h3aW8uYwpk
ZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMzBlYjg4ODgzMGQyLi4wMDAwMDAwMDAwMDAK
LS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9od2lvLmMKKysrIC9kZXYvbnVsbApAQCAtMSwzNTIg
KzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQotLyoKLSAq
IExvdy1sZXZlbCBJL08gZnVuY3Rpb25zLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIw
LCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1F
cmljc3NvbgotICovCi0jaW5jbHVkZSA8bGludXgva2VybmVsLmg+Ci0jaW5jbHVkZSA8bGludXgv
ZGVsYXkuaD4KLSNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Ci0KLSNpbmNsdWRlICJod2lvLmgiCi0j
aW5jbHVkZSAid2Z4LmgiCi0jaW5jbHVkZSAiYnVzLmgiCi0jaW5jbHVkZSAidHJhY2VzLmgiCi0K
LS8qCi0gKiBJbnRlcm5hbCBoZWxwZXJzLgotICoKLSAqIEFib3V0IENPTkZJR19WTUFQX1NUQUNL
OgotICogV2hlbiBDT05GSUdfVk1BUF9TVEFDSyBpcyBlbmFibGVkLCBpdCBpcyBub3QgcG9zc2li
bGUgdG8gcnVuIERNQSBvbiBzdGFjawotICogYWxsb2NhdGVkIGRhdGEuIEZ1bmN0aW9ucyBiZWxv
dyB0aGF0IHdvcmsgd2l0aCByZWdpc3RlcnMgKGFrYSBmdW5jdGlvbnMKLSAqIGVuZGluZyB3aXRo
ICIzMiIpIGF1dG9tYXRpY2FsbHkgcmVhbGxvY2F0ZSBidWZmZXJzIHdpdGgga21hbGxvYy4gSG93
ZXZlciwKLSAqIGZ1bmN0aW9ucyB0aGF0IHdvcmsgd2l0aCBhcmJpdHJhcnkgbGVuZ3RoIGJ1ZmZl
cnMgbGV0J3MgY2FsbGVyIHRvIGhhbmRsZQotICogbWVtb3J5IGxvY2F0aW9uLiBJbiBkb3VidCwg
ZW5hYmxlIENPTkZJR19ERUJVR19TRyB0byBkZXRlY3QgYmFkbHkgbG9jYXRlZAotICogYnVmZmVy
LgotICovCi0KLXN0YXRpYyBpbnQgcmVhZDMyKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgcmVn
LCB1MzIgKnZhbCkKLXsKLQlpbnQgcmV0OwotCV9fbGUzMiAqdG1wID0ga21hbGxvYyhzaXplb2Yo
dTMyKSwgR0ZQX0tFUk5FTCk7Ci0KLQkqdmFsID0gfjA7IC8qIE5ldmVyIHJldHVybiB1bmRlZmlu
ZWQgdmFsdWUgKi8KLQlpZiAoIXRtcCkKLQkJcmV0dXJuIC1FTk9NRU07Ci0JcmV0ID0gd2Rldi0+
aHdidXNfb3BzLT5jb3B5X2Zyb21faW8od2Rldi0+aHdidXNfcHJpdiwgcmVnLCB0bXAsCi0JCQkJ
CSAgICBzaXplb2YodTMyKSk7Ci0JaWYgKHJldCA+PSAwKQotCQkqdmFsID0gbGUzMl90b19jcHUo
KnRtcCk7Ci0Ja2ZyZWUodG1wKTsKLQlpZiAocmV0KQotCQlkZXZfZXJyKHdkZXYtPmRldiwgIiVz
OiBidXMgY29tbXVuaWNhdGlvbiBlcnJvcjogJWRcbiIsCi0JCQlfX2Z1bmNfXywgcmV0KTsKLQly
ZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IHdyaXRlMzIoc3RydWN0IHdmeF9kZXYgKndkZXYs
IGludCByZWcsIHUzMiB2YWwpCi17Ci0JaW50IHJldDsKLQlfX2xlMzIgKnRtcCA9IGttYWxsb2Mo
c2l6ZW9mKHUzMiksIEdGUF9LRVJORUwpOwotCi0JaWYgKCF0bXApCi0JCXJldHVybiAtRU5PTUVN
OwotCSp0bXAgPSBjcHVfdG9fbGUzMih2YWwpOwotCXJldCA9IHdkZXYtPmh3YnVzX29wcy0+Y29w
eV90b19pbyh3ZGV2LT5od2J1c19wcml2LCByZWcsIHRtcCwKLQkJCQkJICBzaXplb2YodTMyKSk7
Ci0Ja2ZyZWUodG1wKTsKLQlpZiAocmV0KQotCQlkZXZfZXJyKHdkZXYtPmRldiwgIiVzOiBidXMg
Y29tbXVuaWNhdGlvbiBlcnJvcjogJWRcbiIsCi0JCQlfX2Z1bmNfXywgcmV0KTsKLQlyZXR1cm4g
cmV0OwotfQotCi1zdGF0aWMgaW50IHJlYWQzMl9sb2NrZWQoc3RydWN0IHdmeF9kZXYgKndkZXYs
IGludCByZWcsIHUzMiAqdmFsKQotewotCWludCByZXQ7Ci0KLQl3ZGV2LT5od2J1c19vcHMtPmxv
Y2sod2Rldi0+aHdidXNfcHJpdik7Ci0JcmV0ID0gcmVhZDMyKHdkZXYsIHJlZywgdmFsKTsKLQlf
dHJhY2VfaW9fcmVhZDMyKHJlZywgKnZhbCk7Ci0Jd2Rldi0+aHdidXNfb3BzLT51bmxvY2sod2Rl
di0+aHdidXNfcHJpdik7Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB3cml0ZTMyX2xv
Y2tlZChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHJlZywgdTMyIHZhbCkKLXsKLQlpbnQgcmV0
OwotCi0Jd2Rldi0+aHdidXNfb3BzLT5sb2NrKHdkZXYtPmh3YnVzX3ByaXYpOwotCXJldCA9IHdy
aXRlMzIod2RldiwgcmVnLCB2YWwpOwotCV90cmFjZV9pb193cml0ZTMyKHJlZywgdmFsKTsKLQl3
ZGV2LT5od2J1c19vcHMtPnVubG9jayh3ZGV2LT5od2J1c19wcml2KTsKLQlyZXR1cm4gcmV0Owot
fQotCi1zdGF0aWMgaW50IHdyaXRlMzJfYml0c19sb2NrZWQoc3RydWN0IHdmeF9kZXYgKndkZXYs
IGludCByZWcsIHUzMiBtYXNrLCB1MzIgdmFsKQotewotCWludCByZXQ7Ci0JdTMyIHZhbF9yLCB2
YWxfdzsKLQotCVdBUk5fT04ofm1hc2sgJiB2YWwpOwotCXZhbCAmPSBtYXNrOwotCXdkZXYtPmh3
YnVzX29wcy0+bG9jayh3ZGV2LT5od2J1c19wcml2KTsKLQlyZXQgPSByZWFkMzIod2RldiwgcmVn
LCAmdmFsX3IpOwotCV90cmFjZV9pb19yZWFkMzIocmVnLCB2YWxfcik7Ci0JaWYgKHJldCA8IDAp
Ci0JCWdvdG8gZXJyOwotCXZhbF93ID0gKHZhbF9yICYgfm1hc2spIHwgdmFsOwotCWlmICh2YWxf
dyAhPSB2YWxfcikgewotCQlyZXQgPSB3cml0ZTMyKHdkZXYsIHJlZywgdmFsX3cpOwotCQlfdHJh
Y2VfaW9fd3JpdGUzMihyZWcsIHZhbF93KTsKLQl9Ci1lcnI6Ci0Jd2Rldi0+aHdidXNfb3BzLT51
bmxvY2sod2Rldi0+aHdidXNfcHJpdik7Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCBp
bmRpcmVjdF9yZWFkKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgcmVnLCB1MzIgYWRkciwKLQkJ
CSB2b2lkICpidWYsIHNpemVfdCBsZW4pCi17Ci0JaW50IHJldDsKLQlpbnQgaTsKLQl1MzIgY2Zn
OwotCXUzMiBwcmVmZXRjaDsKLQotCVdBUk5fT04obGVuID49IDB4MjAwMCk7Ci0JV0FSTl9PTihy
ZWcgIT0gV0ZYX1JFR19BSEJfRFBPUlQgJiYgcmVnICE9IFdGWF9SRUdfU1JBTV9EUE9SVCk7Ci0K
LQlpZiAocmVnID09IFdGWF9SRUdfQUhCX0RQT1JUKQotCQlwcmVmZXRjaCA9IENGR19QUkVGRVRD
SF9BSEI7Ci0JZWxzZSBpZiAocmVnID09IFdGWF9SRUdfU1JBTV9EUE9SVCkKLQkJcHJlZmV0Y2gg
PSBDRkdfUFJFRkVUQ0hfU1JBTTsKLQllbHNlCi0JCXJldHVybiAtRU5PREVWOwotCi0JcmV0ID0g
d3JpdGUzMih3ZGV2LCBXRlhfUkVHX0JBU0VfQUREUiwgYWRkcik7Ci0JaWYgKHJldCA8IDApCi0J
CWdvdG8gZXJyOwotCi0JcmV0ID0gcmVhZDMyKHdkZXYsIFdGWF9SRUdfQ09ORklHLCAmY2ZnKTsK
LQlpZiAocmV0IDwgMCkKLQkJZ290byBlcnI7Ci0KLQlyZXQgPSB3cml0ZTMyKHdkZXYsIFdGWF9S
RUdfQ09ORklHLCBjZmcgfCBwcmVmZXRjaCk7Ci0JaWYgKHJldCA8IDApCi0JCWdvdG8gZXJyOwot
Ci0JZm9yIChpID0gMDsgaSA8IDIwOyBpKyspIHsKLQkJcmV0ID0gcmVhZDMyKHdkZXYsIFdGWF9S
RUdfQ09ORklHLCAmY2ZnKTsKLQkJaWYgKHJldCA8IDApCi0JCQlnb3RvIGVycjsKLQkJaWYgKCEo
Y2ZnICYgcHJlZmV0Y2gpKQotCQkJYnJlYWs7Ci0JCXVzbGVlcF9yYW5nZSgyMDAsIDI1MCk7Ci0J
fQotCWlmIChpID09IDIwKSB7Ci0JCXJldCA9IC1FVElNRURPVVQ7Ci0JCWdvdG8gZXJyOwotCX0K
LQotCXJldCA9IHdkZXYtPmh3YnVzX29wcy0+Y29weV9mcm9tX2lvKHdkZXYtPmh3YnVzX3ByaXYs
IHJlZywgYnVmLCBsZW4pOwotCi1lcnI6Ci0JaWYgKHJldCA8IDApCi0JCW1lbXNldChidWYsIDB4
RkYsIGxlbik7IC8qIE5ldmVyIHJldHVybiB1bmRlZmluZWQgdmFsdWUgKi8KLQlyZXR1cm4gcmV0
OwotfQotCi1zdGF0aWMgaW50IGluZGlyZWN0X3dyaXRlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBp
bnQgcmVnLCB1MzIgYWRkciwKLQkJCSAgY29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgbGVuKQotewot
CWludCByZXQ7Ci0KLQlXQVJOX09OKGxlbiA+PSAweDIwMDApOwotCVdBUk5fT04ocmVnICE9IFdG
WF9SRUdfQUhCX0RQT1JUICYmIHJlZyAhPSBXRlhfUkVHX1NSQU1fRFBPUlQpOwotCXJldCA9IHdy
aXRlMzIod2RldiwgV0ZYX1JFR19CQVNFX0FERFIsIGFkZHIpOwotCWlmIChyZXQgPCAwKQotCQly
ZXR1cm4gcmV0OwotCi0JcmV0dXJuIHdkZXYtPmh3YnVzX29wcy0+Y29weV90b19pbyh3ZGV2LT5o
d2J1c19wcml2LCByZWcsIGJ1ZiwgbGVuKTsKLX0KLQotc3RhdGljIGludCBpbmRpcmVjdF9yZWFk
X2xvY2tlZChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHJlZywgdTMyIGFkZHIsCi0JCQkJdm9p
ZCAqYnVmLCBzaXplX3QgbGVuKQotewotCWludCByZXQ7Ci0KLQl3ZGV2LT5od2J1c19vcHMtPmxv
Y2sod2Rldi0+aHdidXNfcHJpdik7Ci0JcmV0ID0gaW5kaXJlY3RfcmVhZCh3ZGV2LCByZWcsIGFk
ZHIsIGJ1ZiwgbGVuKTsKLQlfdHJhY2VfaW9faW5kX3JlYWQocmVnLCBhZGRyLCBidWYsIGxlbik7
Ci0Jd2Rldi0+aHdidXNfb3BzLT51bmxvY2sod2Rldi0+aHdidXNfcHJpdik7Ci0JcmV0dXJuIHJl
dDsKLX0KLQotc3RhdGljIGludCBpbmRpcmVjdF93cml0ZV9sb2NrZWQoc3RydWN0IHdmeF9kZXYg
KndkZXYsIGludCByZWcsIHUzMiBhZGRyLAotCQkJCSBjb25zdCB2b2lkICpidWYsIHNpemVfdCBs
ZW4pCi17Ci0JaW50IHJldDsKLQotCXdkZXYtPmh3YnVzX29wcy0+bG9jayh3ZGV2LT5od2J1c19w
cml2KTsKLQlyZXQgPSBpbmRpcmVjdF93cml0ZSh3ZGV2LCByZWcsIGFkZHIsIGJ1ZiwgbGVuKTsK
LQlfdHJhY2VfaW9faW5kX3dyaXRlKHJlZywgYWRkciwgYnVmLCBsZW4pOwotCXdkZXYtPmh3YnVz
X29wcy0+dW5sb2NrKHdkZXYtPmh3YnVzX3ByaXYpOwotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRp
YyBpbnQgaW5kaXJlY3RfcmVhZDMyX2xvY2tlZChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHJl
ZywKLQkJCQkgIHUzMiBhZGRyLCB1MzIgKnZhbCkKLXsKLQlpbnQgcmV0OwotCV9fbGUzMiAqdG1w
ID0ga21hbGxvYyhzaXplb2YodTMyKSwgR0ZQX0tFUk5FTCk7Ci0KLQlpZiAoIXRtcCkKLQkJcmV0
dXJuIC1FTk9NRU07Ci0Jd2Rldi0+aHdidXNfb3BzLT5sb2NrKHdkZXYtPmh3YnVzX3ByaXYpOwot
CXJldCA9IGluZGlyZWN0X3JlYWQod2RldiwgcmVnLCBhZGRyLCB0bXAsIHNpemVvZih1MzIpKTsK
LQkqdmFsID0gbGUzMl90b19jcHUoKnRtcCk7Ci0JX3RyYWNlX2lvX2luZF9yZWFkMzIocmVnLCBh
ZGRyLCAqdmFsKTsKLQl3ZGV2LT5od2J1c19vcHMtPnVubG9jayh3ZGV2LT5od2J1c19wcml2KTsK
LQlrZnJlZSh0bXApOwotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgaW5kaXJlY3Rfd3Jp
dGUzMl9sb2NrZWQoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCByZWcsCi0JCQkJICAgdTMyIGFk
ZHIsIHUzMiB2YWwpCi17Ci0JaW50IHJldDsKLQlfX2xlMzIgKnRtcCA9IGttYWxsb2Moc2l6ZW9m
KHUzMiksIEdGUF9LRVJORUwpOwotCi0JaWYgKCF0bXApCi0JCXJldHVybiAtRU5PTUVNOwotCSp0
bXAgPSBjcHVfdG9fbGUzMih2YWwpOwotCXdkZXYtPmh3YnVzX29wcy0+bG9jayh3ZGV2LT5od2J1
c19wcml2KTsKLQlyZXQgPSBpbmRpcmVjdF93cml0ZSh3ZGV2LCByZWcsIGFkZHIsIHRtcCwgc2l6
ZW9mKHUzMikpOwotCV90cmFjZV9pb19pbmRfd3JpdGUzMihyZWcsIGFkZHIsIHZhbCk7Ci0Jd2Rl
di0+aHdidXNfb3BzLT51bmxvY2sod2Rldi0+aHdidXNfcHJpdik7Ci0Ja2ZyZWUodG1wKTsKLQly
ZXR1cm4gcmV0OwotfQotCi1pbnQgd2Z4X2RhdGFfcmVhZChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldiwg
dm9pZCAqYnVmLCBzaXplX3QgbGVuKQotewotCWludCByZXQ7Ci0KLQlXQVJOKChsb25nKWJ1ZiAm
IDMsICIlczogdW5hbGlnbmVkIGJ1ZmZlciIsIF9fZnVuY19fKTsKLQl3ZGV2LT5od2J1c19vcHMt
PmxvY2sod2Rldi0+aHdidXNfcHJpdik7Ci0JcmV0ID0gd2Rldi0+aHdidXNfb3BzLT5jb3B5X2Zy
b21faW8od2Rldi0+aHdidXNfcHJpdiwKLQkJCQkJICAgIFdGWF9SRUdfSU5fT1VUX1FVRVVFLCBi
dWYsIGxlbik7Ci0JX3RyYWNlX2lvX3JlYWQoV0ZYX1JFR19JTl9PVVRfUVVFVUUsIGJ1ZiwgbGVu
KTsKLQl3ZGV2LT5od2J1c19vcHMtPnVubG9jayh3ZGV2LT5od2J1c19wcml2KTsKLQlpZiAocmV0
KQotCQlkZXZfZXJyKHdkZXYtPmRldiwgIiVzOiBidXMgY29tbXVuaWNhdGlvbiBlcnJvcjogJWRc
biIsCi0JCQlfX2Z1bmNfXywgcmV0KTsKLQlyZXR1cm4gcmV0OwotfQotCi1pbnQgd2Z4X2RhdGFf
d3JpdGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbikK
LXsKLQlpbnQgcmV0OwotCi0JV0FSTigobG9uZylidWYgJiAzLCAiJXM6IHVuYWxpZ25lZCBidWZm
ZXIiLCBfX2Z1bmNfXyk7Ci0Jd2Rldi0+aHdidXNfb3BzLT5sb2NrKHdkZXYtPmh3YnVzX3ByaXYp
OwotCXJldCA9IHdkZXYtPmh3YnVzX29wcy0+Y29weV90b19pbyh3ZGV2LT5od2J1c19wcml2LAot
CQkJCQkgIFdGWF9SRUdfSU5fT1VUX1FVRVVFLCBidWYsIGxlbik7Ci0JX3RyYWNlX2lvX3dyaXRl
KFdGWF9SRUdfSU5fT1VUX1FVRVVFLCBidWYsIGxlbik7Ci0Jd2Rldi0+aHdidXNfb3BzLT51bmxv
Y2sod2Rldi0+aHdidXNfcHJpdik7Ci0JaWYgKHJldCkKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICIl
czogYnVzIGNvbW11bmljYXRpb24gZXJyb3I6ICVkXG4iLAotCQkJX19mdW5jX18sIHJldCk7Ci0J
cmV0dXJuIHJldDsKLX0KLQotaW50IHNyYW1fYnVmX3JlYWQoc3RydWN0IHdmeF9kZXYgKndkZXYs
IHUzMiBhZGRyLCB2b2lkICpidWYsIHNpemVfdCBsZW4pCi17Ci0JcmV0dXJuIGluZGlyZWN0X3Jl
YWRfbG9ja2VkKHdkZXYsIFdGWF9SRUdfU1JBTV9EUE9SVCwgYWRkciwgYnVmLCBsZW4pOwotfQot
Ci1pbnQgYWhiX2J1Zl9yZWFkKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgYWRkciwgdm9pZCAq
YnVmLCBzaXplX3QgbGVuKQotewotCXJldHVybiBpbmRpcmVjdF9yZWFkX2xvY2tlZCh3ZGV2LCBX
RlhfUkVHX0FIQl9EUE9SVCwgYWRkciwgYnVmLCBsZW4pOwotfQotCi1pbnQgc3JhbV9idWZfd3Jp
dGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBhZGRyLCBjb25zdCB2b2lkICpidWYsIHNpemVf
dCBsZW4pCi17Ci0JcmV0dXJuIGluZGlyZWN0X3dyaXRlX2xvY2tlZCh3ZGV2LCBXRlhfUkVHX1NS
QU1fRFBPUlQsIGFkZHIsIGJ1ZiwgbGVuKTsKLX0KLQotaW50IGFoYl9idWZfd3JpdGUoc3RydWN0
IHdmeF9kZXYgKndkZXYsIHUzMiBhZGRyLCBjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4pCi17
Ci0JcmV0dXJuIGluZGlyZWN0X3dyaXRlX2xvY2tlZCh3ZGV2LCBXRlhfUkVHX0FIQl9EUE9SVCwg
YWRkciwgYnVmLCBsZW4pOwotfQotCi1pbnQgc3JhbV9yZWdfcmVhZChzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiwgdTMyIGFkZHIsIHUzMiAqdmFsKQotewotCXJldHVybiBpbmRpcmVjdF9yZWFkMzJfbG9j
a2VkKHdkZXYsIFdGWF9SRUdfU1JBTV9EUE9SVCwgYWRkciwgdmFsKTsKLX0KLQotaW50IGFoYl9y
ZWdfcmVhZChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIGFkZHIsIHUzMiAqdmFsKQotewotCXJl
dHVybiBpbmRpcmVjdF9yZWFkMzJfbG9ja2VkKHdkZXYsIFdGWF9SRUdfQUhCX0RQT1JULCBhZGRy
LCB2YWwpOwotfQotCi1pbnQgc3JhbV9yZWdfd3JpdGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUz
MiBhZGRyLCB1MzIgdmFsKQotewotCXJldHVybiBpbmRpcmVjdF93cml0ZTMyX2xvY2tlZCh3ZGV2
LCBXRlhfUkVHX1NSQU1fRFBPUlQsIGFkZHIsIHZhbCk7Ci19Ci0KLWludCBhaGJfcmVnX3dyaXRl
KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgYWRkciwgdTMyIHZhbCkKLXsKLQlyZXR1cm4gaW5k
aXJlY3Rfd3JpdGUzMl9sb2NrZWQod2RldiwgV0ZYX1JFR19BSEJfRFBPUlQsIGFkZHIsIHZhbCk7
Ci19Ci0KLWludCBjb25maWdfcmVnX3JlYWQoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiAqdmFs
KQotewotCXJldHVybiByZWFkMzJfbG9ja2VkKHdkZXYsIFdGWF9SRUdfQ09ORklHLCB2YWwpOwot
fQotCi1pbnQgY29uZmlnX3JlZ193cml0ZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIHZhbCkK
LXsKLQlyZXR1cm4gd3JpdGUzMl9sb2NrZWQod2RldiwgV0ZYX1JFR19DT05GSUcsIHZhbCk7Ci19
Ci0KLWludCBjb25maWdfcmVnX3dyaXRlX2JpdHMoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBt
YXNrLCB1MzIgdmFsKQotewotCXJldHVybiB3cml0ZTMyX2JpdHNfbG9ja2VkKHdkZXYsIFdGWF9S
RUdfQ09ORklHLCBtYXNrLCB2YWwpOwotfQotCi1pbnQgY29udHJvbF9yZWdfcmVhZChzdHJ1Y3Qg
d2Z4X2RldiAqd2RldiwgdTMyICp2YWwpCi17Ci0JcmV0dXJuIHJlYWQzMl9sb2NrZWQod2Rldiwg
V0ZYX1JFR19DT05UUk9MLCB2YWwpOwotfQotCi1pbnQgY29udHJvbF9yZWdfd3JpdGUoc3RydWN0
IHdmeF9kZXYgKndkZXYsIHUzMiB2YWwpCi17Ci0JcmV0dXJuIHdyaXRlMzJfbG9ja2VkKHdkZXYs
IFdGWF9SRUdfQ09OVFJPTCwgdmFsKTsKLX0KLQotaW50IGNvbnRyb2xfcmVnX3dyaXRlX2JpdHMo
c3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBtYXNrLCB1MzIgdmFsKQotewotCXJldHVybiB3cml0
ZTMyX2JpdHNfbG9ja2VkKHdkZXYsIFdGWF9SRUdfQ09OVFJPTCwgbWFzaywgdmFsKTsKLX0KLQot
aW50IGlncHJfcmVnX3JlYWQoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBpbmRleCwgdTMyICp2
YWwpCi17Ci0JaW50IHJldDsKLQotCSp2YWwgPSB+MDsgLyogTmV2ZXIgcmV0dXJuIHVuZGVmaW5l
ZCB2YWx1ZSAqLwotCXJldCA9IHdyaXRlMzJfbG9ja2VkKHdkZXYsIFdGWF9SRUdfU0VUX0dFTl9S
X1csIElHUFJfUlcgfCBpbmRleCA8PCAyNCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQly
ZXQgPSByZWFkMzJfbG9ja2VkKHdkZXYsIFdGWF9SRUdfU0VUX0dFTl9SX1csIHZhbCk7Ci0JaWYg
KHJldCkKLQkJcmV0dXJuIHJldDsKLQkqdmFsICY9IElHUFJfVkFMVUU7Ci0JcmV0dXJuIHJldDsK
LX0KLQotaW50IGlncHJfcmVnX3dyaXRlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgaW5kZXgs
IHUzMiB2YWwpCi17Ci0JcmV0dXJuIHdyaXRlMzJfbG9ja2VkKHdkZXYsIFdGWF9SRUdfU0VUX0dF
Tl9SX1csIGluZGV4IDw8IDI0IHwgdmFsKTsKLX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2lu
Zy93ZngvaHdpby5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9od2lvLmgKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IGZmMDk1NzVkZDFhZi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMv
c3RhZ2luZy93ZngvaHdpby5oCisrKyAvZGV2L251bGwKQEAgLTEsNzUgKzAsMCBAQAotLyogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwotLyoKLSAqIExvdy1sZXZlbCBJ
L08gZnVuY3Rpb25zLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExh
Ym9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICov
Ci0jaWZuZGVmIFdGWF9IV0lPX0gKLSNkZWZpbmUgV0ZYX0hXSU9fSAotCi0jaW5jbHVkZSA8bGlu
dXgvdHlwZXMuaD4KLQotc3RydWN0IHdmeF9kZXY7Ci0KLWludCB3ZnhfZGF0YV9yZWFkKHN0cnVj
dCB3ZnhfZGV2ICp3ZGV2LCB2b2lkICpidWYsIHNpemVfdCBidWZfbGVuKTsKLWludCB3ZnhfZGF0
YV93cml0ZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgY29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgYnVm
X2xlbik7Ci0KLWludCBzcmFtX2J1Zl9yZWFkKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgYWRk
ciwgdm9pZCAqYnVmLCBzaXplX3QgbGVuKTsKLWludCBzcmFtX2J1Zl93cml0ZShzdHJ1Y3Qgd2Z4
X2RldiAqd2RldiwgdTMyIGFkZHIsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbik7Ci0KLWlu
dCBhaGJfYnVmX3JlYWQoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBhZGRyLCB2b2lkICpidWYs
IHNpemVfdCBsZW4pOwotaW50IGFoYl9idWZfd3JpdGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUz
MiBhZGRyLCBjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4pOwotCi1pbnQgc3JhbV9yZWdfcmVh
ZChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIGFkZHIsIHUzMiAqdmFsKTsKLWludCBzcmFtX3Jl
Z193cml0ZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIGFkZHIsIHUzMiB2YWwpOwotCi1pbnQg
YWhiX3JlZ19yZWFkKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgYWRkciwgdTMyICp2YWwpOwot
aW50IGFoYl9yZWdfd3JpdGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBhZGRyLCB1MzIgdmFs
KTsKLQotI2RlZmluZSBDRkdfRVJSX1NQSV9GUkFNRSAgICAgICAgICAweDAwMDAwMDAxIC8qIG9u
bHkgd2l0aCBTUEkgKi8KLSNkZWZpbmUgQ0ZHX0VSUl9TRElPX0JVRl9NSVNNQVRDSCAgMHgwMDAw
MDAwMSAvKiBvbmx5IHdpdGggU0RJTyAqLwotI2RlZmluZSBDRkdfRVJSX0JVRl9VTkRFUlJVTiAg
ICAgICAweDAwMDAwMDAyCi0jZGVmaW5lIENGR19FUlJfREFUQV9JTl9UT09fTEFSR0UgIDB4MDAw
MDAwMDQKLSNkZWZpbmUgQ0ZHX0VSUl9IT1NUX05PX09VVF9RVUVVRSAgMHgwMDAwMDAwOAotI2Rl
ZmluZSBDRkdfRVJSX0JVRl9PVkVSUlVOICAgICAgICAweDAwMDAwMDEwCi0jZGVmaW5lIENGR19F
UlJfREFUQV9PVVRfVE9PX0xBUkdFIDB4MDAwMDAwMjAKLSNkZWZpbmUgQ0ZHX0VSUl9IT1NUX05P
X0lOX1FVRVVFICAgMHgwMDAwMDA0MAotI2RlZmluZSBDRkdfRVJSX0hPU1RfQ1JDX01JU1MgICAg
ICAweDAwMDAwMDgwIC8qIG9ubHkgd2l0aCBTRElPICovCi0jZGVmaW5lIENGR19TUElfSUdOT1JF
X0NTICAgICAgICAgIDB4MDAwMDAwODAgLyogb25seSB3aXRoIFNQSSAqLwotI2RlZmluZSBDRkdf
QllURV9PUkRFUl9NQVNLICAgICAgICAweDAwMDAwMzAwIC8qIG9ubHkgd3JpdGFibGUgd2l0aCBT
UEkgKi8KLSNkZWZpbmUgICAgIENGR19CWVRFX09SREVSX0JBREMgICAgMHgwMDAwMDAwMAotI2Rl
ZmluZSAgICAgQ0ZHX0JZVEVfT1JERVJfRENCQSAgICAweDAwMDAwMTAwCi0jZGVmaW5lICAgICBD
RkdfQllURV9PUkRFUl9BQkNEICAgIDB4MDAwMDAyMDAgLyogU0RJTyBhbHdheXMgdXNlIHRoaXMg
dmFsdWUgKi8KLSNkZWZpbmUgQ0ZHX0RJUkVDVF9BQ0NFU1NfTU9ERSAgICAgMHgwMDAwMDQwMAot
I2RlZmluZSBDRkdfUFJFRkVUQ0hfQUhCICAgICAgICAgICAweDAwMDAwODAwCi0jZGVmaW5lIENG
R19ESVNBQkxFX0NQVV9DTEsgICAgICAgIDB4MDAwMDEwMDAKLSNkZWZpbmUgQ0ZHX1BSRUZFVENI
X1NSQU0gICAgICAgICAgMHgwMDAwMjAwMAotI2RlZmluZSBDRkdfQ1BVX1JFU0VUICAgICAgICAg
ICAgICAweDAwMDA0MDAwCi0jZGVmaW5lIENGR19TRElPX0RJU0FCTEVfSVJRICAgICAgIDB4MDAw
MDgwMDAgLyogb25seSB3aXRoIFNESU8gKi8KLSNkZWZpbmUgQ0ZHX0lSUV9FTkFCTEVfREFUQSAg
ICAgICAgMHgwMDAxMDAwMAotI2RlZmluZSBDRkdfSVJRX0VOQUJMRV9XUkRZICAgICAgICAweDAw
MDIwMDAwCi0jZGVmaW5lIENGR19DTEtfUklTRV9FREdFICAgICAgICAgIDB4MDAwNDAwMDAKLSNk
ZWZpbmUgQ0ZHX1NESU9fRElTQUJMRV9DUkNfQ0hLICAgMHgwMDA4MDAwMCAvKiBvbmx5IHdpdGgg
U0RJTyAqLwotI2RlZmluZSBDRkdfUkVTRVJWRUQgICAgICAgICAgICAgICAweDAwRjAwMDAwCi0j
ZGVmaW5lIENGR19ERVZJQ0VfSURfTUFKT1IgICAgICAgIDB4MDcwMDAwMDAKLSNkZWZpbmUgQ0ZH
X0RFVklDRV9JRF9SRVNFUlZFRCAgICAgMHg3ODAwMDAwMAotI2RlZmluZSBDRkdfREVWSUNFX0lE
X1RZUEUgICAgICAgICAweDgwMDAwMDAwCi1pbnQgY29uZmlnX3JlZ19yZWFkKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2LCB1MzIgKnZhbCk7Ci1pbnQgY29uZmlnX3JlZ193cml0ZShzdHJ1Y3Qgd2Z4X2Rl
diAqd2RldiwgdTMyIHZhbCk7Ci1pbnQgY29uZmlnX3JlZ193cml0ZV9iaXRzKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2LCB1MzIgbWFzaywgdTMyIHZhbCk7Ci0KLSNkZWZpbmUgQ1RSTF9ORVhUX0xFTl9N
QVNLICAgMHgwMDAwMEZGRgotI2RlZmluZSBDVFJMX1dMQU5fV0FLRVVQICAgICAweDAwMDAxMDAw
Ci0jZGVmaW5lIENUUkxfV0xBTl9SRUFEWSAgICAgIDB4MDAwMDIwMDAKLWludCBjb250cm9sX3Jl
Z19yZWFkKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgKnZhbCk7Ci1pbnQgY29udHJvbF9yZWdf
d3JpdGUoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiB2YWwpOwotaW50IGNvbnRyb2xfcmVnX3dy
aXRlX2JpdHMoc3RydWN0IHdmeF9kZXYgKndkZXYsIHUzMiBtYXNrLCB1MzIgdmFsKTsKLQotI2Rl
ZmluZSBJR1BSX1JXICAgICAgICAgIDB4ODAwMDAwMDAKLSNkZWZpbmUgSUdQUl9JTkRFWCAgICAg
ICAweDdGMDAwMDAwCi0jZGVmaW5lIElHUFJfVkFMVUUgICAgICAgMHgwMEZGRkZGRgotaW50IGln
cHJfcmVnX3JlYWQoc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBpbmRleCwgdTMyICp2YWwpOwot
aW50IGlncHJfcmVnX3dyaXRlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBpbnQgaW5kZXgsIHUzMiB2
YWwpOwotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93Zngva2V5LmMgYi9k
cml2ZXJzL3N0YWdpbmcvd2Z4L2tleS5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA2
NTEzNGExNzQ2ODMuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2tleS5j
CisrKyAvZGV2L251bGwKQEAgLTEsMjQxICswLDAgQEAKLS8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wLW9ubHkKLS8qCi0gKiBLZXkgbWFuYWdlbWVudCByZWxhdGVkIGZ1bmN0aW9u
cy4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMs
IEluYy4KLSAqIENvcHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KLSAqLwotI2luY2x1ZGUg
PGxpbnV4L2V0aGVyZGV2aWNlLmg+Ci0jaW5jbHVkZSA8bmV0L21hYzgwMjExLmg+Ci0KLSNpbmNs
dWRlICJrZXkuaCIKLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJoaWZfdHhfbWliLmgiCi0K
LXN0YXRpYyBpbnQgd2Z4X2FsbG9jX2tleShzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKLXsKLQlpbnQg
aWR4OwotCi0JaWR4ID0gZmZzKH53ZGV2LT5rZXlfbWFwKSAtIDE7Ci0JaWYgKGlkeCA8IDAgfHwg
aWR4ID49IE1BWF9LRVlfRU5UUklFUykKLQkJcmV0dXJuIC0xOwotCi0Jd2Rldi0+a2V5X21hcCB8
PSBCSVQoaWR4KTsKLQlyZXR1cm4gaWR4OwotfQotCi1zdGF0aWMgdm9pZCB3ZnhfZnJlZV9rZXko
c3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBpZHgpCi17Ci0JV0FSTighKHdkZXYtPmtleV9tYXAg
JiBCSVQoaWR4KSksICJpbmNvbnNpc3RlbnQga2V5IGFsbG9jYXRpb24iKTsKLQl3ZGV2LT5rZXlf
bWFwICY9IH5CSVQoaWR4KTsKLX0KLQotc3RhdGljIHU4IGZpbGxfd2VwX3BhaXIoc3RydWN0IGhp
Zl93ZXBfcGFpcndpc2Vfa2V5ICptc2csCi0JCQlzdHJ1Y3QgaWVlZTgwMjExX2tleV9jb25mICpr
ZXksIHU4ICpwZWVyX2FkZHIpCi17Ci0JV0FSTihrZXktPmtleWxlbiA+IHNpemVvZihtc2ctPmtl
eV9kYXRhKSwgImluY29uc2lzdGVudCBkYXRhIik7Ci0JbXNnLT5rZXlfbGVuZ3RoID0ga2V5LT5r
ZXlsZW47Ci0JbWVtY3B5KG1zZy0+a2V5X2RhdGEsIGtleS0+a2V5LCBrZXktPmtleWxlbik7Ci0J
ZXRoZXJfYWRkcl9jb3B5KG1zZy0+cGVlcl9hZGRyZXNzLCBwZWVyX2FkZHIpOwotCXJldHVybiBI
SUZfS0VZX1RZUEVfV0VQX1BBSVJXSVNFOwotfQotCi1zdGF0aWMgdTggZmlsbF93ZXBfZ3JvdXAo
c3RydWN0IGhpZl93ZXBfZ3JvdXBfa2V5ICptc2csCi0JCQkgc3RydWN0IGllZWU4MDIxMV9rZXlf
Y29uZiAqa2V5KQotewotCVdBUk4oa2V5LT5rZXlsZW4gPiBzaXplb2YobXNnLT5rZXlfZGF0YSks
ICJpbmNvbnNpc3RlbnQgZGF0YSIpOwotCW1zZy0+a2V5X2lkID0ga2V5LT5rZXlpZHg7Ci0JbXNn
LT5rZXlfbGVuZ3RoID0ga2V5LT5rZXlsZW47Ci0JbWVtY3B5KG1zZy0+a2V5X2RhdGEsIGtleS0+
a2V5LCBrZXktPmtleWxlbik7Ci0JcmV0dXJuIEhJRl9LRVlfVFlQRV9XRVBfREVGQVVMVDsKLX0K
LQotc3RhdGljIHU4IGZpbGxfdGtpcF9wYWlyKHN0cnVjdCBoaWZfdGtpcF9wYWlyd2lzZV9rZXkg
Km1zZywKLQkJCSBzdHJ1Y3QgaWVlZTgwMjExX2tleV9jb25mICprZXksIHU4ICpwZWVyX2FkZHIp
Ci17Ci0JdTggKmtleWJ1ZiA9IGtleS0+a2V5OwotCi0JV0FSTihrZXktPmtleWxlbiAhPSBzaXpl
b2YobXNnLT50a2lwX2tleV9kYXRhKQotCQkJICAgICsgc2l6ZW9mKG1zZy0+dHhfbWljX2tleSkK
LQkJCSAgICArIHNpemVvZihtc2ctPnJ4X21pY19rZXkpLCAiaW5jb25zaXN0ZW50IGRhdGEiKTsK
LQltZW1jcHkobXNnLT50a2lwX2tleV9kYXRhLCBrZXlidWYsIHNpemVvZihtc2ctPnRraXBfa2V5
X2RhdGEpKTsKLQlrZXlidWYgKz0gc2l6ZW9mKG1zZy0+dGtpcF9rZXlfZGF0YSk7Ci0JbWVtY3B5
KG1zZy0+dHhfbWljX2tleSwga2V5YnVmLCBzaXplb2YobXNnLT50eF9taWNfa2V5KSk7Ci0Ja2V5
YnVmICs9IHNpemVvZihtc2ctPnR4X21pY19rZXkpOwotCW1lbWNweShtc2ctPnJ4X21pY19rZXks
IGtleWJ1Ziwgc2l6ZW9mKG1zZy0+cnhfbWljX2tleSkpOwotCWV0aGVyX2FkZHJfY29weShtc2ct
PnBlZXJfYWRkcmVzcywgcGVlcl9hZGRyKTsKLQlyZXR1cm4gSElGX0tFWV9UWVBFX1RLSVBfUEFJ
UldJU0U7Ci19Ci0KLXN0YXRpYyB1OCBmaWxsX3RraXBfZ3JvdXAoc3RydWN0IGhpZl90a2lwX2dy
b3VwX2tleSAqbXNnLAotCQkJICBzdHJ1Y3QgaWVlZTgwMjExX2tleV9jb25mICprZXksCi0JCQkg
IHN0cnVjdCBpZWVlODAyMTFfa2V5X3NlcSAqc2VxLAotCQkJICBlbnVtIG5sODAyMTFfaWZ0eXBl
IGlmdHlwZSkKLXsKLQl1OCAqa2V5YnVmID0ga2V5LT5rZXk7Ci0KLQlXQVJOKGtleS0+a2V5bGVu
ICE9IHNpemVvZihtc2ctPnRraXBfa2V5X2RhdGEpCi0JCQkgICAgKyAyICogc2l6ZW9mKG1zZy0+
cnhfbWljX2tleSksICJpbmNvbnNpc3RlbnQgZGF0YSIpOwotCW1zZy0+a2V5X2lkID0ga2V5LT5r
ZXlpZHg7Ci0JbWVtY3B5KG1zZy0+cnhfc2VxdWVuY2VfY291bnRlciwKLQkgICAgICAgJnNlcS0+
dGtpcC5pdjE2LCBzaXplb2Yoc2VxLT50a2lwLml2MTYpKTsKLQltZW1jcHkobXNnLT5yeF9zZXF1
ZW5jZV9jb3VudGVyICsgc2l6ZW9mKHUxNiksCi0JICAgICAgICZzZXEtPnRraXAuaXYzMiwgc2l6
ZW9mKHNlcS0+dGtpcC5pdjMyKSk7Ci0JbWVtY3B5KG1zZy0+dGtpcF9rZXlfZGF0YSwga2V5YnVm
LCBzaXplb2YobXNnLT50a2lwX2tleV9kYXRhKSk7Ci0Ja2V5YnVmICs9IHNpemVvZihtc2ctPnRr
aXBfa2V5X2RhdGEpOwotCWlmIChpZnR5cGUgPT0gTkw4MDIxMV9JRlRZUEVfQVApCi0JCS8qIFVz
ZSBUeCBNSUMgS2V5ICovCi0JCW1lbWNweShtc2ctPnJ4X21pY19rZXksIGtleWJ1ZiArIDAsIHNp
emVvZihtc2ctPnJ4X21pY19rZXkpKTsKLQllbHNlCi0JCS8qIFVzZSBSeCBNSUMgS2V5ICovCi0J
CW1lbWNweShtc2ctPnJ4X21pY19rZXksIGtleWJ1ZiArIDgsIHNpemVvZihtc2ctPnJ4X21pY19r
ZXkpKTsKLQlyZXR1cm4gSElGX0tFWV9UWVBFX1RLSVBfR1JPVVA7Ci19Ci0KLXN0YXRpYyB1OCBm
aWxsX2NjbXBfcGFpcihzdHJ1Y3QgaGlmX2Flc19wYWlyd2lzZV9rZXkgKm1zZywKLQkJCSBzdHJ1
Y3QgaWVlZTgwMjExX2tleV9jb25mICprZXksIHU4ICpwZWVyX2FkZHIpCi17Ci0JV0FSTihrZXkt
PmtleWxlbiAhPSBzaXplb2YobXNnLT5hZXNfa2V5X2RhdGEpLCAiaW5jb25zaXN0ZW50IGRhdGEi
KTsKLQlldGhlcl9hZGRyX2NvcHkobXNnLT5wZWVyX2FkZHJlc3MsIHBlZXJfYWRkcik7Ci0JbWVt
Y3B5KG1zZy0+YWVzX2tleV9kYXRhLCBrZXktPmtleSwga2V5LT5rZXlsZW4pOwotCXJldHVybiBI
SUZfS0VZX1RZUEVfQUVTX1BBSVJXSVNFOwotfQotCi1zdGF0aWMgdTggZmlsbF9jY21wX2dyb3Vw
KHN0cnVjdCBoaWZfYWVzX2dyb3VwX2tleSAqbXNnLAotCQkJICBzdHJ1Y3QgaWVlZTgwMjExX2tl
eV9jb25mICprZXksCi0JCQkgIHN0cnVjdCBpZWVlODAyMTFfa2V5X3NlcSAqc2VxKQotewotCVdB
Uk4oa2V5LT5rZXlsZW4gIT0gc2l6ZW9mKG1zZy0+YWVzX2tleV9kYXRhKSwgImluY29uc2lzdGVu
dCBkYXRhIik7Ci0JbWVtY3B5KG1zZy0+YWVzX2tleV9kYXRhLCBrZXktPmtleSwga2V5LT5rZXls
ZW4pOwotCW1lbWNweShtc2ctPnJ4X3NlcXVlbmNlX2NvdW50ZXIsIHNlcS0+Y2NtcC5wbiwgc2l6
ZW9mKHNlcS0+Y2NtcC5wbikpOwotCW1lbXJldmVyc2UobXNnLT5yeF9zZXF1ZW5jZV9jb3VudGVy
LCBzaXplb2Yoc2VxLT5jY21wLnBuKSk7Ci0JbXNnLT5rZXlfaWQgPSBrZXktPmtleWlkeDsKLQly
ZXR1cm4gSElGX0tFWV9UWVBFX0FFU19HUk9VUDsKLX0KLQotc3RhdGljIHU4IGZpbGxfc21zNF9w
YWlyKHN0cnVjdCBoaWZfd2FwaV9wYWlyd2lzZV9rZXkgKm1zZywKLQkJCSBzdHJ1Y3QgaWVlZTgw
MjExX2tleV9jb25mICprZXksIHU4ICpwZWVyX2FkZHIpCi17Ci0JdTggKmtleWJ1ZiA9IGtleS0+
a2V5OwotCi0JV0FSTihrZXktPmtleWxlbiAhPSBzaXplb2YobXNnLT53YXBpX2tleV9kYXRhKQot
CQkJICAgICsgc2l6ZW9mKG1zZy0+bWljX2tleV9kYXRhKSwgImluY29uc2lzdGVudCBkYXRhIik7
Ci0JZXRoZXJfYWRkcl9jb3B5KG1zZy0+cGVlcl9hZGRyZXNzLCBwZWVyX2FkZHIpOwotCW1lbWNw
eShtc2ctPndhcGlfa2V5X2RhdGEsIGtleWJ1Ziwgc2l6ZW9mKG1zZy0+d2FwaV9rZXlfZGF0YSkp
OwotCWtleWJ1ZiArPSBzaXplb2YobXNnLT53YXBpX2tleV9kYXRhKTsKLQltZW1jcHkobXNnLT5t
aWNfa2V5X2RhdGEsIGtleWJ1Ziwgc2l6ZW9mKG1zZy0+bWljX2tleV9kYXRhKSk7Ci0JbXNnLT5r
ZXlfaWQgPSBrZXktPmtleWlkeDsKLQlyZXR1cm4gSElGX0tFWV9UWVBFX1dBUElfUEFJUldJU0U7
Ci19Ci0KLXN0YXRpYyB1OCBmaWxsX3NtczRfZ3JvdXAoc3RydWN0IGhpZl93YXBpX2dyb3VwX2tl
eSAqbXNnLAotCQkJICBzdHJ1Y3QgaWVlZTgwMjExX2tleV9jb25mICprZXkpCi17Ci0JdTggKmtl
eWJ1ZiA9IGtleS0+a2V5OwotCi0JV0FSTihrZXktPmtleWxlbiAhPSBzaXplb2YobXNnLT53YXBp
X2tleV9kYXRhKQotCQkJICAgICsgc2l6ZW9mKG1zZy0+bWljX2tleV9kYXRhKSwgImluY29uc2lz
dGVudCBkYXRhIik7Ci0JbWVtY3B5KG1zZy0+d2FwaV9rZXlfZGF0YSwga2V5YnVmLCBzaXplb2Yo
bXNnLT53YXBpX2tleV9kYXRhKSk7Ci0Ja2V5YnVmICs9IHNpemVvZihtc2ctPndhcGlfa2V5X2Rh
dGEpOwotCW1lbWNweShtc2ctPm1pY19rZXlfZGF0YSwga2V5YnVmLCBzaXplb2YobXNnLT5taWNf
a2V5X2RhdGEpKTsKLQltc2ctPmtleV9pZCA9IGtleS0+a2V5aWR4OwotCXJldHVybiBISUZfS0VZ
X1RZUEVfV0FQSV9HUk9VUDsKLX0KLQotc3RhdGljIHU4IGZpbGxfYWVzX2NtYWNfZ3JvdXAoc3Ry
dWN0IGhpZl9pZ3RrX2dyb3VwX2tleSAqbXNnLAotCQkJICAgICAgc3RydWN0IGllZWU4MDIxMV9r
ZXlfY29uZiAqa2V5LAotCQkJICAgICAgc3RydWN0IGllZWU4MDIxMV9rZXlfc2VxICpzZXEpCi17
Ci0JV0FSTihrZXktPmtleWxlbiAhPSBzaXplb2YobXNnLT5pZ3RrX2tleV9kYXRhKSwgImluY29u
c2lzdGVudCBkYXRhIik7Ci0JbWVtY3B5KG1zZy0+aWd0a19rZXlfZGF0YSwga2V5LT5rZXksIGtl
eS0+a2V5bGVuKTsKLQltZW1jcHkobXNnLT5pcG4sIHNlcS0+YWVzX2NtYWMucG4sIHNpemVvZihz
ZXEtPmFlc19jbWFjLnBuKSk7Ci0JbWVtcmV2ZXJzZShtc2ctPmlwbiwgc2l6ZW9mKHNlcS0+YWVz
X2NtYWMucG4pKTsKLQltc2ctPmtleV9pZCA9IGtleS0+a2V5aWR4OwotCXJldHVybiBISUZfS0VZ
X1RZUEVfSUdUS19HUk9VUDsKLX0KLQotc3RhdGljIGludCB3ZnhfYWRkX2tleShzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZiwgc3RydWN0IGllZWU4MDIxMV9zdGEgKnN0YSwKLQkJICAgICAgIHN0cnVjdCBp
ZWVlODAyMTFfa2V5X2NvbmYgKmtleSkKLXsKLQlpbnQgcmV0OwotCXN0cnVjdCBoaWZfcmVxX2Fk
ZF9rZXkgayA9IHsgfTsKLQlzdHJ1Y3QgaWVlZTgwMjExX2tleV9zZXEgc2VxOwotCXN0cnVjdCB3
ZnhfZGV2ICp3ZGV2ID0gd3ZpZi0+d2RldjsKLQlpbnQgaWR4ID0gd2Z4X2FsbG9jX2tleSh3dmlm
LT53ZGV2KTsKLQlib29sIHBhaXJ3aXNlID0ga2V5LT5mbGFncyAmIElFRUU4MDIxMV9LRVlfRkxB
R19QQUlSV0lTRTsKLQotCVdBUk4oa2V5LT5mbGFncyAmIElFRUU4MDIxMV9LRVlfRkxBR19QQUlS
V0lTRSAmJiAhc3RhLCAiaW5jb25zaXN0ZW50IGRhdGEiKTsKLQlpZWVlODAyMTFfZ2V0X2tleV9y
eF9zZXEoa2V5LCAwLCAmc2VxKTsKLQlpZiAoaWR4IDwgMCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0J
ay5pbnRfaWQgPSB3dmlmLT5pZDsKLQlrLmVudHJ5X2luZGV4ID0gaWR4OwotCWlmIChrZXktPmNp
cGhlciA9PSBXTEFOX0NJUEhFUl9TVUlURV9XRVA0MCB8fAotCSAgICBrZXktPmNpcGhlciA9PSBX
TEFOX0NJUEhFUl9TVUlURV9XRVAxMDQpIHsKLQkJaWYgKHBhaXJ3aXNlKQotCQkJay50eXBlID0g
ZmlsbF93ZXBfcGFpcigmay5rZXkud2VwX3BhaXJ3aXNlX2tleSwga2V5LAotCQkJCQkgICAgICAg
c3RhLT5hZGRyKTsKLQkJZWxzZQotCQkJay50eXBlID0gZmlsbF93ZXBfZ3JvdXAoJmsua2V5Lndl
cF9ncm91cF9rZXksIGtleSk7Ci0JfSBlbHNlIGlmIChrZXktPmNpcGhlciA9PSBXTEFOX0NJUEhF
Ul9TVUlURV9US0lQKSB7Ci0JCWlmIChwYWlyd2lzZSkKLQkJCWsudHlwZSA9IGZpbGxfdGtpcF9w
YWlyKCZrLmtleS50a2lwX3BhaXJ3aXNlX2tleSwga2V5LAotCQkJCQkJc3RhLT5hZGRyKTsKLQkJ
ZWxzZQotCQkJay50eXBlID0gZmlsbF90a2lwX2dyb3VwKCZrLmtleS50a2lwX2dyb3VwX2tleSwg
a2V5LAotCQkJCQkJICZzZXEsIHd2aWYtPnZpZi0+dHlwZSk7Ci0JfSBlbHNlIGlmIChrZXktPmNp
cGhlciA9PSBXTEFOX0NJUEhFUl9TVUlURV9DQ01QKSB7Ci0JCWlmIChwYWlyd2lzZSkKLQkJCWsu
dHlwZSA9IGZpbGxfY2NtcF9wYWlyKCZrLmtleS5hZXNfcGFpcndpc2Vfa2V5LCBrZXksCi0JCQkJ
CQlzdGEtPmFkZHIpOwotCQllbHNlCi0JCQlrLnR5cGUgPSBmaWxsX2NjbXBfZ3JvdXAoJmsua2V5
LmFlc19ncm91cF9rZXksIGtleSwKLQkJCQkJCSAmc2VxKTsKLQl9IGVsc2UgaWYgKGtleS0+Y2lw
aGVyID09IFdMQU5fQ0lQSEVSX1NVSVRFX1NNUzQpIHsKLQkJaWYgKHBhaXJ3aXNlKQotCQkJay50
eXBlID0gZmlsbF9zbXM0X3BhaXIoJmsua2V5LndhcGlfcGFpcndpc2Vfa2V5LCBrZXksCi0JCQkJ
CQlzdGEtPmFkZHIpOwotCQllbHNlCi0JCQlrLnR5cGUgPSBmaWxsX3NtczRfZ3JvdXAoJmsua2V5
LndhcGlfZ3JvdXBfa2V5LCBrZXkpOwotCX0gZWxzZSBpZiAoa2V5LT5jaXBoZXIgPT0gV0xBTl9D
SVBIRVJfU1VJVEVfQUVTX0NNQUMpIHsKLQkJay50eXBlID0gZmlsbF9hZXNfY21hY19ncm91cCgm
ay5rZXkuaWd0a19ncm91cF9rZXksIGtleSwgJnNlcSk7Ci0JCWtleS0+ZmxhZ3MgfD0gSUVFRTgw
MjExX0tFWV9GTEFHX0dFTkVSQVRFX01NSUU7Ci0JfSBlbHNlIHsKLQkJZGV2X3dhcm4od2Rldi0+
ZGV2LCAidW5zdXBwb3J0ZWQga2V5IHR5cGUgJWRcbiIsIGtleS0+Y2lwaGVyKTsKLQkJd2Z4X2Zy
ZWVfa2V5KHdkZXYsIGlkeCk7Ci0JCXJldHVybiAtRU9QTk9UU1VQUDsKLQl9Ci0JcmV0ID0gaGlm
X2FkZF9rZXkod2RldiwgJmspOwotCWlmIChyZXQpIHsKLQkJd2Z4X2ZyZWVfa2V5KHdkZXYsIGlk
eCk7Ci0JCXJldHVybiAtRU9QTk9UU1VQUDsKLQl9Ci0Ja2V5LT5mbGFncyB8PSBJRUVFODAyMTFf
S0VZX0ZMQUdfUFVUX0lWX1NQQUNFIHwKLQkJICAgICAgSUVFRTgwMjExX0tFWV9GTEFHX1JFU0VS
VkVfVEFJTFJPT007Ci0Ja2V5LT5od19rZXlfaWR4ID0gaWR4OwotCXJldHVybiAwOwotfQotCi1z
dGF0aWMgaW50IHdmeF9yZW1vdmVfa2V5KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgaWVl
ZTgwMjExX2tleV9jb25mICprZXkpCi17Ci0JV0FSTihrZXktPmh3X2tleV9pZHggPj0gTUFYX0tF
WV9FTlRSSUVTLCAiY29ycnVwdGVkIGh3X2tleV9pZHgiKTsKLQl3ZnhfZnJlZV9rZXkod3ZpZi0+
d2Rldiwga2V5LT5od19rZXlfaWR4KTsKLQlyZXR1cm4gaGlmX3JlbW92ZV9rZXkod3ZpZi0+d2Rl
diwga2V5LT5od19rZXlfaWR4KTsKLX0KLQotaW50IHdmeF9zZXRfa2V5KHN0cnVjdCBpZWVlODAy
MTFfaHcgKmh3LCBlbnVtIHNldF9rZXlfY21kIGNtZCwKLQkJc3RydWN0IGllZWU4MDIxMV92aWYg
KnZpZiwgc3RydWN0IGllZWU4MDIxMV9zdGEgKnN0YSwKLQkJc3RydWN0IGllZWU4MDIxMV9rZXlf
Y29uZiAqa2V5KQotewotCWludCByZXQgPSAtRU9QTk9UU1VQUDsKLQlzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiA9IChzdHJ1Y3Qgd2Z4X3ZpZiAqKXZpZi0+ZHJ2X3ByaXY7Ci0KLQltdXRleF9sb2NrKCZ3
dmlmLT53ZGV2LT5jb25mX211dGV4KTsKLQlpZiAoY21kID09IFNFVF9LRVkpCi0JCXJldCA9IHdm
eF9hZGRfa2V5KHd2aWYsIHN0YSwga2V5KTsKLQlpZiAoY21kID09IERJU0FCTEVfS0VZKQotCQly
ZXQgPSB3ZnhfcmVtb3ZlX2tleSh3dmlmLCBrZXkpOwotCW11dGV4X3VubG9jaygmd3ZpZi0+d2Rl
di0+Y29uZl9tdXRleCk7Ci0JcmV0dXJuIHJldDsKLX0KLQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9z
dGFnaW5nL3dmeC9rZXkuaCBiL2RyaXZlcnMvc3RhZ2luZy93Zngva2V5LmgKZGVsZXRlZCBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDJkMTM1ZWZmN2FmMi4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZl
cnMvc3RhZ2luZy93Zngva2V5LmgKKysrIC9kZXYvbnVsbApAQCAtMSwyMCArMCwwIEBACi0vKiBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCi0vKgotICogS2V5IG1hbmFn
ZW1lbnQgcmVsYXRlZCBmdW5jdGlvbnMuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAs
IFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIFNULUVy
aWNzc29uCi0gKi8KLSNpZm5kZWYgV0ZYX0tFWV9ICi0jZGVmaW5lIFdGWF9LRVlfSAotCi0jaW5j
bHVkZSA8bmV0L21hYzgwMjExLmg+Ci0KLXN0cnVjdCB3ZnhfZGV2Owotc3RydWN0IHdmeF92aWY7
Ci0KLWludCB3Znhfc2V0X2tleShzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgZW51bSBzZXRfa2V5
X2NtZCBjbWQsCi0JCXN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsIHN0cnVjdCBpZWVlODAyMTFf
c3RhICpzdGEsCi0JCXN0cnVjdCBpZWVlODAyMTFfa2V5X2NvbmYgKmtleSk7Ci0KLSNlbmRpZgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9tYWluLmMgYi9kcml2ZXJzL3N0YWdpbmcv
d2Z4L21haW4uYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggODU4ZDc3OGNjNTg5Li4w
MDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9tYWluLmMKKysrIC9kZXYvbnVs
bApAQCAtMSw1MDYgKzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seQotLyoKLSAqIERldmljZSBwcm9iZSBhbmQgcmVnaXN0ZXIuCi0gKgotICogQ29weXJpZ2h0
IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQg
KGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDgsIEpvaGFubmVzIEJl
cmcgPGpvaGFubmVzQHNpcHNvbHV0aW9ucy5uZXQ+Ci0gKiBDb3B5cmlnaHQgKGMpIDIwMDggTm9r
aWEgQ29ycG9yYXRpb24gYW5kL29yIGl0cyBzdWJzaWRpYXJ5KC1pZXMpLgotICogQ29weXJpZ2h0
IChjKSAyMDA3LTIwMDksIENocmlzdGlhbiBMYW1wYXJ0ZXIgPGNodW5rZWV5QHdlYi5kZT4KLSAq
IENvcHlyaWdodCAoYykgMjAwNiwgTWljaGFlbCBXdSA8ZmxhbWluZ2ljZUBzb3VybWlsay5uZXQ+
Ci0gKiBDb3B5cmlnaHQgKGMpIDIwMDQtMjAwNiBKZWFuLUJhcHRpc3RlIE5vdGUgPGpibm90ZUBn
bWFpbC5jb20+LCBldCBhbC4KLSAqLwotI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgotI2luY2x1
ZGUgPGxpbnV4L29mLmg+Ci0jaW5jbHVkZSA8bGludXgvb2ZfbmV0Lmg+Ci0jaW5jbHVkZSA8bGlu
dXgvZ3Bpby9jb25zdW1lci5oPgotI2luY2x1ZGUgPGxpbnV4L21tYy9zZGlvX2Z1bmMuaD4KLSNp
bmNsdWRlIDxsaW51eC9zcGkvc3BpLmg+Ci0jaW5jbHVkZSA8bGludXgvZXRoZXJkZXZpY2UuaD4K
LSNpbmNsdWRlIDxsaW51eC9maXJtd2FyZS5oPgotCi0jaW5jbHVkZSAibWFpbi5oIgotI2luY2x1
ZGUgIndmeC5oIgotI2luY2x1ZGUgImZ3aW8uaCIKLSNpbmNsdWRlICJod2lvLmgiCi0jaW5jbHVk
ZSAiYnVzLmgiCi0jaW5jbHVkZSAiYmguaCIKLSNpbmNsdWRlICJzdGEuaCIKLSNpbmNsdWRlICJr
ZXkuaCIKLSNpbmNsdWRlICJzY2FuLmgiCi0jaW5jbHVkZSAiZGVidWcuaCIKLSNpbmNsdWRlICJk
YXRhX3R4LmgiCi0jaW5jbHVkZSAiaGlmX3R4X21pYi5oIgotI2luY2x1ZGUgImhpZl9hcGlfY21k
LmgiCi0KLSNkZWZpbmUgV0ZYX1BEU19NQVhfU0laRSAxNTAwCi0KLU1PRFVMRV9ERVNDUklQVElP
TigiU2lsaWNvbiBMYWJzIDgwMi4xMSBXaXJlbGVzcyBMQU4gZHJpdmVyIGZvciBXRjIwMCIpOwot
TU9EVUxFX0FVVEhPUigiSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMu
Y29tPiIpOwotTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwotCi0jZGVmaW5lIFJBVEVUQUJfRU5UKF9y
YXRlLCBfcmF0ZWlkLCBfZmxhZ3MpIHsgXAotCS5iaXRyYXRlICA9IChfcmF0ZSksICAgXAotCS5o
d192YWx1ZSA9IChfcmF0ZWlkKSwgXAotCS5mbGFncyAgICA9IChfZmxhZ3MpLCAgXAotfQotCi1z
dGF0aWMgc3RydWN0IGllZWU4MDIxMV9yYXRlIHdmeF9yYXRlc1tdID0gewotCVJBVEVUQUJfRU5U
KDEwLCAgMCwgIDApLAotCVJBVEVUQUJfRU5UKDIwLCAgMSwgIElFRUU4MDIxMV9SQVRFX1NIT1JU
X1BSRUFNQkxFKSwKLQlSQVRFVEFCX0VOVCg1NSwgIDIsICBJRUVFODAyMTFfUkFURV9TSE9SVF9Q
UkVBTUJMRSksCi0JUkFURVRBQl9FTlQoMTEwLCAzLCAgSUVFRTgwMjExX1JBVEVfU0hPUlRfUFJF
QU1CTEUpLAotCVJBVEVUQUJfRU5UKDYwLCAgNiwgIDApLAotCVJBVEVUQUJfRU5UKDkwLCAgNywg
IDApLAotCVJBVEVUQUJfRU5UKDEyMCwgOCwgIDApLAotCVJBVEVUQUJfRU5UKDE4MCwgOSwgIDAp
LAotCVJBVEVUQUJfRU5UKDI0MCwgMTAsIDApLAotCVJBVEVUQUJfRU5UKDM2MCwgMTEsIDApLAot
CVJBVEVUQUJfRU5UKDQ4MCwgMTIsIDApLAotCVJBVEVUQUJfRU5UKDU0MCwgMTMsIDApLAotfTsK
LQotI2RlZmluZSBDSEFOMkcoX2NoYW5uZWwsIF9mcmVxLCBfZmxhZ3MpIHsgXAotCS5iYW5kID0g
Tkw4MDIxMV9CQU5EXzJHSFosIFwKLQkuY2VudGVyX2ZyZXEgPSAoX2ZyZXEpLCAgICBcCi0JLmh3
X3ZhbHVlID0gKF9jaGFubmVsKSwgICAgXAotCS5mbGFncyA9IChfZmxhZ3MpLCAgICAgICAgIFwK
LQkubWF4X2FudGVubmFfZ2FpbiA9IDAsICAgICBcCi0JLm1heF9wb3dlciA9IDMwLCAgICAgICAg
ICAgXAotfQotCi1zdGF0aWMgc3RydWN0IGllZWU4MDIxMV9jaGFubmVsIHdmeF8yZ2h6X2NoYW50
YWJsZVtdID0gewotCUNIQU4yRygxLCAgMjQxMiwgMCksCi0JQ0hBTjJHKDIsICAyNDE3LCAwKSwK
LQlDSEFOMkcoMywgIDI0MjIsIDApLAotCUNIQU4yRyg0LCAgMjQyNywgMCksCi0JQ0hBTjJHKDUs
ICAyNDMyLCAwKSwKLQlDSEFOMkcoNiwgIDI0MzcsIDApLAotCUNIQU4yRyg3LCAgMjQ0MiwgMCks
Ci0JQ0hBTjJHKDgsICAyNDQ3LCAwKSwKLQlDSEFOMkcoOSwgIDI0NTIsIDApLAotCUNIQU4yRygx
MCwgMjQ1NywgMCksCi0JQ0hBTjJHKDExLCAyNDYyLCAwKSwKLQlDSEFOMkcoMTIsIDI0NjcsIDAp
LAotCUNIQU4yRygxMywgMjQ3MiwgMCksCi0JQ0hBTjJHKDE0LCAyNDg0LCAwKSwKLX07Ci0KLXN0
YXRpYyBjb25zdCBzdHJ1Y3QgaWVlZTgwMjExX3N1cHBvcnRlZF9iYW5kIHdmeF9iYW5kXzJnaHog
PSB7Ci0JLmNoYW5uZWxzID0gd2Z4XzJnaHpfY2hhbnRhYmxlLAotCS5uX2NoYW5uZWxzID0gQVJS
QVlfU0laRSh3ZnhfMmdoel9jaGFudGFibGUpLAotCS5iaXRyYXRlcyA9IHdmeF9yYXRlcywKLQku
bl9iaXRyYXRlcyA9IEFSUkFZX1NJWkUod2Z4X3JhdGVzKSwKLQkuaHRfY2FwID0gewotCQkvKiBS
ZWNlaXZlIGNhcHMgKi8KLQkJLmNhcCA9IElFRUU4MDIxMV9IVF9DQVBfR1JOX0ZMRCB8IElFRUU4
MDIxMV9IVF9DQVBfU0dJXzIwIHwKLQkJICAgICAgIElFRUU4MDIxMV9IVF9DQVBfTUFYX0FNU0RV
IHwKLQkJICAgICAgICgxIDw8IElFRUU4MDIxMV9IVF9DQVBfUlhfU1RCQ19TSElGVCksCi0JCS5o
dF9zdXBwb3J0ZWQgPSAxLAotCQkuYW1wZHVfZmFjdG9yID0gSUVFRTgwMjExX0hUX01BWF9BTVBE
VV8xNkssCi0JCS5hbXBkdV9kZW5zaXR5ID0gSUVFRTgwMjExX0hUX01QRFVfREVOU0lUWV9OT05F
LAotCQkubWNzID0gewotCQkJLnJ4X21hc2sgPSB7IDB4RkYgfSwgLyogTUNTMCB0byBNQ1M3ICov
Ci0JCQkucnhfaGlnaGVzdCA9IGNwdV90b19sZTE2KDcyKSwKLQkJCS50eF9wYXJhbXMgPSBJRUVF
ODAyMTFfSFRfTUNTX1RYX0RFRklORUQsCi0JCX0sCi0JfSwKLX07Ci0KLXN0YXRpYyBjb25zdCBz
dHJ1Y3QgaWVlZTgwMjExX2lmYWNlX2xpbWl0IHdkZXZfaWZhY2VfbGltaXRzW10gPSB7Ci0JeyAu
bWF4ID0gMSwgLnR5cGVzID0gQklUKE5MODAyMTFfSUZUWVBFX1NUQVRJT04pIH0sCi0JeyAubWF4
ID0gMSwgLnR5cGVzID0gQklUKE5MODAyMTFfSUZUWVBFX0FQKSB9LAotfTsKLQotc3RhdGljIGNv
bnN0IHN0cnVjdCBpZWVlODAyMTFfaWZhY2VfY29tYmluYXRpb24gd2Z4X2lmYWNlX2NvbWJpbmF0
aW9uc1tdID0gewotCXsKLQkJLm51bV9kaWZmZXJlbnRfY2hhbm5lbHMgPSAyLAotCQkubWF4X2lu
dGVyZmFjZXMgPSAyLAotCQkubGltaXRzID0gd2Rldl9pZmFjZV9saW1pdHMsCi0JCS5uX2xpbWl0
cyA9IEFSUkFZX1NJWkUod2Rldl9pZmFjZV9saW1pdHMpLAotCX0KLX07Ci0KLXN0YXRpYyBjb25z
dCBzdHJ1Y3QgaWVlZTgwMjExX29wcyB3Znhfb3BzID0gewotCS5zdGFydAkJCT0gd2Z4X3N0YXJ0
LAotCS5zdG9wCQkJPSB3Znhfc3RvcCwKLQkuYWRkX2ludGVyZmFjZQkJPSB3ZnhfYWRkX2ludGVy
ZmFjZSwKLQkucmVtb3ZlX2ludGVyZmFjZQk9IHdmeF9yZW1vdmVfaW50ZXJmYWNlLAotCS5jb25m
aWcgICAgICAgICAgICAgICAgID0gd2Z4X2NvbmZpZywKLQkudHgJCQk9IHdmeF90eCwKLQkuam9p
bl9pYnNzCQk9IHdmeF9qb2luX2lic3MsCi0JLmxlYXZlX2lic3MJCT0gd2Z4X2xlYXZlX2lic3Ms
Ci0JLmNvbmZfdHgJCT0gd2Z4X2NvbmZfdHgsCi0JLmh3X3NjYW4JCT0gd2Z4X2h3X3NjYW4sCi0J
LmNhbmNlbF9od19zY2FuCQk9IHdmeF9jYW5jZWxfaHdfc2NhbiwKLQkuc3RhcnRfYXAJCT0gd2Z4
X3N0YXJ0X2FwLAotCS5zdG9wX2FwCQk9IHdmeF9zdG9wX2FwLAotCS5zdGFfYWRkCQk9IHdmeF9z
dGFfYWRkLAotCS5zdGFfcmVtb3ZlCQk9IHdmeF9zdGFfcmVtb3ZlLAotCS5zZXRfdGltCQk9IHdm
eF9zZXRfdGltLAotCS5zZXRfa2V5CQk9IHdmeF9zZXRfa2V5LAotCS5zZXRfcnRzX3RocmVzaG9s
ZAk9IHdmeF9zZXRfcnRzX3RocmVzaG9sZCwKLQkuc2V0X2RlZmF1bHRfdW5pY2FzdF9rZXkgPSB3
Znhfc2V0X2RlZmF1bHRfdW5pY2FzdF9rZXksCi0JLmJzc19pbmZvX2NoYW5nZWQJPSB3ZnhfYnNz
X2luZm9fY2hhbmdlZCwKLQkuY29uZmlndXJlX2ZpbHRlcgk9IHdmeF9jb25maWd1cmVfZmlsdGVy
LAotCS5hbXBkdV9hY3Rpb24JCT0gd2Z4X2FtcGR1X2FjdGlvbiwKLQkuZmx1c2gJCQk9IHdmeF9m
bHVzaCwKLQkuYWRkX2NoYW5jdHgJCT0gd2Z4X2FkZF9jaGFuY3R4LAotCS5yZW1vdmVfY2hhbmN0
eAkJPSB3ZnhfcmVtb3ZlX2NoYW5jdHgsCi0JLmNoYW5nZV9jaGFuY3R4CQk9IHdmeF9jaGFuZ2Vf
Y2hhbmN0eCwKLQkuYXNzaWduX3ZpZl9jaGFuY3R4CT0gd2Z4X2Fzc2lnbl92aWZfY2hhbmN0eCwK
LQkudW5hc3NpZ25fdmlmX2NoYW5jdHgJPSB3ZnhfdW5hc3NpZ25fdmlmX2NoYW5jdHgsCi19Owot
Ci1ib29sIHdmeF9hcGlfb2xkZXJfdGhhbihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IG1ham9y
LCBpbnQgbWlub3IpCi17Ci0JaWYgKHdkZXYtPmh3X2NhcHMuYXBpX3ZlcnNpb25fbWFqb3IgPCBt
YWpvcikKLQkJcmV0dXJuIHRydWU7Ci0JaWYgKHdkZXYtPmh3X2NhcHMuYXBpX3ZlcnNpb25fbWFq
b3IgPiBtYWpvcikKLQkJcmV0dXJuIGZhbHNlOwotCWlmICh3ZGV2LT5od19jYXBzLmFwaV92ZXJz
aW9uX21pbm9yIDwgbWlub3IpCi0JCXJldHVybiB0cnVlOwotCXJldHVybiBmYWxzZTsKLX0KLQot
LyogVGhlIGRldmljZSBuZWVkcyBkYXRhIGFib3V0IHRoZSBhbnRlbm5hIGNvbmZpZ3VyYXRpb24u
IFRoaXMgaW5mb3JtYXRpb24gaW4KLSAqIHByb3ZpZGVkIGJ5IFBEUyAoUGxhdGZvcm0gRGF0YSBT
ZXQsIHRoaXMgaXMgdGhlIHdvcmRpbmcgdXNlZCBpbiBXRjIwMAotICogZG9jdW1lbnRhdGlvbikg
ZmlsZXMuIEZvciBoYXJkd2FyZSBpbnRlZ3JhdG9ycywgdGhlIGZ1bGwgcHJvY2VzcyB0byBjcmVh
dGUKLSAqIFBEUyBmaWxlcyBpcyBkZXNjcmliZWQgaGVyZToKLSAqICAgaHR0cHM6Z2l0aHViLmNv
bS9TaWxpY29uTGFicy93ZngtZmlybXdhcmUvYmxvYi9tYXN0ZXIvUERTL1JFQURNRS5tZAotICoK
LSAqIFNvIHRoaXMgZnVuY3Rpb24gYWltcyB0byBzZW5kIFBEUyB0byB0aGUgZGV2aWNlLiBIb3dl
dmVyLCB0aGUgUERTIGZpbGUgaXMKLSAqIG9mdGVuIGJpZ2dlciB0aGFuIFJ4IGJ1ZmZlcnMgb2Yg
dGhlIGNoaXAsIHNvIGl0IGhhcyB0byBiZSBzZW50IGluIG11bHRpcGxlCi0gKiBwYXJ0cy4KLSAq
Ci0gKiBJbiBhZGQsIHRoZSBQRFMgZGF0YSBjYW5ub3QgYmUgc3BsaXQgYW55d2hlcmUuIFRoZSBQ
RFMgZmlsZXMgY29udGFpbnMgdHJlZQotICogc3RydWN0dXJlcy4gQnJhY2VzIGFyZSB1c2VkIHRv
IGVudGVyL2xlYXZlIGEgbGV2ZWwgb2YgdGhlIHRyZWUgKGluIGEgSlNPTgotICogZmFzaGlvbiku
IFBEUyBmaWxlcyBjYW4gb25seSBiZWVuIHNwbGl0IGJldHdlZW4gcm9vdCBub2Rlcy4KLSAqLwot
aW50IHdmeF9zZW5kX3BkcyhzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTggKmJ1Ziwgc2l6ZV90IGxl
bikKLXsKLQlpbnQgcmV0OwotCWludCBzdGFydCwgYnJhY2VfbGV2ZWwsIGk7Ci0KLQlzdGFydCA9
IDA7Ci0JYnJhY2VfbGV2ZWwgPSAwOwotCWlmIChidWZbMF0gIT0gJ3snKSB7Ci0JCWRldl9lcnIo
d2Rldi0+ZGV2LCAidmFsaWQgUERTIHN0YXJ0IHdpdGggJ3snLiBEaWQgeW91IGZvcmdldCB0byBj
b21wcmVzcyBpdD9cbiIpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0JZm9yIChpID0gMTsgaSA8
IGxlbiAtIDE7IGkrKykgewotCQlpZiAoYnVmW2ldID09ICd7JykKLQkJCWJyYWNlX2xldmVsKys7
Ci0JCWlmIChidWZbaV0gPT0gJ30nKQotCQkJYnJhY2VfbGV2ZWwtLTsKLQkJaWYgKGJ1ZltpXSA9
PSAnfScgJiYgIWJyYWNlX2xldmVsKSB7Ci0JCQlpKys7Ci0JCQlpZiAoaSAtIHN0YXJ0ICsgMSA+
IFdGWF9QRFNfTUFYX1NJWkUpCi0JCQkJcmV0dXJuIC1FRkJJRzsKLQkJCWJ1ZltzdGFydF0gPSAn
eyc7Ci0JCQlidWZbaV0gPSAwOwotCQkJZGV2X2RiZyh3ZGV2LT5kZXYsICJzZW5kIFBEUyAnJXN9
J1xuIiwgYnVmICsgc3RhcnQpOwotCQkJYnVmW2ldID0gJ30nOwotCQkJcmV0ID0gaGlmX2NvbmZp
Z3VyYXRpb24od2RldiwgYnVmICsgc3RhcnQsCi0JCQkJCQlpIC0gc3RhcnQgKyAxKTsKLQkJCWlm
IChyZXQgPiAwKSB7Ci0JCQkJZGV2X2Vycih3ZGV2LT5kZXYsICJQRFMgYnl0ZXMgJWQgdG8gJWQ6
IGludmFsaWQgZGF0YSAodW5zdXBwb3J0ZWQgb3B0aW9ucz8pXG4iLAotCQkJCQlzdGFydCwgaSk7
Ci0JCQkJcmV0dXJuIC1FSU5WQUw7Ci0JCQl9Ci0JCQlpZiAocmV0ID09IC1FVElNRURPVVQpIHsK
LQkJCQlkZXZfZXJyKHdkZXYtPmRldiwgIlBEUyBieXRlcyAlZCB0byAlZDogY2hpcCBkaWRuJ3Qg
cmVwbHkgKGNvcnJ1cHRlZCBmaWxlPylcbiIsCi0JCQkJCXN0YXJ0LCBpKTsKLQkJCQlyZXR1cm4g
cmV0OwotCQkJfQotCQkJaWYgKHJldCkgewotCQkJCWRldl9lcnIod2Rldi0+ZGV2LCAiUERTIGJ5
dGVzICVkIHRvICVkOiBjaGlwIHJldHVybmVkIGFuIHVua25vd24gZXJyb3JcbiIsCi0JCQkJCXN0
YXJ0LCBpKTsKLQkJCQlyZXR1cm4gLUVJTzsKLQkJCX0KLQkJCWJ1ZltpXSA9ICcsJzsKLQkJCXN0
YXJ0ID0gaTsKLQkJfQotCX0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCB3Znhfc2VuZF9w
ZGF0YV9wZHMoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0JaW50IHJldCA9IDA7Ci0JY29uc3Qg
c3RydWN0IGZpcm13YXJlICpwZHM7Ci0JdTggKnRtcF9idWY7Ci0KLQlyZXQgPSByZXF1ZXN0X2Zp
cm13YXJlKCZwZHMsIHdkZXYtPnBkYXRhLmZpbGVfcGRzLCB3ZGV2LT5kZXYpOwotCWlmIChyZXQp
IHsKLQkJZGV2X2Vycih3ZGV2LT5kZXYsICJjYW4ndCBsb2FkIGFudGVubmEgcGFyYW1ldGVycyAo
UERTIGZpbGUgJXMpLiBUaGUgZGV2aWNlIG1heSBiZSB1bnN0YWJsZS5cbiIsCi0JCQl3ZGV2LT5w
ZGF0YS5maWxlX3Bkcyk7Ci0JCWdvdG8gZXJyMTsKLQl9Ci0JdG1wX2J1ZiA9IGttZW1kdXAocGRz
LT5kYXRhLCBwZHMtPnNpemUsIEdGUF9LRVJORUwpOwotCWlmICghdG1wX2J1ZikgewotCQlyZXQg
PSAtRU5PTUVNOwotCQlnb3RvIGVycjI7Ci0JfQotCXJldCA9IHdmeF9zZW5kX3Bkcyh3ZGV2LCB0
bXBfYnVmLCBwZHMtPnNpemUpOwotCWtmcmVlKHRtcF9idWYpOwotZXJyMjoKLQlyZWxlYXNlX2Zp
cm13YXJlKHBkcyk7Ci1lcnIxOgotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyB2b2lkIHdmeF9m
cmVlX2NvbW1vbih2b2lkICpkYXRhKQotewotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gZGF0YTsK
LQotCW11dGV4X2Rlc3Ryb3koJndkZXYtPnR4X3Bvd2VyX2xvb3BfaW5mb19sb2NrKTsKLQltdXRl
eF9kZXN0cm95KCZ3ZGV2LT5yeF9zdGF0c19sb2NrKTsKLQltdXRleF9kZXN0cm95KCZ3ZGV2LT5j
b25mX211dGV4KTsKLQlpZWVlODAyMTFfZnJlZV9odyh3ZGV2LT5odyk7Ci19Ci0KLXN0cnVjdCB3
ZnhfZGV2ICp3ZnhfaW5pdF9jb21tb24oc3RydWN0IGRldmljZSAqZGV2LAotCQkJCWNvbnN0IHN0
cnVjdCB3ZnhfcGxhdGZvcm1fZGF0YSAqcGRhdGEsCi0JCQkJY29uc3Qgc3RydWN0IGh3YnVzX29w
cyAqaHdidXNfb3BzLAotCQkJCXZvaWQgKmh3YnVzX3ByaXYpCi17Ci0Jc3RydWN0IGllZWU4MDIx
MV9odyAqaHc7Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXY7Ci0KLQlodyA9IGllZWU4MDIxMV9hbGxv
Y19odyhzaXplb2Yoc3RydWN0IHdmeF9kZXYpLCAmd2Z4X29wcyk7Ci0JaWYgKCFodykKLQkJcmV0
dXJuIE5VTEw7Ci0KLQlTRVRfSUVFRTgwMjExX0RFVihodywgZGV2KTsKLQotCWllZWU4MDIxMV9o
d19zZXQoaHcsIFRYX0FNUERVX1NFVFVQX0lOX0hXKTsKLQlpZWVlODAyMTFfaHdfc2V0KGh3LCBB
TVBEVV9BR0dSRUdBVElPTik7Ci0JaWVlZTgwMjExX2h3X3NldChodywgQ09OTkVDVElPTl9NT05J
VE9SKTsKLQlpZWVlODAyMTFfaHdfc2V0KGh3LCBSRVBPUlRTX1RYX0FDS19TVEFUVVMpOwotCWll
ZWU4MDIxMV9od19zZXQoaHcsIFNVUFBPUlRTX0RZTkFNSUNfUFMpOwotCWllZWU4MDIxMV9od19z
ZXQoaHcsIFNJR05BTF9EQk0pOwotCWllZWU4MDIxMV9od19zZXQoaHcsIFNVUFBPUlRTX1BTKTsK
LQlpZWVlODAyMTFfaHdfc2V0KGh3LCBNRlBfQ0FQQUJMRSk7Ci0KLQlody0+dmlmX2RhdGFfc2l6
ZSA9IHNpemVvZihzdHJ1Y3Qgd2Z4X3ZpZik7Ci0JaHctPnN0YV9kYXRhX3NpemUgPSBzaXplb2Yo
c3RydWN0IHdmeF9zdGFfcHJpdik7Ci0JaHctPnF1ZXVlcyA9IDQ7Ci0JaHctPm1heF9yYXRlcyA9
IDg7Ci0JaHctPm1heF9yYXRlX3RyaWVzID0gODsKLQlody0+ZXh0cmFfdHhfaGVhZHJvb20gPSBz
aXplb2Yoc3RydWN0IGhpZl9tc2cpCi0JCQkJKyBzaXplb2Yoc3RydWN0IGhpZl9yZXFfdHgpCi0J
CQkJKyA0IC8qIGFsaWdubWVudCAqLyArIDggLyogVEtJUCBJViAqLzsKLQlody0+d2lwaHktPmlu
dGVyZmFjZV9tb2RlcyA9IEJJVChOTDgwMjExX0lGVFlQRV9TVEFUSU9OKSB8Ci0JCQkJICAgICBC
SVQoTkw4MDIxMV9JRlRZUEVfQURIT0MpIHwKLQkJCQkgICAgIEJJVChOTDgwMjExX0lGVFlQRV9B
UCk7Ci0JaHctPndpcGh5LT5wcm9iZV9yZXNwX29mZmxvYWQgPSBOTDgwMjExX1BST0JFX1JFU1Bf
T0ZGTE9BRF9TVVBQT1JUX1dQUyB8Ci0JCQkJCU5MODAyMTFfUFJPQkVfUkVTUF9PRkZMT0FEX1NV
UFBPUlRfV1BTMiB8Ci0JCQkJCU5MODAyMTFfUFJPQkVfUkVTUF9PRkZMT0FEX1NVUFBPUlRfUDJQ
IHwKLQkJCQkJTkw4MDIxMV9QUk9CRV9SRVNQX09GRkxPQURfU1VQUE9SVF84MDIxMVU7Ci0JaHct
PndpcGh5LT5mZWF0dXJlcyB8PSBOTDgwMjExX0ZFQVRVUkVfQVBfU0NBTjsKLQlody0+d2lwaHkt
PmZsYWdzIHw9IFdJUEhZX0ZMQUdfQVBfUFJPQkVfUkVTUF9PRkZMT0FEOwotCWh3LT53aXBoeS0+
ZmxhZ3MgfD0gV0lQSFlfRkxBR19BUF9VQVBTRDsKLQlody0+d2lwaHktPm1heF9hcF9hc3NvY19z
dGEgPSBISUZfTElOS19JRF9NQVg7Ci0JaHctPndpcGh5LT5tYXhfc2Nhbl9zc2lkcyA9IDI7Ci0J
aHctPndpcGh5LT5tYXhfc2Nhbl9pZV9sZW4gPSBJRUVFODAyMTFfTUFYX0RBVEFfTEVOOwotCWh3
LT53aXBoeS0+bl9pZmFjZV9jb21iaW5hdGlvbnMgPSBBUlJBWV9TSVpFKHdmeF9pZmFjZV9jb21i
aW5hdGlvbnMpOwotCWh3LT53aXBoeS0+aWZhY2VfY29tYmluYXRpb25zID0gd2Z4X2lmYWNlX2Nv
bWJpbmF0aW9uczsKLQlody0+d2lwaHktPmJhbmRzW05MODAyMTFfQkFORF8yR0haXSA9IGRldm1f
a21hbGxvYyhkZXYsIHNpemVvZih3ZnhfYmFuZF8yZ2h6KSwgR0ZQX0tFUk5FTCk7Ci0JLyogRklY
TUU6IGFsc28gY29weSB3ZnhfcmF0ZXMgYW5kIHdmeF8yZ2h6X2NoYW50YWJsZSAqLwotCW1lbWNw
eShody0+d2lwaHktPmJhbmRzW05MODAyMTFfQkFORF8yR0haXSwgJndmeF9iYW5kXzJnaHosCi0J
ICAgICAgIHNpemVvZih3ZnhfYmFuZF8yZ2h6KSk7Ci0KLQl3ZGV2ID0gaHctPnByaXY7Ci0Jd2Rl
di0+aHcgPSBodzsKLQl3ZGV2LT5kZXYgPSBkZXY7Ci0Jd2Rldi0+aHdidXNfb3BzID0gaHdidXNf
b3BzOwotCXdkZXYtPmh3YnVzX3ByaXYgPSBod2J1c19wcml2OwotCW1lbWNweSgmd2Rldi0+cGRh
dGEsIHBkYXRhLCBzaXplb2YoKnBkYXRhKSk7Ci0Jb2ZfcHJvcGVydHlfcmVhZF9zdHJpbmcoZGV2
LT5vZl9ub2RlLCAiY29uZmlnLWZpbGUiLAotCQkJCSZ3ZGV2LT5wZGF0YS5maWxlX3Bkcyk7Ci0J
d2Rldi0+cGRhdGEuZ3Bpb193YWtldXAgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYsICJ3
YWtldXAiLAotCQkJCQkJCSAgR1BJT0RfT1VUX0xPVyk7Ci0JaWYgKElTX0VSUih3ZGV2LT5wZGF0
YS5ncGlvX3dha2V1cCkpCi0JCXJldHVybiBOVUxMOwotCWlmICh3ZGV2LT5wZGF0YS5ncGlvX3dh
a2V1cCkKLQkJZ3Bpb2Rfc2V0X2NvbnN1bWVyX25hbWUod2Rldi0+cGRhdGEuZ3Bpb193YWtldXAs
ICJ3Znggd2FrZXVwIik7Ci0KLQltdXRleF9pbml0KCZ3ZGV2LT5jb25mX211dGV4KTsKLQltdXRl
eF9pbml0KCZ3ZGV2LT5yeF9zdGF0c19sb2NrKTsKLQltdXRleF9pbml0KCZ3ZGV2LT50eF9wb3dl
cl9sb29wX2luZm9fbG9jayk7Ci0JaW5pdF9jb21wbGV0aW9uKCZ3ZGV2LT5maXJtd2FyZV9yZWFk
eSk7Ci0JSU5JVF9ERUxBWUVEX1dPUksoJndkZXYtPmNvb2xpbmdfdGltZW91dF93b3JrLAotCQkJ
ICB3ZnhfY29vbGluZ190aW1lb3V0X3dvcmspOwotCXNrYl9xdWV1ZV9oZWFkX2luaXQoJndkZXYt
PnR4X3BlbmRpbmcpOwotCWluaXRfd2FpdHF1ZXVlX2hlYWQoJndkZXYtPnR4X2RlcXVldWUpOwot
CXdmeF9pbml0X2hpZl9jbWQoJndkZXYtPmhpZl9jbWQpOwotCXdkZXYtPmZvcmNlX3BzX3RpbWVv
dXQgPSAtMTsKLQotCWlmIChkZXZtX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGV2LCB3ZnhfZnJlZV9j
b21tb24sIHdkZXYpKQotCQlyZXR1cm4gTlVMTDsKLQotCXJldHVybiB3ZGV2OwotfQotCi1pbnQg
d2Z4X3Byb2JlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KQotewotCWludCBpOwotCWludCBlcnI7Ci0J
c3RydWN0IGdwaW9fZGVzYyAqZ3Bpb19zYXZlZDsKLQotCS8qIER1cmluZyBmaXJzdCBwYXJ0IG9m
IGJvb3QsIGdwaW9fd2FrZXVwIGNhbm5vdCB5ZXQgYmVlbiB1c2VkLiBTbwotCSAqIHByZXZlbnQg
YmgoKSB0byB0b3VjaCBpdC4KLQkgKi8KLQlncGlvX3NhdmVkID0gd2Rldi0+cGRhdGEuZ3Bpb193
YWtldXA7Ci0Jd2Rldi0+cGRhdGEuZ3Bpb193YWtldXAgPSBOVUxMOwotCXdkZXYtPnBvbGxfaXJx
ID0gdHJ1ZTsKLQotCXdmeF9iaF9yZWdpc3Rlcih3ZGV2KTsKLQotCWVyciA9IHdmeF9pbml0X2Rl
dmljZSh3ZGV2KTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycjA7Ci0KLQl3ZnhfYmhfcG9sbF9pcnEo
d2Rldik7Ci0JZXJyID0gd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ3ZGV2LT5maXJtd2Fy
ZV9yZWFkeSwgMSAqIEhaKTsKLQlpZiAoZXJyIDw9IDApIHsKLQkJaWYgKGVyciA9PSAwKSB7Ci0J
CQlkZXZfZXJyKHdkZXYtPmRldiwgInRpbWVvdXQgd2hpbGUgd2FpdGluZyBmb3Igc3RhcnR1cCBp
bmRpY2F0aW9uXG4iKTsKLQkJCWVyciA9IC1FVElNRURPVVQ7Ci0JCX0gZWxzZSBpZiAoZXJyID09
IC1FUkVTVEFSVFNZUykgewotCQkJZGV2X2luZm8od2Rldi0+ZGV2LCAicHJvYmUgaW50ZXJydXB0
ZWQgYnkgdXNlclxuIik7Ci0JCX0KLQkJZ290byBlcnIwOwotCX0KLQotCS8qIEZJWE1FOiBmaWxs
IHdpcGh5Ojpod192ZXJzaW9uICovCi0JZGV2X2luZm8od2Rldi0+ZGV2LCAic3RhcnRlZCBmaXJt
d2FyZSAlZC4lZC4lZCBcIiVzXCIgKEFQSTogJWQuJWQsIGtleXNldDogJTAyWCwgY2FwczogMHgl
LjhYKVxuIiwKLQkJIHdkZXYtPmh3X2NhcHMuZmlybXdhcmVfbWFqb3IsIHdkZXYtPmh3X2NhcHMu
ZmlybXdhcmVfbWlub3IsCi0JCSB3ZGV2LT5od19jYXBzLmZpcm13YXJlX2J1aWxkLCB3ZGV2LT5o
d19jYXBzLmZpcm13YXJlX2xhYmVsLAotCQkgd2Rldi0+aHdfY2Fwcy5hcGlfdmVyc2lvbl9tYWpv
ciwgd2Rldi0+aHdfY2Fwcy5hcGlfdmVyc2lvbl9taW5vciwKLQkJIHdkZXYtPmtleXNldCwgd2Rl
di0+aHdfY2Fwcy5saW5rX21vZGUpOwotCXNucHJpbnRmKHdkZXYtPmh3LT53aXBoeS0+ZndfdmVy
c2lvbiwKLQkJIHNpemVvZih3ZGV2LT5ody0+d2lwaHktPmZ3X3ZlcnNpb24pLAotCQkgIiVkLiVk
LiVkIiwKLQkJIHdkZXYtPmh3X2NhcHMuZmlybXdhcmVfbWFqb3IsCi0JCSB3ZGV2LT5od19jYXBz
LmZpcm13YXJlX21pbm9yLAotCQkgd2Rldi0+aHdfY2Fwcy5maXJtd2FyZV9idWlsZCk7Ci0KLQlp
ZiAod2Z4X2FwaV9vbGRlcl90aGFuKHdkZXYsIDEsIDApKSB7Ci0JCWRldl9lcnIod2Rldi0+ZGV2
LAotCQkJInVuc3VwcG9ydGVkIGZpcm13YXJlIEFQSSB2ZXJzaW9uIChleHBlY3QgMSB3aGlsZSBm
aXJtd2FyZSByZXR1cm5zICVkKVxuIiwKLQkJCXdkZXYtPmh3X2NhcHMuYXBpX3ZlcnNpb25fbWFq
b3IpOwotCQllcnIgPSAtRU5PVFNVUFA7Ci0JCWdvdG8gZXJyMDsKLQl9Ci0KLQlpZiAod2Rldi0+
aHdfY2Fwcy5saW5rX21vZGUgPT0gU0VDX0xJTktfRU5GT1JDRUQpIHsKLQkJZGV2X2Vycih3ZGV2
LT5kZXYsCi0JCQkiY2hpcCByZXF1aXJlIHNlY3VyZV9saW5rLCBidXQgY2FuJ3QgbmVnb3RpYXRl
IGl0XG4iKTsKLQkJZ290byBlcnIwOwotCX0KLQotCWlmICh3ZGV2LT5od19jYXBzLnJlZ2lvbl9z
ZWxfbW9kZSkgewotCQl3ZGV2LT5ody0+d2lwaHktPmJhbmRzW05MODAyMTFfQkFORF8yR0haXS0+
Y2hhbm5lbHNbMTFdLmZsYWdzIHw9IElFRUU4MDIxMV9DSEFOX05PX0lSOwotCQl3ZGV2LT5ody0+
d2lwaHktPmJhbmRzW05MODAyMTFfQkFORF8yR0haXS0+Y2hhbm5lbHNbMTJdLmZsYWdzIHw9IElF
RUU4MDIxMV9DSEFOX05PX0lSOwotCQl3ZGV2LT5ody0+d2lwaHktPmJhbmRzW05MODAyMTFfQkFO
RF8yR0haXS0+Y2hhbm5lbHNbMTNdLmZsYWdzIHw9IElFRUU4MDIxMV9DSEFOX0RJU0FCTEVEOwot
CX0KLQotCWRldl9kYmcod2Rldi0+ZGV2LCAic2VuZGluZyBjb25maWd1cmF0aW9uIGZpbGUgJXNc
biIsCi0JCXdkZXYtPnBkYXRhLmZpbGVfcGRzKTsKLQllcnIgPSB3Znhfc2VuZF9wZGF0YV9wZHMo
d2Rldik7Ci0JaWYgKGVyciA8IDAgJiYgZXJyICE9IC1FTk9FTlQpCi0JCWdvdG8gZXJyMDsKLQot
CXdkZXYtPnBvbGxfaXJxID0gZmFsc2U7Ci0JZXJyID0gd2Rldi0+aHdidXNfb3BzLT5pcnFfc3Vi
c2NyaWJlKHdkZXYtPmh3YnVzX3ByaXYpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyMDsKLQotCWVy
ciA9IGhpZl91c2VfbXVsdGlfdHhfY29uZih3ZGV2LCB0cnVlKTsKLQlpZiAoZXJyKQotCQlkZXZf
ZXJyKHdkZXYtPmRldiwgIm1pc2NvbmZpZ3VyZWQgSVJRP1xuIik7Ci0KLQl3ZGV2LT5wZGF0YS5n
cGlvX3dha2V1cCA9IGdwaW9fc2F2ZWQ7Ci0JaWYgKHdkZXYtPnBkYXRhLmdwaW9fd2FrZXVwKSB7
Ci0JCWRldl9kYmcod2Rldi0+ZGV2LAotCQkJImVuYWJsZSAncXVpZXNjZW50JyBwb3dlciBtb2Rl
IHdpdGggd2FrZXVwIEdQSU8gYW5kIFBEUyBmaWxlICVzXG4iLAotCQkJd2Rldi0+cGRhdGEuZmls
ZV9wZHMpOwotCQlncGlvZF9zZXRfdmFsdWVfY2Fuc2xlZXAod2Rldi0+cGRhdGEuZ3Bpb193YWtl
dXAsIDEpOwotCQljb250cm9sX3JlZ193cml0ZSh3ZGV2LCAwKTsKLQkJaGlmX3NldF9vcGVyYXRp
b25hbF9tb2RlKHdkZXYsIEhJRl9PUF9QT1dFUl9NT0RFX1FVSUVTQ0VOVCk7Ci0JfSBlbHNlIHsK
LQkJaGlmX3NldF9vcGVyYXRpb25hbF9tb2RlKHdkZXYsIEhJRl9PUF9QT1dFUl9NT0RFX0RPWkUp
OwotCX0KLQotCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHdkZXYtPmFkZHJlc3Nlcyk7IGkr
KykgewotCQlldGhfemVyb19hZGRyKHdkZXYtPmFkZHJlc3Nlc1tpXS5hZGRyKTsKLQkJZXJyID0g
b2ZfZ2V0X21hY19hZGRyZXNzKHdkZXYtPmRldi0+b2Zfbm9kZSwKLQkJCQkJIHdkZXYtPmFkZHJl
c3Nlc1tpXS5hZGRyKTsKLQkJaWYgKCFlcnIpIHsKLQkJCXdkZXYtPmFkZHJlc3Nlc1tpXS5hZGRy
W0VUSF9BTEVOIC0gMV0gKz0gaTsKLQkJfSBlbHNlIHsKLQkJCWV0aGVyX2FkZHJfY29weSh3ZGV2
LT5hZGRyZXNzZXNbaV0uYWRkciwKLQkJCQkJd2Rldi0+aHdfY2Fwcy5tYWNfYWRkcltpXSk7Ci0J
CX0KLQkJaWYgKCFpc192YWxpZF9ldGhlcl9hZGRyKHdkZXYtPmFkZHJlc3Nlc1tpXS5hZGRyKSkg
ewotCQkJZGV2X3dhcm4od2Rldi0+ZGV2LCAidXNpbmcgcmFuZG9tIE1BQyBhZGRyZXNzXG4iKTsK
LQkJCWV0aF9yYW5kb21fYWRkcih3ZGV2LT5hZGRyZXNzZXNbaV0uYWRkcik7Ci0JCX0KLQkJZGV2
X2luZm8od2Rldi0+ZGV2LCAiTUFDIGFkZHJlc3MgJWQ6ICVwTVxuIiwgaSwKLQkJCSB3ZGV2LT5h
ZGRyZXNzZXNbaV0uYWRkcik7Ci0JfQotCXdkZXYtPmh3LT53aXBoeS0+bl9hZGRyZXNzZXMgPSBB
UlJBWV9TSVpFKHdkZXYtPmFkZHJlc3Nlcyk7Ci0Jd2Rldi0+aHctPndpcGh5LT5hZGRyZXNzZXMg
PSB3ZGV2LT5hZGRyZXNzZXM7Ci0KLQlpZiAoIXdmeF9hcGlfb2xkZXJfdGhhbih3ZGV2LCAzLCA4
KSkKLQkJd2Rldi0+aHctPndpcGh5LT5mbGFncyB8PSBXSVBIWV9GTEFHX1NVUFBPUlRTX1RETFM7
Ci0KLQllcnIgPSBpZWVlODAyMTFfcmVnaXN0ZXJfaHcod2Rldi0+aHcpOwotCWlmIChlcnIpCi0J
CWdvdG8gZXJyMTsKLQotCWVyciA9IHdmeF9kZWJ1Z19pbml0KHdkZXYpOwotCWlmIChlcnIpCi0J
CWdvdG8gZXJyMjsKLQotCXJldHVybiAwOwotCi1lcnIyOgotCWllZWU4MDIxMV91bnJlZ2lzdGVy
X2h3KHdkZXYtPmh3KTsKLWVycjE6Ci0Jd2Rldi0+aHdidXNfb3BzLT5pcnFfdW5zdWJzY3JpYmUo
d2Rldi0+aHdidXNfcHJpdik7Ci1lcnIwOgotCXdmeF9iaF91bnJlZ2lzdGVyKHdkZXYpOwotCXJl
dHVybiBlcnI7Ci19Ci0KLXZvaWQgd2Z4X3JlbGVhc2Uoc3RydWN0IHdmeF9kZXYgKndkZXYpCi17
Ci0JaWVlZTgwMjExX3VucmVnaXN0ZXJfaHcod2Rldi0+aHcpOwotCWhpZl9zaHV0ZG93bih3ZGV2
KTsKLQl3ZGV2LT5od2J1c19vcHMtPmlycV91bnN1YnNjcmliZSh3ZGV2LT5od2J1c19wcml2KTsK
LQl3ZnhfYmhfdW5yZWdpc3Rlcih3ZGV2KTsKLX0KLQotc3RhdGljIGludCBfX2luaXQgd2Z4X2Nv
cmVfaW5pdCh2b2lkKQotewotCWludCByZXQgPSAwOwotCi0JaWYgKElTX0VOQUJMRUQoQ09ORklH
X1NQSSkpCi0JCXJldCA9IHNwaV9yZWdpc3Rlcl9kcml2ZXIoJndmeF9zcGlfZHJpdmVyKTsKLQlp
ZiAoSVNfRU5BQkxFRChDT05GSUdfTU1DKSAmJiAhcmV0KQotCQlyZXQgPSBzZGlvX3JlZ2lzdGVy
X2RyaXZlcigmd2Z4X3NkaW9fZHJpdmVyKTsKLQlyZXR1cm4gcmV0OwotfQotbW9kdWxlX2luaXQo
d2Z4X2NvcmVfaW5pdCk7Ci0KLXN0YXRpYyB2b2lkIF9fZXhpdCB3ZnhfY29yZV9leGl0KHZvaWQp
Ci17Ci0JaWYgKElTX0VOQUJMRUQoQ09ORklHX01NQykpCi0JCXNkaW9fdW5yZWdpc3Rlcl9kcml2
ZXIoJndmeF9zZGlvX2RyaXZlcik7Ci0JaWYgKElTX0VOQUJMRUQoQ09ORklHX1NQSSkpCi0JCXNw
aV91bnJlZ2lzdGVyX2RyaXZlcigmd2Z4X3NwaV9kcml2ZXIpOwotfQotbW9kdWxlX2V4aXQod2Z4
X2NvcmVfZXhpdCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L21haW4uaCBiL2Ry
aXZlcnMvc3RhZ2luZy93ZngvbWFpbi5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAx
MTVhYmQyZDQzNzguLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L21haW4u
aAorKysgL2Rldi9udWxsCkBAIC0xLDQzICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wLW9ubHkgKi8KLS8qCi0gKiBEZXZpY2UgcHJvYmUgYW5kIHJlZ2lzdGVyLgot
ICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5j
LgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICogQ29weXJpZ2h0IChjKSAy
MDA2LCBNaWNoYWVsIFd1IDxmbGFtaW5naWNlQHNvdXJtaWxrLm5ldD4KLSAqIENvcHlyaWdodCAy
MDA0LTIwMDYgSmVhbi1CYXB0aXN0ZSBOb3RlIDxqYm5vdGVAZ21haWwuY29tPiwgZXQgYWwuCi0g
Ki8KLSNpZm5kZWYgV0ZYX01BSU5fSAotI2RlZmluZSBXRlhfTUFJTl9ICi0KLSNpbmNsdWRlIDxs
aW51eC9kZXZpY2UuaD4KLSNpbmNsdWRlIDxsaW51eC9ncGlvL2NvbnN1bWVyLmg+Ci0KLSNpbmNs
dWRlICJoaWZfYXBpX2dlbmVyYWwuaCIKLQotc3RydWN0IHdmeF9kZXY7Ci1zdHJ1Y3QgaHdidXNf
b3BzOwotCi1zdHJ1Y3Qgd2Z4X3BsYXRmb3JtX2RhdGEgewotCS8qIEtleXNldCBhbmQgIi5zZWMi
IGV4dGVuc2lvbiB3aWxsIGJlIGFwcGVuZGVkIHRvIHRoaXMgc3RyaW5nICovCi0JY29uc3QgY2hh
ciAqZmlsZV9mdzsKLQljb25zdCBjaGFyICpmaWxlX3BkczsKLQlzdHJ1Y3QgZ3Bpb19kZXNjICpn
cGlvX3dha2V1cDsKLQkvKiBpZiB0cnVlIEhJRiBEX291dCBpcyBzYW1wbGVkIG9uIHRoZSByaXNp
bmcgZWRnZSBvZiB0aGUgY2xvY2sKLQkgKiAoaW50ZW5kZWQgdG8gYmUgdXNlZCBpbiA1ME1oeiBT
RElPKQotCSAqLwotCWJvb2wgdXNlX3Jpc2luZ19jbGs7Ci19OwotCi1zdHJ1Y3Qgd2Z4X2RldiAq
d2Z4X2luaXRfY29tbW9uKHN0cnVjdCBkZXZpY2UgKmRldiwKLQkJCQljb25zdCBzdHJ1Y3Qgd2Z4
X3BsYXRmb3JtX2RhdGEgKnBkYXRhLAotCQkJCWNvbnN0IHN0cnVjdCBod2J1c19vcHMgKmh3YnVz
X29wcywKLQkJCQl2b2lkICpod2J1c19wcml2KTsKLQotaW50IHdmeF9wcm9iZShzdHJ1Y3Qgd2Z4
X2RldiAqd2Rldik7Ci12b2lkIHdmeF9yZWxlYXNlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLQot
Ym9vbCB3ZnhfYXBpX29sZGVyX3RoYW4oc3RydWN0IHdmeF9kZXYgKndkZXYsIGludCBtYWpvciwg
aW50IG1pbm9yKTsKLWludCB3Znhfc2VuZF9wZHMoc3RydWN0IHdmeF9kZXYgKndkZXYsIHU4ICpi
dWYsIHNpemVfdCBsZW4pOwotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93
ZngvcXVldWUuYyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvcXVldWUuYwpkZWxldGVkIGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggN2EzYmEzYzM4OTI1Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9z
dGFnaW5nL3dmeC9xdWV1ZS5jCisrKyAvZGV2L251bGwKQEAgLTEsMzA3ICswLDAgQEAKLS8vIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKLS8qCi0gKiBRdWV1ZSBiZXR3ZWVu
IHRoZSB0eCBvcGVyYXRpb24gYW5kIHRoZSBiaCB3b3JrcXVldWUuCi0gKgotICogQ29weXJpZ2h0
IChjKSAyMDE3LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQg
KGMpIDIwMTAsIFNULUVyaWNzc29uCi0gKi8KLSNpbmNsdWRlIDxsaW51eC9zY2hlZC5oPgotI2lu
Y2x1ZGUgPG5ldC9tYWM4MDIxMS5oPgotCi0jaW5jbHVkZSAicXVldWUuaCIKLSNpbmNsdWRlICJ3
ZnguaCIKLSNpbmNsdWRlICJzdGEuaCIKLSNpbmNsdWRlICJkYXRhX3R4LmgiCi0jaW5jbHVkZSAi
dHJhY2VzLmgiCi0KLXZvaWQgd2Z4X3R4X2xvY2soc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0J
YXRvbWljX2luYygmd2Rldi0+dHhfbG9jayk7Ci19Ci0KLXZvaWQgd2Z4X3R4X3VubG9jayhzdHJ1
Y3Qgd2Z4X2RldiAqd2RldikKLXsKLQlpbnQgdHhfbG9jayA9IGF0b21pY19kZWNfcmV0dXJuKCZ3
ZGV2LT50eF9sb2NrKTsKLQotCVdBUk4odHhfbG9jayA8IDAsICJpbmNvbnNpc3RlbnQgdHhfbG9j
ayB2YWx1ZSIpOwotCWlmICghdHhfbG9jaykKLQkJd2Z4X2JoX3JlcXVlc3RfdHgod2Rldik7Ci19
Ci0KLXZvaWQgd2Z4X3R4X2ZsdXNoKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KQotewotCWludCByZXQ7
Ci0KLQkvKiBEbyBub3Qgd2FpdCBmb3IgYW55IHJlcGx5IGlmIGNoaXAgaXMgZnJvemVuICovCi0J
aWYgKHdkZXYtPmNoaXBfZnJvemVuKQotCQlyZXR1cm47Ci0KLQl3ZnhfdHhfbG9jayh3ZGV2KTsK
LQltdXRleF9sb2NrKCZ3ZGV2LT5oaWZfY21kLmxvY2spOwotCXJldCA9IHdhaXRfZXZlbnRfdGlt
ZW91dCh3ZGV2LT5oaWYudHhfYnVmZmVyc19lbXB0eSwKLQkJCQkgIXdkZXYtPmhpZi50eF9idWZm
ZXJzX3VzZWQsCi0JCQkJIG1zZWNzX3RvX2ppZmZpZXMoMzAwMCkpOwotCWlmICghcmV0KSB7Ci0J
CWRldl93YXJuKHdkZXYtPmRldiwgImNhbm5vdCBmbHVzaCB0eCBidWZmZXJzICglZCBzdGlsbCBi
dXN5KVxuIiwKLQkJCSB3ZGV2LT5oaWYudHhfYnVmZmVyc191c2VkKTsKLQkJd2Z4X3BlbmRpbmdf
ZHVtcF9vbGRfZnJhbWVzKHdkZXYsIDMwMDApOwotCQkvKiBGSVhNRTogZHJvcCBwZW5kaW5nIGZy
YW1lcyBoZXJlICovCi0JCXdkZXYtPmNoaXBfZnJvemVuID0gdHJ1ZTsKLQl9Ci0JbXV0ZXhfdW5s
b2NrKCZ3ZGV2LT5oaWZfY21kLmxvY2spOwotCXdmeF90eF91bmxvY2sod2Rldik7Ci19Ci0KLXZv
aWQgd2Z4X3R4X2xvY2tfZmx1c2goc3RydWN0IHdmeF9kZXYgKndkZXYpCi17Ci0Jd2Z4X3R4X2xv
Y2sod2Rldik7Ci0Jd2Z4X3R4X2ZsdXNoKHdkZXYpOwotfQotCi12b2lkIHdmeF90eF9xdWV1ZXNf
aW5pdChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZikKLXsKLQkvKiBUaGUgZGV2aWNlIGlzIGluIGNoYXJn
ZSB0byByZXNwZWN0IHRoZSBkZXRhaWxzIG9mIHRoZSBRb1MgcGFyYW1ldGVycy4KLQkgKiBUaGUg
ZHJpdmVyIGp1c3QgZW5zdXJlIHRoYXQgaXQgcm91Z2h0bHkgcmVzcGVjdCB0aGUgcHJpb3JpdGll
cyB0bwotCSAqIGF2b2lkIGFueSBzaG9ydGFnZS4KLQkgKi8KLQljb25zdCBpbnQgcHJpb3JpdGll
c1tJRUVFODAyMTFfTlVNX0FDU10gPSB7IDEsIDIsIDY0LCAxMjggfTsKLQlpbnQgaTsKLQotCWZv
ciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfTlVNX0FDUzsgKytpKSB7Ci0JCXNrYl9xdWV1ZV9oZWFk
X2luaXQoJnd2aWYtPnR4X3F1ZXVlW2ldLm5vcm1hbCk7Ci0JCXNrYl9xdWV1ZV9oZWFkX2luaXQo
Jnd2aWYtPnR4X3F1ZXVlW2ldLmNhYik7Ci0JCXd2aWYtPnR4X3F1ZXVlW2ldLnByaW9yaXR5ID0g
cHJpb3JpdGllc1tpXTsKLQl9Ci19Ci0KLWJvb2wgd2Z4X3R4X3F1ZXVlX2VtcHR5KHN0cnVjdCB3
ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSkKLXsKLQlyZXR1cm4gc2tiX3F1
ZXVlX2VtcHR5X2xvY2tsZXNzKCZxdWV1ZS0+bm9ybWFsKSAmJgotCSAgICAgICBza2JfcXVldWVf
ZW1wdHlfbG9ja2xlc3MoJnF1ZXVlLT5jYWIpOwotfQotCi12b2lkIHdmeF90eF9xdWV1ZXNfY2hl
Y2tfZW1wdHkoc3RydWN0IHdmeF92aWYgKnd2aWYpCi17Ci0JaW50IGk7Ci0KLQlmb3IgKGkgPSAw
OyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7ICsraSkgewotCQlXQVJOX09OKGF0b21pY19yZWFkKCZ3
dmlmLT50eF9xdWV1ZVtpXS5wZW5kaW5nX2ZyYW1lcykpOwotCQlXQVJOX09OKCF3ZnhfdHhfcXVl
dWVfZW1wdHkod3ZpZiwgJnd2aWYtPnR4X3F1ZXVlW2ldKSk7Ci0JfQotfQotCi1zdGF0aWMgdm9p
ZCBfX3dmeF90eF9xdWV1ZV9kcm9wKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAotCQkJCXN0cnVjdCBz
a19idWZmX2hlYWQgKnNrYl9xdWV1ZSwKLQkJCQlzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpkcm9wcGVk
KQotewotCXN0cnVjdCBza19idWZmICpza2IsICp0bXA7Ci0KLQlzcGluX2xvY2tfYmgoJnNrYl9x
dWV1ZS0+bG9jayk7Ci0Jc2tiX3F1ZXVlX3dhbGtfc2FmZShza2JfcXVldWUsIHNrYiwgdG1wKSB7
Ci0JCV9fc2tiX3VubGluayhza2IsIHNrYl9xdWV1ZSk7Ci0JCXNrYl9xdWV1ZV9oZWFkKGRyb3Bw
ZWQsIHNrYik7Ci0JfQotCXNwaW5fdW5sb2NrX2JoKCZza2JfcXVldWUtPmxvY2spOwotfQotCi12
b2lkIHdmeF90eF9xdWV1ZV9kcm9wKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1
ZXVlICpxdWV1ZSwKLQkJICAgICAgIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpCi17Ci0J
X193ZnhfdHhfcXVldWVfZHJvcCh3dmlmLCAmcXVldWUtPmNhYiwgZHJvcHBlZCk7Ci0JX193Znhf
dHhfcXVldWVfZHJvcCh3dmlmLCAmcXVldWUtPm5vcm1hbCwgZHJvcHBlZCk7Ci0Jd2FrZV91cCgm
d3ZpZi0+d2Rldi0+dHhfZGVxdWV1ZSk7Ci19Ci0KLXZvaWQgd2Z4X3R4X3F1ZXVlc19wdXQoc3Ry
dWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZmICpza2IpCi17Ci0Jc3RydWN0IHdmeF9x
dWV1ZSAqcXVldWUgPSAmd3ZpZi0+dHhfcXVldWVbc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYild
OwotCXN0cnVjdCBpZWVlODAyMTFfdHhfaW5mbyAqdHhfaW5mbyA9IElFRUU4MDIxMV9TS0JfQ0Io
c2tiKTsKLQotCWlmICh0eF9pbmZvLT5mbGFncyAmIElFRUU4MDIxMV9UWF9DVExfU0VORF9BRlRF
Ul9EVElNKQotCQlza2JfcXVldWVfdGFpbCgmcXVldWUtPmNhYiwgc2tiKTsKLQllbHNlCi0JCXNr
Yl9xdWV1ZV90YWlsKCZxdWV1ZS0+bm9ybWFsLCBza2IpOwotfQotCi12b2lkIHdmeF9wZW5kaW5n
X2Ryb3Aoc3RydWN0IHdmeF9kZXYgKndkZXYsIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQp
Ci17Ci0Jc3RydWN0IHdmeF9xdWV1ZSAqcXVldWU7Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWY7Ci0J
c3RydWN0IGhpZl9tc2cgKmhpZjsKLQlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCi0JV0FSTighd2Rl
di0+Y2hpcF9mcm96ZW4sICIlcyBzaG91bGQgb25seSBiZSB1c2VkIHRvIHJlY292ZXIgYSBmcm96
ZW4gZGV2aWNlIiwKLQkgICAgIF9fZnVuY19fKTsKLQl3aGlsZSAoKHNrYiA9IHNrYl9kZXF1ZXVl
KCZ3ZGV2LT50eF9wZW5kaW5nKSkgIT0gTlVMTCkgewotCQloaWYgPSAoc3RydWN0IGhpZl9tc2cg
Kilza2ItPmRhdGE7Ci0JCXd2aWYgPSB3ZGV2X3RvX3d2aWYod2RldiwgaGlmLT5pbnRlcmZhY2Up
OwotCQlpZiAod3ZpZikgewotCQkJcXVldWUgPSAmd3ZpZi0+dHhfcXVldWVbc2tiX2dldF9xdWV1
ZV9tYXBwaW5nKHNrYildOwotCQkJV0FSTl9PTihza2JfZ2V0X3F1ZXVlX21hcHBpbmcoc2tiKSA+
IDMpOwotCQkJV0FSTl9PTighYXRvbWljX3JlYWQoJnF1ZXVlLT5wZW5kaW5nX2ZyYW1lcykpOwot
CQkJYXRvbWljX2RlYygmcXVldWUtPnBlbmRpbmdfZnJhbWVzKTsKLQkJfQotCQlza2JfcXVldWVf
aGVhZChkcm9wcGVkLCBza2IpOwotCX0KLX0KLQotc3RydWN0IHNrX2J1ZmYgKndmeF9wZW5kaW5n
X2dldChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIHBhY2tldF9pZCkKLXsKLQlzdHJ1Y3Qgd2Z4
X3F1ZXVlICpxdWV1ZTsKLQlzdHJ1Y3QgaGlmX3JlcV90eCAqcmVxOwotCXN0cnVjdCB3Znhfdmlm
ICp3dmlmOwotCXN0cnVjdCBoaWZfbXNnICpoaWY7Ci0Jc3RydWN0IHNrX2J1ZmYgKnNrYjsKLQot
CXNwaW5fbG9ja19iaCgmd2Rldi0+dHhfcGVuZGluZy5sb2NrKTsKLQlza2JfcXVldWVfd2Fsaygm
d2Rldi0+dHhfcGVuZGluZywgc2tiKSB7Ci0JCWhpZiA9IChzdHJ1Y3QgaGlmX21zZyAqKXNrYi0+
ZGF0YTsKLQkJcmVxID0gKHN0cnVjdCBoaWZfcmVxX3R4ICopaGlmLT5ib2R5OwotCQlpZiAocmVx
LT5wYWNrZXRfaWQgIT0gcGFja2V0X2lkKQotCQkJY29udGludWU7Ci0JCXNwaW5fdW5sb2NrX2Jo
KCZ3ZGV2LT50eF9wZW5kaW5nLmxvY2spOwotCQl3dmlmID0gd2Rldl90b193dmlmKHdkZXYsIGhp
Zi0+aW50ZXJmYWNlKTsKLQkJaWYgKHd2aWYpIHsKLQkJCXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVl
W3NrYl9nZXRfcXVldWVfbWFwcGluZyhza2IpXTsKLQkJCVdBUk5fT04oc2tiX2dldF9xdWV1ZV9t
YXBwaW5nKHNrYikgPiAzKTsKLQkJCVdBUk5fT04oIWF0b21pY19yZWFkKCZxdWV1ZS0+cGVuZGlu
Z19mcmFtZXMpKTsKLQkJCWF0b21pY19kZWMoJnF1ZXVlLT5wZW5kaW5nX2ZyYW1lcyk7Ci0JCX0K
LQkJc2tiX3VubGluayhza2IsICZ3ZGV2LT50eF9wZW5kaW5nKTsKLQkJcmV0dXJuIHNrYjsKLQl9
Ci0Jc3Bpbl91bmxvY2tfYmgoJndkZXYtPnR4X3BlbmRpbmcubG9jayk7Ci0JV0FSTigxLCAiY2Fu
bm90IGZpbmQgcGFja2V0IGluIHBlbmRpbmcgcXVldWUiKTsKLQlyZXR1cm4gTlVMTDsKLX0KLQot
dm9pZCB3ZnhfcGVuZGluZ19kdW1wX29sZF9mcmFtZXMoc3RydWN0IHdmeF9kZXYgKndkZXYsIHVu
c2lnbmVkIGludCBsaW1pdF9tcykKLXsKLQlrdGltZV90IG5vdyA9IGt0aW1lX2dldCgpOwotCXN0
cnVjdCB3ZnhfdHhfcHJpdiAqdHhfcHJpdjsKLQlzdHJ1Y3QgaGlmX3JlcV90eCAqcmVxOwotCXN0
cnVjdCBza19idWZmICpza2I7Ci0JYm9vbCBmaXJzdCA9IHRydWU7Ci0KLQlzcGluX2xvY2tfYmgo
JndkZXYtPnR4X3BlbmRpbmcubG9jayk7Ci0Jc2tiX3F1ZXVlX3dhbGsoJndkZXYtPnR4X3BlbmRp
bmcsIHNrYikgewotCQl0eF9wcml2ID0gd2Z4X3NrYl90eF9wcml2KHNrYik7Ci0JCXJlcSA9IHdm
eF9za2JfdHhyZXEoc2tiKTsKLQkJaWYgKGt0aW1lX2FmdGVyKG5vdywga3RpbWVfYWRkX21zKHR4
X3ByaXYtPnhtaXRfdGltZXN0YW1wLAotCQkJCQkJICBsaW1pdF9tcykpKSB7Ci0JCQlpZiAoZmly
c3QpIHsKLQkJCQlkZXZfaW5mbyh3ZGV2LT5kZXYsICJmcmFtZXMgc3R1Y2sgaW4gZmlybXdhcmUg
c2luY2UgJWRtcyBvciBtb3JlOlxuIiwKLQkJCQkJIGxpbWl0X21zKTsKLQkJCQlmaXJzdCA9IGZh
bHNlOwotCQkJfQotCQkJZGV2X2luZm8od2Rldi0+ZGV2LCAiICAgaWQgJTA4eCBzZW50ICVsbGRt
cyBhZ29cbiIsCi0JCQkJIHJlcS0+cGFja2V0X2lkLAotCQkJCSBrdGltZV9tc19kZWx0YShub3cs
IHR4X3ByaXYtPnhtaXRfdGltZXN0YW1wKSk7Ci0JCX0KLQl9Ci0Jc3Bpbl91bmxvY2tfYmgoJndk
ZXYtPnR4X3BlbmRpbmcubG9jayk7Ci19Ci0KLXVuc2lnbmVkIGludCB3ZnhfcGVuZGluZ19nZXRf
cGt0X3VzX2RlbGF5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJCQkgIHN0cnVjdCBza19idWZm
ICpza2IpCi17Ci0Ja3RpbWVfdCBub3cgPSBrdGltZV9nZXQoKTsKLQlzdHJ1Y3Qgd2Z4X3R4X3By
aXYgKnR4X3ByaXYgPSB3Znhfc2tiX3R4X3ByaXYoc2tiKTsKLQotCXJldHVybiBrdGltZV91c19k
ZWx0YShub3csIHR4X3ByaXYtPnhtaXRfdGltZXN0YW1wKTsKLX0KLQotYm9vbCB3ZnhfdHhfcXVl
dWVzX2hhc19jYWIoc3RydWN0IHdmeF92aWYgKnd2aWYpCi17Ci0JaW50IGk7Ci0KLQlpZiAod3Zp
Zi0+dmlmLT50eXBlICE9IE5MODAyMTFfSUZUWVBFX0FQKQotCQlyZXR1cm4gZmFsc2U7Ci0JZm9y
IChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyArK2kpCi0JCS8qIE5vdGU6IHNpbmNlIG9u
bHkgQVAgY2FuIGhhdmUgbWNhc3QgZnJhbWVzIGluIHF1ZXVlIGFuZCBvbmx5Ci0JCSAqIG9uZSB2
aWYgY2FuIGJlIEFQLCBhbGwgcXVldWVkIGZyYW1lcyBoYXMgc2FtZSBpbnRlcmZhY2UgaWQKLQkJ
ICovCi0JCWlmICghc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3dmlmLT50eF9xdWV1ZVtpXS5j
YWIpKQotCQkJcmV0dXJuIHRydWU7Ci0JcmV0dXJuIGZhbHNlOwotfQotCi1zdGF0aWMgaW50IHdm
eF90eF9xdWV1ZV9nZXRfd2VpZ2h0KHN0cnVjdCB3ZnhfcXVldWUgKnF1ZXVlKQotewotCXJldHVy
biBhdG9taWNfcmVhZCgmcXVldWUtPnBlbmRpbmdfZnJhbWVzKSAqIHF1ZXVlLT5wcmlvcml0eTsK
LX0KLQotc3RhdGljIHN0cnVjdCBza19idWZmICp3ZnhfdHhfcXVldWVzX2dldF9za2Ioc3RydWN0
IHdmeF9kZXYgKndkZXYpCi17Ci0Jc3RydWN0IHdmeF9xdWV1ZSAqcXVldWVzW0lFRUU4MDIxMV9O
VU1fQUNTICogQVJSQVlfU0laRSh3ZGV2LT52aWYpXTsKLQlpbnQgaSwgaiwgbnVtX3F1ZXVlcyA9
IDA7Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWY7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZjsKLQlzdHJ1
Y3Qgc2tfYnVmZiAqc2tiOwotCi0JLyogc29ydCB0aGUgcXVldWVzICovCi0Jd3ZpZiA9IE5VTEw7
Ci0Jd2hpbGUgKCh3dmlmID0gd3ZpZl9pdGVyYXRlKHdkZXYsIHd2aWYpKSAhPSBOVUxMKSB7Ci0J
CWZvciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfTlVNX0FDUzsgaSsrKSB7Ci0JCQlXQVJOX09OKG51
bV9xdWV1ZXMgPj0gQVJSQVlfU0laRShxdWV1ZXMpKTsKLQkJCXF1ZXVlc1tudW1fcXVldWVzXSA9
ICZ3dmlmLT50eF9xdWV1ZVtpXTsKLQkJCWZvciAoaiA9IG51bV9xdWV1ZXM7IGogPiAwOyBqLS0p
Ci0JCQkJaWYgKHdmeF90eF9xdWV1ZV9nZXRfd2VpZ2h0KHF1ZXVlc1tqXSkgPAotCQkJCSAgICB3
ZnhfdHhfcXVldWVfZ2V0X3dlaWdodChxdWV1ZXNbaiAtIDFdKSkKLQkJCQkJc3dhcChxdWV1ZXNb
aiAtIDFdLCBxdWV1ZXNbal0pOwotCQkJbnVtX3F1ZXVlcysrOwotCQl9Ci0JfQotCi0Jd3ZpZiA9
IE5VTEw7Ci0Jd2hpbGUgKCh3dmlmID0gd3ZpZl9pdGVyYXRlKHdkZXYsIHd2aWYpKSAhPSBOVUxM
KSB7Ci0JCWlmICghd3ZpZi0+YWZ0ZXJfZHRpbV90eF9hbGxvd2VkKQotCQkJY29udGludWU7Ci0J
CWZvciAoaSA9IDA7IGkgPCBudW1fcXVldWVzOyBpKyspIHsKLQkJCXNrYiA9IHNrYl9kZXF1ZXVl
KCZxdWV1ZXNbaV0tPmNhYik7Ci0JCQlpZiAoIXNrYikKLQkJCQljb250aW51ZTsKLQkJCS8qIE5v
dGU6IHNpbmNlIG9ubHkgQVAgY2FuIGhhdmUgbWNhc3QgZnJhbWVzIGluIHF1ZXVlCi0JCQkgKiBh
bmQgb25seSBvbmUgdmlmIGNhbiBiZSBBUCwgYWxsIHF1ZXVlZCBmcmFtZXMgaGFzCi0JCQkgKiBz
YW1lIGludGVyZmFjZSBpZAotCQkJICovCi0JCQloaWYgPSAoc3RydWN0IGhpZl9tc2cgKilza2It
PmRhdGE7Ci0JCQlXQVJOX09OKGhpZi0+aW50ZXJmYWNlICE9IHd2aWYtPmlkKTsKLQkJCVdBUk5f
T04ocXVldWVzW2ldICE9Ci0JCQkJJnd2aWYtPnR4X3F1ZXVlW3NrYl9nZXRfcXVldWVfbWFwcGlu
Zyhza2IpXSk7Ci0JCQlhdG9taWNfaW5jKCZxdWV1ZXNbaV0tPnBlbmRpbmdfZnJhbWVzKTsKLQkJ
CXRyYWNlX3F1ZXVlc19zdGF0cyh3ZGV2LCBxdWV1ZXNbaV0pOwotCQkJcmV0dXJuIHNrYjsKLQkJ
fQotCQkvKiBObyBtb3JlIG11bHRpY2FzdCB0byBzZW50ICovCi0JCXd2aWYtPmFmdGVyX2R0aW1f
dHhfYWxsb3dlZCA9IGZhbHNlOwotCQlzY2hlZHVsZV93b3JrKCZ3dmlmLT51cGRhdGVfdGltX3dv
cmspOwotCX0KLQotCWZvciAoaSA9IDA7IGkgPCBudW1fcXVldWVzOyBpKyspIHsKLQkJc2tiID0g
c2tiX2RlcXVldWUoJnF1ZXVlc1tpXS0+bm9ybWFsKTsKLQkJaWYgKHNrYikgewotCQkJYXRvbWlj
X2luYygmcXVldWVzW2ldLT5wZW5kaW5nX2ZyYW1lcyk7Ci0JCQl0cmFjZV9xdWV1ZXNfc3RhdHMo
d2RldiwgcXVldWVzW2ldKTsKLQkJCXJldHVybiBza2I7Ci0JCX0KLQl9Ci0JcmV0dXJuIE5VTEw7
Ci19Ci0KLXN0cnVjdCBoaWZfbXNnICp3ZnhfdHhfcXVldWVzX2dldChzdHJ1Y3Qgd2Z4X2RldiAq
d2RldikKLXsKLQlzdHJ1Y3Qgd2Z4X3R4X3ByaXYgKnR4X3ByaXY7Ci0Jc3RydWN0IHNrX2J1ZmYg
KnNrYjsKLQotCWlmIChhdG9taWNfcmVhZCgmd2Rldi0+dHhfbG9jaykpCi0JCXJldHVybiBOVUxM
OwotCXNrYiA9IHdmeF90eF9xdWV1ZXNfZ2V0X3NrYih3ZGV2KTsKLQlpZiAoIXNrYikKLQkJcmV0
dXJuIE5VTEw7Ci0Jc2tiX3F1ZXVlX3RhaWwoJndkZXYtPnR4X3BlbmRpbmcsIHNrYik7Ci0Jd2Fr
ZV91cCgmd2Rldi0+dHhfZGVxdWV1ZSk7Ci0JdHhfcHJpdiA9IHdmeF9za2JfdHhfcHJpdihza2Ip
OwotCXR4X3ByaXYtPnhtaXRfdGltZXN0YW1wID0ga3RpbWVfZ2V0KCk7Ci0JcmV0dXJuIChzdHJ1
Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKLX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93
ZngvcXVldWUuaCBiL2RyaXZlcnMvc3RhZ2luZy93ZngvcXVldWUuaApkZWxldGVkIGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggZWRkMGQwMThiMTk4Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9z
dGFnaW5nL3dmeC9xdWV1ZS5oCisrKyAvZGV2L251bGwKQEAgLTEsNDUgKzAsMCBAQAotLyogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwotLyoKLSAqIFF1ZXVlIGJldHdl
ZW4gdGhlIHR4IG9wZXJhdGlvbiBhbmQgdGhlIGJoIHdvcmtxdWV1ZS4KLSAqCi0gKiBDb3B5cmln
aHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIEluYy4KLSAqIENvcHlyaWdo
dCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KLSAqLwotI2lmbmRlZiBXRlhfUVVFVUVfSAotI2RlZmlu
ZSBXRlhfUVVFVUVfSAotCi0jaW5jbHVkZSA8bGludXgvc2tidWZmLmg+Ci0jaW5jbHVkZSA8bGlu
dXgvYXRvbWljLmg+Ci0KLXN0cnVjdCB3ZnhfZGV2Owotc3RydWN0IHdmeF92aWY7Ci0KLXN0cnVj
dCB3ZnhfcXVldWUgewotCXN0cnVjdCBza19idWZmX2hlYWQJbm9ybWFsOwotCXN0cnVjdCBza19i
dWZmX2hlYWQJY2FiOyAvKiBDb250ZW50IEFmdGVyIChEVElNKSBCZWFjb24gKi8KLQlhdG9taWNf
dAkJcGVuZGluZ19mcmFtZXM7Ci0JaW50CQkJcHJpb3JpdHk7Ci19OwotCi12b2lkIHdmeF90eF9s
b2NrKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLXZvaWQgd2Z4X3R4X3VubG9jayhzdHJ1Y3Qgd2Z4
X2RldiAqd2Rldik7Ci12b2lkIHdmeF90eF9mbHVzaChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7Ci12
b2lkIHdmeF90eF9sb2NrX2ZsdXNoKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLQotdm9pZCB3Znhf
dHhfcXVldWVzX2luaXQoc3RydWN0IHdmeF92aWYgKnd2aWYpOwotdm9pZCB3ZnhfdHhfcXVldWVz
X2NoZWNrX2VtcHR5KHN0cnVjdCB3ZnhfdmlmICp3dmlmKTsKLWJvb2wgd2Z4X3R4X3F1ZXVlc19o
YXNfY2FiKHN0cnVjdCB3ZnhfdmlmICp3dmlmKTsKLXZvaWQgd2Z4X3R4X3F1ZXVlc19wdXQoc3Ry
dWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZmICpza2IpOwotc3RydWN0IGhpZl9tc2cg
KndmeF90eF9xdWV1ZXNfZ2V0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLQotYm9vbCB3ZnhfdHhf
cXVldWVfZW1wdHkoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCB3ZnhfcXVldWUgKnF1ZXVl
KTsKLXZvaWQgd2Z4X3R4X3F1ZXVlX2Ryb3Aoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCB3
ZnhfcXVldWUgKnF1ZXVlLAotCQkgICAgICAgc3RydWN0IHNrX2J1ZmZfaGVhZCAqZHJvcHBlZCk7
Ci0KLXN0cnVjdCBza19idWZmICp3ZnhfcGVuZGluZ19nZXQoc3RydWN0IHdmeF9kZXYgKndkZXYs
IHUzMiBwYWNrZXRfaWQpOwotdm9pZCB3ZnhfcGVuZGluZ19kcm9wKHN0cnVjdCB3ZnhfZGV2ICp3
ZGV2LCBzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpkcm9wcGVkKTsKLXVuc2lnbmVkIGludCB3ZnhfcGVu
ZGluZ19nZXRfcGt0X3VzX2RlbGF5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAotCQkJCQkgIHN0cnVj
dCBza19idWZmICpza2IpOwotdm9pZCB3ZnhfcGVuZGluZ19kdW1wX29sZF9mcmFtZXMoc3RydWN0
IHdmeF9kZXYgKndkZXYsIHVuc2lnbmVkIGludCBsaW1pdF9tcyk7Ci0KLSNlbmRpZgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3Nj
YW4uYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNjY4ZWYyYzYwODM3Li4wMDAwMDAw
MDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmMKKysrIC9kZXYvbnVsbApAQCAt
MSwxNDkgKzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQot
LyoKLSAqIFNjYW4gcmVsYXRlZCBmdW5jdGlvbnMuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDE3
LTIwMjAsIFNpbGljb24gTGFib3JhdG9yaWVzLCBJbmMuCi0gKiBDb3B5cmlnaHQgKGMpIDIwMTAs
IFNULUVyaWNzc29uCi0gKi8KLSNpbmNsdWRlIDxuZXQvbWFjODAyMTEuaD4KLQotI2luY2x1ZGUg
InNjYW4uaCIKLSNpbmNsdWRlICJ3ZnguaCIKLSNpbmNsdWRlICJzdGEuaCIKLSNpbmNsdWRlICJo
aWZfdHhfbWliLmgiCi0KLXN0YXRpYyB2b2lkIF9faWVlZTgwMjExX3NjYW5fY29tcGxldGVkX2Nv
bXBhdChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywKLQkJCQkJICAgICAgYm9vbCBhYm9ydGVkKQot
ewotCXN0cnVjdCBjZmc4MDIxMV9zY2FuX2luZm8gaW5mbyA9IHsKLQkJLmFib3J0ZWQgPSBhYm9y
dGVkLAotCX07Ci0KLQlpZWVlODAyMTFfc2Nhbl9jb21wbGV0ZWQoaHcsICZpbmZvKTsKLX0KLQot
c3RhdGljIGludCB1cGRhdGVfcHJvYmVfdG1wbChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKLQkJCSAg
ICAgc3RydWN0IGNmZzgwMjExX3NjYW5fcmVxdWVzdCAqcmVxKQotewotCXN0cnVjdCBza19idWZm
ICpza2I7Ci0KLQlza2IgPSBpZWVlODAyMTFfcHJvYmVyZXFfZ2V0KHd2aWYtPndkZXYtPmh3LCB3
dmlmLT52aWYtPmFkZHIsCi0JCQkJICAgICBOVUxMLCAwLCByZXEtPmllX2xlbik7Ci0JaWYgKCFz
a2IpCi0JCXJldHVybiAtRU5PTUVNOwotCi0Jc2tiX3B1dF9kYXRhKHNrYiwgcmVxLT5pZSwgcmVx
LT5pZV9sZW4pOwotCWhpZl9zZXRfdGVtcGxhdGVfZnJhbWUod3ZpZiwgc2tiLCBISUZfVE1QTFRf
UFJCUkVRLCAwKTsKLQlkZXZfa2ZyZWVfc2tiKHNrYik7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRp
YyBpbnQgc2VuZF9zY2FuX3JlcShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKLQkJCSBzdHJ1Y3QgY2Zn
ODAyMTFfc2Nhbl9yZXF1ZXN0ICpyZXEsIGludCBzdGFydF9pZHgpCi17Ci0JaW50IGksIHJldDsK
LQlzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKmNoX3N0YXJ0LCAqY2hfY3VyOwotCi0JZm9yIChp
ID0gc3RhcnRfaWR4OyBpIDwgcmVxLT5uX2NoYW5uZWxzOyBpKyspIHsKLQkJY2hfc3RhcnQgPSBy
ZXEtPmNoYW5uZWxzW3N0YXJ0X2lkeF07Ci0JCWNoX2N1ciA9IHJlcS0+Y2hhbm5lbHNbaV07Ci0J
CVdBUk4oY2hfY3VyLT5iYW5kICE9IE5MODAyMTFfQkFORF8yR0haLCAiYmFuZCBub3Qgc3VwcG9y
dGVkIik7Ci0JCWlmIChjaF9jdXItPm1heF9wb3dlciAhPSBjaF9zdGFydC0+bWF4X3Bvd2VyKQot
CQkJYnJlYWs7Ci0JCWlmICgoY2hfY3VyLT5mbGFncyBeIGNoX3N0YXJ0LT5mbGFncykgJiBJRUVF
ODAyMTFfQ0hBTl9OT19JUikKLQkJCWJyZWFrOwotCX0KLQl3ZnhfdHhfbG9ja19mbHVzaCh3dmlm
LT53ZGV2KTsKLQl3dmlmLT5zY2FuX2Fib3J0ID0gZmFsc2U7Ci0JcmVpbml0X2NvbXBsZXRpb24o
Jnd2aWYtPnNjYW5fY29tcGxldGUpOwotCXJldCA9IGhpZl9zY2FuKHd2aWYsIHJlcSwgc3RhcnRf
aWR4LCBpIC0gc3RhcnRfaWR4KTsKLQlpZiAocmV0KSB7Ci0JCXdmeF90eF91bmxvY2sod3ZpZi0+
d2Rldik7Ci0JCXJldHVybiAtRUlPOwotCX0KLQlyZXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX3Rp
bWVvdXQoJnd2aWYtPnNjYW5fY29tcGxldGUsIDEgKiBIWik7Ci0JaWYgKCFyZXQpIHsKLQkJaGlm
X3N0b3Bfc2Nhbih3dmlmKTsKLQkJcmV0ID0gd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ3
dmlmLT5zY2FuX2NvbXBsZXRlLCAxICogSFopOwotCQlkZXZfZGJnKHd2aWYtPndkZXYtPmRldiwg
InNjYW4gdGltZW91dCAoJWQgY2hhbm5lbHMgZG9uZSlcbiIsCi0JCQl3dmlmLT5zY2FuX25iX2No
YW5fZG9uZSk7Ci0JfQotCWlmICghcmV0KSB7Ci0JCWRldl9lcnIod3ZpZi0+d2Rldi0+ZGV2LCAi
c2NhbiBkaWRuJ3Qgc3RvcFxuIik7Ci0JCXJldCA9IC1FVElNRURPVVQ7Ci0JfSBlbHNlIGlmICh3
dmlmLT5zY2FuX2Fib3J0KSB7Ci0JCWRldl9ub3RpY2Uod3ZpZi0+d2Rldi0+ZGV2LCAic2NhbiBh
Ym9ydFxuIik7Ci0JCXJldCA9IC1FQ09OTkFCT1JURUQ7Ci0JfSBlbHNlIGlmICh3dmlmLT5zY2Fu
X25iX2NoYW5fZG9uZSA+IGkgLSBzdGFydF9pZHgpIHsKLQkJcmV0ID0gLUVJTzsKLQl9IGVsc2Ug
ewotCQlyZXQgPSB3dmlmLT5zY2FuX25iX2NoYW5fZG9uZTsKLQl9Ci0JaWYgKHJlcS0+Y2hhbm5l
bHNbc3RhcnRfaWR4XS0+bWF4X3Bvd2VyICE9IHd2aWYtPnZpZi0+YnNzX2NvbmYudHhwb3dlcikK
LQkJaGlmX3NldF9vdXRwdXRfcG93ZXIod3ZpZiwgd3ZpZi0+dmlmLT5ic3NfY29uZi50eHBvd2Vy
KTsKLQl3ZnhfdHhfdW5sb2NrKHd2aWYtPndkZXYpOwotCXJldHVybiByZXQ7Ci19Ci0KLS8qIEl0
IGlzIG5vdCByZWFsbHkgbmVjZXNzYXJ5IHRvIHJ1biBzY2FuIHJlcXVlc3QgYXN5bmNocm9ub3Vz
bHkuIEhvd2V2ZXIsCi0gKiB0aGVyZSBpcyBhIGJ1ZyBpbiAiaXcgc2NhbiIgd2hlbiBpZWVlODAy
MTFfc2Nhbl9jb21wbGV0ZWQoKSBpcyBjYWxsZWQgYmVmb3JlCi0gKiB3ZnhfaHdfc2NhbigpIHJl
dHVybgotICovCi12b2lkIHdmeF9od19zY2FuX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCB3
ZnhfdmlmLCBzY2FuX3dvcmspOwotCXN0cnVjdCBpZWVlODAyMTFfc2Nhbl9yZXF1ZXN0ICpod19y
ZXEgPSB3dmlmLT5zY2FuX3JlcTsKLQlpbnQgY2hhbl9jdXIsIHJldCwgZXJyOwotCi0JbXV0ZXhf
bG9jaygmd3ZpZi0+d2Rldi0+Y29uZl9tdXRleCk7Ci0JbXV0ZXhfbG9jaygmd3ZpZi0+c2Nhbl9s
b2NrKTsKLQlpZiAod3ZpZi0+am9pbl9pbl9wcm9ncmVzcykgewotCQlkZXZfaW5mbyh3dmlmLT53
ZGV2LT5kZXYsICIlczogYWJvcnQgaW4tcHJvZ3Jlc3MgUkVRX0pPSU4iLAotCQkJIF9fZnVuY19f
KTsKLQkJd2Z4X3Jlc2V0KHd2aWYpOwotCX0KLQl1cGRhdGVfcHJvYmVfdG1wbCh3dmlmLCAmaHdf
cmVxLT5yZXEpOwotCWNoYW5fY3VyID0gMDsKLQllcnIgPSAwOwotCWRvIHsKLQkJcmV0ID0gc2Vu
ZF9zY2FuX3JlcSh3dmlmLCAmaHdfcmVxLT5yZXEsIGNoYW5fY3VyKTsKLQkJaWYgKHJldCA+IDAp
IHsKLQkJCWNoYW5fY3VyICs9IHJldDsKLQkJCWVyciA9IDA7Ci0JCX0KLQkJaWYgKCFyZXQpCi0J
CQllcnIrKzsKLQkJaWYgKGVyciA+IDIpIHsKLQkJCWRldl9lcnIod3ZpZi0+d2Rldi0+ZGV2LCAi
c2NhbiBoYXMgbm90IGJlZW4gYWJsZSB0byBzdGFydFxuIik7Ci0JCQlyZXQgPSAtRVRJTUVET1VU
OwotCQl9Ci0JfSB3aGlsZSAocmV0ID49IDAgJiYgY2hhbl9jdXIgPCBod19yZXEtPnJlcS5uX2No
YW5uZWxzKTsKLQltdXRleF91bmxvY2soJnd2aWYtPnNjYW5fbG9jayk7Ci0JbXV0ZXhfdW5sb2Nr
KCZ3dmlmLT53ZGV2LT5jb25mX211dGV4KTsKLQlfX2llZWU4MDIxMV9zY2FuX2NvbXBsZXRlZF9j
b21wYXQod3ZpZi0+d2Rldi0+aHcsIHJldCA8IDApOwotfQotCi1pbnQgd2Z4X2h3X3NjYW4oc3Ry
dWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsCi0JCXN0cnVj
dCBpZWVlODAyMTFfc2Nhbl9yZXF1ZXN0ICpod19yZXEpCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2
aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYtPmRydl9wcml2OwotCi0JV0FSTl9PTihod19yZXEt
PnJlcS5uX2NoYW5uZWxzID4gSElGX0FQSV9NQVhfTkJfQ0hBTk5FTFMpOwotCXd2aWYtPnNjYW5f
cmVxID0gaHdfcmVxOwotCXNjaGVkdWxlX3dvcmsoJnd2aWYtPnNjYW5fd29yayk7Ci0JcmV0dXJu
IDA7Ci19Ci0KLXZvaWQgd2Z4X2NhbmNlbF9od19zY2FuKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3
LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmKQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0g
KHN0cnVjdCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQotCXd2aWYtPnNjYW5fYWJvcnQgPSB0
cnVlOwotCWhpZl9zdG9wX3NjYW4od3ZpZik7Ci19Ci0KLXZvaWQgd2Z4X3NjYW5fY29tcGxldGUo
c3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBuYl9jaGFuX2RvbmUpCi17Ci0Jd3ZpZi0+c2Nhbl9u
Yl9jaGFuX2RvbmUgPSBuYl9jaGFuX2RvbmU7Ci0JY29tcGxldGUoJnd2aWYtPnNjYW5fY29tcGxl
dGUpOwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmggYi9kcml2ZXJz
L3N0YWdpbmcvd2Z4L3NjYW4uaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNzhlM2I5
ODRmMzc1Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmgKKysr
IC9kZXYvbnVsbApAQCAtMSwyMiArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5ICovCi0vKgotICogU2NhbiByZWxhdGVkIGZ1bmN0aW9ucy4KLSAqCi0gKiBD
b3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIEluYy4KLSAqIENv
cHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KLSAqLwotI2lmbmRlZiBXRlhfU0NBTl9ICi0j
ZGVmaW5lIFdGWF9TQ0FOX0gKLQotI2luY2x1ZGUgPG5ldC9tYWM4MDIxMS5oPgotCi1zdHJ1Y3Qg
d2Z4X2RldjsKLXN0cnVjdCB3ZnhfdmlmOwotCi12b2lkIHdmeF9od19zY2FuX3dvcmsoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKTsKLWludCB3ZnhfaHdfc2NhbihzdHJ1Y3QgaWVlZTgwMjExX2h3
ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKLQkJc3RydWN0IGllZWU4MDIxMV9zY2Fu
X3JlcXVlc3QgKnJlcSk7Ci12b2lkIHdmeF9jYW5jZWxfaHdfc2NhbihzdHJ1Y3QgaWVlZTgwMjEx
X2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZik7Ci12b2lkIHdmeF9zY2FuX2NvbXBs
ZXRlKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgbmJfY2hhbl9kb25lKTsKLQotI2VuZGlmCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L3N0YS5jIGIvZHJpdmVycy9zdGFnaW5nL3dm
eC9zdGEuYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMjNjMDQyNWUzOTI5Li4wMDAw
MDAwMDAwMDAKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYworKysgL2Rldi9udWxsCkBA
IC0xLDgzMyArMCwwIEBACi0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5
Ci0vKgotICogSW1wbGVtZW50YXRpb24gb2YgbWFjODAyMTEgQVBJLgotICoKLSAqIENvcHlyaWdo
dCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0
IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0jaW5jbHVkZSA8bGludXgvZXRoZXJkZXZpY2Uu
aD4KLSNpbmNsdWRlIDxuZXQvbWFjODAyMTEuaD4KLQotI2luY2x1ZGUgInN0YS5oIgotI2luY2x1
ZGUgIndmeC5oIgotI2luY2x1ZGUgImZ3aW8uaCIKLSNpbmNsdWRlICJiaC5oIgotI2luY2x1ZGUg
ImtleS5oIgotI2luY2x1ZGUgInNjYW4uaCIKLSNpbmNsdWRlICJkZWJ1Zy5oIgotI2luY2x1ZGUg
ImhpZl90eC5oIgotI2luY2x1ZGUgImhpZl90eF9taWIuaCIKLQotI2RlZmluZSBISUZfTUFYX0FS
UF9JUF9BRERSVEFCTEVfRU5UUklFUyAyCi0KLXUzMiB3ZnhfcmF0ZV9tYXNrX3RvX2h3KHN0cnVj
dCB3ZnhfZGV2ICp3ZGV2LCB1MzIgcmF0ZXMpCi17Ci0JaW50IGk7Ci0JdTMyIHJldCA9IDA7Ci0J
LyogVGhlIGRldmljZSBvbmx5IHN1cHBvcnRzIDJHSHogKi8KLQlzdHJ1Y3QgaWVlZTgwMjExX3N1
cHBvcnRlZF9iYW5kICpzYmFuZCA9IHdkZXYtPmh3LT53aXBoeS0+YmFuZHNbTkw4MDIxMV9CQU5E
XzJHSFpdOwotCi0JZm9yIChpID0gMDsgaSA8IHNiYW5kLT5uX2JpdHJhdGVzOyBpKyspIHsKLQkJ
aWYgKHJhdGVzICYgQklUKGkpKSB7Ci0JCQlpZiAoaSA+PSBzYmFuZC0+bl9iaXRyYXRlcykKLQkJ
CQlkZXZfd2Fybih3ZGV2LT5kZXYsICJ1bnN1cHBvcnRlZCBiYXNpYyByYXRlXG4iKTsKLQkJCWVs
c2UKLQkJCQlyZXQgfD0gQklUKHNiYW5kLT5iaXRyYXRlc1tpXS5od192YWx1ZSk7Ci0JCX0KLQl9
Ci0JcmV0dXJuIHJldDsKLX0KLQotdm9pZCB3ZnhfY29vbGluZ190aW1lb3V0X3dvcmsoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQotewotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gY29udGFpbmVy
X29mKHRvX2RlbGF5ZWRfd29yayh3b3JrKSwKLQkJCQkJICAgIHN0cnVjdCB3ZnhfZGV2LAotCQkJ
CQkgICAgY29vbGluZ190aW1lb3V0X3dvcmspOwotCi0Jd2Rldi0+Y2hpcF9mcm96ZW4gPSB0cnVl
OwotCXdmeF90eF91bmxvY2sod2Rldik7Ci19Ci0KLXZvaWQgd2Z4X3N1c3BlbmRfaG90X2Rldihz
dHJ1Y3Qgd2Z4X2RldiAqd2RldiwgZW51bSBzdGFfbm90aWZ5X2NtZCBjbWQpCi17Ci0JaWYgKGNt
ZCA9PSBTVEFfTk9USUZZX0FXQUtFKSB7Ci0JCS8qIERldmljZSByZWNvdmVyIG5vcm1hbCB0ZW1w
ZXJhdHVyZSAqLwotCQlpZiAoY2FuY2VsX2RlbGF5ZWRfd29yaygmd2Rldi0+Y29vbGluZ190aW1l
b3V0X3dvcmspKQotCQkJd2Z4X3R4X3VubG9jayh3ZGV2KTsKLQl9IGVsc2UgewotCQkvKiBEZXZp
Y2UgaXMgdG9vIGhvdCAqLwotCQlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJndkZXYtPmNvb2xpbmdf
dGltZW91dF93b3JrLCAxMCAqIEhaKTsKLQkJd2Z4X3R4X2xvY2sod2Rldik7Ci0JfQotfQotCi1z
dGF0aWMgdm9pZCB3ZnhfZmlsdGVyX2JlYWNvbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBm
aWx0ZXJfYmVhY29uKQotewotCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaGlmX2llX3RhYmxlX2VudHJ5
IGZpbHRlcl9pZXNbXSA9IHsKLQkJewotCQkJLmllX2lkICAgICAgICA9IFdMQU5fRUlEX1ZFTkRP
Ul9TUEVDSUZJQywKLQkJCS5oYXNfY2hhbmdlZCAgPSAxLAotCQkJLm5vX2xvbmdlciAgICA9IDEs
Ci0JCQkuaGFzX2FwcGVhcmVkID0gMSwKLQkJCS5vdWkgICAgICAgICAgPSB7IDB4NTAsIDB4NkYs
IDB4OUEgfSwKLQkJfSwgewotCQkJLmllX2lkICAgICAgICA9IFdMQU5fRUlEX0hUX09QRVJBVElP
TiwKLQkJCS5oYXNfY2hhbmdlZCAgPSAxLAotCQkJLm5vX2xvbmdlciAgICA9IDEsCi0JCQkuaGFz
X2FwcGVhcmVkID0gMSwKLQkJfSwgewotCQkJLmllX2lkICAgICAgICA9IFdMQU5fRUlEX0VSUF9J
TkZPLAotCQkJLmhhc19jaGFuZ2VkICA9IDEsCi0JCQkubm9fbG9uZ2VyICAgID0gMSwKLQkJCS5o
YXNfYXBwZWFyZWQgPSAxLAotCQl9LCB7Ci0JCQkuaWVfaWQgICAgICAgID0gV0xBTl9FSURfQ0hB
Tk5FTF9TV0lUQ0gsCi0JCQkuaGFzX2NoYW5nZWQgID0gMSwKLQkJCS5ub19sb25nZXIgICAgPSAx
LAotCQkJLmhhc19hcHBlYXJlZCA9IDEsCi0JCX0KLQl9OwotCi0JaWYgKCFmaWx0ZXJfYmVhY29u
KSB7Ci0JCWhpZl9iZWFjb25fZmlsdGVyX2NvbnRyb2wod3ZpZiwgMCwgMSk7Ci0JfSBlbHNlIHsK
LQkJaGlmX3NldF9iZWFjb25fZmlsdGVyX3RhYmxlKHd2aWYsIEFSUkFZX1NJWkUoZmlsdGVyX2ll
cyksIGZpbHRlcl9pZXMpOwotCQloaWZfYmVhY29uX2ZpbHRlcl9jb250cm9sKHd2aWYsIEhJRl9C
RUFDT05fRklMVEVSX0VOQUJMRSwgMCk7Ci0JfQotfQotCi12b2lkIHdmeF9jb25maWd1cmVfZmls
dGVyKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCB1bnNpZ25lZCBpbnQgY2hhbmdlZF9mbGFncywK
LQkJCSAgdW5zaWduZWQgaW50ICp0b3RhbF9mbGFncywgdTY0IHVudXNlZCkKLXsKLQlzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiA9IE5VTEw7Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYgPSBody0+cHJpdjsK
LQlib29sIGZpbHRlcl9ic3NpZCwgZmlsdGVyX3ByYnJlcSwgZmlsdGVyX2JlYWNvbjsKLQotCS8q
IE5vdGVzOgotCSAqICAgLSBQcm9iZSByZXNwb25zZXMgKEZJRl9CQ05fUFJCUkVTUF9QUk9NSVND
KSBhcmUgbmV2ZXIgZmlsdGVyZWQKLQkgKiAgIC0gUFMtUG9sbCAoRklGX1BTUE9MTCkgYXJlIG5l
dmVyIGZpbHRlcmVkCi0JICogICAtIFJUUywgQ1RTIGFuZCBBY2sgKEZJRl9DT05UUk9MKSBhcmUg
YWx3YXlzIGZpbHRlcmVkCi0JICogICAtIEJyb2tlbiBmcmFtZXMgKEZJRl9GQ1NGQUlMIGFuZCBG
SUZfUExDUEZBSUwpIGFyZSBhbHdheXMgZmlsdGVyZWQKLQkgKiAgIC0gRmlybXdhcmUgZG9lcyAo
eWV0KSBhbGxvdyB0byBmb3J3YXJkIHVuaWNhc3QgdHJhZmZpYyBzZW50IHRvCi0JICogICAgIG90
aGVyIHN0YXRpb25zIChha2EuIHByb21pc2N1b3VzIG1vZGUpCi0JICovCi0JKnRvdGFsX2ZsYWdz
ICY9IEZJRl9CQ05fUFJCUkVTUF9QUk9NSVNDIHwgRklGX0FMTE1VTFRJIHwgRklGX09USEVSX0JT
UyB8Ci0JCQlGSUZfUFJPQkVfUkVRIHwgRklGX1BTUE9MTDsKLQotCW11dGV4X2xvY2soJndkZXYt
PmNvbmZfbXV0ZXgpOwotCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkg
IT0gTlVMTCkgewotCQltdXRleF9sb2NrKCZ3dmlmLT5zY2FuX2xvY2spOwotCi0JCS8qIE5vdGU6
IEZJRl9CQ05fUFJCUkVTUF9QUk9NSVNDIGNvdmVycyBwcm9iZSByZXNwb25zZSBhbmQKLQkJICog
YmVhY29ucyBmcm9tIG90aGVyIEJTUwotCQkgKi8KLQkJaWYgKCp0b3RhbF9mbGFncyAmIEZJRl9C
Q05fUFJCUkVTUF9QUk9NSVNDKQotCQkJZmlsdGVyX2JlYWNvbiA9IGZhbHNlOwotCQllbHNlCi0J
CQlmaWx0ZXJfYmVhY29uID0gdHJ1ZTsKLQkJd2Z4X2ZpbHRlcl9iZWFjb24od3ZpZiwgZmlsdGVy
X2JlYWNvbik7Ci0KLQkJaWYgKCp0b3RhbF9mbGFncyAmIEZJRl9PVEhFUl9CU1MpCi0JCQlmaWx0
ZXJfYnNzaWQgPSBmYWxzZTsKLQkJZWxzZQotCQkJZmlsdGVyX2Jzc2lkID0gdHJ1ZTsKLQotCQkv
KiBJbiBBUCBtb2RlLCBjaGlwIGNhbiByZXBseSB0byBwcm9iZSByZXF1ZXN0IGl0c2VsZiAqLwot
CQlpZiAoKnRvdGFsX2ZsYWdzICYgRklGX1BST0JFX1JFUSAmJgotCQkgICAgd3ZpZi0+dmlmLT50
eXBlID09IE5MODAyMTFfSUZUWVBFX0FQKSB7Ci0JCQlkZXZfZGJnKHdkZXYtPmRldiwgImRvIG5v
dCBmb3J3YXJkIHByb2JlIHJlcXVlc3QgaW4gQVAgbW9kZVxuIik7Ci0JCQkqdG90YWxfZmxhZ3Mg
Jj0gfkZJRl9QUk9CRV9SRVE7Ci0JCX0KLQotCQlpZiAoKnRvdGFsX2ZsYWdzICYgRklGX1BST0JF
X1JFUSkKLQkJCWZpbHRlcl9wcmJyZXEgPSBmYWxzZTsKLQkJZWxzZQotCQkJZmlsdGVyX3ByYnJl
cSA9IHRydWU7Ci0JCWhpZl9zZXRfcnhfZmlsdGVyKHd2aWYsIGZpbHRlcl9ic3NpZCwgZmlsdGVy
X3ByYnJlcSk7Ci0KLQkJbXV0ZXhfdW5sb2NrKCZ3dmlmLT5zY2FuX2xvY2spOwotCX0KLQltdXRl
eF91bmxvY2soJndkZXYtPmNvbmZfbXV0ZXgpOwotfQotCi1zdGF0aWMgaW50IHdmeF9nZXRfcHNf
dGltZW91dChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCAqZW5hYmxlX3BzKQotewotCXN0cnVj
dCBpZWVlODAyMTFfY2hhbm5lbCAqY2hhbjAgPSBOVUxMLCAqY2hhbjEgPSBOVUxMOwotCXN0cnVj
dCBpZWVlODAyMTFfY29uZiAqY29uZiA9ICZ3dmlmLT53ZGV2LT5ody0+Y29uZjsKLQotCVdBUk4o
IXd2aWYtPnZpZi0+YnNzX2NvbmYuYXNzb2MgJiYgZW5hYmxlX3BzLAotCSAgICAgImVuYWJsZV9w
cyBpcyByZWxpYWJsZSBvbmx5IGlmIGFzc29jaWF0ZWQiKTsKLQlpZiAod2Rldl90b193dmlmKHd2
aWYtPndkZXYsIDApKQotCQljaGFuMCA9IHdkZXZfdG9fd3ZpZih3dmlmLT53ZGV2LCAwKS0+dmlm
LT5ic3NfY29uZi5jaGFuZGVmLmNoYW47Ci0JaWYgKHdkZXZfdG9fd3ZpZih3dmlmLT53ZGV2LCAx
KSkKLQkJY2hhbjEgPSB3ZGV2X3RvX3d2aWYod3ZpZi0+d2RldiwgMSktPnZpZi0+YnNzX2NvbmYu
Y2hhbmRlZi5jaGFuOwotCWlmIChjaGFuMCAmJiBjaGFuMSAmJiB3dmlmLT52aWYtPnR5cGUgIT0g
Tkw4MDIxMV9JRlRZUEVfQVApIHsKLQkJaWYgKGNoYW4wLT5od192YWx1ZSA9PSBjaGFuMS0+aHdf
dmFsdWUpIHsKLQkJCS8qIEl0IGlzIHVzZWxlc3MgdG8gZW5hYmxlIFBTIGlmIGNoYW5uZWxzIGFy
ZSB0aGUgc2FtZS4gKi8KLQkJCWlmIChlbmFibGVfcHMpCi0JCQkJKmVuYWJsZV9wcyA9IGZhbHNl
OwotCQkJaWYgKHd2aWYtPnZpZi0+YnNzX2NvbmYuYXNzb2MgJiYgd3ZpZi0+dmlmLT5ic3NfY29u
Zi5wcykKLQkJCQlkZXZfaW5mbyh3dmlmLT53ZGV2LT5kZXYsICJpZ25vcmluZyByZXF1ZXN0ZWQg
UFMgbW9kZSIpOwotCQkJcmV0dXJuIC0xOwotCQl9Ci0JCS8qIEl0IGlzIG5lY2Vzc2FyeSB0byBl
bmFibGUgUFMgaWYgY2hhbm5lbHMKLQkJICogYXJlIGRpZmZlcmVudC4KLQkJICovCi0JCWlmIChl
bmFibGVfcHMpCi0JCQkqZW5hYmxlX3BzID0gdHJ1ZTsKLQkJaWYgKHd2aWYtPndkZXYtPmZvcmNl
X3BzX3RpbWVvdXQgPiAtMSkKLQkJCXJldHVybiB3dmlmLT53ZGV2LT5mb3JjZV9wc190aW1lb3V0
OwotCQllbHNlIGlmICh3ZnhfYXBpX29sZGVyX3RoYW4od3ZpZi0+d2RldiwgMywgMikpCi0JCQly
ZXR1cm4gMDsKLQkJZWxzZQotCQkJcmV0dXJuIDMwOwotCX0KLQlpZiAoZW5hYmxlX3BzKQotCQkq
ZW5hYmxlX3BzID0gd3ZpZi0+dmlmLT5ic3NfY29uZi5wczsKLQlpZiAod3ZpZi0+d2Rldi0+Zm9y
Y2VfcHNfdGltZW91dCA+IC0xKQotCQlyZXR1cm4gd3ZpZi0+d2Rldi0+Zm9yY2VfcHNfdGltZW91
dDsKLQllbHNlIGlmICh3dmlmLT52aWYtPmJzc19jb25mLmFzc29jICYmIHd2aWYtPnZpZi0+YnNz
X2NvbmYucHMpCi0JCXJldHVybiBjb25mLT5keW5hbWljX3BzX3RpbWVvdXQ7Ci0JZWxzZQotCQly
ZXR1cm4gLTE7Ci19Ci0KLWludCB3ZnhfdXBkYXRlX3BtKHN0cnVjdCB3ZnhfdmlmICp3dmlmKQot
ewotCWludCBwc190aW1lb3V0OwotCWJvb2wgcHM7Ci0KLQlpZiAoIXd2aWYtPnZpZi0+YnNzX2Nv
bmYuYXNzb2MpCi0JCXJldHVybiAwOwotCXBzX3RpbWVvdXQgPSB3ZnhfZ2V0X3BzX3RpbWVvdXQo
d3ZpZiwgJnBzKTsKLQlpZiAoIXBzKQotCQlwc190aW1lb3V0ID0gMDsKLQlXQVJOX09OKHBzX3Rp
bWVvdXQgPCAwKTsKLQlpZiAod3ZpZi0+dWFwc2RfbWFzaykKLQkJcHNfdGltZW91dCA9IDA7Ci0K
LQlpZiAoIXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmd3ZpZi0+c2V0X3BtX21vZGVfY29t
cGxldGUsCi0JCQkJCSBUVV9UT19KSUZGSUVTKDUxMikpKQotCQlkZXZfd2Fybih3dmlmLT53ZGV2
LT5kZXYsCi0JCQkgInRpbWVvdXQgd2hpbGUgd2FpdGluZyBvZiBzZXRfcG1fbW9kZV9jb21wbGV0
ZVxuIik7Ci0JcmV0dXJuIGhpZl9zZXRfcG0od3ZpZiwgcHMsIHBzX3RpbWVvdXQpOwotfQotCi1p
bnQgd2Z4X2NvbmZfdHgoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFf
dmlmICp2aWYsCi0JCXUxNiBxdWV1ZSwgY29uc3Qgc3RydWN0IGllZWU4MDIxMV90eF9xdWV1ZV9w
YXJhbXMgKnBhcmFtcykKLXsKLQlzdHJ1Y3Qgd2Z4X2RldiAqd2RldiA9IGh3LT5wcml2OwotCXN0
cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQlp
bnQgb2xkX3VhcHNkID0gd3ZpZi0+dWFwc2RfbWFzazsKLQotCVdBUk5fT04ocXVldWUgPj0gaHct
PnF1ZXVlcyk7Ci0KLQltdXRleF9sb2NrKCZ3ZGV2LT5jb25mX211dGV4KTsKLQlhc3NpZ25fYml0
KHF1ZXVlLCAmd3ZpZi0+dWFwc2RfbWFzaywgcGFyYW1zLT51YXBzZCk7Ci0JaGlmX3NldF9lZGNh
X3F1ZXVlX3BhcmFtcyh3dmlmLCBxdWV1ZSwgcGFyYW1zKTsKLQlpZiAod3ZpZi0+dmlmLT50eXBl
ID09IE5MODAyMTFfSUZUWVBFX1NUQVRJT04gJiYKLQkgICAgb2xkX3VhcHNkICE9IHd2aWYtPnVh
cHNkX21hc2spIHsKLQkJaGlmX3NldF91YXBzZF9pbmZvKHd2aWYsIHd2aWYtPnVhcHNkX21hc2sp
OwotCQl3ZnhfdXBkYXRlX3BtKHd2aWYpOwotCX0KLQltdXRleF91bmxvY2soJndkZXYtPmNvbmZf
bXV0ZXgpOwotCXJldHVybiAwOwotfQotCi1pbnQgd2Z4X3NldF9ydHNfdGhyZXNob2xkKHN0cnVj
dCBpZWVlODAyMTFfaHcgKmh3LCB1MzIgdmFsdWUpCi17Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYg
PSBody0+cHJpdjsKLQlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiA9IE5VTEw7Ci0KLQl3aGlsZSAoKHd2
aWYgPSB3dmlmX2l0ZXJhdGUod2Rldiwgd3ZpZikpICE9IE5VTEwpCi0JCWhpZl9ydHNfdGhyZXNo
b2xkKHd2aWYsIHZhbHVlKTsKLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB3ZnhfZXZlbnRfcmVwb3J0
X3Jzc2koc3RydWN0IHdmeF92aWYgKnd2aWYsIHU4IHJhd19yY3BpX3Jzc2kpCi17Ci0JLyogUlNT
STogc2lnbmVkIFE4LjAsIFJDUEk6IHVuc2lnbmVkIFE3LjEKLQkgKiBSU1NJID0gUkNQSSAvIDIg
LSAxMTAKLQkgKi8KLQlpbnQgcmNwaV9yc3NpOwotCWludCBjcW1fZXZ0OwotCi0JcmNwaV9yc3Np
ID0gcmF3X3JjcGlfcnNzaSAvIDIgLSAxMTA7Ci0JaWYgKHJjcGlfcnNzaSA8PSB3dmlmLT52aWYt
PmJzc19jb25mLmNxbV9yc3NpX3Rob2xkKQotCQljcW1fZXZ0ID0gTkw4MDIxMV9DUU1fUlNTSV9U
SFJFU0hPTERfRVZFTlRfTE9XOwotCWVsc2UKLQkJY3FtX2V2dCA9IE5MODAyMTFfQ1FNX1JTU0lf
VEhSRVNIT0xEX0VWRU5UX0hJR0g7Ci0JaWVlZTgwMjExX2NxbV9yc3NpX25vdGlmeSh3dmlmLT52
aWYsIGNxbV9ldnQsIHJjcGlfcnNzaSwgR0ZQX0tFUk5FTCk7Ci19Ci0KLXN0YXRpYyB2b2lkIHdm
eF9iZWFjb25fbG9zc193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKLXsKLQlzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiA9IGNvbnRhaW5lcl9vZih0b19kZWxheWVkX3dvcmsod29yayksCi0JCQkJ
CSAgICBzdHJ1Y3Qgd2Z4X3ZpZiwgYmVhY29uX2xvc3Nfd29yayk7Ci0Jc3RydWN0IGllZWU4MDIx
MV9ic3NfY29uZiAqYnNzX2NvbmYgPSAmd3ZpZi0+dmlmLT5ic3NfY29uZjsKLQotCWllZWU4MDIx
MV9iZWFjb25fbG9zcyh3dmlmLT52aWYpOwotCXNjaGVkdWxlX2RlbGF5ZWRfd29yayh0b19kZWxh
eWVkX3dvcmsod29yayksCi0JCQkgICAgICBtc2Vjc190b19qaWZmaWVzKGJzc19jb25mLT5iZWFj
b25faW50KSk7Ci19Ci0KLXZvaWQgd2Z4X3NldF9kZWZhdWx0X3VuaWNhc3Rfa2V5KHN0cnVjdCBp
ZWVlODAyMTFfaHcgKmh3LAotCQkJCSBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLCBpbnQgaWR4
KQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICopdmlmLT5kcnZf
cHJpdjsKLQotCWhpZl93ZXBfZGVmYXVsdF9rZXlfaWQod3ZpZiwgaWR4KTsKLX0KLQotdm9pZCB3
ZnhfcmVzZXQoc3RydWN0IHdmeF92aWYgKnd2aWYpCi17Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYg
PSB3dmlmLT53ZGV2OwotCi0Jd2Z4X3R4X2xvY2tfZmx1c2god2Rldik7Ci0JaGlmX3Jlc2V0KHd2
aWYsIGZhbHNlKTsKLQl3ZnhfdHhfcG9saWN5X2luaXQod3ZpZik7Ci0JaWYgKHd2aWZfY291bnQo
d2RldikgPD0gMSkKLQkJaGlmX3NldF9ibG9ja19hY2tfcG9saWN5KHd2aWYsIDB4RkYsIDB4RkYp
OwotCXdmeF90eF91bmxvY2sod2Rldik7Ci0Jd3ZpZi0+am9pbl9pbl9wcm9ncmVzcyA9IGZhbHNl
OwotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmd3ZpZi0+YmVhY29uX2xvc3Nfd29yayk7Ci0J
d3ZpZiA9ICBOVUxMOwotCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkg
IT0gTlVMTCkKLQkJd2Z4X3VwZGF0ZV9wbSh3dmlmKTsKLX0KLQotaW50IHdmeF9zdGFfYWRkKHN0
cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLAotCQlzdHJ1
Y3QgaWVlZTgwMjExX3N0YSAqc3RhKQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVj
dCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQlzdHJ1Y3Qgd2Z4X3N0YV9wcml2ICpzdGFfcHJp
diA9IChzdHJ1Y3Qgd2Z4X3N0YV9wcml2ICopJnN0YS0+ZHJ2X3ByaXY7Ci0KLQlzdGFfcHJpdi0+
dmlmX2lkID0gd3ZpZi0+aWQ7Ci0KLQlpZiAodmlmLT50eXBlID09IE5MODAyMTFfSUZUWVBFX1NU
QVRJT04pCi0JCWhpZl9zZXRfbWZwKHd2aWYsIHN0YS0+bWZwLCBzdGEtPm1mcCk7Ci0KLQkvKiBJ
biBzdGF0aW9uIG1vZGUsIHRoZSBmaXJtd2FyZSBpbnRlcnByZXRzIG5ldyBsaW5rLWlkIGFzIGEg
VERMUyBwZWVyICovCi0JaWYgKHZpZi0+dHlwZSA9PSBOTDgwMjExX0lGVFlQRV9TVEFUSU9OICYm
ICFzdGEtPnRkbHMpCi0JCXJldHVybiAwOwotCXN0YV9wcml2LT5saW5rX2lkID0gZmZ6KHd2aWYt
PmxpbmtfaWRfbWFwKTsKLQl3dmlmLT5saW5rX2lkX21hcCB8PSBCSVQoc3RhX3ByaXYtPmxpbmtf
aWQpOwotCVdBUk5fT04oIXN0YV9wcml2LT5saW5rX2lkKTsKLQlXQVJOX09OKHN0YV9wcml2LT5s
aW5rX2lkID49IEhJRl9MSU5LX0lEX01BWCk7Ci0JaGlmX21hcF9saW5rKHd2aWYsIGZhbHNlLCBz
dGEtPmFkZHIsIHN0YV9wcml2LT5saW5rX2lkLCBzdGEtPm1mcCk7Ci0KLQlyZXR1cm4gMDsKLX0K
LQotaW50IHdmeF9zdGFfcmVtb3ZlKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVl
ZTgwMjExX3ZpZiAqdmlmLAotCQkgICBzdHJ1Y3QgaWVlZTgwMjExX3N0YSAqc3RhKQotewotCXN0
cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQlz
dHJ1Y3Qgd2Z4X3N0YV9wcml2ICpzdGFfcHJpdiA9IChzdHJ1Y3Qgd2Z4X3N0YV9wcml2ICopJnN0
YS0+ZHJ2X3ByaXY7Ci0KLQkvKiBTZWUgbm90ZSBpbiB3Znhfc3RhX2FkZCgpICovCi0JaWYgKCFz
dGFfcHJpdi0+bGlua19pZCkKLQkJcmV0dXJuIDA7Ci0JLyogRklYTUUgYWRkIGEgbXV0ZXg/ICov
Ci0JaGlmX21hcF9saW5rKHd2aWYsIHRydWUsIHN0YS0+YWRkciwgc3RhX3ByaXYtPmxpbmtfaWQs
IGZhbHNlKTsKLQl3dmlmLT5saW5rX2lkX21hcCAmPSB+QklUKHN0YV9wcml2LT5saW5rX2lkKTsK
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCB3ZnhfdXBsb2FkX2FwX3RlbXBsYXRlcyhzdHJ1
Y3Qgd2Z4X3ZpZiAqd3ZpZikKLXsKLQlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCi0Jc2tiID0gaWVl
ZTgwMjExX2JlYWNvbl9nZXQod3ZpZi0+d2Rldi0+aHcsIHd2aWYtPnZpZik7Ci0JaWYgKCFza2Ip
Ci0JCXJldHVybiAtRU5PTUVNOwotCWhpZl9zZXRfdGVtcGxhdGVfZnJhbWUod3ZpZiwgc2tiLCBI
SUZfVE1QTFRfQkNOLAotCQkJICAgICAgIEFQSV9SQVRFX0lOREVYX0JfMU1CUFMpOwotCWRldl9r
ZnJlZV9za2Ioc2tiKTsKLQotCXNrYiA9IGllZWU4MDIxMV9wcm9iZXJlc3BfZ2V0KHd2aWYtPndk
ZXYtPmh3LCB3dmlmLT52aWYpOwotCWlmICghc2tiKQotCQlyZXR1cm4gLUVOT01FTTsKLQloaWZf
c2V0X3RlbXBsYXRlX2ZyYW1lKHd2aWYsIHNrYiwgSElGX1RNUExUX1BSQlJFUywKLQkJCSAgICAg
ICBBUElfUkFURV9JTkRFWF9CXzFNQlBTKTsKLQlkZXZfa2ZyZWVfc2tiKHNrYik7Ci0JcmV0dXJu
IDA7Ci19Ci0KLXN0YXRpYyB2b2lkIHdmeF9zZXRfbWZwX2FwKHN0cnVjdCB3ZnhfdmlmICp3dmlm
KQotewotCXN0cnVjdCBza19idWZmICpza2IgPSBpZWVlODAyMTFfYmVhY29uX2dldCh3dmlmLT53
ZGV2LT5odywgd3ZpZi0+dmlmKTsKLQljb25zdCBpbnQgaWVvZmZzZXQgPSBvZmZzZXRvZihzdHJ1
Y3QgaWVlZTgwMjExX21nbXQsIHUuYmVhY29uLnZhcmlhYmxlKTsKLQljb25zdCB1MTYgKnB0ciA9
ICh1MTYgKiljZmc4MDIxMV9maW5kX2llKFdMQU5fRUlEX1JTTiwKLQkJCQkJCSBza2ItPmRhdGEg
KyBpZW9mZnNldCwKLQkJCQkJCSBza2ItPmxlbiAtIGllb2Zmc2V0KTsKLQljb25zdCBpbnQgcGFp
cndpc2VfY2lwaGVyX3N1aXRlX2NvdW50X29mZnNldCA9IDggLyBzaXplb2YodTE2KTsKLQljb25z
dCBpbnQgcGFpcndpc2VfY2lwaGVyX3N1aXRlX3NpemUgPSA0IC8gc2l6ZW9mKHUxNik7Ci0JY29u
c3QgaW50IGFrbV9zdWl0ZV9zaXplID0gNCAvIHNpemVvZih1MTYpOwotCi0JaWYgKHB0cikgewot
CQlwdHIgKz0gcGFpcndpc2VfY2lwaGVyX3N1aXRlX2NvdW50X29mZnNldDsKLQkJaWYgKFdBUk5f
T04ocHRyID4gKHUxNiAqKXNrYl90YWlsX3BvaW50ZXIoc2tiKSkpCi0JCQlyZXR1cm47Ci0JCXB0
ciArPSAxICsgcGFpcndpc2VfY2lwaGVyX3N1aXRlX3NpemUgKiAqcHRyOwotCQlpZiAoV0FSTl9P
TihwdHIgPiAodTE2ICopc2tiX3RhaWxfcG9pbnRlcihza2IpKSkKLQkJCXJldHVybjsKLQkJcHRy
ICs9IDEgKyBha21fc3VpdGVfc2l6ZSAqICpwdHI7Ci0JCWlmIChXQVJOX09OKHB0ciA+ICh1MTYg
Kilza2JfdGFpbF9wb2ludGVyKHNrYikpKQotCQkJcmV0dXJuOwotCQloaWZfc2V0X21mcCh3dmlm
LCAqcHRyICYgQklUKDcpLCAqcHRyICYgQklUKDYpKTsKLQl9Ci19Ci0KLWludCB3Znhfc3RhcnRf
YXAoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYpCi17
Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYtPmRydl9wcml2
OwotCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gd3ZpZi0+d2RldjsKLQlpbnQgcmV0OwotCi0Jd3Zp
ZiA9ICBOVUxMOwotCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0g
TlVMTCkKLQkJd2Z4X3VwZGF0ZV9wbSh3dmlmKTsKLQl3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICop
dmlmLT5kcnZfcHJpdjsKLQl3ZnhfdXBsb2FkX2FwX3RlbXBsYXRlcyh3dmlmKTsKLQlyZXQgPSBo
aWZfc3RhcnQod3ZpZiwgJnZpZi0+YnNzX2NvbmYsIHd2aWYtPmNoYW5uZWwpOwotCWlmIChyZXQg
PiAwKQotCQlyZXR1cm4gLUVJTzsKLQl3Znhfc2V0X21mcF9hcCh3dmlmKTsKLQlyZXR1cm4gcmV0
OwotfQotCi12b2lkIHdmeF9zdG9wX2FwKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3Qg
aWVlZTgwMjExX3ZpZiAqdmlmKQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3
ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQotCXdmeF9yZXNldCh3dmlmKTsKLX0KLQotc3RhdGlj
IHZvaWQgd2Z4X2pvaW4oc3RydWN0IHdmeF92aWYgKnd2aWYpCi17Ci0JaW50IHJldDsKLQlzdHJ1
Y3QgaWVlZTgwMjExX2Jzc19jb25mICpjb25mID0gJnd2aWYtPnZpZi0+YnNzX2NvbmY7Ci0Jc3Ry
dWN0IGNmZzgwMjExX2JzcyAqYnNzID0gTlVMTDsKLQl1OCBzc2lkW0lFRUU4MDIxMV9NQVhfU1NJ
RF9MRU5dOwotCWNvbnN0IHU4ICpzc2lkaWUgPSBOVUxMOwotCWludCBzc2lkbGVuID0gMDsKLQot
CXdmeF90eF9sb2NrX2ZsdXNoKHd2aWYtPndkZXYpOwotCi0JYnNzID0gY2ZnODAyMTFfZ2V0X2Jz
cyh3dmlmLT53ZGV2LT5ody0+d2lwaHksIHd2aWYtPmNoYW5uZWwsCi0JCQkgICAgICAgY29uZi0+
YnNzaWQsIE5VTEwsIDAsCi0JCQkgICAgICAgSUVFRTgwMjExX0JTU19UWVBFX0FOWSwgSUVFRTgw
MjExX1BSSVZBQ1lfQU5ZKTsKLQlpZiAoIWJzcyAmJiAhY29uZi0+aWJzc19qb2luZWQpIHsKLQkJ
d2Z4X3R4X3VubG9jayh3dmlmLT53ZGV2KTsKLQkJcmV0dXJuOwotCX0KLQotCXJjdV9yZWFkX2xv
Y2soKTsgLyogcHJvdGVjdCBzc2lkaWUgKi8KLQlpZiAoYnNzKQotCQlzc2lkaWUgPSBpZWVlODAy
MTFfYnNzX2dldF9pZShic3MsIFdMQU5fRUlEX1NTSUQpOwotCWlmIChzc2lkaWUpIHsKLQkJc3Np
ZGxlbiA9IHNzaWRpZVsxXTsKLQkJaWYgKHNzaWRsZW4gPiBJRUVFODAyMTFfTUFYX1NTSURfTEVO
KQotCQkJc3NpZGxlbiA9IElFRUU4MDIxMV9NQVhfU1NJRF9MRU47Ci0JCW1lbWNweShzc2lkLCAm
c3NpZGllWzJdLCBzc2lkbGVuKTsKLQl9Ci0JcmN1X3JlYWRfdW5sb2NrKCk7Ci0KLQljZmc4MDIx
MV9wdXRfYnNzKHd2aWYtPndkZXYtPmh3LT53aXBoeSwgYnNzKTsKLQotCXd2aWYtPmpvaW5faW5f
cHJvZ3Jlc3MgPSB0cnVlOwotCXJldCA9IGhpZl9qb2luKHd2aWYsIGNvbmYsIHd2aWYtPmNoYW5u
ZWwsIHNzaWQsIHNzaWRsZW4pOwotCWlmIChyZXQpIHsKLQkJaWVlZTgwMjExX2Nvbm5lY3Rpb25f
bG9zcyh3dmlmLT52aWYpOwotCQl3ZnhfcmVzZXQod3ZpZik7Ci0JfSBlbHNlIHsKLQkJLyogRHVl
IHRvIGJlYWNvbiBmaWx0ZXJpbmcgaXQgaXMgcG9zc2libGUgdGhhdCB0aGUKLQkJICogQVAncyBi
ZWFjb24gaXMgbm90IGtub3duIGZvciB0aGUgbWFjODAyMTEgc3RhY2suCi0JCSAqIERpc2FibGUg
ZmlsdGVyaW5nIHRlbXBvcmFyeSB0byBtYWtlIHN1cmUgdGhlIHN0YWNrCi0JCSAqIHJlY2VpdmVz
IGF0IGxlYXN0IG9uZQotCQkgKi8KLQkJd2Z4X2ZpbHRlcl9iZWFjb24od3ZpZiwgZmFsc2UpOwot
CX0KLQl3ZnhfdHhfdW5sb2NrKHd2aWYtPndkZXYpOwotfQotCi1zdGF0aWMgdm9pZCB3Znhfam9p
bl9maW5hbGl6ZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKLQkJCSAgICAgIHN0cnVjdCBpZWVlODAy
MTFfYnNzX2NvbmYgKmluZm8pCi17Ci0Jc3RydWN0IGllZWU4MDIxMV9zdGEgKnN0YSA9IE5VTEw7
Ci0JaW50IGFtcGR1X2RlbnNpdHkgPSAwOwotCWJvb2wgZ3JlZW5maWVsZCA9IGZhbHNlOwotCi0J
cmN1X3JlYWRfbG9jaygpOyAvKiBwcm90ZWN0IHN0YSAqLwotCWlmIChpbmZvLT5ic3NpZCAmJiAh
aW5mby0+aWJzc19qb2luZWQpCi0JCXN0YSA9IGllZWU4MDIxMV9maW5kX3N0YSh3dmlmLT52aWYs
IGluZm8tPmJzc2lkKTsKLQlpZiAoc3RhICYmIHN0YS0+aHRfY2FwLmh0X3N1cHBvcnRlZCkKLQkJ
YW1wZHVfZGVuc2l0eSA9IHN0YS0+aHRfY2FwLmFtcGR1X2RlbnNpdHk7Ci0JaWYgKHN0YSAmJiBz
dGEtPmh0X2NhcC5odF9zdXBwb3J0ZWQgJiYKLQkgICAgIShpbmZvLT5odF9vcGVyYXRpb25fbW9k
ZSAmIElFRUU4MDIxMV9IVF9PUF9NT0RFX05PTl9HRl9TVEFfUFJTTlQpKQotCQlncmVlbmZpZWxk
ID0gISEoc3RhLT5odF9jYXAuY2FwICYgSUVFRTgwMjExX0hUX0NBUF9HUk5fRkxEKTsKLQlyY3Vf
cmVhZF91bmxvY2soKTsKLQotCXd2aWYtPmpvaW5faW5fcHJvZ3Jlc3MgPSBmYWxzZTsKLQloaWZf
c2V0X2Fzc29jaWF0aW9uX21vZGUod3ZpZiwgYW1wZHVfZGVuc2l0eSwgZ3JlZW5maWVsZCwKLQkJ
CQkgaW5mby0+dXNlX3Nob3J0X3ByZWFtYmxlKTsKLQloaWZfa2VlcF9hbGl2ZV9wZXJpb2Qod3Zp
ZiwgMCk7Ci0JLyogYmVhY29uX2xvc3NfY291bnQgaXMgZGVmaW5lZCB0byA3IGluIG5ldC9tYWM4
MDIxMS9tbG1lLmMuIExldCdzIHVzZQotCSAqIHRoZSBzYW1lIHZhbHVlLgotCSAqLwotCWhpZl9z
ZXRfYnNzX3BhcmFtcyh3dmlmLCBpbmZvLT5haWQsIDcpOwotCWhpZl9zZXRfYmVhY29uX3dha2V1
cF9wZXJpb2Qod3ZpZiwgMSwgMSk7Ci0Jd2Z4X3VwZGF0ZV9wbSh3dmlmKTsKLX0KLQotaW50IHdm
eF9qb2luX2lic3Moc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlm
ICp2aWYpCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYt
PmRydl9wcml2OwotCi0Jd2Z4X3VwbG9hZF9hcF90ZW1wbGF0ZXMod3ZpZik7Ci0Jd2Z4X2pvaW4o
d3ZpZik7Ci0JcmV0dXJuIDA7Ci19Ci0KLXZvaWQgd2Z4X2xlYXZlX2lic3Moc3RydWN0IGllZWU4
MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYpCi17Ci0Jc3RydWN0IHdmeF92
aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYtPmRydl9wcml2OwotCi0Jd2Z4X3Jlc2V0
KHd2aWYpOwotfQotCi1zdGF0aWMgdm9pZCB3ZnhfZW5hYmxlX2JlYWNvbihzdHJ1Y3Qgd2Z4X3Zp
ZiAqd3ZpZiwgYm9vbCBlbmFibGUpCi17Ci0JLyogRHJpdmVyIGhhcyBDb250ZW50IEFmdGVyIERU
SU0gQmVhY29uIGluIHF1ZXVlLiBEcml2ZXIgaXMgd2FpdGluZyBmb3IKLQkgKiBhIHNpZ25hbCBm
cm9tIHRoZSBmaXJtd2FyZS4gU2luY2Ugd2UgYXJlIGdvaW5nIHRvIHN0b3AgdG8gc2VuZAotCSAq
IGJlYWNvbnMsIHRoaXMgc2lnbmFsIHdpbGwgbmV2ZXIgaGFwcGVucy4gU2VlIGFsc28KLQkgKiB3
Znhfc3VzcGVuZF9yZXN1bWVfbWMoKQotCSAqLwotCWlmICghZW5hYmxlICYmIHdmeF90eF9xdWV1
ZXNfaGFzX2NhYih3dmlmKSkgewotCQl3dmlmLT5hZnRlcl9kdGltX3R4X2FsbG93ZWQgPSB0cnVl
OwotCQl3ZnhfYmhfcmVxdWVzdF90eCh3dmlmLT53ZGV2KTsKLQl9Ci0JaGlmX2JlYWNvbl90cmFu
c21pdCh3dmlmLCBlbmFibGUpOwotfQotCi12b2lkIHdmeF9ic3NfaW5mb19jaGFuZ2VkKHN0cnVj
dCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLAotCQkJICBzdHJ1
Y3QgaWVlZTgwMjExX2Jzc19jb25mICppbmZvLCB1MzIgY2hhbmdlZCkKLXsKLQlzdHJ1Y3Qgd2Z4
X2RldiAqd2RldiA9IGh3LT5wcml2OwotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3
ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQlpbnQgaTsKLQotCW11dGV4X2xvY2soJndkZXYtPmNv
bmZfbXV0ZXgpOwotCi0JaWYgKGNoYW5nZWQgJiBCU1NfQ0hBTkdFRF9CQVNJQ19SQVRFUyB8fAot
CSAgICBjaGFuZ2VkICYgQlNTX0NIQU5HRURfQkVBQ09OX0lOVCB8fAotCSAgICBjaGFuZ2VkICYg
QlNTX0NIQU5HRURfQlNTSUQpIHsKLQkJaWYgKHZpZi0+dHlwZSA9PSBOTDgwMjExX0lGVFlQRV9T
VEFUSU9OKQotCQkJd2Z4X2pvaW4od3ZpZik7Ci0JfQotCi0JaWYgKGNoYW5nZWQgJiBCU1NfQ0hB
TkdFRF9BU1NPQykgewotCQlpZiAoaW5mby0+YXNzb2MgfHwgaW5mby0+aWJzc19qb2luZWQpCi0J
CQl3Znhfam9pbl9maW5hbGl6ZSh3dmlmLCBpbmZvKTsKLQkJZWxzZSBpZiAoIWluZm8tPmFzc29j
ICYmIHZpZi0+dHlwZSA9PSBOTDgwMjExX0lGVFlQRV9TVEFUSU9OKQotCQkJd2Z4X3Jlc2V0KHd2
aWYpOwotCQllbHNlCi0JCQlkZXZfd2Fybih3ZGV2LT5kZXYsICIlczogbWlzdW5kZXJzdG9vZCBj
aGFuZ2U6IEFTU09DXG4iLAotCQkJCSBfX2Z1bmNfXyk7Ci0JfQotCi0JaWYgKGNoYW5nZWQgJiBC
U1NfQ0hBTkdFRF9CRUFDT05fSU5GTykgewotCQlpZiAodmlmLT50eXBlICE9IE5MODAyMTFfSUZU
WVBFX1NUQVRJT04pCi0JCQlkZXZfd2Fybih3ZGV2LT5kZXYsICIlczogbWlzdW5kZXJzdG9vZCBj
aGFuZ2U6IEJFQUNPTl9JTkZPXG4iLAotCQkJCSBfX2Z1bmNfXyk7Ci0JCWhpZl9zZXRfYmVhY29u
X3dha2V1cF9wZXJpb2Qod3ZpZiwgaW5mby0+ZHRpbV9wZXJpb2QsCi0JCQkJCSAgICAgaW5mby0+
ZHRpbV9wZXJpb2QpOwotCQkvKiBXZSB0ZW1wb3JhcnkgZm9yd2FyZGVkIGJlYWNvbiBmb3Igam9p
biBwcm9jZXNzLiBJdCBpcyBub3cgbm8KLQkJICogbW9yZSBuZWNlc3NhcnkuCi0JCSAqLwotCQl3
ZnhfZmlsdGVyX2JlYWNvbih3dmlmLCB0cnVlKTsKLQl9Ci0KLQlpZiAoY2hhbmdlZCAmIEJTU19D
SEFOR0VEX0FSUF9GSUxURVIpIHsKLQkJZm9yIChpID0gMDsgaSA8IEhJRl9NQVhfQVJQX0lQX0FE
RFJUQUJMRV9FTlRSSUVTOyBpKyspIHsKLQkJCV9fYmUzMiAqYXJwX2FkZHIgPSAmaW5mby0+YXJw
X2FkZHJfbGlzdFtpXTsKLQotCQkJaWYgKGluZm8tPmFycF9hZGRyX2NudCA+IEhJRl9NQVhfQVJQ
X0lQX0FERFJUQUJMRV9FTlRSSUVTKQotCQkJCWFycF9hZGRyID0gTlVMTDsKLQkJCWlmIChpID49
IGluZm8tPmFycF9hZGRyX2NudCkKLQkJCQlhcnBfYWRkciA9IE5VTEw7Ci0JCQloaWZfc2V0X2Fy
cF9pcHY0X2ZpbHRlcih3dmlmLCBpLCBhcnBfYWRkcik7Ci0JCX0KLQl9Ci0KLQlpZiAoY2hhbmdl
ZCAmIEJTU19DSEFOR0VEX0FQX1BST0JFX1JFU1AgfHwKLQkgICAgY2hhbmdlZCAmIEJTU19DSEFO
R0VEX0JFQUNPTikKLQkJd2Z4X3VwbG9hZF9hcF90ZW1wbGF0ZXMod3ZpZik7Ci0KLQlpZiAoY2hh
bmdlZCAmIEJTU19DSEFOR0VEX0JFQUNPTl9FTkFCTEVEKQotCQl3ZnhfZW5hYmxlX2JlYWNvbih3
dmlmLCBpbmZvLT5lbmFibGVfYmVhY29uKTsKLQotCWlmIChjaGFuZ2VkICYgQlNTX0NIQU5HRURf
S0VFUF9BTElWRSkKLQkJaGlmX2tlZXBfYWxpdmVfcGVyaW9kKHd2aWYsIGluZm8tPm1heF9pZGxl
X3BlcmlvZCAqCi0JCQkJCSAgICBVU0VDX1BFUl9UVSAvIFVTRUNfUEVSX01TRUMpOwotCi0JaWYg
KGNoYW5nZWQgJiBCU1NfQ0hBTkdFRF9FUlBfQ1RTX1BST1QpCi0JCWhpZl9lcnBfdXNlX3Byb3Rl
Y3Rpb24od3ZpZiwgaW5mby0+dXNlX2N0c19wcm90KTsKLQotCWlmIChjaGFuZ2VkICYgQlNTX0NI
QU5HRURfRVJQX1NMT1QpCi0JCWhpZl9zbG90X3RpbWUod3ZpZiwgaW5mby0+dXNlX3Nob3J0X3Ns
b3QgPyA5IDogMjApOwotCi0JaWYgKGNoYW5nZWQgJiBCU1NfQ0hBTkdFRF9DUU0pCi0JCWhpZl9z
ZXRfcmNwaV9yc3NpX3RocmVzaG9sZCh3dmlmLCBpbmZvLT5jcW1fcnNzaV90aG9sZCwKLQkJCQkJ
ICAgIGluZm8tPmNxbV9yc3NpX2h5c3QpOwotCi0JaWYgKGNoYW5nZWQgJiBCU1NfQ0hBTkdFRF9U
WFBPV0VSKQotCQloaWZfc2V0X291dHB1dF9wb3dlcih3dmlmLCBpbmZvLT50eHBvd2VyKTsKLQot
CWlmIChjaGFuZ2VkICYgQlNTX0NIQU5HRURfUFMpCi0JCXdmeF91cGRhdGVfcG0od3ZpZik7Ci0K
LQltdXRleF91bmxvY2soJndkZXYtPmNvbmZfbXV0ZXgpOwotfQotCi1zdGF0aWMgaW50IHdmeF91
cGRhdGVfdGltKHN0cnVjdCB3ZnhfdmlmICp3dmlmKQotewotCXN0cnVjdCBza19idWZmICpza2I7
Ci0JdTE2IHRpbV9vZmZzZXQsIHRpbV9sZW5ndGg7Ci0JdTggKnRpbV9wdHI7Ci0KLQlza2IgPSBp
ZWVlODAyMTFfYmVhY29uX2dldF90aW0od3ZpZi0+d2Rldi0+aHcsIHd2aWYtPnZpZiwKLQkJCQkg
ICAgICAgJnRpbV9vZmZzZXQsICZ0aW1fbGVuZ3RoKTsKLQlpZiAoIXNrYikKLQkJcmV0dXJuIC1F
Tk9FTlQ7Ci0JdGltX3B0ciA9IHNrYi0+ZGF0YSArIHRpbV9vZmZzZXQ7Ci0KLQlpZiAodGltX29m
ZnNldCAmJiB0aW1fbGVuZ3RoID49IDYpIHsKLQkJLyogRmlybXdhcmUgaGFuZGxlcyBEVElNIGNv
dW50ZXIgaW50ZXJuYWxseSAqLwotCQl0aW1fcHRyWzJdID0gMDsKLQotCQkvKiBTZXQvcmVzZXQg
YWlkMCBiaXQgKi8KLQkJaWYgKHdmeF90eF9xdWV1ZXNfaGFzX2NhYih3dmlmKSkKLQkJCXRpbV9w
dHJbNF0gfD0gMTsKLQkJZWxzZQotCQkJdGltX3B0cls0XSAmPSB+MTsKLQl9Ci0KLQloaWZfdXBk
YXRlX2llX2JlYWNvbih3dmlmLCB0aW1fcHRyLCB0aW1fbGVuZ3RoKTsKLQlkZXZfa2ZyZWVfc2ti
KHNrYik7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZvaWQgd2Z4X3VwZGF0ZV90aW1fd29y
ayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSBj
b250YWluZXJfb2Yod29yaywgc3RydWN0IHdmeF92aWYsIHVwZGF0ZV90aW1fd29yayk7Ci0KLQl3
ZnhfdXBkYXRlX3RpbSh3dmlmKTsKLX0KLQotaW50IHdmeF9zZXRfdGltKHN0cnVjdCBpZWVlODAy
MTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3N0YSAqc3RhLCBib29sIHNldCkKLXsKLQlzdHJ1
Y3Qgd2Z4X2RldiAqd2RldiA9IGh3LT5wcml2OwotCXN0cnVjdCB3Znhfc3RhX3ByaXYgKnN0YV9k
ZXYgPSAoc3RydWN0IHdmeF9zdGFfcHJpdiAqKSZzdGEtPmRydl9wcml2OwotCXN0cnVjdCB3Znhf
dmlmICp3dmlmID0gd2Rldl90b193dmlmKHdkZXYsIHN0YV9kZXYtPnZpZl9pZCk7Ci0KLQlpZiAo
IXd2aWYpIHsKLQkJZGV2X3dhcm4od2Rldi0+ZGV2LCAiJXM6IHJlY2VpdmVkIGV2ZW50IGZvciBu
b24tZXhpc3RlbnQgdmlmXG4iLCBfX2Z1bmNfXyk7Ci0JCXJldHVybiAtRUlPOwotCX0KLQlzY2hl
ZHVsZV93b3JrKCZ3dmlmLT51cGRhdGVfdGltX3dvcmspOwotCXJldHVybiAwOwotfQotCi12b2lk
IHdmeF9zdXNwZW5kX3Jlc3VtZV9tYyhzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgZW51bSBzdGFfbm90
aWZ5X2NtZCBub3RpZnlfY21kKQotewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmX2l0OwotCi0JaWYg
KG5vdGlmeV9jbWQgIT0gU1RBX05PVElGWV9BV0FLRSkKLQkJcmV0dXJuOwotCi0JLyogRGV2aWNl
IHdvbid0IGJlIGFibGUgdG8gaG9ub3IgQ0FCIGlmIGEgc2NhbiBpcyBpbiBwcm9ncmVzcyBvbiBh
bnkKLQkgKiBpbnRlcmZhY2UuIFByZWZlciB0byBza2lwIHRoaXMgRFRJTSBhbmQgd2FpdCBmb3Ig
dGhlIG5leHQgb25lLgotCSAqLwotCXd2aWZfaXQgPSBOVUxMOwotCXdoaWxlICgod3ZpZl9pdCA9
IHd2aWZfaXRlcmF0ZSh3dmlmLT53ZGV2LCB3dmlmX2l0KSkgIT0gTlVMTCkKLQkJaWYgKG11dGV4
X2lzX2xvY2tlZCgmd3ZpZl9pdC0+c2Nhbl9sb2NrKSkKLQkJCXJldHVybjsKLQotCWlmICghd2Z4
X3R4X3F1ZXVlc19oYXNfY2FiKHd2aWYpIHx8IHd2aWYtPmFmdGVyX2R0aW1fdHhfYWxsb3dlZCkK
LQkJZGV2X3dhcm4od3ZpZi0+d2Rldi0+ZGV2LCAiaW5jb3JyZWN0IHNlcXVlbmNlICglZCBDQUIg
aW4gcXVldWUpIiwKLQkJCSB3ZnhfdHhfcXVldWVzX2hhc19jYWIod3ZpZikpOwotCXd2aWYtPmFm
dGVyX2R0aW1fdHhfYWxsb3dlZCA9IHRydWU7Ci0Jd2Z4X2JoX3JlcXVlc3RfdHgod3ZpZi0+d2Rl
dik7Ci19Ci0KLWludCB3ZnhfYW1wZHVfYWN0aW9uKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LAot
CQkgICAgIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsCi0JCSAgICAgc3RydWN0IGllZWU4MDIx
MV9hbXBkdV9wYXJhbXMgKnBhcmFtcykKLXsKLQkvKiBBZ2dyZWdhdGlvbiBpcyBpbXBsZW1lbnRl
ZCBmdWxseSBpbiBmaXJtd2FyZSAqLwotCXN3aXRjaCAocGFyYW1zLT5hY3Rpb24pIHsKLQljYXNl
IElFRUU4MDIxMV9BTVBEVV9SWF9TVEFSVDoKLQljYXNlIElFRUU4MDIxMV9BTVBEVV9SWF9TVE9Q
OgotCQkvKiBKdXN0IGFja25vd2xlZGdlIGl0IHRvIGVuYWJsZSBmcmFtZSByZS1vcmRlcmluZyAq
LwotCQlyZXR1cm4gMDsKLQlkZWZhdWx0OgotCQkvKiBMZWF2ZSB0aGUgZmlybXdhcmUgZG9pbmcg
aXRzIGJ1c2luZXNzIGZvciB0eCBhZ2dyZWdhdGlvbiAqLwotCQlyZXR1cm4gLUVPUE5PVFNVUFA7
Ci0JfQotfQotCi1pbnQgd2Z4X2FkZF9jaGFuY3R4KHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LAot
CQkgICAgc3RydWN0IGllZWU4MDIxMV9jaGFuY3R4X2NvbmYgKmNvbmYpCi17Ci0JcmV0dXJuIDA7
Ci19Ci0KLXZvaWQgd2Z4X3JlbW92ZV9jaGFuY3R4KHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LAot
CQkJc3RydWN0IGllZWU4MDIxMV9jaGFuY3R4X2NvbmYgKmNvbmYpCi17Ci19Ci0KLXZvaWQgd2Z4
X2NoYW5nZV9jaGFuY3R4KHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LAotCQkJc3RydWN0IGllZWU4
MDIxMV9jaGFuY3R4X2NvbmYgKmNvbmYsCi0JCQl1MzIgY2hhbmdlZCkKLXsKLX0KLQotaW50IHdm
eF9hc3NpZ25fdmlmX2NoYW5jdHgoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVl
ODAyMTFfdmlmICp2aWYsCi0JCQkgICBzdHJ1Y3QgaWVlZTgwMjExX2NoYW5jdHhfY29uZiAqY29u
ZikKLXsKLQlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiA9IChzdHJ1Y3Qgd2Z4X3ZpZiAqKXZpZi0+ZHJ2
X3ByaXY7Ci0Jc3RydWN0IGllZWU4MDIxMV9jaGFubmVsICpjaCA9IGNvbmYtPmRlZi5jaGFuOwot
Ci0JV0FSTih3dmlmLT5jaGFubmVsLCAiY2hhbm5lbCBvdmVyd3JpdGUiKTsKLQl3dmlmLT5jaGFu
bmVsID0gY2g7Ci0KLQlyZXR1cm4gMDsKLX0KLQotdm9pZCB3ZnhfdW5hc3NpZ25fdmlmX2NoYW5j
dHgoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsCi0JCQkgICAgICBzdHJ1Y3QgaWVlZTgwMjExX3Zp
ZiAqdmlmLAotCQkJICAgICAgc3RydWN0IGllZWU4MDIxMV9jaGFuY3R4X2NvbmYgKmNvbmYpCi17
Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYtPmRydl9wcml2
OwotCXN0cnVjdCBpZWVlODAyMTFfY2hhbm5lbCAqY2ggPSBjb25mLT5kZWYuY2hhbjsKLQotCVdB
Uk4od3ZpZi0+Y2hhbm5lbCAhPSBjaCwgImNoYW5uZWwgbWlzbWF0Y2giKTsKLQl3dmlmLT5jaGFu
bmVsID0gTlVMTDsKLX0KLQotaW50IHdmeF9jb25maWcoc3RydWN0IGllZWU4MDIxMV9odyAqaHcs
IHUzMiBjaGFuZ2VkKQotewotCXJldHVybiAwOwotfQotCi1pbnQgd2Z4X2FkZF9pbnRlcmZhY2Uo
c3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYpCi17Ci0J
aW50IGksIHJldCA9IDA7Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYgPSBody0+cHJpdjsKLQlzdHJ1
Y3Qgd2Z4X3ZpZiAqd3ZpZiA9IChzdHJ1Y3Qgd2Z4X3ZpZiAqKXZpZi0+ZHJ2X3ByaXY7Ci0KLQl2
aWYtPmRyaXZlcl9mbGFncyB8PSBJRUVFODAyMTFfVklGX0JFQUNPTl9GSUxURVIgfAotCQkJICAg
ICBJRUVFODAyMTFfVklGX1NVUFBPUlRTX1VBUFNEIHwKLQkJCSAgICAgSUVFRTgwMjExX1ZJRl9T
VVBQT1JUU19DUU1fUlNTSTsKLQotCW11dGV4X2xvY2soJndkZXYtPmNvbmZfbXV0ZXgpOwotCi0J
c3dpdGNoICh2aWYtPnR5cGUpIHsKLQljYXNlIE5MODAyMTFfSUZUWVBFX1NUQVRJT046Ci0JY2Fz
ZSBOTDgwMjExX0lGVFlQRV9BREhPQzoKLQljYXNlIE5MODAyMTFfSUZUWVBFX0FQOgotCQlicmVh
azsKLQlkZWZhdWx0OgotCQltdXRleF91bmxvY2soJndkZXYtPmNvbmZfbXV0ZXgpOwotCQlyZXR1
cm4gLUVPUE5PVFNVUFA7Ci0JfQotCi0JLyogRklYTUU6IHByZWZlciB1c2Ugb2YgY29udGFpbmVy
X29mKCkgdG8gZ2V0IHZpZiAqLwotCXd2aWYtPnZpZiA9IHZpZjsKLQl3dmlmLT53ZGV2ID0gd2Rl
djsKLQotCXd2aWYtPmxpbmtfaWRfbWFwID0gMTsgLyogbGluay1pZCAwIGlzIHJlc2VydmVkIGZv
ciBtdWx0aWNhc3QgKi8KLQlJTklUX1dPUksoJnd2aWYtPnVwZGF0ZV90aW1fd29yaywgd2Z4X3Vw
ZGF0ZV90aW1fd29yayk7Ci0JSU5JVF9ERUxBWUVEX1dPUksoJnd2aWYtPmJlYWNvbl9sb3NzX3dv
cmssIHdmeF9iZWFjb25fbG9zc193b3JrKTsKLQotCWluaXRfY29tcGxldGlvbigmd3ZpZi0+c2V0
X3BtX21vZGVfY29tcGxldGUpOwotCWNvbXBsZXRlKCZ3dmlmLT5zZXRfcG1fbW9kZV9jb21wbGV0
ZSk7Ci0JSU5JVF9XT1JLKCZ3dmlmLT50eF9wb2xpY3lfdXBsb2FkX3dvcmssIHdmeF90eF9wb2xp
Y3lfdXBsb2FkX3dvcmspOwotCi0JbXV0ZXhfaW5pdCgmd3ZpZi0+c2Nhbl9sb2NrKTsKLQlpbml0
X2NvbXBsZXRpb24oJnd2aWYtPnNjYW5fY29tcGxldGUpOwotCUlOSVRfV09SSygmd3ZpZi0+c2Nh
bl93b3JrLCB3ZnhfaHdfc2Nhbl93b3JrKTsKLQotCXdmeF90eF9xdWV1ZXNfaW5pdCh3dmlmKTsK
LQl3ZnhfdHhfcG9saWN5X2luaXQod3ZpZik7Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0la
RSh3ZGV2LT52aWYpOyBpKyspIHsKLQkJaWYgKCF3ZGV2LT52aWZbaV0pIHsKLQkJCXdkZXYtPnZp
ZltpXSA9IHZpZjsKLQkJCXd2aWYtPmlkID0gaTsKLQkJCWJyZWFrOwotCQl9Ci0JfQotCVdBUk4o
aSA9PSBBUlJBWV9TSVpFKHdkZXYtPnZpZiksICJ0cnkgdG8gaW5zdGFudGlhdGUgbW9yZSB2aWYg
dGhhbiBzdXBwb3J0ZWQiKTsKLQotCWhpZl9zZXRfbWFjYWRkcih3dmlmLCB2aWYtPmFkZHIpOwot
Ci0JbXV0ZXhfdW5sb2NrKCZ3ZGV2LT5jb25mX211dGV4KTsKLQotCXd2aWYgPSBOVUxMOwotCXdo
aWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgewotCQkvKiBD
b21ibyBtb2RlIGRvZXMgbm90IHN1cHBvcnQgQmxvY2sgQWNrcy4gV2UgY2FuIHJlLWVuYWJsZSB0
aGVtICovCi0JCWlmICh3dmlmX2NvdW50KHdkZXYpID09IDEpCi0JCQloaWZfc2V0X2Jsb2NrX2Fj
a19wb2xpY3kod3ZpZiwgMHhGRiwgMHhGRik7Ci0JCWVsc2UKLQkJCWhpZl9zZXRfYmxvY2tfYWNr
X3BvbGljeSh3dmlmLCAweDAwLCAweDAwKTsKLQl9Ci0JcmV0dXJuIHJldDsKLX0KLQotdm9pZCB3
ZnhfcmVtb3ZlX2ludGVyZmFjZShzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4
MDIxMV92aWYgKnZpZikKLXsKLQlzdHJ1Y3Qgd2Z4X2RldiAqd2RldiA9IGh3LT5wcml2OwotCXN0
cnVjdCB3ZnhfdmlmICp3dmlmID0gKHN0cnVjdCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdjsKLQot
CXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmd3ZpZi0+c2V0X3BtX21vZGVfY29tcGxldGUs
IG1zZWNzX3RvX2ppZmZpZXMoMzAwKSk7Ci0Jd2Z4X3R4X3F1ZXVlc19jaGVja19lbXB0eSh3dmlm
KTsKLQotCW11dGV4X2xvY2soJndkZXYtPmNvbmZfbXV0ZXgpOwotCVdBUk4od3ZpZi0+bGlua19p
ZF9tYXAgIT0gMSwgImNvcnJ1cHRlZCBzdGF0ZSIpOwotCi0JaGlmX3Jlc2V0KHd2aWYsIGZhbHNl
KTsKLQloaWZfc2V0X21hY2FkZHIod3ZpZiwgTlVMTCk7Ci0Jd2Z4X3R4X3BvbGljeV9pbml0KHd2
aWYpOwotCi0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZ3dmlmLT5iZWFjb25fbG9zc193b3Jr
KTsKLQl3ZGV2LT52aWZbd3ZpZi0+aWRdID0gTlVMTDsKLQl3dmlmLT52aWYgPSBOVUxMOwotCi0J
bXV0ZXhfdW5sb2NrKCZ3ZGV2LT5jb25mX211dGV4KTsKLQotCXd2aWYgPSBOVUxMOwotCXdoaWxl
ICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgewotCQkvKiBDb21i
byBtb2RlIGRvZXMgbm90IHN1cHBvcnQgQmxvY2sgQWNrcy4gV2UgY2FuIHJlLWVuYWJsZSB0aGVt
ICovCi0JCWlmICh3dmlmX2NvdW50KHdkZXYpID09IDEpCi0JCQloaWZfc2V0X2Jsb2NrX2Fja19w
b2xpY3kod3ZpZiwgMHhGRiwgMHhGRik7Ci0JCWVsc2UKLQkJCWhpZl9zZXRfYmxvY2tfYWNrX3Bv
bGljeSh3dmlmLCAweDAwLCAweDAwKTsKLQl9Ci19Ci0KLWludCB3Znhfc3RhcnQoc3RydWN0IGll
ZWU4MDIxMV9odyAqaHcpCi17Ci0JcmV0dXJuIDA7Ci19Ci0KLXZvaWQgd2Z4X3N0b3Aoc3RydWN0
IGllZWU4MDIxMV9odyAqaHcpCi17Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYgPSBody0+cHJpdjsK
LQotCVdBUk5fT04oIXNrYl9xdWV1ZV9lbXB0eV9sb2NrbGVzcygmd2Rldi0+dHhfcGVuZGluZykp
OwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuaCBiL2RyaXZlcnMvc3Rh
Z2luZy93Zngvc3RhLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDRkN2UzOGJlNDIz
NS4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmgKKysrIC9kZXYv
bnVsbApAQCAtMSw3MyArMCwwIEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5ICovCi0vKgotICogSW1wbGVtZW50YXRpb24gb2YgbWFjODAyMTEgQVBJLgotICoKLSAq
IENvcHlyaWdodCAoYykgMjAxNy0yMDIwLCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICog
Q29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3NvbgotICovCi0jaWZuZGVmIFdGWF9TVEFfSAot
I2RlZmluZSBXRlhfU1RBX0gKLQotI2luY2x1ZGUgPG5ldC9tYWM4MDIxMS5oPgotCi1zdHJ1Y3Qg
d2Z4X2RldjsKLXN0cnVjdCB3ZnhfdmlmOwotCi1zdHJ1Y3Qgd2Z4X3N0YV9wcml2IHsKLQlpbnQg
bGlua19pZDsKLQlpbnQgdmlmX2lkOwotfTsKLQotLyogbWFjODAyMTEgaW50ZXJmYWNlICovCi1p
bnQgd2Z4X3N0YXJ0KHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3KTsKLXZvaWQgd2Z4X3N0b3Aoc3Ry
dWN0IGllZWU4MDIxMV9odyAqaHcpOwotaW50IHdmeF9jb25maWcoc3RydWN0IGllZWU4MDIxMV9o
dyAqaHcsIHUzMiBjaGFuZ2VkKTsKLWludCB3Znhfc2V0X3J0c190aHJlc2hvbGQoc3RydWN0IGll
ZWU4MDIxMV9odyAqaHcsIHUzMiB2YWx1ZSk7Ci12b2lkIHdmeF9zZXRfZGVmYXVsdF91bmljYXN0
X2tleShzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywKLQkJCQkgc3RydWN0IGllZWU4MDIxMV92aWYg
KnZpZiwgaW50IGlkeCk7Ci12b2lkIHdmeF9jb25maWd1cmVfZmlsdGVyKHN0cnVjdCBpZWVlODAy
MTFfaHcgKmh3LCB1bnNpZ25lZCBpbnQgY2hhbmdlZF9mbGFncywKLQkJCSAgdW5zaWduZWQgaW50
ICp0b3RhbF9mbGFncywgdTY0IHVudXNlZCk7Ci0KLWludCB3ZnhfYWRkX2ludGVyZmFjZShzdHJ1
Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZik7Ci12b2lkIHdm
eF9yZW1vdmVfaW50ZXJmYWNlKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgw
MjExX3ZpZiAqdmlmKTsKLWludCB3Znhfc3RhcnRfYXAoc3RydWN0IGllZWU4MDIxMV9odyAqaHcs
IHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYpOwotdm9pZCB3Znhfc3RvcF9hcChzdHJ1Y3QgaWVl
ZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZik7Ci1pbnQgd2Z4X2pvaW5f
aWJzcyhzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZik7
Ci12b2lkIHdmeF9sZWF2ZV9pYnNzKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVl
ZTgwMjExX3ZpZiAqdmlmKTsKLWludCB3ZnhfY29uZl90eChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpo
dywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKLQkJdTE2IHF1ZXVlLCBjb25zdCBzdHJ1Y3Qg
aWVlZTgwMjExX3R4X3F1ZXVlX3BhcmFtcyAqcGFyYW1zKTsKLXZvaWQgd2Z4X2Jzc19pbmZvX2No
YW5nZWQoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYs
Ci0JCQkgIHN0cnVjdCBpZWVlODAyMTFfYnNzX2NvbmYgKmluZm8sIHUzMiBjaGFuZ2VkKTsKLWlu
dCB3Znhfc3RhX2FkZChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92
aWYgKnZpZiwKLQkJc3RydWN0IGllZWU4MDIxMV9zdGEgKnN0YSk7Ci1pbnQgd2Z4X3N0YV9yZW1v
dmUoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsCi0J
CSAgIHN0cnVjdCBpZWVlODAyMTFfc3RhICpzdGEpOwotdm9pZCB3Znhfc3RhX25vdGlmeShzdHJ1
Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKLQkJICAgIGVu
dW0gc3RhX25vdGlmeV9jbWQgY21kLCBzdHJ1Y3QgaWVlZTgwMjExX3N0YSAqc3RhKTsKLWludCB3
Znhfc2V0X3RpbShzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV9zdGEg
KnN0YSwgYm9vbCBzZXQpOwotaW50IHdmeF9hbXBkdV9hY3Rpb24oc3RydWN0IGllZWU4MDIxMV9o
dyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsCi0JCSAgICAgc3RydWN0IGllZWU4MDIx
MV9hbXBkdV9wYXJhbXMgKnBhcmFtcyk7Ci1pbnQgd2Z4X2FkZF9jaGFuY3R4KHN0cnVjdCBpZWVl
ODAyMTFfaHcgKmh3LAotCQkgICAgc3RydWN0IGllZWU4MDIxMV9jaGFuY3R4X2NvbmYgKmNvbmYp
Owotdm9pZCB3ZnhfcmVtb3ZlX2NoYW5jdHgoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsCi0JCQlz
dHJ1Y3QgaWVlZTgwMjExX2NoYW5jdHhfY29uZiAqY29uZik7Ci12b2lkIHdmeF9jaGFuZ2VfY2hh
bmN0eChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywKLQkJCXN0cnVjdCBpZWVlODAyMTFfY2hhbmN0
eF9jb25mICpjb25mLCB1MzIgY2hhbmdlZCk7Ci1pbnQgd2Z4X2Fzc2lnbl92aWZfY2hhbmN0eChz
dHJ1Y3QgaWVlZTgwMjExX2h3ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKLQkJCSAg
IHN0cnVjdCBpZWVlODAyMTFfY2hhbmN0eF9jb25mICpjb25mKTsKLXZvaWQgd2Z4X3VuYXNzaWdu
X3ZpZl9jaGFuY3R4KHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LAotCQkJICAgICAgc3RydWN0IGll
ZWU4MDIxMV92aWYgKnZpZiwKLQkJCSAgICAgIHN0cnVjdCBpZWVlODAyMTFfY2hhbmN0eF9jb25m
ICpjb25mKTsKLQotLyogSGFyZHdhcmUgQVBJIENhbGxiYWNrcyAqLwotdm9pZCB3ZnhfY29vbGlu
Z190aW1lb3V0X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKTsKLXZvaWQgd2Z4X3N1c3Bl
bmRfaG90X2RldihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgZW51bSBzdGFfbm90aWZ5X2NtZCBjbWQp
Owotdm9pZCB3Znhfc3VzcGVuZF9yZXN1bWVfbWMoc3RydWN0IHdmeF92aWYgKnd2aWYsIGVudW0g
c3RhX25vdGlmeV9jbWQgY21kKTsKLXZvaWQgd2Z4X2V2ZW50X3JlcG9ydF9yc3NpKHN0cnVjdCB3
ZnhfdmlmICp3dmlmLCB1OCByYXdfcmNwaV9yc3NpKTsKLWludCB3ZnhfdXBkYXRlX3BtKHN0cnVj
dCB3ZnhfdmlmICp3dmlmKTsKLQotLyogT3RoZXIgSGVscGVycyAqLwotdm9pZCB3ZnhfcmVzZXQo
c3RydWN0IHdmeF92aWYgKnd2aWYpOwotdTMyIHdmeF9yYXRlX21hc2tfdG9faHcoc3RydWN0IHdm
eF9kZXYgKndkZXYsIHUzMiByYXRlcyk7Ci0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9z
dGFnaW5nL3dmeC90cmFjZXMuaCBiL2RyaXZlcnMvc3RhZ2luZy93ZngvdHJhY2VzLmgKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGU5MGRjNzNjNGIwMS4uMDAwMDAwMDAwMDAwCi0tLSBh
L2RyaXZlcnMvc3RhZ2luZy93ZngvdHJhY2VzLmgKKysrIC9kZXYvbnVsbApAQCAtMSw1MDEgKzAs
MCBAQAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwotLyoKLSAq
IFRyYWNlcG9pbnRzIGRlZmluaXRpb25zLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxOC0yMDIw
LCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICovCi0KLSN1bmRlZiBUUkFDRV9TWVNURU0K
LSNkZWZpbmUgVFJBQ0VfU1lTVEVNIHdmeAotCi0jaWYgIWRlZmluZWQoX1dGWF9UUkFDRV9IKSB8
fCBkZWZpbmVkKFRSQUNFX0hFQURFUl9NVUxUSV9SRUFEKQotI2RlZmluZSBfV0ZYX1RSQUNFX0gK
LQotI2luY2x1ZGUgPGxpbnV4L3RyYWNlcG9pbnQuaD4KLSNpbmNsdWRlIDxuZXQvbWFjODAyMTEu
aD4KLQotI2luY2x1ZGUgImJ1cy5oIgotI2luY2x1ZGUgImhpZl9hcGlfY21kLmgiCi0jaW5jbHVk
ZSAiaGlmX2FwaV9taWIuaCIKLQotLyogVGhlIGhlbGwgYmVsb3cgbmVlZCBzb21lIGV4cGxhbmF0
aW9ucy4gRm9yIGVhY2ggc3ltYm9saWMgbnVtYmVyLCB3ZSBuZWVkIHRvCi0gKiBkZWZpbmUgaXQg
d2l0aCBUUkFDRV9ERUZJTkVfRU5VTSgpIGFuZCBpbiBhIGxpc3QgZm9yIF9fcHJpbnRfc3ltYm9s
aWMuCi0gKgotICogICAxLiBEZWZpbmUgYSBuZXcgbWFjcm8gdGhhdCBjYWxsIFRSQUNFX0RFRklO
RV9FTlVNKCk6Ci0gKgotICogICAgICAgICAgI2RlZmluZSB4eHhfbmFtZShzeW0pIFRSQUNFX0RF
RklORV9FTlVNKHN5bSk7Ci0gKgotICogICAyLiBEZWZpbmUgbGlzdCBvZiBhbGwgc3ltYm9sczoK
LSAqCi0gKiAgICAgICAgICAjZGVmaW5lIGxpc3RfbmFtZXMgICAgIFwKLSAqICAgICAgICAgICAg
IC4uLiAgICAgICAgICAgICAgICAgXAotICogICAgICAgICAgICAgeHh4X25hbWUoWFhYKSAgICAg
ICBcCi0gKiAgICAgICAgICAgICAuLi4KLSAqCi0gKiAgIDMuIEluc3RhbnRpYXRlIHRoYXQgbGlz
dF9uYW1lczoKLSAqCi0gKiAgICAgICAgICBsaXN0X25hbWVzCi0gKgotICogICA0LiBSZWRlZmlu
ZSB4eHhfbmFtZSgpIGFzIGFuIGVudHJ5IG9mIGFycmF5IGZvciBfX3ByaW50X3N5bWJvbGljKCkK
LSAqCi0gKiAgICAgICAgICAjdW5kZWYgeHh4X25hbWUKLSAqICAgICAgICAgICNkZWZpbmUgeHh4
X25hbWUobXNnKSB7IG1zZywgI21zZyB9LAotICoKLSAqICAgNS4gbGlzdF9uYW1lIGNhbiBub3cg
bmVhcmx5IGJlIHVzZWQgd2l0aCBfX3ByaW50X3N5bWJvbGljKCkgYnV0LAotICogICAgICBfX3By
aW50X3N5bWJvbGljKCkgZGlzbGlrZSBsYXN0IGNvbW1hIG9mIGxpc3QuIFNvIHdlIGRlZmluZSBh
IG5ldyBsaXN0Ci0gKiAgICAgIHdpdGggYSBkdW1teSBlbGVtZW50OgotICoKLSAqICAgICAgICAg
ICNkZWZpbmUgbGlzdF9mb3JfcHJpbnRfc3ltYm9saWMgbGlzdF9uYW1lcyB7IC0xLCBOVUxMIH0K
LSAqLwotCi0jZGVmaW5lIF9oaWZfbXNnX2xpc3QgICAgICAgICAgICAgICAgICAgICAgIFwKLQlo
aWZfY25mX25hbWUoQUREX0tFWSkgICAgICAgICAgICAgICBcCi0JaGlmX2NuZl9uYW1lKEJFQUNP
Tl9UUkFOU01JVCkgICAgICAgXAotCWhpZl9jbmZfbmFtZShFRENBX1FVRVVFX1BBUkFNUykgICAg
IFwKLQloaWZfY25mX25hbWUoSk9JTikgICAgICAgICAgICAgICAgICBcCi0JaGlmX2NuZl9uYW1l
KE1BUF9MSU5LKSAgICAgICAgICAgICAgXAotCWhpZl9jbmZfbmFtZShSRUFEX01JQikgICAgICAg
ICAgICAgIFwKLQloaWZfY25mX25hbWUoUkVNT1ZFX0tFWSkgICAgICAgICAgICBcCi0JaGlmX2Nu
Zl9uYW1lKFJFU0VUKSAgICAgICAgICAgICAgICAgXAotCWhpZl9jbmZfbmFtZShTRVRfQlNTX1BB
UkFNUykgICAgICAgIFwKLQloaWZfY25mX25hbWUoU0VUX1BNX01PREUpICAgICAgICAgICBcCi0J
aGlmX2NuZl9uYW1lKFNUQVJUKSAgICAgICAgICAgICAgICAgXAotCWhpZl9jbmZfbmFtZShTVEFS
VF9TQ0FOKSAgICAgICAgICAgIFwKLQloaWZfY25mX25hbWUoU1RPUF9TQ0FOKSAgICAgICAgICAg
ICBcCi0JaGlmX2NuZl9uYW1lKFRYKSAgICAgICAgICAgICAgICAgICAgXAotCWhpZl9jbmZfbmFt
ZShNVUxUSV9UUkFOU01JVCkgICAgICAgIFwKLQloaWZfY25mX25hbWUoVVBEQVRFX0lFKSAgICAg
ICAgICAgICBcCi0JaGlmX2NuZl9uYW1lKFdSSVRFX01JQikgICAgICAgICAgICAgXAotCWhpZl9j
bmZfbmFtZShDT05GSUdVUkFUSU9OKSAgICAgICAgIFwKLQloaWZfY25mX25hbWUoQ09OVFJPTF9H
UElPKSAgICAgICAgICBcCi0JaGlmX2NuZl9uYW1lKFBSRVZFTlRfUk9MTEJBQ0spICAgICAgXAot
CWhpZl9jbmZfbmFtZShTRVRfU0xfTUFDX0tFWSkgICAgICAgIFwKLQloaWZfY25mX25hbWUoU0xf
Q09ORklHVVJFKSAgICAgICAgICBcCi0JaGlmX2NuZl9uYW1lKFNMX0VYQ0hBTkdFX1BVQl9LRVlT
KSAgXAotCWhpZl9jbmZfbmFtZShTSFVUX0RPV04pICAgICAgICAgICAgIFwKLQloaWZfaW5kX25h
bWUoRVZFTlQpICAgICAgICAgICAgICAgICBcCi0JaGlmX2luZF9uYW1lKEpPSU5fQ09NUExFVEUp
ICAgICAgICAgXAotCWhpZl9pbmRfbmFtZShSWCkgICAgICAgICAgICAgICAgICAgIFwKLQloaWZf
aW5kX25hbWUoU0NBTl9DTVBMKSAgICAgICAgICAgICBcCi0JaGlmX2luZF9uYW1lKFNFVF9QTV9N
T0RFX0NNUEwpICAgICAgXAotCWhpZl9pbmRfbmFtZShTVVNQRU5EX1JFU1VNRV9UWCkgICAgIFwK
LQloaWZfaW5kX25hbWUoU0xfRVhDSEFOR0VfUFVCX0tFWVMpICBcCi0JaGlmX2luZF9uYW1lKEVS
Uk9SKSAgICAgICAgICAgICAgICAgXAotCWhpZl9pbmRfbmFtZShFWENFUFRJT04pICAgICAgICAg
ICAgIFwKLQloaWZfaW5kX25hbWUoR0VORVJJQykgICAgICAgICAgICAgICBcCi0JaGlmX2luZF9u
YW1lKFdBS0VVUCkgICAgICAgICAgICAgICAgXAotCWhpZl9pbmRfbmFtZShTVEFSVFVQKQotCi0j
ZGVmaW5lIGhpZl9tc2dfbGlzdF9lbnVtIF9oaWZfbXNnX2xpc3QKLQotI3VuZGVmIGhpZl9jbmZf
bmFtZQotI3VuZGVmIGhpZl9pbmRfbmFtZQotI2RlZmluZSBoaWZfY25mX25hbWUobXNnKSBUUkFD
RV9ERUZJTkVfRU5VTShISUZfQ05GX0lEXyMjbXNnKTsKLSNkZWZpbmUgaGlmX2luZF9uYW1lKG1z
ZykgVFJBQ0VfREVGSU5FX0VOVU0oSElGX0lORF9JRF8jI21zZyk7Ci1oaWZfbXNnX2xpc3RfZW51
bQotI3VuZGVmIGhpZl9jbmZfbmFtZQotI3VuZGVmIGhpZl9pbmRfbmFtZQotI2RlZmluZSBoaWZf
Y25mX25hbWUobXNnKSB7IEhJRl9DTkZfSURfIyNtc2csICNtc2cgfSwKLSNkZWZpbmUgaGlmX2lu
ZF9uYW1lKG1zZykgeyBISUZfSU5EX0lEXyMjbXNnLCAjbXNnIH0sCi0jZGVmaW5lIGhpZl9tc2df
bGlzdCBoaWZfbXNnX2xpc3RfZW51bSB7IC0xLCBOVUxMIH0KLQotI2RlZmluZSBfaGlmX21pYl9s
aXN0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKEFSUF9J
UF9BRERSRVNTRVNfVEFCTEUpICAgICAgICAgXAotCWhpZl9taWJfbmFtZShBUlBfS0VFUF9BTElW
RV9QRVJJT0QpICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoQkVBQ09OX0ZJTFRFUl9FTkFCTEUp
ICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKEJFQUNPTl9GSUxURVJfVEFCTEUpICAgICAgICAg
ICAgXAotCWhpZl9taWJfbmFtZShCRUFDT05fU1RBVFMpICAgICAgICAgICAgICAgICAgIFwKLQlo
aWZfbWliX25hbWUoQkVBQ09OX1dBS0VVUF9QRVJJT0QpICAgICAgICAgICBcCi0JaGlmX21pYl9u
YW1lKEJMT0NLX0FDS19QT0xJQ1kpICAgICAgICAgICAgICAgXAotCWhpZl9taWJfbmFtZShDQ0Ff
Q09ORklHKSAgICAgICAgICAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoQ09ORklHX0RBVEFf
RklMVEVSKSAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKENPVU5URVJTX1RBQkxFKSAgICAg
ICAgICAgICAgICAgXAotCWhpZl9taWJfbmFtZShDVVJSRU5UX1RYX1BPV0VSX0xFVkVMKSAgICAg
ICAgIFwKLQloaWZfbWliX25hbWUoRE9UMTFfTUFDX0FERFJFU1MpICAgICAgICAgICAgICBcCi0J
aGlmX21pYl9uYW1lKERPVDExX01BWF9SRUNFSVZFX0xJRkVUSU1FKSAgICAgXAotCWhpZl9taWJf
bmFtZShET1QxMV9NQVhfVFJBTlNNSVRfTVNEVV9MSUZFVElNRSkgXAotCWhpZl9taWJfbmFtZShE
T1QxMV9SVFNfVEhSRVNIT0xEKSAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoRE9UMTFfV0VQ
X0RFRkFVTFRfS0VZX0lEKSAgICAgICBcCi0JaGlmX21pYl9uYW1lKEVUSEVSVFlQRV9EQVRBRlJB
TUVfQ09ORElUSU9OKSAgXAotCWhpZl9taWJfbmFtZShFWFRFTkRFRF9DT1VOVEVSU19UQUJMRSkg
ICAgICAgIFwKLQloaWZfbWliX25hbWUoR0xfQkxPQ0tfQUNLX0lORk8pICAgICAgICAgICAgICBc
Ci0JaGlmX21pYl9uYW1lKEdMX09QRVJBVElPTkFMX1BPV0VSX01PREUpICAgICAgXAotCWhpZl9t
aWJfbmFtZShHTF9TRVRfTVVMVElfTVNHKSAgICAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUo
R1JQX1NFUV9DT1VOVEVSKSAgICAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKElOQUNUSVZJ
VFlfVElNRVIpICAgICAgICAgICAgICAgXAotCWhpZl9taWJfbmFtZShJTlRFUkZBQ0VfUFJPVEVD
VElPTikgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoSVBWNF9BRERSX0RBVEFGUkFNRV9DT05E
SVRJT04pICBcCi0JaGlmX21pYl9uYW1lKElQVjZfQUREUl9EQVRBRlJBTUVfQ09ORElUSU9OKSAg
XAotCWhpZl9taWJfbmFtZShLRUVQX0FMSVZFX1BFUklPRCkgICAgICAgICAgICAgIFwKLQloaWZf
bWliX25hbWUoTUFDX0FERFJfREFUQUZSQU1FX0NPTkRJVElPTikgICBcCi0JaGlmX21pYl9uYW1l
KE1BR0lDX0RBVEFGUkFNRV9DT05ESVRJT04pICAgICAgXAotCWhpZl9taWJfbmFtZShNQVhfVFhf
UE9XRVJfTEVWRUwpICAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoTk9OX0VSUF9QUk9URUNU
SU9OKSAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKE5TX0lQX0FERFJFU1NFU19UQUJMRSkg
ICAgICAgICAgXAotCWhpZl9taWJfbmFtZShPVkVSUklERV9JTlRFUk5BTF9UWF9SQVRFKSAgICAg
IFwKLQloaWZfbWliX25hbWUoUE9SVF9EQVRBRlJBTUVfQ09ORElUSU9OKSAgICAgICBcCi0JaGlm
X21pYl9uYW1lKFBST1RFQ1RFRF9NR01UX1BPTElDWSkgICAgICAgICAgXAotCWhpZl9taWJfbmFt
ZShSQ1BJX1JTU0lfVEhSRVNIT0xEKSAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoUlhfRklM
VEVSKSAgICAgICAgICAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKFNFVF9BU1NPQ0lBVElP
Tl9NT0RFKSAgICAgICAgICAgXAotCWhpZl9taWJfbmFtZShTRVRfREFUQV9GSUxURVJJTkcpICAg
ICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoU0VUX0hUX1BST1RFQ1RJT04pICAgICAgICAgICAg
ICBcCi0JaGlmX21pYl9uYW1lKFNFVF9UWF9SQVRFX1JFVFJZX1BPTElDWSkgICAgICAgXAotCWhp
Zl9taWJfbmFtZShTRVRfVUFQU0RfSU5GT1JNQVRJT04pICAgICAgICAgIFwKLQloaWZfbWliX25h
bWUoU0xPVF9USU1FKSAgICAgICAgICAgICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKFNUQVRJ
U1RJQ1NfVEFCTEUpICAgICAgICAgICAgICAgXAotCWhpZl9taWJfbmFtZShURU1QTEFURV9GUkFN
RSkgICAgICAgICAgICAgICAgIFwKLQloaWZfbWliX25hbWUoVFNGX0NPVU5URVIpICAgICAgICAg
ICAgICAgICAgICBcCi0JaGlmX21pYl9uYW1lKFVDX01DX0JDX0RBVEFGUkFNRV9DT05ESVRJT04p
Ci0KLSNkZWZpbmUgaGlmX21pYl9saXN0X2VudW0gX2hpZl9taWJfbGlzdAotCi0jdW5kZWYgaGlm
X21pYl9uYW1lCi0jZGVmaW5lIGhpZl9taWJfbmFtZShtaWIpIFRSQUNFX0RFRklORV9FTlVNKEhJ
Rl9NSUJfSURfIyNtaWIpOwotaGlmX21pYl9saXN0X2VudW0KLSN1bmRlZiBoaWZfbWliX25hbWUK
LSNkZWZpbmUgaGlmX21pYl9uYW1lKG1pYikgeyBISUZfTUlCX0lEXyMjbWliLCAjbWliIH0sCi0j
ZGVmaW5lIGhpZl9taWJfbGlzdCBoaWZfbWliX2xpc3RfZW51bSB7IC0xLCBOVUxMIH0KLQotREVD
TEFSRV9FVkVOVF9DTEFTUyhoaWZfZGF0YSwKLQlUUF9QUk9UTyhjb25zdCBzdHJ1Y3QgaGlmX21z
ZyAqaGlmLCBpbnQgdHhfZmlsbF9sZXZlbCwgYm9vbCBpc19yZWN2KSwKLQlUUF9BUkdTKGhpZiwg
dHhfZmlsbF9sZXZlbCwgaXNfcmVjdiksCi0JVFBfU1RSVUNUX19lbnRyeSgKLQkJX19maWVsZChp
bnQsIHR4X2ZpbGxfbGV2ZWwpCi0JCV9fZmllbGQoaW50LCBtc2dfaWQpCi0JCV9fZmllbGQoY29u
c3QgY2hhciAqLCBtc2dfdHlwZSkKLQkJX19maWVsZChpbnQsIG1zZ19sZW4pCi0JCV9fZmllbGQo
aW50LCBidWZfbGVuKQotCQlfX2ZpZWxkKGludCwgaWZfaWQpCi0JCV9fZmllbGQoaW50LCBtaWIp
Ci0JCV9fYXJyYXkodTgsIGJ1ZiwgMTI4KQotCSksCi0JVFBfZmFzdF9hc3NpZ24oCi0JCWludCBo
ZWFkZXJfbGVuOwotCi0JCV9fZW50cnktPnR4X2ZpbGxfbGV2ZWwgPSB0eF9maWxsX2xldmVsOwot
CQlfX2VudHJ5LT5tc2dfbGVuID0gbGUxNl90b19jcHUoaGlmLT5sZW4pOwotCQlfX2VudHJ5LT5t
c2dfaWQgPSBoaWYtPmlkOwotCQlfX2VudHJ5LT5pZl9pZCA9IGhpZi0+aW50ZXJmYWNlOwotCQlp
ZiAoaXNfcmVjdikKLQkJCV9fZW50cnktPm1zZ190eXBlID0gX19lbnRyeS0+bXNnX2lkICYgMHg4
MCA/ICJJTkQiIDogIkNORiI7Ci0JCWVsc2UKLQkJCV9fZW50cnktPm1zZ190eXBlID0gIlJFUSI7
Ci0JCWlmICghaXNfcmVjdiAmJgotCQkgICAgKF9fZW50cnktPm1zZ19pZCA9PSBISUZfUkVRX0lE
X1JFQURfTUlCIHx8Ci0JCSAgICAgX19lbnRyeS0+bXNnX2lkID09IEhJRl9SRVFfSURfV1JJVEVf
TUlCKSkgewotCQkJX19lbnRyeS0+bWliID0gbGUxNl90b19jcHVwKChfX2xlMTYgKiloaWYtPmJv
ZHkpOwotCQkJaGVhZGVyX2xlbiA9IDQ7Ci0JCX0gZWxzZSB7Ci0JCQlfX2VudHJ5LT5taWIgPSAt
MTsKLQkJCWhlYWRlcl9sZW4gPSAwOwotCQl9Ci0JCV9fZW50cnktPmJ1Zl9sZW4gPSBtaW5fdChp
bnQsIF9fZW50cnktPm1zZ19sZW4sCi0JCQkJCSBzaXplb2YoX19lbnRyeS0+YnVmKSkKLQkJCQkg
ICAtIHNpemVvZihzdHJ1Y3QgaGlmX21zZykgLSBoZWFkZXJfbGVuOwotCQltZW1jcHkoX19lbnRy
eS0+YnVmLCBoaWYtPmJvZHkgKyBoZWFkZXJfbGVuLCBfX2VudHJ5LT5idWZfbGVuKTsKLQkpLAot
CVRQX3ByaW50aygiJWQ6JWQ6JXNfJXMlcyVzOiAlcyVzICglZCBieXRlcykiLAotCQlfX2VudHJ5
LT50eF9maWxsX2xldmVsLAotCQlfX2VudHJ5LT5pZl9pZCwKLQkJX19lbnRyeS0+bXNnX3R5cGUs
Ci0JCV9fcHJpbnRfc3ltYm9saWMoX19lbnRyeS0+bXNnX2lkLCBoaWZfbXNnX2xpc3QpLAotCQlf
X2VudHJ5LT5taWIgIT0gLTEgPyAiLyIgOiAiIiwKLQkJX19lbnRyeS0+bWliICE9IC0xID8gX19w
cmludF9zeW1ib2xpYyhfX2VudHJ5LT5taWIsIGhpZl9taWJfbGlzdCkgOiAiIiwKLQkJX19wcmlu
dF9oZXgoX19lbnRyeS0+YnVmLCBfX2VudHJ5LT5idWZfbGVuKSwKLQkJX19lbnRyeS0+bXNnX2xl
biA+IHNpemVvZihfX2VudHJ5LT5idWYpID8gIiAuLi4iIDogIiIsCi0JCV9fZW50cnktPm1zZ19s
ZW4KLQkpCi0pOwotREVGSU5FX0VWRU5UKGhpZl9kYXRhLCBoaWZfc2VuZCwKLQlUUF9QUk9UTyhj
b25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBpbnQgdHhfZmlsbF9sZXZlbCwgYm9vbCBpc19yZWN2
KSwKLQlUUF9BUkdTKGhpZiwgdHhfZmlsbF9sZXZlbCwgaXNfcmVjdikpOwotI2RlZmluZSBfdHJh
Y2VfaGlmX3NlbmQoaGlmLCB0eF9maWxsX2xldmVsKVwKLQl0cmFjZV9oaWZfc2VuZChoaWYsIHR4
X2ZpbGxfbGV2ZWwsIGZhbHNlKQotREVGSU5FX0VWRU5UKGhpZl9kYXRhLCBoaWZfcmVjdiwKLQlU
UF9QUk9UTyhjb25zdCBzdHJ1Y3QgaGlmX21zZyAqaGlmLCBpbnQgdHhfZmlsbF9sZXZlbCwgYm9v
bCBpc19yZWN2KSwKLQlUUF9BUkdTKGhpZiwgdHhfZmlsbF9sZXZlbCwgaXNfcmVjdikpOwotI2Rl
ZmluZSBfdHJhY2VfaGlmX3JlY3YoaGlmLCB0eF9maWxsX2xldmVsKVwKLQl0cmFjZV9oaWZfcmVj
dihoaWYsIHR4X2ZpbGxfbGV2ZWwsIHRydWUpCi0KLSNkZWZpbmUgd2Z4X3JlZ19saXN0X2VudW0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdf
Q09ORklHLCAgICAgICAiQ09ORklHIikgICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfQ09O
VFJPTCwgICAgICAiQ09OVFJPTCIpICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfSU5fT1VU
X1FVRVVFLCAiUVVFVUUiKSAgICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfQUhCX0RQT1JU
LCAgICAiQUhCIikgICAgICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfQkFTRV9BRERSLCAg
ICAiQkFTRV9BRERSIikgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfU1JBTV9EUE9SVCwgICAi
U1JBTSIpICAgICAgICBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfU0VUX0dFTl9SX1csICAiU0VU
X0dFTl9SX1ciKSBcCi0Jd2Z4X3JlZ19uYW1lKFdGWF9SRUdfRlJBTUVfT1VULCAgICAiRlJBTUVf
T1VUIikKLQotI3VuZGVmIHdmeF9yZWdfbmFtZQotI2RlZmluZSB3ZnhfcmVnX25hbWUoc3ltLCBu
YW1lKSBUUkFDRV9ERUZJTkVfRU5VTShzeW0pOwotd2Z4X3JlZ19saXN0X2VudW0KLSN1bmRlZiB3
ZnhfcmVnX25hbWUKLSNkZWZpbmUgd2Z4X3JlZ19uYW1lKHN5bSwgbmFtZSkgeyBzeW0sIG5hbWUg
fSwKLSNkZWZpbmUgd2Z4X3JlZ19saXN0IHdmeF9yZWdfbGlzdF9lbnVtIHsgLTEsIE5VTEwgfQot
Ci1ERUNMQVJFX0VWRU5UX0NMQVNTKGlvX2RhdGEsCi0JVFBfUFJPVE8oaW50IHJlZywgaW50IGFk
ZHIsIGNvbnN0IHZvaWQgKmlvX2J1Ziwgc2l6ZV90IGxlbiksCi0JVFBfQVJHUyhyZWcsIGFkZHIs
IGlvX2J1ZiwgbGVuKSwKLQlUUF9TVFJVQ1RfX2VudHJ5KAotCQlfX2ZpZWxkKGludCwgcmVnKQot
CQlfX2ZpZWxkKGludCwgYWRkcikKLQkJX19maWVsZChpbnQsIG1zZ19sZW4pCi0JCV9fZmllbGQo
aW50LCBidWZfbGVuKQotCQlfX2FycmF5KHU4LCBidWYsIDMyKQotCQlfX2FycmF5KHU4LCBhZGRy
X3N0ciwgMTApCi0JKSwKLQlUUF9mYXN0X2Fzc2lnbigKLQkJX19lbnRyeS0+cmVnID0gcmVnOwot
CQlfX2VudHJ5LT5hZGRyID0gYWRkcjsKLQkJX19lbnRyeS0+bXNnX2xlbiA9IGxlbjsKLQkJX19l
bnRyeS0+YnVmX2xlbiA9IG1pbl90KGludCwgc2l6ZW9mKF9fZW50cnktPmJ1ZiksCi0JCQkJCSBf
X2VudHJ5LT5tc2dfbGVuKTsKLQkJbWVtY3B5KF9fZW50cnktPmJ1ZiwgaW9fYnVmLCBfX2VudHJ5
LT5idWZfbGVuKTsKLQkJaWYgKGFkZHIgPj0gMCkKLQkJCXNucHJpbnRmKF9fZW50cnktPmFkZHJf
c3RyLCAxMCwgIi8lMDh4IiwgYWRkcik7Ci0JCWVsc2UKLQkJCV9fZW50cnktPmFkZHJfc3RyWzBd
ID0gMDsKLQkpLAotCVRQX3ByaW50aygiJXMlczogJXMlcyAoJWQgYnl0ZXMpIiwKLQkJX19wcmlu
dF9zeW1ib2xpYyhfX2VudHJ5LT5yZWcsIHdmeF9yZWdfbGlzdCksCi0JCV9fZW50cnktPmFkZHJf
c3RyLAotCQlfX3ByaW50X2hleChfX2VudHJ5LT5idWYsIF9fZW50cnktPmJ1Zl9sZW4pLAotCQlf
X2VudHJ5LT5tc2dfbGVuID4gc2l6ZW9mKF9fZW50cnktPmJ1ZikgPyAiIC4uLiIgOiAiIiwKLQkJ
X19lbnRyeS0+bXNnX2xlbgotCSkKLSk7Ci1ERUZJTkVfRVZFTlQoaW9fZGF0YSwgaW9fd3JpdGUs
Ci0JVFBfUFJPVE8oaW50IHJlZywgaW50IGFkZHIsIGNvbnN0IHZvaWQgKmlvX2J1Ziwgc2l6ZV90
IGxlbiksCi0JVFBfQVJHUyhyZWcsIGFkZHIsIGlvX2J1ZiwgbGVuKSk7Ci0jZGVmaW5lIF90cmFj
ZV9pb19pbmRfd3JpdGUocmVnLCBhZGRyLCBpb19idWYsIGxlbilcCi0JdHJhY2VfaW9fd3JpdGUo
cmVnLCBhZGRyLCBpb19idWYsIGxlbikKLSNkZWZpbmUgX3RyYWNlX2lvX3dyaXRlKHJlZywgaW9f
YnVmLCBsZW4pIHRyYWNlX2lvX3dyaXRlKHJlZywgLTEsIGlvX2J1ZiwgbGVuKQotREVGSU5FX0VW
RU5UKGlvX2RhdGEsIGlvX3JlYWQsCi0JVFBfUFJPVE8oaW50IHJlZywgaW50IGFkZHIsIGNvbnN0
IHZvaWQgKmlvX2J1Ziwgc2l6ZV90IGxlbiksCi0JVFBfQVJHUyhyZWcsIGFkZHIsIGlvX2J1Ziwg
bGVuKSk7Ci0jZGVmaW5lIF90cmFjZV9pb19pbmRfcmVhZChyZWcsIGFkZHIsIGlvX2J1ZiwgbGVu
KVwKLQl0cmFjZV9pb19yZWFkKHJlZywgYWRkciwgaW9fYnVmLCBsZW4pCi0jZGVmaW5lIF90cmFj
ZV9pb19yZWFkKHJlZywgaW9fYnVmLCBsZW4pIHRyYWNlX2lvX3JlYWQocmVnLCAtMSwgaW9fYnVm
LCBsZW4pCi0KLURFQ0xBUkVfRVZFTlRfQ0xBU1MoaW9fZGF0YTMyLAotCVRQX1BST1RPKGludCBy
ZWcsIGludCBhZGRyLCB1MzIgdmFsKSwKLQlUUF9BUkdTKHJlZywgYWRkciwgdmFsKSwKLQlUUF9T
VFJVQ1RfX2VudHJ5KAotCQlfX2ZpZWxkKGludCwgcmVnKQotCQlfX2ZpZWxkKGludCwgYWRkcikK
LQkJX19maWVsZChpbnQsIHZhbCkKLQkJX19hcnJheSh1OCwgYWRkcl9zdHIsIDEwKQotCSksCi0J
VFBfZmFzdF9hc3NpZ24oCi0JCV9fZW50cnktPnJlZyA9IHJlZzsKLQkJX19lbnRyeS0+YWRkciA9
IGFkZHI7Ci0JCV9fZW50cnktPnZhbCA9IHZhbDsKLQkJaWYgKGFkZHIgPj0gMCkKLQkJCXNucHJp
bnRmKF9fZW50cnktPmFkZHJfc3RyLCAxMCwgIi8lMDh4IiwgYWRkcik7Ci0JCWVsc2UKLQkJCV9f
ZW50cnktPmFkZHJfc3RyWzBdID0gMDsKLQkpLAotCVRQX3ByaW50aygiJXMlczogJTA4eCIsCi0J
CV9fcHJpbnRfc3ltYm9saWMoX19lbnRyeS0+cmVnLCB3ZnhfcmVnX2xpc3QpLAotCQlfX2VudHJ5
LT5hZGRyX3N0ciwKLQkJX19lbnRyeS0+dmFsCi0JKQotKTsKLURFRklORV9FVkVOVChpb19kYXRh
MzIsIGlvX3dyaXRlMzIsCi0JVFBfUFJPVE8oaW50IHJlZywgaW50IGFkZHIsIHUzMiB2YWwpLAot
CVRQX0FSR1MocmVnLCBhZGRyLCB2YWwpKTsKLSNkZWZpbmUgX3RyYWNlX2lvX2luZF93cml0ZTMy
KHJlZywgYWRkciwgdmFsKSB0cmFjZV9pb193cml0ZTMyKHJlZywgYWRkciwgdmFsKQotI2RlZmlu
ZSBfdHJhY2VfaW9fd3JpdGUzMihyZWcsIHZhbCkgdHJhY2VfaW9fd3JpdGUzMihyZWcsIC0xLCB2
YWwpCi1ERUZJTkVfRVZFTlQoaW9fZGF0YTMyLCBpb19yZWFkMzIsCi0JVFBfUFJPVE8oaW50IHJl
ZywgaW50IGFkZHIsIHUzMiB2YWwpLAotCVRQX0FSR1MocmVnLCBhZGRyLCB2YWwpKTsKLSNkZWZp
bmUgX3RyYWNlX2lvX2luZF9yZWFkMzIocmVnLCBhZGRyLCB2YWwpIHRyYWNlX2lvX3JlYWQzMihy
ZWcsIGFkZHIsIHZhbCkKLSNkZWZpbmUgX3RyYWNlX2lvX3JlYWQzMihyZWcsIHZhbCkgdHJhY2Vf
aW9fcmVhZDMyKHJlZywgLTEsIHZhbCkKLQotREVDTEFSRV9FVkVOVF9DTEFTUyhwaWdneWJhY2ss
Ci0JVFBfUFJPVE8odTMyIHZhbCwgYm9vbCBpZ25vcmVkKSwKLQlUUF9BUkdTKHZhbCwgaWdub3Jl
ZCksCi0JVFBfU1RSVUNUX19lbnRyeSgKLQkJX19maWVsZChpbnQsIHZhbCkKLQkJX19maWVsZChi
b29sLCBpZ25vcmVkKQotCSksCi0JVFBfZmFzdF9hc3NpZ24oCi0JCV9fZW50cnktPnZhbCA9IHZh
bDsKLQkJX19lbnRyeS0+aWdub3JlZCA9IGlnbm9yZWQ7Ci0JKSwKLQlUUF9wcmludGsoIkNPTlRS
T0w6ICUwOHglcyIsCi0JCV9fZW50cnktPnZhbCwKLQkJX19lbnRyeS0+aWdub3JlZCA/ICIgKGln
bm9yZWQpIiA6ICIiCi0JKQotKTsKLURFRklORV9FVkVOVChwaWdneWJhY2ssIHBpZ2d5YmFjaywK
LQlUUF9QUk9UTyh1MzIgdmFsLCBib29sIGlnbm9yZWQpLAotCVRQX0FSR1ModmFsLCBpZ25vcmVk
KSk7Ci0jZGVmaW5lIF90cmFjZV9waWdneWJhY2sodmFsLCBpZ25vcmVkKSB0cmFjZV9waWdneWJh
Y2sodmFsLCBpZ25vcmVkKQotCi1UUkFDRV9FVkVOVChiaF9zdGF0cywKLQlUUF9QUk9UTyhpbnQg
aW5kLCBpbnQgcmVxLCBpbnQgY25mLCBpbnQgYnVzeSwgYm9vbCByZWxlYXNlKSwKLQlUUF9BUkdT
KGluZCwgcmVxLCBjbmYsIGJ1c3ksIHJlbGVhc2UpLAotCVRQX1NUUlVDVF9fZW50cnkoCi0JCV9f
ZmllbGQoaW50LCBpbmQpCi0JCV9fZmllbGQoaW50LCByZXEpCi0JCV9fZmllbGQoaW50LCBjbmYp
Ci0JCV9fZmllbGQoaW50LCBidXN5KQotCQlfX2ZpZWxkKGJvb2wsIHJlbGVhc2UpCi0JKSwKLQlU
UF9mYXN0X2Fzc2lnbigKLQkJX19lbnRyeS0+aW5kID0gaW5kOwotCQlfX2VudHJ5LT5yZXEgPSBy
ZXE7Ci0JCV9fZW50cnktPmNuZiA9IGNuZjsKLQkJX19lbnRyeS0+YnVzeSA9IGJ1c3k7Ci0JCV9f
ZW50cnktPnJlbGVhc2UgPSByZWxlYXNlOwotCSksCi0JVFBfcHJpbnRrKCJJTkQvUkVRL0NORjol
M2QvJTNkLyUzZCwgUkVRIGluIHByb2dyZXNzOiUzZCwgV1VQOiAlcyIsCi0JCV9fZW50cnktPmlu
ZCwKLQkJX19lbnRyeS0+cmVxLAotCQlfX2VudHJ5LT5jbmYsCi0JCV9fZW50cnktPmJ1c3ksCi0J
CV9fZW50cnktPnJlbGVhc2UgPyAicmVsZWFzZSIgOiAia2VlcCIKLQkpCi0pOwotI2RlZmluZSBf
dHJhY2VfYmhfc3RhdHMoaW5kLCByZXEsIGNuZiwgYnVzeSwgcmVsZWFzZSlcCi0JdHJhY2VfYmhf
c3RhdHMoaW5kLCByZXEsIGNuZiwgYnVzeSwgcmVsZWFzZSkKLQotVFJBQ0VfRVZFTlQodHhfc3Rh
dHMsCi0JVFBfUFJPVE8oY29uc3Qgc3RydWN0IGhpZl9jbmZfdHggKnR4X2NuZiwgY29uc3Qgc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwKLQkJIGludCBkZWxheSksCi0JVFBfQVJHUyh0eF9jbmYsIHNrYiwg
ZGVsYXkpLAotCVRQX1NUUlVDVF9fZW50cnkoCi0JCV9fZmllbGQoaW50LCBwa3RfaWQpCi0JCV9f
ZmllbGQoaW50LCBkZWxheV9tZWRpYSkKLQkJX19maWVsZChpbnQsIGRlbGF5X3F1ZXVlKQotCQlf
X2ZpZWxkKGludCwgZGVsYXlfZncpCi0JCV9fZmllbGQoaW50LCBhY2tfZmFpbHVyZXMpCi0JCV9f
ZmllbGQoaW50LCBmbGFncykKLQkJX19hcnJheShpbnQsIHJhdGUsIDQpCi0JCV9fYXJyYXkoaW50
LCB0eF9jb3VudCwgNCkKLQkpLAotCVRQX2Zhc3RfYXNzaWduKAotCQkvKiBLZWVwIHN5bmMgd2l0
aCB3ZnhfcmF0ZXMgZGVmaW5pdGlvbiBpbiBtYWluLmMgKi8KLQkJc3RhdGljIGNvbnN0IGludCBo
d19yYXRlW10gPSB7IDAsIDEsIDIsIDMsIDYsIDcsIDgsIDksCi0JCQkJCSAgICAgICAxMCwgMTEs
IDEyLCAxMyB9OwotCQljb25zdCBzdHJ1Y3QgaWVlZTgwMjExX3R4X2luZm8gKnR4X2luZm8gPQot
CQkJKGNvbnN0IHN0cnVjdCBpZWVlODAyMTFfdHhfaW5mbyAqKXNrYi0+Y2I7Ci0JCWNvbnN0IHN0
cnVjdCBpZWVlODAyMTFfdHhfcmF0ZSAqcmF0ZXMgPSB0eF9pbmZvLT5kcml2ZXJfcmF0ZXM7Ci0J
CWludCBpOwotCi0JCV9fZW50cnktPnBrdF9pZCA9IHR4X2NuZi0+cGFja2V0X2lkOwotCQlfX2Vu
dHJ5LT5kZWxheV9tZWRpYSA9IGxlMzJfdG9fY3B1KHR4X2NuZi0+bWVkaWFfZGVsYXkpOwotCQlf
X2VudHJ5LT5kZWxheV9xdWV1ZSA9IGxlMzJfdG9fY3B1KHR4X2NuZi0+dHhfcXVldWVfZGVsYXkp
OwotCQlfX2VudHJ5LT5kZWxheV9mdyA9IGRlbGF5OwotCQlfX2VudHJ5LT5hY2tfZmFpbHVyZXMg
PSB0eF9jbmYtPmFja19mYWlsdXJlczsKLQkJaWYgKCF0eF9jbmYtPnN0YXR1cyB8fCBfX2VudHJ5
LT5hY2tfZmFpbHVyZXMpCi0JCQlfX2VudHJ5LT5hY2tfZmFpbHVyZXMgKz0gMTsKLQotCQlmb3Ig
KGkgPSAwOyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7IGkrKykgewotCQkJaWYgKHJhdGVzWzBdLmZs
YWdzICYgSUVFRTgwMjExX1RYX1JDX01DUykKLQkJCQlfX2VudHJ5LT5yYXRlW2ldID0gcmF0ZXNb
aV0uaWR4OwotCQkJZWxzZQotCQkJCV9fZW50cnktPnJhdGVbaV0gPSBod19yYXRlW3JhdGVzW2ld
LmlkeF07Ci0JCQlfX2VudHJ5LT50eF9jb3VudFtpXSA9IHJhdGVzW2ldLmNvdW50OwotCQl9Ci0J
CV9fZW50cnktPmZsYWdzID0gMDsKLQkJaWYgKHJhdGVzWzBdLmZsYWdzICYgSUVFRTgwMjExX1RY
X1JDX01DUykKLQkJCV9fZW50cnktPmZsYWdzIHw9IDB4MDE7Ci0JCWlmIChyYXRlc1swXS5mbGFn
cyAmIElFRUU4MDIxMV9UWF9SQ19TSE9SVF9HSSkKLQkJCV9fZW50cnktPmZsYWdzIHw9IDB4MDI7
Ci0JCWlmIChyYXRlc1swXS5mbGFncyAmIElFRUU4MDIxMV9UWF9SQ19HUkVFTl9GSUVMRCkKLQkJ
CV9fZW50cnktPmZsYWdzIHw9IDB4MDQ7Ci0JCWlmIChyYXRlc1swXS5mbGFncyAmIElFRUU4MDIx
MV9UWF9SQ19VU0VfUlRTX0NUUykKLQkJCV9fZW50cnktPmZsYWdzIHw9IDB4MDg7Ci0JCWlmICh0
eF9pbmZvLT5mbGFncyAmIElFRUU4MDIxMV9UWF9DVExfU0VORF9BRlRFUl9EVElNKQotCQkJX19l
bnRyeS0+ZmxhZ3MgfD0gMHgxMDsKLQkJaWYgKHR4X2NuZi0+c3RhdHVzKQotCQkJX19lbnRyeS0+
ZmxhZ3MgfD0gMHgyMDsKLQkJaWYgKHR4X2NuZi0+c3RhdHVzID09IEhJRl9TVEFUVVNfVFhfRkFJ
TF9SRVFVRVVFKQotCQkJX19lbnRyeS0+ZmxhZ3MgfD0gMHg0MDsKLQkpLAotCVRQX3ByaW50aygi
cGFja2V0IElEOiAlMDh4LCByYXRlIHBvbGljeTogJXMgJWR8JWQgJWR8JWQgJWR8JWQgJWR8JWQg
LT4gJWQgYXR0ZW1wdCwgRGVsYXlzIG1lZGlhL3F1ZXVlL3RvdGFsOiAlNGR1cy8lNGR1cy8lNGR1
cyIsCi0JCV9fZW50cnktPnBrdF9pZCwKLQkJX19wcmludF9mbGFncyhfX2VudHJ5LT5mbGFncywg
TlVMTCwKLQkJCXsgMHgwMSwgIk0iIH0sIHsgMHgwMiwgIlMiIH0sIHsgMHgwNCwgIkciIH0sCi0J
CQl7IDB4MDgsICJSIiB9LCB7IDB4MTAsICJEIiB9LCB7IDB4MjAsICJGIiB9LAotCQkJeyAweDQw
LCAiUSIgfSksCi0JCV9fZW50cnktPnJhdGVbMF0sCi0JCV9fZW50cnktPnR4X2NvdW50WzBdLAot
CQlfX2VudHJ5LT5yYXRlWzFdLAotCQlfX2VudHJ5LT50eF9jb3VudFsxXSwKLQkJX19lbnRyeS0+
cmF0ZVsyXSwKLQkJX19lbnRyeS0+dHhfY291bnRbMl0sCi0JCV9fZW50cnktPnJhdGVbM10sCi0J
CV9fZW50cnktPnR4X2NvdW50WzNdLAotCQlfX2VudHJ5LT5hY2tfZmFpbHVyZXMsCi0JCV9fZW50
cnktPmRlbGF5X21lZGlhLAotCQlfX2VudHJ5LT5kZWxheV9xdWV1ZSwKLQkJX19lbnRyeS0+ZGVs
YXlfZncKLQkpCi0pOwotI2RlZmluZSBfdHJhY2VfdHhfc3RhdHModHhfY25mLCBza2IsIGRlbGF5
KSB0cmFjZV90eF9zdGF0cyh0eF9jbmYsIHNrYiwgZGVsYXkpCi0KLVRSQUNFX0VWRU5UKHF1ZXVl
c19zdGF0cywKLQlUUF9QUk9UTyhzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgY29uc3Qgc3RydWN0IHdm
eF9xdWV1ZSAqZWxlY3RlZF9xdWV1ZSksCi0JVFBfQVJHUyh3ZGV2LCBlbGVjdGVkX3F1ZXVlKSwK
LQlUUF9TVFJVQ1RfX2VudHJ5KAotCQlfX2ZpZWxkKGludCwgdmlmX2lkKQotCQlfX2ZpZWxkKGlu
dCwgcXVldWVfaWQpCi0JCV9fYXJyYXkoaW50LCBodywgSUVFRTgwMjExX05VTV9BQ1MgKiAyKQot
CQlfX2FycmF5KGludCwgZHJ2LCBJRUVFODAyMTFfTlVNX0FDUyAqIDIpCi0JCV9fYXJyYXkoaW50
LCBjYWIsIElFRUU4MDIxMV9OVU1fQUNTICogMikKLQkpLAotCVRQX2Zhc3RfYXNzaWduKAotCQlj
b25zdCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZTsKLQkJc3RydWN0IHdmeF92aWYgKnd2aWY7Ci0J
CWludCBpLCBqOwotCi0JCWZvciAoaiA9IDA7IGogPCBJRUVFODAyMTFfTlVNX0FDUyAqIDI7IGor
KykgewotCQkJX19lbnRyeS0+aHdbal0gPSAtMTsKLQkJCV9fZW50cnktPmRydltqXSA9IC0xOwot
CQkJX19lbnRyeS0+Y2FiW2pdID0gLTE7Ci0JCX0KLQkJX19lbnRyeS0+dmlmX2lkID0gLTE7Ci0J
CV9fZW50cnktPnF1ZXVlX2lkID0gLTE7Ci0JCXd2aWYgPSBOVUxMOwotCQl3aGlsZSAoKHd2aWYg
PSB3dmlmX2l0ZXJhdGUod2Rldiwgd3ZpZikpICE9IE5VTEwpIHsKLQkJCWZvciAoaSA9IDA7IGkg
PCBJRUVFODAyMTFfTlVNX0FDUzsgaSsrKSB7Ci0JCQkJaiA9IHd2aWYtPmlkICogSUVFRTgwMjEx
X05VTV9BQ1MgKyBpOwotCQkJCVdBUk5fT04oaiA+PSBJRUVFODAyMTFfTlVNX0FDUyAqIDIpOwot
CQkJCXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVlW2ldOwotCQkJCV9fZW50cnktPmh3W2pdID0gYXRv
bWljX3JlYWQoJnF1ZXVlLT5wZW5kaW5nX2ZyYW1lcyk7Ci0JCQkJX19lbnRyeS0+ZHJ2W2pdID0g
c2tiX3F1ZXVlX2xlbigmcXVldWUtPm5vcm1hbCk7Ci0JCQkJX19lbnRyeS0+Y2FiW2pdID0gc2ti
X3F1ZXVlX2xlbigmcXVldWUtPmNhYik7Ci0JCQkJaWYgKHF1ZXVlID09IGVsZWN0ZWRfcXVldWUp
IHsKLQkJCQkJX19lbnRyeS0+dmlmX2lkID0gd3ZpZi0+aWQ7Ci0JCQkJCV9fZW50cnktPnF1ZXVl
X2lkID0gaTsKLQkJCQl9Ci0JCQl9Ci0JCX0KLQkpLAotCVRQX3ByaW50aygiZ290IHNrYiBmcm9t
ICVkLyVkLCBwZW5kLiBody9ub3JtL2NhYjogWyAlZC8lZC8lZCAlZC8lZC8lZCAlZC8lZC8lZCAl
ZC8lZC8lZCBdIFsgJWQvJWQvJWQgJWQvJWQvJWQgJWQvJWQvJWQgJWQvJWQvJWQgXSIsCi0JCV9f
ZW50cnktPnZpZl9pZCwgX19lbnRyeS0+cXVldWVfaWQsCi0JCV9fZW50cnktPmh3WzBdLCBfX2Vu
dHJ5LT5kcnZbMF0sIF9fZW50cnktPmNhYlswXSwKLQkJX19lbnRyeS0+aHdbMV0sIF9fZW50cnkt
PmRydlsxXSwgX19lbnRyeS0+Y2FiWzFdLAotCQlfX2VudHJ5LT5od1syXSwgX19lbnRyeS0+ZHJ2
WzJdLCBfX2VudHJ5LT5jYWJbMl0sCi0JCV9fZW50cnktPmh3WzNdLCBfX2VudHJ5LT5kcnZbM10s
IF9fZW50cnktPmNhYlszXSwKLQkJX19lbnRyeS0+aHdbNF0sIF9fZW50cnktPmRydls0XSwgX19l
bnRyeS0+Y2FiWzRdLAotCQlfX2VudHJ5LT5od1s1XSwgX19lbnRyeS0+ZHJ2WzVdLCBfX2VudHJ5
LT5jYWJbNV0sCi0JCV9fZW50cnktPmh3WzZdLCBfX2VudHJ5LT5kcnZbNl0sIF9fZW50cnktPmNh
Yls2XSwKLQkJX19lbnRyeS0+aHdbN10sIF9fZW50cnktPmRydls3XSwgX19lbnRyeS0+Y2FiWzdd
Ci0JKQotKTsKLQotI2VuZGlmCi0KLS8qIFRoaXMgcGFydCBtdXN0IGJlIG91dHNpZGUgcHJvdGVj
dGlvbiAqLwotI3VuZGVmIFRSQUNFX0lOQ0xVREVfUEFUSAotI2RlZmluZSBUUkFDRV9JTkNMVURF
X1BBVEggLgotI3VuZGVmIFRSQUNFX0lOQ0xVREVfRklMRQotI2RlZmluZSBUUkFDRV9JTkNMVURF
X0ZJTEUgdHJhY2VzCi0KLSNpbmNsdWRlIDx0cmFjZS9kZWZpbmVfdHJhY2UuaD4KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvc3RhZ2luZy93Zngvd2Z4LmggYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3dmeC5o
CmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBmOGRmNTlhZDE2MzkuLjAwMDAwMDAwMDAw
MAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L3dmeC5oCisrKyAvZGV2L251bGwKQEAgLTEsMTY0
ICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KLS8q
Ci0gKiBDb21tb24gcHJpdmF0ZSBkYXRhLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxNy0yMDIw
LCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgotICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1F
cmljc3NvbgotICogQ29weXJpZ2h0IChjKSAyMDA2LCBNaWNoYWVsIFd1IDxmbGFtaW5naWNlQHNv
dXJtaWxrLm5ldD4KLSAqIENvcHlyaWdodCAyMDA0LTIwMDYgSmVhbi1CYXB0aXN0ZSBOb3RlIDxq
Ym5vdGVAZ21haWwuY29tPiwgZXQgYWwuCi0gKi8KLSNpZm5kZWYgV0ZYX0gKLSNkZWZpbmUgV0ZY
X0gKLQotI2luY2x1ZGUgPGxpbnV4L2NvbXBsZXRpb24uaD4KLSNpbmNsdWRlIDxsaW51eC93b3Jr
cXVldWUuaD4KLSNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgotI2luY2x1ZGUgPGxpbnV4L25vc3Bl
Yy5oPgotI2luY2x1ZGUgPG5ldC9tYWM4MDIxMS5oPgotCi0jaW5jbHVkZSAiYmguaCIKLSNpbmNs
dWRlICJkYXRhX3R4LmgiCi0jaW5jbHVkZSAibWFpbi5oIgotI2luY2x1ZGUgInF1ZXVlLmgiCi0j
aW5jbHVkZSAiaGlmX3R4LmgiCi0KLSNkZWZpbmUgVVNFQ19QRVJfVFhPUCAzMiAvKiBzZWUgc3Ry
dWN0IGllZWU4MDIxMV90eF9xdWV1ZV9wYXJhbXMgKi8KLSNkZWZpbmUgVVNFQ19QRVJfVFUgMTAy
NAotCi1zdHJ1Y3QgaHdidXNfb3BzOwotCi1zdHJ1Y3Qgd2Z4X2RldiB7Ci0Jc3RydWN0IHdmeF9w
bGF0Zm9ybV9kYXRhIHBkYXRhOwotCXN0cnVjdCBkZXZpY2UJCSpkZXY7Ci0Jc3RydWN0IGllZWU4
MDIxMV9odwkqaHc7Ci0Jc3RydWN0IGllZWU4MDIxMV92aWYJKnZpZlsyXTsKLQlzdHJ1Y3QgbWFj
X2FkZHJlc3MJYWRkcmVzc2VzWzJdOwotCWNvbnN0IHN0cnVjdCBod2J1c19vcHMJKmh3YnVzX29w
czsKLQl2b2lkCQkJKmh3YnVzX3ByaXY7Ci0KLQl1OAkJCWtleXNldDsKLQlzdHJ1Y3QgY29tcGxl
dGlvbglmaXJtd2FyZV9yZWFkeTsKLQlzdHJ1Y3QgaGlmX2luZF9zdGFydHVwCWh3X2NhcHM7Ci0J
c3RydWN0IHdmeF9oaWYJCWhpZjsKLQlzdHJ1Y3QgZGVsYXllZF93b3JrCWNvb2xpbmdfdGltZW91
dF93b3JrOwotCWJvb2wJCQlwb2xsX2lycTsKLQlib29sCQkJY2hpcF9mcm96ZW47Ci0Jc3RydWN0
IG11dGV4CQljb25mX211dGV4OwotCi0Jc3RydWN0IHdmeF9oaWZfY21kCWhpZl9jbWQ7Ci0Jc3Ry
dWN0IHNrX2J1ZmZfaGVhZAl0eF9wZW5kaW5nOwotCXdhaXRfcXVldWVfaGVhZF90CXR4X2RlcXVl
dWU7Ci0JYXRvbWljX3QJCXR4X2xvY2s7Ci0KLQlhdG9taWNfdAkJcGFja2V0X2lkOwotCXUzMgkJ
CWtleV9tYXA7Ci0KLQlzdHJ1Y3QgaGlmX3J4X3N0YXRzCXJ4X3N0YXRzOwotCXN0cnVjdCBtdXRl
eAkJcnhfc3RhdHNfbG9jazsKLQlzdHJ1Y3QgaGlmX3R4X3Bvd2VyX2xvb3BfaW5mbyB0eF9wb3dl
cl9sb29wX2luZm87Ci0Jc3RydWN0IG11dGV4CQl0eF9wb3dlcl9sb29wX2luZm9fbG9jazsKLQlp
bnQJCQlmb3JjZV9wc190aW1lb3V0OwotfTsKLQotc3RydWN0IHdmeF92aWYgewotCXN0cnVjdCB3
ZnhfZGV2CQkqd2RldjsKLQlzdHJ1Y3QgaWVlZTgwMjExX3ZpZgkqdmlmOwotCXN0cnVjdCBpZWVl
ODAyMTFfY2hhbm5lbCAqY2hhbm5lbDsKLQlpbnQJCQlpZDsKLQotCXUzMgkJCWxpbmtfaWRfbWFw
OwotCi0JYm9vbAkJCWFmdGVyX2R0aW1fdHhfYWxsb3dlZDsKLQlib29sCQkJam9pbl9pbl9wcm9n
cmVzczsKLQotCXN0cnVjdCBkZWxheWVkX3dvcmsJYmVhY29uX2xvc3Nfd29yazsKLQotCXN0cnVj
dCB3ZnhfcXVldWUJdHhfcXVldWVbNF07Ci0Jc3RydWN0IHR4X3BvbGljeV9jYWNoZQl0eF9wb2xp
Y3lfY2FjaGU7Ci0Jc3RydWN0IHdvcmtfc3RydWN0CXR4X3BvbGljeV91cGxvYWRfd29yazsKLQot
CXN0cnVjdCB3b3JrX3N0cnVjdAl1cGRhdGVfdGltX3dvcms7Ci0KLQl1bnNpZ25lZCBsb25nCQl1
YXBzZF9tYXNrOwotCi0JLyogYXZvaWQgc29tZSBvcGVyYXRpb25zIGluIHBhcmFsbGVsIHdpdGgg
c2NhbiAqLwotCXN0cnVjdCBtdXRleAkJc2Nhbl9sb2NrOwotCXN0cnVjdCB3b3JrX3N0cnVjdAlz
Y2FuX3dvcms7Ci0Jc3RydWN0IGNvbXBsZXRpb24Jc2Nhbl9jb21wbGV0ZTsKLQlpbnQJCQlzY2Fu
X25iX2NoYW5fZG9uZTsKLQlib29sCQkJc2Nhbl9hYm9ydDsKLQlzdHJ1Y3QgaWVlZTgwMjExX3Nj
YW5fcmVxdWVzdCAqc2Nhbl9yZXE7Ci0KLQlzdHJ1Y3QgY29tcGxldGlvbglzZXRfcG1fbW9kZV9j
b21wbGV0ZTsKLX07Ci0KLXN0YXRpYyBpbmxpbmUgc3RydWN0IHdmeF92aWYgKndkZXZfdG9fd3Zp
ZihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgaW50IHZpZl9pZCkKLXsKLQlpZiAodmlmX2lkID49IEFS
UkFZX1NJWkUod2Rldi0+dmlmKSkgewotCQlkZXZfZGJnKHdkZXYtPmRldiwgInJlcXVlc3Rpbmcg
bm9uLWV4aXN0ZW50IHZpZjogJWRcbiIsIHZpZl9pZCk7Ci0JCXJldHVybiBOVUxMOwotCX0KLQl2
aWZfaWQgPSBhcnJheV9pbmRleF9ub3NwZWModmlmX2lkLCBBUlJBWV9TSVpFKHdkZXYtPnZpZikp
OwotCWlmICghd2Rldi0+dmlmW3ZpZl9pZF0pCi0JCXJldHVybiBOVUxMOwotCXJldHVybiAoc3Ry
dWN0IHdmeF92aWYgKil3ZGV2LT52aWZbdmlmX2lkXS0+ZHJ2X3ByaXY7Ci19Ci0KLXN0YXRpYyBp
bmxpbmUgc3RydWN0IHdmeF92aWYgKnd2aWZfaXRlcmF0ZShzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwK
LQkJCQkJICAgc3RydWN0IHdmeF92aWYgKmN1cikKLXsKLQlpbnQgaTsKLQlpbnQgbWFyayA9IDA7
Ci0Jc3RydWN0IHdmeF92aWYgKnRtcDsKLQotCWlmICghY3VyKQotCQltYXJrID0gMTsKLQlmb3Ig
KGkgPSAwOyBpIDwgQVJSQVlfU0laRSh3ZGV2LT52aWYpOyBpKyspIHsKLQkJdG1wID0gd2Rldl90
b193dmlmKHdkZXYsIGkpOwotCQlpZiAobWFyayAmJiB0bXApCi0JCQlyZXR1cm4gdG1wOwotCQlp
ZiAodG1wID09IGN1cikKLQkJCW1hcmsgPSAxOwotCX0KLQlyZXR1cm4gTlVMTDsKLX0KLQotc3Rh
dGljIGlubGluZSBpbnQgd3ZpZl9jb3VudChzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKLXsKLQlpbnQg
aTsKLQlpbnQgcmV0ID0gMDsKLQlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZjsKLQotCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKHdkZXYtPnZpZik7IGkrKykgewotCQl3dmlmID0gd2Rldl90b193dmlm
KHdkZXYsIGkpOwotCQlpZiAod3ZpZikKLQkJCXJldCsrOwotCX0KLQlyZXR1cm4gcmV0OwotfQot
Ci1zdGF0aWMgaW5saW5lIHZvaWQgbWVtcmV2ZXJzZSh1OCAqc3JjLCB1OCBsZW5ndGgpCi17Ci0J
dTggKmxvID0gc3JjOwotCXU4ICpoaSA9IHNyYyArIGxlbmd0aCAtIDE7Ci0JdTggc3dhcDsKLQot
CXdoaWxlIChsbyA8IGhpKSB7Ci0JCXN3YXAgPSAqbG87Ci0JCSpsbysrID0gKmhpOwotCQkqaGkt
LSA9IHN3YXA7Ci0JfQotfQotCi1zdGF0aWMgaW5saW5lIGludCBtZW16Y21wKHZvaWQgKnNyYywg
dW5zaWduZWQgaW50IHNpemUpCi17Ci0JdTggKmJ1ZiA9IHNyYzsKLQotCWlmICghc2l6ZSkKLQkJ
cmV0dXJuIDA7Ci0JaWYgKCpidWYpCi0JCXJldHVybiAxOwotCXJldHVybiBtZW1jbXAoYnVmLCBi
dWYgKyAxLCBzaXplIC0gMSk7Ci19Ci0KLSNlbmRpZgotLSAKMi4zNC4xCgo=
