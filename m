Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 69CFF293C87
	for <lists+netdev@lfdr.de>; Tue, 20 Oct 2020 15:00:37 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2407103AbgJTNAa (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Tue, 20 Oct 2020 09:00:30 -0400
Received: from mail-bn7nam10on2070.outbound.protection.outlook.com ([40.107.92.70]:55456
        "EHLO NAM10-BN7-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S2406958AbgJTM7i (ORCPT <rfc822;netdev@vger.kernel.org>);
        Tue, 20 Oct 2020 08:59:38 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=jhcNS93H+n9qVLUljRmM5r/CPfmQJVCxtBsYqaU2R6mkT0iP1hC8xjjT9HeFHee6OBf90iJvMr1ra91GLKzjxxw/uPlroFcwKmVopXLANlne7FNnwaANdTgXerEoEASjus9wH9sug1dqg/VbOH3XYkgI1NXp3j0XSyxoltJwcQz4WNIXHrpUrvxkzzDIKoF+6o2QaC9Im9VbnJOgXeApjVS/W4H+kl1Vr1fupDyxD3sFO4qcM2tNUrh4stDkpn+zB/RVmA0BltG/JmER9Eb5HGBAtf1mvrnJ85m99flo3fZxsvAdIQYFAkP28AT75jVby66NrCYqyEPsnC35gQolNw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=eIURbkR+WRTMa/ZE0179d5foWVXp3R5tOWbXD4yj7d0=;
 b=m3/GMH3KbgIFljwKTIi2/O/82dFLh1vS/r1ohCohcCgTzGZ5IdROPQ9yg2V0bP2KHsfInLT/MjeRXPjY19D4ZXH6SWqY88UHcNxMefh5Na1wRmOFUr1Wrqlk7jpP1elfYrIW9+l4ri5E8DZOHJ1y0jZa05Y09/mrFYd/qB7XLw7JSzdW8EnxVzk/+Sed2I4ghS/Rasi6sftbopIgbgQ78SQKikCRs3kBxfvXZF41gyo8DUUTadEmXkj9wvK8xwbaMnN8D34c9Q37rXpUWUNGPCXXdSAJAvTlyFnTtb0cnnXnQcVlWrUSOLcSAHXsnXtB3VkkOYQ2FPna1L7QijmU3g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=eIURbkR+WRTMa/ZE0179d5foWVXp3R5tOWbXD4yj7d0=;
 b=WjRs+5HaMsjMn+0r6/6UWL2slbNx9pI9JhsRyNbWF1ROFtKQxik3uHDQHizf9Weu4w2LvR5QLD1/Mq6MCE17Q9cPEZJqhc+75k35R87gUiuHLvOIg/OAeCSJcgOXZeXIO43OgRW+qkhD6D+mzpFMzXbMSlXoHCdmqlveQ18AsG0=
Authentication-Results: vger.kernel.org; dkim=none (message not signed)
 header.d=none;vger.kernel.org; dmarc=none action=none header.from=silabs.com;
Received: from SN6PR11MB2718.namprd11.prod.outlook.com (2603:10b6:805:63::18)
 by SN6PR11MB3040.namprd11.prod.outlook.com (2603:10b6:805:db::27) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3477.28; Tue, 20 Oct
 2020 12:59:22 +0000
Received: from SN6PR11MB2718.namprd11.prod.outlook.com
 ([fe80::4f5:fbe5:44a7:cb8a]) by SN6PR11MB2718.namprd11.prod.outlook.com
 ([fe80::4f5:fbe5:44a7:cb8a%5]) with mapi id 15.20.3477.028; Tue, 20 Oct 2020
 12:59:22 +0000
From:   Jerome Pouiller <Jerome.Pouiller@silabs.com>
To:     linux-wireless@vger.kernel.org, netdev@vger.kernel.org
Cc:     devel@driverdev.osuosl.org, linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Kalle Valo <kvalo@codeaurora.org>,
        "David S . Miller" <davem@davemloft.net>,
        devicetree@vger.kernel.org, Rob Herring <robh+dt@kernel.org>,
        linux-mmc@vger.kernel.org,
        =?UTF-8?q?Pali=20Roh=C3=A1r?= <pali@kernel.org>,
        Ulf Hansson <ulf.hansson@linaro.org>,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH v2 17/24] wfx: add queue.c/queue.h
Date:   Tue, 20 Oct 2020 14:58:10 +0200
Message-Id: <20201020125817.1632995-18-Jerome.Pouiller@silabs.com>
X-Mailer: git-send-email 2.28.0
In-Reply-To: <20201020125817.1632995-1-Jerome.Pouiller@silabs.com>
References: <20201020125817.1632995-1-Jerome.Pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-Originating-IP: [37.71.187.125]
X-ClientProxiedBy: PR3P192CA0026.EURP192.PROD.OUTLOOK.COM
 (2603:10a6:102:56::31) To SN6PR11MB2718.namprd11.prod.outlook.com
 (2603:10b6:805:63::18)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from pc-42.silabs.com (37.71.187.125) by PR3P192CA0026.EURP192.PROD.OUTLOOK.COM (2603:10a6:102:56::31) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3477.21 via Frontend Transport; Tue, 20 Oct 2020 12:59:19 +0000
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: d57046f8-7941-4889-cfbd-08d874f7f6be
X-MS-TrafficTypeDiagnostic: SN6PR11MB3040:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <SN6PR11MB3040176A9CB78438AC26A1C5931F0@SN6PR11MB3040.namprd11.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:4714;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: v/dFCujUwT+9bjYMXaVe5dNoEyakQLuRpv4OLynZWNsJY4l9Ez8vxJMyl2Za/yjfdGIDMkqtVE/f1GVqLTgn/E4/ONj268bitaKXvBIMeSaK3xrlAdcdr1JELP14xRCAhml8oW9bpZtA7TcZCb2UD8x9IeXPFEJ7OAuvdfRosdcymO9aNvRHiZs2NodEXrjK9xwu5R3uHZWxAP/a/8qZFbRWvUggBir2tG09lpnMfuc8xlVOkYpsV2BslQO99aGdUVYIBykcOXuwa9X/kRJMsxNVnVDrHr4IrFgabk/Dwu5rbLnWT4Zc67NVYaXubksosAIAEY8v2BvnU0Cc0rTqFA==
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:SN6PR11MB2718.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(346002)(396003)(376002)(136003)(366004)(39840400004)(4326008)(5660300002)(54906003)(478600001)(30864003)(83380400001)(86362001)(316002)(1076003)(2906002)(186003)(6486002)(66574015)(16526019)(7696005)(66556008)(7416002)(36756003)(26005)(8676002)(66476007)(52116002)(66946007)(107886003)(956004)(2616005)(6666004)(8936002);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData: RMppmVK1sS7zPXYWiAJg//Fh/ncIH93NzxpZGnDZjZnFnVkMq5xYZfQj3rk/C/jjiD9Ont9yCQWyXn3UDq5wUOeb5ZAlZHxdeXa2pDz/9iKDI6olXout9z0vjsZLnDg6WTKWYB2VyHSZKh7OW7UUjhFXtP7Jd7TG3HVdaSX4O2toqroxE/dVDAeuApQ4fbHnNgLBxYjK/y6TjJW42BMMimSFSEjExf6XsE8i3f3lKQ8/UvhhwFHVZQdBEu5+P8evx6/UaJVadT+WqQBLpil9C+dy6ZEukPdF2c9h4p3FXyPhTCYnwmeIbIgkrXStXuQ5iUOCcLFfxPbdUnAGkwHGwCN0Wiy+dyNC8F0MSDTavngufQVF5CoWTBYGCBlAdVvxhDeHBWAmU73SKo7mjYt4IxiIwoIXiWqhUjiJ47Xo5XHdNjE7LCCR51PCrNRYnkHPSPLK0Bh1s0ACFI2Rc+tQJ/AQx1VSy4BxHT5cK0n+wS6/LHRVlCuYbSQtaqVNzTD9xmsi9r1MQVsxBaoj227iWybgoh/cqIhYMJPc6HYVPzR1S0sFB2Vc3JOOZDKB/YZfo3UM3i3d7EHG0kopOX+U2RXKcJsKlDYsAm6E/PGG1FQ0vUIEYhNsIhX7S1pLZQ2e34rb+VnjGKQHwXOQpBI3qQ==
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: d57046f8-7941-4889-cfbd-08d874f7f6be
X-MS-Exchange-CrossTenant-AuthSource: SN6PR11MB2718.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 20 Oct 2020 12:59:22.0708
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: d4c+/1bY6QjtOzC4XS/ZnNLjuJNCEZNHVmd0bPkIL+B+QRjJAahXOFHk1a1dZSMyfVQEuc2EeJFvJmoYnZtodA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR11MB3040
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKU2ln
bmVkLW9mZi1ieTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29t
PgotLS0KIGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvcXVldWUuYyB8IDMwNCArKysr
KysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvcXVl
dWUuaCB8ICA0NSArKysrCiAyIGZpbGVzIGNoYW5nZWQsIDM0OSBpbnNlcnRpb25zKCspCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5o
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5jIGIv
ZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzFjMzdmNjljMjk1Ci0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5jCkBAIC0wLDAgKzEsMzA0IEBA
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogTygxKSBU
WCBxdWV1ZSB3aXRoIGJ1aWx0LWluIGFsbG9jYXRvci4KKyAqCisgKiBDb3B5cmlnaHQgKGMpIDIw
MTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3JpZXMsIEluYy4KKyAqIENvcHlyaWdodCAoYykgMjAx
MCwgU1QtRXJpY3Nzb24KKyAqLworI2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+CisjaW5jbHVkZSA8
bmV0L21hYzgwMjExLmg+CisKKyNpbmNsdWRlICJxdWV1ZS5oIgorI2luY2x1ZGUgIndmeC5oIgor
I2luY2x1ZGUgInN0YS5oIgorI2luY2x1ZGUgImRhdGFfdHguaCIKKyNpbmNsdWRlICJ0cmFjZXMu
aCIKKwordm9pZCB3ZnhfdHhfbG9jayhzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKK3sKKwlhdG9taWNf
aW5jKCZ3ZGV2LT50eF9sb2NrKTsKK30KKwordm9pZCB3ZnhfdHhfdW5sb2NrKHN0cnVjdCB3Znhf
ZGV2ICp3ZGV2KQoreworCWludCB0eF9sb2NrID0gYXRvbWljX2RlY19yZXR1cm4oJndkZXYtPnR4
X2xvY2spOworCisJV0FSTih0eF9sb2NrIDwgMCwgImluY29uc2lzdGVudCB0eF9sb2NrIHZhbHVl
Iik7CisJaWYgKCF0eF9sb2NrKQorCQl3ZnhfYmhfcmVxdWVzdF90eCh3ZGV2KTsKK30KKwordm9p
ZCB3ZnhfdHhfZmx1c2goc3RydWN0IHdmeF9kZXYgKndkZXYpCit7CisJaW50IHJldDsKKworCS8v
IERvIG5vdCB3YWl0IGZvciBhbnkgcmVwbHkgaWYgY2hpcCBpcyBmcm96ZW4KKwlpZiAod2Rldi0+
Y2hpcF9mcm96ZW4pCisJCXJldHVybjsKKworCXdmeF90eF9sb2NrKHdkZXYpOworCW11dGV4X2xv
Y2soJndkZXYtPmhpZl9jbWQubG9jayk7CisJcmV0ID0gd2FpdF9ldmVudF90aW1lb3V0KHdkZXYt
PmhpZi50eF9idWZmZXJzX2VtcHR5LAorCQkJCSAhd2Rldi0+aGlmLnR4X2J1ZmZlcnNfdXNlZCwK
KwkJCQkgbXNlY3NfdG9famlmZmllcygzMDAwKSk7CisJaWYgKCFyZXQpIHsKKwkJZGV2X3dhcm4o
d2Rldi0+ZGV2LCAiY2Fubm90IGZsdXNoIHR4IGJ1ZmZlcnMgKCVkIHN0aWxsIGJ1c3kpXG4iLAor
CQkJIHdkZXYtPmhpZi50eF9idWZmZXJzX3VzZWQpOworCQl3ZnhfcGVuZGluZ19kdW1wX29sZF9m
cmFtZXMod2RldiwgMzAwMCk7CisJCS8vIEZJWE1FOiBkcm9wIHBlbmRpbmcgZnJhbWVzIGhlcmUK
KwkJd2Rldi0+Y2hpcF9mcm96ZW4gPSB0cnVlOworCX0KKwltdXRleF91bmxvY2soJndkZXYtPmhp
Zl9jbWQubG9jayk7CisJd2Z4X3R4X3VubG9jayh3ZGV2KTsKK30KKwordm9pZCB3ZnhfdHhfbG9j
a19mbHVzaChzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKK3sKKwl3ZnhfdHhfbG9jayh3ZGV2KTsKKwl3
ZnhfdHhfZmx1c2god2Rldik7Cit9CisKK3ZvaWQgd2Z4X3R4X3F1ZXVlc19pbml0KHN0cnVjdCB3
ZnhfdmlmICp3dmlmKQoreworCS8vIFRoZSBkZXZpY2UgaXMgaW4gY2hhcmdlIHRvIHJlc3BlY3Qg
dGhlIGRldGFpbHMgb2YgdGhlIFFvUyBwYXJhbWV0ZXJzLgorCS8vIFRoZSBkcml2ZXIganVzdCBl
bnN1cmUgdGhhdCBpdCByb3VnaHRseSByZXNwZWN0IHRoZSBwcmlvcml0aWVzIHRvCisJLy8gYXZv
aWQgYW55IHNob3J0YWdlLgorCWNvbnN0IGludCBwcmlvcml0aWVzW0lFRUU4MDIxMV9OVU1fQUNT
XSA9IHsgMSwgMiwgNjQsIDEyOCB9OworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IElFRUU4
MDIxMV9OVU1fQUNTOyArK2kpIHsKKwkJc2tiX3F1ZXVlX2hlYWRfaW5pdCgmd3ZpZi0+dHhfcXVl
dWVbaV0ubm9ybWFsKTsKKwkJc2tiX3F1ZXVlX2hlYWRfaW5pdCgmd3ZpZi0+dHhfcXVldWVbaV0u
Y2FiKTsKKwkJd3ZpZi0+dHhfcXVldWVbaV0ucHJpb3JpdHkgPSBwcmlvcml0aWVzW2ldOworCX0K
K30KKwordm9pZCB3ZnhfdHhfcXVldWVzX2NoZWNrX2VtcHR5KHN0cnVjdCB3ZnhfdmlmICp3dmlm
KQoreworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyArK2kp
IHsKKwkJV0FSTl9PTihhdG9taWNfcmVhZCgmd3ZpZi0+dHhfcXVldWVbaV0ucGVuZGluZ19mcmFt
ZXMpKTsKKwkJV0FSTl9PTighc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3dmlmLT50eF9xdWV1
ZVtpXS5ub3JtYWwpKTsKKwkJV0FSTl9PTighc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3dmlm
LT50eF9xdWV1ZVtpXS5jYWIpKTsKKwl9Cit9CisKK2Jvb2wgd2Z4X3R4X3F1ZXVlX2VtcHR5KHN0
cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSkKK3sKKwlyZXR1cm4g
c2tiX3F1ZXVlX2VtcHR5KCZxdWV1ZS0+bm9ybWFsKSAmJiBza2JfcXVldWVfZW1wdHkoJnF1ZXVl
LT5jYWIpOworfQorCitzdGF0aWMgdm9pZCBfX3dmeF90eF9xdWV1ZV9kcm9wKHN0cnVjdCB3Znhf
dmlmICp3dmlmLAorCQkJCXN0cnVjdCBza19idWZmX2hlYWQgKnNrYl9xdWV1ZSwKKwkJCQlzdHJ1
Y3Qgc2tfYnVmZl9oZWFkICpkcm9wcGVkKQoreworCXN0cnVjdCBza19idWZmICpza2IsICp0bXA7
CisKKwlzcGluX2xvY2tfYmgoJnNrYl9xdWV1ZS0+bG9jayk7CisJc2tiX3F1ZXVlX3dhbGtfc2Fm
ZShza2JfcXVldWUsIHNrYiwgdG1wKSB7CisJCV9fc2tiX3VubGluayhza2IsIHNrYl9xdWV1ZSk7
CisJCXNrYl9xdWV1ZV9oZWFkKGRyb3BwZWQsIHNrYik7CisJfQorCXNwaW5fdW5sb2NrX2JoKCZz
a2JfcXVldWUtPmxvY2spOworfQorCit2b2lkIHdmeF90eF9xdWV1ZV9kcm9wKHN0cnVjdCB3Znhf
dmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwKKwkJICAgICAgIHN0cnVjdCBza19i
dWZmX2hlYWQgKmRyb3BwZWQpCit7CisJX193ZnhfdHhfcXVldWVfZHJvcCh3dmlmLCAmcXVldWUt
PmNhYiwgZHJvcHBlZCk7CisJX193ZnhfdHhfcXVldWVfZHJvcCh3dmlmLCAmcXVldWUtPm5vcm1h
bCwgZHJvcHBlZCk7CisJd2FrZV91cCgmd3ZpZi0+d2Rldi0+dHhfZGVxdWV1ZSk7Cit9CisKK3Zv
aWQgd2Z4X3R4X3F1ZXVlc19wdXQoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZm
ICpza2IpCit7CisJc3RydWN0IHdmeF9xdWV1ZSAqcXVldWUgPSAmd3ZpZi0+dHhfcXVldWVbc2ti
X2dldF9xdWV1ZV9tYXBwaW5nKHNrYildOworCXN0cnVjdCBpZWVlODAyMTFfdHhfaW5mbyAqdHhf
aW5mbyA9IElFRUU4MDIxMV9TS0JfQ0Ioc2tiKTsKKworCWlmICh0eF9pbmZvLT5mbGFncyAmIElF
RUU4MDIxMV9UWF9DVExfU0VORF9BRlRFUl9EVElNKQorCQlza2JfcXVldWVfdGFpbCgmcXVldWUt
PmNhYiwgc2tiKTsKKwllbHNlCisJCXNrYl9xdWV1ZV90YWlsKCZxdWV1ZS0+bm9ybWFsLCBza2Ip
OworfQorCit2b2lkIHdmeF9wZW5kaW5nX2Ryb3Aoc3RydWN0IHdmeF9kZXYgKndkZXYsIHN0cnVj
dCBza19idWZmX2hlYWQgKmRyb3BwZWQpCit7CisJc3RydWN0IHdmeF9xdWV1ZSAqcXVldWU7CisJ
c3RydWN0IHdmeF92aWYgKnd2aWY7CisJc3RydWN0IGhpZl9tc2cgKmhpZjsKKwlzdHJ1Y3Qgc2tf
YnVmZiAqc2tiOworCisJV0FSTighd2Rldi0+Y2hpcF9mcm96ZW4sICIlcyBzaG91bGQgb25seSBi
ZSB1c2VkIHRvIHJlY292ZXIgYSBmcm96ZW4gZGV2aWNlIiwKKwkgICAgIF9fZnVuY19fKTsKKwl3
aGlsZSAoKHNrYiA9IHNrYl9kZXF1ZXVlKCZ3ZGV2LT50eF9wZW5kaW5nKSkgIT0gTlVMTCkgewor
CQloaWYgPSAoc3RydWN0IGhpZl9tc2cgKilza2ItPmRhdGE7CisJCXd2aWYgPSB3ZGV2X3RvX3d2
aWYod2RldiwgaGlmLT5pbnRlcmZhY2UpOworCQlpZiAod3ZpZikgeworCQkJcXVldWUgPSAmd3Zp
Zi0+dHhfcXVldWVbc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYildOworCQkJV0FSTl9PTihza2Jf
Z2V0X3F1ZXVlX21hcHBpbmcoc2tiKSA+IDMpOworCQkJV0FSTl9PTighYXRvbWljX3JlYWQoJnF1
ZXVlLT5wZW5kaW5nX2ZyYW1lcykpOworCQkJYXRvbWljX2RlYygmcXVldWUtPnBlbmRpbmdfZnJh
bWVzKTsKKwkJfQorCQlza2JfcXVldWVfaGVhZChkcm9wcGVkLCBza2IpOworCX0KK30KKworc3Ry
dWN0IHNrX2J1ZmYgKndmeF9wZW5kaW5nX2dldChzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwgdTMyIHBh
Y2tldF9pZCkKK3sKKwlzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZTsKKwlzdHJ1Y3QgaGlmX3JlcV90
eCAqcmVxOworCXN0cnVjdCB3ZnhfdmlmICp3dmlmOworCXN0cnVjdCBoaWZfbXNnICpoaWY7CisJ
c3RydWN0IHNrX2J1ZmYgKnNrYjsKKworCXNwaW5fbG9ja19iaCgmd2Rldi0+dHhfcGVuZGluZy5s
b2NrKTsKKwlza2JfcXVldWVfd2Fsaygmd2Rldi0+dHhfcGVuZGluZywgc2tiKSB7CisJCWhpZiA9
IChzdHJ1Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKKwkJcmVxID0gKHN0cnVjdCBoaWZfcmVxX3R4
ICopaGlmLT5ib2R5OworCQlpZiAocmVxLT5wYWNrZXRfaWQgIT0gcGFja2V0X2lkKQorCQkJY29u
dGludWU7CisJCXNwaW5fdW5sb2NrX2JoKCZ3ZGV2LT50eF9wZW5kaW5nLmxvY2spOworCQl3dmlm
ID0gd2Rldl90b193dmlmKHdkZXYsIGhpZi0+aW50ZXJmYWNlKTsKKwkJaWYgKHd2aWYpIHsKKwkJ
CXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVlW3NrYl9nZXRfcXVldWVfbWFwcGluZyhza2IpXTsKKwkJ
CVdBUk5fT04oc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYikgPiAzKTsKKwkJCVdBUk5fT04oIWF0
b21pY19yZWFkKCZxdWV1ZS0+cGVuZGluZ19mcmFtZXMpKTsKKwkJCWF0b21pY19kZWMoJnF1ZXVl
LT5wZW5kaW5nX2ZyYW1lcyk7CisJCX0KKwkJc2tiX3VubGluayhza2IsICZ3ZGV2LT50eF9wZW5k
aW5nKTsKKwkJcmV0dXJuIHNrYjsKKwl9CisJc3Bpbl91bmxvY2tfYmgoJndkZXYtPnR4X3BlbmRp
bmcubG9jayk7CisJV0FSTigxLCAiY2Fubm90IGZpbmQgcGFja2V0IGluIHBlbmRpbmcgcXVldWUi
KTsKKwlyZXR1cm4gTlVMTDsKK30KKwordm9pZCB3ZnhfcGVuZGluZ19kdW1wX29sZF9mcmFtZXMo
c3RydWN0IHdmeF9kZXYgKndkZXYsIHVuc2lnbmVkIGludCBsaW1pdF9tcykKK3sKKwlrdGltZV90
IG5vdyA9IGt0aW1lX2dldCgpOworCXN0cnVjdCB3ZnhfdHhfcHJpdiAqdHhfcHJpdjsKKwlzdHJ1
Y3QgaGlmX3JlcV90eCAqcmVxOworCXN0cnVjdCBza19idWZmICpza2I7CisJYm9vbCBmaXJzdCA9
IHRydWU7CisKKwlzcGluX2xvY2tfYmgoJndkZXYtPnR4X3BlbmRpbmcubG9jayk7CisJc2tiX3F1
ZXVlX3dhbGsoJndkZXYtPnR4X3BlbmRpbmcsIHNrYikgeworCQl0eF9wcml2ID0gd2Z4X3NrYl90
eF9wcml2KHNrYik7CisJCXJlcSA9IHdmeF9za2JfdHhyZXEoc2tiKTsKKwkJaWYgKGt0aW1lX2Fm
dGVyKG5vdywga3RpbWVfYWRkX21zKHR4X3ByaXYtPnhtaXRfdGltZXN0YW1wLAorCQkJCQkJICBs
aW1pdF9tcykpKSB7CisJCQlpZiAoZmlyc3QpIHsKKwkJCQlkZXZfaW5mbyh3ZGV2LT5kZXYsICJm
cmFtZXMgc3R1Y2sgaW4gZmlybXdhcmUgc2luY2UgJWRtcyBvciBtb3JlOlxuIiwKKwkJCQkJIGxp
bWl0X21zKTsKKwkJCQlmaXJzdCA9IGZhbHNlOworCQkJfQorCQkJZGV2X2luZm8od2Rldi0+ZGV2
LCAiICAgaWQgJTA4eCBzZW50ICVsbGRtcyBhZ29cbiIsCisJCQkJIHJlcS0+cGFja2V0X2lkLAor
CQkJCSBrdGltZV9tc19kZWx0YShub3csIHR4X3ByaXYtPnhtaXRfdGltZXN0YW1wKSk7CisJCX0K
Kwl9CisJc3Bpbl91bmxvY2tfYmgoJndkZXYtPnR4X3BlbmRpbmcubG9jayk7Cit9CisKK3Vuc2ln
bmVkIGludCB3ZnhfcGVuZGluZ19nZXRfcGt0X3VzX2RlbGF5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2
LAorCQkJCQkgIHN0cnVjdCBza19idWZmICpza2IpCit7CisJa3RpbWVfdCBub3cgPSBrdGltZV9n
ZXQoKTsKKwlzdHJ1Y3Qgd2Z4X3R4X3ByaXYgKnR4X3ByaXYgPSB3Znhfc2tiX3R4X3ByaXYoc2ti
KTsKKworCXJldHVybiBrdGltZV91c19kZWx0YShub3csIHR4X3ByaXYtPnhtaXRfdGltZXN0YW1w
KTsKK30KKworYm9vbCB3ZnhfdHhfcXVldWVzX2hhc19jYWIoc3RydWN0IHdmeF92aWYgKnd2aWYp
Cit7CisJaW50IGk7CisKKwlpZiAod3ZpZi0+dmlmLT50eXBlICE9IE5MODAyMTFfSUZUWVBFX0FQ
KQorCQlyZXR1cm4gZmFsc2U7CisJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyAr
K2kpCisJCS8vIE5vdGU6IHNpbmNlIG9ubHkgQVAgY2FuIGhhdmUgbWNhc3QgZnJhbWVzIGluIHF1
ZXVlIGFuZCBvbmx5CisJCS8vIG9uZSB2aWYgY2FuIGJlIEFQLCBhbGwgcXVldWVkIGZyYW1lcyBo
YXMgc2FtZSBpbnRlcmZhY2UgaWQKKwkJaWYgKCFza2JfcXVldWVfZW1wdHlfbG9ja2xlc3MoJnd2
aWYtPnR4X3F1ZXVlW2ldLmNhYikpCisJCQlyZXR1cm4gdHJ1ZTsKKwlyZXR1cm4gZmFsc2U7Cit9
CisKK3N0YXRpYyBpbnQgd2Z4X3R4X3F1ZXVlX2dldF93ZWlnaHQoc3RydWN0IHdmeF9xdWV1ZSAq
cXVldWUpCit7CisJcmV0dXJuIGF0b21pY19yZWFkKCZxdWV1ZS0+cGVuZGluZ19mcmFtZXMpICog
cXVldWUtPnByaW9yaXR5OworfQorCitzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKndmeF90eF9xdWV1
ZXNfZ2V0X3NrYihzdHJ1Y3Qgd2Z4X2RldiAqd2RldikKK3sKKwlzdHJ1Y3Qgd2Z4X3F1ZXVlICpx
dWV1ZXNbSUVFRTgwMjExX05VTV9BQ1MgKiBBUlJBWV9TSVpFKHdkZXYtPnZpZildOworCWludCBp
LCBqLCBudW1fcXVldWVzID0gMDsKKwlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZjsKKwlzdHJ1Y3QgaGlm
X21zZyAqaGlmOworCXN0cnVjdCBza19idWZmICpza2I7CisKKwkvLyBzb3J0IHRoZSBxdWV1ZXMK
Kwl3dmlmID0gTlVMTDsKKwl3aGlsZSAoKHd2aWYgPSB3dmlmX2l0ZXJhdGUod2Rldiwgd3ZpZikp
ICE9IE5VTEwpIHsKKwkJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyBpKyspIHsK
KwkJCVdBUk5fT04obnVtX3F1ZXVlcyA+PSBBUlJBWV9TSVpFKHF1ZXVlcykpOworCQkJcXVldWVz
W251bV9xdWV1ZXNdID0gJnd2aWYtPnR4X3F1ZXVlW2ldOworCQkJZm9yIChqID0gbnVtX3F1ZXVl
czsgaiA+IDA7IGotLSkKKwkJCQlpZiAod2Z4X3R4X3F1ZXVlX2dldF93ZWlnaHQocXVldWVzW2pd
KSA8CisJCQkJICAgIHdmeF90eF9xdWV1ZV9nZXRfd2VpZ2h0KHF1ZXVlc1tqIC0gMV0pKQorCQkJ
CQlzd2FwKHF1ZXVlc1tqIC0gMV0sIHF1ZXVlc1tqXSk7CisJCQludW1fcXVldWVzKys7CisJCX0K
Kwl9CisKKwl3dmlmID0gTlVMTDsKKwl3aGlsZSAoKHd2aWYgPSB3dmlmX2l0ZXJhdGUod2Rldiwg
d3ZpZikpICE9IE5VTEwpIHsKKwkJaWYgKCF3dmlmLT5hZnRlcl9kdGltX3R4X2FsbG93ZWQpCisJ
CQljb250aW51ZTsKKwkJZm9yIChpID0gMDsgaSA8IG51bV9xdWV1ZXM7IGkrKykgeworCQkJc2ti
ID0gc2tiX2RlcXVldWUoJnF1ZXVlc1tpXS0+Y2FiKTsKKwkJCWlmICghc2tiKQorCQkJCWNvbnRp
bnVlOworCQkJLy8gTm90ZTogc2luY2Ugb25seSBBUCBjYW4gaGF2ZSBtY2FzdCBmcmFtZXMgaW4g
cXVldWUKKwkJCS8vIGFuZCBvbmx5IG9uZSB2aWYgY2FuIGJlIEFQLCBhbGwgcXVldWVkIGZyYW1l
cyBoYXMKKwkJCS8vIHNhbWUgaW50ZXJmYWNlIGlkCisJCQloaWYgPSAoc3RydWN0IGhpZl9tc2cg
Kilza2ItPmRhdGE7CisJCQlXQVJOX09OKGhpZi0+aW50ZXJmYWNlICE9IHd2aWYtPmlkKTsKKwkJ
CVdBUk5fT04ocXVldWVzW2ldICE9CisJCQkJJnd2aWYtPnR4X3F1ZXVlW3NrYl9nZXRfcXVldWVf
bWFwcGluZyhza2IpXSk7CisJCQlhdG9taWNfaW5jKCZxdWV1ZXNbaV0tPnBlbmRpbmdfZnJhbWVz
KTsKKwkJCXRyYWNlX3F1ZXVlc19zdGF0cyh3ZGV2LCBxdWV1ZXNbaV0pOworCQkJcmV0dXJuIHNr
YjsKKwkJfQorCQkvLyBObyBtb3JlIG11bHRpY2FzdCB0byBzZW50CisJCXd2aWYtPmFmdGVyX2R0
aW1fdHhfYWxsb3dlZCA9IGZhbHNlOworCQlzY2hlZHVsZV93b3JrKCZ3dmlmLT51cGRhdGVfdGlt
X3dvcmspOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBudW1fcXVldWVzOyBpKyspIHsKKwkJc2ti
ID0gc2tiX2RlcXVldWUoJnF1ZXVlc1tpXS0+bm9ybWFsKTsKKwkJaWYgKHNrYikgeworCQkJYXRv
bWljX2luYygmcXVldWVzW2ldLT5wZW5kaW5nX2ZyYW1lcyk7CisJCQl0cmFjZV9xdWV1ZXNfc3Rh
dHMod2RldiwgcXVldWVzW2ldKTsKKwkJCXJldHVybiBza2I7CisJCX0KKwl9CisJcmV0dXJuIE5V
TEw7Cit9CisKK3N0cnVjdCBoaWZfbXNnICp3ZnhfdHhfcXVldWVzX2dldChzdHJ1Y3Qgd2Z4X2Rl
diAqd2RldikKK3sKKwlzdHJ1Y3Qgd2Z4X3R4X3ByaXYgKnR4X3ByaXY7CisJc3RydWN0IHNrX2J1
ZmYgKnNrYjsKKworCWlmIChhdG9taWNfcmVhZCgmd2Rldi0+dHhfbG9jaykpCisJCXJldHVybiBO
VUxMOworCXNrYiA9IHdmeF90eF9xdWV1ZXNfZ2V0X3NrYih3ZGV2KTsKKwlpZiAoIXNrYikKKwkJ
cmV0dXJuIE5VTEw7CisJc2tiX3F1ZXVlX3RhaWwoJndkZXYtPnR4X3BlbmRpbmcsIHNrYik7CisJ
d2FrZV91cCgmd2Rldi0+dHhfZGVxdWV1ZSk7CisJdHhfcHJpdiA9IHdmeF9za2JfdHhfcHJpdihz
a2IpOworCXR4X3ByaXYtPnhtaXRfdGltZXN0YW1wID0ga3RpbWVfZ2V0KCk7CisJcmV0dXJuIChz
dHJ1Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3dp
cmVsZXNzL3NpbGFicy93ZngvcXVldWUuaCBiL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93
ZngvcXVldWUuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjgwYmEx
OTQ1NWVmMwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93
ZngvcXVldWUuaApAQCAtMCwwICsxLDQ1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5ICovCisvKgorICogTygxKSBUWCBxdWV1ZSB3aXRoIGJ1aWx0LWluIGFsbG9j
YXRvci4KKyAqCisgKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAyMCwgU2lsaWNvbiBMYWJvcmF0b3Jp
ZXMsIEluYy4KKyAqIENvcHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KKyAqLworI2lmbmRl
ZiBXRlhfUVVFVUVfSAorI2RlZmluZSBXRlhfUVVFVUVfSAorCisjaW5jbHVkZSA8bGludXgvc2ti
dWZmLmg+CisjaW5jbHVkZSA8bGludXgvYXRvbWljLmg+CisKK3N0cnVjdCB3ZnhfZGV2Oworc3Ry
dWN0IHdmeF92aWY7CisKK3N0cnVjdCB3ZnhfcXVldWUgeworCXN0cnVjdCBza19idWZmX2hlYWQJ
bm9ybWFsOworCXN0cnVjdCBza19idWZmX2hlYWQJY2FiOyAvLyBDb250ZW50IEFmdGVyIChEVElN
KSBCZWFjb24KKwlhdG9taWNfdAkJcGVuZGluZ19mcmFtZXM7CisJaW50CQkJcHJpb3JpdHk7Cit9
OworCit2b2lkIHdmeF90eF9sb2NrKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKK3ZvaWQgd2Z4X3R4
X3VubG9jayhzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7Cit2b2lkIHdmeF90eF9mbHVzaChzdHJ1Y3Qg
d2Z4X2RldiAqd2Rldik7Cit2b2lkIHdmeF90eF9sb2NrX2ZsdXNoKHN0cnVjdCB3ZnhfZGV2ICp3
ZGV2KTsKKwordm9pZCB3ZnhfdHhfcXVldWVzX2luaXQoc3RydWN0IHdmeF92aWYgKnd2aWYpOwor
dm9pZCB3ZnhfdHhfcXVldWVzX2NoZWNrX2VtcHR5KHN0cnVjdCB3ZnhfdmlmICp3dmlmKTsKK2Jv
b2wgd2Z4X3R4X3F1ZXVlc19oYXNfY2FiKHN0cnVjdCB3ZnhfdmlmICp3dmlmKTsKK3ZvaWQgd2Z4
X3R4X3F1ZXVlc19wdXQoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBza19idWZmICpza2Ip
Oworc3RydWN0IGhpZl9tc2cgKndmeF90eF9xdWV1ZXNfZ2V0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2
KTsKKworYm9vbCB3ZnhfdHhfcXVldWVfZW1wdHkoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVj
dCB3ZnhfcXVldWUgKnF1ZXVlKTsKK3ZvaWQgd2Z4X3R4X3F1ZXVlX2Ryb3Aoc3RydWN0IHdmeF92
aWYgKnd2aWYsIHN0cnVjdCB3ZnhfcXVldWUgKnF1ZXVlLAorCQkgICAgICAgc3RydWN0IHNrX2J1
ZmZfaGVhZCAqZHJvcHBlZCk7CisKK3N0cnVjdCBza19idWZmICp3ZnhfcGVuZGluZ19nZXQoc3Ry
dWN0IHdmeF9kZXYgKndkZXYsIHUzMiBwYWNrZXRfaWQpOwordm9pZCB3ZnhfcGVuZGluZ19kcm9w
KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpkcm9wcGVkKTsKK3Vu
c2lnbmVkIGludCB3ZnhfcGVuZGluZ19nZXRfcGt0X3VzX2RlbGF5KHN0cnVjdCB3ZnhfZGV2ICp3
ZGV2LAorCQkJCQkgIHN0cnVjdCBza19idWZmICpza2IpOwordm9pZCB3ZnhfcGVuZGluZ19kdW1w
X29sZF9mcmFtZXMoc3RydWN0IHdmeF9kZXYgKndkZXYsIHVuc2lnbmVkIGludCBsaW1pdF9tcyk7
CisKKyNlbmRpZiAvKiBXRlhfUVVFVUVfSCAqLwotLSAKMi4yOC4wCgo=
