Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 5706652D3B3
	for <lists+netdev@lfdr.de>; Thu, 19 May 2022 15:15:01 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S233936AbiESNO7 (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Thu, 19 May 2022 09:14:59 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:45422 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S232830AbiESNO5 (ORCPT
        <rfc822;netdev@vger.kernel.org>); Thu, 19 May 2022 09:14:57 -0400
Received: from eu-smtp-delivery-151.mimecast.com (eu-smtp-delivery-151.mimecast.com [185.58.86.151])
        by lindbergh.monkeyblade.net (Postfix) with ESMTP id A24F9B41FA
        for <netdev@vger.kernel.org>; Thu, 19 May 2022 06:14:56 -0700 (PDT)
Received: from AcuMS.aculab.com (156.67.243.121 [156.67.243.121]) by
 relay.mimecast.com with ESMTP with STARTTLS (version=TLSv1.2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 uk-mta-215-asv0RXLKN2WYuIQcUO9Zhw-1; Thu, 19 May 2022 14:14:53 +0100
X-MC-Unique: asv0RXLKN2WYuIQcUO9Zhw-1
Received: from AcuMS.Aculab.com (fd9f:af1c:a25b:0:994c:f5c2:35d6:9b65) by
 AcuMS.aculab.com (fd9f:af1c:a25b:0:994c:f5c2:35d6:9b65) with Microsoft SMTP
 Server (TLS) id 15.0.1497.36; Thu, 19 May 2022 14:14:53 +0100
Received: from AcuMS.Aculab.com ([fe80::994c:f5c2:35d6:9b65]) by
 AcuMS.aculab.com ([fe80::994c:f5c2:35d6:9b65%12]) with mapi id
 15.00.1497.036; Thu, 19 May 2022 14:14:53 +0100
From:   David Laight <David.Laight@ACULAB.COM>
To:     'Pavan Chebbi' <pavan.chebbi@broadcom.com>
CC:     Michael Chan <michael.chan@broadcom.com>,
        Paolo Abeni <pabeni@redhat.com>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        "mchan@broadcom.com" <mchan@broadcom.com>,
        David Miller <davem@davemloft.net>
Subject: RE: tg3 dropping packets at high packet rates
Thread-Topic: tg3 dropping packets at high packet rates
Thread-Index: AdhqyKyabzDEQq15SKKGm31SHwTbKwAC24IAAAoYsMAABXOQgAASBiKAAAHW4wAABHST0A==
Date:   Thu, 19 May 2022 13:14:53 +0000
Message-ID: <f3d1d5bf11144b31b1b3959e95b04490@AcuMS.aculab.com>
References: <70a20d8f91664412ae91e401391e17cb@AcuMS.aculab.com>
 <6576c307ed554adb443e62a60f099266c95b55a7.camel@redhat.com>
 <153739175cf241a5895e6a5685a89598@AcuMS.aculab.com>
 <CACKFLinwh=YgPGPZ0M0dTJK1ar+SoPUZtYb5nBmLj6CNPdCQ2g@mail.gmail.com>
 <13d6579e9bc44dc2bfb73de8d9715b10@AcuMS.aculab.com>
 <CALs4sv1RxAbVid2f8EQF_kQkk48fd=8kcz2WbkTXRkwLbPLgwA@mail.gmail.com>
In-Reply-To: <CALs4sv1RxAbVid2f8EQF_kQkk48fd=8kcz2WbkTXRkwLbPLgwA@mail.gmail.com>
Accept-Language: en-GB, en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [10.202.205.107]
MIME-Version: 1.0
Authentication-Results: relay.mimecast.com;
        auth=pass smtp.auth=C51A453 smtp.mailfrom=david.laight@aculab.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: aculab.com
Content-Language: en-US
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_LOW,
        SPF_HELO_NONE,SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogUGF2YW4gQ2hlYmJpDQo+IFNlbnQ6IDE5IE1heSAyMDIyIDExOjIxDQouLi4NCj4gPg0K
PiA+ID4gUGxlYXNlIHNob3cgYSBzbmFwc2hvdCBvZiBhbGwgdGhlIGNvdW50ZXJzLiAgSW4gcGFy
dGljdWxhciwNCj4gPiA+IHJ4YmRzX2VtcHR5LCByeF9kaXNjYXJkcywgZXRjIHdpbGwgc2hvdyB3
aGV0aGVyIHRoZSBkcml2ZXIgaXMga2VlcGluZw0KPiA+ID4gdXAgd2l0aCBpbmNvbWluZyBSWCBw
YWNrZXRzIG9yIG5vdC4NCj4gPg0KPiA+IEFmdGVyIHJ1bm5pbmcgdGhlIHRlc3QgZm9yIGEgc2hv
cnQgdGltZS4NCj4gPiBUaGUgYXBwbGljYXRpb24gc3RhdHMgaW5kaWNhdGUgdGhhdCBhcm91bmQg
NDAwMDAgcGFja2V0cyBhcmUgbWlzc2luZy4NCj4gPg0KLi4uDQoNClNvbWUgbnVtYmVycyB0YWtl
biBhdCB0aGUgc2FtZSB0aW1lOg0KDQpBcHBsaWNhdGlvbiB0cmFjZSAtIGVhY2ggJ2dhcCcgaXMg
b25lIG9yIG1vcmUgbG9zdCBwYWNrZXRzLg0KVCswMDAwMDQ6ICBhbGwgZ2FwcyBzbyBmYXIgMTEw
NA0KVCswMDAwMDU6ICBhbGwgZ2FwcyBzbyBmYXIgMjE2NjQNClQrMDAwMDA2OiAgYWxsIGdhcHMg
c28gZmFyIDU0NjQ0DQpUKzAwMDAwNzogIGFsbCBnYXBzIHNvIGZhciA4NDY0MQ0KVCswMDAwMDg6
ICBhbGwgZ2FwcyBzbyBmYXIgMTEwMjMyDQpUKzAwMDAwOTogIGFsbCBnYXBzIHNvIGZhciAxMzEx
OTENClQrMDAwMDEwOiAgYWxsIGdhcHMgc28gZmFyIDE1MDI4Ng0KVCswMDAwMTE6ICBhbGwgZ2Fw
cyBzbyBmYXIgMTcxNTg4DQpUKzAwMDAxMjogIGFsbCBnYXBzIHNvIGZhciAxOTA3NzcNClQrMDAw
MDEzOiAgYWxsIGdhcHMgc28gZmFyIDIxMDc3MQ0KDQpyeF9wYWNrZXRzIGNvdW50ZWQgYnkgdGcz
X3J4KCkgYW5kIHJlYWQgZXZlcnkgc2Vjb25kLg0KNjMgMzQ0NDI2DQo2NCAzNDE3MzQNCjY1IDMz
ODc0MA0KNjYgMzM3OTk1DQo2NyAzMzk3NzANCjY4IDMzNjMxNA0KNjkgMzQwMDg3DQo3MCAzNDUw
ODQNCg0KQ3VtdWxhdGl2ZSBlcnJvciBjb3VudHMgc2luY2UgdGhlIGRyaXZlciB3YXMgbGFzdCBs
b2FkZWQuDQogICAgIHJ4YmRzX2VtcHR5OiAzMDk4Mw0KICAgICByeF9kaXNjYXJkczogMzEyMw0K
ICAgICBtYnVmX2x3bV90aHJlc2hfaGl0OiAzMTIzDQoNClRoZSBudW1iZXIgb2YgaW50ZXJydXB0
IGlzIGhpZ2ggLSBhYm91dCA0MDAwMC9zZWMuDQooSSd2ZSBub3QgZGVsdGFkIHRoZXNlLCBqdXN0
IHJlbW92ZWQgYWxsIHRoZSB6ZXJvcyBhbmQgcHJlZml4ZWQgdGhlDQpjcHUgbnVtYmVyIGJlZm9y
ZSBlYWNoIG5vbi16ZXJvIHZhbHVlLikNCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTIt
cngtMSA4OjEzIDE0OjIzNDc1NDUxNw0KODY6IElSLVBDSS1NU0kgMTA1MDYyNS1lZGdlIGVtMi1y
eC0xIDg6MTMgMTQ6MjM0NzY3OTQ1DQo4NjogSVItUENJLU1TSSAxMDUwNjI1LWVkZ2UgZW0yLXJ4
LTEgODoxMyAxNDoyMzQ4MDI1NTUNCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTItcngt
MSA4OjEzIDE0OjIzNDg0MzU0Mg0KODY6IElSLVBDSS1NU0kgMTA1MDYyNS1lZGdlIGVtMi1yeC0x
IDg6MTMgMTQ6MjM0ODg3OTYzDQo4NjogSVItUENJLU1TSSAxMDUwNjI1LWVkZ2UgZW0yLXJ4LTEg
ODoxMyAxNDoyMzQ5MjgyMDQNCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTItcngtMSA4
OjEzIDE0OjIzNDk2NjQyOA0KODY6IElSLVBDSS1NU0kgMTA1MDYyNS1lZGdlIGVtMi1yeC0xIDg6
MTMgMTQ6MjM1MDA5NTA1DQo4NjogSVItUENJLU1TSSAxMDUwNjI1LWVkZ2UgZW0yLXJ4LTEgODox
MyAxNDoyMzUwNTI3NDANCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTItcngtMSA4OjEz
IDE0OjIzNTA5MzI1NA0KODY6IElSLVBDSS1NU0kgMTA1MDYyNS1lZGdlIGVtMi1yeC0xIDg6MTMg
MTQ6MjM1MTMzMjk5DQo4NjogSVItUENJLU1TSSAxMDUwNjI1LWVkZ2UgZW0yLXJ4LTEgODoxMyAx
NDoyMzUxNzMxNTENCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTItcngtMSA4OjEzIDE0
OjIzNTIxMjM4Nw0KODY6IElSLVBDSS1NU0kgMTA1MDYyNS1lZGdlIGVtMi1yeC0xIDg6MTMgMTQ6
MjM1MjUyNDAzDQo4NjogSVItUENJLU1TSSAxMDUwNjI1LWVkZ2UgZW0yLXJ4LTEgODoxMyAxNDoy
MzUzMTc5MjgNCjg2OiBJUi1QQ0ktTVNJIDEwNTA2MjUtZWRnZSBlbTItcngtMSA4OjEzIDE0OjIz
NTM3MTMwMQ0KDQpSU1MgaXMgZW5hYmxlZCwgYnV0IEkndmUgdXNlZCBldGh0b29sIC1YIGVxdWFs
IDEgdG8NCnB1dCBldmVyeXRoaW5nIHRocm91Z2ggcmluZyAwLg0KQ3B1IDE0IGlzIHN0aWxsIDI1
JSBpZGxlIC0gdGhhdCBpcyB0aGUgYnVzaWVzdCBjcHUuDQoNCkkndmUgZGlzY292ZXJlZCB0aGF0
IHRoZSAnbG9zdCBwYWNrZXQnIHJhdGUgZG9lcyBkZXBlbmQgb24NCnRoZSBudW1iZXIgb2Ygcngg
YnVmZmVycyBjb25maWd1cmVkIHdpdGggJ2V0aHRvb2wgLUcgZW0yIHJ4IG5ubm4nLg0KVGhlIHRy
YWNlcyBhYm92ZSBhcmUgd2l0aCAxMDAwIHJ4IGJ1ZmZlcnMuDQoNCkknbSBhbHNvIHNsaWdodGx5
IGNvbmZ1c2VkIGFib3V0IHRoZSByZWNlaXZlIGJ1ZmZlcnMuDQpBcyBJIHJlYWQgdGhlIGNvZGUg
dGhlIGZvbGxvd2luZyBoYXBwZW5zOg0KDQpJZ25vcmluZyBqdW1ibyBidWZmZXJzIC0gd2hpY2gg
SSBkb24ndCBoYXZlIGNvbmZpZ3VyZWQuDQpBRkFJQ1QgYWxsIHRoZSByaW5ncyBoYXZlIDIwNDgg
ZW50cmllcy4NCldpdGggUlNTIHRoZXJlIGFyZSA0IHBhaXJzIG9mIHJpbmdzLCBvbmUgY29udGFp
bnMgKGZyZWUpIGJ1ZmZlcnMNCnRoZSBvdGhlciByZWNlaXZlIGRhdGEgc3RhdHVzLg0KVGhlIHJl
Y2VpdmUgY29kZSBwcm9jZXNzZXMgYW4gZW50cnkgZnJvbSB0aGUgc3RhdHVzIHJpbmcNCmFuZCBw
dXRzIGEgYnVmZmVyIGJhY2sgb250byB0aGUgY29ycmVzcG9uZGluZyBidWZmZXJzIHJpbmcuDQpT
aW5jZSB0aGUgaGFyZHdhcmUgb25seSB0YWtlcyBidWZmZXJzIGZyb20gb25lIHJpbmcsIHRoZQ0K
ZHJpdmVyIG1vdmVzIGFsbCB0aGUgZnJlZSBidWZmZXJzIGZyb20gcmluZ3MgMS0zIG9udG8gcmlu
ZyAwLg0KDQpXaGVuIHRoZSByaW5ncyBhcmUgYWxsb2NhdGVkIEkgdGhpbmsgdGhhdCBidWZmZXJz
IChkZWZhdWx0IDIwMCkNCmFyZSBhZGRlZCB0byBhbGwgNCByaW5ncy4NCkFzIHNvb24gYXMgdGhl
ICduYXBpJyBjb2RlIGZvciByaW5nIDAgcnVucyBpdCBjb2xsZWN0cyB0aGUNCm90aGVyIDYwMCBi
dWZmZXJzIGFuZCBwdXRzIHRoZW0gb24gaXRzIG93biAoZnJlZSkgYnVmZmVyIHJpbmcuDQpUaGlz
IHNlZW1zIHRvIG1ha2UgYWxsIDgwMCBidWZmZXJzIGF2YWlsYWJsZSBmb3IgYW55IG9mIHRoZSBS
U1MNCmNoYW5uZWxzLg0KDQpOb3cgaWYgSSBjb25maWd1cmUgJ2V0aHRvb2wgLUcgZW0yIHJ4IDIw
MDAnIGEgdG90YWwgb2YgODAwMA0KcmVjZWl2ZSBidWZmZXJzIGFyZSBhbGxvY2F0ZWQuDQpPbmx5
IDIwNDcgd2lsbCBmaXQgaW50byByaW5nWzBdIHNvIHRoZSBvdGhlciAnYnVmZmVyJyByaW5ncw0K
c3RpbGwgY29udGFpbiBidWZmZXJzLg0KTm93IGlmIEkgcmVjZWl2ZSB0cmFmZmljIHRoYXQgZ29l
cyB0byByaW5nWzNdIHRoZSBmcmVlIGJ1ZmZlcg0KcmluZ1szXSB3aWxsIHdyYXAgLSBkaXNjYXJk
aW5nIDIwNDggYnVmZmVycy4NCg0KSSdtIGFzc3VtaW5nIEkndmUgbWlzc2VkIHNvbWV0aGluZz8N
Cg0KVGhpcyBiaXQgb2YgY29kZSBpbiB0ZzNfcngoKSBhbHNvIGxvb2tzIGJ1Z2d5Og0KDQogICAg
ICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJ4X3N0ZF9wb3N0ZWQgPj0gdHAtPnJ4X3N0ZF9tYXhf
cG9zdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRwci0+cnhfc3RkX3Byb2RfaWR4ID0g
c3RkX3Byb2RfaWR4ICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdHAtPnJ4X3N0ZF9yaW5nX21hc2s7DQogICAgICAgICAgICAgICAgICAgICAgICB0dzMy
X3J4X21ib3goVEczX1JYX1NURF9QUk9EX0lEWF9SRUcsDQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdHByLT5yeF9zdGRfcHJvZF9pZHgpOw0KICAgICAgICAgICAgICAgICAg
ICAgICAgd29ya19tYXNrICY9IH5SWERfT1BBUVVFX1JJTkdfU1REOw0KICAgICAgICAgICAgICAg
ICAgICAgICAgcnhfc3RkX3Bvc3RlZCA9IDA7DQogICAgICAgICAgICAgICAgfQ0KDQpDbGVhcmlu
ZyB3b3JrX21hc2sgc3RvcHMgbmFwaVswXSBiZWluZyBydW4gdG8gbW92ZQ0KdGhlIGZyZWVkIGJ1
ZmZlcnMgYWNyb3NzLg0KKEkgZG9uJ3QgdGhpbmsgSSBoYXZlIHRoZSBoYXJkd2FyZSB0aGF0IGdv
ZXMgdGhyb3VnaCB0aGF0IGJpdC4pDQoNCglEYXZpZA0KDQotDQpSZWdpc3RlcmVkIEFkZHJlc3Mg
TGFrZXNpZGUsIEJyYW1sZXkgUm9hZCwgTW91bnQgRmFybSwgTWlsdG9uIEtleW5lcywgTUsxIDFQ
VCwgVUsNClJlZ2lzdHJhdGlvbiBObzogMTM5NzM4NiAoV2FsZXMpDQo=

