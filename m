Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 40F2319F467
	for <lists+netdev@lfdr.de>; Mon,  6 Apr 2020 13:19:35 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727903AbgDFLSy (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Mon, 6 Apr 2020 07:18:54 -0400
Received: from mail-dm6nam11on2071.outbound.protection.outlook.com ([40.107.223.71]:6126
        "EHLO NAM11-DM6-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727856AbgDFLSw (ORCPT <rfc822;netdev@vger.kernel.org>);
        Mon, 6 Apr 2020 07:18:52 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Hm7n/ZbD7bdti+43lEJvw9xMB5gO8Gm//WiQW9AIaXIeT5XpRq+4PgWqzVI5OEAOg0bma5FGETdnC5yZobC8cJt3zlGFrg2k2DRtQ/0LW4CgGcM7KIZO5etUh/iYGAbvfv/igxKljHvzCdGWM0vCKw/OXGxEyoJo1gDzt/6C9QdBy9/rwt01aG8OMiJh1u++4C8VgS7OWcKQUfoOhGc06Zs7CBiwS4TPpGtmiac3ht1t1teJKCUO3etPaEs+UZXppF4wE488EdooPuOVya3mZKrsKMDH0QplMuRXHbtw+Q/jJo2N+Gwo3ZNhzdgbGnV79dE1HaYPCS8oo21diyLMOA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=UU3n3JoJ+SbA4C2MRlm7G7g8hARTCvaoZPS/J2DUp5U=;
 b=K2WiyLI1K0R3TVlcMrJUJyp43UkdMw98yDETdWpHn2FC5f0EfveDY4AIL4hdDeOe4+tBQtJNAga4bBbh0adO88T5n9uSFV+tKutK/X4Z3C3/FeUIlQykzwXrQJy2OxwcYp7TFn9fU5L09dOvahpiqFTqdszpGF4Z1KviM8C9dFk2YAtFhjIk3Es++f9cq2VVoR5lzXF/Nk3AUdtF/W2t/diDVi+nQozfHEB2oDdAh5xskFbVLvQGMXfnStSXdek/7YMgSd5K8si3SIA8SB8Z+begw9opWbX5MQ9wzHMLravDr+RdcL7XLErYU0b7BEHTSdfIG2wYPmWwiQXqlAP6kA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=UU3n3JoJ+SbA4C2MRlm7G7g8hARTCvaoZPS/J2DUp5U=;
 b=NQFgkhm4ikp7r19ldLdotQhmmCQB7EYZ1/k4USLriU0cqEPuc6yM4cJiEZqH8yZ9MjSO5z6j7STNvCX5+tc4ZYAsVizZehz1BWHFtviJAfJeWaS1eze8SfdgoshWAuMXRnpKBt1JA+ZNqbkKOugl6oOox7osOHMWfMRNtwebby4=
Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Jerome.Pouiller@silabs.com; 
Received: from BN6PR11MB4052.namprd11.prod.outlook.com (2603:10b6:405:7a::37)
 by BN6PR11MB3860.namprd11.prod.outlook.com (2603:10b6:405:77::14) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2878.15; Mon, 6 Apr
 2020 11:18:30 +0000
Received: from BN6PR11MB4052.namprd11.prod.outlook.com
 ([fe80::e0af:e9de:ffce:7376]) by BN6PR11MB4052.namprd11.prod.outlook.com
 ([fe80::e0af:e9de:ffce:7376%3]) with mapi id 15.20.2878.018; Mon, 6 Apr 2020
 11:18:30 +0000
From:   Jerome Pouiller <Jerome.Pouiller@silabs.com>
To:     devel@driverdev.osuosl.org, linux-wireless@vger.kernel.org
Cc:     netdev@vger.kernel.org, linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Kalle Valo <kvalo@codeaurora.org>,
        "David S . Miller" <davem@davemloft.net>,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH 08/11] staging: wfx: place hif_tx_mib functions into a .c file
Date:   Mon,  6 Apr 2020 13:17:53 +0200
Message-Id: <20200406111756.154086-9-Jerome.Pouiller@silabs.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200406111756.154086-1-Jerome.Pouiller@silabs.com>
References: <20200406111756.154086-1-Jerome.Pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-ClientProxiedBy: DM5PR05CA0010.namprd05.prod.outlook.com
 (2603:10b6:3:d4::20) To BN6PR11MB4052.namprd11.prod.outlook.com
 (2603:10b6:405:7a::37)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from pc-42.silabs.com (2a01:e35:2435:66a0:544b:f17b:7ae8:fb7) by DM5PR05CA0010.namprd05.prod.outlook.com (2603:10b6:3:d4::20) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2900.13 via Frontend Transport; Mon, 6 Apr 2020 11:18:28 +0000
X-Mailer: git-send-email 2.25.1
X-Originating-IP: [2a01:e35:2435:66a0:544b:f17b:7ae8:fb7]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 9d099b49-052b-4cd5-2c29-08d7da1c3c66
X-MS-TrafficTypeDiagnostic: BN6PR11MB3860:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <BN6PR11MB38605779ADAB372D8CCF21F293C20@BN6PR11MB3860.namprd11.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:5236;
X-Forefront-PRVS: 0365C0E14B
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:BN6PR11MB4052.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFTY:;SFS:(10009020)(396003)(39850400004)(346002)(366004)(136003)(376002)(186003)(16526019)(7696005)(52116002)(36756003)(5660300002)(107886003)(316002)(54906003)(66946007)(66476007)(4326008)(2616005)(66556008)(1076003)(66574012)(81166006)(6666004)(6486002)(8936002)(2906002)(86362001)(30864003)(81156014)(8676002)(478600001)(142923001);DIR:OUT;SFP:1101;
Received-SPF: None (protection.outlook.com: silabs.com does not designate
 permitted sender hosts)
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: tgQ7MRfeofsEY2VQPS7k6XwiN+CISfrkYOIKLi/WKWJpyB0az3zJSToawA8BEUkilcC5Pwvu4OYZvzQPCy6YmVi/X1oYuEFY63ALeLwkjWt20ofitZDlzZWyy1ujqjIS0DRBqEMX0WxeL/5mBFqMYVUnXWkloQKdyG8+Db42bn2HzFAqH6brwEpYFxHscXQK+prO5nKJ+kx81wlISpx01V5wOCGJEwJsC57rLQPCejPVfsgtPLo6jLu1XX5H/MgUITrifS5vAyZrC3ceOMigFBgbLbXlXQiDRynaaiO1PIX0k7L3/nT9/N5zj824w6ABO6M9tFfXY4JB4nZyF/eDZr9pJYNFKmJI7so0/oXOAcXMV8KTq8yvJNV8I7JqCQJyFyVQmBDYbxzDlRnzex7nzk4h62/Uvexk+M/WkZhtwvt2fZ3OgKKjr+FFJ71H3GqXMHZlplf+l3FX6JgO28RyPWGKgSSvP12nCftB99Yxv6Iq45BH/HvY1sNR5VcqtB0y
X-MS-Exchange-AntiSpam-MessageData: 3vNPSD3yKusk13sx1ikEyCR2p1goxg0SPjqtn1UB4v3PTg64lNLrYrwjrVPHjBHm37f4ZCkvlf59dWw01R76a2KrWyP+cKtoDM31IZtI8mczqtuCQNfFp2+g0wLaPtg7H4ZveraRPBpE9XeyK1woqVMoHPI8pVp+aePxmuUVdjO61p2FK1zlazkb15e3ehFh3Oxft4/Ip5sUHd0BXMvVlg==
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 9d099b49-052b-4cd5-2c29-08d7da1c3c66
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 06 Apr 2020 11:18:30.6781
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: VAAJC36TWMfe96O3s023SOd/19hGHocmejwvhoAsakoNl2pjbH1hF4XYFovshunk3I5ltRZKPGCJhP+ReCcz2g==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN6PR11MB3860
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKVW50
aWwgbm93LCBhbGwgZnVuY3Rpb25zIGZyb20gaGlmX3R4X21pYi5oIGFyZSBkZWNsYXJlZCAic3Rh
dGljIGlubGluZSIuCkhvd2V2ZXIsIHRoZXkgYXJlIG5vdCB0aW1lIGNyaXRpY2FsLiBTbywgaXQg
ZG9lcyBub3QgbWFrZSBzbyBtdWNoIHNlbnNlLgoKV2UgcHJlZmVyIHRvIHBsYWNlIHRoZW0gaW4g
YSAuYyBmaWxlIGFzIGZvciBvdGhlciBoaWYgZnVuY3Rpb25zLgoKU2lnbmVkLW9mZi1ieTogSsOp
csO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgotLS0KIGRyaXZlcnMv
c3RhZ2luZy93ZngvTWFrZWZpbGUgICAgIHwgICAxICsKIGRyaXZlcnMvc3RhZ2luZy93ZngvZGF0
YV90eC5jICAgIHwgICAxICsKIGRyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3R4X21pYi5jIHwgMzk2
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3R4
X21pYi5oIHwgNDM1ICsrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3Rh
Z2luZy93Zngva2V5LmMgICAgICAgIHwgICAxICsKIGRyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMg
ICAgICAgIHwgICAxICsKIDYgZmlsZXMgY2hhbmdlZCwgNDQ0IGluc2VydGlvbnMoKyksIDM5MSBk
ZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90
eF9taWIuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93ZngvTWFrZWZpbGUgYi9kcml2
ZXJzL3N0YWdpbmcvd2Z4L01ha2VmaWxlCmluZGV4IDBkOWMxZWQwOTJmNi4uMGUwY2M5ODJjZWFi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L01ha2VmaWxlCisrKyBiL2RyaXZlcnMv
c3RhZ2luZy93ZngvTWFrZWZpbGUKQEAgLTcsNiArNyw3IEBAIHdmeC15IDo9IFwKIAliaC5vIFwK
IAlod2lvLm8gXAogCWZ3aW8ubyBcCisJaGlmX3R4X21pYi5vIFwKIAloaWZfdHgubyBcCiAJaGlm
X3J4Lm8gXAogCXF1ZXVlLm8gXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRh
X3R4LmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2RhdGFfdHguYwppbmRleCBhMzRmNjIzMWI4Nzgu
LmMzMGU0ZjViNmUyZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmMK
KysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmMKQEAgLTYsNiArNiw3IEBACiAgKiBD
b3B5cmlnaHQgKGMpIDIwMTAsIFNULUVyaWNzc29uCiAgKi8KICNpbmNsdWRlIDxuZXQvbWFjODAy
MTEuaD4KKyNpbmNsdWRlIDxsaW51eC9ldGhlcmRldmljZS5oPgogCiAjaW5jbHVkZSAiZGF0YV90
eC5oIgogI2luY2x1ZGUgIndmeC5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9o
aWZfdHhfbWliLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L2hpZl90eF9taWIuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjViY2ExZTA2OTk1ZgotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3R4X21pYi5jCkBAIC0wLDAgKzEsMzk2IEBA
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogSW1wbGVt
ZW50YXRpb24gb2YgaG9zdC10by1jaGlwIE1JQnMgb2YgV0Z4eHggU3BsaXQgTWFjIChXU00pIEFQ
SS4KKyAqCisgKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOSwgU2lsaWNvbiBMYWJvcmF0b3JpZXMs
IEluYy4KKyAqIENvcHlyaWdodCAoYykgMjAxMCwgU1QtRXJpY3Nzb24KKyAqIENvcHlyaWdodCAo
QykgMjAxMCwgU1QtRXJpY3Nzb24gU0EKKyAqLworCisjaW5jbHVkZSA8bGludXgvZXRoZXJkZXZp
Y2UuaD4KKworI2luY2x1ZGUgIndmeC5oIgorI2luY2x1ZGUgImhpZl90eC5oIgorI2luY2x1ZGUg
ImhpZl90eF9taWIuaCIKKyNpbmNsdWRlICJoaWZfYXBpX21pYi5oIgorCitpbnQgaGlmX3NldF9v
dXRwdXRfcG93ZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCB2YWwpCit7CisJc3RydWN0IGhp
Zl9taWJfY3VycmVudF90eF9wb3dlcl9sZXZlbCBhcmcgPSB7CisJCS5wb3dlcl9sZXZlbCA9IGNw
dV90b19sZTMyKHZhbCAqIDEwKSwKKwl9OworCisJcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+
d2Rldiwgd3ZpZi0+aWQsCisJCQkgICAgIEhJRl9NSUJfSURfQ1VSUkVOVF9UWF9QT1dFUl9MRVZF
TCwKKwkJCSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgaGlmX3NldF9iZWFjb25f
d2FrZXVwX3BlcmlvZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJCQkgdW5zaWduZWQgaW50IGR0
aW1faW50ZXJ2YWwsCisJCQkJIHVuc2lnbmVkIGludCBsaXN0ZW5faW50ZXJ2YWwpCit7CisJc3Ry
dWN0IGhpZl9taWJfYmVhY29uX3dha2VfdXBfcGVyaW9kIHZhbCA9IHsKKwkJLndha2V1cF9wZXJp
b2RfbWluID0gZHRpbV9pbnRlcnZhbCwKKwkJLnJlY2VpdmVfZHRpbSA9IDAsCisJCS53YWtldXBf
cGVyaW9kX21heCA9IGNwdV90b19sZTE2KGxpc3Rlbl9pbnRlcnZhbCksCisJfTsKKworCWlmIChk
dGltX2ludGVydmFsID4gMHhGRiB8fCBsaXN0ZW5faW50ZXJ2YWwgPiAweEZGRkYpCisJCXJldHVy
biAtRUlOVkFMOworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAor
CQkJICAgICBISUZfTUlCX0lEX0JFQUNPTl9XQUtFVVBfUEVSSU9ELAorCQkJICAgICAmdmFsLCBz
aXplb2YodmFsKSk7Cit9CisKK2ludCBoaWZfc2V0X3JjcGlfcnNzaV90aHJlc2hvbGQoc3RydWN0
IHdmeF92aWYgKnd2aWYsCisJCQkJaW50IHJzc2lfdGhvbGQsIGludCByc3NpX2h5c3QpCit7CisJ
c3RydWN0IGhpZl9taWJfcmNwaV9yc3NpX3RocmVzaG9sZCBhcmcgPSB7CisJCS5yb2xsaW5nX2F2
ZXJhZ2VfY291bnQgPSA4LAorCQkuZGV0ZWN0aW9uID0gMSwKKwl9OworCisJaWYgKCFyc3NpX3Ro
b2xkICYmICFyc3NpX2h5c3QpIHsKKwkJYXJnLnVwcGVydGhyZXNoID0gMTsKKwkJYXJnLmxvd2Vy
dGhyZXNoID0gMTsKKwl9IGVsc2UgeworCQlhcmcudXBwZXJfdGhyZXNob2xkID0gcnNzaV90aG9s
ZCArIHJzc2lfaHlzdDsKKwkJYXJnLnVwcGVyX3RocmVzaG9sZCA9IChhcmcudXBwZXJfdGhyZXNo
b2xkICsgMTEwKSAqIDI7CisJCWFyZy5sb3dlcl90aHJlc2hvbGQgPSByc3NpX3Rob2xkOworCQlh
cmcubG93ZXJfdGhyZXNob2xkID0gKGFyZy5sb3dlcl90aHJlc2hvbGQgKyAxMTApICogMjsKKwl9
CisKKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJCSAgICAg
SElGX01JQl9JRF9SQ1BJX1JTU0lfVEhSRVNIT0xELCAmYXJnLCBzaXplb2YoYXJnKSk7Cit9CisK
K2ludCBoaWZfZ2V0X2NvdW50ZXJzX3RhYmxlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAorCQkJICAg
c3RydWN0IGhpZl9taWJfZXh0ZW5kZWRfY291bnRfdGFibGUgKmFyZykKK3sKKwlpZiAod2Z4X2Fw
aV9vbGRlcl90aGFuKHdkZXYsIDEsIDMpKSB7CisJCS8vIGV4dGVuZGVkX2NvdW50X3RhYmxlIGlz
IHdpZGVyIHRoYW4gY291bnRfdGFibGUKKwkJbWVtc2V0KGFyZywgMHhGRiwgc2l6ZW9mKCphcmcp
KTsKKwkJcmV0dXJuIGhpZl9yZWFkX21pYih3ZGV2LCAwLCBISUZfTUlCX0lEX0NPVU5URVJTX1RB
QkxFLAorCQkJCSAgICBhcmcsIHNpemVvZihzdHJ1Y3QgaGlmX21pYl9jb3VudF90YWJsZSkpOwor
CX0gZWxzZSB7CisJCXJldHVybiBoaWZfcmVhZF9taWIod2RldiwgMCwKKwkJCQkgICAgSElGX01J
Ql9JRF9FWFRFTkRFRF9DT1VOVEVSU19UQUJMRSwgYXJnLAorCQkJCXNpemVvZihzdHJ1Y3QgaGlm
X21pYl9leHRlbmRlZF9jb3VudF90YWJsZSkpOworCX0KK30KKworaW50IGhpZl9zZXRfbWFjYWRk
cihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdTggKm1hYykKK3sKKwlzdHJ1Y3QgaGlmX21pYl9tYWNf
YWRkcmVzcyBtc2cgPSB7IH07CisKKwlpZiAobWFjKQorCQlldGhlcl9hZGRyX2NvcHkobXNnLm1h
Y19hZGRyLCBtYWMpOworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlk
LCBISUZfTUlCX0lEX0RPVDExX01BQ19BRERSRVNTLAorCQkJICAgICAmbXNnLCBzaXplb2YobXNn
KSk7Cit9CisKK2ludCBoaWZfc2V0X3J4X2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJ
ICAgICAgYm9vbCBmaWx0ZXJfYnNzaWQsIGJvb2wgZndkX3Byb2JlX3JlcSkKK3sKKwlzdHJ1Y3Qg
aGlmX21pYl9yeF9maWx0ZXIgdmFsID0geyB9OworCisJaWYgKGZpbHRlcl9ic3NpZCkKKwkJdmFs
LmJzc2lkX2ZpbHRlciA9IDE7CisJaWYgKGZ3ZF9wcm9iZV9yZXEpCisJCXZhbC5md2RfcHJvYmVf
cmVxID0gMTsKKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElG
X01JQl9JRF9SWF9GSUxURVIsCisJCQkgICAgICZ2YWwsIHNpemVvZih2YWwpKTsKK30KKworaW50
IGhpZl9zZXRfYmVhY29uX2ZpbHRlcl90YWJsZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJCQlp
bnQgdGJsX2xlbiwgc3RydWN0IGhpZl9pZV90YWJsZV9lbnRyeSAqdGJsKQoreworCWludCByZXQ7
CisJc3RydWN0IGhpZl9taWJfYmNuX2ZpbHRlcl90YWJsZSAqdmFsOworCWludCBidWZfbGVuID0g
c3RydWN0X3NpemUodmFsLCBpZV90YWJsZSwgdGJsX2xlbik7CisKKwl2YWwgPSBremFsbG9jKGJ1
Zl9sZW4sIEdGUF9LRVJORUwpOworCWlmICghdmFsKQorCQlyZXR1cm4gLUVOT01FTTsKKwl2YWwt
Pm51bV9vZl9pbmZvX2VsbXRzID0gY3B1X3RvX2xlMzIodGJsX2xlbik7CisJbWVtY3B5KHZhbC0+
aWVfdGFibGUsIHRibCwgdGJsX2xlbiAqIHNpemVvZigqdGJsKSk7CisJcmV0ID0gaGlmX3dyaXRl
X21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJCSAgICBISUZfTUlCX0lEX0JFQUNPTl9GSUxU
RVJfVEFCTEUsIHZhbCwgYnVmX2xlbik7CisJa2ZyZWUodmFsKTsKKwlyZXR1cm4gcmV0OworfQor
CitpbnQgaGlmX2JlYWNvbl9maWx0ZXJfY29udHJvbChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJ
CSAgICAgIGludCBlbmFibGUsIGludCBiZWFjb25fY291bnQpCit7CisJc3RydWN0IGhpZl9taWJf
YmNuX2ZpbHRlcl9lbmFibGUgYXJnID0geworCQkuZW5hYmxlID0gY3B1X3RvX2xlMzIoZW5hYmxl
KSwKKwkJLmJjbl9jb3VudCA9IGNwdV90b19sZTMyKGJlYWNvbl9jb3VudCksCisJfTsKKwlyZXR1
cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJCSAgICAgSElGX01JQl9J
RF9CRUFDT05fRklMVEVSX0VOQUJMRSwKKwkJCSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOworfQor
CitpbnQgaGlmX3NldF9vcGVyYXRpb25hbF9tb2RlKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBlbnVt
IGhpZl9vcF9wb3dlcl9tb2RlIG1vZGUpCit7CisJc3RydWN0IGhpZl9taWJfZ2xfb3BlcmF0aW9u
YWxfcG93ZXJfbW9kZSB2YWwgPSB7CisJCS5wb3dlcl9tb2RlID0gbW9kZSwKKwkJLnd1cF9pbmRf
YWN0aXZhdGlvbiA9IDEsCisJfTsKKworCXJldHVybiBoaWZfd3JpdGVfbWliKHdkZXYsIC0xLCBI
SUZfTUlCX0lEX0dMX09QRVJBVElPTkFMX1BPV0VSX01PREUsCisJCQkgICAgICZ2YWwsIHNpemVv
Zih2YWwpKTsKK30KKworaW50IGhpZl9zZXRfdGVtcGxhdGVfZnJhbWUoc3RydWN0IHdmeF92aWYg
Knd2aWYsIHN0cnVjdCBza19idWZmICpza2IsCisJCQkgICB1OCBmcmFtZV90eXBlLCBpbnQgaW5p
dF9yYXRlKQoreworCXN0cnVjdCBoaWZfbWliX3RlbXBsYXRlX2ZyYW1lICphcmc7CisKKwlza2Jf
cHVzaChza2IsIDQpOworCWFyZyA9IChzdHJ1Y3QgaGlmX21pYl90ZW1wbGF0ZV9mcmFtZSAqKXNr
Yi0+ZGF0YTsKKwlza2JfcHVsbChza2IsIDQpOworCWFyZy0+aW5pdF9yYXRlID0gaW5pdF9yYXRl
OworCWFyZy0+ZnJhbWVfdHlwZSA9IGZyYW1lX3R5cGU7CisJYXJnLT5mcmFtZV9sZW5ndGggPSBj
cHVfdG9fbGUxNihza2ItPmxlbik7CisJcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwg
d3ZpZi0+aWQsIEhJRl9NSUJfSURfVEVNUExBVEVfRlJBTUUsCisJCQkgICAgIGFyZywgc2l6ZW9m
KCphcmcpKTsKK30KKworaW50IGhpZl9zZXRfbWZwKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29s
IGNhcGFibGUsIGJvb2wgcmVxdWlyZWQpCit7CisJc3RydWN0IGhpZl9taWJfcHJvdGVjdGVkX21n
bXRfcG9saWN5IHZhbCA9IHsgfTsKKworCVdBUk4ocmVxdWlyZWQgJiYgIWNhcGFibGUsICJpbmNv
aGVyZW50IGFyZ3VtZW50cyIpOworCWlmIChjYXBhYmxlKSB7CisJCXZhbC5wbWZfZW5hYmxlID0g
MTsKKwkJdmFsLmhvc3RfZW5jX2F1dGhfZnJhbWVzID0gMTsKKwl9CisJaWYgKCFyZXF1aXJlZCkK
KwkJdmFsLnVucG1mX2FsbG93ZWQgPSAxOworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndk
ZXYsIHd2aWYtPmlkLAorCQkJICAgICBISUZfTUlCX0lEX1BST1RFQ1RFRF9NR01UX1BPTElDWSwK
KwkJCSAgICAgJnZhbCwgc2l6ZW9mKHZhbCkpOworfQorCitpbnQgaGlmX3NldF9ibG9ja19hY2tf
cG9saWN5KHN0cnVjdCB3ZnhfdmlmICp3dmlmLAorCQkJICAgICB1OCB0eF90aWRfcG9saWN5LCB1
OCByeF90aWRfcG9saWN5KQoreworCXN0cnVjdCBoaWZfbWliX2Jsb2NrX2Fja19wb2xpY3kgdmFs
ID0geworCQkuYmxvY2tfYWNrX3R4X3RpZF9wb2xpY3kgPSB0eF90aWRfcG9saWN5LAorCQkuYmxv
Y2tfYWNrX3J4X3RpZF9wb2xpY3kgPSByeF90aWRfcG9saWN5LAorCX07CisKKwlyZXR1cm4gaGlm
X3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9CTE9DS19BQ0tfUE9M
SUNZLAorCQkJICAgICAmdmFsLCBzaXplb2YodmFsKSk7Cit9CisKK2ludCBoaWZfc2V0X2Fzc29j
aWF0aW9uX21vZGUoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkgICAgIHN0cnVjdCBpZWVlODAy
MTFfYnNzX2NvbmYgKmluZm8pCit7CisJaW50IGJhc2ljX3JhdGVzID0gd2Z4X3JhdGVfbWFza190
b19odyh3dmlmLT53ZGV2LCBpbmZvLT5iYXNpY19yYXRlcyk7CisJc3RydWN0IGllZWU4MDIxMV9z
dGEgKnN0YSA9IE5VTEw7CisJc3RydWN0IGhpZl9taWJfc2V0X2Fzc29jaWF0aW9uX21vZGUgdmFs
ID0geworCQkucHJlYW1idHlwZV91c2UgPSAxLAorCQkubW9kZSA9IDEsCisJCS5yYXRlc2V0ID0g
MSwKKwkJLnNwYWNpbmcgPSAxLAorCQkuc2hvcnRfcHJlYW1ibGUgPSBpbmZvLT51c2Vfc2hvcnRf
cHJlYW1ibGUsCisJCS5iYXNpY19yYXRlX3NldCA9IGNwdV90b19sZTMyKGJhc2ljX3JhdGVzKQor
CX07CisKKwlyY3VfcmVhZF9sb2NrKCk7IC8vIHByb3RlY3Qgc3RhCisJaWYgKGluZm8tPmJzc2lk
ICYmICFpbmZvLT5pYnNzX2pvaW5lZCkKKwkJc3RhID0gaWVlZTgwMjExX2ZpbmRfc3RhKHd2aWYt
PnZpZiwgaW5mby0+YnNzaWQpOworCisJLy8gRklYTUU6IGl0IGlzIHN0cmFuZ2UgdG8gbm90IHJl
dHJpZXZlIGFsbCBpbmZvcm1hdGlvbiBmcm9tIGJzc19pbmZvCisJaWYgKHN0YSAmJiBzdGEtPmh0
X2NhcC5odF9zdXBwb3J0ZWQpIHsKKwkJdmFsLm1wZHVfc3RhcnRfc3BhY2luZyA9IHN0YS0+aHRf
Y2FwLmFtcGR1X2RlbnNpdHk7CisJCWlmICghKGluZm8tPmh0X29wZXJhdGlvbl9tb2RlICYgSUVF
RTgwMjExX0hUX09QX01PREVfTk9OX0dGX1NUQV9QUlNOVCkpCisJCQl2YWwuZ3JlZW5maWVsZCA9
ICEhKHN0YS0+aHRfY2FwLmNhcCAmIElFRUU4MDIxMV9IVF9DQVBfR1JOX0ZMRCk7CisJfQorCXJj
dV9yZWFkX3VubG9jaygpOworCisJcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3Zp
Zi0+aWQsCisJCQkgICAgIEhJRl9NSUJfSURfU0VUX0FTU09DSUFUSU9OX01PREUsICZ2YWwsIHNp
emVvZih2YWwpKTsKK30KKworaW50IGhpZl9zZXRfdHhfcmF0ZV9yZXRyeV9wb2xpY3koc3RydWN0
IHdmeF92aWYgKnd2aWYsCisJCQkJIGludCBwb2xpY3lfaW5kZXgsIHVpbnQ4X3QgKnJhdGVzKQor
eworCXN0cnVjdCBoaWZfbWliX3NldF90eF9yYXRlX3JldHJ5X3BvbGljeSAqYXJnOworCXNpemVf
dCBzaXplID0gc3RydWN0X3NpemUoYXJnLCB0eF9yYXRlX3JldHJ5X3BvbGljeSwgMSk7CisJaW50
IHJldDsKKworCWFyZyA9IGt6YWxsb2Moc2l6ZSwgR0ZQX0tFUk5FTCk7CisJYXJnLT5udW1fdHhf
cmF0ZV9wb2xpY2llcyA9IDE7CisJYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5wb2xpY3lf
aW5kZXggPSBwb2xpY3lfaW5kZXg7CisJYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5zaG9y
dF9yZXRyeV9jb3VudCA9IDI1NTsKKwlhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBdLmxvbmdf
cmV0cnlfY291bnQgPSAyNTU7CisJYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5maXJzdF9y
YXRlX3NlbCA9IDE7CisJYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS50ZXJtaW5hdGUgPSAx
OworCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0uY291bnRfaW5pdCA9IDE7CisJbWVtY3B5
KCZhcmctPnR4X3JhdGVfcmV0cnlfcG9saWN5WzBdLnJhdGVzLCByYXRlcywKKwkgICAgICAgc2l6
ZW9mKGFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0ucmF0ZXMpKTsKKwlyZXQgPSBoaWZfd3Jp
dGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAorCQkJICAgIEhJRl9NSUJfSURfU0VUX1RYX1JB
VEVfUkVUUllfUE9MSUNZLCBhcmcsIHNpemUpOworCWtmcmVlKGFyZyk7CisJcmV0dXJuIHJldDsK
K30KKworaW50IGhpZl9zZXRfbWFjX2FkZHJfY29uZGl0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LAorCQkJICAgICAgIGludCBpZHgsIGNvbnN0IHU4ICptYWNfYWRkcikKK3sKKwlzdHJ1Y3QgaGlm
X21pYl9tYWNfYWRkcl9kYXRhX2ZyYW1lX2NvbmRpdGlvbiB2YWwgPSB7CisJCS5jb25kaXRpb25f
aWR4ID0gaWR4LAorCQkuYWRkcmVzc190eXBlID0gSElGX01BQ19BRERSX0ExLAorCX07CisKKwll
dGhlcl9hZGRyX2NvcHkodmFsLm1hY19hZGRyZXNzLCBtYWNfYWRkcik7CisJcmV0dXJuIGhpZl93
cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCisJCQkgICAgIEhJRl9NSUJfSURfTUFDX0FE
RFJfREFUQUZSQU1FX0NPTkRJVElPTiwKKwkJCSAgICAgJnZhbCwgc2l6ZW9mKHZhbCkpOworfQor
CitpbnQgaGlmX3NldF91Y19tY19iY19jb25kaXRpb24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGlu
dCBpZHgsIHU4IGFsbG93ZWRfZnJhbWVzKQoreworCXN0cnVjdCBoaWZfbWliX3VjX21jX2JjX2Rh
dGFfZnJhbWVfY29uZGl0aW9uIHZhbCA9IHsKKwkJLmNvbmRpdGlvbl9pZHggPSBpZHgsCisJCS5h
bGxvd2VkX2ZyYW1lcyA9IGFsbG93ZWRfZnJhbWVzLAorCX07CisKKwlyZXR1cm4gaGlmX3dyaXRl
X21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJCSAgICAgSElGX01JQl9JRF9VQ19NQ19CQ19E
QVRBRlJBTUVfQ09ORElUSU9OLAorCQkJICAgICAmdmFsLCBzaXplb2YodmFsKSk7Cit9CisKK2lu
dCBoaWZfc2V0X2NvbmZpZ19kYXRhX2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBl
bmFibGUsIGludCBpZHgsCisJCQkgICAgICAgaW50IG1hY19maWx0ZXJzLCBpbnQgZnJhbWVzX3R5
cGVzX2ZpbHRlcnMpCit7CisJc3RydWN0IGhpZl9taWJfY29uZmlnX2RhdGFfZmlsdGVyIHZhbCA9
IHsKKwkJLmVuYWJsZSA9IGVuYWJsZSwKKwkJLmZpbHRlcl9pZHggPSBpZHgsCisJCS5tYWNfY29u
ZCA9IG1hY19maWx0ZXJzLAorCQkudWNfbWNfYmNfY29uZCA9IGZyYW1lc190eXBlc19maWx0ZXJz
LAorCX07CisKKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJ
CSAgICAgSElGX01JQl9JRF9DT05GSUdfREFUQV9GSUxURVIsICZ2YWwsIHNpemVvZih2YWwpKTsK
K30KKworaW50IGhpZl9zZXRfZGF0YV9maWx0ZXJpbmcoc3RydWN0IHdmeF92aWYgKnd2aWYsIGJv
b2wgZW5hYmxlLCBib29sIGludmVydCkKK3sKKwlzdHJ1Y3QgaGlmX21pYl9zZXRfZGF0YV9maWx0
ZXJpbmcgdmFsID0geworCQkuZW5hYmxlID0gZW5hYmxlLAorCQkuaW52ZXJ0X21hdGNoaW5nID0g
aW52ZXJ0LAorCX07CisKKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5p
ZCwKKwkJCSAgICAgSElGX01JQl9JRF9TRVRfREFUQV9GSUxURVJJTkcsICZ2YWwsIHNpemVvZih2
YWwpKTsKK30KKworaW50IGhpZl9rZWVwX2FsaXZlX3BlcmlvZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwgaW50IHBlcmlvZCkKK3sKKwlzdHJ1Y3QgaGlmX21pYl9rZWVwX2FsaXZlX3BlcmlvZCBhcmcg
PSB7CisJCS5rZWVwX2FsaXZlX3BlcmlvZCA9IGNwdV90b19sZTE2KHBlcmlvZCksCisJfTsKKwor
CXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlCX0lEX0tF
RVBfQUxJVkVfUEVSSU9ELAorCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Cit9OworCitpbnQg
aGlmX3NldF9hcnBfaXB2NF9maWx0ZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBpZHgsIF9f
YmUzMiAqYWRkcikKK3sKKwlzdHJ1Y3QgaGlmX21pYl9hcnBfaXBfYWRkcl90YWJsZSBhcmcgPSB7
CisJCS5jb25kaXRpb25faWR4ID0gaWR4LAorCQkuYXJwX2VuYWJsZSA9IEhJRl9BUlBfTlNfRklM
VEVSSU5HX0RJU0FCTEUsCisJfTsKKworCWlmIChhZGRyKSB7CisJCS8vIENhdXRpb246IHR5cGUg
b2YgYWRkciBpcyBfX2JlMzIKKwkJbWVtY3B5KGFyZy5pcHY0X2FkZHJlc3MsIGFkZHIsIHNpemVv
ZihhcmcuaXB2NF9hZGRyZXNzKSk7CisJCWFyZy5hcnBfZW5hYmxlID0gSElGX0FSUF9OU19GSUxU
RVJJTkdfRU5BQkxFOworCX0KKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlm
LT5pZCwKKwkJCSAgICAgSElGX01JQl9JRF9BUlBfSVBfQUREUkVTU0VTX1RBQkxFLAorCQkJICAg
ICAmYXJnLCBzaXplb2YoYXJnKSk7Cit9CisKK2ludCBoaWZfdXNlX211bHRpX3R4X2NvbmYoc3Ry
dWN0IHdmeF9kZXYgKndkZXYsIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBoaWZfbWliX2dsX3Nl
dF9tdWx0aV9tc2cgYXJnID0geworCQkuZW5hYmxlX211bHRpX3R4X2NvbmYgPSBlbmFibGUsCisJ
fTsKKworCXJldHVybiBoaWZfd3JpdGVfbWliKHdkZXYsIC0xLCBISUZfTUlCX0lEX0dMX1NFVF9N
VUxUSV9NU0csCisJCQkgICAgICZhcmcsIHNpemVvZihhcmcpKTsKK30KKworaW50IGhpZl9zZXRf
dWFwc2RfaW5mbyhzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdW5zaWduZWQgbG9uZyB2YWwpCit7CisJ
c3RydWN0IGhpZl9taWJfc2V0X3VhcHNkX2luZm9ybWF0aW9uIGFyZyA9IHsgfTsKKworCWlmICh2
YWwgJiBCSVQoSUVFRTgwMjExX0FDX1ZPKSkKKwkJYXJnLnRyaWdfdm9pY2UgPSAxOworCWlmICh2
YWwgJiBCSVQoSUVFRTgwMjExX0FDX1ZJKSkKKwkJYXJnLnRyaWdfdmlkZW8gPSAxOworCWlmICh2
YWwgJiBCSVQoSUVFRTgwMjExX0FDX0JFKSkKKwkJYXJnLnRyaWdfYmUgPSAxOworCWlmICh2YWwg
JiBCSVQoSUVFRTgwMjExX0FDX0JLKSkKKwkJYXJnLnRyaWdfYmNrZ3JuZCA9IDE7CisJcmV0dXJu
IGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCisJCQkgICAgIEhJRl9NSUJfSURf
U0VUX1VBUFNEX0lORk9STUFUSU9OLAorCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Cit9CisK
K2ludCBoaWZfZXJwX3VzZV9wcm90ZWN0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGVu
YWJsZSkKK3sKKwlzdHJ1Y3QgaGlmX21pYl9ub25fZXJwX3Byb3RlY3Rpb24gYXJnID0geworCQku
dXNlX2N0c190b19zZWxmID0gZW5hYmxlLAorCX07CisKKwlyZXR1cm4gaGlmX3dyaXRlX21pYih3
dmlmLT53ZGV2LCB3dmlmLT5pZCwKKwkJCSAgICAgSElGX01JQl9JRF9OT05fRVJQX1BST1RFQ1RJ
T04sICZhcmcsIHNpemVvZihhcmcpKTsKK30KKworaW50IGhpZl9zbG90X3RpbWUoc3RydWN0IHdm
eF92aWYgKnd2aWYsIGludCB2YWwpCit7CisJc3RydWN0IGhpZl9taWJfc2xvdF90aW1lIGFyZyA9
IHsKKwkJLnNsb3RfdGltZSA9IGNwdV90b19sZTMyKHZhbCksCisJfTsKKworCXJldHVybiBoaWZf
d3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlCX0lEX1NMT1RfVElNRSwKKwkJ
CSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgaGlmX2R1YWxfY3RzX3Byb3RlY3Rp
b24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCBoaWZfbWli
X3NldF9odF9wcm90ZWN0aW9uIGFyZyA9IHsKKwkJLmR1YWxfY3RzX3Byb3QgPSBlbmFibGUsCisJ
fTsKKworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlC
X0lEX1NFVF9IVF9QUk9URUNUSU9OLAorCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Cit9CisK
K2ludCBoaWZfd2VwX2RlZmF1bHRfa2V5X2lkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgdmFs
KQoreworCXN0cnVjdCBoaWZfbWliX3dlcF9kZWZhdWx0X2tleV9pZCBhcmcgPSB7CisJCS53ZXBf
ZGVmYXVsdF9rZXlfaWQgPSB2YWwsCisJfTsKKworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYt
PndkZXYsIHd2aWYtPmlkLAorCQkJICAgICBISUZfTUlCX0lEX0RPVDExX1dFUF9ERUZBVUxUX0tF
WV9JRCwKKwkJCSAgICAgJmFyZywgc2l6ZW9mKGFyZykpOworfQorCitpbnQgaGlmX3J0c190aHJl
c2hvbGQoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCB2YWwpCit7CisJc3RydWN0IGhpZl9taWJf
ZG90MTFfcnRzX3RocmVzaG9sZCBhcmcgPSB7CisJCS50aHJlc2hvbGQgPSBjcHVfdG9fbGUzMih2
YWwgPj0gMCA/IHZhbCA6IDB4RkZGRiksCisJfTsKKworCXJldHVybiBoaWZfd3JpdGVfbWliKHd2
aWYtPndkZXYsIHd2aWYtPmlkLAorCQkJICAgICBISUZfTUlCX0lEX0RPVDExX1JUU19USFJFU0hP
TEQsICZhcmcsIHNpemVvZihhcmcpKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93
ZngvaGlmX3R4X21pYi5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfdHhfbWliLmgKaW5kZXgg
MjZiMTQwNmY5ZjZjLi43N2RlZGRhMDQ2NWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93
ZngvaGlmX3R4X21pYi5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3R4X21pYi5oCkBA
IC05LDM5OCArOSw1MSBAQAogI2lmbmRlZiBXRlhfSElGX1RYX01JQl9ICiAjZGVmaW5lIFdGWF9I
SUZfVFhfTUlCX0gKIAotI2luY2x1ZGUgPGxpbnV4L2V0aGVyZGV2aWNlLmg+Ci0KLSNpbmNsdWRl
ICJ3ZnguaCIKLSNpbmNsdWRlICJoaWZfdHguaCIKICNpbmNsdWRlICJoaWZfYXBpX21pYi5oIgog
Ci1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X291dHB1dF9wb3dlcihzdHJ1Y3Qgd2Z4X3ZpZiAq
d3ZpZiwgaW50IHZhbCkKLXsKLQlzdHJ1Y3QgaGlmX21pYl9jdXJyZW50X3R4X3Bvd2VyX2xldmVs
IGFyZyA9IHsKLQkJLnBvd2VyX2xldmVsID0gY3B1X3RvX2xlMzIodmFsICogMTApLAotCX07Ci0K
LQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwKLQkJCSAgICAgSElG
X01JQl9JRF9DVVJSRU5UX1RYX1BPV0VSX0xFVkVMLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJn
KSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9zZXRfYmVhY29uX3dha2V1cF9wZXJpb2Qo
c3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkJCSAgICAgICB1bnNpZ25lZCBpbnQgZHRpbV9pbnRl
cnZhbCwKLQkJCQkJICAgICAgIHVuc2lnbmVkIGludCBsaXN0ZW5faW50ZXJ2YWwpCi17Ci0Jc3Ry
dWN0IGhpZl9taWJfYmVhY29uX3dha2VfdXBfcGVyaW9kIHZhbCA9IHsKLQkJLndha2V1cF9wZXJp
b2RfbWluID0gZHRpbV9pbnRlcnZhbCwKLQkJLnJlY2VpdmVfZHRpbSA9IDAsCi0JCS53YWtldXBf
cGVyaW9kX21heCA9IGNwdV90b19sZTE2KGxpc3Rlbl9pbnRlcnZhbCksCi0JfTsKLQotCWlmIChk
dGltX2ludGVydmFsID4gMHhGRiB8fCBsaXN0ZW5faW50ZXJ2YWwgPiAweEZGRkYpCi0JCXJldHVy
biAtRUlOVkFMOwotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAot
CQkJICAgICBISUZfTUlCX0lEX0JFQUNPTl9XQUtFVVBfUEVSSU9ELAotCQkJICAgICAmdmFsLCBz
aXplb2YodmFsKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9zZXRfcmNwaV9yc3NpX3Ro
cmVzaG9sZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKLQkJCQkJICAgICAgaW50IHJzc2lfdGhvbGQs
IGludCByc3NpX2h5c3QpCi17Ci0Jc3RydWN0IGhpZl9taWJfcmNwaV9yc3NpX3RocmVzaG9sZCBh
cmcgPSB7Ci0JCS5yb2xsaW5nX2F2ZXJhZ2VfY291bnQgPSA4LAotCQkuZGV0ZWN0aW9uID0gMSwK
LQl9OwotCi0JaWYgKCFyc3NpX3Rob2xkICYmICFyc3NpX2h5c3QpIHsKLQkJYXJnLnVwcGVydGhy
ZXNoID0gMTsKLQkJYXJnLmxvd2VydGhyZXNoID0gMTsKLQl9IGVsc2UgewotCQlhcmcudXBwZXJf
dGhyZXNob2xkID0gcnNzaV90aG9sZCArIHJzc2lfaHlzdDsKLQkJYXJnLnVwcGVyX3RocmVzaG9s
ZCA9IChhcmcudXBwZXJfdGhyZXNob2xkICsgMTEwKSAqIDI7Ci0JCWFyZy5sb3dlcl90aHJlc2hv
bGQgPSByc3NpX3Rob2xkOwotCQlhcmcubG93ZXJfdGhyZXNob2xkID0gKGFyZy5sb3dlcl90aHJl
c2hvbGQgKyAxMTApICogMjsKLQl9Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2
LCB3dmlmLT5pZCwKLQkJCSAgICAgSElGX01JQl9JRF9SQ1BJX1JTU0lfVEhSRVNIT0xELCAmYXJn
LCBzaXplb2YoYXJnKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9nZXRfY291bnRlcnNf
dGFibGUoc3RydWN0IHdmeF9kZXYgKndkZXYsCi0JCQkJCSBzdHJ1Y3QgaGlmX21pYl9leHRlbmRl
ZF9jb3VudF90YWJsZSAqYXJnKQotewotCWlmICh3ZnhfYXBpX29sZGVyX3RoYW4od2RldiwgMSwg
MykpIHsKLQkJLy8gZXh0ZW5kZWRfY291bnRfdGFibGUgaXMgd2lkZXIgdGhhbiBjb3VudF90YWJs
ZQotCQltZW1zZXQoYXJnLCAweEZGLCBzaXplb2YoKmFyZykpOwotCQlyZXR1cm4gaGlmX3JlYWRf
bWliKHdkZXYsIDAsIEhJRl9NSUJfSURfQ09VTlRFUlNfVEFCTEUsCi0JCQkJICAgIGFyZywgc2l6
ZW9mKHN0cnVjdCBoaWZfbWliX2NvdW50X3RhYmxlKSk7Ci0JfSBlbHNlIHsKLQkJcmV0dXJuIGhp
Zl9yZWFkX21pYih3ZGV2LCAwLAotCQkJCSAgICBISUZfTUlCX0lEX0VYVEVOREVEX0NPVU5URVJT
X1RBQkxFLCBhcmcsCi0JCQkJc2l6ZW9mKHN0cnVjdCBoaWZfbWliX2V4dGVuZGVkX2NvdW50X3Rh
YmxlKSk7Ci0JfQotfQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X21hY2FkZHIoc3RydWN0
IHdmeF92aWYgKnd2aWYsIHU4ICptYWMpCi17Ci0Jc3RydWN0IGhpZl9taWJfbWFjX2FkZHJlc3Mg
bXNnID0geyB9OwotCi0JaWYgKG1hYykKLQkJZXRoZXJfYWRkcl9jb3B5KG1zZy5tYWNfYWRkciwg
bWFjKTsKLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01J
Ql9JRF9ET1QxMV9NQUNfQUREUkVTUywKLQkJCSAgICAgJm1zZywgc2l6ZW9mKG1zZykpOwotfQot
Ci1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X3J4X2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwgYm9vbCBmaWx0ZXJfYnNzaWQsCi0JCQkJICAgIGJvb2wgZndkX3Byb2JlX3JlcSkKLXsKLQlz
dHJ1Y3QgaGlmX21pYl9yeF9maWx0ZXIgdmFsID0geyB9OwotCi0JaWYgKGZpbHRlcl9ic3NpZCkK
LQkJdmFsLmJzc2lkX2ZpbHRlciA9IDE7Ci0JaWYgKGZ3ZF9wcm9iZV9yZXEpCi0JCXZhbC5md2Rf
cHJvYmVfcmVxID0gMTsKLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5p
ZCwgSElGX01JQl9JRF9SWF9GSUxURVIsCi0JCQkgICAgICZ2YWwsIHNpemVvZih2YWwpKTsKLX0K
LQotc3RhdGljIGlubGluZSBpbnQgaGlmX3NldF9iZWFjb25fZmlsdGVyX3RhYmxlKHN0cnVjdCB3
ZnhfdmlmICp3dmlmLAotCQkJCQkgICAgICBpbnQgdGJsX2xlbiwKLQkJCQkJICAgICAgc3RydWN0
IGhpZl9pZV90YWJsZV9lbnRyeSAqdGJsKQotewotCWludCByZXQ7Ci0Jc3RydWN0IGhpZl9taWJf
YmNuX2ZpbHRlcl90YWJsZSAqdmFsOwotCWludCBidWZfbGVuID0gc3RydWN0X3NpemUodmFsLCBp
ZV90YWJsZSwgdGJsX2xlbik7Ci0KLQl2YWwgPSBremFsbG9jKGJ1Zl9sZW4sIEdGUF9LRVJORUwp
OwotCWlmICghdmFsKQotCQlyZXR1cm4gLUVOT01FTTsKLQl2YWwtPm51bV9vZl9pbmZvX2VsbXRz
ID0gY3B1X3RvX2xlMzIodGJsX2xlbik7Ci0JbWVtY3B5KHZhbC0+aWVfdGFibGUsIHRibCwgdGJs
X2xlbiAqIHNpemVvZigqdGJsKSk7Ci0JcmV0ID0gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3
dmlmLT5pZCwKLQkJCSAgICBISUZfTUlCX0lEX0JFQUNPTl9GSUxURVJfVEFCTEUsIHZhbCwgYnVm
X2xlbik7Ci0Ja2ZyZWUodmFsKTsKLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW5saW5lIGlu
dCBoaWZfYmVhY29uX2ZpbHRlcl9jb250cm9sKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAotCQkJCQkg
ICAgaW50IGVuYWJsZSwgaW50IGJlYWNvbl9jb3VudCkKLXsKLQlzdHJ1Y3QgaGlmX21pYl9iY25f
ZmlsdGVyX2VuYWJsZSBhcmcgPSB7Ci0JCS5lbmFibGUgPSBjcHVfdG9fbGUzMihlbmFibGUpLAot
CQkuYmNuX2NvdW50ID0gY3B1X3RvX2xlMzIoYmVhY29uX2NvdW50KSwKLQl9OwotCXJldHVybiBo
aWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lEX0JF
QUNPTl9GSUxURVJfRU5BQkxFLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLXN0
YXRpYyBpbmxpbmUgaW50IGhpZl9zZXRfb3BlcmF0aW9uYWxfbW9kZShzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiwKLQkJCQkJICAgZW51bSBoaWZfb3BfcG93ZXJfbW9kZSBtb2RlKQotewotCXN0cnVjdCBo
aWZfbWliX2dsX29wZXJhdGlvbmFsX3Bvd2VyX21vZGUgdmFsID0gewotCQkucG93ZXJfbW9kZSA9
IG1vZGUsCi0JCS53dXBfaW5kX2FjdGl2YXRpb24gPSAxLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dy
aXRlX21pYih3ZGV2LCAtMSwgSElGX01JQl9JRF9HTF9PUEVSQVRJT05BTF9QT1dFUl9NT0RFLAot
CQkJICAgICAmdmFsLCBzaXplb2YodmFsKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9z
ZXRfdGVtcGxhdGVfZnJhbWUoc3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkJCSBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiLAotCQkJCQkgdTggZnJhbWVfdHlwZSwgaW50IGluaXRfcmF0ZSkKLXsKLQlzdHJ1
Y3QgaGlmX21pYl90ZW1wbGF0ZV9mcmFtZSAqYXJnOwotCi0Jc2tiX3B1c2goc2tiLCA0KTsKLQlh
cmcgPSAoc3RydWN0IGhpZl9taWJfdGVtcGxhdGVfZnJhbWUgKilza2ItPmRhdGE7Ci0Jc2tiX3B1
bGwoc2tiLCA0KTsKLQlhcmctPmluaXRfcmF0ZSA9IGluaXRfcmF0ZTsKLQlhcmctPmZyYW1lX3R5
cGUgPSBmcmFtZV90eXBlOwotCWFyZy0+ZnJhbWVfbGVuZ3RoID0gY3B1X3RvX2xlMTYoc2tiLT5s
ZW4pOwotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlC
X0lEX1RFTVBMQVRFX0ZSQU1FLAotCQkJICAgICBhcmcsIHNpemVvZigqYXJnKSk7Ci19Ci0KLXN0
YXRpYyBpbmxpbmUgaW50IGhpZl9zZXRfbWZwKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGNh
cGFibGUsIGJvb2wgcmVxdWlyZWQpCi17Ci0Jc3RydWN0IGhpZl9taWJfcHJvdGVjdGVkX21nbXRf
cG9saWN5IHZhbCA9IHsgfTsKLQotCVdBUk4ocmVxdWlyZWQgJiYgIWNhcGFibGUsICJpbmNvaGVy
ZW50IGFyZ3VtZW50cyIpOwotCWlmIChjYXBhYmxlKSB7Ci0JCXZhbC5wbWZfZW5hYmxlID0gMTsK
LQkJdmFsLmhvc3RfZW5jX2F1dGhfZnJhbWVzID0gMTsKLQl9Ci0JaWYgKCFyZXF1aXJlZCkKLQkJ
dmFsLnVucG1mX2FsbG93ZWQgPSAxOwotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYs
IHd2aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lEX1BST1RFQ1RFRF9NR01UX1BPTElDWSwKLQkJ
CSAgICAgJnZhbCwgc2l6ZW9mKHZhbCkpOwotfQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0
X2Jsb2NrX2Fja19wb2xpY3koc3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkJCSAgIHU4IHR4X3Rp
ZF9wb2xpY3ksIHU4IHJ4X3RpZF9wb2xpY3kpCi17Ci0Jc3RydWN0IGhpZl9taWJfYmxvY2tfYWNr
X3BvbGljeSB2YWwgPSB7Ci0JCS5ibG9ja19hY2tfdHhfdGlkX3BvbGljeSA9IHR4X3RpZF9wb2xp
Y3ksCi0JCS5ibG9ja19hY2tfcnhfdGlkX3BvbGljeSA9IHJ4X3RpZF9wb2xpY3ksCi0JfTsKLQot
CXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLCBISUZfTUlCX0lEX0JM
T0NLX0FDS19QT0xJQ1ksCi0JCQkgICAgICZ2YWwsIHNpemVvZih2YWwpKTsKLX0KLQotc3RhdGlj
IGlubGluZSBpbnQgaGlmX3NldF9hc3NvY2lhdGlvbl9tb2RlKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LAotCQkJCQkgICBzdHJ1Y3QgaWVlZTgwMjExX2Jzc19jb25mICppbmZvKQotewotCWludCBiYXNp
Y19yYXRlcyA9IHdmeF9yYXRlX21hc2tfdG9faHcod3ZpZi0+d2RldiwgaW5mby0+YmFzaWNfcmF0
ZXMpOwotCXN0cnVjdCBpZWVlODAyMTFfc3RhICpzdGEgPSBOVUxMOwotCXN0cnVjdCBoaWZfbWli
X3NldF9hc3NvY2lhdGlvbl9tb2RlIHZhbCA9IHsKLQkJLnByZWFtYnR5cGVfdXNlID0gMSwKLQkJ
Lm1vZGUgPSAxLAotCQkucmF0ZXNldCA9IDEsCi0JCS5zcGFjaW5nID0gMSwKLQkJLnNob3J0X3By
ZWFtYmxlID0gaW5mby0+dXNlX3Nob3J0X3ByZWFtYmxlLAotCQkuYmFzaWNfcmF0ZV9zZXQgPSBj
cHVfdG9fbGUzMihiYXNpY19yYXRlcykKLQl9OwotCi0JcmN1X3JlYWRfbG9jaygpOyAvLyBwcm90
ZWN0IHN0YQotCWlmIChpbmZvLT5ic3NpZCAmJiAhaW5mby0+aWJzc19qb2luZWQpCi0JCXN0YSA9
IGllZWU4MDIxMV9maW5kX3N0YSh3dmlmLT52aWYsIGluZm8tPmJzc2lkKTsKLQotCS8vIEZJWE1F
OiBpdCBpcyBzdHJhbmdlIHRvIG5vdCByZXRyaWV2ZSBhbGwgaW5mb3JtYXRpb24gZnJvbSBic3Nf
aW5mbwotCWlmIChzdGEgJiYgc3RhLT5odF9jYXAuaHRfc3VwcG9ydGVkKSB7Ci0JCXZhbC5tcGR1
X3N0YXJ0X3NwYWNpbmcgPSBzdGEtPmh0X2NhcC5hbXBkdV9kZW5zaXR5OwotCQlpZiAoIShpbmZv
LT5odF9vcGVyYXRpb25fbW9kZSAmIElFRUU4MDIxMV9IVF9PUF9NT0RFX05PTl9HRl9TVEFfUFJT
TlQpKQotCQkJdmFsLmdyZWVuZmllbGQgPSAhIShzdGEtPmh0X2NhcC5jYXAgJiBJRUVFODAyMTFf
SFRfQ0FQX0dSTl9GTEQpOwotCX0KLQlyY3VfcmVhZF91bmxvY2soKTsKLQotCXJldHVybiBoaWZf
d3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lEX1NFVF9B
U1NPQ0lBVElPTl9NT0RFLCAmdmFsLCBzaXplb2YodmFsKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUg
aW50IGhpZl9zZXRfdHhfcmF0ZV9yZXRyeV9wb2xpY3koc3RydWN0IHdmeF92aWYgKnd2aWYsCi0J
CQkJCSAgICAgICBpbnQgcG9saWN5X2luZGV4LCB1aW50OF90ICpyYXRlcykKLXsKLQlzdHJ1Y3Qg
aGlmX21pYl9zZXRfdHhfcmF0ZV9yZXRyeV9wb2xpY3kgKmFyZzsKLQlzaXplX3Qgc2l6ZSA9IHN0
cnVjdF9zaXplKGFyZywgdHhfcmF0ZV9yZXRyeV9wb2xpY3ksIDEpOwotCWludCByZXQ7Ci0KLQlh
cmcgPSBremFsbG9jKHNpemUsIEdGUF9LRVJORUwpOwotCWFyZy0+bnVtX3R4X3JhdGVfcG9saWNp
ZXMgPSAxOwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0ucG9saWN5X2luZGV4ID0gcG9s
aWN5X2luZGV4OwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0uc2hvcnRfcmV0cnlfY291
bnQgPSAyNTU7Ci0JYXJnLT50eF9yYXRlX3JldHJ5X3BvbGljeVswXS5sb25nX3JldHJ5X2NvdW50
ID0gMjU1OwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0uZmlyc3RfcmF0ZV9zZWwgPSAx
OwotCWFyZy0+dHhfcmF0ZV9yZXRyeV9wb2xpY3lbMF0udGVybWluYXRlID0gMTsKLQlhcmctPnR4
X3JhdGVfcmV0cnlfcG9saWN5WzBdLmNvdW50X2luaXQgPSAxOwotCW1lbWNweSgmYXJnLT50eF9y
YXRlX3JldHJ5X3BvbGljeVswXS5yYXRlcywgcmF0ZXMsCi0JICAgICAgIHNpemVvZihhcmctPnR4
X3JhdGVfcmV0cnlfcG9saWN5WzBdLnJhdGVzKSk7Ci0JcmV0ID0gaGlmX3dyaXRlX21pYih3dmlm
LT53ZGV2LCB3dmlmLT5pZCwKLQkJCSAgICBISUZfTUlCX0lEX1NFVF9UWF9SQVRFX1JFVFJZX1BP
TElDWSwgYXJnLCBzaXplKTsKLQlrZnJlZShhcmcpOwotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRp
YyBpbmxpbmUgaW50IGhpZl9zZXRfbWFjX2FkZHJfY29uZGl0aW9uKHN0cnVjdCB3ZnhfdmlmICp3
dmlmLAotCQkJCQkgICAgIGludCBpZHgsIGNvbnN0IHU4ICptYWNfYWRkcikKLXsKLQlzdHJ1Y3Qg
aGlmX21pYl9tYWNfYWRkcl9kYXRhX2ZyYW1lX2NvbmRpdGlvbiB2YWwgPSB7Ci0JCS5jb25kaXRp
b25faWR4ID0gaWR4LAotCQkuYWRkcmVzc190eXBlID0gSElGX01BQ19BRERSX0ExLAotCX07Ci0K
LQlldGhlcl9hZGRyX2NvcHkodmFsLm1hY19hZGRyZXNzLCBtYWNfYWRkcik7Ci0JcmV0dXJuIGhp
Zl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCi0JCQkgICAgIEhJRl9NSUJfSURfTUFD
X0FERFJfREFUQUZSQU1FX0NPTkRJVElPTiwKLQkJCSAgICAgJnZhbCwgc2l6ZW9mKHZhbCkpOwot
fQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X3VjX21jX2JjX2NvbmRpdGlvbihzdHJ1Y3Qg
d2Z4X3ZpZiAqd3ZpZiwKLQkJCQkJICAgICBpbnQgaWR4LCB1OCBhbGxvd2VkX2ZyYW1lcykKLXsK
LQlzdHJ1Y3QgaGlmX21pYl91Y19tY19iY19kYXRhX2ZyYW1lX2NvbmRpdGlvbiB2YWwgPSB7Ci0J
CS5jb25kaXRpb25faWR4ID0gaWR4LAotCQkuYWxsb3dlZF9mcmFtZXMgPSBhbGxvd2VkX2ZyYW1l
cywKLQl9OwotCi0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCi0J
CQkgICAgIEhJRl9NSUJfSURfVUNfTUNfQkNfREFUQUZSQU1FX0NPTkRJVElPTiwKLQkJCSAgICAg
JnZhbCwgc2l6ZW9mKHZhbCkpOwotfQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X2NvbmZp
Z19kYXRhX2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBlbmFibGUsCi0JCQkJCSAg
ICAgaW50IGlkeCwgaW50IG1hY19maWx0ZXJzLAotCQkJCQkgICAgIGludCBmcmFtZXNfdHlwZXNf
ZmlsdGVycykKLXsKLQlzdHJ1Y3QgaGlmX21pYl9jb25maWdfZGF0YV9maWx0ZXIgdmFsID0gewot
CQkuZW5hYmxlID0gZW5hYmxlLAotCQkuZmlsdGVyX2lkeCA9IGlkeCwKLQkJLm1hY19jb25kID0g
bWFjX2ZpbHRlcnMsCi0JCS51Y19tY19iY19jb25kID0gZnJhbWVzX3R5cGVzX2ZpbHRlcnMsCi0J
fTsKLQotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAg
ICBISUZfTUlCX0lEX0NPTkZJR19EQVRBX0ZJTFRFUiwgJnZhbCwgc2l6ZW9mKHZhbCkpOwotfQot
Ci1zdGF0aWMgaW5saW5lIGludCBoaWZfc2V0X2RhdGFfZmlsdGVyaW5nKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLAotCQkJCQkgYm9vbCBlbmFibGUsIGJvb2wgaW52ZXJ0KQotewotCXN0cnVjdCBoaWZf
bWliX3NldF9kYXRhX2ZpbHRlcmluZyB2YWwgPSB7Ci0JCS5lbmFibGUgPSBlbmFibGUsCi0JCS5p
bnZlcnRfbWF0Y2hpbmcgPSBpbnZlcnQsCi0JfTsKLQotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2
aWYtPndkZXYsIHd2aWYtPmlkLAotCQkJICAgICBISUZfTUlCX0lEX1NFVF9EQVRBX0ZJTFRFUklO
RywgJnZhbCwgc2l6ZW9mKHZhbCkpOwotfQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfa2VlcF9h
bGl2ZV9wZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBwZXJpb2QpCi17Ci0Jc3RydWN0
IGhpZl9taWJfa2VlcF9hbGl2ZV9wZXJpb2QgYXJnID0gewotCQkua2VlcF9hbGl2ZV9wZXJpb2Qg
PSBjcHVfdG9fbGUxNihwZXJpb2QpLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlm
LT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9LRUVQX0FMSVZFX1BFUklPRCwKLQkJCSAgICAg
JmFyZywgc2l6ZW9mKGFyZykpOwotfTsKLQotc3RhdGljIGlubGluZSBpbnQgaGlmX3NldF9hcnBf
aXB2NF9maWx0ZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCBpZHgsCi0JCQkJCSAgX19iZTMy
ICphZGRyKQotewotCXN0cnVjdCBoaWZfbWliX2FycF9pcF9hZGRyX3RhYmxlIGFyZyA9IHsKLQkJ
LmNvbmRpdGlvbl9pZHggPSBpZHgsCi0JCS5hcnBfZW5hYmxlID0gSElGX0FSUF9OU19GSUxURVJJ
TkdfRElTQUJMRSwKLQl9OwotCi0JaWYgKGFkZHIpIHsKLQkJLy8gQ2F1dGlvbjogdHlwZSBvZiBh
ZGRyIGlzIF9fYmUzMgotCQltZW1jcHkoYXJnLmlwdjRfYWRkcmVzcywgYWRkciwgc2l6ZW9mKGFy
Zy5pcHY0X2FkZHJlc3MpKTsKLQkJYXJnLmFycF9lbmFibGUgPSBISUZfQVJQX05TX0ZJTFRFUklO
R19FTkFCTEU7Ci0JfQotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlk
LAotCQkJICAgICBISUZfTUlCX0lEX0FSUF9JUF9BRERSRVNTRVNfVEFCTEUsCi0JCQkgICAgICZh
cmcsIHNpemVvZihhcmcpKTsKLX0KLQotc3RhdGljIGlubGluZSBpbnQgaGlmX3VzZV9tdWx0aV90
eF9jb25mKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBib29sIGVuYWJsZSkKLXsKLQlzdHJ1Y3QgaGlm
X21pYl9nbF9zZXRfbXVsdGlfbXNnIGFyZyA9IHsKLQkJLmVuYWJsZV9tdWx0aV90eF9jb25mID0g
ZW5hYmxlLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3ZGV2LCAtMSwgSElGX01JQl9J
RF9HTF9TRVRfTVVMVElfTVNHLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLXN0
YXRpYyBpbmxpbmUgaW50IGhpZl9zZXRfdWFwc2RfaW5mbyhzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwg
dW5zaWduZWQgbG9uZyB2YWwpCi17Ci0Jc3RydWN0IGhpZl9taWJfc2V0X3VhcHNkX2luZm9ybWF0
aW9uIGFyZyA9IHsgfTsKLQotCWlmICh2YWwgJiBCSVQoSUVFRTgwMjExX0FDX1ZPKSkKLQkJYXJn
LnRyaWdfdm9pY2UgPSAxOwotCWlmICh2YWwgJiBCSVQoSUVFRTgwMjExX0FDX1ZJKSkKLQkJYXJn
LnRyaWdfdmlkZW8gPSAxOwotCWlmICh2YWwgJiBCSVQoSUVFRTgwMjExX0FDX0JFKSkKLQkJYXJn
LnRyaWdfYmUgPSAxOwotCWlmICh2YWwgJiBCSVQoSUVFRTgwMjExX0FDX0JLKSkKLQkJYXJnLnRy
aWdfYmNrZ3JuZCA9IDE7Ci0JcmV0dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+
aWQsCi0JCQkgICAgIEhJRl9NSUJfSURfU0VUX1VBUFNEX0lORk9STUFUSU9OLAotCQkJICAgICAm
YXJnLCBzaXplb2YoYXJnKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9lcnBfdXNlX3By
b3RlY3Rpb24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlKQotewotCXN0cnVjdCBo
aWZfbWliX25vbl9lcnBfcHJvdGVjdGlvbiBhcmcgPSB7Ci0JCS51c2VfY3RzX3RvX3NlbGYgPSBl
bmFibGUsCi0JfTsKLQotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlk
LAotCQkJICAgICBISUZfTUlCX0lEX05PTl9FUlBfUFJPVEVDVElPTiwgJmFyZywgc2l6ZW9mKGFy
ZykpOwotfQotCi1zdGF0aWMgaW5saW5lIGludCBoaWZfc2xvdF90aW1lKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCBpbnQgdmFsKQotewotCXN0cnVjdCBoaWZfbWliX3Nsb3RfdGltZSBhcmcgPSB7Ci0J
CS5zbG90X3RpbWUgPSBjcHVfdG9fbGUzMih2YWwpLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRl
X21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwgSElGX01JQl9JRF9TTE9UX1RJTUUsCi0JCQkgICAg
ICZhcmcsIHNpemVvZihhcmcpKTsKLX0KLQotc3RhdGljIGlubGluZSBpbnQgaGlmX2R1YWxfY3Rz
X3Byb3RlY3Rpb24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlKQotewotCXN0cnVj
dCBoaWZfbWliX3NldF9odF9wcm90ZWN0aW9uIGFyZyA9IHsKLQkJLmR1YWxfY3RzX3Byb3QgPSBl
bmFibGUsCi0JfTsKLQotCXJldHVybiBoaWZfd3JpdGVfbWliKHd2aWYtPndkZXYsIHd2aWYtPmlk
LCBISUZfTUlCX0lEX1NFVF9IVF9QUk9URUNUSU9OLAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJn
KSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl93ZXBfZGVmYXVsdF9rZXlfaWQoc3RydWN0
IHdmeF92aWYgKnd2aWYsIGludCB2YWwpCi17Ci0Jc3RydWN0IGhpZl9taWJfd2VwX2RlZmF1bHRf
a2V5X2lkIGFyZyA9IHsKLQkJLndlcF9kZWZhdWx0X2tleV9pZCA9IHZhbCwKLQl9OwotCi0JcmV0
dXJuIGhpZl93cml0ZV9taWIod3ZpZi0+d2Rldiwgd3ZpZi0+aWQsCi0JCQkgICAgIEhJRl9NSUJf
SURfRE9UMTFfV0VQX0RFRkFVTFRfS0VZX0lELAotCQkJICAgICAmYXJnLCBzaXplb2YoYXJnKSk7
Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGhpZl9ydHNfdGhyZXNob2xkKHN0cnVjdCB3Znhfdmlm
ICp3dmlmLCBpbnQgdmFsKQotewotCXN0cnVjdCBoaWZfbWliX2RvdDExX3J0c190aHJlc2hvbGQg
YXJnID0gewotCQkudGhyZXNob2xkID0gY3B1X3RvX2xlMzIodmFsID49IDAgPyB2YWwgOiAweEZG
RkYpLAotCX07Ci0KLQlyZXR1cm4gaGlmX3dyaXRlX21pYih3dmlmLT53ZGV2LCB3dmlmLT5pZCwK
LQkJCSAgICAgSElGX01JQl9JRF9ET1QxMV9SVFNfVEhSRVNIT0xELCAmYXJnLCBzaXplb2YoYXJn
KSk7Ci19CitzdHJ1Y3Qgd2Z4X3ZpZjsKK3N0cnVjdCBza19idWZmOworCitpbnQgaGlmX3NldF9v
dXRwdXRfcG93ZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIGludCB2YWwpOworaW50IGhpZl9zZXRf
YmVhY29uX3dha2V1cF9wZXJpb2Qoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkJIHVuc2lnbmVk
IGludCBkdGltX2ludGVydmFsLAorCQkJCSB1bnNpZ25lZCBpbnQgbGlzdGVuX2ludGVydmFsKTsK
K2ludCBoaWZfc2V0X3JjcGlfcnNzaV90aHJlc2hvbGQoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJ
CQkJaW50IHJzc2lfdGhvbGQsIGludCByc3NpX2h5c3QpOworaW50IGhpZl9nZXRfY291bnRlcnNf
dGFibGUoc3RydWN0IHdmeF9kZXYgKndkZXYsCisJCQkgICBzdHJ1Y3QgaGlmX21pYl9leHRlbmRl
ZF9jb3VudF90YWJsZSAqYXJnKTsKK2ludCBoaWZfc2V0X21hY2FkZHIoc3RydWN0IHdmeF92aWYg
Knd2aWYsIHU4ICptYWMpOworaW50IGhpZl9zZXRfcnhfZmlsdGVyKHN0cnVjdCB3ZnhfdmlmICp3
dmlmLAorCQkgICAgICBib29sIGZpbHRlcl9ic3NpZCwgYm9vbCBmd2RfcHJvYmVfcmVxKTsKK2lu
dCBoaWZfc2V0X2JlYWNvbl9maWx0ZXJfdGFibGUoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkJ
aW50IHRibF9sZW4sIHN0cnVjdCBoaWZfaWVfdGFibGVfZW50cnkgKnRibCk7CitpbnQgaGlmX2Jl
YWNvbl9maWx0ZXJfY29udHJvbChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJCSAgICAgIGludCBl
bmFibGUsIGludCBiZWFjb25fY291bnQpOworaW50IGhpZl9zZXRfb3BlcmF0aW9uYWxfbW9kZShz
dHJ1Y3Qgd2Z4X2RldiAqd2RldiwgZW51bSBoaWZfb3BfcG93ZXJfbW9kZSBtb2RlKTsKK2ludCBo
aWZfc2V0X3RlbXBsYXRlX2ZyYW1lKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiLAorCQkJICAgdTggZnJhbWVfdHlwZSwgaW50IGluaXRfcmF0ZSk7CitpbnQgaGlmX3Nl
dF9tZnAoc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgY2FwYWJsZSwgYm9vbCByZXF1aXJlZCk7
CitpbnQgaGlmX3NldF9ibG9ja19hY2tfcG9saWN5KHN0cnVjdCB3ZnhfdmlmICp3dmlmLAorCQkJ
ICAgICB1OCB0eF90aWRfcG9saWN5LCB1OCByeF90aWRfcG9saWN5KTsKK2ludCBoaWZfc2V0X2Fz
c29jaWF0aW9uX21vZGUoc3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkgICAgIHN0cnVjdCBpZWVl
ODAyMTFfYnNzX2NvbmYgKmluZm8pOworaW50IGhpZl9zZXRfdHhfcmF0ZV9yZXRyeV9wb2xpY3ko
c3RydWN0IHdmeF92aWYgKnd2aWYsCisJCQkJIGludCBwb2xpY3lfaW5kZXgsIHVpbnQ4X3QgKnJh
dGVzKTsKK2ludCBoaWZfc2V0X21hY19hZGRyX2NvbmRpdGlvbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwKKwkJCSAgICAgICBpbnQgaWR4LCBjb25zdCB1OCAqbWFjX2FkZHIpOworaW50IGhpZl9zZXRf
dWNfbWNfYmNfY29uZGl0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAorCQkJICAgICAgIGludCBp
ZHgsIHU4IGFsbG93ZWRfZnJhbWVzKTsKK2ludCBoaWZfc2V0X2NvbmZpZ19kYXRhX2ZpbHRlcihz
dHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgYm9vbCBlbmFibGUsIGludCBpZHgsCisJCQkgICAgICAgaW50
IG1hY19maWx0ZXJzLCBpbnQgZnJhbWVzX3R5cGVzX2ZpbHRlcnMpOworaW50IGhpZl9zZXRfZGF0
YV9maWx0ZXJpbmcoc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlLCBib29sIGludmVy
dCk7CitpbnQgaGlmX2tlZXBfYWxpdmVfcGVyaW9kKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQg
cGVyaW9kKTsKK2ludCBoaWZfc2V0X2FycF9pcHY0X2ZpbHRlcihzdHJ1Y3Qgd2Z4X3ZpZiAqd3Zp
ZiwgaW50IGlkeCwgX19iZTMyICphZGRyKTsKK2ludCBoaWZfdXNlX211bHRpX3R4X2NvbmYoc3Ry
dWN0IHdmeF9kZXYgKndkZXYsIGJvb2wgZW5hYmxlKTsKK2ludCBoaWZfc2V0X3VhcHNkX2luZm8o
c3RydWN0IHdmeF92aWYgKnd2aWYsIHVuc2lnbmVkIGxvbmcgdmFsKTsKK2ludCBoaWZfZXJwX3Vz
ZV9wcm90ZWN0aW9uKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBib29sIGVuYWJsZSk7CitpbnQgaGlm
X3Nsb3RfdGltZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCk7CitpbnQgaGlmX2R1YWxf
Y3RzX3Byb3RlY3Rpb24oc3RydWN0IHdmeF92aWYgKnd2aWYsIGJvb2wgZW5hYmxlKTsKK2ludCBo
aWZfd2VwX2RlZmF1bHRfa2V5X2lkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBpbnQgdmFsKTsKK2lu
dCBoaWZfcnRzX3RocmVzaG9sZChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgaW50IHZhbCk7CiAKICNl
bmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9rZXkuYyBiL2RyaXZlcnMvc3Rh
Z2luZy93Zngva2V5LmMKaW5kZXggOTZhZGZhMzMwNjA0Li43Yjc5YjYxNzUzNzIgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvc3RhZ2luZy93Zngva2V5LmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9r
ZXkuYwpAQCAtNSw2ICs1LDcgQEAKICAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE5LCBTaWxpY29u
IExhYm9yYXRvcmllcywgSW5jLgogICogQ29weXJpZ2h0IChjKSAyMDEwLCBTVC1Fcmljc3Nvbgog
ICovCisjaW5jbHVkZSA8bGludXgvZXRoZXJkZXZpY2UuaD4KICNpbmNsdWRlIDxuZXQvbWFjODAy
MTEuaD4KIAogI2luY2x1ZGUgImtleS5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dm
eC9zdGEuYyBiL2RyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMKaW5kZXggNjRjZjU4MTIyNjYxLi5j
MjUwYjExN2ExMzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMKKysrIGIv
ZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYwpAQCAtNSw2ICs1LDcgQEAKICAqIENvcHlyaWdodCAo
YykgMjAxNy0yMDE5LCBTaWxpY29uIExhYm9yYXRvcmllcywgSW5jLgogICogQ29weXJpZ2h0IChj
KSAyMDEwLCBTVC1Fcmljc3NvbgogICovCisjaW5jbHVkZSA8bGludXgvZXRoZXJkZXZpY2UuaD4K
ICNpbmNsdWRlIDxuZXQvbWFjODAyMTEuaD4KIAogI2luY2x1ZGUgInN0YS5oIgotLSAKMi4yNS4x
Cgo=
