Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 7E2F020303
	for <lists+netdev@lfdr.de>; Thu, 16 May 2019 11:59:34 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727190AbfEPJ7P (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Thu, 16 May 2019 05:59:15 -0400
Received: from mail-eopbgr130087.outbound.protection.outlook.com ([40.107.13.87]:52489
        "EHLO EUR01-HE1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1726363AbfEPJ7O (ORCPT <rfc822;netdev@vger.kernel.org>);
        Thu, 16 May 2019 05:59:14 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=cXpEldL5/e76TUbtRM51UsrHohS7DLcy/WhK8ldjEZ8=;
 b=VCUm/df/0hjIpUXfIWg5gy/h2oQkCC7ULJimr7AbTqQw/SM4dOZ1TXQNmSuQ/DnSax+o8JlJKI9sqZtJscHSRzKWJib24xTj0MFlnqzyS2vYou/b5Y9Drmrx4USbJAMyUsEnwCGlHF2akG2R5Afe1ayJVLO7rb4hcwo3YmmQ14A=
Received: from VI1PR0401MB2237.eurprd04.prod.outlook.com (10.169.132.138) by
 VI1PR0401MB2637.eurprd04.prod.outlook.com (10.168.61.7) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1878.24; Thu, 16 May 2019 09:59:08 +0000
Received: from VI1PR0401MB2237.eurprd04.prod.outlook.com
 ([fe80::b091:6395:e853:5986]) by VI1PR0401MB2237.eurprd04.prod.outlook.com
 ([fe80::b091:6395:e853:5986%3]) with mapi id 15.20.1900.010; Thu, 16 May 2019
 09:59:08 +0000
From:   "Y.b. Lu" <yangbo.lu@nxp.com>
To:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        Richard Cochran <richardcochran@gmail.com>,
        David Miller <davem@davemloft.net>,
        Claudiu Manoil <claudiu.manoil@nxp.com>,
        Shawn Guo <shawnguo@kernel.org>,
        Rob Herring <robh+dt@kernel.org>
CC:     "devicetree@vger.kernel.org" <devicetree@vger.kernel.org>,
        "linux-arm-kernel@lists.infradead.org" 
        <linux-arm-kernel@lists.infradead.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "Y.b. Lu" <yangbo.lu@nxp.com>
Subject: [PATCH 1/3] enetc: add hardware timestamping support
Thread-Topic: [PATCH 1/3] enetc: add hardware timestamping support
Thread-Index: AQHVC84AyxJ95TkLo0SObQ6CRQsOGA==
Date:   Thu, 16 May 2019 09:59:08 +0000
Message-ID: <20190516100028.48256-2-yangbo.lu@nxp.com>
References: <20190516100028.48256-1-yangbo.lu@nxp.com>
In-Reply-To: <20190516100028.48256-1-yangbo.lu@nxp.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK2PR0302CA0017.apcprd03.prod.outlook.com
 (2603:1096:202::27) To VI1PR0401MB2237.eurprd04.prod.outlook.com
 (2603:10a6:800:27::10)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=yangbo.lu@nxp.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [119.31.174.73]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 0c287350-8f2b-4137-4456-08d6d9e52337
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(4618075)(2017052603328)(7193020);SRVR:VI1PR0401MB2637;
x-ms-traffictypediagnostic: VI1PR0401MB2637:
x-microsoft-antispam-prvs: <VI1PR0401MB26370E6A372471D0B576FFF7F80A0@VI1PR0401MB2637.eurprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:3968;
x-forefront-prvs: 0039C6E5C5
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(376002)(396003)(39860400002)(136003)(366004)(346002)(189003)(199004)(52116002)(7736002)(3846002)(6116002)(14454004)(76176011)(8936002)(81166006)(305945005)(81156014)(8676002)(36756003)(5660300002)(316002)(2616005)(476003)(6486002)(11346002)(68736007)(446003)(6512007)(6436002)(486006)(25786009)(66066001)(66476007)(1076003)(66446008)(66556008)(64756008)(2906002)(386003)(6506007)(71190400001)(30864003)(71200400001)(256004)(86362001)(4326008)(186003)(53936002)(50226002)(99286004)(110136005)(54906003)(66946007)(26005)(102836004)(478600001)(2501003)(73956011)(309714004);DIR:OUT;SFP:1101;SCL:1;SRVR:VI1PR0401MB2637;H:VI1PR0401MB2237.eurprd04.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: nxp.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: PUeVbW5cHtTjCvIJTCaDmToxrC88Gu/JFwMqz80eVt6I2JbqeLoukV0jlk9d1ok48Aujlk74xA3wb7B1fi1PPBHWSxRqrdlrimJAvu2o75QSN2vwuFVXlVlsdcLo2M3xHraDxcffxFzUJoeJ9waCr8CuoyzZWMYhS3oulKTGs1rE7jittQHxsPkkip3bA9lA/I61ThvZdlEfbL94+7gGmbwuogZqjBJX/j1B6ThVeO97WhkIe7SBe6nlBbTV4ApKjY2+rB29CjCCSXcPaESIOxSLriyYGPe7MmCuGhJ3/n0YL0odS3k8fh8VABEejMYuK1ewJMMWc4ie4vi5MZcvHN6ffH1F8E4anyZFHSGMQVnpRi2BQGTZn8zxC4I5GQOk9CdKbCuJ4vkfnsfruk1AxD5bGzTFlsL47Z/d95HwWsA=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 0c287350-8f2b-4137-4456-08d6d9e52337
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 May 2019 09:59:08.4939
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VI1PR0401MB2637
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

VGhpcyBwYXRjaCBpcyB0byBhZGQgaGFyZHdhcmUgdGltZXN0YW1waW5nIHN1cHBvcnQNCmZvciBF
TkVUQy4gT24gUngsIHRpbWVzdGFtcGluZyBpcyBlbmFibGVkIGZvciBhbGwNCmZyYW1lcy4gT24g
VHgsIHdlIG9ubHkgaW5zdHJ1Y3QgdGhlIGhhcmR3YXJlIHRvDQp0aW1lc3RhbXAgdGhlIGZyYW1l
cyBtYXJrZWQgYWNjb3JkaW5nbHkgYnkgdGhlIHN0YWNrLg0KDQpCZWNhdXNlIHRoZSBSWCBCRCBy
aW5nIGR5bmFtaWMgYWxsb2NhdGlvbiBoYXNuJ3QgYmVlbg0Kc3VwcG9ydGVkIGFuZCBpdCdzIHRv
byBleHBlbnNpdmUgdG8gdXNlIGV4dGVuZGVkIFJYIEJEcw0KaWYgdGltZXN0YW1waW5nIGlzbid0
IHVzZWQsIHdlIGhhdmUgdG8gdXNlIGEgS2NvbmZpZw0Kb3B0aW9uIHRvIGVuYWJsZS9kaXNhYmxl
IHRpbWVzdGFtcGluZyBmb3Igbm93LiBUaGlzDQpLY29uZmlnIG9wdGlvbiB3aWxsIGJlIHJlbW92
ZWQgb25jZSBSWCBCRCByaW5nIGR5bmFtaWMNCmFsbG9jYXRpb24gaXMgaW1wbGVtZW50ZWQuDQoN
ClNpZ25lZC1vZmYtYnk6IFlhbmdibyBMdSA8eWFuZ2JvLmx1QG54cC5jb20+DQotLS0NCiBkcml2
ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvS2NvbmZpZyAgfCAgMTEgKysNCiBkcml2
ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGMuYyAgfCAxNTYgKysrKysrKysr
KysrKysrKystDQogZHJpdmVycy9uZXQvZXRoZXJuZXQvZnJlZXNjYWxlL2VuZXRjL2VuZXRjLmgg
IHwgIDExICstDQogLi4uL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNfaHcuaCAg
IHwgIDEzICsrDQogLi4uL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNfcGYuYyAg
IHwgICAxICsNCiAuLi4vbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Y192Zi5jICAg
fCAgIDEgKw0KIDYgZmlsZXMgY2hhbmdlZCwgMTg3IGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25z
KC0pDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMv
S2NvbmZpZyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9LY29uZmlnDQpp
bmRleCA4NDI5ZjVjMWQ4MTAuLmZjNmYzMGQyZWY5MSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9LY29uZmlnDQorKysgYi9kcml2ZXJzL25ldC9ldGhl
cm5ldC9mcmVlc2NhbGUvZW5ldGMvS2NvbmZpZw0KQEAgLTI5LDMgKzI5LDE0IEBAIGNvbmZpZyBG
U0xfRU5FVENfUFRQX0NMT0NLDQogCSAgcGFja2V0cyB1c2luZyB0aGUgU09fVElNRVNUQU1QSU5H
IEFQSS4NCiANCiAJICBJZiBjb21waWxlZCBhcyBtb2R1bGUgKE0pLCB0aGUgbW9kdWxlIG5hbWUg
aXMgZnNsLWVuZXRjLXB0cC4NCisNCitjb25maWcgRlNMX0VORVRDX0hXX1RJTUVTVEFNUElORw0K
Kwlib29sICJFTkVUQyBoYXJkd2FyZSB0aW1lc3RhbXBpbmcgc3VwcG9ydCINCisJZGVwZW5kcyBv
biBGU0xfRU5FVEMgfHwgRlNMX0VORVRDX1ZGDQorCWhlbHANCisJICBFbmFibGUgaGFyZHdhcmUg
dGltZXN0YW1waW5nIHN1cHBvcnQgb24gdGhlIEV0aGVybmV0IHBhY2tldHMNCisJICB1c2luZyB0
aGUgU09fVElNRVNUQU1QSU5HIEFQSS4gQmVjYXVzZSB0aGUgUlggQkQgcmluZyBkeW5hbWljDQor
CSAgYWxsb2NhdGlvbiBoYXNuJ3QgYmVlbiBzdXBwb3J0ZWQgYW5kIGl0J3MgdG9vIGV4cGVuc2l2
ZSB0byB1c2UNCisJICBleHRlbmRlZCBSWCBCRHMgaWYgdGltZXN0YW1waW5nIGlzbid0IHVzZWQs
IHRoZSBvcHRpb24gd2FzIHVzZWQNCisJICB0byBjb250cm9sIGhhcmR3YXJlIHRpbWVzdGFtcGlu
Zy9leHRlbmRlZCBSWCBCRHMgdG8gYmUgZW5hYmxlZA0KKwkgIG9yIG5vdC4NCmRpZmYgLS1naXQg
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGMuYyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Yy5jDQppbmRleCA1YmI5ZWIzNWQ3NmQu
LjIxMzc5NzNkYWJhOSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2Fs
ZS9lbmV0Yy9lbmV0Yy5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5l
dGMvZW5ldGMuYw0KQEAgLTEzLDcgKzEzLDggQEANCiAjZGVmaW5lIEVORVRDX01BWF9TS0JfRlJB
R1MJMTMNCiAjZGVmaW5lIEVORVRDX1RYQkRTX01BWF9ORUVERUQJRU5FVENfVFhCRFNfTkVFREVE
KEVORVRDX01BWF9TS0JfRlJBR1MgKyAxKQ0KIA0KLXN0YXRpYyBpbnQgZW5ldGNfbWFwX3R4X2J1
ZmZzKHN0cnVjdCBlbmV0Y19iZHIgKnR4X3JpbmcsIHN0cnVjdCBza19idWZmICpza2IpOw0KK3N0
YXRpYyBpbnQgZW5ldGNfbWFwX3R4X2J1ZmZzKHN0cnVjdCBlbmV0Y19iZHIgKnR4X3JpbmcsIHN0
cnVjdCBza19idWZmICpza2IsDQorCQkJICAgICAgaW50IGh3X2ZlYXR1cmVzKTsNCiANCiBuZXRk
ZXZfdHhfdCBlbmV0Y194bWl0KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNl
ICpuZGV2KQ0KIHsNCkBAIC0zMyw3ICszNCw3IEBAIG5ldGRldl90eF90IGVuZXRjX3htaXQoc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYpDQogCQlyZXR1cm4gTkVU
REVWX1RYX0JVU1k7DQogCX0NCiANCi0JY291bnQgPSBlbmV0Y19tYXBfdHhfYnVmZnModHhfcmlu
Zywgc2tiKTsNCisJY291bnQgPSBlbmV0Y19tYXBfdHhfYnVmZnModHhfcmluZywgc2tiLCBwcml2
LT5od19mZWF0dXJlcyk7DQogCWlmICh1bmxpa2VseSghY291bnQpKQ0KIAkJZ290byBkcm9wX3Bh
Y2tldF9lcnI7DQogDQpAQCAtMTA1LDcgKzEwNiw4IEBAIHN0YXRpYyB2b2lkIGVuZXRjX2ZyZWVf
dHhfc2tiKHN0cnVjdCBlbmV0Y19iZHIgKnR4X3JpbmcsDQogCX0NCiB9DQogDQotc3RhdGljIGlu
dCBlbmV0Y19tYXBfdHhfYnVmZnMoc3RydWN0IGVuZXRjX2JkciAqdHhfcmluZywgc3RydWN0IHNr
X2J1ZmYgKnNrYikNCitzdGF0aWMgaW50IGVuZXRjX21hcF90eF9idWZmcyhzdHJ1Y3QgZW5ldGNf
YmRyICp0eF9yaW5nLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLA0KKwkJCSAgICAgIGludCBod19mZWF0
dXJlcykNCiB7DQogCXN0cnVjdCBlbmV0Y190eF9zd2JkICp0eF9zd2JkOw0KIAlzdHJ1Y3Qgc2ti
X2ZyYWdfc3RydWN0ICpmcmFnOw0KQEAgLTEzNyw3ICsxMzksMTAgQEAgc3RhdGljIGludCBlbmV0
Y19tYXBfdHhfYnVmZnMoc3RydWN0IGVuZXRjX2JkciAqdHhfcmluZywgc3RydWN0IHNrX2J1ZmYg
KnNrYikNCiAJY291bnQrKzsNCiANCiAJZG9fdmxhbiA9IHNrYl92bGFuX3RhZ19wcmVzZW50KHNr
Yik7DQotCWRvX3RzdGFtcCA9IHNrYl9zaGluZm8oc2tiKS0+dHhfZmxhZ3MgJiBTS0JUWF9IV19U
U1RBTVA7DQorCWRvX3RzdGFtcCA9IChod19mZWF0dXJlcyAmIEVORVRDX0ZfVFhfVFNUQU1QKSAm
Jg0KKwkJICAgIChza2Jfc2hpbmZvKHNrYiktPnR4X2ZsYWdzICYgU0tCVFhfSFdfVFNUQU1QKTsN
CisJdHhfc3diZC0+ZG9fdHN0YW1wID0gZG9fdHN0YW1wOw0KKwl0eF9zd2JkLT5jaGVja193YiA9
IHR4X3N3YmQtPmRvX3RzdGFtcDsNCiANCiAJaWYgKGRvX3ZsYW4gfHwgZG9fdHN0YW1wKQ0KIAkJ
ZmxhZ3MgfD0gRU5FVENfVFhCRF9GTEFHU19FWDsNCkBAIC0yOTksMjIgKzMwNCw2OCBAQCBzdGF0
aWMgaW50IGVuZXRjX2JkX3JlYWR5X2NvdW50KHN0cnVjdCBlbmV0Y19iZHIgKnR4X3JpbmcsIGlu
dCBjaSkNCiAJcmV0dXJuIHBpID49IGNpID8gcGkgLSBjaSA6IHR4X3JpbmctPmJkX2NvdW50IC0g
Y2kgKyBwaTsNCiB9DQogDQorc3RhdGljIHZvaWQgZW5ldGNfZ2V0X3R4X3RzdGFtcChzdHJ1Y3Qg
ZW5ldGNfaHcgKmh3LCB1bmlvbiBlbmV0Y190eF9iZCAqdHhiZCwNCisJCQkJdTY0ICp0c3RhbXAp
DQorew0KKwl1MzIgbG8sIGhpOw0KKw0KKwlsbyA9IGVuZXRjX3JkKGh3LCBFTkVUQ19TSUNUUjAp
Ow0KKwloaSA9IGVuZXRjX3JkKGh3LCBFTkVUQ19TSUNUUjEpOw0KKwlpZiAobG8gPD0gdHhiZC0+
d2IudHN0YW1wKQ0KKwkJaGkgLT0gMTsNCisJKnRzdGFtcCA9ICh1NjQpaGkgPDwgMzIgfCB0eGJk
LT53Yi50c3RhbXA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGVuZXRjX3RzdGFtcF90eChzdHJ1Y3Qg
c2tfYnVmZiAqc2tiLCB1NjQgdHN0YW1wKQ0KK3sNCisJc3RydWN0IHNrYl9zaGFyZWRfaHd0c3Rh
bXBzIHNoaHd0c3RhbXBzOw0KKw0KKwlpZiAoc2tiX3NoaW5mbyhza2IpLT50eF9mbGFncyAmIFNL
QlRYX0lOX1BST0dSRVNTKSB7DQorCQltZW1zZXQoJnNoaHd0c3RhbXBzLCAwLCBzaXplb2Yoc2ho
d3RzdGFtcHMpKTsNCisJCXNoaHd0c3RhbXBzLmh3dHN0YW1wID0gbnNfdG9fa3RpbWUodHN0YW1w
KTsNCisJCXNrYl90c3RhbXBfdHgoc2tiLCAmc2hod3RzdGFtcHMpOw0KKwl9DQorfQ0KKw0KIHN0
YXRpYyBib29sIGVuZXRjX2NsZWFuX3R4X3Jpbmcoc3RydWN0IGVuZXRjX2JkciAqdHhfcmluZywg
aW50IG5hcGlfYnVkZ2V0KQ0KIHsNCiAJc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYgPSB0eF9yaW5n
LT5uZGV2Ow0KKwlzdHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYobmRl
dik7DQogCWludCB0eF9mcm1fY250ID0gMCwgdHhfYnl0ZV9jbnQgPSAwOw0KIAlzdHJ1Y3QgZW5l
dGNfdHhfc3diZCAqdHhfc3diZDsNCisJdW5pb24gZW5ldGNfdHhfYmQgKnR4YmQ7DQorCWJvb2wg
ZG9fdHN0YW1wOw0KIAlpbnQgaSwgYmRzX3RvX2NsZWFuOw0KKwl1NjQgdHN0YW1wID0gMDsNCiAN
CiAJaSA9IHR4X3JpbmctPm5leHRfdG9fY2xlYW47DQogCXR4X3N3YmQgPSAmdHhfcmluZy0+dHhf
c3diZFtpXTsNCiAJYmRzX3RvX2NsZWFuID0gZW5ldGNfYmRfcmVhZHlfY291bnQodHhfcmluZywg
aSk7DQogDQorCWRvX3RzdGFtcCA9IGZhbHNlOw0KKw0KIAl3aGlsZSAoYmRzX3RvX2NsZWFuICYm
IHR4X2ZybV9jbnQgPCBFTkVUQ19ERUZBVUxUX1RYX1dPUkspIHsNCiAJCWJvb2wgaXNfZW9mID0g
ISF0eF9zd2JkLT5za2I7DQogDQorCQlpZiAodW5saWtlbHkodHhfc3diZC0+Y2hlY2tfd2IpKSB7
DQorCQkJdHhiZCA9IEVORVRDX1RYQkQoKnR4X3JpbmcsIGkpOw0KKw0KKwkJCWlmICghKHR4YmQt
PmZsYWdzICYgRU5FVENfVFhCRF9GTEFHU19XKSkNCisJCQkJZ290byBub193YjsNCisNCisJCQlp
ZiAodHhfc3diZC0+ZG9fdHN0YW1wKSB7DQorCQkJCWVuZXRjX2dldF90eF90c3RhbXAoJnByaXYt
PnNpLT5odywgdHhiZCwNCisJCQkJCQkgICAgJnRzdGFtcCk7DQorCQkJCWRvX3RzdGFtcCA9IHRy
dWU7DQorCQkJfQ0KKwkJfQ0KK25vX3diOg0KIAkJZW5ldGNfdW5tYXBfdHhfYnVmZih0eF9yaW5n
LCB0eF9zd2JkKTsNCiAJCWlmIChpc19lb2YpIHsNCisJCQlpZiAodW5saWtlbHkoZG9fdHN0YW1w
KSkgew0KKwkJCQllbmV0Y190c3RhbXBfdHgodHhfc3diZC0+c2tiLCB0c3RhbXApOw0KKwkJCQlk
b190c3RhbXAgPSBmYWxzZTsNCisJCQl9DQogCQkJbmFwaV9jb25zdW1lX3NrYih0eF9zd2JkLT5z
a2IsIG5hcGlfYnVkZ2V0KTsNCiAJCQl0eF9zd2JkLT5za2IgPSBOVUxMOw0KIAkJfQ0KQEAgLTQy
MywxMCArNDc0LDM0IEBAIHN0YXRpYyBpbnQgZW5ldGNfcmVmaWxsX3J4X3Jpbmcoc3RydWN0IGVu
ZXRjX2JkciAqcnhfcmluZywgY29uc3QgaW50IGJ1ZmZfY250KQ0KIAlyZXR1cm4gajsNCiB9DQog
DQorI2lmZGVmIENPTkZJR19GU0xfRU5FVENfSFdfVElNRVNUQU1QSU5HDQorc3RhdGljIHZvaWQg
ZW5ldGNfZ2V0X3J4X3RzdGFtcChzdHJ1Y3QgbmV0X2RldmljZSAqbmRldiwNCisJCQkJdW5pb24g
ZW5ldGNfcnhfYmQgKnJ4YmQsDQorCQkJCXN0cnVjdCBza19idWZmICpza2IpDQorew0KKwlzdHJ1
Y3Qgc2tiX3NoYXJlZF9od3RzdGFtcHMgKnNoaHd0c3RhbXBzID0gc2tiX2h3dHN0YW1wcyhza2Ip
Ow0KKwlzdHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYobmRldik7DQor
CXN0cnVjdCBlbmV0Y19odyAqaHcgPSAmcHJpdi0+c2ktPmh3Ow0KKwl1MzIgbG8sIGhpOw0KKwl1
NjQgdHN0YW1wOw0KKw0KKwlpZiAocnhiZC0+ci5mbGFncyAmIEVORVRDX1JYQkRfRkxBR19UU1RN
UCkgew0KKwkJbG8gPSBlbmV0Y19yZChodywgRU5FVENfU0lDVFIwKTsNCisJCWhpID0gZW5ldGNf
cmQoaHcsIEVORVRDX1NJQ1RSMSk7DQorCQlpZiAobG8gPD0gcnhiZC0+ci50c3RhbXApDQorCQkJ
aGkgLT0gMTsNCisNCisJCXRzdGFtcCA9ICh1NjQpaGkgPDwgMzIgfCByeGJkLT5yLnRzdGFtcDsN
CisJCW1lbXNldChzaGh3dHN0YW1wcywgMCwgc2l6ZW9mKCpzaGh3dHN0YW1wcykpOw0KKwkJc2ho
d3RzdGFtcHMtPmh3dHN0YW1wID0gbnNfdG9fa3RpbWUodHN0YW1wKTsNCisJfQ0KK30NCisjZW5k
aWYNCisNCiBzdGF0aWMgdm9pZCBlbmV0Y19nZXRfb2ZmbG9hZHMoc3RydWN0IGVuZXRjX2JkciAq
cnhfcmluZywNCiAJCQkgICAgICAgdW5pb24gZW5ldGNfcnhfYmQgKnJ4YmQsIHN0cnVjdCBza19i
dWZmICpza2IpDQogew0KLQkvKiBUT0RPOiBhZGQgdHN0YW1wLCBoYXNoaW5nICovDQorCS8qIFRP
RE86IGhhc2hpbmcgKi8NCiAJaWYgKHJ4X3JpbmctPm5kZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9S
WENTVU0pIHsNCiAJCXUxNiBpbmV0X2NzdW0gPSBsZTE2X3RvX2NwdShyeGJkLT5yLmluZXRfY3N1
bSk7DQogDQpAQCAtNDQwLDYgKzUxNSwxMCBAQCBzdGF0aWMgdm9pZCBlbmV0Y19nZXRfb2ZmbG9h
ZHMoc3RydWN0IGVuZXRjX2JkciAqcnhfcmluZywNCiAJaWYgKGxlMTZfdG9fY3B1KHJ4YmQtPnIu
ZmxhZ3MpICYgRU5FVENfUlhCRF9GTEFHX1ZMQU4pDQogCQlfX3ZsYW5faHdhY2NlbF9wdXRfdGFn
KHNrYiwgaHRvbnMoRVRIX1BfODAyMVEpLA0KIAkJCQkgICAgICAgbGUxNl90b19jcHUocnhiZC0+
ci52bGFuX29wdCkpOw0KKyNpZmRlZiBDT05GSUdfRlNMX0VORVRDX0hXX1RJTUVTVEFNUElORw0K
KwlpZiAocnhfcmluZy0+bmRldi0+aHdfZmVhdHVyZXMgJiBFTkVUQ19GX1JYX1RTVEFNUCkNCisJ
CWVuZXRjX2dldF9yeF90c3RhbXAocnhfcmluZy0+bmRldiwgcnhiZCwgc2tiKTsNCisjZW5kaWYN
CiB9DQogDQogc3RhdGljIHZvaWQgZW5ldGNfcHJvY2Vzc19za2Ioc3RydWN0IGVuZXRjX2JkciAq
cnhfcmluZywNCkBAIC0xMDcyLDYgKzExNTEsOSBAQCBzdGF0aWMgdm9pZCBlbmV0Y19zZXR1cF9y
eGJkcihzdHJ1Y3QgZW5ldGNfaHcgKmh3LCBzdHJ1Y3QgZW5ldGNfYmRyICpyeF9yaW5nKQ0KIAll
bmV0Y19yeGJkcl93cihodywgaWR4LCBFTkVUQ19SQklDSVIwLCBFTkVUQ19SQklDSVIwX0lDRU4g
fCAweDEpOw0KIA0KIAlyYm1yID0gRU5FVENfUkJNUl9FTjsNCisjaWZkZWYgQ09ORklHX0ZTTF9F
TkVUQ19IV19USU1FU1RBTVBJTkcNCisJcmJtciB8PSBFTkVUQ19SQk1SX0JEUzsNCisjZW5kaWYN
CiAJaWYgKHJ4X3JpbmctPm5kZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfUlgp
DQogCQlyYm1yIHw9IEVORVRDX1JCTVJfVlRFOw0KIA0KQEAgLTEzOTQsNiArMTQ3Niw3MCBAQCBp
bnQgZW5ldGNfc2V0X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpuZGV2LA0KIAlyZXR1cm4g
MDsNCiB9DQogDQorI2lmZGVmIENPTkZJR19GU0xfRU5FVENfSFdfVElNRVNUQU1QSU5HDQorc3Rh
dGljIGludCBlbmV0Y19od3RzdGFtcF9zZXQoc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYsIHN0cnVj
dCBpZnJlcSAqaWZyKQ0KK3sNCisJc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiA9IG5ldGRl
dl9wcml2KG5kZXYpOw0KKwlzdHJ1Y3QgaHd0c3RhbXBfY29uZmlnIGNvbmZpZzsNCisNCisJaWYg
KGNvcHlfZnJvbV91c2VyKCZjb25maWcsIGlmci0+aWZyX2RhdGEsIHNpemVvZihjb25maWcpKSkN
CisJCXJldHVybiAtRUZBVUxUOw0KKw0KKwlzd2l0Y2ggKGNvbmZpZy50eF90eXBlKSB7DQorCWNh
c2UgSFdUU1RBTVBfVFhfT0ZGOg0KKwkJcHJpdi0+aHdfZmVhdHVyZXMgJj0gfkVORVRDX0ZfVFhf
VFNUQU1QOw0KKwkJYnJlYWs7DQorCWNhc2UgSFdUU1RBTVBfVFhfT046DQorCQlwcml2LT5od19m
ZWF0dXJlcyB8PSBFTkVUQ19GX1RYX1RTVEFNUDsNCisJCWJyZWFrOw0KKwlkZWZhdWx0Og0KKwkJ
cmV0dXJuIC1FUkFOR0U7DQorCX0NCisNCisJc3dpdGNoIChjb25maWcucnhfZmlsdGVyKSB7DQor
CWNhc2UgSFdUU1RBTVBfRklMVEVSX05PTkU6DQorCQlwcml2LT5od19mZWF0dXJlcyAmPSB+RU5F
VENfRl9SWF9UU1RBTVA7DQorCQlicmVhazsNCisJZGVmYXVsdDoNCisJCXByaXYtPmh3X2ZlYXR1
cmVzIHw9IEVORVRDX0ZfUlhfVFNUQU1QOw0KKwkJY29uZmlnLnJ4X2ZpbHRlciA9IEhXVFNUQU1Q
X0ZJTFRFUl9BTEw7DQorCX0NCisNCisJcmV0dXJuIGNvcHlfdG9fdXNlcihpZnItPmlmcl9kYXRh
LCAmY29uZmlnLCBzaXplb2YoY29uZmlnKSkgPw0KKwkgICAgICAgLUVGQVVMVCA6IDA7DQorfQ0K
Kw0KK3N0YXRpYyBpbnQgZW5ldGNfaHd0c3RhbXBfZ2V0KHN0cnVjdCBuZXRfZGV2aWNlICpuZGV2
LCBzdHJ1Y3QgaWZyZXEgKmlmcikNCit7DQorCXN0cnVjdCBlbmV0Y19uZGV2X3ByaXYgKnByaXYg
PSBuZXRkZXZfcHJpdihuZGV2KTsNCisJc3RydWN0IGh3dHN0YW1wX2NvbmZpZyBjb25maWc7DQor
DQorCWNvbmZpZy5mbGFncyA9IDA7DQorDQorCWlmIChwcml2LT5od19mZWF0dXJlcyAmIEVORVRD
X0ZfVFhfVFNUQU1QKQ0KKwkJY29uZmlnLnR4X3R5cGUgPSBIV1RTVEFNUF9UWF9PTjsNCisJZWxz
ZQ0KKwkJY29uZmlnLnR4X3R5cGUgPSBIV1RTVEFNUF9UWF9PRkY7DQorDQorCWNvbmZpZy5yeF9m
aWx0ZXIgPSAocHJpdi0+aHdfZmVhdHVyZXMgJiBFTkVUQ19GX1JYX1RTVEFNUCkgPw0KKwkJCSAg
ICBIV1RTVEFNUF9GSUxURVJfQUxMIDogSFdUU1RBTVBfRklMVEVSX05PTkU7DQorDQorCXJldHVy
biBjb3B5X3RvX3VzZXIoaWZyLT5pZnJfZGF0YSwgJmNvbmZpZywgc2l6ZW9mKGNvbmZpZykpID8N
CisJICAgICAgIC1FRkFVTFQgOiAwOw0KK30NCisjZW5kaWYNCisNCitpbnQgZW5ldGNfaW9jdGwo
c3RydWN0IG5ldF9kZXZpY2UgKm5kZXYsIHN0cnVjdCBpZnJlcSAqcnEsIGludCBjbWQpDQorew0K
KyNpZmRlZiBDT05GSUdfRlNMX0VORVRDX0hXX1RJTUVTVEFNUElORw0KKwlpZiAoY21kID09IFNJ
T0NTSFdUU1RBTVApDQorCQlyZXR1cm4gZW5ldGNfaHd0c3RhbXBfc2V0KG5kZXYsIHJxKTsNCisJ
aWYgKGNtZCA9PSBTSU9DR0hXVFNUQU1QKQ0KKwkJcmV0dXJuIGVuZXRjX2h3dHN0YW1wX2dldChu
ZGV2LCBycSk7DQorI2VuZGlmDQorCXJldHVybiAtRUlOVkFMOw0KK30NCisNCiBpbnQgZW5ldGNf
YWxsb2NfbXNpeChzdHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2KQ0KIHsNCiAJc3RydWN0IHBj
aV9kZXYgKnBkZXYgPSBwcml2LT5zaS0+cGRldjsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9l
dGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGMuaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2Zy
ZWVzY2FsZS9lbmV0Yy9lbmV0Yy5oDQppbmRleCBiMjc0MTM1YzUxMDMuLjhjNjNlYTI1M2FiMiAx
MDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Yy5o
DQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGMuaA0KQEAg
LTIxLDcgKzIxLDkgQEAgc3RydWN0IGVuZXRjX3R4X3N3YmQgew0KIAlzdHJ1Y3Qgc2tfYnVmZiAq
c2tiOw0KIAlkbWFfYWRkcl90IGRtYTsNCiAJdTE2IGxlbjsNCi0JdTE2IGlzX2RtYV9wYWdlOw0K
Kwl1OCBpc19kbWFfcGFnZToxOw0KKwl1OCBjaGVja193YjoxOw0KKwl1OCBkb190c3RhbXA6MTsN
CiB9Ow0KIA0KICNkZWZpbmUgRU5FVENfUlhfTUFYRlJNX1NJWkUJRU5FVENfTUFDX01BWEZSTV9T
SVpFDQpAQCAtMTY3LDYgKzE2OSwxMSBAQCBzdHJ1Y3QgZW5ldGNfY2xzX3J1bGUgew0KIA0KICNk
ZWZpbmUgRU5FVENfTUFYX0JEUl9JTlQJMiAvKiBmaXhlZCB0byBtYXggIyBvZiBhdmFpbGFibGUg
Y3B1cyAqLw0KIA0KK2VudW0gZW5ldGNfaHdfZmVhdHVyZXMgew0KKwlFTkVUQ19GX1JYX1RTVEFN
UAk9IEJJVCgwKSwNCisJRU5FVENfRl9UWF9UU1RBTVAJPSBCSVQoMSksDQorfTsNCisNCiBzdHJ1
Y3QgZW5ldGNfbmRldl9wcml2IHsNCiAJc3RydWN0IG5ldF9kZXZpY2UgKm5kZXY7DQogCXN0cnVj
dCBkZXZpY2UgKmRldjsgLyogZG1hLW1hcHBpbmcgZGV2aWNlICovDQpAQCAtMTc4LDYgKzE4NSw3
IEBAIHN0cnVjdCBlbmV0Y19uZGV2X3ByaXYgew0KIAl1MTYgcnhfYmRfY291bnQsIHR4X2JkX2Nv
dW50Ow0KIA0KIAl1MTYgbXNnX2VuYWJsZTsNCisJaW50IGh3X2ZlYXR1cmVzOw0KIA0KIAlzdHJ1
Y3QgZW5ldGNfYmRyICp0eF9yaW5nWzE2XTsNCiAJc3RydWN0IGVuZXRjX2JkciAqcnhfcmluZ1sx
Nl07DQpAQCAtMjE2LDYgKzIyNCw3IEBAIG5ldGRldl90eF90IGVuZXRjX3htaXQoc3RydWN0IHNr
X2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYpOw0KIHN0cnVjdCBuZXRfZGV2aWNl
X3N0YXRzICplbmV0Y19nZXRfc3RhdHMoc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYpOw0KIGludCBl
bmV0Y19zZXRfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5kZXYsDQogCQkgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpOw0KK2ludCBlbmV0Y19pb2N0bChzdHJ1Y3QgbmV0X2Rl
dmljZSAqbmRldiwgc3RydWN0IGlmcmVxICpycSwgaW50IGNtZCk7DQogLyogZXRodG9vbCAqLw0K
IHZvaWQgZW5ldGNfc2V0X2V0aHRvb2xfb3BzKHN0cnVjdCBuZXRfZGV2aWNlICpuZGV2KTsNCiAN
CmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNf
aHcuaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Y19ody5oDQpp
bmRleCBkZjhlYjg4ODJkOTIuLjY1NTljZWY0YjA3ZCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Y19ody5oDQorKysgYi9kcml2ZXJzL25ldC9l
dGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNfaHcuaA0KQEAgLTM2MSw2ICszNjEsMTIgQEAg
dW5pb24gZW5ldGNfdHhfYmQgew0KIAkJdTggZV9mbGFnczsNCiAJCXU4IGZsYWdzOw0KIAl9IGV4
dDsgLyogVHggQkQgZXh0ZW5zaW9uICovDQorCXN0cnVjdCB7DQorCQlfX2xlMzIgdHN0YW1wOw0K
KwkJdTggcmVzZXJ2ZWRbMTBdOw0KKwkJdTggc3RhdHVzOw0KKwkJdTggZmxhZ3M7DQorCX0gd2I7
IC8qIHdyaXRlYmFjayBkZXNjcmlwdG9yICovDQogfTsNCiANCiAjZGVmaW5lIEVORVRDX1RYQkRf
RkxBR1NfTDRDUwlCSVQoMCkNCkBAIC0zOTksNiArNDA1LDkgQEAgdW5pb24gZW5ldGNfcnhfYmQg
ew0KIAlzdHJ1Y3Qgew0KIAkJX19sZTY0IGFkZHI7DQogCQl1OCByZXNlcnZlZFs4XTsNCisjaWZk
ZWYgQ09ORklHX0ZTTF9FTkVUQ19IV19USU1FU1RBTVBJTkcNCisJCXU4IHJlc2VydmVkMVsxNl07
DQorI2VuZGlmDQogCX0gdzsNCiAJc3RydWN0IHsNCiAJCV9fbGUxNiBpbmV0X2NzdW07DQpAQCAt
NDEzLDYgKzQyMiwxMCBAQCB1bmlvbiBlbmV0Y19yeF9iZCB7DQogCQkJfTsNCiAJCQlfX2xlMzIg
bHN0YXR1czsNCiAJCX07DQorI2lmZGVmIENPTkZJR19GU0xfRU5FVENfSFdfVElNRVNUQU1QSU5H
DQorCQlfX2xlMzIgdHN0YW1wOw0KKwkJdTggcmVzZXJ2ZWRbMTJdOw0KKyNlbmRpZg0KIAl9IHI7
DQogfTsNCiANCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5l
dGMvZW5ldGNfcGYuYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0
Y19wZi5jDQppbmRleCAxNTg3NmE2ZTc1OTguLjE3ZTkwMTdjZjg5NyAxMDA2NDQNCi0tLSBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Y19wZi5jDQorKysgYi9kcml2
ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNfcGYuYw0KQEAgLTcwMiw2ICs3
MDIsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IG5ldF9kZXZpY2Vfb3BzIGVuZXRjX25kZXZfb3Bz
ID0gew0KIAkubmRvX3NldF92Zl92bGFuCT0gZW5ldGNfcGZfc2V0X3ZmX3ZsYW4sDQogCS5uZG9f
c2V0X3ZmX3Nwb29mY2hrCT0gZW5ldGNfcGZfc2V0X3ZmX3Nwb29mY2hrLA0KIAkubmRvX3NldF9m
ZWF0dXJlcwk9IGVuZXRjX3BmX3NldF9mZWF0dXJlcywNCisJLm5kb19kb19pb2N0bAkJPSBlbmV0
Y19pb2N0bCwNCiB9Ow0KIA0KIHN0YXRpYyB2b2lkIGVuZXRjX3BmX25ldGRldl9zZXR1cChzdHJ1
Y3QgZW5ldGNfc2kgKnNpLCBzdHJ1Y3QgbmV0X2RldmljZSAqbmRldiwNCmRpZmYgLS1naXQgYS9k
cml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2NhbGUvZW5ldGMvZW5ldGNfdmYuYyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L2ZyZWVzY2FsZS9lbmV0Yy9lbmV0Y192Zi5jDQppbmRleCA2NGJlYmVlOWY1
MmEuLmFmOTNjYjFhZjUxMyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2ZyZWVz
Y2FsZS9lbmV0Yy9lbmV0Y192Zi5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9mcmVlc2Nh
bGUvZW5ldGMvZW5ldGNfdmYuYw0KQEAgLTExMSw2ICsxMTEsNyBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IG5ldF9kZXZpY2Vfb3BzIGVuZXRjX25kZXZfb3BzID0gew0KIAkubmRvX2dldF9zdGF0cwkJ
PSBlbmV0Y19nZXRfc3RhdHMsDQogCS5uZG9fc2V0X21hY19hZGRyZXNzCT0gZW5ldGNfdmZfc2V0
X21hY19hZGRyLA0KIAkubmRvX3NldF9mZWF0dXJlcwk9IGVuZXRjX3ZmX3NldF9mZWF0dXJlcywN
CisJLm5kb19kb19pb2N0bAkJPSBlbmV0Y19pb2N0bCwNCiB9Ow0KIA0KIHN0YXRpYyB2b2lkIGVu
ZXRjX3ZmX25ldGRldl9zZXR1cChzdHJ1Y3QgZW5ldGNfc2kgKnNpLCBzdHJ1Y3QgbmV0X2Rldmlj
ZSAqbmRldiwNCi0tIA0KMi4xNy4xDQoNCg==
