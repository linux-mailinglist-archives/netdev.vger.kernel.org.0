Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 009AD11FE21
	for <lists+netdev@lfdr.de>; Mon, 16 Dec 2019 06:40:38 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726612AbfLPFkS (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Mon, 16 Dec 2019 00:40:18 -0500
Received: from mailgw01.mediatek.com ([210.61.82.183]:38802 "EHLO
        mailgw01.mediatek.com" rhost-flags-OK-FAIL-OK-FAIL) by vger.kernel.org
        with ESMTP id S1726191AbfLPFkS (ORCPT
        <rfc822;netdev@vger.kernel.org>); Mon, 16 Dec 2019 00:40:18 -0500
X-UUID: f2e4a8f7672f49c48fc2c99466bfa7dd-20191216
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=mediatek.com; s=dk;
        h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-ID:Date:Subject:CC:To:From; bh=XgzVOi17Vs8h7Os6AUr7k8KXtqKn1aJ/ASp808k2SkU=;
        b=gxVKPISfe055DTbP8PeQzWNE24kQMRuGuR/kyttsa8s5EORMNVPFhLWBBTqVlUsBTePPpNKeCqW9LpFhT2S/r2fEhPByjlgD6MTZjmN2N+0JUHzQY/8etNd8VKhXdc6fQqpgAOAgV7ODQ+sZ3QGYiM6Bg7mBwgooUM62kNAOOdA=;
X-UUID: f2e4a8f7672f49c48fc2c99466bfa7dd-20191216
Received: from mtkexhb02.mediatek.inc [(172.21.101.103)] by mailgw01.mediatek.com
        (envelope-from <biao.huang@mediatek.com>)
        (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
        with ESMTP id 105678265; Mon, 16 Dec 2019 13:40:09 +0800
Received: from MTKCAS06.mediatek.inc (172.21.101.30) by
 mtkmbs08n2.mediatek.inc (172.21.101.56) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Mon, 16 Dec 2019 13:38:57 +0800
Received: from localhost.localdomain (10.17.3.153) by MTKCAS06.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Mon, 16 Dec 2019 13:39:21 +0800
From:   Biao Huang <biao.huang@mediatek.com>
To:     <davem@davemloft.net>, Rob Herring <robh+dt@kernel.org>,
        Andrew Lunn <andrew@lunn.ch>
CC:     Mark Rutland <mark.rutland@arm.com>,
        Giuseppe Cavallaro <peppe.cavallaro@st.com>,
        Alexandre Torgue <alexandre.torgue@st.com>,
        Jose Abreu <joabreu@synopsys.com>,
        Maxime Coquelin <mcoquelin.stm32@gmail.com>,
        Matthias Brugger <matthias.bgg@gmail.com>,
        Biao Huang <biao.huang@mediatek.com>, <netdev@vger.kernel.org>,
        <devicetree@vger.kernel.org>, <linux-kernel@vger.kernel.org>,
        <linux-stm32@st-md-mailman.stormreply.com>,
        <linux-arm-kernel@lists.infradead.org>,
        <linux-mediatek@lists.infradead.org>, <yt.shen@mediatek.com>
Subject: [v2, PATCH 1/2] net-next: stmmac: mediatek: add more support for RMII
Date:   Mon, 16 Dec 2019 13:39:57 +0800
Message-ID: <20191216053958.26130-2-biao.huang@mediatek.com>
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20191216053958.26130-1-biao.huang@mediatek.com>
References: <20191216053958.26130-1-biao.huang@mediatek.com>
MIME-Version: 1.0
Content-Type: text/plain
X-TM-SNTS-SMTP: FFD112F3E34E808E1A08A0EBFFB5922AF512472578675134A16BFA7B742593E12000:8
X-MTK:  N
Content-Transfer-Encoding: base64
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

TVQyNzEyIFNvQyBjYW4gcHJvdmlkZSB0aGUgcm1paSByZWZlcmVuY2UgY2xvY2ssIGFuZCB0aGUg
Y2xvY2sNCndpbGwgb3V0cHV0IGZyb20gVFhDIHBpbiBvbmx5LCB3aGljaCBtZWFucyByZWZfY2xr
IHBpbiBvZiBleHRlcm5hbA0KUEhZIHNob3VsZCBjb25uZWN0IHRvIFRYQyBwaW4gaW4gdGhpcyBj
YXNlLg0KQWRkIGNvcnJlc3BvbmRpbmcgY2xvY2sgYW5kIHRpbWluZyBzZXR0aW5ncy4NCg0KU2ln
bmVkLW9mZi1ieTogQmlhbyBIdWFuZyA8Ymlhby5odWFuZ0BtZWRpYXRlay5jb20+DQotLS0NCiAu
Li4vZXRoZXJuZXQvc3RtaWNyby9zdG1tYWMvZHdtYWMtbWVkaWF0ZWsuYyAgfCA4OSArKysrKysr
KysrKysrLS0tLS0tDQogMSBmaWxlIGNoYW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDI5IGRlbGV0
aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvc3RtaWNyby9zdG1t
YWMvZHdtYWMtbWVkaWF0ZWsuYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L3N0bWljcm8vc3RtbWFj
L2R3bWFjLW1lZGlhdGVrLmMNCmluZGV4IGJkYjgwNDIxYWNhYy4uOWU0YjgzODMyOTM4IDEwMDY0
NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvc3RtaWNyby9zdG1tYWMvZHdtYWMtbWVkaWF0
ZWsuYw0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvc3RtaWNyby9zdG1tYWMvZHdtYWMtbWVk
aWF0ZWsuYw0KQEAgLTU1LDYgKzU1LDggQEAgc3RydWN0IG1lZGlhdGVrX2R3bWFjX3BsYXRfZGF0
YSB7DQogCXN0cnVjdCByZWdtYXAgKnBlcmlfcmVnbWFwOw0KIAlzdHJ1Y3QgZGV2aWNlICpkZXY7
DQogCXBoeV9pbnRlcmZhY2VfdCBwaHlfbW9kZTsNCisJaW50IG51bV9jbGtzX3RvX2NvbmZpZzsN
CisJYm9vbCBybWlpX2Nsa19mcm9tX21hYzsNCiAJYm9vbCBybWlpX3J4YzsNCiB9Ow0KIA0KQEAg
LTczLDIxICs3NSwzMyBAQCBzdHJ1Y3QgbWVkaWF0ZWtfZHdtYWNfdmFyaWFudCB7DQogDQogLyog
bGlzdCBvZiBjbG9ja3MgcmVxdWlyZWQgZm9yIG1hYyAqLw0KIHN0YXRpYyBjb25zdCBjaGFyICog
Y29uc3QgbXQyNzEyX2R3bWFjX2Nsa19sW10gPSB7DQotCSJheGkiLCAiYXBiIiwgIm1hY19tYWlu
IiwgInB0cF9yZWYiDQorCSJheGkiLCAiYXBiIiwgIm1hY19tYWluIiwgInB0cF9yZWYiLCAicm1p
aV9pbnRlcm5hbCINCiB9Ow0KIA0KIHN0YXRpYyBpbnQgbXQyNzEyX3NldF9pbnRlcmZhY2Uoc3Ry
dWN0IG1lZGlhdGVrX2R3bWFjX3BsYXRfZGF0YSAqcGxhdCkNCiB7DQorCWludCBybWlpX2Nsa19m
cm9tX21hYyA9IHBsYXQtPnJtaWlfY2xrX2Zyb21fbWFjID8gUk1JSV9DTEtfU1JDX0lOVEVSTkFM
IDogMDsNCiAJaW50IHJtaWlfcnhjID0gcGxhdC0+cm1paV9yeGMgPyBSTUlJX0NMS19TUkNfUlhD
IDogMDsNCiAJdTMyIGludGZfdmFsID0gMDsNCiANCisJLyogVGhlIGNsb2NrIGxhYmVsZWQgYXMg
InJtaWlfaW50ZXJuYWwiIGluIG10MjcxMl9kd21hY19jbGtfbCBpcyBuZWVkZWQNCisJICogb25s
eSBpbiBSTUlJKHdoZW4gTUFDIHByb3ZpZGVzIHRoZSByZWZlcmVuY2UgY2xvY2spLCBhbmQgdXNl
bGVzcyBmb3INCisJICogUkdNSUkvTUlJL1JNSUkod2hlbiBQSFkgcHJvdmlkZXMgdGhlIHJlZmVy
ZW5jZSBjbG9jaykuDQorCSAqIG51bV9jbGtzX3RvX2NvbmZpZyBpbmRpY2F0ZXMgdGhlIHJlYWwg
bnVtYmVyIG9mIGNsb2NrcyBzaG91bGQgYmUNCisJICogY29uZmlndXJlZCwgZXF1YWxzIHRvIChw
bGF0LT52YXJpYW50LT5udW1fY2xrcyAtIDEpIGluIGRlZmF1bHQgZm9yIGFsbCB0aGUgY2FzZSwN
CisJICogdGhlbiArMSBmb3Igcm1paV9jbGtfZnJvbV9tYWMgY2FzZS4NCisJICovDQorCXBsYXQt
Pm51bV9jbGtzX3RvX2NvbmZpZyA9IHBsYXQtPnZhcmlhbnQtPm51bV9jbGtzIC0gMTsNCisNCiAJ
Lyogc2VsZWN0IHBoeSBpbnRlcmZhY2UgaW4gdG9wIGNvbnRyb2wgZG9tYWluICovDQogCXN3aXRj
aCAocGxhdC0+cGh5X21vZGUpIHsNCiAJY2FzZSBQSFlfSU5URVJGQUNFX01PREVfTUlJOg0KIAkJ
aW50Zl92YWwgfD0gUEhZX0lOVEZfTUlJOw0KIAkJYnJlYWs7DQogCWNhc2UgUEhZX0lOVEVSRkFD
RV9NT0RFX1JNSUk6DQotCQlpbnRmX3ZhbCB8PSAoUEhZX0lOVEZfUk1JSSB8IHJtaWlfcnhjKTsN
CisJCWlmIChwbGF0LT5ybWlpX2Nsa19mcm9tX21hYykNCisJCQlwbGF0LT5udW1fY2xrc190b19j
b25maWcrKzsNCisJCWludGZfdmFsIHw9IChQSFlfSU5URl9STUlJIHwgcm1paV9yeGMgfCBybWlp
X2Nsa19mcm9tX21hYyk7DQogCQlicmVhazsNCiAJY2FzZSBQSFlfSU5URVJGQUNFX01PREVfUkdN
SUk6DQogCWNhc2UgUEhZX0lOVEVSRkFDRV9NT0RFX1JHTUlJX1RYSUQ6DQpAQCAtMTczLDM1ICsx
ODcsNTAgQEAgc3RhdGljIGludCBtdDI3MTJfc2V0X2RlbGF5KHN0cnVjdCBtZWRpYXRla19kd21h
Y19wbGF0X2RhdGEgKnBsYXQpDQogCQlkZWxheV92YWwgfD0gRklFTERfUFJFUChFVEhfRExZX1JY
Q19JTlYsIG1hY19kZWxheS0+cnhfaW52KTsNCiAJCWJyZWFrOw0KIAljYXNlIFBIWV9JTlRFUkZB
Q0VfTU9ERV9STUlJOg0KLQkJLyogdGhlIHJtaWkgcmVmZXJlbmNlIGNsb2NrIGlzIGZyb20gZXh0
ZXJuYWwgcGh5LA0KLQkJICogYW5kIHRoZSBwcm9wZXJ0eSAicm1paV9yeGMiIGluZGljYXRlcyB3
aGljaCBwaW4oVFhDL1JYQykNCi0JCSAqIHRoZSByZWZlcmVuY2UgY2xrIGlzIGNvbm5lY3RlZCB0
by4gVGhlIHJlZmVyZW5jZSBjbG9jayBpcyBhDQotCQkgKiByZWNlaXZlZCBzaWduYWwsIHNvIHJ4
X2RlbGF5L3J4X2ludiBhcmUgdXNlZCB0byBpbmRpY2F0ZQ0KLQkJICogdGhlIHJlZmVyZW5jZSBj
bG9jayB0aW1pbmcgYWRqdXN0bWVudA0KLQkJICovDQotCQlpZiAocGxhdC0+cm1paV9yeGMpIHsN
Ci0JCQkvKiB0aGUgcm1paSByZWZlcmVuY2UgY2xvY2sgZnJvbSBvdXRzaWRlIGlzIGNvbm5lY3Rl
ZA0KLQkJCSAqIHRvIFJYQyBwaW4sIHRoZSByZWZlcmVuY2UgY2xvY2sgd2lsbCBiZSBhZGp1c3Rl
ZA0KLQkJCSAqIGJ5IFJYQyBkZWxheSBtYWNybyBjaXJjdWl0Lg0KLQkJCSAqLw0KLQkJCWRlbGF5
X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlfUlhDX0VOQUJMRSwgISFtYWNfZGVsYXktPnJ4X2Rl
bGF5KTsNCi0JCQlkZWxheV92YWwgfD0gRklFTERfUFJFUChFVEhfRExZX1JYQ19TVEFHRVMsIG1h
Y19kZWxheS0+cnhfZGVsYXkpOw0KLQkJCWRlbGF5X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlf
UlhDX0lOViwgbWFjX2RlbGF5LT5yeF9pbnYpOw0KLQkJfSBlbHNlIHsNCi0JCQkvKiB0aGUgcm1p
aSByZWZlcmVuY2UgY2xvY2sgZnJvbSBvdXRzaWRlIGlzIGNvbm5lY3RlZA0KLQkJCSAqIHRvIFRY
QyBwaW4sIHRoZSByZWZlcmVuY2UgY2xvY2sgd2lsbCBiZSBhZGp1c3RlZA0KLQkJCSAqIGJ5IFRY
QyBkZWxheSBtYWNybyBjaXJjdWl0Lg0KKwkJaWYgKHBsYXQtPnJtaWlfY2xrX2Zyb21fbWFjKSB7
DQorCQkJLyogY2FzZSAxOiBtYWMgcHJvdmlkZXMgdGhlIHJtaWkgcmVmZXJlbmNlIGNsb2NrLA0K
KwkJCSAqIGFuZCB0aGUgY2xvY2sgb3V0cHV0IHRvIFRYQyBwaW4uDQorCQkJICogVGhlIGVncmVz
cyB0aW1pbmcgY2FuIGJlIGFkanVzdGVkIGJ5IEdUWEMgZGVsYXkgbWFjcm8gY2lyY3VpdC4NCisJ
CQkgKiBUaGUgaW5ncmVzcyB0aW1pbmcgY2FuIGJlIGFkanVzdGVkIGJ5IFRYQyBkZWxheSBtYWNy
byBjaXJjdWl0Lg0KIAkJCSAqLw0KIAkJCWRlbGF5X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlf
VFhDX0VOQUJMRSwgISFtYWNfZGVsYXktPnJ4X2RlbGF5KTsNCiAJCQlkZWxheV92YWwgfD0gRklF
TERfUFJFUChFVEhfRExZX1RYQ19TVEFHRVMsIG1hY19kZWxheS0+cnhfZGVsYXkpOw0KIAkJCWRl
bGF5X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlfVFhDX0lOViwgbWFjX2RlbGF5LT5yeF9pbnYp
Ow0KKw0KKwkJCWRlbGF5X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlfR1RYQ19FTkFCTEUsICEh
bWFjX2RlbGF5LT50eF9kZWxheSk7DQorCQkJZGVsYXlfdmFsIHw9IEZJRUxEX1BSRVAoRVRIX0RM
WV9HVFhDX1NUQUdFUywgbWFjX2RlbGF5LT50eF9kZWxheSk7DQorCQkJZGVsYXlfdmFsIHw9IEZJ
RUxEX1BSRVAoRVRIX0RMWV9HVFhDX0lOViwgbWFjX2RlbGF5LT50eF9pbnYpOw0KKwkJfSBlbHNl
IHsNCisJCQkvKiBjYXNlIDI6IHRoZSBybWlpIHJlZmVyZW5jZSBjbG9jayBpcyBmcm9tIGV4dGVy
bmFsIHBoeSwNCisJCQkgKiBhbmQgdGhlIHByb3BlcnR5ICJybWlpX3J4YyIgaW5kaWNhdGVzIHdo
aWNoIHBpbihUWEMvUlhDKQ0KKwkJCSAqIHRoZSByZWZlcmVuY2UgY2xrIGlzIGNvbm5lY3RlZCB0
by4gVGhlIHJlZmVyZW5jZSBjbG9jayBpcyBhDQorCQkJICogcmVjZWl2ZWQgc2lnbmFsLCBzbyBy
eF9kZWxheS9yeF9pbnYgYXJlIHVzZWQgdG8gaW5kaWNhdGUNCisJCQkgKiB0aGUgcmVmZXJlbmNl
IGNsb2NrIHRpbWluZyBhZGp1c3RtZW50DQorCQkJICovDQorCQkJaWYgKHBsYXQtPnJtaWlfcnhj
KSB7DQorCQkJCS8qIHRoZSBybWlpIHJlZmVyZW5jZSBjbG9jayBmcm9tIG91dHNpZGUgaXMgY29u
bmVjdGVkDQorCQkJCSAqIHRvIFJYQyBwaW4sIHRoZSByZWZlcmVuY2UgY2xvY2sgd2lsbCBiZSBh
ZGp1c3RlZA0KKwkJCQkgKiBieSBSWEMgZGVsYXkgbWFjcm8gY2lyY3VpdC4NCisJCQkJICovDQor
CQkJCWRlbGF5X3ZhbCB8PSBGSUVMRF9QUkVQKEVUSF9ETFlfUlhDX0VOQUJMRSwgISFtYWNfZGVs
YXktPnJ4X2RlbGF5KTsNCisJCQkJZGVsYXlfdmFsIHw9IEZJRUxEX1BSRVAoRVRIX0RMWV9SWENf
U1RBR0VTLCBtYWNfZGVsYXktPnJ4X2RlbGF5KTsNCisJCQkJZGVsYXlfdmFsIHw9IEZJRUxEX1BS
RVAoRVRIX0RMWV9SWENfSU5WLCBtYWNfZGVsYXktPnJ4X2ludik7DQorCQkJfSBlbHNlIHsNCisJ
CQkJLyogdGhlIHJtaWkgcmVmZXJlbmNlIGNsb2NrIGZyb20gb3V0c2lkZSBpcyBjb25uZWN0ZWQN
CisJCQkJICogdG8gVFhDIHBpbiwgdGhlIHJlZmVyZW5jZSBjbG9jayB3aWxsIGJlIGFkanVzdGVk
DQorCQkJCSAqIGJ5IFRYQyBkZWxheSBtYWNybyBjaXJjdWl0Lg0KKwkJCQkgKi8NCisJCQkJZGVs
YXlfdmFsIHw9IEZJRUxEX1BSRVAoRVRIX0RMWV9UWENfRU5BQkxFLCAhIW1hY19kZWxheS0+cnhf
ZGVsYXkpOw0KKwkJCQlkZWxheV92YWwgfD0gRklFTERfUFJFUChFVEhfRExZX1RYQ19TVEFHRVMs
IG1hY19kZWxheS0+cnhfZGVsYXkpOw0KKwkJCQlkZWxheV92YWwgfD0gRklFTERfUFJFUChFVEhf
RExZX1RYQ19JTlYsIG1hY19kZWxheS0+cnhfaW52KTsNCisJCQl9DQorCQkJLyogdHhfaW52IHdp
bGwgaW52ZXJzZSB0aGUgdHggY2xvY2sgaW5zaWRlIG1hYyByZWxhdGVpdmUgdG8NCisJCQkgKiBy
ZWZlcmVuY2UgY2xvY2sgZnJvbSBleHRlcm5hbCBwaHksDQorCQkJICogYW5kIHRoaXMgYml0IGlz
IGxvY2F0ZWQgaW4gdGhlIHNhbWUgcmVnaXN0ZXIgd2l0aCBmaW5lLXR1bmUNCisJCQkgKi8NCisJ
CQlpZiAobWFjX2RlbGF5LT50eF9pbnYpDQorCQkJCWZpbmVfdmFsID0gRVRIX1JNSUlfRExZX1RY
X0lOVjsNCiAJCX0NCi0JCS8qIHR4X2ludiB3aWxsIGludmVyc2UgdGhlIHR4IGNsb2NrIGluc2lk
ZSBtYWMgcmVsYXRlaXZlIHRvDQotCQkgKiByZWZlcmVuY2UgY2xvY2sgZnJvbSBleHRlcm5hbCBw
aHksDQotCQkgKiBhbmQgdGhpcyBiaXQgaXMgbG9jYXRlZCBpbiB0aGUgc2FtZSByZWdpc3RlciB3
aXRoIGZpbmUtdHVuZQ0KLQkJICovDQotCQlpZiAobWFjX2RlbGF5LT50eF9pbnYpDQotCQkJZmlu
ZV92YWwgPSBFVEhfUk1JSV9ETFlfVFhfSU5WOw0KIAkJYnJlYWs7DQogCWNhc2UgUEhZX0lOVEVS
RkFDRV9NT0RFX1JHTUlJOg0KIAljYXNlIFBIWV9JTlRFUkZBQ0VfTU9ERV9SR01JSV9UWElEOg0K
QEAgLTI3OCw2ICszMDcsNyBAQCBzdGF0aWMgaW50IG1lZGlhdGVrX2R3bWFjX2NvbmZpZ19kdChz
dHJ1Y3QgbWVkaWF0ZWtfZHdtYWNfcGxhdF9kYXRhICpwbGF0KQ0KIAltYWNfZGVsYXktPnR4X2lu
diA9IG9mX3Byb3BlcnR5X3JlYWRfYm9vbChwbGF0LT5ucCwgIm1lZGlhdGVrLHR4Yy1pbnZlcnNl
Iik7DQogCW1hY19kZWxheS0+cnhfaW52ID0gb2ZfcHJvcGVydHlfcmVhZF9ib29sKHBsYXQtPm5w
LCAibWVkaWF0ZWsscnhjLWludmVyc2UiKTsNCiAJcGxhdC0+cm1paV9yeGMgPSBvZl9wcm9wZXJ0
eV9yZWFkX2Jvb2wocGxhdC0+bnAsICJtZWRpYXRlayxybWlpLXJ4YyIpOw0KKwlwbGF0LT5ybWlp
X2Nsa19mcm9tX21hYyA9IG9mX3Byb3BlcnR5X3JlYWRfYm9vbChwbGF0LT5ucCwgIm1lZGlhdGVr
LHJtaWktY2xrLWZyb20tbWFjIik7DQogDQogCXJldHVybiAwOw0KIH0NCkBAIC0yOTQsNiArMzI0
LDggQEAgc3RhdGljIGludCBtZWRpYXRla19kd21hY19jbGtfaW5pdChzdHJ1Y3QgbWVkaWF0ZWtf
ZHdtYWNfcGxhdF9kYXRhICpwbGF0KQ0KIAlmb3IgKGkgPSAwOyBpIDwgbnVtOyBpKyspDQogCQlw
bGF0LT5jbGtzW2ldLmlkID0gdmFyaWFudC0+Y2xrX2xpc3RbaV07DQogDQorCXBsYXQtPm51bV9j
bGtzX3RvX2NvbmZpZyA9IHZhcmlhbnQtPm51bV9jbGtzOw0KKw0KIAlyZXR1cm4gZGV2bV9jbGtf
YnVsa19nZXQocGxhdC0+ZGV2LCBudW0sIHBsYXQtPmNsa3MpOw0KIH0NCiANCkBAIC0zMjEsNyAr
MzUzLDcgQEAgc3RhdGljIGludCBtZWRpYXRla19kd21hY19pbml0KHN0cnVjdCBwbGF0Zm9ybV9k
ZXZpY2UgKnBkZXYsIHZvaWQgKnByaXYpDQogCQlyZXR1cm4gcmV0Ow0KIAl9DQogDQotCXJldCA9
IGNsa19idWxrX3ByZXBhcmVfZW5hYmxlKHZhcmlhbnQtPm51bV9jbGtzLCBwbGF0LT5jbGtzKTsN
CisJcmV0ID0gY2xrX2J1bGtfcHJlcGFyZV9lbmFibGUocGxhdC0+bnVtX2Nsa3NfdG9fY29uZmln
LCBwbGF0LT5jbGtzKTsNCiAJaWYgKHJldCkgew0KIAkJZGV2X2VycihwbGF0LT5kZXYsICJmYWls
ZWQgdG8gZW5hYmxlIGNsa3MsIGVyciA9ICVkXG4iLCByZXQpOw0KIAkJcmV0dXJuIHJldDsNCkBA
IC0zMzYsOSArMzY4LDggQEAgc3RhdGljIGludCBtZWRpYXRla19kd21hY19pbml0KHN0cnVjdCBw
bGF0Zm9ybV9kZXZpY2UgKnBkZXYsIHZvaWQgKnByaXYpDQogc3RhdGljIHZvaWQgbWVkaWF0ZWtf
ZHdtYWNfZXhpdChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LCB2b2lkICpwcml2KQ0KIHsN
CiAJc3RydWN0IG1lZGlhdGVrX2R3bWFjX3BsYXRfZGF0YSAqcGxhdCA9IHByaXY7DQotCWNvbnN0
IHN0cnVjdCBtZWRpYXRla19kd21hY192YXJpYW50ICp2YXJpYW50ID0gcGxhdC0+dmFyaWFudDsN
CiANCi0JY2xrX2J1bGtfZGlzYWJsZV91bnByZXBhcmUodmFyaWFudC0+bnVtX2Nsa3MsIHBsYXQt
PmNsa3MpOw0KKwljbGtfYnVsa19kaXNhYmxlX3VucHJlcGFyZShwbGF0LT5udW1fY2xrc190b19j
b25maWcsIHBsYXQtPmNsa3MpOw0KIA0KIAlwbV9ydW50aW1lX3B1dF9zeW5jKCZwZGV2LT5kZXYp
Ow0KIAlwbV9ydW50aW1lX2Rpc2FibGUoJnBkZXYtPmRldik7DQotLSANCjIuMTguMA0K

