Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id A1E3C10103
	for <lists+netdev@lfdr.de>; Tue, 30 Apr 2019 22:40:00 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727094AbfD3Uj7 (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Tue, 30 Apr 2019 16:39:59 -0400
Received: from mail-eopbgr10048.outbound.protection.outlook.com ([40.107.1.48]:9176
        "EHLO EUR02-HE1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1726372AbfD3Uj6 (ORCPT <rfc822;netdev@vger.kernel.org>);
        Tue, 30 Apr 2019 16:39:58 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=ROkDJictJ400lpYDcxrn42fRRMDGCGJZKz85eJiDTKU=;
 b=bGvztbCd/imqirTrTOCnexA0FgzJnjefYYc8MUBhy7gQtMY+a4D5wZe/wunlt/X94Abhvt25H59We35vfyOr2p/WWNfQB0KOkAesSvK6i0xS7uauv6UL7msX/oa/TMCp4hLQQX7ZzV0XyfI7Y4A5VLPQdxb3Bm8tK1iApgv4uVE=
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com (20.178.125.223) by
 VI1PR05MB6542.eurprd05.prod.outlook.com (20.179.27.149) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1835.15; Tue, 30 Apr 2019 20:39:50 +0000
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::1d74:be4b:cfe9:59a2]) by VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::1d74:be4b:cfe9:59a2%5]) with mapi id 15.20.1835.018; Tue, 30 Apr 2019
 20:39:50 +0000
From:   Saeed Mahameed <saeedm@mellanox.com>
To:     "David S. Miller" <davem@davemloft.net>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        Eli Britstein <elibr@mellanox.com>,
        Oz Shlomo <ozsh@mellanox.com>,
        Saeed Mahameed <saeedm@mellanox.com>
Subject: [net-next 03/15] net/mlx5e: ACLs for priority tag mode
Thread-Topic: [net-next 03/15] net/mlx5e: ACLs for priority tag mode
Thread-Index: AQHU/5TbgLEQO2NtcEG69Xozj7MXYQ==
Date:   Tue, 30 Apr 2019 20:39:50 +0000
Message-ID: <20190430203926.19284-4-saeedm@mellanox.com>
References: <20190430203926.19284-1-saeedm@mellanox.com>
In-Reply-To: <20190430203926.19284-1-saeedm@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.20.1
x-originating-ip: [209.116.155.178]
x-clientproxiedby: BYAPR02CA0055.namprd02.prod.outlook.com
 (2603:10b6:a03:54::32) To VI1PR05MB5902.eurprd05.prod.outlook.com
 (2603:10a6:803:df::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=saeedm@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: af3ed1bb-1a70-472b-8db2-08d6cdabfdba
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(4618075)(2017052603328)(7193020);SRVR:VI1PR05MB6542;
x-ms-traffictypediagnostic: VI1PR05MB6542:
x-microsoft-antispam-prvs: <VI1PR05MB654226602DAF1B30756E2E70BE3A0@VI1PR05MB6542.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:2803;
x-forefront-prvs: 00235A1EEF
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(136003)(346002)(376002)(396003)(366004)(39860400002)(189003)(199004)(99286004)(25786009)(102836004)(53936002)(36756003)(386003)(478600001)(186003)(6506007)(7736002)(26005)(2616005)(476003)(446003)(52116002)(6436002)(4326008)(305945005)(5660300002)(76176011)(486006)(66066001)(11346002)(14454004)(107886003)(6512007)(6486002)(68736007)(71200400001)(2906002)(30864003)(6916009)(81166006)(316002)(1076003)(97736004)(81156014)(66446008)(64756008)(66556008)(50226002)(66476007)(66946007)(73956011)(8936002)(54906003)(256004)(8676002)(3846002)(86362001)(14444005)(6116002)(71190400001);DIR:OUT;SFP:1101;SCL:1;SRVR:VI1PR05MB6542;H:VI1PR05MB5902.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: oSeEsBI56hML/Di5tKIvBjJyBo9GHVKYf67UmnlYk/u13BpSpCHDDfuI5KqTsaf5dubiAGpWRj8w85otbdJ+Gu3ji+jz0XAkiDAKW1AcTEEXTwoFA7H+UJ0mttTsXa4eitgj7f1ZruesNM4G6WFurwarVTyppVjaWNr4gge/sdkmmJXluhwOZFISbuLtDZV92Rif+82pb/TJ7xgi4avgqGRoT/GZM3o1BxDMNbuMHfsez52FbOTAttheDDwtHUMfQUr2Qs77ZMvxmdjKbjc2sjEFrYam42O+utFIzlJpoYfIC14er6Dq45Qam+0QgWIkzvVipgWuuHSbrzQBhXp13rg8hS8ca2xhDHQQOhPHFO/UpdNkkEsxZaZixuOn/WOLQmOkFsdYnH7fTKcLvQCb4wd1asGxtigJc93r9oedVDo=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: af3ed1bb-1a70-472b-8db2-08d6cdabfdba
X-MS-Exchange-CrossTenant-originalarrivaltime: 30 Apr 2019 20:39:50.3069
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VI1PR05MB6542
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogRWxpIEJyaXRzdGVpbiA8ZWxpYnJAbWVsbGFub3guY29tPg0KDQpDdXJyZW50IENvbm5l
Y3RYIEhXIGlzIHVuYWJsZSB0byBwZXJmb3JtIFZMQU4gcG9wIGluIFRYIHBhdGggYW5kIFZMQU4N
CnB1c2ggb24gUlggcGF0aC4gQXMgYSB3b3JrYXJvdW5kLCB1bnRhZ2dlZCBwYWNrZXRzIGFyZSB0
YWdnZWQgd2l0aA0KVklEIDB4MDAwIGFsbG93aW5nIHBvcC9wdXNoIGFjdGlvbnMgdG8gYmUgZXhj
aGFuZ2VkIHdpdGggVkxBTiByZXdyaXRlDQphY3Rpb25zLg0KVXNlIHRoZSBpbmdyZXNzIEFDTCB0
YWJsZSwgcHJlY2VkaW5nIHRoZSBGREIsIHRvIHB1c2ggVkxBTiAweDAwMCBJRCB0YWcNCmZvciB1
bnRhZ2dlZCBwYWNrZXRzIGFuZCB0aGUgZWdyZXNzIEFDTCB0YWJsZSwgc3VjY2VlZGluZyB0aGUg
RkRCLCB0bw0KcG9wIFZMQU4gMHgwMDAgSUQgdGFnLg0KDQpTaWduZWQtb2ZmLWJ5OiBFbGkgQnJp
dHN0ZWluIDxlbGlickBtZWxsYW5veC5jb20+DQpSZXZpZXdlZC1ieTogT3ogU2hsb21vIDxvenNo
QG1lbGxhbm94LmNvbT4NClNpZ25lZC1vZmYtYnk6IFNhZWVkIE1haGFtZWVkIDxzYWVlZG1AbWVs
bGFub3guY29tPg0KLS0tDQogLi4uL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZXN3
aXRjaC5jIHwgIDI0ICstLQ0KIC4uLi9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vz
d2l0Y2guaCB8ICAxMiArKw0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZXN3aXRjaF9vZmZsb2Fk
cy5jICAgICB8IDE2OSArKysrKysrKysrKysrKysrKysNCiAzIGZpbGVzIGNoYW5nZWQsIDE5MyBp
bnNlcnRpb25zKCspLCAxMiBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoLmMgYi9kcml2ZXJzL25ldC9ldGhl
cm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZXN3aXRjaC5jDQppbmRleCA4YTY3ZmQxOTdiNzkuLmYw
ZWY0YWM1MWI0NSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21s
eDUvY29yZS9lc3dpdGNoLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21s
eDUvY29yZS9lc3dpdGNoLmMNCkBAIC05MjIsOCArOTIyLDggQEAgc3RhdGljIHZvaWQgZXN3X3Zw
b3J0X2NoYW5nZV9oYW5kbGVyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCiAJbXV0ZXhfdW5s
b2NrKCZlc3ctPnN0YXRlX2xvY2spOw0KIH0NCiANCi1zdGF0aWMgaW50IGVzd192cG9ydF9lbmFi
bGVfZWdyZXNzX2FjbChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQotCQkJCSAgICAgICBzdHJ1
Y3QgbWx4NV92cG9ydCAqdnBvcnQpDQoraW50IGVzd192cG9ydF9lbmFibGVfZWdyZXNzX2FjbChz
dHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQorCQkJCXN0cnVjdCBtbHg1X3Zwb3J0ICp2cG9ydCkN
CiB7DQogCWludCBpbmxlbiA9IE1MWDVfU1RfU1pfQllURVMoY3JlYXRlX2Zsb3dfZ3JvdXBfaW4p
Ow0KIAlzdHJ1Y3QgbWx4NV9mbG93X2dyb3VwICp2bGFuX2dycCA9IE5VTEw7DQpAQCAtMTAwNiw4
ICsxMDA2LDggQEAgc3RhdGljIGludCBlc3dfdnBvcnRfZW5hYmxlX2VncmVzc19hY2woc3RydWN0
IG1seDVfZXN3aXRjaCAqZXN3LA0KIAlyZXR1cm4gZXJyOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBl
c3dfdnBvcnRfY2xlYW51cF9lZ3Jlc3NfcnVsZXMoc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3LA0K
LQkJCQkJICAgc3RydWN0IG1seDVfdnBvcnQgKnZwb3J0KQ0KK3ZvaWQgZXN3X3Zwb3J0X2NsZWFu
dXBfZWdyZXNzX3J1bGVzKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCisJCQkJICAgIHN0cnVj
dCBtbHg1X3Zwb3J0ICp2cG9ydCkNCiB7DQogCWlmICghSVNfRVJSX09SX05VTEwodnBvcnQtPmVn
cmVzcy5hbGxvd2VkX3ZsYW4pKQ0KIAkJbWx4NV9kZWxfZmxvd19ydWxlcyh2cG9ydC0+ZWdyZXNz
LmFsbG93ZWRfdmxhbik7DQpAQCAtMTAxOSw4ICsxMDE5LDggQEAgc3RhdGljIHZvaWQgZXN3X3Zw
b3J0X2NsZWFudXBfZWdyZXNzX3J1bGVzKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCiAJdnBv
cnQtPmVncmVzcy5kcm9wX3J1bGUgPSBOVUxMOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBlc3dfdnBv
cnRfZGlzYWJsZV9lZ3Jlc3NfYWNsKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCi0JCQkJCSBz
dHJ1Y3QgbWx4NV92cG9ydCAqdnBvcnQpDQordm9pZCBlc3dfdnBvcnRfZGlzYWJsZV9lZ3Jlc3Nf
YWNsKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCisJCQkJICBzdHJ1Y3QgbWx4NV92cG9ydCAq
dnBvcnQpDQogew0KIAlpZiAoSVNfRVJSX09SX05VTEwodnBvcnQtPmVncmVzcy5hY2wpKQ0KIAkJ
cmV0dXJuOw0KQEAgLTEwMzYsOCArMTAzNiw4IEBAIHN0YXRpYyB2b2lkIGVzd192cG9ydF9kaXNh
YmxlX2VncmVzc19hY2woc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3LA0KIAl2cG9ydC0+ZWdyZXNz
LmFjbCA9IE5VTEw7DQogfQ0KIA0KLXN0YXRpYyBpbnQgZXN3X3Zwb3J0X2VuYWJsZV9pbmdyZXNz
X2FjbChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQotCQkJCQlzdHJ1Y3QgbWx4NV92cG9ydCAq
dnBvcnQpDQoraW50IGVzd192cG9ydF9lbmFibGVfaW5ncmVzc19hY2woc3RydWN0IG1seDVfZXN3
aXRjaCAqZXN3LA0KKwkJCQkgc3RydWN0IG1seDVfdnBvcnQgKnZwb3J0KQ0KIHsNCiAJaW50IGlu
bGVuID0gTUxYNV9TVF9TWl9CWVRFUyhjcmVhdGVfZmxvd19ncm91cF9pbik7DQogCXN0cnVjdCBt
bHg1X2NvcmVfZGV2ICpkZXYgPSBlc3ctPmRldjsNCkBAIC0xMTY4LDggKzExNjgsOCBAQCBzdGF0
aWMgaW50IGVzd192cG9ydF9lbmFibGVfaW5ncmVzc19hY2woc3RydWN0IG1seDVfZXN3aXRjaCAq
ZXN3LA0KIAlyZXR1cm4gZXJyOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBlc3dfdnBvcnRfY2xlYW51
cF9pbmdyZXNzX3J1bGVzKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCi0JCQkJCSAgICBzdHJ1
Y3QgbWx4NV92cG9ydCAqdnBvcnQpDQordm9pZCBlc3dfdnBvcnRfY2xlYW51cF9pbmdyZXNzX3J1
bGVzKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCisJCQkJICAgICBzdHJ1Y3QgbWx4NV92cG9y
dCAqdnBvcnQpDQogew0KIAlpZiAoIUlTX0VSUl9PUl9OVUxMKHZwb3J0LT5pbmdyZXNzLmRyb3Bf
cnVsZSkpDQogCQltbHg1X2RlbF9mbG93X3J1bGVzKHZwb3J0LT5pbmdyZXNzLmRyb3BfcnVsZSk7
DQpAQCAtMTE4MSw4ICsxMTgxLDggQEAgc3RhdGljIHZvaWQgZXN3X3Zwb3J0X2NsZWFudXBfaW5n
cmVzc19ydWxlcyhzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQogCXZwb3J0LT5pbmdyZXNzLmFs
bG93X3J1bGUgPSBOVUxMOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBlc3dfdnBvcnRfZGlzYWJsZV9p
bmdyZXNzX2FjbChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQotCQkJCQkgIHN0cnVjdCBtbHg1
X3Zwb3J0ICp2cG9ydCkNCit2b2lkIGVzd192cG9ydF9kaXNhYmxlX2luZ3Jlc3NfYWNsKHN0cnVj
dCBtbHg1X2Vzd2l0Y2ggKmVzdywNCisJCQkJICAgc3RydWN0IG1seDVfdnBvcnQgKnZwb3J0KQ0K
IHsNCiAJaWYgKElTX0VSUl9PUl9OVUxMKHZwb3J0LT5pbmdyZXNzLmFjbCkpDQogCQlyZXR1cm47
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vz
d2l0Y2guaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNo
LmgNCmluZGV4IDllY2M4YzllZWUzOS4uNDI0ZDQ1Y2Y5NDU0IDEwMDY0NA0KLS0tIGEvZHJpdmVy
cy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guaA0KKysrIGIvZHJpdmVy
cy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2guaA0KQEAgLTIyNyw2ICsy
MjcsMTggQEAgaW50IGVzd19vZmZsb2Fkc19pbml0KHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywg
aW50IHZmX252cG9ydHMsDQogCQkgICAgICBpbnQgdG90YWxfbnZwb3J0cyk7DQogdm9pZCBlc3df
b2ZmbG9hZHNfY2xlYW51cF9yZXBzKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdyk7DQogaW50IGVz
d19vZmZsb2Fkc19pbml0X3JlcHMoc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3KTsNCit2b2lkIGVz
d192cG9ydF9jbGVhbnVwX2luZ3Jlc3NfcnVsZXMoc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3LA0K
KwkJCQkgICAgIHN0cnVjdCBtbHg1X3Zwb3J0ICp2cG9ydCk7DQoraW50IGVzd192cG9ydF9lbmFi
bGVfaW5ncmVzc19hY2woc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3LA0KKwkJCQkgc3RydWN0IG1s
eDVfdnBvcnQgKnZwb3J0KTsNCit2b2lkIGVzd192cG9ydF9jbGVhbnVwX2VncmVzc19ydWxlcyhz
dHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQorCQkJCSAgICBzdHJ1Y3QgbWx4NV92cG9ydCAqdnBv
cnQpOw0KK2ludCBlc3dfdnBvcnRfZW5hYmxlX2VncmVzc19hY2woc3RydWN0IG1seDVfZXN3aXRj
aCAqZXN3LA0KKwkJCQlzdHJ1Y3QgbWx4NV92cG9ydCAqdnBvcnQpOw0KK3ZvaWQgZXN3X3Zwb3J0
X2Rpc2FibGVfZWdyZXNzX2FjbChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQorCQkJCSAgc3Ry
dWN0IG1seDVfdnBvcnQgKnZwb3J0KTsNCit2b2lkIGVzd192cG9ydF9kaXNhYmxlX2luZ3Jlc3Nf
YWNsKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdywNCisJCQkJICAgc3RydWN0IG1seDVfdnBvcnQg
KnZwb3J0KTsNCiANCiAvKiBFLVN3aXRjaCBBUEkgKi8NCiBpbnQgbWx4NV9lc3dpdGNoX2luaXQo
c3RydWN0IG1seDVfY29yZV9kZXYgKmRldik7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2hfb2ZmbG9hZHMuYyBiL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lc3dpdGNoX29mZmxvYWRzLmMNCmluZGV4IDg0
MDYzMDMwNWVkZS4uZjM3MWU3OWNiYzlmIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2hfb2ZmbG9hZHMuYw0KKysrIGIvZHJpdmVycy9u
ZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vzd2l0Y2hfb2ZmbG9hZHMuYw0KQEAgLTE2
MDEsNiArMTYwMSwxNjcgQEAgc3RhdGljIHZvaWQgZXN3X29mZmxvYWRzX2RldmNvbV9jbGVhbnVw
KHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdykNCiAJbWx4NV9kZXZjb21fdW5yZWdpc3Rlcl9jb21w
b25lbnQoZGV2Y29tLCBNTFg1X0RFVkNPTV9FU1dfT0ZGTE9BRFMpOw0KIH0NCiANCitzdGF0aWMg
aW50IGVzd192cG9ydF9pbmdyZXNzX3ByaW9fdGFnX2NvbmZpZyhzdHJ1Y3QgbWx4NV9lc3dpdGNo
ICplc3csDQorCQkJCQkgICAgIHN0cnVjdCBtbHg1X3Zwb3J0ICp2cG9ydCkNCit7DQorCXN0cnVj
dCBtbHg1X2NvcmVfZGV2ICpkZXYgPSBlc3ctPmRldjsNCisJc3RydWN0IG1seDVfZmxvd19hY3Qg
Zmxvd19hY3QgPSB7MH07DQorCXN0cnVjdCBtbHg1X2Zsb3dfc3BlYyAqc3BlYzsNCisJaW50IGVy
ciA9IDA7DQorDQorCS8qIEZvciBwcmlvIHRhZyBtb2RlLCB0aGVyZSBpcyBvbmx5IDEgRlRFczoN
CisJICogMSkgVW50YWdnZWQgcGFja2V0cyAtIHB1c2ggcHJpbyB0YWcgVkxBTiwgYWxsb3cNCisJ
ICogVW5tYXRjaGVkIHRyYWZmaWMgaXMgYWxsb3dlZCBieSBkZWZhdWx0DQorCSAqLw0KKw0KKwlp
ZiAoIU1MWDVfQ0FQX0VTV19JTkdSRVNTX0FDTChkZXYsIGZ0X3N1cHBvcnQpKQ0KKwkJcmV0dXJu
IC1FT1BOT1RTVVBQOw0KKw0KKwllc3dfdnBvcnRfY2xlYW51cF9pbmdyZXNzX3J1bGVzKGVzdywg
dnBvcnQpOw0KKw0KKwllcnIgPSBlc3dfdnBvcnRfZW5hYmxlX2luZ3Jlc3NfYWNsKGVzdywgdnBv
cnQpOw0KKwlpZiAoZXJyKSB7DQorCQltbHg1X2NvcmVfd2Fybihlc3ctPmRldiwNCisJCQkgICAg
ICAgImZhaWxlZCB0byBlbmFibGUgcHJpbyB0YWcgaW5ncmVzcyBhY2wgKCVkKSBvbiB2cG9ydFsl
ZF1cbiIsDQorCQkJICAgICAgIGVyciwgdnBvcnQtPnZwb3J0KTsNCisJCXJldHVybiBlcnI7DQor
CX0NCisNCisJZXN3X2RlYnVnKGVzdy0+ZGV2LA0KKwkJICAidnBvcnRbJWRdIGNvbmZpZ3VyZSBp
bmdyZXNzIHJ1bGVzXG4iLCB2cG9ydC0+dnBvcnQpOw0KKw0KKwlzcGVjID0ga3Z6YWxsb2Moc2l6
ZW9mKCpzcGVjKSwgR0ZQX0tFUk5FTCk7DQorCWlmICghc3BlYykgew0KKwkJZXJyID0gLUVOT01F
TTsNCisJCWdvdG8gb3V0X25vX21lbTsNCisJfQ0KKw0KKwkvKiBVbnRhZ2dlZCBwYWNrZXRzIC0g
cHVzaCBwcmlvIHRhZyBWTEFOLCBhbGxvdyAqLw0KKwlNTFg1X1NFVF9UT19PTkVTKGZ0ZV9tYXRj
aF9wYXJhbSwgc3BlYy0+bWF0Y2hfY3JpdGVyaWEsIG91dGVyX2hlYWRlcnMuY3ZsYW5fdGFnKTsN
CisJTUxYNV9TRVQoZnRlX21hdGNoX3BhcmFtLCBzcGVjLT5tYXRjaF92YWx1ZSwgb3V0ZXJfaGVh
ZGVycy5jdmxhbl90YWcsIDApOw0KKwlzcGVjLT5tYXRjaF9jcml0ZXJpYV9lbmFibGUgPSBNTFg1
X01BVENIX09VVEVSX0hFQURFUlM7DQorCWZsb3dfYWN0LmFjdGlvbiA9IE1MWDVfRkxPV19DT05U
RVhUX0FDVElPTl9WTEFOX1BVU0ggfA0KKwkJCSAgTUxYNV9GTE9XX0NPTlRFWFRfQUNUSU9OX0FM
TE9XOw0KKwlmbG93X2FjdC52bGFuWzBdLmV0aHR5cGUgPSBFVEhfUF84MDIxUTsNCisJZmxvd19h
Y3QudmxhblswXS52aWQgPSAwOw0KKwlmbG93X2FjdC52bGFuWzBdLnByaW8gPSAwOw0KKwl2cG9y
dC0+aW5ncmVzcy5hbGxvd19ydWxlID0NCisJCW1seDVfYWRkX2Zsb3dfcnVsZXModnBvcnQtPmlu
Z3Jlc3MuYWNsLCBzcGVjLA0KKwkJCQkgICAgJmZsb3dfYWN0LCBOVUxMLCAwKTsNCisJaWYgKElT
X0VSUih2cG9ydC0+aW5ncmVzcy5hbGxvd19ydWxlKSkgew0KKwkJZXJyID0gUFRSX0VSUih2cG9y
dC0+aW5ncmVzcy5hbGxvd19ydWxlKTsNCisJCWVzd193YXJuKGVzdy0+ZGV2LA0KKwkJCSAidnBv
cnRbJWRdIGNvbmZpZ3VyZSBpbmdyZXNzIHVudGFnZ2VkIGFsbG93IHJ1bGUsIGVyciglZClcbiIs
DQorCQkJIHZwb3J0LT52cG9ydCwgZXJyKTsNCisJCXZwb3J0LT5pbmdyZXNzLmFsbG93X3J1bGUg
PSBOVUxMOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCitvdXQ6DQorCWt2ZnJlZShzcGVjKTsNCitv
dXRfbm9fbWVtOg0KKwlpZiAoZXJyKQ0KKwkJZXN3X3Zwb3J0X2NsZWFudXBfaW5ncmVzc19ydWxl
cyhlc3csIHZwb3J0KTsNCisJcmV0dXJuIGVycjsNCit9DQorDQorc3RhdGljIGludCBlc3dfdnBv
cnRfZWdyZXNzX3ByaW9fdGFnX2NvbmZpZyhzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csDQorCQkJ
CQkgICAgc3RydWN0IG1seDVfdnBvcnQgKnZwb3J0KQ0KK3sNCisJc3RydWN0IG1seDVfZmxvd19h
Y3QgZmxvd19hY3QgPSB7MH07DQorCXN0cnVjdCBtbHg1X2Zsb3dfc3BlYyAqc3BlYzsNCisJaW50
IGVyciA9IDA7DQorDQorCS8qIEZvciBwcmlvIHRhZyBtb2RlLCB0aGVyZSBpcyBvbmx5IDEgRlRF
czoNCisJICogMSkgcHJpbyB0YWcgcGFja2V0cyAtIHBvcCB0aGUgcHJpbyB0YWcgVkxBTiwgYWxs
b3cNCisJICogVW5tYXRjaGVkIHRyYWZmaWMgaXMgYWxsb3dlZCBieSBkZWZhdWx0DQorCSAqLw0K
Kw0KKwllc3dfdnBvcnRfY2xlYW51cF9lZ3Jlc3NfcnVsZXMoZXN3LCB2cG9ydCk7DQorDQorCWVy
ciA9IGVzd192cG9ydF9lbmFibGVfZWdyZXNzX2FjbChlc3csIHZwb3J0KTsNCisJaWYgKGVycikg
ew0KKwkJbWx4NV9jb3JlX3dhcm4oZXN3LT5kZXYsDQorCQkJICAgICAgICJmYWlsZWQgdG8gZW5h
YmxlIGVncmVzcyBhY2wgKCVkKSBvbiB2cG9ydFslZF1cbiIsDQorCQkJICAgICAgIGVyciwgdnBv
cnQtPnZwb3J0KTsNCisJCXJldHVybiBlcnI7DQorCX0NCisNCisJZXN3X2RlYnVnKGVzdy0+ZGV2
LA0KKwkJICAidnBvcnRbJWRdIGNvbmZpZ3VyZSBwcmlvIHRhZyBlZ3Jlc3MgcnVsZXNcbiIsIHZw
b3J0LT52cG9ydCk7DQorDQorCXNwZWMgPSBrdnphbGxvYyhzaXplb2YoKnNwZWMpLCBHRlBfS0VS
TkVMKTsNCisJaWYgKCFzcGVjKSB7DQorCQllcnIgPSAtRU5PTUVNOw0KKwkJZ290byBvdXRfbm9f
bWVtOw0KKwl9DQorDQorCS8qIHByaW8gdGFnIHZsYW4gcnVsZSAtIHBvcCBpdCBzbyBWRiByZWNl
aXZlcyB1bnRhZ2dlZCBwYWNrZXRzICovDQorCU1MWDVfU0VUX1RPX09ORVMoZnRlX21hdGNoX3Bh
cmFtLCBzcGVjLT5tYXRjaF9jcml0ZXJpYSwgb3V0ZXJfaGVhZGVycy5jdmxhbl90YWcpOw0KKwlN
TFg1X1NFVF9UT19PTkVTKGZ0ZV9tYXRjaF9wYXJhbSwgc3BlYy0+bWF0Y2hfdmFsdWUsIG91dGVy
X2hlYWRlcnMuY3ZsYW5fdGFnKTsNCisJTUxYNV9TRVRfVE9fT05FUyhmdGVfbWF0Y2hfcGFyYW0s
IHNwZWMtPm1hdGNoX2NyaXRlcmlhLCBvdXRlcl9oZWFkZXJzLmZpcnN0X3ZpZCk7DQorCU1MWDVf
U0VUKGZ0ZV9tYXRjaF9wYXJhbSwgc3BlYy0+bWF0Y2hfdmFsdWUsIG91dGVyX2hlYWRlcnMuZmly
c3RfdmlkLCAwKTsNCisNCisJc3BlYy0+bWF0Y2hfY3JpdGVyaWFfZW5hYmxlID0gTUxYNV9NQVRD
SF9PVVRFUl9IRUFERVJTOw0KKwlmbG93X2FjdC5hY3Rpb24gPSBNTFg1X0ZMT1dfQ09OVEVYVF9B
Q1RJT05fVkxBTl9QT1AgfA0KKwkJCSAgTUxYNV9GTE9XX0NPTlRFWFRfQUNUSU9OX0FMTE9XOw0K
Kwl2cG9ydC0+ZWdyZXNzLmFsbG93ZWRfdmxhbiA9DQorCQltbHg1X2FkZF9mbG93X3J1bGVzKHZw
b3J0LT5lZ3Jlc3MuYWNsLCBzcGVjLA0KKwkJCQkgICAgJmZsb3dfYWN0LCBOVUxMLCAwKTsNCisJ
aWYgKElTX0VSUih2cG9ydC0+ZWdyZXNzLmFsbG93ZWRfdmxhbikpIHsNCisJCWVyciA9IFBUUl9F
UlIodnBvcnQtPmVncmVzcy5hbGxvd2VkX3ZsYW4pOw0KKwkJZXN3X3dhcm4oZXN3LT5kZXYsDQor
CQkJICJ2cG9ydFslZF0gY29uZmlndXJlIGVncmVzcyBwb3AgcHJpbyB0YWcgdmxhbiBydWxlIGZh
aWxlZCwgZXJyKCVkKVxuIiwNCisJCQkgdnBvcnQtPnZwb3J0LCBlcnIpOw0KKwkJdnBvcnQtPmVn
cmVzcy5hbGxvd2VkX3ZsYW4gPSBOVUxMOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCitvdXQ6DQor
CWt2ZnJlZShzcGVjKTsNCitvdXRfbm9fbWVtOg0KKwlpZiAoZXJyKQ0KKwkJZXN3X3Zwb3J0X2Ns
ZWFudXBfZWdyZXNzX3J1bGVzKGVzdywgdnBvcnQpOw0KKwlyZXR1cm4gZXJyOw0KK30NCisNCitz
dGF0aWMgaW50IGVzd19wcmlvX3RhZ19hY2xzX2NvbmZpZyhzdHJ1Y3QgbWx4NV9lc3dpdGNoICpl
c3csIGludCBudnBvcnRzKQ0KK3sNCisJaW50IGksIGo7DQorCWludCBlcnI7DQorDQorCW1seDVf
ZXN3X2Zvcl9lYWNoX3ZmX3Zwb3J0KGVzdywgaSwgbnZwb3J0cykgew0KKwkJZXJyID0gZXN3X3Zw
b3J0X2luZ3Jlc3NfcHJpb190YWdfY29uZmlnKGVzdywgJmVzdy0+dnBvcnRzW2ldKTsNCisJCWlm
IChlcnIpDQorCQkJZ290byBlcnJfaW5ncmVzczsNCisJCWVyciA9IGVzd192cG9ydF9lZ3Jlc3Nf
cHJpb190YWdfY29uZmlnKGVzdywgJmVzdy0+dnBvcnRzW2ldKTsNCisJCWlmIChlcnIpDQorCQkJ
Z290byBlcnJfZWdyZXNzOw0KKwl9DQorDQorCXJldHVybiAwOw0KKw0KK2Vycl9lZ3Jlc3M6DQor
CWVzd192cG9ydF9kaXNhYmxlX2luZ3Jlc3NfYWNsKGVzdywgJmVzdy0+dnBvcnRzW2ldKTsNCitl
cnJfaW5ncmVzczoNCisJbWx4NV9lc3dfZm9yX2VhY2hfdmZfdnBvcnRfcmV2ZXJzZShlc3csIGos
IGkgLSAxKSB7DQorCQllc3dfdnBvcnRfZGlzYWJsZV9lZ3Jlc3NfYWNsKGVzdywgJmVzdy0+dnBv
cnRzW2pdKTsNCisJCWVzd192cG9ydF9kaXNhYmxlX2luZ3Jlc3NfYWNsKGVzdywgJmVzdy0+dnBv
cnRzW2pdKTsNCisJfQ0KKw0KKwlyZXR1cm4gZXJyOw0KK30NCisNCitzdGF0aWMgdm9pZCBlc3df
cHJpb190YWdfYWNsc19jbGVhbnVwKHN0cnVjdCBtbHg1X2Vzd2l0Y2ggKmVzdykNCit7DQorCWlu
dCBpOw0KKw0KKwltbHg1X2Vzd19mb3JfZWFjaF92Zl92cG9ydChlc3csIGksIGVzdy0+bnZwb3J0
cykgew0KKwkJZXN3X3Zwb3J0X2Rpc2FibGVfZWdyZXNzX2FjbChlc3csICZlc3ctPnZwb3J0c1tp
XSk7DQorCQllc3dfdnBvcnRfZGlzYWJsZV9pbmdyZXNzX2FjbChlc3csICZlc3ctPnZwb3J0c1tp
XSk7DQorCX0NCit9DQorDQogc3RhdGljIGludCBlc3dfb2ZmbG9hZHNfc3RlZXJpbmdfaW5pdChz
dHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csIGludCBudnBvcnRzKQ0KIHsNCiAJaW50IGVycjsNCkBA
IC0xNjA4LDYgKzE3NjksMTIgQEAgc3RhdGljIGludCBlc3dfb2ZmbG9hZHNfc3RlZXJpbmdfaW5p
dChzdHJ1Y3QgbWx4NV9lc3dpdGNoICplc3csIGludCBudnBvcnRzKQ0KIAltZW1zZXQoJmVzdy0+
ZmRiX3RhYmxlLm9mZmxvYWRzLCAwLCBzaXplb2Yoc3RydWN0IG9mZmxvYWRzX2ZkYikpOw0KIAlt
dXRleF9pbml0KCZlc3ctPmZkYl90YWJsZS5vZmZsb2Fkcy5mZGJfcHJpb19sb2NrKTsNCiANCisJ
aWYgKE1MWDVfQ0FQX0dFTihlc3ctPmRldiwgcHJpb190YWdfcmVxdWlyZWQpKSB7DQorCQllcnIg
PSBlc3dfcHJpb190YWdfYWNsc19jb25maWcoZXN3LCBudnBvcnRzKTsNCisJCWlmIChlcnIpDQor
CQkJcmV0dXJuIGVycjsNCisJfQ0KKw0KIAllcnIgPSBlc3dfY3JlYXRlX29mZmxvYWRzX2ZkYl90
YWJsZXMoZXN3LCBudnBvcnRzKTsNCiAJaWYgKGVycikNCiAJCXJldHVybiBlcnI7DQpAQCAtMTYz
Niw2ICsxODAzLDggQEAgc3RhdGljIHZvaWQgZXN3X29mZmxvYWRzX3N0ZWVyaW5nX2NsZWFudXAo
c3RydWN0IG1seDVfZXN3aXRjaCAqZXN3KQ0KIAllc3dfZGVzdHJveV92cG9ydF9yeF9ncm91cChl
c3cpOw0KIAllc3dfZGVzdHJveV9vZmZsb2Fkc190YWJsZShlc3cpOw0KIAllc3dfZGVzdHJveV9v
ZmZsb2Fkc19mZGJfdGFibGVzKGVzdyk7DQorCWlmIChNTFg1X0NBUF9HRU4oZXN3LT5kZXYsIHBy
aW9fdGFnX3JlcXVpcmVkKSkNCisJCWVzd19wcmlvX3RhZ19hY2xzX2NsZWFudXAoZXN3KTsNCiB9
DQogDQogc3RhdGljIHZvaWQgZXN3X2hvc3RfcGFyYW1zX2V2ZW50X2hhbmRsZXIoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQ0KLS0gDQoyLjIwLjENCg0K
