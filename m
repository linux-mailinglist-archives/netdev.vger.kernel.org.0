Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id E7DD442B7F
	for <lists+netdev@lfdr.de>; Wed, 12 Jun 2019 17:57:44 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2501973AbfFLP5n (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Wed, 12 Jun 2019 11:57:43 -0400
Received: from mail-eopbgr30052.outbound.protection.outlook.com ([40.107.3.52]:27022
        "EHLO EUR03-AM5-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S2440121AbfFLP5m (ORCPT <rfc822;netdev@vger.kernel.org>);
        Wed, 12 Jun 2019 11:57:42 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CLyTkrn+TIj3HMnDTTE1QLgZfhPAUvgYYO16FMQ4a9o=;
 b=btTf+dlyiuPlyL5XpIAgnBHp1+Q6CbmUCaMK5xh9xHHV6tDuoyT+Px5VQOgSbxS0YFZSBcYCoZobN+3rQBf7kYeh0i0HjkZEBYy1MyNRsCDWV0P/b+NUJ+DMWZhbjg5MMpKVSh7FpyVndq4oY4wMf1ayFBL9JSC7CA9JWRBmig0=
Received: from AM6PR05MB5879.eurprd05.prod.outlook.com (20.179.0.76) by
 AM6PR05MB5240.eurprd05.prod.outlook.com (20.177.196.214) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1987.10; Wed, 12 Jun 2019 15:57:09 +0000
Received: from AM6PR05MB5879.eurprd05.prod.outlook.com
 ([fe80::9527:fe9d:2a02:41d5]) by AM6PR05MB5879.eurprd05.prod.outlook.com
 ([fe80::9527:fe9d:2a02:41d5%5]) with mapi id 15.20.1987.010; Wed, 12 Jun 2019
 15:57:09 +0000
From:   Maxim Mikityanskiy <maximmi@mellanox.com>
To:     Alexei Starovoitov <ast@kernel.org>,
        Daniel Borkmann <daniel@iogearbox.net>,
        =?utf-8?B?QmrDtnJuIFTDtnBlbA==?= <bjorn.topel@intel.com>,
        Magnus Karlsson <magnus.karlsson@intel.com>
CC:     "bpf@vger.kernel.org" <bpf@vger.kernel.org>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        "David S. Miller" <davem@davemloft.net>,
        Saeed Mahameed <saeedm@mellanox.com>,
        Jonathan Lemon <bsd@fb.com>,
        Tariq Toukan <tariqt@mellanox.com>,
        Martin KaFai Lau <kafai@fb.com>,
        Song Liu <songliubraving@fb.com>, Yonghong Song <yhs@fb.com>,
        Jakub Kicinski <jakub.kicinski@netronome.com>,
        Maciej Fijalkowski <maciejromanfijalkowski@gmail.com>,
        Maxim Mikityanskiy <maximmi@mellanox.com>
Subject: [PATCH bpf-next v4 17/17] net/mlx5e: Add XSK zero-copy support
Thread-Topic: [PATCH bpf-next v4 17/17] net/mlx5e: Add XSK zero-copy support
Thread-Index: AQHVITd9mSR80BU/Xk6COQfdHRqYuQ==
Date:   Wed, 12 Jun 2019 15:57:09 +0000
Message-ID: <20190612155605.22450-18-maximmi@mellanox.com>
References: <20190612155605.22450-1-maximmi@mellanox.com>
In-Reply-To: <20190612155605.22450-1-maximmi@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: LO2P123CA0019.GBRP123.PROD.OUTLOOK.COM
 (2603:10a6:600:a6::31) To AM6PR05MB5879.eurprd05.prod.outlook.com
 (2603:10a6:20b:a2::12)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=maximmi@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.19.1
x-originating-ip: [141.226.120.58]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: e2bf9eba-9e88-4656-b8b7-08d6ef4e9fd8
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);SRVR:AM6PR05MB5240;
x-ms-traffictypediagnostic: AM6PR05MB5240:
x-microsoft-antispam-prvs: <AM6PR05MB52407FD6DB578368706D7882D1EC0@AM6PR05MB5240.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 0066D63CE6
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(1496009)(366004)(376002)(136003)(39860400002)(396003)(346002)(189003)(199004)(30864003)(486006)(8936002)(6486002)(446003)(8676002)(81166006)(81156014)(2906002)(6436002)(36756003)(26005)(11346002)(2616005)(476003)(50226002)(66066001)(102836004)(14454004)(186003)(107886003)(110136005)(54906003)(71190400001)(71200400001)(478600001)(316002)(25786009)(4326008)(1076003)(7736002)(305945005)(6512007)(66476007)(66946007)(66556008)(64756008)(66446008)(73956011)(68736007)(256004)(99286004)(7416002)(6116002)(386003)(14444005)(3846002)(6506007)(86362001)(53946003)(53936002)(76176011)(5660300002)(52116002)(579004)(569006);DIR:OUT;SFP:1101;SCL:1;SRVR:AM6PR05MB5240;H:AM6PR05MB5879.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: nbRC7G7sD1guV0uGRPmgM+kEcnMwv41AfwYQO7JzWwsrHfFheNV1O03k+gtQ9tFt5d10+qeynXnPy5GCBB8zPQ9CCMLDrrnIbant6GsMBG3lCEOA9vaC9xko2mSufygEZxjQApevHJfdy3987kJX+5oGYLWTZIvM1mOjd7GmT35Pe9nNN7WNkKyRbZa/k85vjD7Q+EOPdxFgdDL5bY/U7g2xeu7CW5pY6/I5LBMPNS0jyxAdwRvsYkEYvL1wN69qnH932d7COJBkMlKnueoIKFpYRUy9jiiuz6DVzlF5zV8xzTqw+hnTg5+Y7MZPOLd3p+nZ/X4+r5s3YVoH1+Fld69kA7EZWZSSjUtzdTS5GrFQ2NEfjoaL/IBrKAj6nJgUji3qfjhsEhQ1hEefHh01Gq1QY7u1AmzRSza7wHhIS0o=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e2bf9eba-9e88-4656-b8b7-08d6ef4e9fd8
X-MS-Exchange-CrossTenant-originalarrivaltime: 12 Jun 2019 15:57:09.3508
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: maximmi@mellanox.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM6PR05MB5240
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

VGhpcyBjb21taXQgYWRkcyBzdXBwb3J0IGZvciBBRl9YRFAgemVyby1jb3B5IFJYIGFuZCBUWC4N
Cg0KV2UgY3JlYXRlIGEgZGVkaWNhdGVkIFhTSyBSUSBpbnNpZGUgdGhlIGNoYW5uZWwsIGl0IG1l
YW5zIHRoYXQgdHdvDQpSUXMgYXJlIHJ1bm5pbmcgc2ltdWx0YW5lb3VzbHk6IG9uZSBmb3Igbm9u
LVhTSyB0cmFmZmljIGFuZCB0aGUgb3RoZXINCmZvciBYU0sgdHJhZmZpYy4gVGhlIHJlZ3VsYXIg
YW5kIFhTSyBSUXMgdXNlIGEgc2luZ2xlIElEIG5hbWVzcGFjZSBzcGxpdA0KaW50byB0d28gaGFs
dmVzOiB0aGUgbG93ZXIgaGFsZiBpcyByZWd1bGFyIFJRcywgYW5kIHRoZSB1cHBlciBoYWxmIGlz
DQpYU0sgUlFzLiBXaGVuIGFueSB6ZXJvLWNvcHkgQUZfWERQIHNvY2tldCBpcyBhY3RpdmUsIGNo
YW5naW5nIHRoZSBudW1iZXINCm9mIGNoYW5uZWxzIGlzIG5vdCBhbGxvd2VkLCBiZWNhdXNlIGl0
IHdvdWxkIGJyZWFrIHRvIG1hcHBpbmcgYmV0d2Vlbg0KWFNLIFJRIElEcyBhbmQgY2hhbm5lbHMu
DQoNClhTSyByZXF1aXJlcyBkaWZmZXJlbnQgcGFnZSBhbGxvY2F0aW9uIGFuZCByZWxlYXNlIHJv
dXRpbmVzLiBTdWNoDQpmdW5jdGlvbnMgYXMgbWx4NWVfe2FsbG9jLGZyZWV9X3J4X21wd3FlIGFu
ZCBtbHg1ZV97Z2V0LHB1dH1fcnhfZnJhZyBhcmUNCmdlbmVyaWMgZW5vdWdoIHRvIGJlIHVzZWQg
Zm9yIGJvdGggcmVndWxhciBhbmQgWFNLIFJRcywgYW5kIHRoZXkgdXNlIHRoZQ0KbWx4NWVfcGFn
ZV97YWxsb2MscmVsZWFzZX0gd3JhcHBlcnMgYXJvdW5kIHRoZSByZWFsIGFsbG9jYXRpb24NCmZ1
bmN0aW9ucy4gRnVuY3Rpb24gcG9pbnRlcnMgYXJlIG5vdCB1c2VkIHRvIGF2b2lkIGxvc2luZyB0
aGUNCnBlcmZvcm1hbmNlIHdpdGggcmV0cG9saW5lcy4gV2hlcmV2ZXIgaXQncyBjZXJ0YWluIHRo
YXQgdGhlIHJlZ3VsYXINCihub24tWFNLKSBwYWdlIHJlbGVhc2UgZnVuY3Rpb24gc2hvdWxkIGJl
IHVzZWQsIGl0J3MgY2FsbGVkIGRpcmVjdGx5Lg0KDQpPbmx5IHRoZSBzdGF0cyB0aGF0IGNvdWxk
IGJlIG1lYW5pbmdmdWwgZm9yIFhTSyBhcmUgZXhwb3NlZCB0byB0aGUNCnVzZXJzcGFjZS4gVGhv
c2UgdGhhdCBkb24ndCB0YWtlIHBhcnQgaW4gdGhlIFhTSyBmbG93IGFyZSBub3QNCmNvbnNpZGVy
ZWQuDQoNCk5vdGUgdGhhdCB3ZSBkb24ndCB3YWl0IGZvciBXUUVzIG9uIHRoZSBYU0sgUlEgKHVu
bGlrZSB0aGUgcmVndWxhciBSUSksDQpiZWNhdXNlIHRoZSBuZXdlciB4ZHBzb2NrIHNhbXBsZSBk
b2Vzbid0IHByb3ZpZGUgYW55IEZpbGwgUmluZyBlbnRyaWVzDQphdCB0aGUgc2V0dXAgc3RhZ2Uu
DQoNCldlIGNyZWF0ZSBhIGRlZGljYXRlZCBYU0sgU1EgaW4gdGhlIGNoYW5uZWwuIFRoaXMgc2Vw
YXJhdGlvbiBoYXMgaXRzDQphZHZhbnRhZ2VzOg0KDQoxLiBXaGVuIHRoZSBVTUVNIGlzIGNsb3Nl
ZCwgdGhlIFhTSyBTUSBjYW4gYWxzbyBiZSBjbG9zZWQgYW5kIHN0b3ANCnJlY2VpdmluZyBjb21w
bGV0aW9ucy4gSWYgYW4gZXhpc3RpbmcgU1Egd2FzIHVzZWQgZm9yIFhTSywgaXQgd291bGQNCmNv
bnRpbnVlIHJlY2VpdmluZyBjb21wbGV0aW9ucyBmb3IgdGhlIHBhY2tldHMgb2YgdGhlIGNsb3Nl
ZCBzb2NrZXQuIElmDQphIG5ldyBVTUVNIHdhcyBvcGVuZWQgYXQgdGhhdCBwb2ludCwgaXQgd291
bGQgc3RhcnQgZ2V0dGluZyBjb21wbGV0aW9ucw0KdGhhdCBkb24ndCBiZWxvbmcgdG8gaXQuDQoN
CjIuIENhbGN1bGF0aW5nIHN0YXRpc3RpY3Mgc2VwYXJhdGVseS4NCg0KV2hlbiB0aGUgdXNlcnNw
YWNlIGtpY2tzIHRoZSBUWCwgdGhlIGRyaXZlciB0cmlnZ2VycyBhIGhhcmR3YXJlDQppbnRlcnJ1
cHQgYnkgcG9zdGluZyBhIE5PUCB0byBhIGRlZGljYXRlZCBYU0sgSUNPIChpbnRlcm5hbCBjb250
cm9sDQpvcGVyYXRpb25zKSBTUSwgaW4gb3JkZXIgdG8gdHJpZ2dlciBOQVBJIG9uIHRoZSByaWdo
dCBDUFUgY29yZS4gVGhpcyBYU0sNCklDTyBTUSBpcyBwcm90ZWN0ZWQgYnkgYSBzcGlubG9jaywg
YXMgdGhlIHVzZXJzcGFjZSBhcHBsaWNhdGlvbiBtYXkga2ljaw0KdGhlIFRYIGZyb20gYW55IGNv
cmUuDQoNClN0b3JlIHRoZSBwb2ludGVycyB0byB0aGUgVU1FTXMgaW4gdGhlIG5ldCBkZXZpY2Ug
cHJpdmF0ZSBjb250ZXh0LA0KaW5kZXBlbmRlbnRseSBmcm9tIHRoZSBrZXJuZWwuIFRoaXMgd2F5
IHRoZSBkcml2ZXIgY2FuIGRpc3Rpbmd1aXNoDQpiZXR3ZWVuIHRoZSB6ZXJvLWNvcHkgYW5kIG5v
bi16ZXJvLWNvcHkgVU1FTXMuIFRoZSBrZXJuZWwgZnVuY3Rpb24NCnhkcF9nZXRfdW1lbV9mcm9t
X3FpZCBkb2VzIG5vdCBjYXJlIGFib3V0IHRoaXMgZGlmZmVyZW5jZSwgYnV0IHRoZQ0KZHJpdmVy
IGlzIG9ubHkgaW50ZXJlc3RlZCBpbiB6ZXJvLWNvcHkgVU1FTXMsIHBhcnRpY3VsYXJseSwgb24g
dGhlDQpjbGVhbnVwIGl0IGRldGVybWluZXMgd2hldGhlciB0byBjbG9zZSB0aGUgWFNLIFJRIGFu
ZCBTUSBvciBub3QgYnkNCmxvb2tpbmcgYXQgdGhlIHByZXNlbmNlIG9mIHRoZSBVTUVNLiBVc2Ug
c3RhdGVfbG9jayB0byBwcm90ZWN0IHRoZQ0KYWNjZXNzIHRvIHRoaXMgYXJlYSBvZiBVTUVNIHBv
aW50ZXJzLg0KDQpMUk8gaXNuJ3QgY29tcGF0aWJsZSB3aXRoIFhEUCwgYnV0IHRoZXJlIG1heSBi
ZSBhY3RpdmUgVU1FTXMgd2hpbGUNClhEUCBpcyBvZmYuIElmIHRoaXMgaXMgdGhlIGNhc2UsIGRv
bid0IGFsbG93IExSTyB0byBlbnN1cmUgWERQIGNhbg0KYmUgcmVlbmFibGVkIGF0IGFueSB0aW1l
Lg0KDQpUaGUgdmFsaWRhdGlvbiBvZiBYU0sgcGFyYW1ldGVycyB0eXBpY2FsbHkgaGFwcGVucyB3
aGVuIFhTSyBxdWV1ZXMNCm9wZW4uIEhvd2V2ZXIsIHdoZW4gdGhlIGludGVyZmFjZSBpcyBkb3du
IG9yIHRoZSBYRFAgcHJvZ3JhbSBpc24ndA0Kc2V0LCBpdCdzIHN0aWxsIHBvc3NpYmxlIHRvIGhh
dmUgYWN0aXZlIEFGX1hEUCBzb2NrZXRzIGFuZCBldmVuIHRvDQpvcGVuIG5ldywgYnV0IHRoZSBY
U0sgcXVldWVzIHdpbGwgYmUgY2xvc2VkLiBUbyBjb3ZlciB0aGVzZSBjYXNlcywNCnBlcmZvcm0g
dGhlIHZhbGlkYXRpb24gYWxzbyBpbiB0aGVzZSBmbG93czoNCg0KMS4gQSBuZXcgVU1FTSBpcyBy
ZWdpc3RlcmVkLCBidXQgdGhlIFhTSyBxdWV1ZXMgYXJlbid0IGdvaW5nIHRvIGJlDQpjcmVhdGVk
IGR1ZSB0byBtaXNzaW5nIFhEUCBwcm9ncmFtIG9yIGludGVyZmFjZSBiZWluZyBkb3duLg0KDQoy
LiBNVFUgY2hhbmdlcyB3aGlsZSB0aGVyZSBhcmUgVU1FTXMgcmVnaXN0ZXJlZC4NCg0KSGF2aW5n
IHRoaXMgZWFybHkgY2hlY2sgcHJldmVudHMgbWx4NWVfb3Blbl9jaGFubmVscyBmcm9tIGZhaWxp
bmcNCmF0IGEgbGF0ZXIgc3RhZ2UsIHdoZXJlIHJlY292ZXJ5IGlzIGltcG9zc2libGUgYW5kIHRo
ZSBhcHBsaWNhdGlvbg0KaGFzIG5vIGNoYW5jZSB0byBoYW5kbGUgdGhlIGVycm9yLCBiZWNhdXNl
IGl0IGdvdCB0aGUgc3VjY2Vzc2Z1bA0KcmV0dXJuIHZhbHVlIGZvciBhbiBNVFUgY2hhbmdlIG9y
IFhTSyBvcGVuIG9wZXJhdGlvbi4NCg0KVGhlIHBlcmZvcm1hbmNlIHRlc3Rpbmcgd2FzIHBlcmZv
cm1lZCBvbiBhIG1hY2hpbmUgd2l0aCB0aGUgZm9sbG93aW5nDQpjb25maWd1cmF0aW9uOg0KDQot
IDI0IGNvcmVzIG9mIEludGVsIFhlb24gRTUtMjYyMCB2MyBAIDIuNDAgR0h6DQotIE1lbGxhbm94
IENvbm5lY3RYLTUgRXggd2l0aCAxMDAgR2JpdC9zIGxpbmsNCg0KVGhlIHJlc3VsdHMgd2l0aCBy
ZXRwb2xpbmUgZGlzYWJsZWQsIHNpbmdsZSBzdHJlYW06DQoNCnR4b25seTogMzMuMyBNcHBzICgy
MS41IE1wcHMgd2l0aCBxdWV1ZSBhbmQgYXBwIHBpbm5lZCB0byB0aGUgc2FtZSBDUFUpDQpyeGRy
b3A6IDEyLjIgTXBwcw0KbDJmd2Q6IDkuNCBNcHBzDQoNClRoZSByZXN1bHRzIHdpdGggcmV0cG9s
aW5lIGVuYWJsZWQsIHNpbmdsZSBzdHJlYW06DQoNCnR4b25seTogMjEuMyBNcHBzICgxNC4xIE1w
cHMgd2l0aCBxdWV1ZSBhbmQgYXBwIHBpbm5lZCB0byB0aGUgc2FtZSBDUFUpDQpyeGRyb3A6IDku
OSBNcHBzDQpsMmZ3ZDogNi44IE1wcHMNCg0KU2lnbmVkLW9mZi1ieTogTWF4aW0gTWlraXR5YW5z
a2l5IDxtYXhpbW1pQG1lbGxhbm94LmNvbT4NClJldmlld2VkLWJ5OiBUYXJpcSBUb3VrYW4gPHRh
cmlxdEBtZWxsYW5veC5jb20+DQpBY2tlZC1ieTogU2FlZWQgTWFoYW1lZWQgPHNhZWVkbUBtZWxs
YW5veC5jb20+DQotLS0NCiAuLi4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9NYWtl
ZmlsZSAgfCAgIDIgKy0NCiBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUv
ZW4uaCAgfCAgOTggKysrLQ0KIC4uLi9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFy
YW1zLmMgICB8ICA1MyArLQ0KIC4uLi9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFy
YW1zLmggICB8ICA3NyArKy0NCiAuLi4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9l
bi94ZHAuYyAgfCAxMDMgKysrLQ0KIC4uLi9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuL3hkcC5oICB8ICAxOCArLQ0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL01ha2Vm
aWxlICAgICAgICB8ICAgMSArDQogLi4uL2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94
c2svcnguYyAgIHwgMTkyICsrKysrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuL3hzay9yeC5oICAgfCAgMjcgKw0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3Nl
dHVwLmMgICAgICAgICB8IDIyMyArKysrKysrKw0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4v
eHNrL3NldHVwLmggICAgICAgICB8ICAyNSArDQogLi4uL2V0aGVybmV0L21lbGxhbm94L21seDUv
Y29yZS9lbi94c2svdHguYyAgIHwgMTExICsrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4
NS9jb3JlL2VuL3hzay90eC5oICAgfCAgMTUgKw0KIC4uLi9ldGhlcm5ldC9tZWxsYW5veC9tbHg1
L2NvcmUvZW4veHNrL3VtZW0uYyB8IDI2NyArKysrKysrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuL3hzay91bWVtLmggfCAgMzEgKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuX2V0aHRvb2wuYyAgfCAgMjkgKy0NCiAuLi4vbWVsbGFub3gvbWx4NS9j
b3JlL2VuX2ZzX2V0aHRvb2wuYyAgICAgICAgfCAgMTggKy0NCiAuLi4vbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbl9tYWluLmMgfCA1MjMgKysrKysrKysrKysrLS0tLS0tDQogLi4u
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fcmVwLmMgIHwgIDEyICstDQogLi4u
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fcnguYyAgIHwgIDc3ICsrLQ0KIC4u
Li9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fc3RhdHMuYyAgICB8IDExNSArKystDQog
Li4uL2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0cy5oICAgIHwgIDMwICsNCiAu
Li4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4LmMgfCAgMzQgKy0NCiAu
Li4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2lwb2liL2lwb2liLmMgfCAgMTQgKy0NCiAy
NCBmaWxlcyBjaGFuZ2VkLCAxODQzIGluc2VydGlvbnMoKyksIDI1MiBkZWxldGlvbnMoLSkNCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuL3hzay9NYWtlZmlsZQ0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3J4LmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5oDQogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94
c2svc2V0dXAuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay90eC5jDQogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2sv
dHguaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9t
bHg1L2NvcmUvZW4veHNrL3VtZW0uYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC9l
dGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3VtZW0uaA0KDQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL01ha2VmaWxlIGIvZHJpdmVy
cy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL01ha2VmaWxlDQppbmRleCAyNDMzNjhk
YzIzZGIuLjk2OTRjZDFlYTc1OSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9NYWtlZmlsZQ0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL01ha2VmaWxlDQpAQCAtMjMsNyArMjMsNyBAQCBtbHg1X2NvcmUteSA6
PQltYWluLm8gY21kLm8gZGVidWdmcy5vIGZ3Lm8gZXEubyB1YXIubyBwYWdlYWxsb2MubyBcDQog
bWx4NV9jb3JlLSQoQ09ORklHX01MWDVfQ09SRV9FTikgKz0gZW5fbWFpbi5vIGVuX2NvbW1vbi5v
IGVuX2ZzLm8gZW5fZXRodG9vbC5vIFwNCiAJCWVuX3R4Lm8gZW5fcngubyBlbl9kaW0ubyBlbl90
eHJ4Lm8gZW4veGRwLm8gZW5fc3RhdHMubyBcDQogCQllbl9zZWxmdGVzdC5vIGVuL3BvcnQubyBl
bi9tb25pdG9yX3N0YXRzLm8gZW4vcmVwb3J0ZXJfdHgubyBcDQotCQllbi9wYXJhbXMubw0KKwkJ
ZW4vcGFyYW1zLm8gZW4veHNrL3VtZW0ubyBlbi94c2svc2V0dXAubyBlbi94c2svcngubyBlbi94
c2svdHgubw0KIA0KICMNCiAjIE5ldGRldiBleHRyYQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi5oIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuLmgNCmluZGV4IDhjYjI4ZTU2MDRmMC4uYzg1ODI3M2M2YWQx
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vu
LmgNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi5oDQpA
QCAtMTM3LDYgKzEzNyw3IEBAIHN0cnVjdCBwYWdlX3Bvb2w7DQogI2RlZmluZSBNTFg1RV9NQVhf
TlVNX0NIQU5ORUxTICAgICAgICAgKE1MWDVFX0lORElSX1JRVF9TSVpFID4+IDEpDQogI2RlZmlu
ZSBNTFg1RV9NQVhfTlVNX1NRUyAgICAgICAgICAgICAgKE1MWDVFX01BWF9OVU1fQ0hBTk5FTFMg
KiBNTFg1RV9NQVhfTlVNX1RDKQ0KICNkZWZpbmUgTUxYNUVfVFhfQ1FfUE9MTF9CVURHRVQgICAg
ICAgIDEyOA0KKyNkZWZpbmUgTUxYNUVfVFhfWFNLX1BPTExfQlVER0VUICAgICAgIDY0DQogI2Rl
ZmluZSBNTFg1RV9TUV9SRUNPVkVSX01JTl9JTlRFUlZBTCAgNTAwIC8qIG1zZWNzICovDQogDQog
I2RlZmluZSBNTFg1RV9VTVJfV1FFX0lOTElORV9TWiBcDQpAQCAtMTU1LDYgKzE1NiwxMSBAQCBk
byB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXA0KIAkJCSAgICAjI19fVkFfQVJHU19fKTsgICAgICAgICAgICAgICAgICAgICBcDQog
fSB3aGlsZSAoMCkNCiANCitlbnVtIG1seDVlX3JxX2dyb3VwIHsNCisJTUxYNUVfUlFfR1JPVVBf
UkVHVUxBUiwNCisJTUxYNUVfUlFfR1JPVVBfWFNLLA0KKwlNTFg1RV9OVU1fUlFfR1JPVVBTIC8q
IEtlZXAgbGFzdC4gKi8NCit9Ow0KIA0KIHN0YXRpYyBpbmxpbmUgdTE2IG1seDVfbWluX3J4X3dx
ZXMoaW50IHdxX3R5cGUsIHUzMiB3cV9zaXplKQ0KIHsNCkBAIC0xNzksNyArMTg1LDggQEAgc3Rh
dGljIGlubGluZSBpbnQgbWx4NWVfZ2V0X21heF9udW1fY2hhbm5lbHMoc3RydWN0IG1seDVfY29y
ZV9kZXYgKm1kZXYpDQogLyogVXNlIHRoaXMgZnVuY3Rpb24gdG8gZ2V0IG1heCBudW0gY2hhbm5l
bHMgYWZ0ZXIgbmV0ZGV2IHdhcyBjcmVhdGVkICovDQogc3RhdGljIGlubGluZSBpbnQgbWx4NWVf
Z2V0X25ldGRldl9tYXhfY2hhbm5lbHMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldikNCiB7DQot
CXJldHVybiBtaW5fdCh1bnNpZ25lZCBpbnQsIG5ldGRldi0+bnVtX3J4X3F1ZXVlcywNCisJcmV0
dXJuIG1pbl90KHVuc2lnbmVkIGludCwNCisJCSAgICAgbmV0ZGV2LT5udW1fcnhfcXVldWVzIC8g
TUxYNUVfTlVNX1JRX0dST1VQUywNCiAJCSAgICAgbmV0ZGV2LT5udW1fdHhfcXVldWVzKTsNCiB9
DQogDQpAQCAtMjUwLDYgKzI1Nyw3IEBAIHN0cnVjdCBtbHg1ZV9wYXJhbXMgew0KIAl1MzIgbHJv
X3RpbWVvdXQ7DQogCXUzMiBwZmxhZ3M7DQogCXN0cnVjdCBicGZfcHJvZyAqeGRwX3Byb2c7DQor
CXN0cnVjdCBtbHg1ZV94c2sgKnhzazsNCiAJdW5zaWduZWQgaW50IHN3X210dTsNCiAJaW50IGhh
cmRfbXR1Ow0KIH07DQpAQCAtMzk4LDggKzQwNiwxNCBAQCBzdHJ1Y3QgbWx4NWVfdHhxc3Egew0K
IH0gX19fX2NhY2hlbGluZV9hbGlnbmVkX2luX3NtcDsNCiANCiBzdHJ1Y3QgbWx4NWVfZG1hX2lu
Zm8gew0KLQlzdHJ1Y3QgcGFnZSAgICAgKnBhZ2U7DQotCWRtYV9hZGRyX3QgICAgICBhZGRyOw0K
KwlkbWFfYWRkcl90IGFkZHI7DQorCXVuaW9uIHsNCisJCXN0cnVjdCBwYWdlICpwYWdlOw0KKwkJ
c3RydWN0IHsNCisJCQl1NjQgaGFuZGxlOw0KKwkJCXZvaWQgKmRhdGE7DQorCQl9IHhzazsNCisJ
fTsNCiB9Ow0KIA0KIC8qIFhEUCBwYWNrZXRzIGNhbiBiZSB0cmFuc21pdHRlZCBpbiBkaWZmZXJl
bnQgd2F5cy4gT24gY29tcGxldGlvbiwgd2UgbmVlZCB0bw0KQEAgLTQ2Niw5ICs0ODAsMTEgQEAg
c3RydWN0IG1seDVlX3hkcF9tcHdxZSB7DQogfTsNCiANCiBzdHJ1Y3QgbWx4NWVfeGRwc3E7DQor
dHlwZWRlZiBpbnQgKCptbHg1ZV9mcF94bWl0X3hkcF9mcmFtZV9jaGVjaykoc3RydWN0IG1seDVl
X3hkcHNxICopOw0KIHR5cGVkZWYgYm9vbCAoKm1seDVlX2ZwX3htaXRfeGRwX2ZyYW1lKShzdHJ1
Y3QgbWx4NWVfeGRwc3EgKiwNCiAJCQkJCXN0cnVjdCBtbHg1ZV94ZHBfeG1pdF9kYXRhICosDQot
CQkJCQlzdHJ1Y3QgbWx4NWVfeGRwX2luZm8gKik7DQorCQkJCQlzdHJ1Y3QgbWx4NWVfeGRwX2lu
Zm8gKiwNCisJCQkJCWludCk7DQogDQogc3RydWN0IG1seDVlX3hkcHNxIHsNCiAJLyogZGF0YSBw
YXRoICovDQpAQCAtNDg2LDggKzUwMiwxMCBAQCBzdHJ1Y3QgbWx4NWVfeGRwc3Egew0KIAlzdHJ1
Y3QgbWx4NWVfY3EgICAgICAgICAgICBjcTsNCiANCiAJLyogcmVhZCBvbmx5ICovDQorCXN0cnVj
dCB4ZHBfdW1lbSAgICAgICAgICAgKnVtZW07DQogCXN0cnVjdCBtbHg1X3dxX2N5YyAgICAgICAg
IHdxOw0KIAlzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMgICpzdGF0czsNCisJbWx4NWVfZnBfeG1p
dF94ZHBfZnJhbWVfY2hlY2sgeG1pdF94ZHBfZnJhbWVfY2hlY2s7DQogCW1seDVlX2ZwX3htaXRf
eGRwX2ZyYW1lICAgIHhtaXRfeGRwX2ZyYW1lOw0KIAlzdHJ1Y3Qgew0KIAkJc3RydWN0IG1seDVl
X3hkcF93cWVfaW5mbyAqd3FlX2luZm87DQpAQCAtNjE4LDYgKzYzNiw3IEBAIHN0cnVjdCBtbHg1
ZV9ycSB7DQogCQl9IG1wd3FlOw0KIAl9Ow0KIAlzdHJ1Y3Qgew0KKwkJdTE2ICAgICAgICAgICAg
dW1lbV9oZWFkcm9vbTsNCiAJCXUxNiAgICAgICAgICAgIGhlYWRyb29tOw0KIAkJdTggICAgICAg
ICAgICAgbWFwX2RpcjsgICAvKiBkbWEgbWFwIGRpcmVjdGlvbiAqLw0KIAl9IGJ1ZmY7DQpAQCAt
NjQ4LDYgKzY2NywxMCBAQCBzdHJ1Y3QgbWx4NWVfcnEgew0KIAlERUNMQVJFX0JJVE1BUChmbGFn
cywgOCk7DQogCXN0cnVjdCBwYWdlX3Bvb2wgICAgICAqcGFnZV9wb29sOw0KIA0KKwkvKiBBRl9Y
RFAgemVyby1jb3B5ICovDQorCXN0cnVjdCB6ZXJvX2NvcHlfYWxsb2NhdG9yIHpjYTsNCisJc3Ry
dWN0IHhkcF91bWVtICAgICAgICp1bWVtOw0KKw0KIAkvKiBjb250cm9sICovDQogCXN0cnVjdCBt
bHg1X3dxX2N0cmwgICAgd3FfY3RybDsNCiAJX19iZTMyICAgICAgICAgICAgICAgICBta2V5X2Jl
Ow0KQEAgLTY2MCw2ICs2ODMsMTEgQEAgc3RydWN0IG1seDVlX3JxIHsNCiAJc3RydWN0IHhkcF9y
eHFfaW5mbyAgICB4ZHBfcnhxOw0KIH0gX19fX2NhY2hlbGluZV9hbGlnbmVkX2luX3NtcDsNCiAN
CitlbnVtIG1seDVlX2NoYW5uZWxfc3RhdGUgew0KKwlNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywN
CisJTUxYNUVfQ0hBTk5FTF9OVU1fU1RBVEVTDQorfTsNCisNCiBzdHJ1Y3QgbWx4NWVfY2hhbm5l
bCB7DQogCS8qIGRhdGEgcGF0aCAqLw0KIAlzdHJ1Y3QgbWx4NWVfcnEgICAgICAgICAgICBycTsN
CkBAIC02NzYsNiArNzA0LDEzIEBAIHN0cnVjdCBtbHg1ZV9jaGFubmVsIHsNCiAJLyogWERQX1JF
RElSRUNUICovDQogCXN0cnVjdCBtbHg1ZV94ZHBzcSAgICAgICAgIHhkcHNxOw0KIA0KKwkvKiBB
Rl9YRFAgemVyby1jb3B5ICovDQorCXN0cnVjdCBtbHg1ZV9ycSAgICAgICAgICAgIHhza3JxOw0K
KwlzdHJ1Y3QgbWx4NWVfeGRwc3EgICAgICAgICB4c2tzcTsNCisJc3RydWN0IG1seDVlX2ljb3Nx
ICAgICAgICAgeHNraWNvc3E7DQorCS8qIHhza2ljb3NxIGNhbiBiZSBhY2Nlc3NlZCBmcm9tIGFu
eSBDUFUgLSB0aGUgc3BpbmxvY2sgcHJvdGVjdHMgaXQuICovDQorCXNwaW5sb2NrX3QgICAgICAg
ICAgICAgICAgIHhza2ljb3NxX2xvY2s7DQorDQogCS8qIGRhdGEgcGF0aCAtIGFjY2Vzc2VkIHBl
ciBuYXBpIHBvbGwgKi8NCiAJc3RydWN0IGlycV9kZXNjICppcnFfZGVzYzsNCiAJc3RydWN0IG1s
eDVlX2NoX3N0YXRzICAgICAqc3RhdHM7DQpAQCAtNjg0LDYgKzcxOSw3IEBAIHN0cnVjdCBtbHg1
ZV9jaGFubmVsIHsNCiAJc3RydWN0IG1seDVlX3ByaXYgICAgICAgICAqcHJpdjsNCiAJc3RydWN0
IG1seDVfY29yZV9kZXYgICAgICAqbWRldjsNCiAJc3RydWN0IGh3dHN0YW1wX2NvbmZpZyAgICAq
dHN0YW1wOw0KKwlERUNMQVJFX0JJVE1BUChzdGF0ZSwgTUxYNUVfQ0hBTk5FTF9OVU1fU1RBVEVT
KTsNCiAJaW50ICAgICAgICAgICAgICAgICAgICAgICAgaXg7DQogCWludCAgICAgICAgICAgICAg
ICAgICAgICAgIGNwdTsNCiAJY3B1bWFza192YXJfdCAgICAgICAgICAgICAgeHBzX2NwdW1hc2s7
DQpAQCAtNjk5LDE0ICs3MzUsMTcgQEAgc3RydWN0IG1seDVlX2NoYW5uZWxfc3RhdHMgew0KIAlz
dHJ1Y3QgbWx4NWVfY2hfc3RhdHMgY2g7DQogCXN0cnVjdCBtbHg1ZV9zcV9zdGF0cyBzcVtNTFg1
RV9NQVhfTlVNX1RDXTsNCiAJc3RydWN0IG1seDVlX3JxX3N0YXRzIHJxOw0KKwlzdHJ1Y3QgbWx4
NWVfcnFfc3RhdHMgeHNrcnE7DQogCXN0cnVjdCBtbHg1ZV94ZHBzcV9zdGF0cyBycV94ZHBzcTsN
CiAJc3RydWN0IG1seDVlX3hkcHNxX3N0YXRzIHhkcHNxOw0KKwlzdHJ1Y3QgbWx4NWVfeGRwc3Ff
c3RhdHMgeHNrc3E7DQogfSBfX19fY2FjaGVsaW5lX2FsaWduZWRfaW5fc21wOw0KIA0KIGVudW0g
ew0KIAlNTFg1RV9TVEFURV9PUEVORUQsDQogCU1MWDVFX1NUQVRFX0RFU1RST1lJTkcsDQogCU1M
WDVFX1NUQVRFX1hEUF9UWF9FTkFCTEVELA0KKwlNTFg1RV9TVEFURV9YRFBfT1BFTiwNCiB9Ow0K
IA0KIHN0cnVjdCBtbHg1ZV9ycXQgew0KQEAgLTczOSw2ICs3NzgsMTcgQEAgc3RydWN0IG1seDVl
X21vZGlmeV9zcV9wYXJhbSB7DQogCWludCBybF9pbmRleDsNCiB9Ow0KIA0KK3N0cnVjdCBtbHg1
ZV94c2sgew0KKwkvKiBVTUVNcyBhcmUgc3RvcmVkIHNlcGFyYXRlbHkgZnJvbSBjaGFubmVscywg
YmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvDQorCSAqIGxvc2UgdGhlbSB3aGVuIGNoYW5uZWxzIGFy
ZSByZWNyZWF0ZWQuIFRoZSBrZXJuZWwgYWxzbyBzdG9yZXMgVU1FTXMsDQorCSAqIGJ1dCBpdCBk
b2Vzbid0IGRpc3Rpbmd1aXNoIGJldHdlZW4gemVyby1jb3B5IGFuZCBub24temVyby1jb3B5IFVN
RU1zLA0KKwkgKiBzbyByZWx5IG9uIG91ciBtZWNoYW5pc20uDQorCSAqLw0KKwlzdHJ1Y3QgeGRw
X3VtZW0gKip1bWVtczsNCisJdTE2IHJlZmNudDsNCisJYm9vbCBldmVyX3VzZWQ7DQorfTsNCisN
CiBzdHJ1Y3QgbWx4NWVfcHJpdiB7DQogCS8qIHByaXYgZGF0YSBwYXRoIGZpZWxkcyAtIHN0YXJ0
ICovDQogCXN0cnVjdCBtbHg1ZV90eHFzcSAqdHhxMnNxW01MWDVFX01BWF9OVU1fQ0hBTk5FTFMg
KiBNTFg1RV9NQVhfTlVNX1RDXTsNCkBAIC03NTksNiArODA5LDcgQEAgc3RydWN0IG1seDVlX3By
aXYgew0KIAlzdHJ1Y3QgbWx4NWVfdGlyICAgICAgICAgICBpbmRpcl90aXJbTUxYNUVfTlVNX0lO
RElSX1RJUlNdOw0KIAlzdHJ1Y3QgbWx4NWVfdGlyICAgICAgICAgICBpbm5lcl9pbmRpcl90aXJb
TUxYNUVfTlVNX0lORElSX1RJUlNdOw0KIAlzdHJ1Y3QgbWx4NWVfdGlyICAgICAgICAgICBkaXJl
Y3RfdGlyW01MWDVFX01BWF9OVU1fQ0hBTk5FTFNdOw0KKwlzdHJ1Y3QgbWx4NWVfdGlyICAgICAg
ICAgICB4c2tfdGlyW01MWDVFX01BWF9OVU1fQ0hBTk5FTFNdOw0KIAlzdHJ1Y3QgbWx4NWVfcnNz
X3BhcmFtcyAgICByc3NfcGFyYW1zOw0KIAl1MzIgICAgICAgICAgICAgICAgICAgICAgICB0eF9y
YXRlc1tNTFg1RV9NQVhfTlVNX1NRU107DQogDQpAQCAtNzk1LDYgKzg0Niw3IEBAIHN0cnVjdCBt
bHg1ZV9wcml2IHsNCiAJc3RydWN0IG1seDVlX3RscyAgICAgICAgICAqdGxzOw0KICNlbmRpZg0K
IAlzdHJ1Y3QgZGV2bGlua19oZWFsdGhfcmVwb3J0ZXIgKnR4X3JlcG9ydGVyOw0KKwlzdHJ1Y3Qg
bWx4NWVfeHNrICAgICAgICAgICB4c2s7DQogfTsNCiANCiBzdHJ1Y3QgbWx4NWVfcHJvZmlsZSB7
DQpAQCAtODM4LDggKzg5MCw5IEBAIGJvb2wgbWx4NWVfc3RyaWRpbmdfcnFfcG9zc2libGUoc3Ry
dWN0IG1seDVfY29yZV9kZXYgKm1kZXYsDQogCQkJCXN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFt
cyk7DQogDQogdm9pZCBtbHg1ZV9wYWdlX2RtYV91bm1hcChzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBz
dHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvKTsNCi12b2lkIG1seDVlX3BhZ2VfcmVsZWFz
ZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0K
LQkJCWJvb2wgcmVjeWNsZSk7DQordm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2VfZHluYW1pYyhzdHJ1
Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQlzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0K
KwkJCQlib29sIHJlY3ljbGUpOw0KIHZvaWQgbWx4NWVfaGFuZGxlX3J4X2NxZShzdHJ1Y3QgbWx4
NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NV9jcWU2NCAqY3FlKTsNCiB2b2lkIG1seDVlX2hhbmRsZV9y
eF9jcWVfbXB3cnEoc3RydWN0IG1seDVlX3JxICpycSwgc3RydWN0IG1seDVfY3FlNjQgKmNxZSk7
DQogYm9vbCBtbHg1ZV9wb3N0X3J4X3dxZXMoc3RydWN0IG1seDVlX3JxICpycSk7DQpAQCAtODk5
LDYgKzk1MiwzMCBAQCB2b2lkIG1seDVlX2J1aWxkX2luZGlyX3Rpcl9jdHhfaGFzaChzdHJ1Y3Qg
bWx4NWVfcnNzX3BhcmFtcyAqcnNzX3BhcmFtcywNCiB2b2lkIG1seDVlX21vZGlmeV90aXJzX2hh
c2goc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHZvaWQgKmluLCBpbnQgaW5sZW4pOw0KIHN0cnVj
dCBtbHg1ZV90aXJjX2NvbmZpZyBtbHg1ZV90aXJjX2dldF9kZWZhdWx0X2NvbmZpZyhlbnVtIG1s
eDVlX3RyYWZmaWNfdHlwZXMgdHQpOw0KIA0KK3N0cnVjdCBtbHg1ZV94c2tfcGFyYW07DQorDQor
c3RydWN0IG1seDVlX3JxX3BhcmFtOw0KK2ludCBtbHg1ZV9vcGVuX3JxKHN0cnVjdCBtbHg1ZV9j
aGFubmVsICpjLCBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkgIHN0cnVjdCBtbHg1
ZV9ycV9wYXJhbSAqcGFyYW0sIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywNCisJCSAgc3Ry
dWN0IHhkcF91bWVtICp1bWVtLCBzdHJ1Y3QgbWx4NWVfcnEgKnJxKTsNCitpbnQgbWx4NWVfd2Fp
dF9mb3JfbWluX3J4X3dxZXMoc3RydWN0IG1seDVlX3JxICpycSwgaW50IHdhaXRfdGltZSk7DQor
dm9pZCBtbHg1ZV9kZWFjdGl2YXRlX3JxKHN0cnVjdCBtbHg1ZV9ycSAqcnEpOw0KK3ZvaWQgbWx4
NWVfY2xvc2VfcnEoc3RydWN0IG1seDVlX3JxICpycSk7DQorDQorc3RydWN0IG1seDVlX3NxX3Bh
cmFtOw0KK2ludCBtbHg1ZV9vcGVuX2ljb3NxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLCBzdHJ1
Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkgICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAq
cGFyYW0sIHN0cnVjdCBtbHg1ZV9pY29zcSAqc3EpOw0KK3ZvaWQgbWx4NWVfY2xvc2VfaWNvc3Eo
c3RydWN0IG1seDVlX2ljb3NxICpzcSk7DQoraW50IG1seDVlX29wZW5feGRwc3Eoc3RydWN0IG1s
eDVlX2NoYW5uZWwgKmMsIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCSAgICAgc3Ry
dWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSwgc3RydWN0IHhkcF91bWVtICp1bWVtLA0KKwkJICAg
ICBzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLCBib29sIGlzX3JlZGlyZWN0KTsNCit2b2lkIG1seDVl
X2Nsb3NlX3hkcHNxKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EpOw0KKw0KK3N0cnVjdCBtbHg1ZV9j
cV9wYXJhbTsNCitpbnQgbWx4NWVfb3Blbl9jcShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywgc3Ry
dWN0IG5ldF9kaW1fY3FfbW9kZXIgbW9kZXIsDQorCQkgIHN0cnVjdCBtbHg1ZV9jcV9wYXJhbSAq
cGFyYW0sIHN0cnVjdCBtbHg1ZV9jcSAqY3EpOw0KK3ZvaWQgbWx4NWVfY2xvc2VfY3Eoc3RydWN0
IG1seDVlX2NxICpjcSk7DQorDQogaW50IG1seDVlX29wZW5fbG9ja2VkKHN0cnVjdCBuZXRfZGV2
aWNlICpuZXRkZXYpOw0KIGludCBtbHg1ZV9jbG9zZV9sb2NrZWQoc3RydWN0IG5ldF9kZXZpY2Ug
Km5ldGRldik7DQogDQpAQCAtMTA2OSwxMCArMTE0NiwxMCBAQCBpbnQgbWx4NWVfY3JlYXRlX2lu
ZGlyZWN0X3JxdChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdik7DQogaW50IG1seDVlX2NyZWF0ZV9p
bmRpcmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBib29sIGlubmVyX3R0Yyk7DQog
dm9pZCBtbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYs
IGJvb2wgaW5uZXJfdHRjKTsNCiANCi1pbnQgbWx4NWVfY3JlYXRlX2RpcmVjdF9ycXRzKHN0cnVj
dCBtbHg1ZV9wcml2ICpwcml2KTsNCi12b2lkIG1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMoc3Ry
dWN0IG1seDVlX3ByaXYgKnByaXYpOw0KLWludCBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMoc3Ry
dWN0IG1seDVlX3ByaXYgKnByaXYpOw0KLXZvaWQgbWx4NWVfZGVzdHJveV9kaXJlY3RfdGlycyhz
dHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdik7DQoraW50IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhz
dHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX3RpciAqdGlycyk7DQordm9pZCBt
bHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3Qg
bWx4NWVfdGlyICp0aXJzKTsNCitpbnQgbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfdGlyICp0aXJzKTsNCit2b2lkIG1seDVlX2Rl
c3Ryb3lfZGlyZWN0X3RpcnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV90
aXIgKnRpcnMpOw0KIHZvaWQgbWx4NWVfZGVzdHJveV9ycXQoc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsIHN0cnVjdCBtbHg1ZV9ycXQgKnJxdCk7DQogDQogaW50IG1seDVlX2NyZWF0ZV90aXMoc3Ry
dWN0IG1seDVfY29yZV9kZXYgKm1kZXYsIGludCB0YywNCkBAIC0xMTQzLDYgKzEyMjAsNyBAQCB2
b2lkIG1seDVlX2RldGFjaF9uZXRkZXYoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpOw0KIHZvaWQg
bWx4NWVfZGVzdHJveV9uZXRkZXYoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpOw0KIHZvaWQgbWx4
NWVfc2V0X25ldGRldl9tdHVfYm91bmRhcmllcyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdik7DQog
dm9pZCBtbHg1ZV9idWlsZF9uaWNfcGFyYW1zKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0K
KwkJCSAgICBzdHJ1Y3QgbWx4NWVfeHNrICp4c2ssDQogCQkJICAgIHN0cnVjdCBtbHg1ZV9yc3Nf
cGFyYW1zICpyc3NfcGFyYW1zLA0KIAkJCSAgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMs
DQogCQkJICAgIHUxNiBtYXhfY2hhbm5lbHMsIHUxNiBtdHUpOw0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi9wYXJhbXMuYyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi9wYXJhbXMuYw0KaW5kZXggMGRlOTA4
YjEyZmNjLi43OTMwMWQxMTY2NjcgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9t
ZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFyYW1zLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0
L21lbGxhbm94L21seDUvY29yZS9lbi9wYXJhbXMuYw0KQEAgLTQ5LDQ4ICs0OSw1NiBAQCB1MzIg
bWx4NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywN
CiAJcmV0dXJuIGZyYWdfc3o7DQogfQ0KIA0KLXU4IG1seDVlX21wd3FlX2xvZ19wa3RzX3Blcl93
cWUoc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0KK3U4IG1seDVlX21wd3FlX2xvZ19wa3Rz
X3Blcl93cWUoc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQlzdHJ1Y3QgbWx4NWVf
eHNrX3BhcmFtICp4c2spDQogew0KLQl1MzIgbGluZWFyX2ZyYWdfc3ogPSBtbHg1ZV9yeF9nZXRf
bGluZWFyX2ZyYWdfc3oocGFyYW1zLCBOVUxMKTsNCisJdTMyIGxpbmVhcl9mcmFnX3N6ID0gbWx4
NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgeHNrKTsNCiANCiAJcmV0dXJuIE1MWDVf
TVBXUlFfTE9HX1dRRV9TWiAtIG9yZGVyX2Jhc2VfMihsaW5lYXJfZnJhZ19zeik7DQogfQ0KIA0K
LWJvb2wgbWx4NWVfcnhfaXNfbGluZWFyX3NrYihzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMp
DQorYm9vbCBtbHg1ZV9yeF9pc19saW5lYXJfc2tiKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFt
cywNCisJCQkgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrKQ0KIHsNCi0JdTMyIGZyYWdf
c3ogPSBtbHg1ZV9yeF9nZXRfbGluZWFyX2ZyYWdfc3oocGFyYW1zLCBOVUxMKTsNCisJLyogQUZf
WERQIGFsbG9jYXRlcyBTS0JzIG9uIFhEUF9QQVNTIC0gZW5zdXJlIHRoZXkgZG9uJ3Qgb2NjdXB5
IG1vcmUNCisJICogdGhhbiBvbmUgcGFnZS4gRm9yIHRoaXMsIGNoZWNrIGJvdGggd2l0aCBhbmQg
d2l0aG91dCB4c2suDQorCSAqLw0KKwl1MzIgbGluZWFyX2ZyYWdfc3ogPSBtYXgobWx4NWVfcnhf
Z2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgeHNrKSwNCisJCQkJIG1seDVlX3J4X2dldF9saW5l
YXJfZnJhZ19zeihwYXJhbXMsIE5VTEwpKTsNCiANCi0JcmV0dXJuICFwYXJhbXMtPmxyb19lbiAm
JiBmcmFnX3N6IDw9IFBBR0VfU0laRTsNCisJcmV0dXJuICFwYXJhbXMtPmxyb19lbiAmJiBsaW5l
YXJfZnJhZ19zeiA8PSBQQUdFX1NJWkU7DQogfQ0KIA0KICNkZWZpbmUgTUxYNV9NQVhfTVBXUUVf
TE9HX1dRRV9TVFJJREVfU1ogKChCSVQoX19tbHg1X2JpdF9zeih3cSwgbG9nX3dxZV9zdHJpZGVf
c2l6ZSkpIC0gMSkgKyBcDQogCQkJCQkgIE1MWDVfTVBXUUVfTE9HX1NUUklERV9TWl9CQVNFKQ0K
IGJvb2wgbWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihzdHJ1Y3QgbWx4NV9jb3JlX2RldiAq
bWRldiwNCi0JCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMpDQorCQkJCSAgc3RydWN0
IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhz
aykNCiB7DQotCXUzMiBmcmFnX3N6ID0gbWx4NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFt
cywgTlVMTCk7DQorCXUzMiBsaW5lYXJfZnJhZ19zeiA9IG1seDVlX3J4X2dldF9saW5lYXJfZnJh
Z19zeihwYXJhbXMsIHhzayk7DQogCXM4IHNpZ25lZF9sb2dfbnVtX3N0cmlkZXNfcGFyYW07DQog
CXU4IGxvZ19udW1fc3RyaWRlczsNCiANCi0JaWYgKCFtbHg1ZV9yeF9pc19saW5lYXJfc2tiKHBh
cmFtcykpDQorCWlmICghbWx4NWVfcnhfaXNfbGluZWFyX3NrYihwYXJhbXMsIHhzaykpDQogCQly
ZXR1cm4gZmFsc2U7DQogDQotCWlmIChvcmRlcl9iYXNlXzIoZnJhZ19zeikgPiBNTFg1X01BWF9N
UFdRRV9MT0dfV1FFX1NUUklERV9TWikNCisJaWYgKG9yZGVyX2Jhc2VfMihsaW5lYXJfZnJhZ19z
eikgPiBNTFg1X01BWF9NUFdRRV9MT0dfV1FFX1NUUklERV9TWikNCiAJCXJldHVybiBmYWxzZTsN
CiANCiAJaWYgKE1MWDVfQ0FQX0dFTihtZGV2LCBleHRfc3RyaWRlX251bV9yYW5nZSkpDQogCQly
ZXR1cm4gdHJ1ZTsNCiANCi0JbG9nX251bV9zdHJpZGVzID0gTUxYNV9NUFdSUV9MT0dfV1FFX1Na
IC0gb3JkZXJfYmFzZV8yKGZyYWdfc3opOw0KKwlsb2dfbnVtX3N0cmlkZXMgPSBNTFg1X01QV1JR
X0xPR19XUUVfU1ogLSBvcmRlcl9iYXNlXzIobGluZWFyX2ZyYWdfc3opOw0KIAlzaWduZWRfbG9n
X251bV9zdHJpZGVzX3BhcmFtID0NCiAJCShzOClsb2dfbnVtX3N0cmlkZXMgLSBNTFg1X01QV1FF
X0xPR19OVU1fU1RSSURFU19CQVNFOw0KIA0KIAlyZXR1cm4gc2lnbmVkX2xvZ19udW1fc3RyaWRl
c19wYXJhbSA+PSAwOw0KIH0NCiANCi11OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUoc3Ry
dWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0KK3U4IG1seDVlX21wd3FlX2dldF9sb2dfcnFfc2l6
ZShzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICAgICAgIHN0cnVjdCBtbHg1ZV94
c2tfcGFyYW0gKnhzaykNCiB7DQotCXU4IGxvZ19wa3RzX3Blcl93cWUgPSBtbHg1ZV9tcHdxZV9s
b2dfcGt0c19wZXJfd3FlKHBhcmFtcyk7DQorCXU4IGxvZ19wa3RzX3Blcl93cWUgPSBtbHg1ZV9t
cHdxZV9sb2dfcGt0c19wZXJfd3FlKHBhcmFtcywgeHNrKTsNCiANCiAJLyogTnVtYmVycyBhcmUg
dW5zaWduZWQsIGRvbid0IHN1YnRyYWN0IHRvIGF2b2lkIHVuZGVyZmxvdy4gKi8NCiAJaWYgKHBh
cmFtcy0+bG9nX3JxX210dV9mcmFtZXMgPA0KQEAgLTEwMSwyNyArMTA5LDMwIEBAIHU4IG1seDVl
X21wd3FlX2dldF9sb2dfcnFfc2l6ZShzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMpDQogfQ0K
IA0KIHU4IG1seDVlX21wd3FlX2dldF9sb2dfc3RyaWRlX3NpemUoc3RydWN0IG1seDVfY29yZV9k
ZXYgKm1kZXYsDQotCQkJCSAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcykNCisJCQkJICAg
c3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfeHNrX3Bh
cmFtICp4c2spDQogew0KLQlpZiAobWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBw
YXJhbXMpKQ0KLQkJcmV0dXJuIG9yZGVyX2Jhc2VfMihtbHg1ZV9yeF9nZXRfbGluZWFyX2ZyYWdf
c3oocGFyYW1zLCBOVUxMKSk7DQorCWlmIChtbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1k
ZXYsIHBhcmFtcywgeHNrKSkNCisJCXJldHVybiBvcmRlcl9iYXNlXzIobWx4NWVfcnhfZ2V0X2xp
bmVhcl9mcmFnX3N6KHBhcmFtcywgeHNrKSk7DQogDQogCXJldHVybiBNTFg1X01QV1JRX0RFRl9M
T0dfU1RSSURFX1NaKG1kZXYpOw0KIH0NCiANCiB1OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9z
dHJpZGVzKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KLQkJCQkgICBzdHJ1Y3QgbWx4NWVf
cGFyYW1zICpwYXJhbXMpDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJ
CQkJICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrKQ0KIHsNCiAJcmV0dXJuIE1MWDVfTVBX
UlFfTE9HX1dRRV9TWiAtDQotCQltbHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKG1kZXYs
IHBhcmFtcyk7DQorCQltbHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKG1kZXYsIHBhcmFt
cywgeHNrKTsNCiB9DQogDQogdTE2IG1seDVlX2dldF9ycV9oZWFkcm9vbShzdHJ1Y3QgbWx4NV9j
b3JlX2RldiAqbWRldiwNCi0JCQkgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcykNCisJCQkg
IHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgIHN0cnVjdCBtbHg1ZV94c2tfcGFy
YW0gKnhzaykNCiB7DQogCWJvb2wgaXNfbGluZWFyX3NrYiA9IChwYXJhbXMtPnJxX3dxX3R5cGUg
PT0gTUxYNV9XUV9UWVBFX0NZQ0xJQykgPw0KLQkJbWx4NWVfcnhfaXNfbGluZWFyX3NrYihwYXJh
bXMpIDoNCi0JCW1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zKTsNCisJ
CW1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1zLCB4c2spIDoNCisJCW1seDVlX3J4X21wd3Fl
X2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zLCB4c2spOw0KIA0KLQlyZXR1cm4gaXNfbGluZWFy
X3NrYiA/IG1seDVlX2dldF9saW5lYXJfcnFfaGVhZHJvb20ocGFyYW1zLCBOVUxMKSA6IDA7DQor
CXJldHVybiBpc19saW5lYXJfc2tiID8gbWx4NWVfZ2V0X2xpbmVhcl9ycV9oZWFkcm9vbShwYXJh
bXMsIHhzaykgOiAwOw0KIH0NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW4vcGFyYW1zLmggYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5v
eC9tbHg1L2NvcmUvZW4vcGFyYW1zLmgNCmluZGV4IGY4MzQxN2I4MjJiZi4uYmQ4ODJiNWVlOWE3
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vu
L3BhcmFtcy5oDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUv
ZW4vcGFyYW1zLmgNCkBAIC00MCwyMiArNDAsODUgQEAgc3RydWN0IG1seDVlX2NoYW5uZWxfcGFy
YW0gew0KIAlzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gICAgICBpY29zcV9jcTsNCiB9Ow0KIA0KK3N0
YXRpYyBpbmxpbmUgYm9vbCBtbHg1ZV9xaWRfZ2V0X2NoX2lmX2luX2dyb3VwKHN0cnVjdCBtbHg1
ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJCQl1MTYgcWlkLA0KKwkJCQkJCWVudW0gbWx4NWVfcnFf
Z3JvdXAgZ3JvdXAsDQorCQkJCQkJdTE2ICppeCkNCit7DQorCWludCBuY2ggPSBwYXJhbXMtPm51
bV9jaGFubmVsczsNCisJaW50IGNoID0gcWlkIC0gbmNoICogZ3JvdXA7DQorDQorCWlmIChjaCA8
IDAgfHwgY2ggPj0gbmNoKQ0KKwkJcmV0dXJuIGZhbHNlOw0KKw0KKwkqaXggPSBjaDsNCisJcmV0
dXJuIHRydWU7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBtbHg1ZV9xaWRfZ2V0X2NoX2Fu
ZF9ncm91cChzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCQkgICAgICB1MTYgcWlk
LA0KKwkJCQkJICAgICAgdTE2ICppeCwNCisJCQkJCSAgICAgIGVudW0gbWx4NWVfcnFfZ3JvdXAg
Kmdyb3VwKQ0KK3sNCisJdTE2IG5jaCA9IHBhcmFtcy0+bnVtX2NoYW5uZWxzOw0KKw0KKwkqaXgg
PSBxaWQgJSBuY2g7DQorCSpncm91cCA9IHFpZCAvIG5jaDsNCit9DQorDQorc3RhdGljIGlubGlu
ZSBib29sIG1seDVlX3FpZF92YWxpZGF0ZShzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsIHU2
NCBxaWQpDQorew0KKwlyZXR1cm4gcWlkIDwgcGFyYW1zLT5udW1fY2hhbm5lbHMgKiBNTFg1RV9O
VU1fUlFfR1JPVVBTOw0KK30NCisNCiAvKiBQYXJhbWV0ZXIgY2FsY3VsYXRpb25zICovDQogDQog
dTE2IG1seDVlX2dldF9saW5lYXJfcnFfaGVhZHJvb20oc3RydWN0IG1seDVlX3BhcmFtcyAqcGFy
YW1zLA0KIAkJCQkgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrKTsNCiB1MzIgbWx4NWVfcnhf
Z2V0X2xpbmVhcl9mcmFnX3N6KHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCiAJCQkJc3Ry
dWN0IG1seDVlX3hza19wYXJhbSAqeHNrKTsNCi11OCBtbHg1ZV9tcHdxZV9sb2dfcGt0c19wZXJf
d3FlKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyk7DQotYm9vbCBtbHg1ZV9yeF9pc19saW5l
YXJfc2tiKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyk7DQordTggbWx4NWVfbXB3cWVfbG9n
X3BrdHNfcGVyX3dxZShzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCXN0cnVjdCBt
bHg1ZV94c2tfcGFyYW0gKnhzayk7DQorYm9vbCBtbHg1ZV9yeF9pc19saW5lYXJfc2tiKHN0cnVj
dCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAq
eHNrKTsNCiBib29sIG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2Ioc3RydWN0IG1seDVfY29y
ZV9kZXYgKm1kZXYsDQotCQkJCSAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKTsNCi11OCBt
bHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUoc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKTsN
CisJCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCSAgc3RydWN0IG1seDVl
X3hza19wYXJhbSAqeHNrKTsNCit1OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUoc3RydWN0
IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgICAgICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFt
ICp4c2spOw0KIHU4IG1seDVlX21wd3FlX2dldF9sb2dfc3RyaWRlX3NpemUoc3RydWN0IG1seDVf
Y29yZV9kZXYgKm1kZXYsDQotCQkJCSAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyk7DQor
CQkJCSAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJICAgc3RydWN0IG1seDVl
X3hza19wYXJhbSAqeHNrKTsNCiB1OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9zdHJpZGVzKHN0
cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KLQkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpw
YXJhbXMpOw0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCSAgIHN0
cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzayk7DQogdTE2IG1seDVlX2dldF9ycV9oZWFkcm9vbShz
dHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCi0JCQkgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBh
cmFtcyk7DQorCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICBzdHJ1Y3Qg
bWx4NWVfeHNrX3BhcmFtICp4c2spOw0KKw0KKy8qIEJ1aWxkIHF1ZXVlIHBhcmFtZXRlcnMgKi8N
CisNCit2b2lkIG1seDVlX2J1aWxkX3JxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0K
KwkJCSAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgc3RydWN0IG1seDVlX3hz
a19wYXJhbSAqeHNrLA0KKwkJCSAgc3RydWN0IG1seDVlX3JxX3BhcmFtICpwYXJhbSk7DQordm9p
ZCBtbHg1ZV9idWlsZF9zcV9wYXJhbV9jb21tb24oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQor
CQkJCSBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtKTsNCit2b2lkIG1seDVlX2J1aWxkX3J4
X2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgc3RydWN0IG1seDVl
X3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrLA0K
KwkJCSAgICAgc3RydWN0IG1seDVlX2NxX3BhcmFtICpwYXJhbSk7DQordm9pZCBtbHg1ZV9idWls
ZF90eF9jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgICAgIHN0cnVjdCBt
bHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgICAgIHN0cnVjdCBtbHg1ZV9jcV9wYXJhbSAqcGFy
YW0pOw0KK3ZvaWQgbWx4NWVfYnVpbGRfaWNvX2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2LA0KKwkJCSAgICAgIHU4IGxvZ193cV9zaXplLA0KKwkJCSAgICAgIHN0cnVjdCBtbHg1ZV9j
cV9wYXJhbSAqcGFyYW0pOw0KK3ZvaWQgbWx4NWVfYnVpbGRfaWNvc3FfcGFyYW0oc3RydWN0IG1s
eDVlX3ByaXYgKnByaXYsDQorCQkJICAgICB1OCBsb2dfd3Ffc2l6ZSwNCisJCQkgICAgIHN0cnVj
dCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pOw0KK3ZvaWQgbWx4NWVfYnVpbGRfeGRwc3FfcGFyYW0o
c3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpw
YXJhbXMsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtKTsNCiANCiAjZW5k
aWYgLyogX19NTFg1X0VOX1BBUkFNU19IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9l
dGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmMNCmluZGV4IGVlOTllZmRlOTE0My4uYjBiOTgy
Y2Y2OWJiIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9j
b3JlL2VuL3hkcC5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2Nv
cmUvZW4veGRwLmMNCkBAIC0zMSw2ICszMSw3IEBADQogICovDQogDQogI2luY2x1ZGUgPGxpbnV4
L2JwZl90cmFjZS5oPg0KKyNpbmNsdWRlIDxuZXQveGRwX3NvY2suaD4NCiAjaW5jbHVkZSAiZW4v
eGRwLmgiDQogI2luY2x1ZGUgImVuL3BhcmFtcy5oIg0KIA0KQEAgLTExMywxMiArMTE0LDEyIEBA
IG1seDVlX3htaXRfeGRwX2J1ZmYoc3RydWN0IG1seDVlX3hkcHNxICpzcSwgc3RydWN0IG1seDVl
X3JxICpycSwNCiAJCXhkcGkucGFnZS5kaSAgICA9ICpkaTsNCiAJfQ0KIA0KLQlyZXR1cm4gc3Et
PnhtaXRfeGRwX2ZyYW1lKHNxLCAmeGRwdHhkLCAmeGRwaSk7DQorCXJldHVybiBzcS0+eG1pdF94
ZHBfZnJhbWUoc3EsICZ4ZHB0eGQsICZ4ZHBpLCAwKTsNCiB9DQogDQogLyogcmV0dXJucyB0cnVl
IGlmIHBhY2tldCB3YXMgY29uc3VtZWQgYnkgeGRwICovDQogYm9vbCBtbHg1ZV94ZHBfaGFuZGxl
KHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZGksDQotCQkgICAg
ICB2b2lkICp2YSwgdTE2ICpyeF9oZWFkcm9vbSwgdTMyICpsZW4pDQorCQkgICAgICB2b2lkICp2
YSwgdTE2ICpyeF9oZWFkcm9vbSwgdTMyICpsZW4sIGJvb2wgeHNrKQ0KIHsNCiAJc3RydWN0IGJw
Zl9wcm9nICpwcm9nID0gUkVBRF9PTkNFKHJxLT54ZHBfcHJvZyk7DQogCXN0cnVjdCB4ZHBfYnVm
ZiB4ZHA7DQpAQCAtMTMyLDkgKzEzMywxMyBAQCBib29sIG1seDVlX3hkcF9oYW5kbGUoc3RydWN0
IG1seDVlX3JxICpycSwgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkaSwNCiAJeGRwX3NldF9kYXRh
X21ldGFfaW52YWxpZCgmeGRwKTsNCiAJeGRwLmRhdGFfZW5kID0geGRwLmRhdGEgKyAqbGVuOw0K
IAl4ZHAuZGF0YV9oYXJkX3N0YXJ0ID0gdmE7DQorCWlmICh4c2spDQorCQl4ZHAuaGFuZGxlID0g
ZGktPnhzay5oYW5kbGU7DQogCXhkcC5yeHEgPSAmcnEtPnhkcF9yeHE7DQogDQogCWFjdCA9IGJw
Zl9wcm9nX3J1bl94ZHAocHJvZywgJnhkcCk7DQorCWlmICh4c2spDQorCQl4ZHAuaGFuZGxlICs9
IHhkcC5kYXRhIC0geGRwLmRhdGFfaGFyZF9zdGFydDsNCiAJc3dpdGNoIChhY3QpIHsNCiAJY2Fz
ZSBYRFBfUEFTUzoNCiAJCSpyeF9oZWFkcm9vbSA9IHhkcC5kYXRhIC0geGRwLmRhdGFfaGFyZF9z
dGFydDsNCkBAIC0xNTIsNyArMTU3LDggQEAgYm9vbCBtbHg1ZV94ZHBfaGFuZGxlKHN0cnVjdCBt
bHg1ZV9ycSAqcnEsIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZGksDQogCQkJZ290byB4ZHBfYWJv
cnQ7DQogCQlfX3NldF9iaXQoTUxYNUVfUlFfRkxBR19YRFBfWE1JVCwgcnEtPmZsYWdzKTsNCiAJ
CV9fc2V0X2JpdChNTFg1RV9SUV9GTEFHX1hEUF9SRURJUkVDVCwgcnEtPmZsYWdzKTsNCi0JCW1s
eDVlX3BhZ2VfZG1hX3VubWFwKHJxLCBkaSk7DQorCQlpZiAoIXhzaykNCisJCQltbHg1ZV9wYWdl
X2RtYV91bm1hcChycSwgZGkpOw0KIAkJcnEtPnN0YXRzLT54ZHBfcmVkaXJlY3QrKzsNCiAJCXJl
dHVybiB0cnVlOw0KIAlkZWZhdWx0Og0KQEAgLTIwNiw3ICsyMTIsNyBAQCBzdGF0aWMgdm9pZCBt
bHg1ZV94ZHBfbXB3cWVfc2Vzc2lvbl9zdGFydChzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxKQ0KIAlz
dGF0cy0+bXB3cWUrKzsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVfeGRwX21wd3FlX2NvbXBs
ZXRlKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EpDQordm9pZCBtbHg1ZV94ZHBfbXB3cWVfY29tcGxl
dGUoc3RydWN0IG1seDVlX3hkcHNxICpzcSkNCiB7DQogCXN0cnVjdCBtbHg1X3dxX2N5YyAgICAg
ICAqd3EgICAgPSAmc3EtPndxOw0KIAlzdHJ1Y3QgbWx4NWVfeGRwX21wd3FlICpzZXNzaW9uID0g
JnNxLT5tcHdxZTsNCkBAIC0yMjksOSArMjM1LDMyIEBAIHN0YXRpYyB2b2lkIG1seDVlX3hkcF9t
cHdxZV9jb21wbGV0ZShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxKQ0KIAlzZXNzaW9uLT53cWUgPSBO
VUxMOyAvKiBDbG9zZSBzZXNzaW9uICovDQogfQ0KIA0KK2VudW0gew0KKwlNTFg1RV9YRFBfQ0hF
Q0tfT0sgPSAxLA0KKwlNTFg1RV9YRFBfQ0hFQ0tfU1RBUlRfTVBXUUUgPSAyLA0KK307DQorDQor
c3RhdGljIGludCBtbHg1ZV94bWl0X3hkcF9mcmFtZV9jaGVja19tcHdxZShzdHJ1Y3QgbWx4NWVf
eGRwc3EgKnNxKQ0KK3sNCisJaWYgKHVubGlrZWx5KCFzcS0+bXB3cWUud3FlKSkgew0KKwkJaWYg
KHVubGlrZWx5KCFtbHg1ZV93cWNfaGFzX3Jvb21fZm9yKCZzcS0+d3EsIHNxLT5jYywgc3EtPnBj
LA0KKwkJCQkJCSAgICAgTUxYNV9TRU5EX1dRRV9NQVhfV1FFQkJTKSkpIHsNCisJCQkvKiBTUSBp
cyBmdWxsLCByaW5nIGRvb3JiZWxsICovDQorCQkJbWx4NWVfeG1pdF94ZHBfZG9vcmJlbGwoc3Ep
Ow0KKwkJCXNxLT5zdGF0cy0+ZnVsbCsrOw0KKwkJCXJldHVybiAtRUJVU1k7DQorCQl9DQorDQor
CQlyZXR1cm4gTUxYNUVfWERQX0NIRUNLX1NUQVJUX01QV1FFOw0KKwl9DQorDQorCXJldHVybiBN
TFg1RV9YRFBfQ0hFQ0tfT0s7DQorfQ0KKw0KIHN0YXRpYyBib29sIG1seDVlX3htaXRfeGRwX2Zy
YW1lX21wd3FlKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsDQogCQkJCSAgICAgICBzdHJ1Y3QgbWx4
NWVfeGRwX3htaXRfZGF0YSAqeGRwdHhkLA0KLQkJCQkgICAgICAgc3RydWN0IG1seDVlX3hkcF9p
bmZvICp4ZHBpKQ0KKwkJCQkgICAgICAgc3RydWN0IG1seDVlX3hkcF9pbmZvICp4ZHBpLA0KKwkJ
CQkgICAgICAgaW50IGNoZWNrX3Jlc3VsdCkNCiB7DQogCXN0cnVjdCBtbHg1ZV94ZHBfbXB3cWUg
KnNlc3Npb24gPSAmc3EtPm1wd3FlOw0KIAlzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMgKnN0YXRz
ID0gc3EtPnN0YXRzOw0KQEAgLTI0MSwxNSArMjcwLDE2IEBAIHN0YXRpYyBib29sIG1seDVlX3ht
aXRfeGRwX2ZyYW1lX21wd3FlKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsDQogCQlyZXR1cm4gZmFs
c2U7DQogCX0NCiANCi0JaWYgKHVubGlrZWx5KCFzZXNzaW9uLT53cWUpKSB7DQotCQlpZiAodW5s
aWtlbHkoIW1seDVlX3dxY19oYXNfcm9vbV9mb3IoJnNxLT53cSwgc3EtPmNjLCBzcS0+cGMsDQot
CQkJCQkJICAgICBNTFg1X1NFTkRfV1FFX01BWF9XUUVCQlMpKSkgew0KLQkJCS8qIFNRIGlzIGZ1
bGwsIHJpbmcgZG9vcmJlbGwgKi8NCi0JCQltbHg1ZV94bWl0X3hkcF9kb29yYmVsbChzcSk7DQot
CQkJc3RhdHMtPmZ1bGwrKzsNCi0JCQlyZXR1cm4gZmFsc2U7DQotCQl9DQorCWlmICghY2hlY2tf
cmVzdWx0KQ0KKwkJY2hlY2tfcmVzdWx0ID0gbWx4NWVfeG1pdF94ZHBfZnJhbWVfY2hlY2tfbXB3
cWUoc3EpOw0KKwlpZiAodW5saWtlbHkoY2hlY2tfcmVzdWx0IDwgMCkpDQorCQlyZXR1cm4gZmFs
c2U7DQogDQorCWlmIChjaGVja19yZXN1bHQgPT0gTUxYNUVfWERQX0NIRUNLX1NUQVJUX01QV1FF
KSB7DQorCQkvKiBTdGFydCB0aGUgc2Vzc2lvbiB3aGVuIG5vdGhpbmcgY2FuIGZhaWwsIHNvIGl0
J3MgZ3VhcmFudGVlZA0KKwkJICogdGhhdCBpZiB0aGVyZSBpcyBhbiBhY3RpdmUgc2Vzc2lvbiwg
aXQgaGFzIGF0IGxlYXN0IG9uZSBkc2VnLA0KKwkJICogYW5kIGl0J3Mgc2FmZSB0byBjb21wbGV0
ZSBpdCBhdCBhbnkgdGltZS4NCisJCSAqLw0KIAkJbWx4NWVfeGRwX21wd3FlX3Nlc3Npb25fc3Rh
cnQoc3EpOw0KIAl9DQogDQpAQCAtMjY0LDkgKzI5NCwyMiBAQCBzdGF0aWMgYm9vbCBtbHg1ZV94
bWl0X3hkcF9mcmFtZV9tcHdxZShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIAlyZXR1cm4gdHJ1
ZTsNCiB9DQogDQorc3RhdGljIGludCBtbHg1ZV94bWl0X3hkcF9mcmFtZV9jaGVjayhzdHJ1Y3Qg
bWx4NWVfeGRwc3EgKnNxKQ0KK3sNCisJaWYgKHVubGlrZWx5KCFtbHg1ZV93cWNfaGFzX3Jvb21f
Zm9yKCZzcS0+d3EsIHNxLT5jYywgc3EtPnBjLCAxKSkpIHsNCisJCS8qIFNRIGlzIGZ1bGwsIHJp
bmcgZG9vcmJlbGwgKi8NCisJCW1seDVlX3htaXRfeGRwX2Rvb3JiZWxsKHNxKTsNCisJCXNxLT5z
dGF0cy0+ZnVsbCsrOw0KKwkJcmV0dXJuIC1FQlVTWTsNCisJfQ0KKw0KKwlyZXR1cm4gTUxYNUVf
WERQX0NIRUNLX09LOw0KK30NCisNCiBzdGF0aWMgYm9vbCBtbHg1ZV94bWl0X3hkcF9mcmFtZShz
dHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIAkJCQkgc3RydWN0IG1seDVlX3hkcF94bWl0X2RhdGEg
KnhkcHR4ZCwNCi0JCQkJIHN0cnVjdCBtbHg1ZV94ZHBfaW5mbyAqeGRwaSkNCisJCQkJIHN0cnVj
dCBtbHg1ZV94ZHBfaW5mbyAqeGRwaSwNCisJCQkJIGludCBjaGVja19yZXN1bHQpDQogew0KIAlz
dHJ1Y3QgbWx4NV93cV9jeWMgICAgICAgKndxICAgPSAmc3EtPndxOw0KIAl1MTYgICAgICAgICAg
ICAgICAgICAgICAgIHBpICAgPSBtbHg1X3dxX2N5Y19jdHIyaXgod3EsIHNxLT5wYyk7DQpAQCAt
Mjg4LDEyICszMzEsMTAgQEAgc3RhdGljIGJvb2wgbWx4NWVfeG1pdF94ZHBfZnJhbWUoc3RydWN0
IG1seDVlX3hkcHNxICpzcSwNCiAJCXJldHVybiBmYWxzZTsNCiAJfQ0KIA0KLQlpZiAodW5saWtl
bHkoIW1seDVlX3dxY19oYXNfcm9vbV9mb3Iod3EsIHNxLT5jYywgc3EtPnBjLCAxKSkpIHsNCi0J
CS8qIFNRIGlzIGZ1bGwsIHJpbmcgZG9vcmJlbGwgKi8NCi0JCW1seDVlX3htaXRfeGRwX2Rvb3Ji
ZWxsKHNxKTsNCi0JCXN0YXRzLT5mdWxsKys7DQorCWlmICghY2hlY2tfcmVzdWx0KQ0KKwkJY2hl
Y2tfcmVzdWx0ID0gbWx4NWVfeG1pdF94ZHBfZnJhbWVfY2hlY2soc3EpOw0KKwlpZiAodW5saWtl
bHkoY2hlY2tfcmVzdWx0IDwgMCkpDQogCQlyZXR1cm4gZmFsc2U7DQotCX0NCiANCiAJY3NlZy0+
Zm1fY2Vfc2UgPSAwOw0KIA0KQEAgLTMyMyw2ICszNjQsNyBAQCBzdGF0aWMgYm9vbCBtbHg1ZV94
bWl0X3hkcF9mcmFtZShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIA0KIHN0YXRpYyB2b2lkIG1s
eDVlX2ZyZWVfeGRwc3FfZGVzYyhzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIAkJCQkgIHN0cnVj
dCBtbHg1ZV94ZHBfd3FlX2luZm8gKndpLA0KKwkJCQkgIHUzMiAqeHNrX2ZyYW1lcywNCiAJCQkJ
ICBib29sIHJlY3ljbGUpDQogew0KIAlzdHJ1Y3QgbWx4NWVfeGRwX2luZm9fZmlmbyAqeGRwaV9m
aWZvID0gJnNxLT5kYi54ZHBpX2ZpZm87DQpAQCAtMzQwLDcgKzM4MiwxMSBAQCBzdGF0aWMgdm9p
ZCBtbHg1ZV9mcmVlX3hkcHNxX2Rlc2Moc3RydWN0IG1seDVlX3hkcHNxICpzcSwNCiAJCQlicmVh
azsNCiAJCWNhc2UgTUxYNUVfWERQX1hNSVRfTU9ERV9QQUdFOg0KIAkJCS8qIFhEUF9UWCBmcm9t
IHRoZSByZWd1bGFyIFJRICovDQotCQkJbWx4NWVfcGFnZV9yZWxlYXNlKHhkcGkucGFnZS5ycSwg
JnhkcGkucGFnZS5kaSwgcmVjeWNsZSk7DQorCQkJbWx4NWVfcGFnZV9yZWxlYXNlX2R5bmFtaWMo
eGRwaS5wYWdlLnJxLCAmeGRwaS5wYWdlLmRpLCByZWN5Y2xlKTsNCisJCQlicmVhazsNCisJCWNh
c2UgTUxYNUVfWERQX1hNSVRfTU9ERV9YU0s6DQorCQkJLyogQUZfWERQIHNlbmQgKi8NCisJCQko
Knhza19mcmFtZXMpKys7DQogCQkJYnJlYWs7DQogCQlkZWZhdWx0Og0KIAkJCVdBUk5fT05fT05D
RSh0cnVlKTsNCkBAIC0zNTIsNiArMzk4LDcgQEAgYm9vbCBtbHg1ZV9wb2xsX3hkcHNxX2NxKHN0
cnVjdCBtbHg1ZV9jcSAqY3EpDQogew0KIAlzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxOw0KIAlzdHJ1
Y3QgbWx4NV9jcWU2NCAqY3FlOw0KKwl1MzIgeHNrX2ZyYW1lcyA9IDA7DQogCXUxNiBzcWNjOw0K
IAlpbnQgaTsNCiANCkBAIC0zOTMsMTAgKzQ0MCwxMyBAQCBib29sIG1seDVlX3BvbGxfeGRwc3Ff
Y3Eoc3RydWN0IG1seDVlX2NxICpjcSkNCiANCiAJCQlzcWNjICs9IHdpLT5udW1fd3FlYmJzOw0K
IA0KLQkJCW1seDVlX2ZyZWVfeGRwc3FfZGVzYyhzcSwgd2ksIHRydWUpOw0KKwkJCW1seDVlX2Zy
ZWVfeGRwc3FfZGVzYyhzcSwgd2ksICZ4c2tfZnJhbWVzLCB0cnVlKTsNCiAJCX0gd2hpbGUgKCFs
YXN0X3dxZSk7DQogCX0gd2hpbGUgKCgrK2kgPCBNTFg1RV9UWF9DUV9QT0xMX0JVREdFVCkgJiYg
KGNxZSA9IG1seDVfY3F3cV9nZXRfY3FlKCZjcS0+d3EpKSk7DQogDQorCWlmICh4c2tfZnJhbWVz
KQ0KKwkJeHNrX3VtZW1fY29tcGxldGVfdHgoc3EtPnVtZW0sIHhza19mcmFtZXMpOw0KKw0KIAlz
cS0+c3RhdHMtPmNxZXMgKz0gaTsNCiANCiAJbWx4NV9jcXdxX3VwZGF0ZV9kYl9yZWNvcmQoJmNx
LT53cSk7DQpAQCAtNDEwLDYgKzQ2MCw4IEBAIGJvb2wgbWx4NWVfcG9sbF94ZHBzcV9jcShzdHJ1
Y3QgbWx4NWVfY3EgKmNxKQ0KIA0KIHZvaWQgbWx4NWVfZnJlZV94ZHBzcV9kZXNjcyhzdHJ1Y3Qg
bWx4NWVfeGRwc3EgKnNxKQ0KIHsNCisJdTMyIHhza19mcmFtZXMgPSAwOw0KKw0KIAl3aGlsZSAo
c3EtPmNjICE9IHNxLT5wYykgew0KIAkJc3RydWN0IG1seDVlX3hkcF93cWVfaW5mbyAqd2k7DQog
CQl1MTYgY2k7DQpAQCAtNDE5LDggKzQ3MSwxMSBAQCB2b2lkIG1seDVlX2ZyZWVfeGRwc3FfZGVz
Y3Moc3RydWN0IG1seDVlX3hkcHNxICpzcSkNCiANCiAJCXNxLT5jYyArPSB3aS0+bnVtX3dxZWJi
czsNCiANCi0JCW1seDVlX2ZyZWVfeGRwc3FfZGVzYyhzcSwgd2ksIGZhbHNlKTsNCisJCW1seDVl
X2ZyZWVfeGRwc3FfZGVzYyhzcSwgd2ksICZ4c2tfZnJhbWVzLCBmYWxzZSk7DQogCX0NCisNCisJ
aWYgKHhza19mcmFtZXMpDQorCQl4c2tfdW1lbV9jb21wbGV0ZV90eChzcS0+dW1lbSwgeHNrX2Zy
YW1lcyk7DQogfQ0KIA0KIGludCBtbHg1ZV94ZHBfeG1pdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LCBpbnQgbiwgc3RydWN0IHhkcF9mcmFtZSAqKmZyYW1lcywNCkBAIC00NjYsNyArNTIxLDcgQEAg
aW50IG1seDVlX3hkcF94bWl0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGludCBuLCBzdHJ1Y3Qg
eGRwX2ZyYW1lICoqZnJhbWVzLA0KIAkJeGRwaS5mcmFtZS54ZHBmICAgICA9IHhkcGY7DQogCQl4
ZHBpLmZyYW1lLmRtYV9hZGRyID0geGRwdHhkLmRtYV9hZGRyOw0KIA0KLQkJaWYgKHVubGlrZWx5
KCFzcS0+eG1pdF94ZHBfZnJhbWUoc3EsICZ4ZHB0eGQsICZ4ZHBpKSkpIHsNCisJCWlmICh1bmxp
a2VseSghc3EtPnhtaXRfeGRwX2ZyYW1lKHNxLCAmeGRwdHhkLCAmeGRwaSwgMCkpKSB7DQogCQkJ
ZG1hX3VubWFwX3NpbmdsZShzcS0+cGRldiwgeGRwdHhkLmRtYV9hZGRyLA0KIAkJCQkJIHhkcHR4
ZC5sZW4sIERNQV9UT19ERVZJQ0UpOw0KIAkJCXhkcF9yZXR1cm5fZnJhbWVfcnhfbmFwaSh4ZHBm
KTsNCkBAIC01MDAsNiArNTU1LDggQEAgdm9pZCBtbHg1ZV94ZHBfcnhfcG9sbF9jb21wbGV0ZShz
dHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIA0KIHZvaWQgbWx4NWVfc2V0X3htaXRfZnAoc3RydWN0IG1s
eDVlX3hkcHNxICpzcSwgYm9vbCBpc19tcHcpDQogew0KKwlzcS0+eG1pdF94ZHBfZnJhbWVfY2hl
Y2sgPSBpc19tcHcgPw0KKwkJbWx4NWVfeG1pdF94ZHBfZnJhbWVfY2hlY2tfbXB3cWUgOiBtbHg1
ZV94bWl0X3hkcF9mcmFtZV9jaGVjazsNCiAJc3EtPnhtaXRfeGRwX2ZyYW1lID0gaXNfbXB3ID8N
CiAJCW1seDVlX3htaXRfeGRwX2ZyYW1lX21wd3FlIDogbWx4NWVfeG1pdF94ZHBfZnJhbWU7DQog
fQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9l
bi94ZHAuaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94ZHAu
aA0KaW5kZXggOTIwMGNiOWY0OTliLi4yZDkzNGM4ZDM4MDcgMTAwNjQ0DQotLS0gYS9kcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmgNCisrKyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94ZHAuaA0KQEAgLTQyLDcgKzQyLDgg
QEANCiBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtOw0KIGludCBtbHg1ZV94ZHBfbWF4X210dShzdHJ1
Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzayk7DQog
Ym9vbCBtbHg1ZV94ZHBfaGFuZGxlKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHN0cnVjdCBtbHg1ZV9k
bWFfaW5mbyAqZGksDQotCQkgICAgICB2b2lkICp2YSwgdTE2ICpyeF9oZWFkcm9vbSwgdTMyICps
ZW4pOw0KKwkJICAgICAgdm9pZCAqdmEsIHUxNiAqcnhfaGVhZHJvb20sIHUzMiAqbGVuLCBib29s
IHhzayk7DQordm9pZCBtbHg1ZV94ZHBfbXB3cWVfY29tcGxldGUoc3RydWN0IG1seDVlX3hkcHNx
ICpzcSk7DQogYm9vbCBtbHg1ZV9wb2xsX3hkcHNxX2NxKHN0cnVjdCBtbHg1ZV9jcSAqY3EpOw0K
IHZvaWQgbWx4NWVfZnJlZV94ZHBzcV9kZXNjcyhzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxKTsNCiB2
b2lkIG1seDVlX3NldF94bWl0X2ZwKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsIGJvb2wgaXNfbXB3
KTsNCkBAIC02Nyw2ICs2OCwyMSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgbWx4NWVfeGRwX3R4X2lz
X2VuYWJsZWQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCXJldHVybiB0ZXN0X2JpdChNTFg1
RV9TVEFURV9YRFBfVFhfRU5BQkxFRCwgJnByaXYtPnN0YXRlKTsNCiB9DQogDQorc3RhdGljIGlu
bGluZSB2b2lkIG1seDVlX3hkcF9zZXRfb3BlbihzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCit7
DQorCXNldF9iaXQoTUxYNUVfU1RBVEVfWERQX09QRU4sICZwcml2LT5zdGF0ZSk7DQorfQ0KKw0K
K3N0YXRpYyBpbmxpbmUgdm9pZCBtbHg1ZV94ZHBfc2V0X2Nsb3NlZChzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdikNCit7DQorCWNsZWFyX2JpdChNTFg1RV9TVEFURV9YRFBfT1BFTiwgJnByaXYtPnN0
YXRlKTsNCit9DQorDQorc3RhdGljIGlubGluZSBib29sIG1seDVlX3hkcF9pc19vcGVuKHN0cnVj
dCBtbHg1ZV9wcml2ICpwcml2KQ0KK3sNCisJcmV0dXJuIHRlc3RfYml0KE1MWDVFX1NUQVRFX1hE
UF9PUEVOLCAmcHJpdi0+c3RhdGUpOw0KK30NCisNCiBzdGF0aWMgaW5saW5lIHZvaWQgbWx4NWVf
eG1pdF94ZHBfZG9vcmJlbGwoc3RydWN0IG1seDVlX3hkcHNxICpzcSkNCiB7DQogCWlmIChzcS0+
ZG9vcmJlbGxfY3NlZykgew0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9lbi94c2svTWFrZWZpbGUgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW4veHNrL01ha2VmaWxlDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5k
ZXggMDAwMDAwMDAwMDAwLi41ZWU0Mjk5MTkwMGENCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZl
cnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svTWFrZWZpbGUNCkBAIC0w
LDAgKzEgQEANCitzdWJkaXItY2NmbGFncy15ICs9IC1JJChzcmMpLy4uLy4uDQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5jIGIv
ZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5jDQpuZXcg
ZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi42YTU1NTczZWM4ZjINCi0tLSAv
ZGV2L251bGwNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9l
bi94c2svcnguYw0KQEAgLTAsMCArMSwxOTIgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMCBPUiBMaW51eC1PcGVuSUINCisvKiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFu
b3ggVGVjaG5vbG9naWVzLiAqLw0KKw0KKyNpbmNsdWRlICJyeC5oIg0KKyNpbmNsdWRlICJlbi94
ZHAuaCINCisjaW5jbHVkZSA8bmV0L3hkcF9zb2NrLmg+DQorDQorLyogUlggZGF0YSBwYXRoICov
DQorDQorYm9vbCBtbHg1ZV94c2tfcGFnZXNfZW5vdWdoX3VtZW0oc3RydWN0IG1seDVlX3JxICpy
cSwgaW50IGNvdW50KQ0KK3sNCisJLyogQ2hlY2sgaW4gYWR2YW5jZSB0aGF0IHdlIGhhdmUgZW5v
dWdoIGZyYW1lcywgaW5zdGVhZCBvZiBhbGxvY2F0aW5nDQorCSAqIG9uZS1ieS1vbmUsIGZhaWxp
bmcgYW5kIG1vdmluZyBmcmFtZXMgdG8gdGhlIFJldXNlIFJpbmcuDQorCSAqLw0KKwlyZXR1cm4g
eHNrX3VtZW1faGFzX2FkZHJzX3JxKHJxLT51bWVtLCBjb3VudCk7DQorfQ0KKw0KK2ludCBtbHg1
ZV94c2tfcGFnZV9hbGxvY191bWVtKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQorCQkJICAgICAgc3Ry
dWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbykNCit7DQorCXN0cnVjdCB4ZHBfdW1lbSAqdW1l
bSA9IHJxLT51bWVtOw0KKwl1NjQgaGFuZGxlOw0KKw0KKwlpZiAoIXhza191bWVtX3BlZWtfYWRk
cl9ycSh1bWVtLCAmaGFuZGxlKSkNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwlkbWFfaW5mby0+
eHNrLmhhbmRsZSA9IGhhbmRsZSArIHJxLT5idWZmLnVtZW1faGVhZHJvb207DQorCWRtYV9pbmZv
LT54c2suZGF0YSA9IHhkcF91bWVtX2dldF9kYXRhKHVtZW0sIGRtYV9pbmZvLT54c2suaGFuZGxl
KTsNCisNCisJLyogTm8gbmVlZCB0byBhZGQgaGVhZHJvb20gdG8gdGhlIERNQSBhZGRyZXNzLiBJ
biBzdHJpZGluZyBSUSBjYXNlLCB3ZQ0KKwkgKiBqdXN0IHByb3ZpZGUgcGFnZXMgZm9yIFVNUiwg
YW5kIGhlYWRyb29tIGlzIGNvdW50ZWQgYXQgdGhlIHNldHVwDQorCSAqIHN0YWdlIHdoZW4gY3Jl
YXRpbmcgYSBXUUUuIEluIG5vbi1zdHJpZGluZyBSUSBjYXNlLCBoZWFkcm9vbSBpcw0KKwkgKiBh
Y2NvdW50ZWQgaW4gbWx4NWVfYWxsb2Nfcnhfd3FlLg0KKwkgKi8NCisJZG1hX2luZm8tPmFkZHIg
PSB4ZHBfdW1lbV9nZXRfZG1hKHVtZW0sIGhhbmRsZSk7DQorDQorCXhza191bWVtX2Rpc2NhcmRf
YWRkcl9ycSh1bWVtKTsNCisNCisJZG1hX3N5bmNfc2luZ2xlX2Zvcl9kZXZpY2UocnEtPnBkZXYs
IGRtYV9pbmZvLT5hZGRyLCBQQUdFX1NJWkUsDQorCQkJCSAgIERNQV9CSURJUkVDVElPTkFMKTsN
CisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBtbHg1ZV94c2tfcmVj
eWNsZV9mcmFtZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCB1NjQgaGFuZGxlKQ0KK3sNCisJeHNrX3Vt
ZW1fZnFfcmV1c2UocnEtPnVtZW0sIGhhbmRsZSAmIHJxLT51bWVtLT5jaHVua19tYXNrKTsNCit9
DQorDQorLyogWFNLUlEgdXNlcyBwYWdlcyBmcm9tIFVNRU0sIHRoZXkgbXVzdCBub3QgYmUgcmVs
ZWFzZWQuIFRoZXkgYXJlIHJldHVybmVkIHRvDQorICogdGhlIHVzZXJzcGFjZSBpZiBwb3NzaWJs
ZSwgYW5kIGlmIG5vdCwgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgdG8gcmV1c2UgdGhlbQ0KKyAq
IGluIHRoZSBkcml2ZXIuDQorICovDQordm9pZCBtbHg1ZV94c2tfcGFnZV9yZWxlYXNlKHN0cnVj
dCBtbHg1ZV9ycSAqcnEsDQorCQkJICAgIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8p
DQorew0KKwltbHg1ZV94c2tfcmVjeWNsZV9mcmFtZShycSwgZG1hX2luZm8tPnhzay5oYW5kbGUp
Ow0KK30NCisNCisvKiBSZXR1cm4gYSBmcmFtZSBiYWNrIHRvIHRoZSBoYXJkd2FyZSB0byBmaWxs
IGluIGFnYWluLiBJdCBpcyB1c2VkIGJ5IFhEUCB3aGVuDQorICogdGhlIFhEUCBwcm9ncmFtIHJl
dHVybnMgWERQX1RYIG9yIFhEUF9SRURJUkVDVCBub3QgdG8gYW4gWFNLTUFQLg0KKyAqLw0KK3Zv
aWQgbWx4NWVfeHNrX3pjYV9mcmVlKHN0cnVjdCB6ZXJvX2NvcHlfYWxsb2NhdG9yICp6Y2EsIHVu
c2lnbmVkIGxvbmcgaGFuZGxlKQ0KK3sNCisJc3RydWN0IG1seDVlX3JxICpycSA9IGNvbnRhaW5l
cl9vZih6Y2EsIHN0cnVjdCBtbHg1ZV9ycSwgemNhKTsNCisNCisJbWx4NWVfeHNrX3JlY3ljbGVf
ZnJhbWUocnEsIGhhbmRsZSk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqbWx4NWVf
eHNrX2NvbnN0cnVjdF9za2Ioc3RydWN0IG1seDVlX3JxICpycSwgdm9pZCAqZGF0YSwNCisJCQkJ
CSAgICAgICB1MzIgY3FlX2JjbnQpDQorew0KKwlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOw0KKw0KKwlz
a2IgPSBuYXBpX2FsbG9jX3NrYihycS0+Y3EubmFwaSwgY3FlX2JjbnQpOw0KKwlpZiAodW5saWtl
bHkoIXNrYikpIHsNCisJCXJxLT5zdGF0cy0+YnVmZl9hbGxvY19lcnIrKzsNCisJCXJldHVybiBO
VUxMOw0KKwl9DQorDQorCXNrYl9wdXRfZGF0YShza2IsIGRhdGEsIGNxZV9iY250KTsNCisNCisJ
cmV0dXJuIHNrYjsNCit9DQorDQorc3RydWN0IHNrX2J1ZmYgKm1seDVlX3hza19za2JfZnJvbV9j
cWVfbXB3cnFfbGluZWFyKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQorCQkJCQkJICAgIHN0cnVjdCBt
bHg1ZV9tcHdfaW5mbyAqd2ksDQorCQkJCQkJICAgIHUxNiBjcWVfYmNudCwNCisJCQkJCQkgICAg
dTMyIGhlYWRfb2Zmc2V0LA0KKwkJCQkJCSAgICB1MzIgcGFnZV9pZHgpDQorew0KKwlzdHJ1Y3Qg
bWx4NWVfZG1hX2luZm8gKmRpID0gJndpLT51bXIuZG1hX2luZm9bcGFnZV9pZHhdOw0KKwl1MTYg
cnhfaGVhZHJvb20gPSBycS0+YnVmZi5oZWFkcm9vbSAtIHJxLT5idWZmLnVtZW1faGVhZHJvb207
DQorCXUzMiBjcWVfYmNudDMyID0gY3FlX2JjbnQ7DQorCXZvaWQgKnZhLCAqZGF0YTsNCisJdTMy
IGZyYWdfc2l6ZTsNCisJYm9vbCBjb25zdW1lZDsNCisNCisJLyogQ2hlY2sgcGFja2V0IHNpemUu
IE5vdGUgTFJPIGRvZXNuJ3QgdXNlIGxpbmVhciBTS0IgKi8NCisJaWYgKHVubGlrZWx5KGNxZV9i
Y250ID4gcnEtPmh3X210dSkpIHsNCisJCXJxLT5zdGF0cy0+b3ZlcnNpemVfcGt0c19zd19kcm9w
Kys7DQorCQlyZXR1cm4gTlVMTDsNCisJfQ0KKw0KKwkvKiBoZWFkX29mZnNldCBpcyBub3QgdXNl
ZCBpbiB0aGlzIGZ1bmN0aW9uLCBiZWNhdXNlIGRpLT54c2suZGF0YSBhbmQNCisJICogZGktPmFk
ZHIgcG9pbnQgZGlyZWN0bHkgdG8gdGhlIG5lY2Vzc2FyeSBwbGFjZS4gRnVydGhlcm1vcmUsIGlu
IHRoZQ0KKwkgKiBjdXJyZW50IGltcGxlbWVudGF0aW9uLCBvbmUgcGFnZSA9IG9uZSBwYWNrZXQg
PSBvbmUgZnJhbWUsIHNvDQorCSAqIGhlYWRfb2Zmc2V0IHNob3VsZCBhbHdheXMgYmUgMC4NCisJ
ICovDQorCVdBUk5fT05fT05DRShoZWFkX29mZnNldCk7DQorDQorCXZhICAgICAgICAgICAgID0g
ZGktPnhzay5kYXRhOw0KKwlkYXRhICAgICAgICAgICA9IHZhICsgcnhfaGVhZHJvb207DQorCWZy
YWdfc2l6ZSAgICAgID0gcnEtPmJ1ZmYuaGVhZHJvb20gKyBjcWVfYmNudDMyOw0KKw0KKwlkbWFf
c3luY19zaW5nbGVfZm9yX2NwdShycS0+cGRldiwgZGktPmFkZHIsIGZyYWdfc2l6ZSwgRE1BX0JJ
RElSRUNUSU9OQUwpOw0KKwlwcmVmZXRjaChkYXRhKTsNCisNCisJcmN1X3JlYWRfbG9jaygpOw0K
Kwljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2YSwgJnJ4X2hlYWRyb29tLCAm
Y3FlX2JjbnQzMiwgdHJ1ZSk7DQorCXJjdV9yZWFkX3VubG9jaygpOw0KKw0KKwkvKiBQb3NzaWJs
ZSBmbG93czoNCisJICogLSBYRFBfUkVESVJFQ1QgdG8gWFNLTUFQOg0KKwkgKiAgIFRoZSBwYWdl
IGlzIG93bmVkIGJ5IHRoZSB1c2Vyc3BhY2UgZnJvbSBub3cuDQorCSAqIC0gWERQX1RYIGFuZCBv
dGhlciBYRFBfUkVESVJFQ1RzOg0KKwkgKiAgIFRoZSBwYWdlIHdhcyByZXR1cm5lZCBieSBaQ0Eg
YW5kIHJlY3ljbGVkLg0KKwkgKiAtIFhEUF9EUk9QOg0KKwkgKiAgIFJlY3ljbGUgdGhlIHBhZ2Uu
DQorCSAqIC0gWERQX1BBU1M6DQorCSAqICAgQWxsb2NhdGUgYW4gU0tCLCBjb3B5IHRoZSBkYXRh
IGFuZCByZWN5Y2xlIHRoZSBwYWdlLg0KKwkgKg0KKwkgKiBQYWdlcyB0byBiZSByZWN5Y2xlZCBn
byB0byB0aGUgUmV1c2UgUmluZyBvbiBNUFdRRSBkZWFsbG9jYXRpb24uIEl0cw0KKwkgKiBzaXpl
IGlzIHRoZSBzYW1lIGFzIHRoZSBEcml2ZXIgUlggUmluZydzIHNpemUsIGFuZCBwYWdlcyBmb3Ig
V1FFcyBhcmUNCisJICogYWxsb2NhdGVkIGZpcnN0IGZyb20gdGhlIFJldXNlIFJpbmcsIHNvIGl0
IGhhcyBlbm91Z2ggc3BhY2UuDQorCSAqLw0KKw0KKwlpZiAobGlrZWx5KGNvbnN1bWVkKSkgew0K
KwkJaWYgKGxpa2VseShfX3Rlc3RfYW5kX2NsZWFyX2JpdChNTFg1RV9SUV9GTEFHX1hEUF9YTUlU
LCBycS0+ZmxhZ3MpKSkNCisJCQlfX3NldF9iaXQocGFnZV9pZHgsIHdpLT54ZHBfeG1pdF9iaXRt
YXApOyAvKiBub24tYXRvbWljICovDQorCQlyZXR1cm4gTlVMTDsgLyogcGFnZS9wYWNrZXQgd2Fz
IGNvbnN1bWVkIGJ5IFhEUCAqLw0KKwl9DQorDQorCS8qIFhEUF9QQVNTOiBjb3B5IHRoZSBkYXRh
IGZyb20gdGhlIFVNRU0gdG8gYSBuZXcgU0tCIGFuZCByZXVzZSB0aGUNCisJICogZnJhbWUuIE9u
IFNLQiBhbGxvY2F0aW9uIGZhaWx1cmUsIE5VTEwgaXMgcmV0dXJuZWQuDQorCSAqLw0KKwlyZXR1
cm4gbWx4NWVfeHNrX2NvbnN0cnVjdF9za2IocnEsIGRhdGEsIGNxZV9iY250MzIpOw0KK30NCisN
CitzdHJ1Y3Qgc2tfYnVmZiAqbWx4NWVfeHNrX3NrYl9mcm9tX2NxZV9saW5lYXIoc3RydWN0IG1s
eDVlX3JxICpycSwNCisJCQkJCSAgICAgIHN0cnVjdCBtbHg1X2NxZTY0ICpjcWUsDQorCQkJCQkg
ICAgICBzdHJ1Y3QgbWx4NWVfd3FlX2ZyYWdfaW5mbyAqd2ksDQorCQkJCQkgICAgICB1MzIgY3Fl
X2JjbnQpDQorew0KKwlzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRpID0gd2ktPmRpOw0KKwl1MTYg
cnhfaGVhZHJvb20gPSBycS0+YnVmZi5oZWFkcm9vbSAtIHJxLT5idWZmLnVtZW1faGVhZHJvb207
DQorCXZvaWQgKnZhLCAqZGF0YTsNCisJYm9vbCBjb25zdW1lZDsNCisJdTMyIGZyYWdfc2l6ZTsN
CisNCisJLyogd2ktPm9mZnNldCBpcyBub3QgdXNlZCBpbiB0aGlzIGZ1bmN0aW9uLCBiZWNhdXNl
IGRpLT54c2suZGF0YSBhbmQNCisJICogZGktPmFkZHIgcG9pbnQgZGlyZWN0bHkgdG8gdGhlIG5l
Y2Vzc2FyeSBwbGFjZS4gRnVydGhlcm1vcmUsIGluIHRoZQ0KKwkgKiBjdXJyZW50IGltcGxlbWVu
dGF0aW9uLCBvbmUgcGFnZSA9IG9uZSBwYWNrZXQgPSBvbmUgZnJhbWUsIHNvDQorCSAqIHdpLT5v
ZmZzZXQgc2hvdWxkIGFsd2F5cyBiZSAwLg0KKwkgKi8NCisJV0FSTl9PTl9PTkNFKHdpLT5vZmZz
ZXQpOw0KKw0KKwl2YSAgICAgICAgICAgICA9IGRpLT54c2suZGF0YTsNCisJZGF0YSAgICAgICAg
ICAgPSB2YSArIHJ4X2hlYWRyb29tOw0KKwlmcmFnX3NpemUgICAgICA9IHJxLT5idWZmLmhlYWRy
b29tICsgY3FlX2JjbnQ7DQorDQorCWRtYV9zeW5jX3NpbmdsZV9mb3JfY3B1KHJxLT5wZGV2LCBk
aS0+YWRkciwgZnJhZ19zaXplLCBETUFfQklESVJFQ1RJT05BTCk7DQorCXByZWZldGNoKGRhdGEp
Ow0KKw0KKwlpZiAodW5saWtlbHkoZ2V0X2NxZV9vcGNvZGUoY3FlKSAhPSBNTFg1X0NRRV9SRVNQ
X1NFTkQpKSB7DQorCQlycS0+c3RhdHMtPndxZV9lcnIrKzsNCisJCXJldHVybiBOVUxMOw0KKwl9
DQorDQorCXJjdV9yZWFkX2xvY2soKTsNCisJY29uc3VtZWQgPSBtbHg1ZV94ZHBfaGFuZGxlKHJx
LCBkaSwgdmEsICZyeF9oZWFkcm9vbSwgJmNxZV9iY250LCB0cnVlKTsNCisJcmN1X3JlYWRfdW5s
b2NrKCk7DQorDQorCWlmIChsaWtlbHkoY29uc3VtZWQpKQ0KKwkJcmV0dXJuIE5VTEw7IC8qIHBh
Z2UvcGFja2V0IHdhcyBjb25zdW1lZCBieSBYRFAgKi8NCisNCisJLyogWERQX1BBU1M6IGNvcHkg
dGhlIGRhdGEgZnJvbSB0aGUgVU1FTSB0byBhIG5ldyBTS0IuIFRoZSBmcmFtZSByZXVzZQ0KKwkg
KiB3aWxsIGJlIGhhbmRsZWQgYnkgbWx4NWVfcHV0X3J4X2ZyYWcuDQorCSAqIE9uIFNLQiBhbGxv
Y2F0aW9uIGZhaWx1cmUsIE5VTEwgaXMgcmV0dXJuZWQuDQorCSAqLw0KKwlyZXR1cm4gbWx4NWVf
eHNrX2NvbnN0cnVjdF9za2IocnEsIGRhdGEsIGNxZV9iY250KTsNCit9DQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5oIGIvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5oDQpuZXcgZmls
ZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4zMDdiOTIzYTEzNjENCi0tLSAvZGV2
L251bGwNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94
c2svcnguaA0KQEAgLTAsMCArMSwyNyBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wIE9SIExpbnV4LU9wZW5JQiAqLw0KKy8qIENvcHlyaWdodCAoYykgMjAxOSBNZWxsYW5v
eCBUZWNobm9sb2dpZXMuICovDQorDQorI2lmbmRlZiBfX01MWDVfRU5fWFNLX1JYX0hfXw0KKyNk
ZWZpbmUgX19NTFg1X0VOX1hTS19SWF9IX18NCisNCisjaW5jbHVkZSAiZW4uaCINCisNCisvKiBS
WCBkYXRhIHBhdGggKi8NCisNCitib29sIG1seDVlX3hza19wYWdlc19lbm91Z2hfdW1lbShzdHJ1
Y3QgbWx4NWVfcnEgKnJxLCBpbnQgY291bnQpOw0KK2ludCBtbHg1ZV94c2tfcGFnZV9hbGxvY191
bWVtKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQorCQkJICAgICAgc3RydWN0IG1seDVlX2RtYV9pbmZv
ICpkbWFfaW5mbyk7DQordm9pZCBtbHg1ZV94c2tfcGFnZV9yZWxlYXNlKHN0cnVjdCBtbHg1ZV9y
cSAqcnEsDQorCQkJICAgIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8pOw0KK3ZvaWQg
bWx4NWVfeHNrX3pjYV9mcmVlKHN0cnVjdCB6ZXJvX2NvcHlfYWxsb2NhdG9yICp6Y2EsIHVuc2ln
bmVkIGxvbmcgaGFuZGxlKTsNCitzdHJ1Y3Qgc2tfYnVmZiAqbWx4NWVfeHNrX3NrYl9mcm9tX2Nx
ZV9tcHdycV9saW5lYXIoc3RydWN0IG1seDVlX3JxICpycSwNCisJCQkJCQkgICAgc3RydWN0IG1s
eDVlX21wd19pbmZvICp3aSwNCisJCQkJCQkgICAgdTE2IGNxZV9iY250LA0KKwkJCQkJCSAgICB1
MzIgaGVhZF9vZmZzZXQsDQorCQkJCQkJICAgIHUzMiBwYWdlX2lkeCk7DQorc3RydWN0IHNrX2J1
ZmYgKm1seDVlX3hza19za2JfZnJvbV9jcWVfbGluZWFyKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQor
CQkJCQkgICAgICBzdHJ1Y3QgbWx4NV9jcWU2NCAqY3FlLA0KKwkJCQkJICAgICAgc3RydWN0IG1s
eDVlX3dxZV9mcmFnX2luZm8gKndpLA0KKwkJCQkJICAgICAgdTMyIGNxZV9iY250KTsNCisNCisj
ZW5kaWYgLyogX19NTFg1X0VOX1hTS19SWF9IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25l
dC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmMgYi9kcml2ZXJzL25l
dC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmMNCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjliNGQ0N2M0N2M5Mg0KLS0tIC9kZXYvbnVs
bA0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9z
ZXR1cC5jDQpAQCAtMCwwICsxLDIyMyBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wIE9SIExpbnV4LU9wZW5JQg0KKy8qIENvcHlyaWdodCAoYykgMjAxOSBNZWxsYW5veCBU
ZWNobm9sb2dpZXMuICovDQorDQorI2luY2x1ZGUgInNldHVwLmgiDQorI2luY2x1ZGUgImVuL3Bh
cmFtcy5oIg0KKw0KK2Jvb2wgbWx4NWVfdmFsaWRhdGVfeHNrX3BhcmFtKHN0cnVjdCBtbHg1ZV9w
YXJhbXMgKnBhcmFtcywNCisJCQkgICAgICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2ssDQor
CQkJICAgICAgc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYpDQorew0KKwkvKiBBRl9YRFAgZG9l
c24ndCBzdXBwb3J0IGZyYW1lcyBsYXJnZXIgdGhhbiBQQUdFX1NJWkUsIGFuZCB0aGUgY3VycmVu
dA0KKwkgKiBtbHg1ZSBYRFAgaW1wbGVtZW50YXRpb24gZG9lc24ndCBzdXBwb3J0IG11bHRpcGxl
IHBhY2tldHMgcGVyIHBhZ2UuDQorCSAqLw0KKwlpZiAoeHNrLT5jaHVua19zaXplICE9IFBBR0Vf
U0laRSkNCisJCXJldHVybiBmYWxzZTsNCisNCisJLyogQ3VycmVudCBNVFUgYW5kIFhTSyBoZWFk
cm9vbSBkb24ndCBhbGxvdyBwYWNrZXRzIHRvIGZpdCB0aGUgZnJhbWVzLiAqLw0KKwlpZiAobWx4
NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgeHNrKSA+IHhzay0+Y2h1bmtfc2l6ZSkN
CisJCXJldHVybiBmYWxzZTsNCisNCisJLyogZnJhZ19zeiBpcyBkaWZmZXJlbnQgZm9yIHJlZ3Vs
YXIgYW5kIFhTSyBSUXMsIHNvIGVuc3VyZSB0aGF0IGxpbmVhcg0KKwkgKiBTS0IgbW9kZSBpcyBw
b3NzaWJsZS4NCisJICovDQorCXN3aXRjaCAocGFyYW1zLT5ycV93cV90eXBlKSB7DQorCWNhc2Ug
TUxYNV9XUV9UWVBFX0xJTktFRF9MSVNUX1NUUklESU5HX1JROg0KKwkJcmV0dXJuIG1seDVlX3J4
X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zLCB4c2spOw0KKwlkZWZhdWx0OiAvKiBN
TFg1X1dRX1RZUEVfQ1lDTElDICovDQorCQlyZXR1cm4gbWx4NWVfcnhfaXNfbGluZWFyX3NrYihw
YXJhbXMsIHhzayk7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfeHNraWNv
c3FfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJCSAgICAgICB1OCBsb2dfd3Ff
c2l6ZSwNCisJCQkJICAgICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pDQorew0KKwl2
b2lkICpzcWMgPSBwYXJhbS0+c3FjOw0KKwl2b2lkICp3cSA9IE1MWDVfQUREUl9PRihzcWMsIHNx
Yywgd3EpOw0KKw0KKwltbHg1ZV9idWlsZF9zcV9wYXJhbV9jb21tb24ocHJpdiwgcGFyYW0pOw0K
Kw0KKwlNTFg1X1NFVCh3cSwgd3EsIGxvZ193cV9zeiwgbG9nX3dxX3NpemUpOw0KK30NCisNCitz
dGF0aWMgdm9pZCBtbHg1ZV9idWlsZF94c2tfY3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
LA0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCSAgIHN0cnVjdCBt
bHg1ZV94c2tfcGFyYW0gKnhzaywNCisJCQkJICAgc3RydWN0IG1seDVlX2NoYW5uZWxfcGFyYW0g
KmNwYXJhbSkNCit7DQorCWNvbnN0IHU4IHhza2ljb3NxX3NpemUgPSBNTFg1RV9QQVJBTVNfTUlO
SU1VTV9MT0dfU1FfU0laRTsNCisNCisJbWx4NWVfYnVpbGRfcnFfcGFyYW0ocHJpdiwgcGFyYW1z
LCB4c2ssICZjcGFyYW0tPnJxKTsNCisJbWx4NWVfYnVpbGRfeGRwc3FfcGFyYW0ocHJpdiwgcGFy
YW1zLCAmY3BhcmFtLT54ZHBfc3EpOw0KKwltbHg1ZV9idWlsZF94c2tpY29zcV9wYXJhbShwcml2
LCB4c2tpY29zcV9zaXplLCAmY3BhcmFtLT5pY29zcSk7DQorCW1seDVlX2J1aWxkX3J4X2NxX3Bh
cmFtKHByaXYsIHBhcmFtcywgeHNrLCAmY3BhcmFtLT5yeF9jcSk7DQorCW1seDVlX2J1aWxkX3R4
X2NxX3BhcmFtKHByaXYsIHBhcmFtcywgJmNwYXJhbS0+dHhfY3EpOw0KKwltbHg1ZV9idWlsZF9p
Y29fY3FfcGFyYW0ocHJpdiwgeHNraWNvc3Ffc2l6ZSwgJmNwYXJhbS0+aWNvc3FfY3EpOw0KK30N
CisNCitpbnQgbWx4NWVfb3Blbl94c2soc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBt
bHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCSAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywg
c3RydWN0IHhkcF91bWVtICp1bWVtLA0KKwkJICAgc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpDQor
ew0KKwlzdHJ1Y3QgbWx4NWVfY2hhbm5lbF9wYXJhbSBjcGFyYW0gPSB7fTsNCisJc3RydWN0IG5l
dF9kaW1fY3FfbW9kZXIgaWNvY3FfbW9kZXIgPSB7fTsNCisJaW50IGVycjsNCisNCisJaWYgKCFt
bHg1ZV92YWxpZGF0ZV94c2tfcGFyYW0ocGFyYW1zLCB4c2ssIHByaXYtPm1kZXYpKQ0KKwkJcmV0
dXJuIC1FSU5WQUw7DQorDQorCW1seDVlX2J1aWxkX3hza19jcGFyYW0ocHJpdiwgcGFyYW1zLCB4
c2ssICZjcGFyYW0pOw0KKw0KKwllcnIgPSBtbHg1ZV9vcGVuX2NxKGMsIHBhcmFtcy0+cnhfY3Ff
bW9kZXJhdGlvbiwgJmNwYXJhbS5yeF9jcSwgJmMtPnhza3JxLmNxKTsNCisJaWYgKHVubGlrZWx5
KGVycikpDQorCQlyZXR1cm4gZXJyOw0KKw0KKwllcnIgPSBtbHg1ZV9vcGVuX3JxKGMsIHBhcmFt
cywgJmNwYXJhbS5ycSwgeHNrLCB1bWVtLCAmYy0+eHNrcnEpOw0KKwlpZiAodW5saWtlbHkoZXJy
KSkNCisJCWdvdG8gZXJyX2Nsb3NlX3J4X2NxOw0KKw0KKwllcnIgPSBtbHg1ZV9vcGVuX2NxKGMs
IHBhcmFtcy0+dHhfY3FfbW9kZXJhdGlvbiwgJmNwYXJhbS50eF9jcSwgJmMtPnhza3NxLmNxKTsN
CisJaWYgKHVubGlrZWx5KGVycikpDQorCQlnb3RvIGVycl9jbG9zZV9ycTsNCisNCisJLyogQ3Jl
YXRlIGEgc2VwYXJhdGUgU1EsIHNvIHRoYXQgd2hlbiB0aGUgVU1FTSBpcyBkaXNhYmxlZCwgd2Ug
Y291bGQNCisJICogY2xvc2UgdGhpcyBTUSBzYWZlbHkgYW5kIHN0b3AgcmVjZWl2aW5nIENRRXMu
IEluIG90aGVyIGNhc2UsIGUuZy4sIGlmDQorCSAqIHRoZSBYRFBTUSB3YXMgdXNlZCBpbnN0ZWFk
LCB3ZSBtaWdodCBydW4gaW50byB0cm91YmxlIHdoZW4gdGhlIFVNRU0NCisJICogaXMgZGlzYWJs
ZWQgYW5kIHRoZW4gcmVlbmFibGVkLCBidXQgdGhlIFNRIGNvbnRpbnVlcyByZWNlaXZpbmcgQ1FF
cw0KKwkgKiBmcm9tIHRoZSBvbGQgVU1FTS4NCisJICovDQorCWVyciA9IG1seDVlX29wZW5feGRw
c3EoYywgcGFyYW1zLCAmY3BhcmFtLnhkcF9zcSwgdW1lbSwgJmMtPnhza3NxLCB0cnVlKTsNCisJ
aWYgKHVubGlrZWx5KGVycikpDQorCQlnb3RvIGVycl9jbG9zZV90eF9jcTsNCisNCisJZXJyID0g
bWx4NWVfb3Blbl9jcShjLCBpY29jcV9tb2RlciwgJmNwYXJhbS5pY29zcV9jcSwgJmMtPnhza2lj
b3NxLmNxKTsNCisJaWYgKHVubGlrZWx5KGVycikpDQorCQlnb3RvIGVycl9jbG9zZV9zcTsNCisN
CisJLyogQ3JlYXRlIGEgZGVkaWNhdGVkIFNRIGZvciBwb3N0aW5nIE5PUHMgd2hlbmV2ZXIgd2Ug
bmVlZCBhbiBJUlEgdG8gYmUNCisJICogdHJpZ2dlcmVkIGFuZCBOQVBJIHRvIGJlIGNhbGxlZCBv
biB0aGUgY29ycmVjdCBDUFUuDQorCSAqLw0KKwllcnIgPSBtbHg1ZV9vcGVuX2ljb3NxKGMsIHBh
cmFtcywgJmNwYXJhbS5pY29zcSwgJmMtPnhza2ljb3NxKTsNCisJaWYgKHVubGlrZWx5KGVycikp
DQorCQlnb3RvIGVycl9jbG9zZV9pY29jcTsNCisNCisJc3Bpbl9sb2NrX2luaXQoJmMtPnhza2lj
b3NxX2xvY2spOw0KKw0KKwlzZXRfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5zdGF0
ZSk7DQorDQorCXJldHVybiAwOw0KKw0KK2Vycl9jbG9zZV9pY29jcToNCisJbWx4NWVfY2xvc2Vf
Y3EoJmMtPnhza2ljb3NxLmNxKTsNCisNCitlcnJfY2xvc2Vfc3E6DQorCW1seDVlX2Nsb3NlX3hk
cHNxKCZjLT54c2tzcSk7DQorDQorZXJyX2Nsb3NlX3R4X2NxOg0KKwltbHg1ZV9jbG9zZV9jcSgm
Yy0+eHNrc3EuY3EpOw0KKw0KK2Vycl9jbG9zZV9ycToNCisJbWx4NWVfY2xvc2VfcnEoJmMtPnhz
a3JxKTsNCisNCitlcnJfY2xvc2VfcnhfY3E6DQorCW1seDVlX2Nsb3NlX2NxKCZjLT54c2tycS5j
cSk7DQorDQorCXJldHVybiBlcnI7DQorfQ0KKw0KK3ZvaWQgbWx4NWVfY2xvc2VfeHNrKHN0cnVj
dCBtbHg1ZV9jaGFubmVsICpjKQ0KK3sNCisJY2xlYXJfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVf
WFNLLCBjLT5zdGF0ZSk7DQorCW5hcGlfc3luY2hyb25pemUoJmMtPm5hcGkpOw0KKw0KKwltbHg1
ZV9jbG9zZV9ycSgmYy0+eHNrcnEpOw0KKwltbHg1ZV9jbG9zZV9jcSgmYy0+eHNrcnEuY3EpOw0K
KwltbHg1ZV9jbG9zZV9pY29zcSgmYy0+eHNraWNvc3EpOw0KKwltbHg1ZV9jbG9zZV9jcSgmYy0+
eHNraWNvc3EuY3EpOw0KKwltbHg1ZV9jbG9zZV94ZHBzcSgmYy0+eHNrc3EpOw0KKwltbHg1ZV9j
bG9zZV9jcSgmYy0+eHNrc3EuY3EpOw0KK30NCisNCit2b2lkIG1seDVlX2FjdGl2YXRlX3hzayhz
dHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYykNCit7DQorCXNldF9iaXQoTUxYNUVfUlFfU1RBVEVfRU5B
QkxFRCwgJmMtPnhza3JxLnN0YXRlKTsNCisJLyogVFggcXVldWUgaXMgY3JlYXRlZCBhY3RpdmUu
ICovDQorCW1seDVlX3RyaWdnZXJfaXJxKCZjLT54c2tpY29zcSk7DQorfQ0KKw0KK3ZvaWQgbWx4
NWVfZGVhY3RpdmF0ZV94c2soc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpDQorew0KKwltbHg1ZV9k
ZWFjdGl2YXRlX3JxKCZjLT54c2tycSk7DQorCS8qIFRYIHF1ZXVlIGlzIGRpc2FibGVkIG9uIGNs
b3NlLiAqLw0KK30NCisNCitzdGF0aWMgaW50IG1seDVlX3JlZGlyZWN0X3hza19ycXQoc3RydWN0
IG1seDVlX3ByaXYgKnByaXYsIHUxNiBpeCwgdTMyIHJxbikNCit7DQorCXN0cnVjdCBtbHg1ZV9y
ZWRpcmVjdF9ycXRfcGFyYW0gZGlyZWN0X3JycCA9IHsNCisJCS5pc19yc3MgPSBmYWxzZSwNCisJ
CXsNCisJCQkucnFuID0gcnFuLA0KKwkJfSwNCisJfTsNCisNCisJdTMyIHJxdG4gPSBwcml2LT54
c2tfdGlyW2l4XS5ycXQucnF0bjsNCisNCisJcmV0dXJuIG1seDVlX3JlZGlyZWN0X3JxdChwcml2
LCBycXRuLCAxLCBkaXJlY3RfcnJwKTsNCit9DQorDQoraW50IG1seDVlX3hza19yZWRpcmVjdF9y
cXRfdG9fY2hhbm5lbChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX2NoYW5u
ZWwgKmMpDQorew0KKwlyZXR1cm4gbWx4NWVfcmVkaXJlY3RfeHNrX3JxdChwcml2LCBjLT5peCwg
Yy0+eHNrcnEucnFuKTsNCit9DQorDQoraW50IG1seDVlX3hza19yZWRpcmVjdF9ycXRfdG9fZHJv
cChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgdTE2IGl4KQ0KK3sNCisJcmV0dXJuIG1seDVlX3Jl
ZGlyZWN0X3hza19ycXQocHJpdiwgaXgsIHByaXYtPmRyb3BfcnEucnFuKTsNCit9DQorDQoraW50
IG1seDVlX3hza19yZWRpcmVjdF9ycXRzX3RvX2NoYW5uZWxzKHN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2LCBzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgKmNocykNCit7DQorCWludCBlcnIsIGk7DQorDQor
CWlmICghcHJpdi0+eHNrLnJlZmNudCkNCisJCXJldHVybiAwOw0KKw0KKwlmb3IgKGkgPSAwOyBp
IDwgY2hzLT5udW07IGkrKykgew0KKwkJc3RydWN0IG1seDVlX2NoYW5uZWwgKmMgPSBjaHMtPmNb
aV07DQorDQorCQlpZiAoIXRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5zdGF0
ZSkpDQorCQkJY29udGludWU7DQorDQorCQllcnIgPSBtbHg1ZV94c2tfcmVkaXJlY3RfcnF0X3Rv
X2NoYW5uZWwocHJpdiwgYyk7DQorCQlpZiAodW5saWtlbHkoZXJyKSkNCisJCQlnb3RvIGVycl9z
dG9wOw0KKwl9DQorDQorCXJldHVybiAwOw0KKw0KK2Vycl9zdG9wOg0KKwlmb3IgKGktLTsgaSA+
PSAwOyBpLS0pIHsNCisJCWlmICghdGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGNo
cy0+Y1tpXS0+c3RhdGUpKQ0KKwkJCWNvbnRpbnVlOw0KKw0KKwkJbWx4NWVfeHNrX3JlZGlyZWN0
X3JxdF90b19kcm9wKHByaXYsIGkpOw0KKwl9DQorDQorCXJldHVybiBlcnI7DQorfQ0KKw0KK3Zv
aWQgbWx4NWVfeHNrX3JlZGlyZWN0X3JxdHNfdG9fZHJvcChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJp
diwgc3RydWN0IG1seDVlX2NoYW5uZWxzICpjaHMpDQorew0KKwlpbnQgaTsNCisNCisJaWYgKCFw
cml2LT54c2sucmVmY250KQ0KKwkJcmV0dXJuOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgY2hzLT5u
dW07IGkrKykgew0KKwkJaWYgKCF0ZXN0X2JpdChNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywgY2hz
LT5jW2ldLT5zdGF0ZSkpDQorCQkJY29udGludWU7DQorDQorCQltbHg1ZV94c2tfcmVkaXJlY3Rf
cnF0X3RvX2Ryb3AocHJpdiwgaSk7DQorCX0NCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9zZXR1cC5oIGIvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9zZXR1cC5oDQpuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4wZGQxMWI4MWMwNDYNCi0tLSAvZGV2L251bGwN
CisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svc2V0
dXAuaA0KQEAgLTAsMCArMSwyNSBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wIE9SIExpbnV4LU9wZW5JQiAqLw0KKy8qIENvcHlyaWdodCAoYykgMjAxOSBNZWxsYW5veCBU
ZWNobm9sb2dpZXMuICovDQorDQorI2lmbmRlZiBfX01MWDVfRU5fWFNLX1NFVFVQX0hfXw0KKyNk
ZWZpbmUgX19NTFg1X0VOX1hTS19TRVRVUF9IX18NCisNCisjaW5jbHVkZSAiZW4uaCINCisNCitz
dHJ1Y3QgbWx4NWVfeHNrX3BhcmFtOw0KKw0KK2Jvb2wgbWx4NWVfdmFsaWRhdGVfeHNrX3BhcmFt
KHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgICAgICBzdHJ1Y3QgbWx4NWVfeHNr
X3BhcmFtICp4c2ssDQorCQkJICAgICAgc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYpOw0KK2lu
dCBtbHg1ZV9vcGVuX3hzayhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zLA0KKwkJICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrLCBzdHJ1Y3Qg
eGRwX3VtZW0gKnVtZW0sDQorCQkgICBzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYyk7DQordm9pZCBt
bHg1ZV9jbG9zZV94c2soc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpOw0KK3ZvaWQgbWx4NWVfYWN0
aXZhdGVfeHNrKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKTsNCit2b2lkIG1seDVlX2RlYWN0aXZh
dGVfeHNrKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKTsNCitpbnQgbWx4NWVfeHNrX3JlZGlyZWN0
X3JxdF90b19jaGFubmVsKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfY2hh
bm5lbCAqYyk7DQoraW50IG1seDVlX3hza19yZWRpcmVjdF9ycXRfdG9fZHJvcChzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwgdTE2IGl4KTsNCitpbnQgbWx4NWVfeHNrX3JlZGlyZWN0X3JxdHNfdG9f
Y2hhbm5lbHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV9jaGFubmVscyAq
Y2hzKTsNCit2b2lkIG1seDVlX3hza19yZWRpcmVjdF9ycXRzX3RvX2Ryb3Aoc3RydWN0IG1seDVl
X3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV9jaGFubmVscyAqY2hzKTsNCisNCisjZW5kaWYgLyog
X19NTFg1X0VOX1hTS19TRVRVUF9IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhl
cm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4LmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQpp
bmRleCAwMDAwMDAwMDAwMDAuLjM1ZTE4OGNmNGVhNA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay90eC5jDQpAQCAtMCww
ICsxLDExMSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIE9SIExpbnV4
LU9wZW5JQg0KKy8qIENvcHlyaWdodCAoYykgMjAxOSBNZWxsYW5veCBUZWNobm9sb2dpZXMuICov
DQorDQorI2luY2x1ZGUgInR4LmgiDQorI2luY2x1ZGUgInVtZW0uaCINCisjaW5jbHVkZSAiZW4v
eGRwLmgiDQorI2luY2x1ZGUgImVuL3BhcmFtcy5oIg0KKyNpbmNsdWRlIDxuZXQveGRwX3NvY2su
aD4NCisNCitpbnQgbWx4NWVfeHNrX2FzeW5jX3htaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwg
dTMyIHFpZCkNCit7DQorCXN0cnVjdCBtbHg1ZV9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYoZGV2
KTsNCisJc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zID0gJnByaXYtPmNoYW5uZWxzLnBhcmFt
czsNCisJc3RydWN0IG1seDVlX2NoYW5uZWwgKmM7DQorCXUxNiBpeDsNCisNCisJaWYgKHVubGlr
ZWx5KCFtbHg1ZV94ZHBfaXNfb3Blbihwcml2KSkpDQorCQlyZXR1cm4gLUVORVRET1dOOw0KKw0K
KwlpZiAodW5saWtlbHkoIW1seDVlX3FpZF9nZXRfY2hfaWZfaW5fZ3JvdXAocGFyYW1zLCBxaWQs
IE1MWDVFX1JRX0dST1VQX1hTSywgJml4KSkpDQorCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJYyA9
IHByaXYtPmNoYW5uZWxzLmNbaXhdOw0KKw0KKwlpZiAodW5saWtlbHkoIXRlc3RfYml0KE1MWDVF
X0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5zdGF0ZSkpKQ0KKwkJcmV0dXJuIC1FTlhJTzsNCisNCisJ
aWYgKCFuYXBpX2lmX3NjaGVkdWxlZF9tYXJrX21pc3NlZCgmYy0+bmFwaSkpIHsNCisJCXNwaW5f
bG9jaygmYy0+eHNraWNvc3FfbG9jayk7DQorCQltbHg1ZV90cmlnZ2VyX2lycSgmYy0+eHNraWNv
c3EpOw0KKwkJc3Bpbl91bmxvY2soJmMtPnhza2ljb3NxX2xvY2spOw0KKwl9DQorDQorCXJldHVy
biAwOw0KK30NCisNCisvKiBXaGVuIFRYIGZhaWxzIChiZWNhdXNlIG9mIHRoZSBzaXplIG9mIHRo
ZSBwYWNrZXQpLCB3ZSBuZWVkIHRvIGdldCBjb21wbGV0aW9ucw0KKyAqIGluIG9yZGVyLCBzbyBw
b3N0IGEgTk9QIHRvIGdldCBhIENRRS4gU2luY2UgQUZfWERQIGRvZXNuJ3QgZGlzdGluZ3Vpc2gN
CisgKiBiZXR3ZWVuIHN1Y2Nlc3NmdWwgVFggYW5kIGVycm9ycywgaGFuZGxpbmcgaW4gbWx4NWVf
cG9sbF94ZHBzcV9jcSBpcyB0aGUNCisgKiBzYW1lLg0KKyAqLw0KK3N0YXRpYyB2b2lkIG1seDVl
X3hza190eF9wb3N0X2VycihzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KKwkJCQkgIHN0cnVjdCBt
bHg1ZV94ZHBfaW5mbyAqeGRwaSkNCit7DQorCXUxNiBwaSA9IG1seDVfd3FfY3ljX2N0cjJpeCgm
c3EtPndxLCBzcS0+cGMpOw0KKwlzdHJ1Y3QgbWx4NWVfeGRwX3dxZV9pbmZvICp3aSA9ICZzcS0+
ZGIud3FlX2luZm9bcGldOw0KKwlzdHJ1Y3QgbWx4NWVfdHhfd3FlICpub3B3cWU7DQorDQorCXdp
LT5udW1fd3FlYmJzID0gMTsNCisJd2ktPm51bV9wa3RzID0gMTsNCisNCisJbm9wd3FlID0gbWx4
NWVfcG9zdF9ub3AoJnNxLT53cSwgc3EtPnNxbiwgJnNxLT5wYyk7DQorCW1seDVlX3hkcGlfZmlm
b19wdXNoKCZzcS0+ZGIueGRwaV9maWZvLCB4ZHBpKTsNCisJc3EtPmRvb3JiZWxsX2NzZWcgPSAm
bm9wd3FlLT5jdHJsOw0KK30NCisNCitib29sIG1seDVlX3hza190eChzdHJ1Y3QgbWx4NWVfeGRw
c3EgKnNxLCB1bnNpZ25lZCBpbnQgYnVkZ2V0KQ0KK3sNCisJc3RydWN0IHhkcF91bWVtICp1bWVt
ID0gc3EtPnVtZW07DQorCXN0cnVjdCBtbHg1ZV94ZHBfaW5mbyB4ZHBpOw0KKwlzdHJ1Y3QgbWx4
NWVfeGRwX3htaXRfZGF0YSB4ZHB0eGQ7DQorCWJvb2wgd29ya19kb25lID0gdHJ1ZTsNCisJYm9v
bCBmbHVzaCA9IGZhbHNlOw0KKw0KKwl4ZHBpLm1vZGUgPSBNTFg1RV9YRFBfWE1JVF9NT0RFX1hT
SzsNCisNCisJZm9yICg7IGJ1ZGdldDsgYnVkZ2V0LS0pIHsNCisJCWludCBjaGVja19yZXN1bHQg
PSBzcS0+eG1pdF94ZHBfZnJhbWVfY2hlY2soc3EpOw0KKwkJc3RydWN0IHhkcF9kZXNjIGRlc2M7
DQorDQorCQlpZiAodW5saWtlbHkoY2hlY2tfcmVzdWx0IDwgMCkpIHsNCisJCQl3b3JrX2RvbmUg
PSBmYWxzZTsNCisJCQlicmVhazsNCisJCX0NCisNCisJCWlmICgheHNrX3VtZW1fY29uc3VtZV90
eCh1bWVtLCAmZGVzYykpIHsNCisJCQkvKiBUWCB3aWxsIGdldCBzdHVjayB1bnRpbCBzb21ldGhp
bmcgd2FrZXMgaXQgdXAgYnkNCisJCQkgKiB0cmlnZ2VyaW5nIE5BUEkuIEN1cnJlbnRseSBpdCdz
IGV4cGVjdGVkIHRoYXQgdGhlDQorCQkJICogYXBwbGljYXRpb24gY2FsbHMgc2VuZHRvKCkgaWYg
dGhlcmUgYXJlIGNvbnN1bWVkLCBidXQNCisJCQkgKiBub3QgY29tcGxldGVkIGZyYW1lcy4NCisJ
CQkgKi8NCisJCQlicmVhazsNCisJCX0NCisNCisJCXhkcHR4ZC5kbWFfYWRkciA9IHhkcF91bWVt
X2dldF9kbWEodW1lbSwgZGVzYy5hZGRyKTsNCisJCXhkcHR4ZC5kYXRhID0geGRwX3VtZW1fZ2V0
X2RhdGEodW1lbSwgZGVzYy5hZGRyKTsNCisJCXhkcHR4ZC5sZW4gPSBkZXNjLmxlbjsNCisNCisJ
CWRtYV9zeW5jX3NpbmdsZV9mb3JfZGV2aWNlKHNxLT5wZGV2LCB4ZHB0eGQuZG1hX2FkZHIsDQor
CQkJCQkgICB4ZHB0eGQubGVuLCBETUFfQklESVJFQ1RJT05BTCk7DQorDQorCQlpZiAodW5saWtl
bHkoIXNxLT54bWl0X3hkcF9mcmFtZShzcSwgJnhkcHR4ZCwgJnhkcGksIGNoZWNrX3Jlc3VsdCkp
KSB7DQorCQkJaWYgKHNxLT5tcHdxZS53cWUpDQorCQkJCW1seDVlX3hkcF9tcHdxZV9jb21wbGV0
ZShzcSk7DQorDQorCQkJbWx4NWVfeHNrX3R4X3Bvc3RfZXJyKHNxLCAmeGRwaSk7DQorCQl9DQor
DQorCQlmbHVzaCA9IHRydWU7DQorCX0NCisNCisJaWYgKGZsdXNoKSB7DQorCQlpZiAoc3EtPm1w
d3FlLndxZSkNCisJCQltbHg1ZV94ZHBfbXB3cWVfY29tcGxldGUoc3EpOw0KKwkJbWx4NWVfeG1p
dF94ZHBfZG9vcmJlbGwoc3EpOw0KKw0KKwkJeHNrX3VtZW1fY29uc3VtZV90eF9kb25lKHVtZW0p
Ow0KKwl9DQorDQorCXJldHVybiAhKGJ1ZGdldCAmJiB3b3JrX2RvbmUpOw0KK30NCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4Lmgg
Yi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4LmgNCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjdhZGQxOGJmNzhkOA0KLS0t
IC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuL3hzay90eC5oDQpAQCAtMCwwICsxLDE1IEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgT1IgTGludXgtT3BlbklCICovDQorLyogQ29weXJpZ2h0IChjKSAyMDE5IE1l
bGxhbm94IFRlY2hub2xvZ2llcy4gKi8NCisNCisjaWZuZGVmIF9fTUxYNV9FTl9YU0tfVFhfSF9f
DQorI2RlZmluZSBfX01MWDVfRU5fWFNLX1RYX0hfXw0KKw0KKyNpbmNsdWRlICJlbi5oIg0KKw0K
Ky8qIFRYIGRhdGEgcGF0aCAqLw0KKw0KK2ludCBtbHg1ZV94c2tfYXN5bmNfeG1pdChzdHJ1Y3Qg
bmV0X2RldmljZSAqZGV2LCB1MzIgcWlkKTsNCisNCitib29sIG1seDVlX3hza190eChzdHJ1Y3Qg
bWx4NWVfeGRwc3EgKnNxLCB1bnNpZ25lZCBpbnQgYnVkZ2V0KTsNCisNCisjZW5kaWYgLyogX19N
TFg1X0VOX1hTS19UWF9IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9t
ZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3VtZW0uYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbi94c2svdW1lbS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5k
ZXggMDAwMDAwMDAwMDAwLi40YmFhYTU3ODgzMjANCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZl
cnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdW1lbS5jDQpAQCAtMCww
ICsxLDI2NyBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIE9SIExpbnV4
LU9wZW5JQg0KKy8qIENvcHlyaWdodCAoYykgMjAxOSBNZWxsYW5veCBUZWNobm9sb2dpZXMuICov
DQorDQorI2luY2x1ZGUgPG5ldC94ZHBfc29jay5oPg0KKyNpbmNsdWRlICJ1bWVtLmgiDQorI2lu
Y2x1ZGUgInNldHVwLmgiDQorI2luY2x1ZGUgImVuL3BhcmFtcy5oIg0KKw0KK3N0YXRpYyBpbnQg
bWx4NWVfeHNrX21hcF91bWVtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgIHN0
cnVjdCB4ZHBfdW1lbSAqdW1lbSkNCit7DQorCXN0cnVjdCBkZXZpY2UgKmRldiA9IHByaXYtPm1k
ZXYtPmRldmljZTsNCisJdTMyIGk7DQorDQorCWZvciAoaSA9IDA7IGkgPCB1bWVtLT5ucGdzOyBp
KyspIHsNCisJCWRtYV9hZGRyX3QgZG1hID0gZG1hX21hcF9wYWdlKGRldiwgdW1lbS0+cGdzW2ld
LCAwLCBQQUdFX1NJWkUsDQorCQkJCQkgICAgICBETUFfQklESVJFQ1RJT05BTCk7DQorDQorCQlp
ZiAodW5saWtlbHkoZG1hX21hcHBpbmdfZXJyb3IoZGV2LCBkbWEpKSkNCisJCQlnb3RvIGVycl91
bm1hcDsNCisJCXVtZW0tPnBhZ2VzW2ldLmRtYSA9IGRtYTsNCisJfQ0KKw0KKwlyZXR1cm4gMDsN
CisNCitlcnJfdW5tYXA6DQorCXdoaWxlIChpLS0pIHsNCisJCWRtYV91bm1hcF9wYWdlKGRldiwg
dW1lbS0+cGFnZXNbaV0uZG1hLCBQQUdFX1NJWkUsDQorCQkJICAgICAgIERNQV9CSURJUkVDVElP
TkFMKTsNCisJCXVtZW0tPnBhZ2VzW2ldLmRtYSA9IDA7DQorCX0NCisNCisJcmV0dXJuIC1FTk9N
RU07DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1seDVlX3hza191bm1hcF91bWVtKHN0cnVjdCBtbHg1
ZV9wcml2ICpwcml2LA0KKwkJCQkgc3RydWN0IHhkcF91bWVtICp1bWVtKQ0KK3sNCisJc3RydWN0
IGRldmljZSAqZGV2ID0gcHJpdi0+bWRldi0+ZGV2aWNlOw0KKwl1MzIgaTsNCisNCisJZm9yIChp
ID0gMDsgaSA8IHVtZW0tPm5wZ3M7IGkrKykgew0KKwkJZG1hX3VubWFwX3BhZ2UoZGV2LCB1bWVt
LT5wYWdlc1tpXS5kbWEsIFBBR0VfU0laRSwNCisJCQkgICAgICAgRE1BX0JJRElSRUNUSU9OQUwp
Ow0KKwkJdW1lbS0+cGFnZXNbaV0uZG1hID0gMDsNCisJfQ0KK30NCisNCitzdGF0aWMgaW50IG1s
eDVlX3hza19nZXRfdW1lbXMoc3RydWN0IG1seDVlX3hzayAqeHNrKQ0KK3sNCisJaWYgKCF4c2st
PnVtZW1zKSB7DQorCQl4c2stPnVtZW1zID0ga2NhbGxvYyhNTFg1RV9NQVhfTlVNX0NIQU5ORUxT
LA0KKwkJCQkgICAgIHNpemVvZigqeHNrLT51bWVtcyksIEdGUF9LRVJORUwpOw0KKwkJaWYgKHVu
bGlrZWx5KCF4c2stPnVtZW1zKSkNCisJCQlyZXR1cm4gLUVOT01FTTsNCisJfQ0KKw0KKwl4c2st
PnJlZmNudCsrOw0KKwl4c2stPmV2ZXJfdXNlZCA9IHRydWU7DQorDQorCXJldHVybiAwOw0KK30N
CisNCitzdGF0aWMgdm9pZCBtbHg1ZV94c2tfcHV0X3VtZW1zKHN0cnVjdCBtbHg1ZV94c2sgKnhz
aykNCit7DQorCWlmICghLS14c2stPnJlZmNudCkgew0KKwkJa2ZyZWUoeHNrLT51bWVtcyk7DQor
CQl4c2stPnVtZW1zID0gTlVMTDsNCisJfQ0KK30NCisNCitzdGF0aWMgaW50IG1seDVlX3hza19h
ZGRfdW1lbShzdHJ1Y3QgbWx4NWVfeHNrICp4c2ssIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwgdTE2
IGl4KQ0KK3sNCisJaW50IGVycjsNCisNCisJZXJyID0gbWx4NWVfeHNrX2dldF91bWVtcyh4c2sp
Ow0KKwlpZiAodW5saWtlbHkoZXJyKSkNCisJCXJldHVybiBlcnI7DQorDQorCXhzay0+dW1lbXNb
aXhdID0gdW1lbTsNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1seDVlX3hza19y
ZW1vdmVfdW1lbShzdHJ1Y3QgbWx4NWVfeHNrICp4c2ssIHUxNiBpeCkNCit7DQorCXhzay0+dW1l
bXNbaXhdID0gTlVMTDsNCisNCisJbWx4NWVfeHNrX3B1dF91bWVtcyh4c2spOw0KK30NCisNCitz
dGF0aWMgYm9vbCBtbHg1ZV94c2tfaXNfdW1lbV9zYW5lKHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSkN
Cit7DQorCXJldHVybiB1bWVtLT5oZWFkcm9vbSA8PSAweGZmZmYgJiYgdW1lbS0+Y2h1bmtfc2l6
ZV9ub2hyIDw9IDB4ZmZmZjsNCit9DQorDQordm9pZCBtbHg1ZV9idWlsZF94c2tfcGFyYW0oc3Ry
dWN0IHhkcF91bWVtICp1bWVtLCBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2spDQorew0KKwl4
c2stPmhlYWRyb29tID0gdW1lbS0+aGVhZHJvb207DQorCXhzay0+Y2h1bmtfc2l6ZSA9IHVtZW0t
PmNodW5rX3NpemVfbm9ociArIHVtZW0tPmhlYWRyb29tOw0KK30NCisNCitzdGF0aWMgaW50IG1s
eDVlX3hza19lbmFibGVfbG9ja2VkKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCQkgICBz
dHJ1Y3QgeGRwX3VtZW0gKnVtZW0sIHUxNiBpeCkNCit7DQorCXN0cnVjdCBtbHg1ZV9wYXJhbXMg
KnBhcmFtcyA9ICZwcml2LT5jaGFubmVscy5wYXJhbXM7DQorCXN0cnVjdCBtbHg1ZV94c2tfcGFy
YW0geHNrOw0KKwlzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYzsNCisJaW50IGVycjsNCisNCisJaWYg
KHVubGlrZWx5KG1seDVlX3hza19nZXRfdW1lbSgmcHJpdi0+Y2hhbm5lbHMucGFyYW1zLCAmcHJp
di0+eHNrLCBpeCkpKQ0KKwkJcmV0dXJuIC1FQlVTWTsNCisNCisJaWYgKHVubGlrZWx5KCFtbHg1
ZV94c2tfaXNfdW1lbV9zYW5lKHVtZW0pKSkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwllcnIg
PSBtbHg1ZV94c2tfbWFwX3VtZW0ocHJpdiwgdW1lbSk7DQorCWlmICh1bmxpa2VseShlcnIpKQ0K
KwkJcmV0dXJuIGVycjsNCisNCisJZXJyID0gbWx4NWVfeHNrX2FkZF91bWVtKCZwcml2LT54c2ss
IHVtZW0sIGl4KTsNCisJaWYgKHVubGlrZWx5KGVycikpDQorCQlnb3RvIGVycl91bm1hcF91bWVt
Ow0KKw0KKwltbHg1ZV9idWlsZF94c2tfcGFyYW0odW1lbSwgJnhzayk7DQorDQorCWlmICghdGVz
dF9iaXQoTUxYNUVfU1RBVEVfT1BFTkVELCAmcHJpdi0+c3RhdGUpKSB7DQorCQkvKiBYU0sgb2Jq
ZWN0cyB3aWxsIGJlIGNyZWF0ZWQgb24gb3Blbi4gKi8NCisJCWdvdG8gdmFsaWRhdGVfY2xvc2Vk
Ow0KKwl9DQorDQorCWlmICghcGFyYW1zLT54ZHBfcHJvZykgew0KKwkJLyogWFNLIG9iamVjdHMg
d2lsbCBiZSBjcmVhdGVkIHdoZW4gYW4gWERQIHByb2dyYW0gaXMgc2V0LA0KKwkJICogYW5kIHRo
ZSBjaGFubmVscyBhcmUgcmVvcGVuZWQuDQorCQkgKi8NCisJCWdvdG8gdmFsaWRhdGVfY2xvc2Vk
Ow0KKwl9DQorDQorCWMgPSBwcml2LT5jaGFubmVscy5jW2l4XTsNCisNCisJZXJyID0gbWx4NWVf
b3Blbl94c2socHJpdiwgcGFyYW1zLCAmeHNrLCB1bWVtLCBjKTsNCisJaWYgKHVubGlrZWx5KGVy
cikpDQorCQlnb3RvIGVycl9yZW1vdmVfdW1lbTsNCisNCisJbWx4NWVfYWN0aXZhdGVfeHNrKGMp
Ow0KKw0KKwkvKiBEb24ndCB3YWl0IGZvciBXUUVzLCBiZWNhdXNlIHRoZSBuZXdlciB4ZHBzb2Nr
IHNhbXBsZSBkb2Vzbid0IHByb3ZpZGUNCisJICogYW55IEZpbGwgUmluZyBlbnRyaWVzIGF0IHRo
ZSBzZXR1cCBzdGFnZS4NCisJICovDQorDQorCWVyciA9IG1seDVlX3hza19yZWRpcmVjdF9ycXRf
dG9fY2hhbm5lbChwcml2LCBwcml2LT5jaGFubmVscy5jW2l4XSk7DQorCWlmICh1bmxpa2VseShl
cnIpKQ0KKwkJZ290byBlcnJfZGVhY3RpdmF0ZTsNCisNCisJcmV0dXJuIDA7DQorDQorZXJyX2Rl
YWN0aXZhdGU6DQorCW1seDVlX2RlYWN0aXZhdGVfeHNrKGMpOw0KKwltbHg1ZV9jbG9zZV94c2so
Yyk7DQorDQorZXJyX3JlbW92ZV91bWVtOg0KKwltbHg1ZV94c2tfcmVtb3ZlX3VtZW0oJnByaXYt
PnhzaywgaXgpOw0KKw0KK2Vycl91bm1hcF91bWVtOg0KKwltbHg1ZV94c2tfdW5tYXBfdW1lbShw
cml2LCB1bWVtKTsNCisNCisJcmV0dXJuIGVycjsNCisNCit2YWxpZGF0ZV9jbG9zZWQ6DQorCS8q
IENoZWNrIHRoZSBjb25maWd1cmF0aW9uIGluIGFkdmFuY2UsIHJhdGhlciB0aGFuIGZhaWwgYXQg
YSBsYXRlciBzdGFnZQ0KKwkgKiAoaW4gbWx4NWVfeGRwX3NldCBvciBvbiBvcGVuKSBhbmQgZW5k
IHVwIHdpdGggbm8gY2hhbm5lbHMuDQorCSAqLw0KKwlpZiAoIW1seDVlX3ZhbGlkYXRlX3hza19w
YXJhbShwYXJhbXMsICZ4c2ssIHByaXYtPm1kZXYpKSB7DQorCQllcnIgPSAtRUlOVkFMOw0KKwkJ
Z290byBlcnJfcmVtb3ZlX3VtZW07DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRp
YyBpbnQgbWx4NWVfeHNrX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB1
MTYgaXgpDQorew0KKwlzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0gPSBtbHg1ZV94c2tfZ2V0X3VtZW0o
JnByaXYtPmNoYW5uZWxzLnBhcmFtcywNCisJCQkJCQkgICAmcHJpdi0+eHNrLCBpeCk7DQorCXN0
cnVjdCBtbHg1ZV9jaGFubmVsICpjOw0KKw0KKwlpZiAodW5saWtlbHkoIXVtZW0pKQ0KKwkJcmV0
dXJuIC1FSU5WQUw7DQorDQorCWlmICghdGVzdF9iaXQoTUxYNUVfU1RBVEVfT1BFTkVELCAmcHJp
di0+c3RhdGUpKQ0KKwkJZ290byByZW1vdmVfdW1lbTsNCisNCisJLyogWFNLIFJRIGFuZCBTUSBh
cmUgb25seSBjcmVhdGVkIGlmIFhEUCBwcm9ncmFtIGlzIHNldC4gKi8NCisJaWYgKCFwcml2LT5j
aGFubmVscy5wYXJhbXMueGRwX3Byb2cpDQorCQlnb3RvIHJlbW92ZV91bWVtOw0KKw0KKwljID0g
cHJpdi0+Y2hhbm5lbHMuY1tpeF07DQorCW1seDVlX3hza19yZWRpcmVjdF9ycXRfdG9fZHJvcChw
cml2LCBpeCk7DQorCW1seDVlX2RlYWN0aXZhdGVfeHNrKGMpOw0KKwltbHg1ZV9jbG9zZV94c2so
Yyk7DQorDQorcmVtb3ZlX3VtZW06DQorCW1seDVlX3hza19yZW1vdmVfdW1lbSgmcHJpdi0+eHNr
LCBpeCk7DQorCW1seDVlX3hza191bm1hcF91bWVtKHByaXYsIHVtZW0pOw0KKw0KKwlyZXR1cm4g
MDsNCit9DQorDQorc3RhdGljIGludCBtbHg1ZV94c2tfZW5hYmxlX3VtZW0oc3RydWN0IG1seDVl
X3ByaXYgKnByaXYsIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwNCisJCQkJIHUxNiBpeCkNCit7DQor
CWludCBlcnI7DQorDQorCW11dGV4X2xvY2soJnByaXYtPnN0YXRlX2xvY2spOw0KKwllcnIgPSBt
bHg1ZV94c2tfZW5hYmxlX2xvY2tlZChwcml2LCB1bWVtLCBpeCk7DQorCW11dGV4X3VubG9jaygm
cHJpdi0+c3RhdGVfbG9jayk7DQorDQorCXJldHVybiBlcnI7DQorfQ0KKw0KK3N0YXRpYyBpbnQg
bWx4NWVfeHNrX2Rpc2FibGVfdW1lbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgdTE2IGl4KQ0K
K3sNCisJaW50IGVycjsNCisNCisJbXV0ZXhfbG9jaygmcHJpdi0+c3RhdGVfbG9jayk7DQorCWVy
ciA9IG1seDVlX3hza19kaXNhYmxlX2xvY2tlZChwcml2LCBpeCk7DQorCW11dGV4X3VubG9jaygm
cHJpdi0+c3RhdGVfbG9jayk7DQorDQorCXJldHVybiBlcnI7DQorfQ0KKw0KK2ludCBtbHg1ZV94
c2tfc2V0dXBfdW1lbShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgeGRwX3VtZW0gKnVt
ZW0sIHUxNiBxaWQpDQorew0KKwlzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiA9IG5ldGRldl9wcml2
KGRldik7DQorCXN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyA9ICZwcml2LT5jaGFubmVscy5w
YXJhbXM7DQorCXUxNiBpeDsNCisNCisJaWYgKHVubGlrZWx5KCFtbHg1ZV9xaWRfZ2V0X2NoX2lm
X2luX2dyb3VwKHBhcmFtcywgcWlkLCBNTFg1RV9SUV9HUk9VUF9YU0ssICZpeCkpKQ0KKwkJcmV0
dXJuIC1FSU5WQUw7DQorDQorCXJldHVybiB1bWVtID8gbWx4NWVfeHNrX2VuYWJsZV91bWVtKHBy
aXYsIHVtZW0sIGl4KSA6DQorCQkgICAgICBtbHg1ZV94c2tfZGlzYWJsZV91bWVtKHByaXYsIGl4
KTsNCit9DQorDQoraW50IG1seDVlX3hza19yZXNpemVfcmV1c2VxKHN0cnVjdCB4ZHBfdW1lbSAq
dW1lbSwgdTMyIG5lbnRyaWVzKQ0KK3sNCisJc3RydWN0IHhkcF91bWVtX2ZxX3JldXNlICpyZXVz
ZXE7DQorDQorCXJldXNlcSA9IHhza19yZXVzZXFfcHJlcGFyZShuZW50cmllcyk7DQorCWlmICh1
bmxpa2VseSghcmV1c2VxKSkNCisJCXJldHVybiAtRU5PTUVNOw0KKwl4c2tfcmV1c2VxX2ZyZWUo
eHNrX3JldXNlcV9zd2FwKHVtZW0sIHJldXNlcSkpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQor
dTE2IG1seDVlX3hza19maXJzdF91bnVzZWRfY2hhbm5lbChzdHJ1Y3QgbWx4NWVfcGFyYW1zICpw
YXJhbXMsIHN0cnVjdCBtbHg1ZV94c2sgKnhzaykNCit7DQorCXUxNiByZXMgPSB4c2stPnJlZmNu
dCA/IHBhcmFtcy0+bnVtX2NoYW5uZWxzIDogMDsNCisNCisJd2hpbGUgKHJlcykgew0KKwkJaWYg
KG1seDVlX3hza19nZXRfdW1lbShwYXJhbXMsIHhzaywgcmVzIC0gMSkpDQorCQkJYnJlYWs7DQor
CQktLXJlczsNCisJfQ0KKw0KKwlyZXR1cm4gcmVzOw0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3VtZW0uaCBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdW1lbS5oDQpuZXcgZmlsZSBt
b2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4yNWI0Y2JlNThiNTQNCi0tLSAvZGV2L251
bGwNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2sv
dW1lbS5oDQpAQCAtMCwwICsxLDMxIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAgT1IgTGludXgtT3BlbklCICovDQorLyogQ29weXJpZ2h0IChjKSAyMDE5IE1lbGxhbm94
IFRlY2hub2xvZ2llcy4gKi8NCisNCisjaWZuZGVmIF9fTUxYNV9FTl9YU0tfVU1FTV9IX18NCisj
ZGVmaW5lIF9fTUxYNV9FTl9YU0tfVU1FTV9IX18NCisNCisjaW5jbHVkZSAiZW4uaCINCisNCitz
dGF0aWMgaW5saW5lIHN0cnVjdCB4ZHBfdW1lbSAqbWx4NWVfeHNrX2dldF91bWVtKHN0cnVjdCBt
bHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJCQkgIHN0cnVjdCBtbHg1ZV94c2sgKnhzaywgdTE2
IGl4KQ0KK3sNCisJaWYgKCF4c2sgfHwgIXhzay0+dW1lbXMpDQorCQlyZXR1cm4gTlVMTDsNCisN
CisJaWYgKHVubGlrZWx5KGl4ID49IHBhcmFtcy0+bnVtX2NoYW5uZWxzKSkNCisJCXJldHVybiBO
VUxMOw0KKw0KKwlyZXR1cm4geHNrLT51bWVtc1tpeF07DQorfQ0KKw0KK3N0cnVjdCBtbHg1ZV94
c2tfcGFyYW07DQordm9pZCBtbHg1ZV9idWlsZF94c2tfcGFyYW0oc3RydWN0IHhkcF91bWVtICp1
bWVtLCBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2spOw0KKw0KKy8qIC5uZG9fYnBmIGNhbGxi
YWNrLiAqLw0KK2ludCBtbHg1ZV94c2tfc2V0dXBfdW1lbShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LCBzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sIHUxNiBxaWQpOw0KKw0KK2ludCBtbHg1ZV94c2tfcmVz
aXplX3JldXNlcShzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sIHUzMiBuZW50cmllcyk7DQorDQordTE2
IG1seDVlX3hza19maXJzdF91bnVzZWRfY2hhbm5lbChzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJh
bXMsIHN0cnVjdCBtbHg1ZV94c2sgKnhzayk7DQorDQorI2VuZGlmIC8qIF9fTUxYNV9FTl9YU0tf
VU1FTV9IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9t
bHg1L2NvcmUvZW5fZXRodG9vbC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4
NS9jb3JlL2VuX2V0aHRvb2wuYw0KaW5kZXggZGQ3NjRlMDQ3MWYyLi5hNDYxOTM5YzRlMzUgMTAw
NjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fZXRo
dG9vbC5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5f
ZXRodG9vbC5jDQpAQCAtMzIsNiArMzIsNyBAQA0KIA0KICNpbmNsdWRlICJlbi5oIg0KICNpbmNs
dWRlICJlbi9wb3J0LmgiDQorI2luY2x1ZGUgImVuL3hzay91bWVtLmgiDQogI2luY2x1ZGUgImxp
Yi9jbG9jay5oIg0KIA0KIHZvaWQgbWx4NWVfZXRodG9vbF9nZXRfZHJ2aW5mbyhzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwNCkBAIC0zOTAsNiArMzkxLDEyIEBAIHZvaWQgbWx4NWVfZXRodG9vbF9n
ZXRfY2hhbm5lbHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQogew0KIAljaC0+bWF4X2NvbWJp
bmVkICAgPSBtbHg1ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhwcml2LT5uZXRkZXYpOw0KIAlj
aC0+Y29tYmluZWRfY291bnQgPSBwcml2LT5jaGFubmVscy5wYXJhbXMubnVtX2NoYW5uZWxzOw0K
Kw0KKwkvKiBYU0sgUlFzICovDQorCWNoLT5tYXhfcnggICAgICAgICA9IGNoLT5tYXhfY29tYmlu
ZWQ7DQorCS8qIHJ4X2NvdW50IHNob3dzIHRoZSBudW1iZXIgb2YgWFNLIFJRcyB1cCB0byB0aGUg
aGlnaGVzdCBhY3RpdmUgb25lLiAqLw0KKwljaC0+cnhfY291bnQgICAgICAgPSBtbHg1ZV94c2tf
Zmlyc3RfdW51c2VkX2NoYW5uZWwoJnByaXYtPmNoYW5uZWxzLnBhcmFtcywNCisJCQkJCQkJICAg
ICZwcml2LT54c2spOw0KIH0NCiANCiBzdGF0aWMgdm9pZCBtbHg1ZV9nZXRfY2hhbm5lbHMoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwNCkBAIC00MDMsNiArNDEwLDggQEAgc3RhdGljIHZvaWQgbWx4
NWVfZ2V0X2NoYW5uZWxzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsDQogaW50IG1seDVlX2V0aHRv
b2xfc2V0X2NoYW5uZWxzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAkJCSAgICAgICBzdHJ1
Y3QgZXRodG9vbF9jaGFubmVscyAqY2gpDQogew0KKwlzdHJ1Y3QgbWx4NWVfcGFyYW1zICpjdXJf
cGFyYW1zID0gJnByaXYtPmNoYW5uZWxzLnBhcmFtczsNCisJdTE2IG9sZF9yeF9jb3VudCA9IG1s
eDVlX3hza19maXJzdF91bnVzZWRfY2hhbm5lbChjdXJfcGFyYW1zLCAmcHJpdi0+eHNrKTsNCiAJ
dW5zaWduZWQgaW50IGNvdW50ID0gY2gtPmNvbWJpbmVkX2NvdW50Ow0KIAlzdHJ1Y3QgbWx4NWVf
Y2hhbm5lbHMgbmV3X2NoYW5uZWxzID0ge307DQogCWJvb2wgYXJmc19lbmFibGVkOw0KQEAgLTQx
NCwxNiArNDIzLDMyIEBAIGludCBtbHg1ZV9ldGh0b29sX3NldF9jaGFubmVscyhzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwNCiAJCXJldHVybiAtRUlOVkFMOw0KIAl9DQogDQotCWlmIChwcml2LT5j
aGFubmVscy5wYXJhbXMubnVtX2NoYW5uZWxzID09IGNvdW50KQ0KKwlpZiAoY2gtPnJ4X2NvdW50
ICE9IG9sZF9yeF9jb3VudCkgew0KKwkJbmV0ZGV2X2luZm8ocHJpdi0+bmV0ZGV2LCAiJXM6IHJ4
X2NvdW50IChYU0sgUlFzKSBpcyBjb250cm9sbGVkIGJ5IEFGX1hEUCBhcHBsaWNhdGlvbnMgYW5k
IGNhbid0IGJlIGNoYW5nZWQgZXh0ZXJuYWxseVxuIiwNCisJCQkgICAgX19mdW5jX18pOw0KKwkJ
cmV0dXJuIC1FSU5WQUw7DQorCX0NCisNCisJaWYgKGN1cl9wYXJhbXMtPm51bV9jaGFubmVscyA9
PSBjb3VudCkNCiAJCXJldHVybiAwOw0KIA0KIAltdXRleF9sb2NrKCZwcml2LT5zdGF0ZV9sb2Nr
KTsNCiANCisJLyogRG9uJ3QgYWxsb3cgY2hhbmdpbmcgdGhlIG51bWJlciBvZiBjaGFubmVscyBp
ZiB0aGVyZSBpcyBhbiBhY3RpdmUNCisJICogWFNLLCBiZWNhdXNlIHRoZSBudW1lcmF0aW9uIG9m
IHRoZSBYU0sgYW5kIHJlZ3VsYXIgUlFzIHdpbGwgY2hhbmdlLg0KKwkgKi8NCisJaWYgKHByaXYt
Pnhzay5yZWZjbnQpIHsNCisJCWVyciA9IC1FSU5WQUw7DQorCQluZXRkZXZfZXJyKHByaXYtPm5l
dGRldiwgIiVzOiBBRl9YRFAgaXMgYWN0aXZlLCBjYW5ub3QgY2hhbmdlIHRoZSBudW1iZXIgb2Yg
Y2hhbm5lbHNcbiIsDQorCQkJICAgX19mdW5jX18pOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCiAJ
bmV3X2NoYW5uZWxzLnBhcmFtcyA9IHByaXYtPmNoYW5uZWxzLnBhcmFtczsNCiAJbmV3X2NoYW5u
ZWxzLnBhcmFtcy5udW1fY2hhbm5lbHMgPSBjb3VudDsNCiANCiAJaWYgKCF0ZXN0X2JpdChNTFg1
RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSkpIHsNCi0JCXByaXYtPmNoYW5uZWxzLnBhcmFt
cyA9IG5ld19jaGFubmVscy5wYXJhbXM7DQorCQkqY3VyX3BhcmFtcyA9IG5ld19jaGFubmVscy5w
YXJhbXM7DQogCQlpZiAoIW5ldGlmX2lzX3J4ZmhfY29uZmlndXJlZChwcml2LT5uZXRkZXYpKQ0K
IAkJCW1seDVlX2J1aWxkX2RlZmF1bHRfaW5kaXJfcnF0KHByaXYtPnJzc19wYXJhbXMuaW5kaXJl
Y3Rpb25fcnF0LA0KIAkJCQkJCSAgICAgIE1MWDVFX0lORElSX1JRVF9TSVpFLCBjb3VudCk7DQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX2Zz
X2V0aHRvb2wuYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9m
c19ldGh0b29sLmMNCmluZGV4IDQ0MjFjMTBmNThhZS4uZWM1MzkyYmFhYmM4IDEwMDY0NA0KLS0t
IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX2ZzX2V0aHRvb2wu
Yw0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX2ZzX2V0
aHRvb2wuYw0KQEAgLTMyLDYgKzMyLDggQEANCiANCiAjaW5jbHVkZSA8bGludXgvbWx4NS9mcy5o
Pg0KICNpbmNsdWRlICJlbi5oIg0KKyNpbmNsdWRlICJlbi9wYXJhbXMuaCINCisjaW5jbHVkZSAi
ZW4veHNrL3VtZW0uaCINCiANCiBzdHJ1Y3QgbWx4NWVfZXRodG9vbF9ydWxlIHsNCiAJc3RydWN0
IGxpc3RfaGVhZCAgICAgICAgICAgICBsaXN0Ow0KQEAgLTQxNCw2ICs0MTYsMTQgQEAgYWRkX2V0
aHRvb2xfZmxvd19ydWxlKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAlpZiAoZnMtPnJpbmdf
Y29va2llID09IFJYX0NMU19GTE9XX0RJU0MpIHsNCiAJCWZsb3dfYWN0LmFjdGlvbiA9IE1MWDVf
RkxPV19DT05URVhUX0FDVElPTl9EUk9QOw0KIAl9IGVsc2Ugew0KKwkJc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zID0gJnByaXYtPmNoYW5uZWxzLnBhcmFtczsNCisJCWVudW0gbWx4NWVfcnFf
Z3JvdXAgZ3JvdXA7DQorCQlzdHJ1Y3QgbWx4NWVfdGlyICp0aXI7DQorCQl1MTYgaXg7DQorDQor
CQltbHg1ZV9xaWRfZ2V0X2NoX2FuZF9ncm91cChwYXJhbXMsIGZzLT5yaW5nX2Nvb2tpZSwgJml4
LCAmZ3JvdXApOw0KKwkJdGlyID0gZ3JvdXAgPT0gTUxYNUVfUlFfR1JPVVBfWFNLID8gcHJpdi0+
eHNrX3RpciA6IHByaXYtPmRpcmVjdF90aXI7DQorDQogCQlkc3QgPSBremFsbG9jKHNpemVvZigq
ZHN0KSwgR0ZQX0tFUk5FTCk7DQogCQlpZiAoIWRzdCkgew0KIAkJCWVyciA9IC1FTk9NRU07DQpA
QCAtNDIxLDcgKzQzMSw3IEBAIGFkZF9ldGh0b29sX2Zsb3dfcnVsZShzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdiwNCiAJCX0NCiANCiAJCWRzdC0+dHlwZSA9IE1MWDVfRkxPV19ERVNUSU5BVElPTl9U
WVBFX1RJUjsNCi0JCWRzdC0+dGlyX251bSA9IHByaXYtPmRpcmVjdF90aXJbZnMtPnJpbmdfY29v
a2llXS50aXJuOw0KKwkJZHN0LT50aXJfbnVtID0gdGlyW2l4XS50aXJuOw0KIAkJZmxvd19hY3Qu
YWN0aW9uID0gTUxYNV9GTE9XX0NPTlRFWFRfQUNUSU9OX0ZXRF9ERVNUOw0KIAl9DQogDQpAQCAt
NjAwLDkgKzYxMCw5IEBAIHN0YXRpYyBpbnQgdmFsaWRhdGVfZmxvdyhzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdiwNCiAJaWYgKGZzLT5sb2NhdGlvbiA+PSBNQVhfTlVNX09GX0VUSFRPT0xfUlVMRVMp
DQogCQlyZXR1cm4gLUVOT1NQQzsNCiANCi0JaWYgKGZzLT5yaW5nX2Nvb2tpZSA+PSBwcml2LT5j
aGFubmVscy5wYXJhbXMubnVtX2NoYW5uZWxzICYmDQotCSAgICBmcy0+cmluZ19jb29raWUgIT0g
UlhfQ0xTX0ZMT1dfRElTQykNCi0JCXJldHVybiAtRUlOVkFMOw0KKwlpZiAoZnMtPnJpbmdfY29v
a2llICE9IFJYX0NMU19GTE9XX0RJU0MpDQorCQlpZiAoIW1seDVlX3FpZF92YWxpZGF0ZSgmcHJp
di0+Y2hhbm5lbHMucGFyYW1zLCBmcy0+cmluZ19jb29raWUpKQ0KKwkJCXJldHVybiAtRUlOVkFM
Ow0KIA0KIAlzd2l0Y2ggKGZzLT5mbG93X3R5cGUgJiB+KEZMT1dfRVhUIHwgRkxPV19NQUNfRVhU
KSkgew0KIAljYXNlIEVUSEVSX0ZMT1c6DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX21haW4uYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbl9tYWluLmMNCmluZGV4IGJiMzllYzE0ODJjOS4uODBkOWNkOTc4
YTI5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuX21haW4uYw0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3Jl
L2VuX21haW4uYw0KQEAgLTM4LDYgKzM4LDcgQEANCiAjaW5jbHVkZSA8bGludXgvYnBmLmg+DQog
I2luY2x1ZGUgPGxpbnV4L2lmX2JyaWRnZS5oPg0KICNpbmNsdWRlIDxuZXQvcGFnZV9wb29sLmg+
DQorI2luY2x1ZGUgPG5ldC94ZHBfc29jay5oPg0KICNpbmNsdWRlICJlc3dpdGNoLmgiDQogI2lu
Y2x1ZGUgImVuLmgiDQogI2luY2x1ZGUgImVuX3RjLmgiDQpAQCAtNTYsNiArNTcsMTAgQEANCiAj
aW5jbHVkZSAiZW4vbW9uaXRvcl9zdGF0cy5oIg0KICNpbmNsdWRlICJlbi9yZXBvcnRlci5oIg0K
ICNpbmNsdWRlICJlbi9wYXJhbXMuaCINCisjaW5jbHVkZSAiZW4veHNrL3VtZW0uaCINCisjaW5j
bHVkZSAiZW4veHNrL3NldHVwLmgiDQorI2luY2x1ZGUgImVuL3hzay9yeC5oIg0KKyNpbmNsdWRl
ICJlbi94c2svdHguaCINCiANCiBib29sIG1seDVlX2NoZWNrX2ZyYWdtZW50ZWRfc3RyaWRpbmdf
cnFfY2FwKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2KQ0KIHsNCkBAIC04NSwxOCArOTAsMzEg
QEAgdm9pZCBtbHg1ZV9pbml0X3JxX3R5cGVfcGFyYW1zKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICpt
ZGV2LA0KIAltbHg1X2NvcmVfaW5mbyhtZGV2LCAiTUxYNUU6IFN0cmRScSglZCkgUnFTeiglbGQp
IFN0cmRTeiglbGQpIFJ4Q3FlQ21wcnNzKCVkKVxuIiwNCiAJCSAgICAgICBwYXJhbXMtPnJxX3dx
X3R5cGUgPT0gTUxYNV9XUV9UWVBFX0xJTktFRF9MSVNUX1NUUklESU5HX1JRLA0KIAkJICAgICAg
IHBhcmFtcy0+cnFfd3FfdHlwZSA9PSBNTFg1X1dRX1RZUEVfTElOS0VEX0xJU1RfU1RSSURJTkdf
UlEgPw0KLQkJICAgICAgIEJJVChtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zKSkg
Og0KKwkJICAgICAgIEJJVChtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zLCBOVUxM
KSkgOg0KIAkJICAgICAgIEJJVChwYXJhbXMtPmxvZ19ycV9tdHVfZnJhbWVzKSwNCi0JCSAgICAg
ICBCSVQobWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJpZGVfc2l6ZShtZGV2LCBwYXJhbXMpKSwNCisJ
CSAgICAgICBCSVQobWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJpZGVfc2l6ZShtZGV2LCBwYXJhbXMs
IE5VTEwpKSwNCiAJCSAgICAgICBNTFg1RV9HRVRfUEZMQUcocGFyYW1zLCBNTFg1RV9QRkxBR19S
WF9DUUVfQ09NUFJFU1MpKTsNCiB9DQogDQogYm9vbCBtbHg1ZV9zdHJpZGluZ19ycV9wb3NzaWJs
ZShzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCiAJCQkJc3RydWN0IG1seDVlX3BhcmFtcyAq
cGFyYW1zKQ0KIHsNCi0JcmV0dXJuIG1seDVlX2NoZWNrX2ZyYWdtZW50ZWRfc3RyaWRpbmdfcnFf
Y2FwKG1kZXYpICYmDQotCQkhTUxYNV9JUFNFQ19ERVYobWRldikgJiYNCi0JCSEocGFyYW1zLT54
ZHBfcHJvZyAmJiAhbWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBwYXJhbXMpKTsN
CisJaWYgKCFtbHg1ZV9jaGVja19mcmFnbWVudGVkX3N0cmlkaW5nX3JxX2NhcChtZGV2KSkNCisJ
CXJldHVybiBmYWxzZTsNCisNCisJaWYgKE1MWDVfSVBTRUNfREVWKG1kZXYpKQ0KKwkJcmV0dXJu
IGZhbHNlOw0KKw0KKwlpZiAocGFyYW1zLT54ZHBfcHJvZykgew0KKwkJLyogWFNLIHBhcmFtcyBh
cmUgbm90IGNvbnNpZGVyZWQgaGVyZS4gSWYgc3RyaWRpbmcgUlEgaXMgaW4gdXNlLA0KKwkJICog
YW5kIGFuIFhTSyBpcyBiZWluZyBvcGVuZWQsIG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2Ig
d2lsbA0KKwkJICogYmUgY2FsbGVkIHdpdGggdGhlIGtub3duIFhTSyBwYXJhbXMuDQorCQkgKi8N
CisJCWlmICghbWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBwYXJhbXMsIE5VTEwp
KQ0KKwkJCXJldHVybiBmYWxzZTsNCisJfQ0KKw0KKwlyZXR1cm4gdHJ1ZTsNCiB9DQogDQogdm9p
ZCBtbHg1ZV9zZXRfcnFfdHlwZShzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwgc3RydWN0IG1s
eDVlX3BhcmFtcyAqcGFyYW1zKQ0KQEAgLTM2NSw2ICszODMsOCBAQCBzdGF0aWMgdm9pZCBtbHg1
ZV9mcmVlX2RpX2xpc3Qoc3RydWN0IG1seDVlX3JxICpycSkNCiANCiBzdGF0aWMgaW50IG1seDVl
X2FsbG9jX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KIAkJCSAgc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zLA0KKwkJCSAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrLA0KKwkJCSAg
c3RydWN0IHhkcF91bWVtICp1bWVtLA0KIAkJCSAgc3RydWN0IG1seDVlX3JxX3BhcmFtICpycXAs
DQogCQkJICBzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIHsNCkBAIC0zNzIsNiArMzkyLDggQEAgc3Rh
dGljIGludCBtbHg1ZV9hbGxvY19ycShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywNCiAJc3RydWN0
IG1seDVfY29yZV9kZXYgKm1kZXYgPSBjLT5tZGV2Ow0KIAl2b2lkICpycWMgPSBycXAtPnJxYzsN
CiAJdm9pZCAqcnFjX3dxID0gTUxYNV9BRERSX09GKHJxYywgcnFjLCB3cSk7DQorCXUzMiBudW1f
eHNrX2ZyYW1lcyA9IDA7DQorCXUzMiBycV94ZHBfaXg7DQogCXUzMiBwb29sX3NpemU7DQogCWlu
dCB3cV9zejsNCiAJaW50IGVycjsNCkBAIC0zODgsOCArNDEwLDEzIEBAIHN0YXRpYyBpbnQgbWx4
NWVfYWxsb2NfcnEoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCXJxLT5peCAgICAgID0gYy0+
aXg7DQogCXJxLT5tZGV2ICAgID0gbWRldjsNCiAJcnEtPmh3X210dSAgPSBNTFg1RV9TVzJIV19N
VFUocGFyYW1zLCBwYXJhbXMtPnN3X210dSk7DQotCXJxLT5zdGF0cyAgID0gJmMtPnByaXYtPmNo
YW5uZWxfc3RhdHNbYy0+aXhdLnJxOw0KIAlycS0+eGRwc3EgICA9ICZjLT5ycV94ZHBzcTsNCisJ
cnEtPnVtZW0gICAgPSB1bWVtOw0KKw0KKwlpZiAocnEtPnVtZW0pDQorCQlycS0+c3RhdHMgPSAm
Yy0+cHJpdi0+Y2hhbm5lbF9zdGF0c1tjLT5peF0ueHNrcnE7DQorCWVsc2UNCisJCXJxLT5zdGF0
cyA9ICZjLT5wcml2LT5jaGFubmVsX3N0YXRzW2MtPml4XS5ycTsNCiANCiAJcnEtPnhkcF9wcm9n
ID0gcGFyYW1zLT54ZHBfcHJvZyA/IGJwZl9wcm9nX2luYyhwYXJhbXMtPnhkcF9wcm9nKSA6IE5V
TEw7DQogCWlmIChJU19FUlIocnEtPnhkcF9wcm9nKSkgew0KQEAgLTM5OCwxMiArNDI1LDE2IEBA
IHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfcnEoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCQln
b3RvIGVycl9ycV93cV9kZXN0cm95Ow0KIAl9DQogDQotCWVyciA9IHhkcF9yeHFfaW5mb19yZWco
JnJxLT54ZHBfcnhxLCBycS0+bmV0ZGV2LCBycS0+aXgpOw0KKwlycV94ZHBfaXggPSBycS0+aXg7
DQorCWlmICh4c2spDQorCQlycV94ZHBfaXggKz0gcGFyYW1zLT5udW1fY2hhbm5lbHMgKiBNTFg1
RV9SUV9HUk9VUF9YU0s7DQorCWVyciA9IHhkcF9yeHFfaW5mb19yZWcoJnJxLT54ZHBfcnhxLCBy
cS0+bmV0ZGV2LCBycV94ZHBfaXgpOw0KIAlpZiAoZXJyIDwgMCkNCiAJCWdvdG8gZXJyX3JxX3dx
X2Rlc3Ryb3k7DQogDQogCXJxLT5idWZmLm1hcF9kaXIgPSBycS0+eGRwX3Byb2cgPyBETUFfQklE
SVJFQ1RJT05BTCA6IERNQV9GUk9NX0RFVklDRTsNCi0JcnEtPmJ1ZmYuaGVhZHJvb20gPSBtbHg1
ZV9nZXRfcnFfaGVhZHJvb20obWRldiwgcGFyYW1zKTsNCisJcnEtPmJ1ZmYuaGVhZHJvb20gPSBt
bHg1ZV9nZXRfcnFfaGVhZHJvb20obWRldiwgcGFyYW1zLCB4c2spOw0KKwlycS0+YnVmZi51bWVt
X2hlYWRyb29tID0geHNrID8geHNrLT5oZWFkcm9vbSA6IDA7DQogCXBvb2xfc2l6ZSA9IDEgPDwg
cGFyYW1zLT5sb2dfcnFfbXR1X2ZyYW1lczsNCiANCiAJc3dpdGNoIChycS0+d3FfdHlwZSkgew0K
QEAgLTQxNyw3ICs0NDgsMTIgQEAgc3RhdGljIGludCBtbHg1ZV9hbGxvY19ycShzdHJ1Y3QgbWx4
NWVfY2hhbm5lbCAqYywNCiANCiAJCXdxX3N6ID0gbWx4NV93cV9sbF9nZXRfc2l6ZSgmcnEtPm1w
d3FlLndxKTsNCiANCi0JCXBvb2xfc2l6ZSA9IE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSA8PCBt
bHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zKTsNCisJCWlmICh4c2spDQorCQkJbnVt
X3hza19mcmFtZXMgPSB3cV9zeiA8PA0KKwkJCQltbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9zdHJp
ZGVzKG1kZXYsIHBhcmFtcywgeHNrKTsNCisNCisJCXBvb2xfc2l6ZSA9IE1MWDVfTVBXUlFfUEFH
RVNfUEVSX1dRRSA8PA0KKwkJCW1seDVlX21wd3FlX2dldF9sb2dfcnFfc2l6ZShwYXJhbXMsIHhz
ayk7DQogDQogCQlycS0+cG9zdF93cWVzID0gbWx4NWVfcG9zdF9yeF9tcHdxZXM7DQogCQlycS0+
ZGVhbGxvY193cWUgPSBtbHg1ZV9kZWFsbG9jX3J4X21wd3FlOw0KQEAgLTQzNiwxMiArNDcyLDE1
IEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfcnEoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQog
CQkJZ290byBlcnJfcnFfd3FfZGVzdHJveTsNCiAJCX0NCiANCi0JCXJxLT5tcHdxZS5za2JfZnJv
bV9jcWVfbXB3cnEgPQ0KLQkJCW1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFy
YW1zKSA/DQotCQkJbWx4NWVfc2tiX2Zyb21fY3FlX21wd3JxX2xpbmVhciA6DQotCQkJbWx4NWVf
c2tiX2Zyb21fY3FlX21wd3JxX25vbmxpbmVhcjsNCi0JCXJxLT5tcHdxZS5sb2dfc3RyaWRlX3N6
ID0gbWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJpZGVfc2l6ZShtZGV2LCBwYXJhbXMpOw0KLQkJcnEt
Pm1wd3FlLm51bV9zdHJpZGVzID0gQklUKG1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0cmlkZXMo
bWRldiwgcGFyYW1zKSk7DQorCQlycS0+bXB3cWUuc2tiX2Zyb21fY3FlX21wd3JxID0geHNrID8N
CisJCQltbHg1ZV94c2tfc2tiX2Zyb21fY3FlX21wd3JxX2xpbmVhciA6DQorCQkJbWx4NWVfcnhf
bXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBwYXJhbXMsIE5VTEwpID8NCisJCQkJbWx4NWVfc2ti
X2Zyb21fY3FlX21wd3JxX2xpbmVhciA6DQorCQkJCW1seDVlX3NrYl9mcm9tX2NxZV9tcHdycV9u
b25saW5lYXI7DQorDQorCQlycS0+bXB3cWUubG9nX3N0cmlkZV9zeiA9IG1seDVlX21wd3FlX2dl
dF9sb2dfc3RyaWRlX3NpemUobWRldiwgcGFyYW1zLCB4c2spOw0KKwkJcnEtPm1wd3FlLm51bV9z
dHJpZGVzID0NCisJCQlCSVQobWx4NWVfbXB3cWVfZ2V0X2xvZ19udW1fc3RyaWRlcyhtZGV2LCBw
YXJhbXMsIHhzaykpOw0KIA0KIAkJZXJyID0gbWx4NWVfY3JlYXRlX3JxX3Vtcl9ta2V5KG1kZXYs
IHJxKTsNCiAJCWlmIChlcnIpDQpAQCAtNDYyLDYgKzUwMSw5IEBAIHN0YXRpYyBpbnQgbWx4NWVf
YWxsb2NfcnEoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogDQogCQl3cV9zeiA9IG1seDVfd3Ff
Y3ljX2dldF9zaXplKCZycS0+d3FlLndxKTsNCiANCisJCWlmICh4c2spDQorCQkJbnVtX3hza19m
cmFtZXMgPSB3cV9zeiA8PCBycS0+d3FlLmluZm8ubG9nX251bV9mcmFnczsNCisNCiAJCXJxLT53
cWUuaW5mbyA9IHJxcC0+ZnJhZ3NfaW5mbzsNCiAJCXJxLT53cWUuZnJhZ3MgPQ0KIAkJCWt2emFs
bG9jX25vZGUoYXJyYXlfc2l6ZShzaXplb2YoKnJxLT53cWUuZnJhZ3MpLA0KQEAgLTQ3NSw2ICs1
MTcsNyBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpj
LA0KIAkJZXJyID0gbWx4NWVfaW5pdF9kaV9saXN0KHJxLCB3cV9zeiwgYy0+Y3B1KTsNCiAJCWlm
IChlcnIpDQogCQkJZ290byBlcnJfZnJlZTsNCisNCiAJCXJxLT5wb3N0X3dxZXMgPSBtbHg1ZV9w
b3N0X3J4X3dxZXM7DQogCQlycS0+ZGVhbGxvY193cWUgPSBtbHg1ZV9kZWFsbG9jX3J4X3dxZTsN
CiANCkBAIC00OTAsMzMgKzUzMyw1MSBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3JxKHN0cnVj
dCBtbHg1ZV9jaGFubmVsICpjLA0KIAkJCWdvdG8gZXJyX2ZyZWU7DQogCQl9DQogDQotCQlycS0+
d3FlLnNrYl9mcm9tX2NxZSA9IG1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1zKSA/DQotCQkJ
bWx4NWVfc2tiX2Zyb21fY3FlX2xpbmVhciA6DQotCQkJbWx4NWVfc2tiX2Zyb21fY3FlX25vbmxp
bmVhcjsNCisJCXJxLT53cWUuc2tiX2Zyb21fY3FlID0geHNrID8NCisJCQltbHg1ZV94c2tfc2ti
X2Zyb21fY3FlX2xpbmVhciA6DQorCQkJbWx4NWVfcnhfaXNfbGluZWFyX3NrYihwYXJhbXMsIE5V
TEwpID8NCisJCQkJbWx4NWVfc2tiX2Zyb21fY3FlX2xpbmVhciA6DQorCQkJCW1seDVlX3NrYl9m
cm9tX2NxZV9ub25saW5lYXI7DQorDQogCQlycS0+bWtleV9iZSA9IGMtPm1rZXlfYmU7DQogCX0N
CiANCi0JLyogQ3JlYXRlIGEgcGFnZV9wb29sIGFuZCByZWdpc3RlciBpdCB3aXRoIHJ4cSAqLw0K
LQlwcF9wYXJhbXMub3JkZXIgICAgID0gMDsNCi0JcHBfcGFyYW1zLmZsYWdzICAgICA9IDA7IC8q
IE5vLWludGVybmFsIERNQSBtYXBwaW5nIGluIHBhZ2VfcG9vbCAqLw0KLQlwcF9wYXJhbXMucG9v
bF9zaXplID0gcG9vbF9zaXplOw0KLQlwcF9wYXJhbXMubmlkICAgICAgID0gY3B1X3RvX25vZGUo
Yy0+Y3B1KTsNCi0JcHBfcGFyYW1zLmRldiAgICAgICA9IGMtPnBkZXY7DQotCXBwX3BhcmFtcy5k
bWFfZGlyICAgPSBycS0+YnVmZi5tYXBfZGlyOw0KLQ0KLQkvKiBwYWdlX3Bvb2wgY2FuIGJlIHVz
ZWQgZXZlbiB3aGVuIHRoZXJlIGlzIG5vIHJxLT54ZHBfcHJvZywNCi0JICogZ2l2ZW4gcGFnZV9w
b29sIGRvZXMgbm90IGhhbmRsZSBETUEgbWFwcGluZyB0aGVyZSBpcyBubw0KLQkgKiByZXF1aXJl
ZCBzdGF0ZSB0byBjbGVhci4gQW5kIHBhZ2VfcG9vbCBncmFjZWZ1bGx5IGhhbmRsZQ0KLQkgKiBl
bGV2YXRlZCByZWZjbnQuDQotCSAqLw0KLQlycS0+cGFnZV9wb29sID0gcGFnZV9wb29sX2NyZWF0
ZSgmcHBfcGFyYW1zKTsNCi0JaWYgKElTX0VSUihycS0+cGFnZV9wb29sKSkgew0KLQkJZXJyID0g
UFRSX0VSUihycS0+cGFnZV9wb29sKTsNCi0JCXJxLT5wYWdlX3Bvb2wgPSBOVUxMOw0KLQkJZ290
byBlcnJfZnJlZTsNCisJaWYgKHhzaykgew0KKwkJZXJyID0gbWx4NWVfeHNrX3Jlc2l6ZV9yZXVz
ZXEodW1lbSwgbnVtX3hza19mcmFtZXMpOw0KKwkJaWYgKHVubGlrZWx5KGVycikpIHsNCisJCQlt
bHg1X2NvcmVfZXJyKG1kZXYsICJVbmFibGUgdG8gYWxsb2NhdGUgdGhlIFJldXNlIFJpbmcgZm9y
ICV1IGZyYW1lc1xuIiwNCisJCQkJICAgICAgbnVtX3hza19mcmFtZXMpOw0KKwkJCWdvdG8gZXJy
X2ZyZWU7DQorCQl9DQorDQorCQlycS0+emNhLmZyZWUgPSBtbHg1ZV94c2tfemNhX2ZyZWU7DQor
CQllcnIgPSB4ZHBfcnhxX2luZm9fcmVnX21lbV9tb2RlbCgmcnEtPnhkcF9yeHEsDQorCQkJCQkJ
IE1FTV9UWVBFX1pFUk9fQ09QWSwNCisJCQkJCQkgJnJxLT56Y2EpOw0KKwl9IGVsc2Ugew0KKwkJ
LyogQ3JlYXRlIGEgcGFnZV9wb29sIGFuZCByZWdpc3RlciBpdCB3aXRoIHJ4cSAqLw0KKwkJcHBf
cGFyYW1zLm9yZGVyICAgICA9IDA7DQorCQlwcF9wYXJhbXMuZmxhZ3MgICAgID0gMDsgLyogTm8t
aW50ZXJuYWwgRE1BIG1hcHBpbmcgaW4gcGFnZV9wb29sICovDQorCQlwcF9wYXJhbXMucG9vbF9z
aXplID0gcG9vbF9zaXplOw0KKwkJcHBfcGFyYW1zLm5pZCAgICAgICA9IGNwdV90b19ub2RlKGMt
PmNwdSk7DQorCQlwcF9wYXJhbXMuZGV2ICAgICAgID0gYy0+cGRldjsNCisJCXBwX3BhcmFtcy5k
bWFfZGlyICAgPSBycS0+YnVmZi5tYXBfZGlyOw0KKw0KKwkJLyogcGFnZV9wb29sIGNhbiBiZSB1
c2VkIGV2ZW4gd2hlbiB0aGVyZSBpcyBubyBycS0+eGRwX3Byb2csDQorCQkgKiBnaXZlbiBwYWdl
X3Bvb2wgZG9lcyBub3QgaGFuZGxlIERNQSBtYXBwaW5nIHRoZXJlIGlzIG5vDQorCQkgKiByZXF1
aXJlZCBzdGF0ZSB0byBjbGVhci4gQW5kIHBhZ2VfcG9vbCBncmFjZWZ1bGx5IGhhbmRsZQ0KKwkJ
ICogZWxldmF0ZWQgcmVmY250Lg0KKwkJICovDQorCQlycS0+cGFnZV9wb29sID0gcGFnZV9wb29s
X2NyZWF0ZSgmcHBfcGFyYW1zKTsNCisJCWlmIChJU19FUlIocnEtPnBhZ2VfcG9vbCkpIHsNCisJ
CQllcnIgPSBQVFJfRVJSKHJxLT5wYWdlX3Bvb2wpOw0KKwkJCXJxLT5wYWdlX3Bvb2wgPSBOVUxM
Ow0KKwkJCWdvdG8gZXJyX2ZyZWU7DQorCQl9DQorCQllcnIgPSB4ZHBfcnhxX2luZm9fcmVnX21l
bV9tb2RlbCgmcnEtPnhkcF9yeHEsDQorCQkJCQkJIE1FTV9UWVBFX1BBR0VfUE9PTCwNCisJCQkJ
CQkgcnEtPnBhZ2VfcG9vbCk7DQogCX0NCi0JZXJyID0geGRwX3J4cV9pbmZvX3JlZ19tZW1fbW9k
ZWwoJnJxLT54ZHBfcnhxLA0KLQkJCQkJIE1FTV9UWVBFX1BBR0VfUE9PTCwgcnEtPnBhZ2VfcG9v
bCk7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9mcmVlOw0KIA0KQEAgLTYxNSw3ICs2NzYsMTEg
QEAgc3RhdGljIHZvaWQgbWx4NWVfZnJlZV9ycShzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIAkgICAg
IGkgPSAoaSArIDEpICYgKE1MWDVFX0NBQ0hFX1NJWkUgLSAxKSkgew0KIAkJc3RydWN0IG1seDVl
X2RtYV9pbmZvICpkbWFfaW5mbyA9ICZycS0+cGFnZV9jYWNoZS5wYWdlX2NhY2hlW2ldOw0KIA0K
LQkJbWx4NWVfcGFnZV9yZWxlYXNlKHJxLCBkbWFfaW5mbywgZmFsc2UpOw0KKwkJLyogV2l0aCBB
Rl9YRFAsIHBhZ2VfY2FjaGUgaXMgbm90IHVzZWQsIHNvIHRoaXMgbG9vcCBpcyBub3QNCisJCSAq
IGVudGVyZWQsIGFuZCBpdCdzIHNhZmUgdG8gY2FsbCBtbHg1ZV9wYWdlX3JlbGVhc2VfZHluYW1p
Yw0KKwkJICogZGlyZWN0bHkuDQorCQkgKi8NCisJCW1seDVlX3BhZ2VfcmVsZWFzZV9keW5hbWlj
KHJxLCBkbWFfaW5mbywgZmFsc2UpOw0KIAl9DQogCW1seDVfd3FfZGVzdHJveSgmcnEtPndxX2N0
cmwpOw0KIH0NCkBAIC03NTAsNyArODE1LDcgQEAgc3RhdGljIHZvaWQgbWx4NWVfZGVzdHJveV9y
cShzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIAltbHg1X2NvcmVfZGVzdHJveV9ycShycS0+bWRldiwg
cnEtPnJxbik7DQogfQ0KIA0KLXN0YXRpYyBpbnQgbWx4NWVfd2FpdF9mb3JfbWluX3J4X3dxZXMo
c3RydWN0IG1seDVlX3JxICpycSwgaW50IHdhaXRfdGltZSkNCitpbnQgbWx4NWVfd2FpdF9mb3Jf
bWluX3J4X3dxZXMoc3RydWN0IG1seDVlX3JxICpycSwgaW50IHdhaXRfdGltZSkNCiB7DQogCXVu
c2lnbmVkIGxvbmcgZXhwX3RpbWUgPSBqaWZmaWVzICsgbXNlY3NfdG9famlmZmllcyh3YWl0X3Rp
bWUpOw0KIAlzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYyA9IHJxLT5jaGFubmVsOw0KQEAgLTgwOCwx
NCArODczLDEzIEBAIHN0YXRpYyB2b2lkIG1seDVlX2ZyZWVfcnhfZGVzY3Moc3RydWN0IG1seDVl
X3JxICpycSkNCiANCiB9DQogDQotc3RhdGljIGludCBtbHg1ZV9vcGVuX3JxKHN0cnVjdCBtbHg1
ZV9jaGFubmVsICpjLA0KLQkJCSBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQotCQkJIHN0
cnVjdCBtbHg1ZV9ycV9wYXJhbSAqcGFyYW0sDQotCQkJIHN0cnVjdCBtbHg1ZV9ycSAqcnEpDQor
aW50IG1seDVlX29wZW5fcnEoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsIHN0cnVjdCBtbHg1ZV9w
YXJhbXMgKnBhcmFtcywNCisJCSAgc3RydWN0IG1seDVlX3JxX3BhcmFtICpwYXJhbSwgc3RydWN0
IG1seDVlX3hza19wYXJhbSAqeHNrLA0KKwkJICBzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sIHN0cnVj
dCBtbHg1ZV9ycSAqcnEpDQogew0KIAlpbnQgZXJyOw0KIA0KLQllcnIgPSBtbHg1ZV9hbGxvY19y
cShjLCBwYXJhbXMsIHBhcmFtLCBycSk7DQorCWVyciA9IG1seDVlX2FsbG9jX3JxKGMsIHBhcmFt
cywgeHNrLCB1bWVtLCBwYXJhbSwgcnEpOw0KIAlpZiAoZXJyKQ0KIAkJcmV0dXJuIGVycjsNCiAN
CkBAIC04NTMsMTMgKzkxNywxMyBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9hY3RpdmF0ZV9ycShzdHJ1
Y3QgbWx4NWVfcnEgKnJxKQ0KIAltbHg1ZV90cmlnZ2VyX2lycSgmcnEtPmNoYW5uZWwtPmljb3Nx
KTsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVfZGVhY3RpdmF0ZV9ycShzdHJ1Y3QgbWx4NWVf
cnEgKnJxKQ0KK3ZvaWQgbWx4NWVfZGVhY3RpdmF0ZV9ycShzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0K
IHsNCiAJY2xlYXJfYml0KE1MWDVFX1JRX1NUQVRFX0VOQUJMRUQsICZycS0+c3RhdGUpOw0KIAlu
YXBpX3N5bmNocm9uaXplKCZycS0+Y2hhbm5lbC0+bmFwaSk7IC8qIHByZXZlbnQgbWx4NWVfcG9z
dF9yeF93cWVzICovDQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX3JxKHN0cnVjdCBt
bHg1ZV9ycSAqcnEpDQordm9pZCBtbHg1ZV9jbG9zZV9ycShzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0K
IHsNCiAJY2FuY2VsX3dvcmtfc3luYygmcnEtPmRpbS53b3JrKTsNCiAJbWx4NWVfZGVzdHJveV9y
cShycSk7DQpAQCAtOTEyLDYgKzk3Niw3IEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfeGRwc3Ff
ZGIoc3RydWN0IG1seDVlX3hkcHNxICpzcSwgaW50IG51bWEpDQogDQogc3RhdGljIGludCBtbHg1
ZV9hbGxvY194ZHBzcShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywNCiAJCQkgICAgIHN0cnVjdCBt
bHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgICAgIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwNCiAJ
CQkgICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0sDQogCQkJICAgICBzdHJ1Y3QgbWx4
NWVfeGRwc3EgKnNxLA0KIAkJCSAgICAgYm9vbCBpc19yZWRpcmVjdCkNCkBAIC05MjcsOSArOTky
LDEzIEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfeGRwc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwg
KmMsDQogCXNxLT51YXJfbWFwICAgPSBtZGV2LT5tbHg1ZV9yZXMuYmZyZWcubWFwOw0KIAlzcS0+
bWluX2lubGluZV9tb2RlID0gcGFyYW1zLT50eF9taW5faW5saW5lX21vZGU7DQogCXNxLT5od19t
dHUgICAgPSBNTFg1RV9TVzJIV19NVFUocGFyYW1zLCBwYXJhbXMtPnN3X210dSk7DQotCXNxLT5z
dGF0cyAgICAgPSBpc19yZWRpcmVjdCA/DQotCQkmYy0+cHJpdi0+Y2hhbm5lbF9zdGF0c1tjLT5p
eF0ueGRwc3EgOg0KLQkJJmMtPnByaXYtPmNoYW5uZWxfc3RhdHNbYy0+aXhdLnJxX3hkcHNxOw0K
KwlzcS0+dW1lbSAgICAgID0gdW1lbTsNCisNCisJc3EtPnN0YXRzID0gc3EtPnVtZW0gPw0KKwkJ
JmMtPnByaXYtPmNoYW5uZWxfc3RhdHNbYy0+aXhdLnhza3NxIDoNCisJCWlzX3JlZGlyZWN0ID8N
CisJCQkmYy0+cHJpdi0+Y2hhbm5lbF9zdGF0c1tjLT5peF0ueGRwc3EgOg0KKwkJCSZjLT5wcml2
LT5jaGFubmVsX3N0YXRzW2MtPml4XS5ycV94ZHBzcTsNCiANCiAJcGFyYW0tPndxLmRiX251bWFf
bm9kZSA9IGNwdV90b19ub2RlKGMtPmNwdSk7DQogCWVyciA9IG1seDVfd3FfY3ljX2NyZWF0ZSht
ZGV2LCAmcGFyYW0tPndxLCBzcWNfd3EsIHdxLCAmc3EtPndxX2N0cmwpOw0KQEAgLTEzMDgsMTAg
KzEzNzcsOCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV90eF9lcnJfY3FlX3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICpyZWNvdmVyX3dvcmspDQogCW1seDVlX3R4X3JlcG9ydGVyX2Vycl9jcWUoc3EpOw0K
IH0NCiANCi1zdGF0aWMgaW50IG1seDVlX29wZW5faWNvc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwg
KmMsDQotCQkJICAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCi0JCQkgICAgc3RydWN0
IG1seDVlX3NxX3BhcmFtICpwYXJhbSwNCi0JCQkgICAgc3RydWN0IG1seDVlX2ljb3NxICpzcSkN
CitpbnQgbWx4NWVfb3Blbl9pY29zcShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywgc3RydWN0IG1s
eDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJICAgICBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFt
LCBzdHJ1Y3QgbWx4NWVfaWNvc3EgKnNxKQ0KIHsNCiAJc3RydWN0IG1seDVlX2NyZWF0ZV9zcV9w
YXJhbSBjc3AgPSB7fTsNCiAJaW50IGVycjsNCkBAIC0xMzM3LDcgKzE0MDQsNyBAQCBzdGF0aWMg
aW50IG1seDVlX29wZW5faWNvc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCXJldHVybiBl
cnI7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX2ljb3NxKHN0cnVjdCBtbHg1ZV9p
Y29zcSAqc3EpDQordm9pZCBtbHg1ZV9jbG9zZV9pY29zcShzdHJ1Y3QgbWx4NWVfaWNvc3EgKnNx
KQ0KIHsNCiAJc3RydWN0IG1seDVlX2NoYW5uZWwgKmMgPSBzcS0+Y2hhbm5lbDsNCiANCkBAIC0x
MzQ4LDE2ICsxNDE1LDE0IEBAIHN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX2ljb3NxKHN0cnVjdCBt
bHg1ZV9pY29zcSAqc3EpDQogCW1seDVlX2ZyZWVfaWNvc3Eoc3EpOw0KIH0NCiANCi1zdGF0aWMg
aW50IG1seDVlX29wZW5feGRwc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQotCQkJICAgIHN0
cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCi0JCQkgICAgc3RydWN0IG1seDVlX3NxX3BhcmFt
ICpwYXJhbSwNCi0JCQkgICAgc3RydWN0IG1seDVlX3hkcHNxICpzcSwNCi0JCQkgICAgYm9vbCBp
c19yZWRpcmVjdCkNCitpbnQgbWx4NWVfb3Blbl94ZHBzcShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAq
Yywgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJICAgICBzdHJ1Y3QgbWx4NWVfc3Ff
cGFyYW0gKnBhcmFtLCBzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sDQorCQkgICAgIHN0cnVjdCBtbHg1
ZV94ZHBzcSAqc3EsIGJvb2wgaXNfcmVkaXJlY3QpDQogew0KIAlzdHJ1Y3QgbWx4NWVfY3JlYXRl
X3NxX3BhcmFtIGNzcCA9IHt9Ow0KIAlpbnQgZXJyOw0KIA0KLQllcnIgPSBtbHg1ZV9hbGxvY194
ZHBzcShjLCBwYXJhbXMsIHBhcmFtLCBzcSwgaXNfcmVkaXJlY3QpOw0KKwllcnIgPSBtbHg1ZV9h
bGxvY194ZHBzcShjLCBwYXJhbXMsIHVtZW0sIHBhcmFtLCBzcSwgaXNfcmVkaXJlY3QpOw0KIAlp
ZiAoZXJyKQ0KIAkJcmV0dXJuIGVycjsNCiANCkBAIC0xNDExLDcgKzE0NzYsNyBAQCBzdGF0aWMg
aW50IG1seDVlX29wZW5feGRwc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCXJldHVybiBl
cnI7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX3hkcHNxKHN0cnVjdCBtbHg1ZV94
ZHBzcSAqc3EpDQordm9pZCBtbHg1ZV9jbG9zZV94ZHBzcShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNx
KQ0KIHsNCiAJc3RydWN0IG1seDVlX2NoYW5uZWwgKmMgPSBzcS0+Y2hhbm5lbDsNCiANCkBAIC0x
NTQwLDEwICsxNjA1LDggQEAgc3RhdGljIHZvaWQgbWx4NWVfZGVzdHJveV9jcShzdHJ1Y3QgbWx4
NWVfY3EgKmNxKQ0KIAltbHg1X2NvcmVfZGVzdHJveV9jcShjcS0+bWRldiwgJmNxLT5tY3EpOw0K
IH0NCiANCi1zdGF0aWMgaW50IG1seDVlX29wZW5fY3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMs
DQotCQkJIHN0cnVjdCBuZXRfZGltX2NxX21vZGVyIG1vZGVyLA0KLQkJCSBzdHJ1Y3QgbWx4NWVf
Y3FfcGFyYW0gKnBhcmFtLA0KLQkJCSBzdHJ1Y3QgbWx4NWVfY3EgKmNxKQ0KK2ludCBtbHg1ZV9v
cGVuX2NxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLCBzdHJ1Y3QgbmV0X2RpbV9jcV9tb2RlciBt
b2RlciwNCisJCSAgc3RydWN0IG1seDVlX2NxX3BhcmFtICpwYXJhbSwgc3RydWN0IG1seDVlX2Nx
ICpjcSkNCiB7DQogCXN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2ID0gYy0+bWRldjsNCiAJaW50
IGVycjsNCkBAIC0xNTY2LDcgKzE2MjksNyBAQCBzdGF0aWMgaW50IG1seDVlX29wZW5fY3Eoc3Ry
dWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCXJldHVybiBlcnI7DQogfQ0KIA0KLXN0YXRpYyB2b2lk
IG1seDVlX2Nsb3NlX2NxKHN0cnVjdCBtbHg1ZV9jcSAqY3EpDQordm9pZCBtbHg1ZV9jbG9zZV9j
cShzdHJ1Y3QgbWx4NWVfY3EgKmNxKQ0KIHsNCiAJbWx4NWVfZGVzdHJveV9jcShjcSk7DQogCW1s
eDVlX2ZyZWVfY3EoY3EpOw0KQEAgLTE3ODAsMTcgKzE4NDMsMTcgQEAgc3RhdGljIGludCBtbHg1
ZV9vcGVuX3F1ZXVlcyhzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywNCiAJCWdvdG8gZXJyX2Nsb3Nl
X2ljb3NxOw0KIA0KIAlpZiAoYy0+eGRwKSB7DQotCQllcnIgPSBtbHg1ZV9vcGVuX3hkcHNxKGMs
IHBhcmFtcywgJmNwYXJhbS0+eGRwX3NxLA0KKwkJZXJyID0gbWx4NWVfb3Blbl94ZHBzcShjLCBw
YXJhbXMsICZjcGFyYW0tPnhkcF9zcSwgTlVMTCwNCiAJCQkJICAgICAgICZjLT5ycV94ZHBzcSwg
ZmFsc2UpOw0KIAkJaWYgKGVycikNCiAJCQlnb3RvIGVycl9jbG9zZV9zcXM7DQogCX0NCiANCi0J
ZXJyID0gbWx4NWVfb3Blbl9ycShjLCBwYXJhbXMsICZjcGFyYW0tPnJxLCAmYy0+cnEpOw0KKwll
cnIgPSBtbHg1ZV9vcGVuX3JxKGMsIHBhcmFtcywgJmNwYXJhbS0+cnEsIE5VTEwsIE5VTEwsICZj
LT5ycSk7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9jbG9zZV94ZHBfc3E7DQogDQotCWVyciA9
IG1seDVlX29wZW5feGRwc3EoYywgcGFyYW1zLCAmY3BhcmFtLT54ZHBfc3EsICZjLT54ZHBzcSwg
dHJ1ZSk7DQorCWVyciA9IG1seDVlX29wZW5feGRwc3EoYywgcGFyYW1zLCAmY3BhcmFtLT54ZHBf
c3EsIE5VTEwsICZjLT54ZHBzcSwgdHJ1ZSk7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9jbG9z
ZV9ycTsNCiANCkBAIC0xODUwLDEwICsxOTEzLDEyIEBAIHN0YXRpYyB2b2lkIG1seDVlX2Nsb3Nl
X3F1ZXVlcyhzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYykNCiBzdGF0aWMgaW50IG1seDVlX29wZW5f
Y2hhbm5lbChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgaW50IGl4LA0KIAkJCSAgICAgIHN0cnVj
dCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCiAJCQkgICAgICBzdHJ1Y3QgbWx4NWVfY2hhbm5lbF9w
YXJhbSAqY3BhcmFtLA0KKwkJCSAgICAgIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwNCiAJCQkgICAg
ICBzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqKmNwKQ0KIHsNCiAJaW50IGNwdSA9IGNwdW1hc2tfZmly
c3QobWx4NV9jb21wX2lycV9nZXRfYWZmaW5pdHlfbWFzayhwcml2LT5tZGV2LCBpeCkpOw0KIAlz
dHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2ID0gcHJpdi0+bmV0ZGV2Ow0KKwlzdHJ1Y3QgbWx4NWVf
eHNrX3BhcmFtIHhzazsNCiAJc3RydWN0IG1seDVlX2NoYW5uZWwgKmM7DQogCXVuc2lnbmVkIGlu
dCBpcnE7DQogCWludCBlcnI7DQpAQCAtMTg5MCwxMCArMTk1NSwyMCBAQCBzdGF0aWMgaW50IG1s
eDVlX29wZW5fY2hhbm5lbChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgaW50IGl4LA0KIAlpZiAo
dW5saWtlbHkoZXJyKSkNCiAJCWdvdG8gZXJyX25hcGlfZGVsOw0KIA0KKwlpZiAodW1lbSkgew0K
KwkJbWx4NWVfYnVpbGRfeHNrX3BhcmFtKHVtZW0sICZ4c2spOw0KKwkJZXJyID0gbWx4NWVfb3Bl
bl94c2socHJpdiwgcGFyYW1zLCAmeHNrLCB1bWVtLCBjKTsNCisJCWlmICh1bmxpa2VseShlcnIp
KQ0KKwkJCWdvdG8gZXJyX2Nsb3NlX3F1ZXVlczsNCisJfQ0KKw0KIAkqY3AgPSBjOw0KIA0KIAly
ZXR1cm4gMDsNCiANCitlcnJfY2xvc2VfcXVldWVzOg0KKwltbHg1ZV9jbG9zZV9xdWV1ZXMoYyk7
DQorDQogZXJyX25hcGlfZGVsOg0KIAluZXRpZl9uYXBpX2RlbCgmYy0+bmFwaSk7DQogCW1seDVl
X2ZyZWVfeHBzX2NwdW1hc2soYyk7DQpAQCAtMTkxMiwxMiArMTk4NywxOCBAQCBzdGF0aWMgdm9p
ZCBtbHg1ZV9hY3RpdmF0ZV9jaGFubmVsKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0KIAkJbWx4
NWVfYWN0aXZhdGVfdHhxc3EoJmMtPnNxW3RjXSk7DQogCW1seDVlX2FjdGl2YXRlX3JxKCZjLT5y
cSk7DQogCW5ldGlmX3NldF94cHNfcXVldWUoYy0+bmV0ZGV2LCBjLT54cHNfY3B1bWFzaywgYy0+
aXgpOw0KKw0KKwlpZiAodGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGMtPnN0YXRl
KSkNCisJCW1seDVlX2FjdGl2YXRlX3hzayhjKTsNCiB9DQogDQogc3RhdGljIHZvaWQgbWx4NWVf
ZGVhY3RpdmF0ZV9jaGFubmVsKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0KIHsNCiAJaW50IHRj
Ow0KIA0KKwlpZiAodGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGMtPnN0YXRlKSkN
CisJCW1seDVlX2RlYWN0aXZhdGVfeHNrKGMpOw0KKw0KIAltbHg1ZV9kZWFjdGl2YXRlX3JxKCZj
LT5ycSk7DQogCWZvciAodGMgPSAwOyB0YyA8IGMtPm51bV90YzsgdGMrKykNCiAJCW1seDVlX2Rl
YWN0aXZhdGVfdHhxc3EoJmMtPnNxW3RjXSk7DQpAQCAtMTkyNSw2ICsyMDA2LDggQEAgc3RhdGlj
IHZvaWQgbWx4NWVfZGVhY3RpdmF0ZV9jaGFubmVsKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0K
IA0KIHN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX2NoYW5uZWwoc3RydWN0IG1seDVlX2NoYW5uZWwg
KmMpDQogew0KKwlpZiAodGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGMtPnN0YXRl
KSkNCisJCW1seDVlX2Nsb3NlX3hzayhjKTsNCiAJbWx4NWVfY2xvc2VfcXVldWVzKGMpOw0KIAlu
ZXRpZl9uYXBpX2RlbCgmYy0+bmFwaSk7DQogCW1seDVlX2ZyZWVfeHBzX2NwdW1hc2soYyk7DQpA
QCAtMTkzNiw2ICsyMDE5LDcgQEAgc3RhdGljIHZvaWQgbWx4NWVfY2xvc2VfY2hhbm5lbChzdHJ1
Y3QgbWx4NWVfY2hhbm5lbCAqYykNCiANCiBzdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9ycV9mcmFn
c19pbmZvKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KIAkJCQkgICAgICBzdHJ1Y3QgbWx4
NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCSAgICAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhz
aywNCiAJCQkJICAgICAgc3RydWN0IG1seDVlX3JxX2ZyYWdzX2luZm8gKmluZm8pDQogew0KIAl1
MzIgYnl0ZV9jb3VudCA9IE1MWDVFX1NXMkhXX01UVShwYXJhbXMsIHBhcmFtcy0+c3dfbXR1KTsN
CkBAIC0xOTQ4LDEwICsyMDMyLDEwIEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3JxX2ZyYWdz
X2luZm8oc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYsDQogCQlieXRlX2NvdW50ICs9IE1MWDVF
X01FVEFEQVRBX0VUSEVSX0xFTjsNCiAjZW5kaWYNCiANCi0JaWYgKG1seDVlX3J4X2lzX2xpbmVh
cl9za2IocGFyYW1zKSkgew0KKwlpZiAobWx4NWVfcnhfaXNfbGluZWFyX3NrYihwYXJhbXMsIHhz
aykpIHsNCiAJCWludCBmcmFnX3N0cmlkZTsNCiANCi0JCWZyYWdfc3RyaWRlID0gbWx4NWVfcnhf
Z2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgTlVMTCk7DQorCQlmcmFnX3N0cmlkZSA9IG1seDVl
X3J4X2dldF9saW5lYXJfZnJhZ19zeihwYXJhbXMsIHhzayk7DQogCQlmcmFnX3N0cmlkZSA9IHJv
dW5kdXBfcG93X29mX3R3byhmcmFnX3N0cmlkZSk7DQogDQogCQlpbmZvLT5hcnJbMF0uZnJhZ19z
aXplID0gYnl0ZV9jb3VudDsNCkBAIC0yMDA5LDkgKzIwOTMsMTAgQEAgc3RhdGljIHU4IG1seDVl
X2dldF9ycV9sb2dfd3Ffc3oodm9pZCAqcnFjKQ0KIAlyZXR1cm4gTUxYNV9HRVQod3EsIHdxLCBs
b2dfd3Ffc3opOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9ycV9wYXJhbShzdHJ1
Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCi0JCQkJIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywN
Ci0JCQkJIHN0cnVjdCBtbHg1ZV9ycV9wYXJhbSAqcGFyYW0pDQordm9pZCBtbHg1ZV9idWlsZF9y
cV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgIHN0cnVjdCBtbHg1ZV9wYXJh
bXMgKnBhcmFtcywNCisJCQkgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywNCisJCQkgIHN0
cnVjdCBtbHg1ZV9ycV9wYXJhbSAqcGFyYW0pDQogew0KIAlzdHJ1Y3QgbWx4NV9jb3JlX2RldiAq
bWRldiA9IHByaXYtPm1kZXY7DQogCXZvaWQgKnJxYyA9IHBhcmFtLT5ycWM7DQpAQCAtMjAyMSwx
NiArMjEwNiwxNiBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9ycV9wYXJhbShzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwNCiAJc3dpdGNoIChwYXJhbXMtPnJxX3dxX3R5cGUpIHsNCiAJY2FzZSBN
TFg1X1dRX1RZUEVfTElOS0VEX0xJU1RfU1RSSURJTkdfUlE6DQogCQlNTFg1X1NFVCh3cSwgd3Es
IGxvZ193cWVfbnVtX29mX3N0cmlkZXMsDQotCQkJIG1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0
cmlkZXMobWRldiwgcGFyYW1zKSAtDQorCQkJIG1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0cmlk
ZXMobWRldiwgcGFyYW1zLCB4c2spIC0NCiAJCQkgTUxYNV9NUFdRRV9MT0dfTlVNX1NUUklERVNf
QkFTRSk7DQogCQlNTFg1X1NFVCh3cSwgd3EsIGxvZ193cWVfc3RyaWRlX3NpemUsDQotCQkJIG1s
eDVlX21wd3FlX2dldF9sb2dfc3RyaWRlX3NpemUobWRldiwgcGFyYW1zKSAtDQorCQkJIG1seDVl
X21wd3FlX2dldF9sb2dfc3RyaWRlX3NpemUobWRldiwgcGFyYW1zLCB4c2spIC0NCiAJCQkgTUxY
NV9NUFdRRV9MT0dfU1RSSURFX1NaX0JBU0UpOw0KLQkJTUxYNV9TRVQod3EsIHdxLCBsb2dfd3Ff
c3osIG1seDVlX21wd3FlX2dldF9sb2dfcnFfc2l6ZShwYXJhbXMpKTsNCisJCU1MWDVfU0VUKHdx
LCB3cSwgbG9nX3dxX3N6LCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zLCB4c2sp
KTsNCiAJCWJyZWFrOw0KIAlkZWZhdWx0OiAvKiBNTFg1X1dRX1RZUEVfQ1lDTElDICovDQogCQlN
TFg1X1NFVCh3cSwgd3EsIGxvZ193cV9zeiwgcGFyYW1zLT5sb2dfcnFfbXR1X2ZyYW1lcyk7DQot
CQltbHg1ZV9idWlsZF9ycV9mcmFnc19pbmZvKG1kZXYsIHBhcmFtcywgJnBhcmFtLT5mcmFnc19p
bmZvKTsNCisJCW1seDVlX2J1aWxkX3JxX2ZyYWdzX2luZm8obWRldiwgcGFyYW1zLCB4c2ssICZw
YXJhbS0+ZnJhZ3NfaW5mbyk7DQogCQluZHNlZ3MgPSBwYXJhbS0+ZnJhZ3NfaW5mby5udW1fZnJh
Z3M7DQogCX0NCiANCkBAIC0yMDYxLDggKzIxNDYsOCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWls
ZF9kcm9wX3JxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAlwYXJhbS0+d3EuYnVm
X251bWFfbm9kZSA9IGRldl90b19ub2RlKG1kZXYtPmRldmljZSk7DQogfQ0KIA0KLXN0YXRpYyB2
b2lkIG1seDVlX2J1aWxkX3NxX3BhcmFtX2NvbW1vbihzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwN
Ci0JCQkJCXN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pDQordm9pZCBtbHg1ZV9idWlsZF9z
cV9wYXJhbV9jb21tb24oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJCSBzdHJ1Y3QgbWx4
NWVfc3FfcGFyYW0gKnBhcmFtKQ0KIHsNCiAJdm9pZCAqc3FjID0gcGFyYW0tPnNxYzsNCiAJdm9p
ZCAqd3EgPSBNTFg1X0FERFJfT0Yoc3FjLCBzcWMsIHdxKTsNCkBAIC0yMDk4LDkgKzIxODMsMTAg
QEAgc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfY29tbW9uX2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9w
cml2ICpwcml2LA0KIAkJTUxYNV9TRVQoY3FjLCBjcWMsIGNxZV9zeiwgQ1FFX1NUUklERV8xMjhf
UEFEKTsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfcnhfY3FfcGFyYW0oc3RydWN0
IG1seDVlX3ByaXYgKnByaXYsDQotCQkJCSAgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMs
DQotCQkJCSAgICBzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gKnBhcmFtKQ0KK3ZvaWQgbWx4NWVfYnVp
bGRfcnhfY3FfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJICAgICBzdHJ1Y3Qg
bWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4
c2ssDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gKnBhcmFtKQ0KIHsNCiAJc3RydWN0
IG1seDVfY29yZV9kZXYgKm1kZXYgPSBwcml2LT5tZGV2Ow0KIAl2b2lkICpjcWMgPSBwYXJhbS0+
Y3FjOw0KQEAgLTIxMDgsOCArMjE5NCw4IEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3J4X2Nx
X3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIA0KIAlzd2l0Y2ggKHBhcmFtcy0+cnFf
d3FfdHlwZSkgew0KIAljYXNlIE1MWDVfV1FfVFlQRV9MSU5LRURfTElTVF9TVFJJRElOR19SUToN
Ci0JCWxvZ19jcV9zaXplID0gbWx4NWVfbXB3cWVfZ2V0X2xvZ19ycV9zaXplKHBhcmFtcykgKw0K
LQkJCW1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0cmlkZXMobWRldiwgcGFyYW1zKTsNCisJCWxv
Z19jcV9zaXplID0gbWx4NWVfbXB3cWVfZ2V0X2xvZ19ycV9zaXplKHBhcmFtcywgeHNrKSArDQor
CQkJbWx4NWVfbXB3cWVfZ2V0X2xvZ19udW1fc3RyaWRlcyhtZGV2LCBwYXJhbXMsIHhzayk7DQog
CQlicmVhazsNCiAJZGVmYXVsdDogLyogTUxYNV9XUV9UWVBFX0NZQ0xJQyAqLw0KIAkJbG9nX2Nx
X3NpemUgPSBwYXJhbXMtPmxvZ19ycV9tdHVfZnJhbWVzOw0KQEAgLTIxMjUsOSArMjIxMSw5IEBA
IHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3J4X2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2LA0KIAlwYXJhbS0+Y3FfcGVyaW9kX21vZGUgPSBwYXJhbXMtPnJ4X2NxX21vZGVyYXRpb24u
Y3FfcGVyaW9kX21vZGU7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3R4X2NxX3Bh
cmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KLQkJCQkgICAgc3RydWN0IG1seDVlX3BhcmFt
cyAqcGFyYW1zLA0KLQkJCQkgICAgc3RydWN0IG1seDVlX2NxX3BhcmFtICpwYXJhbSkNCit2b2lk
IG1seDVlX2J1aWxkX3R4X2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAg
ICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX2Nx
X3BhcmFtICpwYXJhbSkNCiB7DQogCXZvaWQgKmNxYyA9IHBhcmFtLT5jcWM7DQogDQpAQCAtMjEz
Nyw5ICsyMjIzLDkgQEAgc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfdHhfY3FfcGFyYW0oc3RydWN0
IG1seDVlX3ByaXYgKnByaXYsDQogCXBhcmFtLT5jcV9wZXJpb2RfbW9kZSA9IHBhcmFtcy0+dHhf
Y3FfbW9kZXJhdGlvbi5jcV9wZXJpb2RfbW9kZTsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVf
YnVpbGRfaWNvX2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KLQkJCQkgICAgIHU4
IGxvZ193cV9zaXplLA0KLQkJCQkgICAgIHN0cnVjdCBtbHg1ZV9jcV9wYXJhbSAqcGFyYW0pDQor
dm9pZCBtbHg1ZV9idWlsZF9pY29fY3FfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQor
CQkJICAgICAgdTggbG9nX3dxX3NpemUsDQorCQkJICAgICAgc3RydWN0IG1seDVlX2NxX3BhcmFt
ICpwYXJhbSkNCiB7DQogCXZvaWQgKmNxYyA9IHBhcmFtLT5jcWM7DQogDQpAQCAtMjE1MCw5ICsy
MjM2LDkgQEAgc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfaWNvX2NxX3BhcmFtKHN0cnVjdCBtbHg1
ZV9wcml2ICpwcml2LA0KIAlwYXJhbS0+Y3FfcGVyaW9kX21vZGUgPSBORVRfRElNX0NRX1BFUklP
RF9NT0RFX1NUQVJUX0ZST01fRVFFOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9p
Y29zcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCi0JCQkJICAgIHU4IGxvZ193cV9z
aXplLA0KLQkJCQkgICAgc3RydWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSkNCit2b2lkIG1seDVl
X2J1aWxkX2ljb3NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgdTgg
bG9nX3dxX3NpemUsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtKQ0KIHsN
CiAJdm9pZCAqc3FjID0gcGFyYW0tPnNxYzsNCiAJdm9pZCAqd3EgPSBNTFg1X0FERFJfT0Yoc3Fj
LCBzcWMsIHdxKTsNCkBAIC0yMTYzLDkgKzIyNDksOSBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWls
ZF9pY29zcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJTUxYNV9TRVQoc3FjLCBz
cWMsIHJlZ191bXIsIE1MWDVfQ0FQX0VUSChwcml2LT5tZGV2LCByZWdfdW1yX3NxKSk7DQogfQ0K
IA0KLXN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3hkcHNxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2LA0KLQkJCQkgICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KLQkJCQkgICAg
c3RydWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSkNCit2b2lkIG1seDVlX2J1aWxkX3hkcHNxX3Bh
cmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3BhcmFt
cyAqcGFyYW1zLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSkNCiB7DQog
CXZvaWQgKnNxYyA9IHBhcmFtLT5zcWM7DQogCXZvaWQgKndxID0gTUxYNV9BRERSX09GKHNxYywg
c3FjLCB3cSk7DQpAQCAtMjE5MywxNCArMjI3OSwxNCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWls
ZF9jaGFubmVsX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIHsNCiAJdTggaWNvc3Ff
bG9nX3dxX3N6Ow0KIA0KLQltbHg1ZV9idWlsZF9ycV9wYXJhbShwcml2LCBwYXJhbXMsICZjcGFy
YW0tPnJxKTsNCisJbWx4NWVfYnVpbGRfcnFfcGFyYW0ocHJpdiwgcGFyYW1zLCBOVUxMLCAmY3Bh
cmFtLT5ycSk7DQogDQogCWljb3NxX2xvZ193cV9zeiA9IG1seDVlX2J1aWxkX2ljb3NxX2xvZ193
cV9zeihwYXJhbXMsICZjcGFyYW0tPnJxKTsNCiANCiAJbWx4NWVfYnVpbGRfc3FfcGFyYW0ocHJp
diwgcGFyYW1zLCAmY3BhcmFtLT5zcSk7DQogCW1seDVlX2J1aWxkX3hkcHNxX3BhcmFtKHByaXYs
IHBhcmFtcywgJmNwYXJhbS0+eGRwX3NxKTsNCiAJbWx4NWVfYnVpbGRfaWNvc3FfcGFyYW0ocHJp
diwgaWNvc3FfbG9nX3dxX3N6LCAmY3BhcmFtLT5pY29zcSk7DQotCW1seDVlX2J1aWxkX3J4X2Nx
X3BhcmFtKHByaXYsIHBhcmFtcywgJmNwYXJhbS0+cnhfY3EpOw0KKwltbHg1ZV9idWlsZF9yeF9j
cV9wYXJhbShwcml2LCBwYXJhbXMsIE5VTEwsICZjcGFyYW0tPnJ4X2NxKTsNCiAJbWx4NWVfYnVp
bGRfdHhfY3FfcGFyYW0ocHJpdiwgcGFyYW1zLCAmY3BhcmFtLT50eF9jcSk7DQogCW1seDVlX2J1
aWxkX2ljb19jcV9wYXJhbShwcml2LCBpY29zcV9sb2dfd3Ffc3osICZjcGFyYW0tPmljb3NxX2Nx
KTsNCiB9DQpAQCAtMjIyMSw3ICsyMzA3LDEyIEBAIGludCBtbHg1ZV9vcGVuX2NoYW5uZWxzKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIA0KIAltbHg1ZV9idWlsZF9jaGFubmVsX3BhcmFtKHBy
aXYsICZjaHMtPnBhcmFtcywgY3BhcmFtKTsNCiAJZm9yIChpID0gMDsgaSA8IGNocy0+bnVtOyBp
KyspIHsNCi0JCWVyciA9IG1seDVlX29wZW5fY2hhbm5lbChwcml2LCBpLCAmY2hzLT5wYXJhbXMs
IGNwYXJhbSwgJmNocy0+Y1tpXSk7DQorCQlzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0gPSBOVUxMOw0K
Kw0KKwkJaWYgKGNocy0+cGFyYW1zLnhkcF9wcm9nKQ0KKwkJCXVtZW0gPSBtbHg1ZV94c2tfZ2V0
X3VtZW0oJmNocy0+cGFyYW1zLCBjaHMtPnBhcmFtcy54c2ssIGkpOw0KKw0KKwkJZXJyID0gbWx4
NWVfb3Blbl9jaGFubmVsKHByaXYsIGksICZjaHMtPnBhcmFtcywgY3BhcmFtLCB1bWVtLCAmY2hz
LT5jW2ldKTsNCiAJCWlmIChlcnIpDQogCQkJZ290byBlcnJfY2xvc2VfY2hhbm5lbHM7DQogCX0N
CkBAIC0yMjYzLDYgKzIzNTQsMTAgQEAgc3RhdGljIGludCBtbHg1ZV93YWl0X2NoYW5uZWxzX21p
bl9yeF93cWVzKHN0cnVjdCBtbHg1ZV9jaGFubmVscyAqY2hzKQ0KIAkJaW50IHRpbWVvdXQgPSBl
cnIgPyAwIDogTUxYNUVfUlFfV1FFU19USU1FT1VUOw0KIA0KIAkJZXJyIHw9IG1seDVlX3dhaXRf
Zm9yX21pbl9yeF93cWVzKCZjaHMtPmNbaV0tPnJxLCB0aW1lb3V0KTsNCisNCisJCS8qIERvbid0
IHdhaXQgb24gdGhlIFhTSyBSUSwgYmVjYXVzZSB0aGUgbmV3ZXIgeGRwc29jayBzYW1wbGUNCisJ
CSAqIGRvZXNuJ3QgcHJvdmlkZSBhbnkgRmlsbCBSaW5nIGVudHJpZXMgYXQgdGhlIHNldHVwIHN0
YWdlLg0KKwkJICovDQogCX0NCiANCiAJcmV0dXJuIGVyciA/IC1FVElNRURPVVQgOiAwOw0KQEAg
LTIzMzUsMzUgKzI0MzAsMzUgQEAgaW50IG1seDVlX2NyZWF0ZV9pbmRpcmVjdF9ycXQoc3RydWN0
IG1seDVlX3ByaXYgKnByaXYpDQogCXJldHVybiBlcnI7DQogfQ0KIA0KLWludCBtbHg1ZV9jcmVh
dGVfZGlyZWN0X3JxdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQoraW50IG1seDVlX2NyZWF0
ZV9kaXJlY3RfcnF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX3RpciAq
dGlycykNCiB7DQotCXN0cnVjdCBtbHg1ZV9ycXQgKnJxdDsNCisJY29uc3QgaW50IG1heF9uY2gg
PSBtbHg1ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhwcml2LT5uZXRkZXYpOw0KIAlpbnQgZXJy
Ow0KIAlpbnQgaXg7DQogDQotCWZvciAoaXggPSAwOyBpeCA8IG1seDVlX2dldF9uZXRkZXZfbWF4
X2NoYW5uZWxzKHByaXYtPm5ldGRldik7IGl4KyspIHsNCi0JCXJxdCA9ICZwcml2LT5kaXJlY3Rf
dGlyW2l4XS5ycXQ7DQotCQllcnIgPSBtbHg1ZV9jcmVhdGVfcnF0KHByaXYsIDEgLypzaXplICov
LCBycXQpOw0KLQkJaWYgKGVycikNCisJZm9yIChpeCA9IDA7IGl4IDwgbWF4X25jaDsgaXgrKykg
ew0KKwkJZXJyID0gbWx4NWVfY3JlYXRlX3JxdChwcml2LCAxIC8qc2l6ZSAqLywgJnRpcnNbaXhd
LnJxdCk7DQorCQlpZiAodW5saWtlbHkoZXJyKSkNCiAJCQlnb3RvIGVycl9kZXN0cm95X3JxdHM7
DQogCX0NCiANCiAJcmV0dXJuIDA7DQogDQogZXJyX2Rlc3Ryb3lfcnF0czoNCi0JbWx4NV9jb3Jl
X3dhcm4ocHJpdi0+bWRldiwgImNyZWF0ZSBkaXJlY3QgcnF0cyBmYWlsZWQsICVkXG4iLCBlcnIp
Ow0KKwltbHg1X2NvcmVfd2Fybihwcml2LT5tZGV2LCAiY3JlYXRlIHJxdHMgZmFpbGVkLCAlZFxu
IiwgZXJyKTsNCiAJZm9yIChpeC0tOyBpeCA+PSAwOyBpeC0tKQ0KLQkJbWx4NWVfZGVzdHJveV9y
cXQocHJpdiwgJnByaXYtPmRpcmVjdF90aXJbaXhdLnJxdCk7DQorCQltbHg1ZV9kZXN0cm95X3Jx
dChwcml2LCAmdGlyc1tpeF0ucnF0KTsNCiANCiAJcmV0dXJuIGVycjsNCiB9DQogDQotdm9pZCBt
bHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KK3ZvaWQg
bWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0
IG1seDVlX3RpciAqdGlycykNCiB7DQorCWNvbnN0IGludCBtYXhfbmNoID0gbWx4NWVfZ2V0X25l
dGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCiAJaW50IGk7DQogDQotCWZvciAoaSA9
IDA7IGkgPCBtbHg1ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhwcml2LT5uZXRkZXYpOyBpKysp
DQotCQltbHg1ZV9kZXN0cm95X3JxdChwcml2LCAmcHJpdi0+ZGlyZWN0X3RpcltpXS5ycXQpOw0K
Kwlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKQ0KKwkJbWx4NWVfZGVzdHJveV9ycXQocHJp
diwgJnRpcnNbaV0ucnF0KTsNCiB9DQogDQogc3RhdGljIGludCBtbHg1ZV9yeF9oYXNoX2ZuKGlu
dCBoZnVuYykNCkBAIC0yNzgzLDExICsyODc4LDEyIEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxk
X3R4MnNxX21hcHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogdm9pZCBtbHg1ZV9hY3RpdmF0
ZV9wcml2X2NoYW5uZWxzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIHsNCiAJaW50IG51bV90
eHFzID0gcHJpdi0+Y2hhbm5lbHMubnVtICogcHJpdi0+Y2hhbm5lbHMucGFyYW1zLm51bV90YzsN
CisJaW50IG51bV9yeHFzID0gcHJpdi0+Y2hhbm5lbHMubnVtICogTUxYNUVfTlVNX1JRX0dST1VQ
UzsNCiAJc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiA9IHByaXYtPm5ldGRldjsNCiANCiAJbWx4
NWVfbmV0ZGV2X3NldF90Y3MobmV0ZGV2KTsNCiAJbmV0aWZfc2V0X3JlYWxfbnVtX3R4X3F1ZXVl
cyhuZXRkZXYsIG51bV90eHFzKTsNCi0JbmV0aWZfc2V0X3JlYWxfbnVtX3J4X3F1ZXVlcyhuZXRk
ZXYsIHByaXYtPmNoYW5uZWxzLm51bSk7DQorCW5ldGlmX3NldF9yZWFsX251bV9yeF9xdWV1ZXMo
bmV0ZGV2LCBudW1fcnhxcyk7DQogDQogCW1seDVlX2J1aWxkX3R4MnNxX21hcHMocHJpdik7DQog
CW1seDVlX2FjdGl2YXRlX2NoYW5uZWxzKCZwcml2LT5jaGFubmVscyk7DQpAQCAtMjc5OSwxMCAr
Mjg5NSwxNCBAQCB2b2lkIG1seDVlX2FjdGl2YXRlX3ByaXZfY2hhbm5lbHMoc3RydWN0IG1seDVl
X3ByaXYgKnByaXYpDQogDQogCW1seDVlX3dhaXRfY2hhbm5lbHNfbWluX3J4X3dxZXMoJnByaXYt
PmNoYW5uZWxzKTsNCiAJbWx4NWVfcmVkaXJlY3RfcnF0c190b19jaGFubmVscyhwcml2LCAmcHJp
di0+Y2hhbm5lbHMpOw0KKw0KKwltbHg1ZV94c2tfcmVkaXJlY3RfcnF0c190b19jaGFubmVscyhw
cml2LCAmcHJpdi0+Y2hhbm5lbHMpOw0KIH0NCiANCiB2b2lkIG1seDVlX2RlYWN0aXZhdGVfcHJp
dl9jaGFubmVscyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiB7DQorCW1seDVlX3hza19yZWRp
cmVjdF9ycXRzX3RvX2Ryb3AocHJpdiwgJnByaXYtPmNoYW5uZWxzKTsNCisNCiAJbWx4NWVfcmVk
aXJlY3RfcnF0c190b19kcm9wKHByaXYpOw0KIA0KIAlpZiAobWx4NWVfaXNfdnBvcnRfcmVwKHBy
aXYpKQ0KQEAgLTI4ODEsOSArMjk4MSwxMiBAQCB2b2lkIG1seDVlX3RpbWVzdGFtcF9pbml0KHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIGludCBtbHg1ZV9vcGVuX2xvY2tlZChzdHJ1Y3QgbmV0
X2RldmljZSAqbmV0ZGV2KQ0KIHsNCiAJc3RydWN0IG1seDVlX3ByaXYgKnByaXYgPSBuZXRkZXZf
cHJpdihuZXRkZXYpOw0KKwlib29sIGlzX3hkcCA9IHByaXYtPmNoYW5uZWxzLnBhcmFtcy54ZHBf
cHJvZzsNCiAJaW50IGVycjsNCiANCiAJc2V0X2JpdChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2
LT5zdGF0ZSk7DQorCWlmIChpc194ZHApDQorCQltbHg1ZV94ZHBfc2V0X29wZW4ocHJpdik7DQog
DQogCWVyciA9IG1seDVlX29wZW5fY2hhbm5lbHMocHJpdiwgJnByaXYtPmNoYW5uZWxzKTsNCiAJ
aWYgKGVycikNCkBAIC0yODk4LDYgKzMwMDEsOCBAQCBpbnQgbWx4NWVfb3Blbl9sb2NrZWQoc3Ry
dWN0IG5ldF9kZXZpY2UgKm5ldGRldikNCiAJcmV0dXJuIDA7DQogDQogZXJyX2NsZWFyX3N0YXRl
X29wZW5lZF9mbGFnOg0KKwlpZiAoaXNfeGRwKQ0KKwkJbWx4NWVfeGRwX3NldF9jbG9zZWQocHJp
dik7DQogCWNsZWFyX2JpdChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSk7DQogCXJl
dHVybiBlcnI7DQogfQ0KQEAgLTI5MjksNiArMzAzNCw4IEBAIGludCBtbHg1ZV9jbG9zZV9sb2Nr
ZWQoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldikNCiAJaWYgKCF0ZXN0X2JpdChNTFg1RV9TVEFU
RV9PUEVORUQsICZwcml2LT5zdGF0ZSkpDQogCQlyZXR1cm4gMDsNCiANCisJaWYgKHByaXYtPmNo
YW5uZWxzLnBhcmFtcy54ZHBfcHJvZykNCisJCW1seDVlX3hkcF9zZXRfY2xvc2VkKHByaXYpOw0K
IAljbGVhcl9iaXQoTUxYNUVfU1RBVEVfT1BFTkVELCAmcHJpdi0+c3RhdGUpOw0KIA0KIAluZXRp
Zl9jYXJyaWVyX29mZihwcml2LT5uZXRkZXYpOw0KQEAgLTMxODUsMTMgKzMyOTIsMTMgQEAgaW50
IG1seDVlX2NyZWF0ZV9pbmRpcmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBib29s
IGlubmVyX3R0YykNCiAJcmV0dXJuIGVycjsNCiB9DQogDQotaW50IG1seDVlX2NyZWF0ZV9kaXJl
Y3RfdGlycyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCitpbnQgbWx4NWVfY3JlYXRlX2RpcmVj
dF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfdGlyICp0aXJzKQ0K
IHsNCi0JaW50IG5jaCA9IG1seDVlX2dldF9uZXRkZXZfbWF4X2NoYW5uZWxzKHByaXYtPm5ldGRl
dik7DQorCWNvbnN0IGludCBtYXhfbmNoID0gbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMo
cHJpdi0+bmV0ZGV2KTsNCiAJc3RydWN0IG1seDVlX3RpciAqdGlyOw0KIAl2b2lkICp0aXJjOw0K
IAlpbnQgaW5sZW47DQotCWludCBlcnI7DQorCWludCBlcnIgPSAwOw0KIAl1MzIgKmluOw0KIAlp
bnQgaXg7DQogDQpAQCAtMzIwMCwyNSArMzMwNywyNCBAQCBpbnQgbWx4NWVfY3JlYXRlX2RpcmVj
dF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlpZiAoIWluKQ0KIAkJcmV0dXJuIC1F
Tk9NRU07DQogDQotCWZvciAoaXggPSAwOyBpeCA8IG5jaDsgaXgrKykgew0KKwlmb3IgKGl4ID0g
MDsgaXggPCBtYXhfbmNoOyBpeCsrKSB7DQogCQltZW1zZXQoaW4sIDAsIGlubGVuKTsNCi0JCXRp
ciA9ICZwcml2LT5kaXJlY3RfdGlyW2l4XTsNCisJCXRpciA9ICZ0aXJzW2l4XTsNCiAJCXRpcmMg
PSBNTFg1X0FERFJfT0YoY3JlYXRlX3Rpcl9pbiwgaW4sIGN0eCk7DQotCQltbHg1ZV9idWlsZF9k
aXJlY3RfdGlyX2N0eChwcml2LCBwcml2LT5kaXJlY3RfdGlyW2l4XS5ycXQucnF0biwgdGlyYyk7
DQorCQltbHg1ZV9idWlsZF9kaXJlY3RfdGlyX2N0eChwcml2LCB0aXItPnJxdC5ycXRuLCB0aXJj
KTsNCiAJCWVyciA9IG1seDVlX2NyZWF0ZV90aXIocHJpdi0+bWRldiwgdGlyLCBpbiwgaW5sZW4p
Ow0KLQkJaWYgKGVycikNCisJCWlmICh1bmxpa2VseShlcnIpKQ0KIAkJCWdvdG8gZXJyX2Rlc3Ry
b3lfY2hfdGlyczsNCiAJfQ0KIA0KLQlrdmZyZWUoaW4pOw0KLQ0KLQlyZXR1cm4gMDsNCisJZ290
byBvdXQ7DQogDQogZXJyX2Rlc3Ryb3lfY2hfdGlyczoNCi0JbWx4NV9jb3JlX3dhcm4ocHJpdi0+
bWRldiwgImNyZWF0ZSBkaXJlY3QgdGlycyBmYWlsZWQsICVkXG4iLCBlcnIpOw0KKwltbHg1X2Nv
cmVfd2Fybihwcml2LT5tZGV2LCAiY3JlYXRlIHRpcnMgZmFpbGVkLCAlZFxuIiwgZXJyKTsNCiAJ
Zm9yIChpeC0tOyBpeCA+PSAwOyBpeC0tKQ0KLQkJbWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRl
diwgJnByaXYtPmRpcmVjdF90aXJbaXhdKTsNCisJCW1seDVlX2Rlc3Ryb3lfdGlyKHByaXYtPm1k
ZXYsICZ0aXJzW2l4XSk7DQogDQorb3V0Og0KIAlrdmZyZWUoaW4pOw0KIA0KIAlyZXR1cm4gZXJy
Ow0KQEAgLTMyMzgsMTMgKzMzNDQsMTMgQEAgdm9pZCBtbHg1ZV9kZXN0cm95X2luZGlyZWN0X3Rp
cnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIGJvb2wgaW5uZXJfdHRjKQ0KIAkJbWx4NWVfZGVz
dHJveV90aXIocHJpdi0+bWRldiwgJnByaXYtPmlubmVyX2luZGlyX3RpcltpXSk7DQogfQ0KIA0K
LXZvaWQgbWx4NWVfZGVzdHJveV9kaXJlY3RfdGlycyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikN
Cit2b2lkIG1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYs
IHN0cnVjdCBtbHg1ZV90aXIgKnRpcnMpDQogew0KLQlpbnQgbmNoID0gbWx4NWVfZ2V0X25ldGRl
dl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCisJY29uc3QgaW50IG1heF9uY2ggPSBtbHg1
ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhwcml2LT5uZXRkZXYpOw0KIAlpbnQgaTsNCiANCi0J
Zm9yIChpID0gMDsgaSA8IG5jaDsgaSsrKQ0KLQkJbWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRl
diwgJnByaXYtPmRpcmVjdF90aXJbaV0pOw0KKwlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsr
KQ0KKwkJbWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRldiwgJnRpcnNbaV0pOw0KIH0NCiANCiBz
dGF0aWMgaW50IG1seDVlX21vZGlmeV9jaGFubmVsc19zY2F0dGVyX2ZjcyhzdHJ1Y3QgbWx4NWVf
Y2hhbm5lbHMgKmNocywgYm9vbCBlbmFibGUpDQpAQCAtMzM4NiwxMSArMzQ5MiwxMiBAQCB2b2lk
IG1seDVlX2ZvbGRfc3dfc3RhdHM2NChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IHJ0
bmxfbGlua19zdGF0czY0ICpzKQ0KIA0KIAlmb3IgKGkgPSAwOyBpIDwgbWx4NWVfZ2V0X25ldGRl
dl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsgaSsrKSB7DQogCQlzdHJ1Y3QgbWx4NWVfY2hh
bm5lbF9zdGF0cyAqY2hhbm5lbF9zdGF0cyA9ICZwcml2LT5jaGFubmVsX3N0YXRzW2ldOw0KKwkJ
c3RydWN0IG1seDVlX3JxX3N0YXRzICp4c2tycV9zdGF0cyA9ICZjaGFubmVsX3N0YXRzLT54c2ty
cTsNCiAJCXN0cnVjdCBtbHg1ZV9ycV9zdGF0cyAqcnFfc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+
cnE7DQogCQlpbnQgajsNCiANCi0JCXMtPnJ4X3BhY2tldHMgICArPSBycV9zdGF0cy0+cGFja2V0
czsNCi0JCXMtPnJ4X2J5dGVzICAgICArPSBycV9zdGF0cy0+Ynl0ZXM7DQorCQlzLT5yeF9wYWNr
ZXRzICAgKz0gcnFfc3RhdHMtPnBhY2tldHMgKyB4c2tycV9zdGF0cy0+cGFja2V0czsNCisJCXMt
PnJ4X2J5dGVzICAgICArPSBycV9zdGF0cy0+Ynl0ZXMgKyB4c2tycV9zdGF0cy0+Ynl0ZXM7DQog
DQogCQlmb3IgKGogPSAwOyBqIDwgcHJpdi0+bWF4X29wZW5lZF90YzsgaisrKSB7DQogCQkJc3Ry
dWN0IG1seDVlX3NxX3N0YXRzICpzcV9zdGF0cyA9ICZjaGFubmVsX3N0YXRzLT5zcVtqXTsNCkBA
IC0zNDg5LDYgKzM1OTYsMTMgQEAgc3RhdGljIGludCBzZXRfZmVhdHVyZV9scm8oc3RydWN0IG5l
dF9kZXZpY2UgKm5ldGRldiwgYm9vbCBlbmFibGUpDQogDQogCW11dGV4X2xvY2soJnByaXYtPnN0
YXRlX2xvY2spOw0KIA0KKwlpZiAoZW5hYmxlICYmIHByaXYtPnhzay5yZWZjbnQpIHsNCisJCW5l
dGRldl93YXJuKG5ldGRldiwgIkxSTyBpcyBpbmNvbXBhdGlibGUgd2l0aCBBRl9YRFAgKCVodSBY
U0tzIGFyZSBhY3RpdmUpXG4iLA0KKwkJCSAgICBwcml2LT54c2sucmVmY250KTsNCisJCWVyciA9
IC1FSU5WQUw7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KIAlvbGRfcGFyYW1zID0gJnByaXYtPmNo
YW5uZWxzLnBhcmFtczsNCiAJaWYgKGVuYWJsZSAmJiAhTUxYNUVfR0VUX1BGTEFHKG9sZF9wYXJh
bXMsIE1MWDVFX1BGTEFHX1JYX1NUUklESU5HX1JRKSkgew0KIAkJbmV0ZGV2X3dhcm4obmV0ZGV2
LCAiY2FuJ3Qgc2V0IExSTyB3aXRoIGxlZ2FjeSBSUVxuIik7DQpAQCAtMzUwMiw4ICszNjE2LDgg
QEAgc3RhdGljIGludCBzZXRfZmVhdHVyZV9scm8oc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwg
Ym9vbCBlbmFibGUpDQogCW5ld19jaGFubmVscy5wYXJhbXMubHJvX2VuID0gZW5hYmxlOw0KIA0K
IAlpZiAob2xkX3BhcmFtcy0+cnFfd3FfdHlwZSAhPSBNTFg1X1dRX1RZUEVfQ1lDTElDKSB7DQot
CQlpZiAobWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBvbGRfcGFyYW1zKSA9PQ0K
LQkJICAgIG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgJm5ld19jaGFubmVscy5w
YXJhbXMpKQ0KKwkJaWYgKG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgb2xkX3Bh
cmFtcywgTlVMTCkgPT0NCisJCSAgICBtbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYs
ICZuZXdfY2hhbm5lbHMucGFyYW1zLCBOVUxMKSkNCiAJCQlyZXNldCA9IGZhbHNlOw0KIAl9DQog
DQpAQCAtMzY5NCw2ICszODA4LDQzIEBAIHN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdCBtbHg1ZV9m
aXhfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwNCiAJcmV0dXJuIGZlYXR1cmVz
Ow0KIH0NCiANCitzdGF0aWMgYm9vbCBtbHg1ZV94c2tfdmFsaWRhdGVfbXR1KHN0cnVjdCBuZXRf
ZGV2aWNlICpuZXRkZXYsDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9jaGFubmVscyAqY2hzLA0KKwkJ
CQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpuZXdfcGFyYW1zLA0KKwkJCQkgICBzdHJ1Y3QgbWx4
NV9jb3JlX2RldiAqbWRldikNCit7DQorCXUxNiBpeDsNCisNCisJZm9yIChpeCA9IDA7IGl4IDwg
Y2hzLT5wYXJhbXMubnVtX2NoYW5uZWxzOyBpeCsrKSB7DQorCQlzdHJ1Y3QgeGRwX3VtZW0gKnVt
ZW0gPSBtbHg1ZV94c2tfZ2V0X3VtZW0oJmNocy0+cGFyYW1zLCBjaHMtPnBhcmFtcy54c2ssIGl4
KTsNCisJCXN0cnVjdCBtbHg1ZV94c2tfcGFyYW0geHNrOw0KKw0KKwkJaWYgKCF1bWVtKQ0KKwkJ
CWNvbnRpbnVlOw0KKw0KKwkJbWx4NWVfYnVpbGRfeHNrX3BhcmFtKHVtZW0sICZ4c2spOw0KKw0K
KwkJaWYgKCFtbHg1ZV92YWxpZGF0ZV94c2tfcGFyYW0obmV3X3BhcmFtcywgJnhzaywgbWRldikp
IHsNCisJCQl1MzIgaHIgPSBtbHg1ZV9nZXRfbGluZWFyX3JxX2hlYWRyb29tKG5ld19wYXJhbXMs
ICZ4c2spOw0KKwkJCWludCBtYXhfbXR1X2ZyYW1lLCBtYXhfbXR1X3BhZ2UsIG1heF9tdHU7DQor
DQorCQkJLyogVHdvIGNyaXRlcmlhIG11c3QgYmUgbWV0Og0KKwkJCSAqIDEuIEhXIE1UVSArIGFs
bCBoZWFkcm9vbXMgPD0gWFNLIGZyYW1lIHNpemUuDQorCQkJICogMi4gU2l6ZSBvZiBTS0JzIGFs
bG9jYXRlZCBvbiBYRFBfUEFTUyA8PSBQQUdFX1NJWkUuDQorCQkJICovDQorCQkJbWF4X210dV9m
cmFtZSA9IE1MWDVFX0hXMlNXX01UVShuZXdfcGFyYW1zLCB4c2suY2h1bmtfc2l6ZSAtIGhyKTsN
CisJCQltYXhfbXR1X3BhZ2UgPSBtbHg1ZV94ZHBfbWF4X210dShuZXdfcGFyYW1zLCAmeHNrKTsN
CisJCQltYXhfbXR1ID0gbWluKG1heF9tdHVfZnJhbWUsIG1heF9tdHVfcGFnZSk7DQorDQorCQkJ
bmV0ZGV2X2VycihuZXRkZXYsICJNVFUgJWQgaXMgdG9vIGJpZyBmb3IgYW4gWFNLIHJ1bm5pbmcg
b24gY2hhbm5lbCAlaHUuIFRyeSBNVFUgPD0gJWRcbiIsDQorCQkJCSAgIG5ld19wYXJhbXMtPnN3
X210dSwgaXgsIG1heF9tdHUpOw0KKwkJCXJldHVybiBmYWxzZTsNCisJCX0NCisJfQ0KKw0KKwly
ZXR1cm4gdHJ1ZTsNCit9DQorDQogaW50IG1seDVlX2NoYW5nZV9tdHUoc3RydWN0IG5ldF9kZXZp
Y2UgKm5ldGRldiwgaW50IG5ld19tdHUsDQogCQkgICAgIGNoYW5nZV9od19tdHVfY2Igc2V0X210
dV9jYikNCiB7DQpAQCAtMzcxNCwxOCArMzg2NSwzMSBAQCBpbnQgbWx4NWVfY2hhbmdlX210dShz
dHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LCBpbnQgbmV3X210dSwNCiAJbmV3X2NoYW5uZWxzLnBh
cmFtcy5zd19tdHUgPSBuZXdfbXR1Ow0KIA0KIAlpZiAocGFyYW1zLT54ZHBfcHJvZyAmJg0KLQkg
ICAgIW1seDVlX3J4X2lzX2xpbmVhcl9za2IoJm5ld19jaGFubmVscy5wYXJhbXMpKSB7DQorCSAg
ICAhbWx4NWVfcnhfaXNfbGluZWFyX3NrYigmbmV3X2NoYW5uZWxzLnBhcmFtcywgTlVMTCkpIHsN
CiAJCW5ldGRldl9lcnIobmV0ZGV2LCAiTVRVKCVkKSA+ICVkIGlzIG5vdCBhbGxvd2VkIHdoaWxl
IFhEUCBlbmFibGVkXG4iLA0KIAkJCSAgIG5ld19tdHUsIG1seDVlX3hkcF9tYXhfbXR1KHBhcmFt
cywgTlVMTCkpOw0KIAkJZXJyID0gLUVJTlZBTDsNCiAJCWdvdG8gb3V0Ow0KIAl9DQogDQorCWlm
IChwcml2LT54c2sucmVmY250ICYmDQorCSAgICAhbWx4NWVfeHNrX3ZhbGlkYXRlX210dShuZXRk
ZXYsICZwcml2LT5jaGFubmVscywNCisJCQkJICAgICZuZXdfY2hhbm5lbHMucGFyYW1zLCBwcml2
LT5tZGV2KSkgew0KKwkJZXJyID0gLUVJTlZBTDsNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQogCWlm
IChwYXJhbXMtPnJxX3dxX3R5cGUgPT0gTUxYNV9XUV9UWVBFX0xJTktFRF9MSVNUX1NUUklESU5H
X1JRKSB7DQotCQlib29sIGlzX2xpbmVhciA9IG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2Io
cHJpdi0+bWRldiwgJm5ld19jaGFubmVscy5wYXJhbXMpOw0KLQkJdTggcHB3X29sZCA9IG1seDVl
X21wd3FlX2xvZ19wa3RzX3Blcl93cWUocGFyYW1zKTsNCi0JCXU4IHBwd19uZXcgPSBtbHg1ZV9t
cHdxZV9sb2dfcGt0c19wZXJfd3FlKCZuZXdfY2hhbm5lbHMucGFyYW1zKTsNCisJCWJvb2wgaXNf
bGluZWFyID0gbWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihwcml2LT5tZGV2LA0KKwkJCQkJ
CQkgICAgICAmbmV3X2NoYW5uZWxzLnBhcmFtcywNCisJCQkJCQkJICAgICAgTlVMTCk7DQorCQl1
OCBwcHdfb2xkID0gbWx4NWVfbXB3cWVfbG9nX3BrdHNfcGVyX3dxZShwYXJhbXMsIE5VTEwpOw0K
KwkJdTggcHB3X25ldyA9IG1seDVlX21wd3FlX2xvZ19wa3RzX3Blcl93cWUoJm5ld19jaGFubmVs
cy5wYXJhbXMsIE5VTEwpOw0KIA0KKwkJLyogSWYgWFNLIGlzIGFjdGl2ZSwgWFNLIFJRcyBhcmUg
bGluZWFyLiAqLw0KKwkJaXNfbGluZWFyIHw9IHByaXYtPnhzay5yZWZjbnQ7DQorDQorCQkvKiBB
bHdheXMgcmVzZXQgaW4gbGluZWFyIG1vZGUgLSBod19tdHUgaXMgdXNlZCBpbiBkYXRhIHBhdGgu
ICovDQogCQlyZXNldCA9IHJlc2V0ICYmIChpc19saW5lYXIgfHwgKHBwd19vbGQgIT0gcHB3X25l
dykpOw0KIAl9DQogDQpAQCAtNDE1OCw3ICs0MzIyLDEwIEBAIHN0YXRpYyBpbnQgbWx4NWVfeGRw
X2FsbG93ZWQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBicGZfcHJvZyAqcHJvZykN
CiAJbmV3X2NoYW5uZWxzLnBhcmFtcyA9IHByaXYtPmNoYW5uZWxzLnBhcmFtczsNCiAJbmV3X2No
YW5uZWxzLnBhcmFtcy54ZHBfcHJvZyA9IHByb2c7DQogDQotCWlmICghbWx4NWVfcnhfaXNfbGlu
ZWFyX3NrYigmbmV3X2NoYW5uZWxzLnBhcmFtcykpIHsNCisJLyogTm8gWFNLIHBhcmFtczogQUZf
WERQIGNhbid0IGJlIGVuYWJsZWQgeWV0IGF0IHRoZSBwb2ludCBvZiBzZXR0aW5nDQorCSAqIHRo
ZSBYRFAgcHJvZ3JhbS4NCisJICovDQorCWlmICghbWx4NWVfcnhfaXNfbGluZWFyX3NrYigmbmV3
X2NoYW5uZWxzLnBhcmFtcywgTlVMTCkpIHsNCiAJCW5ldGRldl93YXJuKG5ldGRldiwgIlhEUCBp
cyBub3QgYWxsb3dlZCB3aXRoIE1UVSglZCkgPiAlZFxuIiwNCiAJCQkgICAgbmV3X2NoYW5uZWxz
LnBhcmFtcy5zd19tdHUsDQogCQkJICAgIG1seDVlX3hkcF9tYXhfbXR1KCZuZXdfY2hhbm5lbHMu
cGFyYW1zLCBOVUxMKSk7DQpAQCAtNDE2OCw2ICs0MzM1LDE2IEBAIHN0YXRpYyBpbnQgbWx4NWVf
eGRwX2FsbG93ZWQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBicGZfcHJvZyAqcHJv
ZykNCiAJcmV0dXJuIDA7DQogfQ0KIA0KK3N0YXRpYyBpbnQgbWx4NWVfeGRwX3VwZGF0ZV9zdGF0
ZShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCit7DQorCWlmIChwcml2LT5jaGFubmVscy5wYXJh
bXMueGRwX3Byb2cpDQorCQltbHg1ZV94ZHBfc2V0X29wZW4ocHJpdik7DQorCWVsc2UNCisJCW1s
eDVlX3hkcF9zZXRfY2xvc2VkKHByaXYpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQogc3RhdGlj
IGludCBtbHg1ZV94ZHBfc2V0KHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsIHN0cnVjdCBicGZf
cHJvZyAqcHJvZykNCiB7DQogCXN0cnVjdCBtbHg1ZV9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYo
bmV0ZGV2KTsNCkBAIC00MjA3LDcgKzQzODQsNyBAQCBzdGF0aWMgaW50IG1seDVlX3hkcF9zZXQo
c3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgc3RydWN0IGJwZl9wcm9nICpwcm9nKQ0KIAkJbWx4
NWVfc2V0X3JxX3R5cGUocHJpdi0+bWRldiwgJm5ld19jaGFubmVscy5wYXJhbXMpOw0KIAkJb2xk
X3Byb2cgPSBwcml2LT5jaGFubmVscy5wYXJhbXMueGRwX3Byb2c7DQogDQotCQllcnIgPSBtbHg1
ZV9zYWZlX3N3aXRjaF9jaGFubmVscyhwcml2LCAmbmV3X2NoYW5uZWxzLCBOVUxMKTsNCisJCWVy
ciA9IG1seDVlX3NhZmVfc3dpdGNoX2NoYW5uZWxzKHByaXYsICZuZXdfY2hhbm5lbHMsIG1seDVl
X3hkcF91cGRhdGVfc3RhdGUpOw0KIAkJaWYgKGVycikNCiAJCQlnb3RvIHVubG9jazsNCiAJfSBl
bHNlIHsNCkBAIC00MjMxLDE5ICs0NDA4LDI5IEBAIHN0YXRpYyBpbnQgbWx4NWVfeGRwX3NldChz
dHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LCBzdHJ1Y3QgYnBmX3Byb2cgKnByb2cpDQogCSAqLw0K
IAlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+Y2hhbm5lbHMubnVtOyBpKyspIHsNCiAJCXN0cnVjdCBt
bHg1ZV9jaGFubmVsICpjID0gcHJpdi0+Y2hhbm5lbHMuY1tpXTsNCisJCWJvb2wgeHNrX29wZW4g
PSB0ZXN0X2JpdChNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywgYy0+c3RhdGUpOw0KIA0KIAkJY2xl
YXJfYml0KE1MWDVFX1JRX1NUQVRFX0VOQUJMRUQsICZjLT5ycS5zdGF0ZSk7DQorCQlpZiAoeHNr
X29wZW4pDQorCQkJY2xlYXJfYml0KE1MWDVFX1JRX1NUQVRFX0VOQUJMRUQsICZjLT54c2tycS5z
dGF0ZSk7DQogCQluYXBpX3N5bmNocm9uaXplKCZjLT5uYXBpKTsNCiAJCS8qIHByZXZlbnQgbWx4
NWVfcG9sbF9yeF9jcSBmcm9tIGFjY2Vzc2luZyBycS0+eGRwX3Byb2cgKi8NCiANCiAJCW9sZF9w
cm9nID0geGNoZygmYy0+cnEueGRwX3Byb2csIHByb2cpOw0KKwkJaWYgKG9sZF9wcm9nKQ0KKwkJ
CWJwZl9wcm9nX3B1dChvbGRfcHJvZyk7DQorDQorCQlpZiAoeHNrX29wZW4pIHsNCisJCQlvbGRf
cHJvZyA9IHhjaGcoJmMtPnhza3JxLnhkcF9wcm9nLCBwcm9nKTsNCisJCQlpZiAob2xkX3Byb2cp
DQorCQkJCWJwZl9wcm9nX3B1dChvbGRfcHJvZyk7DQorCQl9DQogDQogCQlzZXRfYml0KE1MWDVF
X1JRX1NUQVRFX0VOQUJMRUQsICZjLT5ycS5zdGF0ZSk7DQorCQlpZiAoeHNrX29wZW4pDQorCQkJ
c2V0X2JpdChNTFg1RV9SUV9TVEFURV9FTkFCTEVELCAmYy0+eHNrcnEuc3RhdGUpOw0KIAkJLyog
bmFwaV9zY2hlZHVsZSBpbiBjYXNlIHdlIGhhdmUgbWlzc2VkIGFueXRoaW5nICovDQogCQluYXBp
X3NjaGVkdWxlKCZjLT5uYXBpKTsNCi0NCi0JCWlmIChvbGRfcHJvZykNCi0JCQlicGZfcHJvZ19w
dXQob2xkX3Byb2cpOw0KIAl9DQogDQogdW5sb2NrOg0KQEAgLTQyNzQsNiArNDQ2MSw5IEBAIHN0
YXRpYyBpbnQgbWx4NWVfeGRwKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHN0cnVjdCBuZXRkZXZf
YnBmICp4ZHApDQogCWNhc2UgWERQX1FVRVJZX1BST0c6DQogCQl4ZHAtPnByb2dfaWQgPSBtbHg1
ZV94ZHBfcXVlcnkoZGV2KTsNCiAJCXJldHVybiAwOw0KKwljYXNlIFhEUF9TRVRVUF9YU0tfVU1F
TToNCisJCXJldHVybiBtbHg1ZV94c2tfc2V0dXBfdW1lbShkZXYsIHhkcC0+eHNrLnVtZW0sDQor
CQkJCQkgICAgeGRwLT54c2sucXVldWVfaWQpOw0KIAlkZWZhdWx0Og0KIAkJcmV0dXJuIC1FSU5W
QUw7DQogCX0NCkBAIC00MzU2LDYgKzQ1NDYsNyBAQCBjb25zdCBzdHJ1Y3QgbmV0X2RldmljZV9v
cHMgbWx4NWVfbmV0ZGV2X29wcyA9IHsNCiAJLm5kb190eF90aW1lb3V0ICAgICAgICAgID0gbWx4
NWVfdHhfdGltZW91dCwNCiAJLm5kb19icGYJCSA9IG1seDVlX3hkcCwNCiAJLm5kb194ZHBfeG1p
dCAgICAgICAgICAgID0gbWx4NWVfeGRwX3htaXQsDQorCS5uZG9feHNrX2FzeW5jX3htaXQgICAg
ICA9IG1seDVlX3hza19hc3luY194bWl0LA0KICNpZmRlZiBDT05GSUdfTUxYNV9FTl9BUkZTDQog
CS5uZG9fcnhfZmxvd19zdGVlcgkgPSBtbHg1ZV9yeF9mbG93X3N0ZWVyLA0KICNlbmRpZg0KQEAg
LTQ1MDcsMTEgKzQ2OTgsMTMgQEAgdm9pZCBtbHg1ZV9idWlsZF9ycV9wYXJhbXMoc3RydWN0IG1s
eDVfY29yZV9kZXYgKm1kZXYsDQogCSAqIC0gU3RyaWRpbmcgUlEgY29uZmlndXJhdGlvbiBpcyBu
b3QgcG9zc2libGUvc3VwcG9ydGVkLg0KIAkgKiAtIFNsb3cgUENJIGhldXJpc3RpYy4NCiAJICog
LSBMZWdhY3kgUlEgd291bGQgdXNlIGxpbmVhciBTS0Igd2hpbGUgU3RyaWRpbmcgUlEgd291bGQg
dXNlIG5vbi1saW5lYXIuDQorCSAqDQorCSAqIE5vIFhTSyBwYXJhbXM6IGNoZWNraW5nIHRoZSBh
dmFpbGFiaWxpdHkgb2Ygc3RyaWRpbmcgUlEgaW4gZ2VuZXJhbC4NCiAJICovDQogCWlmICghc2xv
d19wY2lfaGV1cmlzdGljKG1kZXYpICYmDQogCSAgICBtbHg1ZV9zdHJpZGluZ19ycV9wb3NzaWJs
ZShtZGV2LCBwYXJhbXMpICYmDQotCSAgICAobWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYiht
ZGV2LCBwYXJhbXMpIHx8DQotCSAgICAgIW1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1zKSkp
DQorCSAgICAobWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBwYXJhbXMsIE5VTEwp
IHx8DQorCSAgICAgIW1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1zLCBOVUxMKSkpDQogCQlN
TFg1RV9TRVRfUEZMQUcocGFyYW1zLCBNTFg1RV9QRkxBR19SWF9TVFJJRElOR19SUSwgdHJ1ZSk7
DQogCW1seDVlX3NldF9ycV90eXBlKG1kZXYsIHBhcmFtcyk7DQogCW1seDVlX2luaXRfcnFfdHlw
ZV9wYXJhbXMobWRldiwgcGFyYW1zKTsNCkBAIC00NTMzLDYgKzQ3MjYsNyBAQCB2b2lkIG1seDVl
X2J1aWxkX3Jzc19wYXJhbXMoc3RydWN0IG1seDVlX3Jzc19wYXJhbXMgKnJzc19wYXJhbXMsDQog
fQ0KIA0KIHZvaWQgbWx4NWVfYnVpbGRfbmljX3BhcmFtcyhzdHJ1Y3QgbWx4NV9jb3JlX2RldiAq
bWRldiwNCisJCQkgICAgc3RydWN0IG1seDVlX3hzayAqeHNrLA0KIAkJCSAgICBzdHJ1Y3QgbWx4
NWVfcnNzX3BhcmFtcyAqcnNzX3BhcmFtcywNCiAJCQkgICAgc3RydWN0IG1seDVlX3BhcmFtcyAq
cGFyYW1zLA0KIAkJCSAgICB1MTYgbWF4X2NoYW5uZWxzLCB1MTYgbXR1KQ0KQEAgLTQ1NjgsOSAr
NDc2MiwxMSBAQCB2b2lkIG1seDVlX2J1aWxkX25pY19wYXJhbXMoc3RydWN0IG1seDVfY29yZV9k
ZXYgKm1kZXYsDQogCS8qIEhXIExSTyAqLw0KIA0KIAkvKiBUT0RPOiAmJiBNTFg1X0NBUF9FVEgo
bWRldiwgbHJvX2NhcCkgKi8NCi0JaWYgKHBhcmFtcy0+cnFfd3FfdHlwZSA9PSBNTFg1X1dRX1RZ
UEVfTElOS0VEX0xJU1RfU1RSSURJTkdfUlEpDQotCQlpZiAoIW1seDVlX3J4X21wd3FlX2lzX2xp
bmVhcl9za2IobWRldiwgcGFyYW1zKSkNCisJaWYgKHBhcmFtcy0+cnFfd3FfdHlwZSA9PSBNTFg1
X1dRX1RZUEVfTElOS0VEX0xJU1RfU1RSSURJTkdfUlEpIHsNCisJCS8qIE5vIFhTSyBwYXJhbXM6
IGNoZWNraW5nIHRoZSBhdmFpbGFiaWxpdHkgb2Ygc3RyaWRpbmcgUlEgaW4gZ2VuZXJhbC4gKi8N
CisJCWlmICghbWx4NWVfcnhfbXB3cWVfaXNfbGluZWFyX3NrYihtZGV2LCBwYXJhbXMsIE5VTEwp
KQ0KIAkJCXBhcmFtcy0+bHJvX2VuID0gIXNsb3dfcGNpX2hldXJpc3RpYyhtZGV2KTsNCisJfQ0K
IAlwYXJhbXMtPmxyb190aW1lb3V0ID0gbWx4NWVfY2hvb3NlX2xyb190aW1lb3V0KG1kZXYsIE1M
WDVFX0RFRkFVTFRfTFJPX1RJTUVPVVQpOw0KIA0KIAkvKiBDUSBtb2RlcmF0aW9uIHBhcmFtcyAq
Lw0KQEAgLTQ1ODksNiArNDc4NSw5IEBAIHZvaWQgbWx4NWVfYnVpbGRfbmljX3BhcmFtcyhzdHJ1
Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCiAJbWx4NWVfYnVpbGRfcnNzX3BhcmFtcyhyc3NfcGFy
YW1zLCBwYXJhbXMtPm51bV9jaGFubmVscyk7DQogCXBhcmFtcy0+dHVubmVsZWRfb2ZmbG9hZF9l
biA9DQogCQltbHg1ZV90dW5uZWxfaW5uZXJfZnRfc3VwcG9ydGVkKG1kZXYpOw0KKw0KKwkvKiBB
Rl9YRFAgKi8NCisJcGFyYW1zLT54c2sgPSB4c2s7DQogfQ0KIA0KIHN0YXRpYyB2b2lkIG1seDVl
X3NldF9uZXRkZXZfZGV2X2FkZHIoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldikNCkBAIC00NzYx
LDcgKzQ5NjAsNyBAQCBzdGF0aWMgaW50IG1seDVlX25pY19pbml0KHN0cnVjdCBtbHg1X2NvcmVf
ZGV2ICptZGV2LA0KIAlpZiAoZXJyKQ0KIAkJcmV0dXJuIGVycjsNCiANCi0JbWx4NWVfYnVpbGRf
bmljX3BhcmFtcyhtZGV2LCByc3MsICZwcml2LT5jaGFubmVscy5wYXJhbXMsDQorCW1seDVlX2J1
aWxkX25pY19wYXJhbXMobWRldiwgJnByaXYtPnhzaywgcnNzLCAmcHJpdi0+Y2hhbm5lbHMucGFy
YW1zLA0KIAkJCSAgICAgICBtbHg1ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhuZXRkZXYpLA0K
IAkJCSAgICAgICBuZXRkZXYtPm10dSk7DQogDQpAQCAtNDgwMyw3ICs1MDAyLDcgQEAgc3RhdGlj
IGludCBtbHg1ZV9pbml0X25pY19yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiAJaWYgKGVy
cikNCiAJCWdvdG8gZXJyX2Nsb3NlX2Ryb3BfcnE7DQogDQotCWVyciA9IG1seDVlX2NyZWF0ZV9k
aXJlY3RfcnF0cyhwcml2KTsNCisJZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF9ycXRzKHByaXYs
IHByaXYtPmRpcmVjdF90aXIpOw0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZGVzdHJveV9pbmRp
cmVjdF9ycXRzOw0KIA0KQEAgLTQ4MTEsMTQgKzUwMTAsMjIgQEAgc3RhdGljIGludCBtbHg1ZV9p
bml0X25pY19yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiAJaWYgKGVycikNCiAJCWdvdG8g
ZXJyX2Rlc3Ryb3lfZGlyZWN0X3JxdHM7DQogDQotCWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3Rf
dGlycyhwcml2KTsNCisJZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHByaXYsIHByaXYt
PmRpcmVjdF90aXIpOw0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZGVzdHJveV9pbmRpcmVjdF90
aXJzOw0KIA0KKwllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3JxdHMocHJpdiwgcHJpdi0+eHNr
X3Rpcik7DQorCWlmICh1bmxpa2VseShlcnIpKQ0KKwkJZ290byBlcnJfZGVzdHJveV9kaXJlY3Rf
dGlyczsNCisNCisJZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHByaXYsIHByaXYtPnhz
a190aXIpOw0KKwlpZiAodW5saWtlbHkoZXJyKSkNCisJCWdvdG8gZXJyX2Rlc3Ryb3lfeHNrX3Jx
dHM7DQorDQogCWVyciA9IG1seDVlX2NyZWF0ZV9mbG93X3N0ZWVyaW5nKHByaXYpOw0KIAlpZiAo
ZXJyKSB7DQogCQltbHg1X2NvcmVfd2FybihtZGV2LCAiY3JlYXRlIGZsb3cgc3RlZXJpbmcgZmFp
bGVkLCAlZFxuIiwgZXJyKTsNCi0JCWdvdG8gZXJyX2Rlc3Ryb3lfZGlyZWN0X3RpcnM7DQorCQln
b3RvIGVycl9kZXN0cm95X3hza190aXJzOw0KIAl9DQogDQogCWVyciA9IG1seDVlX3RjX25pY19p
bml0KHByaXYpOw0KQEAgLTQ4MjksMTIgKzUwMzYsMTYgQEAgc3RhdGljIGludCBtbHg1ZV9pbml0
X25pY19yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiANCiBlcnJfZGVzdHJveV9mbG93X3N0
ZWVyaW5nOg0KIAltbHg1ZV9kZXN0cm95X2Zsb3dfc3RlZXJpbmcocHJpdik7DQorZXJyX2Rlc3Ry
b3lfeHNrX3RpcnM6DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+eHNr
X3Rpcik7DQorZXJyX2Rlc3Ryb3lfeHNrX3JxdHM6DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3Jx
dHMocHJpdiwgcHJpdi0+eHNrX3Rpcik7DQogZXJyX2Rlc3Ryb3lfZGlyZWN0X3RpcnM6DQotCW1s
eDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdik7DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3Rp
cnMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogZXJyX2Rlc3Ryb3lfaW5kaXJlY3RfdGlyczoN
CiAJbWx4NWVfZGVzdHJveV9pbmRpcmVjdF90aXJzKHByaXYsIHRydWUpOw0KIGVycl9kZXN0cm95
X2RpcmVjdF9ycXRzOg0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYpOw0KKwltbHg1
ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYsIHByaXYtPmRpcmVjdF90aXIpOw0KIGVycl9kZXN0
cm95X2luZGlyZWN0X3JxdHM6DQogCW1seDVlX2Rlc3Ryb3lfcnF0KHByaXYsICZwcml2LT5pbmRp
cl9ycXQpOw0KIGVycl9jbG9zZV9kcm9wX3JxOg0KQEAgLTQ4NDgsOSArNTA1OSwxMSBAQCBzdGF0
aWMgdm9pZCBtbHg1ZV9jbGVhbnVwX25pY19yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiB7
DQogCW1seDVlX3RjX25pY19jbGVhbnVwKHByaXYpOw0KIAltbHg1ZV9kZXN0cm95X2Zsb3dfc3Rl
ZXJpbmcocHJpdik7DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdik7DQorCW1seDVl
X2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+eHNrX3Rpcik7DQorCW1seDVlX2Rlc3Ry
b3lfZGlyZWN0X3JxdHMocHJpdiwgcHJpdi0+eHNrX3Rpcik7DQorCW1seDVlX2Rlc3Ryb3lfZGly
ZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogCW1seDVlX2Rlc3Ryb3lfaW5kaXJl
Y3RfdGlycyhwcml2LCB0cnVlKTsNCi0JbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhwcml2KTsN
CisJbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiAJ
bWx4NWVfZGVzdHJveV9ycXQocHJpdiwgJnByaXYtPmluZGlyX3JxdCk7DQogCW1seDVlX2Nsb3Nl
X2Ryb3BfcnEoJnByaXYtPmRyb3BfcnEpOw0KIAltbHg1ZV9kZXN0cm95X3FfY291bnRlcnMocHJp
dik7DQpAQCAtNTAwMCw3ICs1MjEzLDcgQEAgc3RydWN0IG5ldF9kZXZpY2UgKm1seDVlX2NyZWF0
ZV9uZXRkZXYoc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYsDQogDQogCW5ldGRldiA9IGFsbG9j
X2V0aGVyZGV2X21xcyhzaXplb2Yoc3RydWN0IG1seDVlX3ByaXYpLA0KIAkJCQkgICAgbmNoICog
cHJvZmlsZS0+bWF4X3RjLA0KLQkJCQkgICAgbmNoKTsNCisJCQkJICAgIG5jaCAqIE1MWDVFX05V
TV9SUV9HUk9VUFMpOw0KIAlpZiAoIW5ldGRldikgew0KIAkJbWx4NV9jb3JlX2VycihtZGV2LCAi
YWxsb2NfZXRoZXJkZXZfbXFzKCkgZmFpbGVkXG4iKTsNCiAJCXJldHVybiBOVUxMOw0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuYyBi
L2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuYw0KaW5kZXgg
OWFlYTljNWIyY2U4Li4zYjE4MjNmY2Y0YjUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhl
cm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fcmVwLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuYw0KQEAgLTE1MjgsNyArMTUyOCw3IEBAIHN0
YXRpYyBpbnQgbWx4NWVfaW5pdF9yZXBfcngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCWlm
IChlcnIpDQogCQlnb3RvIGVycl9jbG9zZV9kcm9wX3JxOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVh
dGVfZGlyZWN0X3JxdHMocHJpdik7DQorCWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhw
cml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiAJaWYgKGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lf
aW5kaXJlY3RfcnF0czsNCiANCkBAIC0xNTM2LDcgKzE1MzYsNyBAQCBzdGF0aWMgaW50IG1seDVl
X2luaXRfcmVwX3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlpZiAoZXJyKQ0KIAkJZ290
byBlcnJfZGVzdHJveV9kaXJlY3RfcnF0czsNCiANCi0JZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVj
dF90aXJzKHByaXYpOw0KKwllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMocHJpdiwgcHJp
di0+ZGlyZWN0X3Rpcik7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9kZXN0cm95X2luZGlyZWN0
X3RpcnM7DQogDQpAQCAtMTU1MywxMSArMTU1MywxMSBAQCBzdGF0aWMgaW50IG1seDVlX2luaXRf
cmVwX3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIGVycl9kZXN0cm95X3R0Y190YWJsZToN
CiAJbWx4NWVfZGVzdHJveV90dGNfdGFibGUocHJpdiwgJnByaXYtPmZzLnR0Yyk7DQogZXJyX2Rl
c3Ryb3lfZGlyZWN0X3RpcnM6DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdik7DQor
CW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogZXJy
X2Rlc3Ryb3lfaW5kaXJlY3RfdGlyczoNCiAJbWx4NWVfZGVzdHJveV9pbmRpcmVjdF90aXJzKHBy
aXYsIGZhbHNlKTsNCiBlcnJfZGVzdHJveV9kaXJlY3RfcnF0czoNCi0JbWx4NWVfZGVzdHJveV9k
aXJlY3RfcnF0cyhwcml2KTsNCisJbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhwcml2LCBwcml2
LT5kaXJlY3RfdGlyKTsNCiBlcnJfZGVzdHJveV9pbmRpcmVjdF9ycXRzOg0KIAltbHg1ZV9kZXN0
cm95X3JxdChwcml2LCAmcHJpdi0+aW5kaXJfcnF0KTsNCiBlcnJfY2xvc2VfZHJvcF9ycToNCkBA
IC0xNTcxLDkgKzE1NzEsOSBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9jbGVhbnVwX3JlcF9yeChzdHJ1
Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiANCiAJbWx4NV9kZWxfZmxvd19ydWxlcyhycHJpdi0+dnBv
cnRfcnhfcnVsZSk7DQogCW1seDVlX2Rlc3Ryb3lfdHRjX3RhYmxlKHByaXYsICZwcml2LT5mcy50
dGMpOw0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYpOw0KKwltbHg1ZV9kZXN0cm95
X2RpcmVjdF90aXJzKHByaXYsIHByaXYtPmRpcmVjdF90aXIpOw0KIAltbHg1ZV9kZXN0cm95X2lu
ZGlyZWN0X3RpcnMocHJpdiwgZmFsc2UpOw0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHBy
aXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYsIHByaXYtPmRpcmVjdF90aXIp
Ow0KIAltbHg1ZV9kZXN0cm95X3JxdChwcml2LCAmcHJpdi0+aW5kaXJfcnF0KTsNCiAJbWx4NWVf
Y2xvc2VfZHJvcF9ycSgmcHJpdi0+ZHJvcF9ycSk7DQogfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yeC5jIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3J4LmMNCmluZGV4IDVkNzYyZGE2YmY5Yi4uOWVl
ZGM2NzkzOTg0IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4
NS9jb3JlL2VuX3J4LmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUv
Y29yZS9lbl9yeC5jDQpAQCAtNDYsNiArNDYsNyBAQA0KICNpbmNsdWRlICJlbl9hY2NlbC90bHNf
cnh0eC5oIg0KICNpbmNsdWRlICJsaWIvY2xvY2suaCINCiAjaW5jbHVkZSAiZW4veGRwLmgiDQor
I2luY2x1ZGUgImVuL3hzay9yeC5oIg0KIA0KIHN0YXRpYyBpbmxpbmUgYm9vbCBtbHg1ZV9yeF9o
d19zdGFtcChzdHJ1Y3QgaHd0c3RhbXBfY29uZmlnICpjb25maWcpDQogew0KQEAgLTIzNCw4ICsy
MzUsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgbWx4NWVfcnhfY2FjaGVfZ2V0KHN0cnVjdCBtbHg1
ZV9ycSAqcnEsDQogCXJldHVybiB0cnVlOw0KIH0NCiANCi1zdGF0aWMgaW5saW5lIGludCBtbHg1
ZV9wYWdlX2FsbG9jX21hcHBlZChzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KLQkJCQkJICBzdHJ1Y3Qg
bWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvKQ0KK3N0YXRpYyBpbmxpbmUgaW50IG1seDVlX3BhZ2Vf
YWxsb2NfcG9vbChzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQkJc3RydWN0IG1seDVlX2RtYV9p
bmZvICpkbWFfaW5mbykNCiB7DQogCWlmIChtbHg1ZV9yeF9jYWNoZV9nZXQocnEsIGRtYV9pbmZv
KSkNCiAJCXJldHVybiAwOw0KQEAgLTI1NSwxMyArMjU2LDIzIEBAIHN0YXRpYyBpbmxpbmUgaW50
IG1seDVlX3BhZ2VfYWxsb2NfbWFwcGVkKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQogCXJldHVybiAw
Ow0KIH0NCiANCitzdGF0aWMgaW5saW5lIGludCBtbHg1ZV9wYWdlX2FsbG9jKHN0cnVjdCBtbHg1
ZV9ycSAqcnEsDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8pDQorew0K
KwlpZiAocnEtPnVtZW0pDQorCQlyZXR1cm4gbWx4NWVfeHNrX3BhZ2VfYWxsb2NfdW1lbShycSwg
ZG1hX2luZm8pOw0KKwllbHNlDQorCQlyZXR1cm4gbWx4NWVfcGFnZV9hbGxvY19wb29sKHJxLCBk
bWFfaW5mbyk7DQorfQ0KKw0KIHZvaWQgbWx4NWVfcGFnZV9kbWFfdW5tYXAoc3RydWN0IG1seDVl
X3JxICpycSwgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbykNCiB7DQogCWRtYV91bm1h
cF9wYWdlKHJxLT5wZGV2LCBkbWFfaW5mby0+YWRkciwgUEFHRV9TSVpFLCBycS0+YnVmZi5tYXBf
ZGlyKTsNCiB9DQogDQotdm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2Uoc3RydWN0IG1seDVlX3JxICpy
cSwgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbywNCi0JCQlib29sIHJlY3ljbGUpDQor
dm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2VfZHluYW1pYyhzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJ
CQlzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0KKwkJCQlib29sIHJlY3ljbGUpDQog
ew0KIAlpZiAobGlrZWx5KHJlY3ljbGUpKSB7DQogCQlpZiAobWx4NWVfcnhfY2FjaGVfcHV0KHJx
LCBkbWFfaW5mbykpDQpAQCAtMjc1LDYgKzI4NiwyMCBAQCB2b2lkIG1seDVlX3BhZ2VfcmVsZWFz
ZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0K
IAl9DQogfQ0KIA0KK3N0YXRpYyBpbmxpbmUgdm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2Uoc3RydWN0
IG1seDVlX3JxICpycSwNCisJCQkJICAgICAgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5m
bywNCisJCQkJICAgICAgYm9vbCByZWN5Y2xlKQ0KK3sNCisJaWYgKHJxLT51bWVtKQ0KKwkJLyog
VGhlIGByZWN5Y2xlYCBwYXJhbWV0ZXIgaXMgaWdub3JlZCwgYW5kIHRoZSBwYWdlIGlzIGFsd2F5
cw0KKwkJICogcHV0IGludG8gdGhlIFJldXNlIFJpbmcsIGJlY2F1c2UgdGhlcmUgaXMgbm8gd2F5
IHRvIHJldHVybg0KKwkJICogdGhlIHBhZ2UgdG8gdGhlIHVzZXJzcGFjZSB3aGVuIHRoZSBpbnRl
cmZhY2UgZ29lcyBkb3duLg0KKwkJICovDQorCQltbHg1ZV94c2tfcGFnZV9yZWxlYXNlKHJxLCBk
bWFfaW5mbyk7DQorCWVsc2UNCisJCW1seDVlX3BhZ2VfcmVsZWFzZV9keW5hbWljKHJxLCBkbWFf
aW5mbywgcmVjeWNsZSk7DQorfQ0KKw0KIHN0YXRpYyBpbmxpbmUgaW50IG1seDVlX2dldF9yeF9m
cmFnKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQogCQkJCSAgICBzdHJ1Y3QgbWx4NWVfd3FlX2ZyYWdf
aW5mbyAqZnJhZykNCiB7DQpAQCAtMjg2LDcgKzMxMSw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IG1s
eDVlX2dldF9yeF9mcmFnKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQogCQkgKiBvZmZzZXQpIHNob3Vs
ZCBqdXN0IHVzZSB0aGUgbmV3IG9uZSB3aXRob3V0IHJlcGxlbmlzaGluZyBhZ2Fpbg0KIAkJICog
YnkgdGhlbXNlbHZlcy4NCiAJCSAqLw0KLQkJZXJyID0gbWx4NWVfcGFnZV9hbGxvY19tYXBwZWQo
cnEsIGZyYWctPmRpKTsNCisJCWVyciA9IG1seDVlX3BhZ2VfYWxsb2MocnEsIGZyYWctPmRpKTsN
CiANCiAJcmV0dXJuIGVycjsNCiB9DQpAQCAtMzUyLDYgKzM3NywxMyBAQCBzdGF0aWMgaW50IG1s
eDVlX2FsbG9jX3J4X3dxZXMoc3RydWN0IG1seDVlX3JxICpycSwgdTE2IGl4LCB1OCB3cWVfYnVs
aykNCiAJaW50IGVycjsNCiAJaW50IGk7DQogDQorCWlmIChycS0+dW1lbSkgew0KKwkJaW50IHBh
Z2VzX2Rlc2lyZWQgPSB3cWVfYnVsayA8PCBycS0+d3FlLmluZm8ubG9nX251bV9mcmFnczsNCisN
CisJCWlmICh1bmxpa2VseSghbWx4NWVfeHNrX3BhZ2VzX2Vub3VnaF91bWVtKHJxLCBwYWdlc19k
ZXNpcmVkKSkpDQorCQkJcmV0dXJuIC1FTk9NRU07DQorCX0NCisNCiAJZm9yIChpID0gMDsgaSA8
IHdxZV9idWxrOyBpKyspIHsNCiAJCXN0cnVjdCBtbHg1ZV9yeF93cWVfY3ljICp3cWUgPSBtbHg1
X3dxX2N5Y19nZXRfd3FlKHdxLCBpeCArIGkpOw0KIA0KQEAgLTM5OSwxMSArNDMxLDE3IEBAIG1s
eDVlX2NvcHlfc2tiX2hlYWRlcihzdHJ1Y3QgZGV2aWNlICpwZGV2LCBzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLA0KIHN0YXRpYyB2b2lkDQogbWx4NWVfZnJlZV9yeF9tcHdxZShzdHJ1Y3QgbWx4NWVfcnEg
KnJxLCBzdHJ1Y3QgbWx4NWVfbXB3X2luZm8gKndpLCBib29sIHJlY3ljbGUpDQogew0KLQljb25z
dCBib29sIG5vX3hkcF94bWl0ID0NCi0JCWJpdG1hcF9lbXB0eSh3aS0+eGRwX3htaXRfYml0bWFw
LCBNTFg1X01QV1JRX1BBR0VTX1BFUl9XUUUpOw0KKwlib29sIG5vX3hkcF94bWl0Ow0KIAlzdHJ1
Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvID0gd2ktPnVtci5kbWFfaW5mbzsNCiAJaW50IGk7
DQogDQorCS8qIEEgY29tbW9uIGNhc2UgZm9yIEFGX1hEUC4gKi8NCisJaWYgKGJpdG1hcF9mdWxs
KHdpLT54ZHBfeG1pdF9iaXRtYXAsIE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSkpDQorCQlyZXR1
cm47DQorDQorCW5vX3hkcF94bWl0ID0gYml0bWFwX2VtcHR5KHdpLT54ZHBfeG1pdF9iaXRtYXAs
DQorCQkJCSAgIE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSk7DQorDQogCWZvciAoaSA9IDA7IGkg
PCBNTFg1X01QV1JRX1BBR0VTX1BFUl9XUUU7IGkrKykNCiAJCWlmIChub194ZHBfeG1pdCB8fCAh
dGVzdF9iaXQoaSwgd2ktPnhkcF94bWl0X2JpdG1hcCkpDQogCQkJbWx4NWVfcGFnZV9yZWxlYXNl
KHJxLCAmZG1hX2luZm9baV0sIHJlY3ljbGUpOw0KQEAgLTQ1Miw2ICs0OTAsMTIgQEAgc3RhdGlj
IGludCBtbHg1ZV9hbGxvY19yeF9tcHdxZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCB1MTYgaXgpDQog
CWludCBlcnI7DQogCWludCBpOw0KIA0KKwlpZiAocnEtPnVtZW0gJiYNCisJICAgIHVubGlrZWx5
KCFtbHg1ZV94c2tfcGFnZXNfZW5vdWdoX3VtZW0ocnEsIE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dR
RSkpKSB7DQorCQllcnIgPSAtRU5PTUVNOw0KKwkJZ290byBlcnI7DQorCX0NCisNCiAJcGkgPSBt
bHg1X3dxX2N5Y19jdHIyaXgod3EsIHNxLT5wYyk7DQogCWNvbnRpZ193cWViYnNfcm9vbSA9IG1s
eDVfd3FfY3ljX2dldF9jb250aWdfd3FlYmJzKHdxLCBwaSk7DQogCWlmICh1bmxpa2VseShjb250
aWdfd3FlYmJzX3Jvb20gPCBNTFg1RV9VTVJfV1FFQkJTKSkgew0KQEAgLTQ2Myw3ICs1MDcsNyBA
QCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3J4X21wd3FlKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHUx
NiBpeCkNCiAJbWVtY3B5KHVtcl93cWUsICZycS0+bXB3cWUudW1yX3dxZSwgb2Zmc2V0b2Yoc3Ry
dWN0IG1seDVlX3Vtcl93cWUsIGlubGluZV9tdHRzKSk7DQogDQogCWZvciAoaSA9IDA7IGkgPCBN
TFg1X01QV1JRX1BBR0VTX1BFUl9XUUU7IGkrKywgZG1hX2luZm8rKykgew0KLQkJZXJyID0gbWx4
NWVfcGFnZV9hbGxvY19tYXBwZWQocnEsIGRtYV9pbmZvKTsNCisJCWVyciA9IG1seDVlX3BhZ2Vf
YWxsb2MocnEsIGRtYV9pbmZvKTsNCiAJCWlmICh1bmxpa2VseShlcnIpKQ0KIAkJCWdvdG8gZXJy
X3VubWFwOw0KIAkJdW1yX3dxZS0+aW5saW5lX210dHNbaV0ucHRhZyA9IGNwdV90b19iZTY0KGRt
YV9pbmZvLT5hZGRyIHwgTUxYNV9FTl9XUik7DQpAQCAtNDkwLDYgKzUzNCw4IEBAIHN0YXRpYyBp
bnQgbWx4NWVfYWxsb2NfcnhfbXB3cWUoc3RydWN0IG1seDVlX3JxICpycSwgdTE2IGl4KQ0KIAkJ
ZG1hX2luZm8tLTsNCiAJCW1seDVlX3BhZ2VfcmVsZWFzZShycSwgZG1hX2luZm8sIHRydWUpOw0K
IAl9DQorDQorZXJyOg0KIAlycS0+c3RhdHMtPmJ1ZmZfYWxsb2NfZXJyKys7DQogDQogCXJldHVy
biBlcnI7DQpAQCAtNjAzLDYgKzY0OSw3IEBAIGJvb2wgbWx4NWVfcG9zdF9yeF9tcHdxZXMoc3Ry
dWN0IG1seDVlX3JxICpycSkNCiAJc3RydWN0IG1seDVlX2ljb3NxICpzcSA9ICZycS0+Y2hhbm5l
bC0+aWNvc3E7DQogCXN0cnVjdCBtbHg1X3dxX2xsICp3cSA9ICZycS0+bXB3cWUud3E7DQogCXU4
ICB1bXJfY29tcGxldGVkID0gcnEtPm1wd3FlLnVtcl9jb21wbGV0ZWQ7DQorCWludCBhbGxvY19l
cnIgPSAwOw0KIAl1OCAgbWlzc2luZywgaTsNCiAJdTE2IGhlYWQ7DQogDQpAQCAtNjI3LDcgKzY3
NCw5IEBAIGJvb2wgbWx4NWVfcG9zdF9yeF9tcHdxZXMoc3RydWN0IG1seDVlX3JxICpycSkNCiAJ
aGVhZCA9IHJxLT5tcHdxZS5hY3R1YWxfd3FfaGVhZDsNCiAJaSA9IG1pc3Npbmc7DQogCWRvIHsN
Ci0JCWlmICh1bmxpa2VseShtbHg1ZV9hbGxvY19yeF9tcHdxZShycSwgaGVhZCkpKQ0KKwkJYWxs
b2NfZXJyID0gbWx4NWVfYWxsb2NfcnhfbXB3cWUocnEsIGhlYWQpOw0KKw0KKwkJaWYgKHVubGlr
ZWx5KGFsbG9jX2VycikpDQogCQkJYnJlYWs7DQogCQloZWFkID0gbWx4NV93cV9sbF9nZXRfd3Fl
X25leHRfaXgod3EsIGhlYWQpOw0KIAl9IHdoaWxlICgtLWkpOw0KQEAgLTY0MSw2ICs2OTAsMTIg
QEAgYm9vbCBtbHg1ZV9wb3N0X3J4X21wd3FlcyhzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIAlycS0+
bXB3cWUudW1yX2luX3Byb2dyZXNzICs9IHJxLT5tcHdxZS51bXJfbGFzdF9idWxrOw0KIAlycS0+
bXB3cWUuYWN0dWFsX3dxX2hlYWQgICA9IGhlYWQ7DQogDQorCS8qIElmIFhTSyBGaWxsIFJpbmcg
ZG9lc24ndCBoYXZlIGVub3VnaCBmcmFtZXMsIGJ1c3kgcG9sbCBieQ0KKwkgKiByZXNjaGVkdWxp
bmcgdGhlIE5BUEkgcG9sbC4NCisJICovDQorCWlmICh1bmxpa2VseShhbGxvY19lcnIgPT0gLUVO
T01FTSAmJiBycS0+dW1lbSkpDQorCQlyZXR1cm4gdHJ1ZTsNCisNCiAJcmV0dXJuIGZhbHNlOw0K
IH0NCiANCkBAIC0xMDA5LDcgKzEwNjQsNyBAQCBtbHg1ZV9za2JfZnJvbV9jcWVfbGluZWFyKHN0
cnVjdCBtbHg1ZV9ycSAqcnEsIHN0cnVjdCBtbHg1X2NxZTY0ICpjcWUsDQogCX0NCiANCiAJcmN1
X3JlYWRfbG9jaygpOw0KLQljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2YSwg
JnJ4X2hlYWRyb29tLCAmY3FlX2JjbnQpOw0KKwljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUo
cnEsIGRpLCB2YSwgJnJ4X2hlYWRyb29tLCAmY3FlX2JjbnQsIGZhbHNlKTsNCiAJcmN1X3JlYWRf
dW5sb2NrKCk7DQogCWlmIChjb25zdW1lZCkNCiAJCXJldHVybiBOVUxMOyAvKiBwYWdlL3BhY2tl
dCB3YXMgY29uc3VtZWQgYnkgWERQICovDQpAQCAtMTIyMyw3ICsxMjc4LDcgQEAgbWx4NWVfc2ti
X2Zyb21fY3FlX21wd3JxX2xpbmVhcihzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVf
bXB3X2luZm8gKndpLA0KIAlwcmVmZXRjaChkYXRhKTsNCiANCiAJcmN1X3JlYWRfbG9jaygpOw0K
LQljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2YSwgJnJ4X2hlYWRyb29tLCAm
Y3FlX2JjbnQzMik7DQorCWNvbnN1bWVkID0gbWx4NWVfeGRwX2hhbmRsZShycSwgZGksIHZhLCAm
cnhfaGVhZHJvb20sICZjcWVfYmNudDMyLCBmYWxzZSk7DQogCXJjdV9yZWFkX3VubG9jaygpOw0K
IAlpZiAoY29uc3VtZWQpIHsNCiAJCWlmIChfX3Rlc3RfYW5kX2NsZWFyX2JpdChNTFg1RV9SUV9G
TEFHX1hEUF9YTUlULCBycS0+ZmxhZ3MpKQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0cy5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0YXRzLmMNCmluZGV4IDQ4M2QzMjFkMjE1MS4uNWY1NDBk
YjQ3Y2M5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9j
b3JlL2VuX3N0YXRzLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUv
Y29yZS9lbl9zdGF0cy5jDQpAQCAtMTA0LDcgKzEwNCwzMyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IGNvdW50ZXJfZGVzYyBzd19zdGF0c19kZXNjW10gPSB7DQogCXsgTUxYNUVfREVDTEFSRV9TVEFU
KHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgY2hfcG9sbCkgfSwNCiAJeyBNTFg1RV9ERUNMQVJFX1NU
QVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCBjaF9hcm0pIH0sDQogCXsgTUxYNUVfREVDTEFSRV9T
VEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgY2hfYWZmX2NoYW5nZSkgfSwNCisJeyBNTFg1RV9E
RUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCBjaF9mb3JjZV9pcnEpIH0sDQogCXsg
TUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgY2hfZXFfcmVhcm0pIH0s
DQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX3Bh
Y2tldHMpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywg
cnhfeHNrX2J5dGVzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3df
c3RhdHMsIHJ4X3hza19jc3VtX2NvbXBsZXRlKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChz
dHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19jc3VtX3VubmVjZXNzYXJ5KSB9LA0KKwl7IE1M
WDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19jc3VtX3VubmVj
ZXNzYXJ5X2lubmVyKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3df
c3RhdHMsIHJ4X3hza19jc3VtX25vbmUpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVj
dCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2Vjbl9tYXJrKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVf
U1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19yZW1vdmVkX3ZsYW5fcGFja2V0cykg
fSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCByeF94c2tf
eGRwX2Ryb3ApIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0
cywgcnhfeHNrX3hkcF9yZWRpcmVjdCkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0
IG1seDVlX3N3X3N0YXRzLCByeF94c2tfd3FlX2VycikgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NU
QVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCByeF94c2tfbXB3cWVfZmlsbGVyX2NxZXMpIH0sDQor
CXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX21wd3Fl
X2ZpbGxlcl9zdHJpZGVzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVf
c3dfc3RhdHMsIHJ4X3hza19vdmVyc2l6ZV9wa3RzX3N3X2Ryb3ApIH0sDQorCXsgTUxYNUVfREVD
TEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2J1ZmZfYWxsb2NfZXJyKSB9
LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19j
cWVfY29tcHJlc3NfYmxrcykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVl
X3N3X3N0YXRzLCByeF94c2tfY3FlX2NvbXByZXNzX3BrdHMpIH0sDQorCXsgTUxYNUVfREVDTEFS
RV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2NvbmdzdF91bXIpIH0sDQorCXsg
TUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2FyZnNfZXJy
KSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHR4X3hz
a194bWl0KSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMs
IHR4X3hza19tcHdxZSkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3
X3N0YXRzLCB0eF94c2tfaW5sbncpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBt
bHg1ZV9zd19zdGF0cywgdHhfeHNrX2Z1bGwpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0
cnVjdCBtbHg1ZV9zd19zdGF0cywgdHhfeHNrX2VycikgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NU
QVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCB0eF94c2tfY3FlcykgfSwNCiB9Ow0KIA0KICNkZWZp
bmUgTlVNX1NXX0NPVU5URVJTCQkJQVJSQVlfU0laRShzd19zdGF0c19kZXNjKQ0KQEAgLTE0NCw2
ICsxNzAsOCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9ncnBfc3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2KQ0KIAkJCSZwcml2LT5jaGFubmVsX3N0YXRzW2ldOw0KIAkJc3RydWN0
IG1seDVlX3hkcHNxX3N0YXRzICp4ZHBzcV9yZWRfc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+eGRw
c3E7DQogCQlzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMgKnhkcHNxX3N0YXRzID0gJmNoYW5uZWxf
c3RhdHMtPnJxX3hkcHNxOw0KKwkJc3RydWN0IG1seDVlX3hkcHNxX3N0YXRzICp4c2tzcV9zdGF0
cyA9ICZjaGFubmVsX3N0YXRzLT54c2tzcTsNCisJCXN0cnVjdCBtbHg1ZV9ycV9zdGF0cyAqeHNr
cnFfc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+eHNrcnE7DQogCQlzdHJ1Y3QgbWx4NWVfcnFfc3Rh
dHMgKnJxX3N0YXRzID0gJmNoYW5uZWxfc3RhdHMtPnJxOw0KIAkJc3RydWN0IG1seDVlX2NoX3N0
YXRzICpjaF9zdGF0cyA9ICZjaGFubmVsX3N0YXRzLT5jaDsNCiAJCWludCBqOw0KQEAgLTE4Niw2
ICsyMTQsNyBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9ncnBfc3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2KQ0KIAkJcy0+Y2hfcG9sbCAgICAgICAgKz0gY2hfc3RhdHMtPnBvbGw7
DQogCQlzLT5jaF9hcm0gICAgICAgICArPSBjaF9zdGF0cy0+YXJtOw0KIAkJcy0+Y2hfYWZmX2No
YW5nZSAgKz0gY2hfc3RhdHMtPmFmZl9jaGFuZ2U7DQorCQlzLT5jaF9mb3JjZV9pcnEgICArPSBj
aF9zdGF0cy0+Zm9yY2VfaXJxOw0KIAkJcy0+Y2hfZXFfcmVhcm0gICAgKz0gY2hfc3RhdHMtPmVx
X3JlYXJtOw0KIAkJLyogeGRwIHJlZGlyZWN0ICovDQogCQlzLT50eF94ZHBfeG1pdCAgICArPSB4
ZHBzcV9yZWRfc3RhdHMtPnhtaXQ7DQpAQCAtMTk0LDYgKzIyMywzMiBAQCBzdGF0aWMgdm9pZCBt
bHg1ZV9ncnBfc3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAkJcy0+
dHhfeGRwX2Z1bGwgICAgKz0geGRwc3FfcmVkX3N0YXRzLT5mdWxsOw0KIAkJcy0+dHhfeGRwX2Vy
ciAgICAgKz0geGRwc3FfcmVkX3N0YXRzLT5lcnI7DQogCQlzLT50eF94ZHBfY3FlcyAgICArPSB4
ZHBzcV9yZWRfc3RhdHMtPmNxZXM7DQorCQkvKiBBRl9YRFAgemVyby1jb3B5ICovDQorCQlzLT5y
eF94c2tfcGFja2V0cyAgICAgICAgICAgICAgICArPSB4c2tycV9zdGF0cy0+cGFja2V0czsNCisJ
CXMtPnJ4X3hza19ieXRlcyAgICAgICAgICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5ieXRlczsN
CisJCXMtPnJ4X3hza19jc3VtX2NvbXBsZXRlICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5jc3Vt
X2NvbXBsZXRlOw0KKwkJcy0+cnhfeHNrX2NzdW1fdW5uZWNlc3NhcnkgICAgICAgKz0geHNrcnFf
c3RhdHMtPmNzdW1fdW5uZWNlc3Nhcnk7DQorCQlzLT5yeF94c2tfY3N1bV91bm5lY2Vzc2FyeV9p
bm5lciArPSB4c2tycV9zdGF0cy0+Y3N1bV91bm5lY2Vzc2FyeV9pbm5lcjsNCisJCXMtPnJ4X3hz
a19jc3VtX25vbmUgICAgICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5jc3VtX25vbmU7DQorCQlz
LT5yeF94c2tfZWNuX21hcmsgICAgICAgICAgICAgICArPSB4c2tycV9zdGF0cy0+ZWNuX21hcms7
DQorCQlzLT5yeF94c2tfcmVtb3ZlZF92bGFuX3BhY2tldHMgICArPSB4c2tycV9zdGF0cy0+cmVt
b3ZlZF92bGFuX3BhY2tldHM7DQorCQlzLT5yeF94c2tfeGRwX2Ryb3AgICAgICAgICAgICAgICAr
PSB4c2tycV9zdGF0cy0+eGRwX2Ryb3A7DQorCQlzLT5yeF94c2tfeGRwX3JlZGlyZWN0ICAgICAg
ICAgICArPSB4c2tycV9zdGF0cy0+eGRwX3JlZGlyZWN0Ow0KKwkJcy0+cnhfeHNrX3dxZV9lcnIg
ICAgICAgICAgICAgICAgKz0geHNrcnFfc3RhdHMtPndxZV9lcnI7DQorCQlzLT5yeF94c2tfbXB3
cWVfZmlsbGVyX2NxZXMgICAgICArPSB4c2tycV9zdGF0cy0+bXB3cWVfZmlsbGVyX2NxZXM7DQor
CQlzLT5yeF94c2tfbXB3cWVfZmlsbGVyX3N0cmlkZXMgICArPSB4c2tycV9zdGF0cy0+bXB3cWVf
ZmlsbGVyX3N0cmlkZXM7DQorCQlzLT5yeF94c2tfb3ZlcnNpemVfcGt0c19zd19kcm9wICArPSB4
c2tycV9zdGF0cy0+b3ZlcnNpemVfcGt0c19zd19kcm9wOw0KKwkJcy0+cnhfeHNrX2J1ZmZfYWxs
b2NfZXJyICAgICAgICAgKz0geHNrcnFfc3RhdHMtPmJ1ZmZfYWxsb2NfZXJyOw0KKwkJcy0+cnhf
eHNrX2NxZV9jb21wcmVzc19ibGtzICAgICAgKz0geHNrcnFfc3RhdHMtPmNxZV9jb21wcmVzc19i
bGtzOw0KKwkJcy0+cnhfeHNrX2NxZV9jb21wcmVzc19wa3RzICAgICAgKz0geHNrcnFfc3RhdHMt
PmNxZV9jb21wcmVzc19wa3RzOw0KKwkJcy0+cnhfeHNrX2NvbmdzdF91bXIgICAgICAgICAgICAg
Kz0geHNrcnFfc3RhdHMtPmNvbmdzdF91bXI7DQorCQlzLT5yeF94c2tfYXJmc19lcnIgICAgICAg
ICAgICAgICArPSB4c2tycV9zdGF0cy0+YXJmc19lcnI7DQorCQlzLT50eF94c2tfeG1pdCAgICAg
ICAgICAgICAgICAgICArPSB4c2tzcV9zdGF0cy0+eG1pdDsNCisJCXMtPnR4X3hza19tcHdxZSAg
ICAgICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5tcHdxZTsNCisJCXMtPnR4X3hza19pbmxu
dyAgICAgICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5pbmxudzsNCisJCXMtPnR4X3hza19m
dWxsICAgICAgICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5mdWxsOw0KKwkJcy0+dHhfeHNr
X2VyciAgICAgICAgICAgICAgICAgICAgKz0geHNrc3Ffc3RhdHMtPmVycjsNCisJCXMtPnR4X3hz
a19jcWVzICAgICAgICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5jcWVzOw0KIA0KIAkJZm9y
IChqID0gMDsgaiA8IHByaXYtPm1heF9vcGVuZWRfdGM7IGorKykgew0KIAkJCXN0cnVjdCBtbHg1
ZV9zcV9zdGF0cyAqc3Ffc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+c3Fbal07DQpAQCAtMTI2Niwx
MSArMTMyMSw0MyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGVzYyB4ZHBzcV9zdGF0
c19kZXNjW10gPSB7DQogCXsgTUxYNUVfREVDTEFSRV9YRFBTUV9TVEFUKHN0cnVjdCBtbHg1ZV94
ZHBzcV9zdGF0cywgY3FlcykgfSwNCiB9Ow0KIA0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRl
cl9kZXNjIHhza3JxX3N0YXRzX2Rlc2NbXSA9IHsNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NU
QVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBwYWNrZXRzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVf
WFNLUlFfU1RBVChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGJ5dGVzKSB9LA0KKwl7IE1MWDVFX0RF
Q0xBUkVfWFNLUlFfU1RBVChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGNzdW1fY29tcGxldGUpIH0s
DQorCXsgTUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgY3N1
bV91bm5lY2Vzc2FyeSkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1s
eDVlX3JxX3N0YXRzLCBjc3VtX3VubmVjZXNzYXJ5X2lubmVyKSB9LA0KKwl7IE1MWDVFX0RFQ0xB
UkVfWFNLUlFfU1RBVChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGNzdW1fbm9uZSkgfSwNCisJeyBN
TFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBlY25fbWFyaykg
fSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBy
ZW1vdmVkX3ZsYW5fcGFja2V0cykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3Ry
dWN0IG1seDVlX3JxX3N0YXRzLCB4ZHBfZHJvcCkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JR
X1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCB4ZHBfcmVkaXJlY3QpIH0sDQorCXsgTUxYNUVf
REVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgd3FlX2VycikgfSwNCisJ
eyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBtcHdxZV9m
aWxsZXJfY3FlcykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVl
X3JxX3N0YXRzLCBtcHdxZV9maWxsZXJfc3RyaWRlcykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hT
S1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBvdmVyc2l6ZV9wa3RzX3N3X2Ryb3ApIH0s
DQorCXsgTUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgYnVm
Zl9hbGxvY19lcnIpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1
ZV9ycV9zdGF0cywgY3FlX2NvbXByZXNzX2Jsa3MpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9YU0tS
UV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgY3FlX2NvbXByZXNzX3BrdHMpIH0sDQorCXsg
TUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgY29uZ3N0X3Vt
cikgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRz
LCBhcmZzX2VycikgfSwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXNj
IHhza3NxX3N0YXRzX2Rlc2NbXSA9IHsNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1NRX1NUQVQoc3Ry
dWN0IG1seDVlX3hkcHNxX3N0YXRzLCB4bWl0KSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLU1Ff
U1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIG1wd3FlKSB9LA0KKwl7IE1MWDVFX0RFQ0xB
UkVfWFNLU1FfU1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIGlubG53KSB9LA0KKwl7IE1M
WDVFX0RFQ0xBUkVfWFNLU1FfU1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIGZ1bGwpIH0s
DQorCXsgTUxYNUVfREVDTEFSRV9YU0tTUV9TVEFUKHN0cnVjdCBtbHg1ZV94ZHBzcV9zdGF0cywg
ZXJyKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLU1FfU1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ff
c3RhdHMsIGNxZXMpIH0sDQorfTsNCisNCiBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGVz
YyBjaF9zdGF0c19kZXNjW10gPSB7DQogCXsgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHN0cnVjdCBt
bHg1ZV9jaF9zdGF0cywgZXZlbnRzKSB9LA0KIAl7IE1MWDVFX0RFQ0xBUkVfQ0hfU1RBVChzdHJ1
Y3QgbWx4NWVfY2hfc3RhdHMsIHBvbGwpIH0sDQogCXsgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHN0
cnVjdCBtbHg1ZV9jaF9zdGF0cywgYXJtKSB9LA0KIAl7IE1MWDVFX0RFQ0xBUkVfQ0hfU1RBVChz
dHJ1Y3QgbWx4NWVfY2hfc3RhdHMsIGFmZl9jaGFuZ2UpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9D
SF9TVEFUKHN0cnVjdCBtbHg1ZV9jaF9zdGF0cywgZm9yY2VfaXJxKSB9LA0KIAl7IE1MWDVFX0RF
Q0xBUkVfQ0hfU1RBVChzdHJ1Y3QgbWx4NWVfY2hfc3RhdHMsIGVxX3JlYXJtKSB9LA0KIH07DQog
DQpAQCAtMTI3OCw2ICsxMzY1LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2Rlc2Mg
Y2hfc3RhdHNfZGVzY1tdID0gew0KICNkZWZpbmUgTlVNX1NRX1NUQVRTCQkJQVJSQVlfU0laRShz
cV9zdGF0c19kZXNjKQ0KICNkZWZpbmUgTlVNX1hEUFNRX1NUQVRTCQkJQVJSQVlfU0laRSh4ZHBz
cV9zdGF0c19kZXNjKQ0KICNkZWZpbmUgTlVNX1JRX1hEUFNRX1NUQVRTCQlBUlJBWV9TSVpFKHJx
X3hkcHNxX3N0YXRzX2Rlc2MpDQorI2RlZmluZSBOVU1fWFNLUlFfU1RBVFMJCQlBUlJBWV9TSVpF
KHhza3JxX3N0YXRzX2Rlc2MpDQorI2RlZmluZSBOVU1fWFNLU1FfU1RBVFMJCQlBUlJBWV9TSVpF
KHhza3NxX3N0YXRzX2Rlc2MpDQogI2RlZmluZSBOVU1fQ0hfU1RBVFMJCQlBUlJBWV9TSVpFKGNo
X3N0YXRzX2Rlc2MpDQogDQogc3RhdGljIGludCBtbHg1ZV9ncnBfY2hhbm5lbHNfZ2V0X251bV9z
dGF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCkBAIC0xMjg4LDEzICsxMzc3LDE2IEBAIHN0
YXRpYyBpbnQgbWx4NWVfZ3JwX2NoYW5uZWxzX2dldF9udW1fc3RhdHMoc3RydWN0IG1seDVlX3By
aXYgKnByaXYpDQogCSAgICAgICAoTlVNX0NIX1NUQVRTICogbWF4X25jaCkgKw0KIAkgICAgICAg
KE5VTV9TUV9TVEFUUyAqIG1heF9uY2ggKiBwcml2LT5tYXhfb3BlbmVkX3RjKSArDQogCSAgICAg
ICAoTlVNX1JRX1hEUFNRX1NUQVRTICogbWF4X25jaCkgKw0KLQkgICAgICAgKE5VTV9YRFBTUV9T
VEFUUyAqIG1heF9uY2gpOw0KKwkgICAgICAgKE5VTV9YRFBTUV9TVEFUUyAqIG1heF9uY2gpICsN
CisJICAgICAgIChOVU1fWFNLUlFfU1RBVFMgKiBtYXhfbmNoICogcHJpdi0+eHNrLmV2ZXJfdXNl
ZCkgKw0KKwkgICAgICAgKE5VTV9YU0tTUV9TVEFUUyAqIG1heF9uY2ggKiBwcml2LT54c2suZXZl
cl91c2VkKTsNCiB9DQogDQogc3RhdGljIGludCBtbHg1ZV9ncnBfY2hhbm5lbHNfZmlsbF9zdHJp
bmdzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB1OCAqZGF0YSwNCiAJCQkJCSAgIGludCBpZHgp
DQogew0KIAlpbnQgbWF4X25jaCA9IG1seDVlX2dldF9uZXRkZXZfbWF4X2NoYW5uZWxzKHByaXYt
Pm5ldGRldik7DQorCWJvb2wgaXNfeHNrID0gcHJpdi0+eHNrLmV2ZXJfdXNlZDsNCiAJaW50IGks
IGosIHRjOw0KIA0KIAlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKQ0KQEAgLTEzMDYsNiAr
MTM5OCw5IEBAIHN0YXRpYyBpbnQgbWx4NWVfZ3JwX2NoYW5uZWxzX2ZpbGxfc3RyaW5ncyhzdHJ1
Y3QgbWx4NWVfcHJpdiAqcHJpdiwgdTggKmRhdGEsDQogCQlmb3IgKGogPSAwOyBqIDwgTlVNX1JR
X1NUQVRTOyBqKyspDQogCQkJc3ByaW50ZihkYXRhICsgKGlkeCsrKSAqIEVUSF9HU1RSSU5HX0xF
TiwNCiAJCQkJcnFfc3RhdHNfZGVzY1tqXS5mb3JtYXQsIGkpOw0KKwkJZm9yIChqID0gMDsgaiA8
IE5VTV9YU0tSUV9TVEFUUyAqIGlzX3hzazsgaisrKQ0KKwkJCXNwcmludGYoZGF0YSArIChpZHgr
KykgKiBFVEhfR1NUUklOR19MRU4sDQorCQkJCXhza3JxX3N0YXRzX2Rlc2Nbal0uZm9ybWF0LCBp
KTsNCiAJCWZvciAoaiA9IDA7IGogPCBOVU1fUlFfWERQU1FfU1RBVFM7IGorKykNCiAJCQlzcHJp
bnRmKGRhdGEgKyAoaWR4KyspICogRVRIX0dTVFJJTkdfTEVOLA0KIAkJCQlycV94ZHBzcV9zdGF0
c19kZXNjW2pdLmZvcm1hdCwgaSk7DQpAQCAtMTMxOCwxMCArMTQxMywxNCBAQCBzdGF0aWMgaW50
IG1seDVlX2dycF9jaGFubmVsc19maWxsX3N0cmluZ3Moc3RydWN0IG1seDVlX3ByaXYgKnByaXYs
IHU4ICpkYXRhLA0KIAkJCQkJc3Ffc3RhdHNfZGVzY1tqXS5mb3JtYXQsDQogCQkJCQlwcml2LT5j
aGFubmVsX3RjMnR4cVtpXVt0Y10pOw0KIA0KLQlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsr
KQ0KKwlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKSB7DQorCQlmb3IgKGogPSAwOyBqIDwg
TlVNX1hTS1NRX1NUQVRTICogaXNfeHNrOyBqKyspDQorCQkJc3ByaW50ZihkYXRhICsgKGlkeCsr
KSAqIEVUSF9HU1RSSU5HX0xFTiwNCisJCQkJeHNrc3Ffc3RhdHNfZGVzY1tqXS5mb3JtYXQsIGkp
Ow0KIAkJZm9yIChqID0gMDsgaiA8IE5VTV9YRFBTUV9TVEFUUzsgaisrKQ0KIAkJCXNwcmludGYo
ZGF0YSArIChpZHgrKykgKiBFVEhfR1NUUklOR19MRU4sDQogCQkJCXhkcHNxX3N0YXRzX2Rlc2Nb
al0uZm9ybWF0LCBpKTsNCisJfQ0KIA0KIAlyZXR1cm4gaWR4Ow0KIH0NCkBAIC0xMzMwLDYgKzE0
MjksNyBAQCBzdGF0aWMgaW50IG1seDVlX2dycF9jaGFubmVsc19maWxsX3N0YXRzKHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2LCB1NjQgKmRhdGEsDQogCQkJCQkgaW50IGlkeCkNCiB7DQogCWludCBt
YXhfbmNoID0gbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCisJ
Ym9vbCBpc194c2sgPSBwcml2LT54c2suZXZlcl91c2VkOw0KIAlpbnQgaSwgaiwgdGM7DQogDQog
CWZvciAoaSA9IDA7IGkgPCBtYXhfbmNoOyBpKyspDQpAQCAtMTM0Myw2ICsxNDQzLDEwIEBAIHN0
YXRpYyBpbnQgbWx4NWVfZ3JwX2NoYW5uZWxzX2ZpbGxfc3RhdHMoc3RydWN0IG1seDVlX3ByaXYg
KnByaXYsIHU2NCAqZGF0YSwNCiAJCQlkYXRhW2lkeCsrXSA9DQogCQkJCU1MWDVFX1JFQURfQ1RS
NjRfQ1BVKCZwcml2LT5jaGFubmVsX3N0YXRzW2ldLnJxLA0KIAkJCQkJCSAgICAgcnFfc3RhdHNf
ZGVzYywgaik7DQorCQlmb3IgKGogPSAwOyBqIDwgTlVNX1hTS1JRX1NUQVRTICogaXNfeHNrOyBq
KyspDQorCQkJZGF0YVtpZHgrK10gPQ0KKwkJCQlNTFg1RV9SRUFEX0NUUjY0X0NQVSgmcHJpdi0+
Y2hhbm5lbF9zdGF0c1tpXS54c2tycSwNCisJCQkJCQkgICAgIHhza3JxX3N0YXRzX2Rlc2MsIGop
Ow0KIAkJZm9yIChqID0gMDsgaiA8IE5VTV9SUV9YRFBTUV9TVEFUUzsgaisrKQ0KIAkJCWRhdGFb
aWR4KytdID0NCiAJCQkJTUxYNUVfUkVBRF9DVFI2NF9DUFUoJnByaXYtPmNoYW5uZWxfc3RhdHNb
aV0ucnFfeGRwc3EsDQpAQCAtMTM1NiwxMSArMTQ2MCwxNiBAQCBzdGF0aWMgaW50IG1seDVlX2dy
cF9jaGFubmVsc19maWxsX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB1NjQgKmRhdGEs
DQogCQkJCQlNTFg1RV9SRUFEX0NUUjY0X0NQVSgmcHJpdi0+Y2hhbm5lbF9zdGF0c1tpXS5zcVt0
Y10sDQogCQkJCQkJCSAgICAgc3Ffc3RhdHNfZGVzYywgaik7DQogDQotCWZvciAoaSA9IDA7IGkg
PCBtYXhfbmNoOyBpKyspDQorCWZvciAoaSA9IDA7IGkgPCBtYXhfbmNoOyBpKyspIHsNCisJCWZv
ciAoaiA9IDA7IGogPCBOVU1fWFNLU1FfU1RBVFMgKiBpc194c2s7IGorKykNCisJCQlkYXRhW2lk
eCsrXSA9DQorCQkJCU1MWDVFX1JFQURfQ1RSNjRfQ1BVKCZwcml2LT5jaGFubmVsX3N0YXRzW2ld
Lnhza3NxLA0KKwkJCQkJCSAgICAgeHNrc3Ffc3RhdHNfZGVzYywgaik7DQogCQlmb3IgKGogPSAw
OyBqIDwgTlVNX1hEUFNRX1NUQVRTOyBqKyspDQogCQkJZGF0YVtpZHgrK10gPQ0KIAkJCQlNTFg1
RV9SRUFEX0NUUjY0X0NQVSgmcHJpdi0+Y2hhbm5lbF9zdGF0c1tpXS54ZHBzcSwNCiAJCQkJCQkg
ICAgIHhkcHNxX3N0YXRzX2Rlc2MsIGopOw0KKwl9DQogDQogCXJldHVybiBpZHg7DQogfQ0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0
cy5oIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0YXRzLmgN
CmluZGV4IGNkZGRjYzQ2OTcxYi4uZmIzYWQ3MjMxZTExIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9u
ZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0YXRzLmgNCisrKyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0cy5oDQpAQCAtNDYsNiArNDYs
OCBAQA0KICNkZWZpbmUgTUxYNUVfREVDTEFSRV9UWF9TVEFUKHR5cGUsIGZsZCkgInR4JWRfIiNm
bGQsIG9mZnNldG9mKHR5cGUsIGZsZCkNCiAjZGVmaW5lIE1MWDVFX0RFQ0xBUkVfWERQU1FfU1RB
VCh0eXBlLCBmbGQpICJ0eCVkX3hkcF8iI2ZsZCwgb2Zmc2V0b2YodHlwZSwgZmxkKQ0KICNkZWZp
bmUgTUxYNUVfREVDTEFSRV9SUV9YRFBTUV9TVEFUKHR5cGUsIGZsZCkgInJ4JWRfeGRwX3R4XyIj
ZmxkLCBvZmZzZXRvZih0eXBlLCBmbGQpDQorI2RlZmluZSBNTFg1RV9ERUNMQVJFX1hTS1JRX1NU
QVQodHlwZSwgZmxkKSAicnglZF94c2tfIiNmbGQsIG9mZnNldG9mKHR5cGUsIGZsZCkNCisjZGVm
aW5lIE1MWDVFX0RFQ0xBUkVfWFNLU1FfU1RBVCh0eXBlLCBmbGQpICJ0eCVkX3hza18iI2ZsZCwg
b2Zmc2V0b2YodHlwZSwgZmxkKQ0KICNkZWZpbmUgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHR5cGUs
IGZsZCkgImNoJWRfIiNmbGQsIG9mZnNldG9mKHR5cGUsIGZsZCkNCiANCiBzdHJ1Y3QgY291bnRl
cl9kZXNjIHsNCkBAIC0xMTYsMTIgKzExOCwzOSBAQCBzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMgew0K
IAl1NjQgY2hfcG9sbDsNCiAJdTY0IGNoX2FybTsNCiAJdTY0IGNoX2FmZl9jaGFuZ2U7DQorCXU2
NCBjaF9mb3JjZV9pcnE7DQogCXU2NCBjaF9lcV9yZWFybTsNCiANCiAjaWZkZWYgQ09ORklHX01M
WDVfRU5fVExTDQogCXU2NCB0eF90bHNfb29vOw0KIAl1NjQgdHhfdGxzX3Jlc3luY19ieXRlczsN
CiAjZW5kaWYNCisNCisJdTY0IHJ4X3hza19wYWNrZXRzOw0KKwl1NjQgcnhfeHNrX2J5dGVzOw0K
Kwl1NjQgcnhfeHNrX2NzdW1fY29tcGxldGU7DQorCXU2NCByeF94c2tfY3N1bV91bm5lY2Vzc2Fy
eTsNCisJdTY0IHJ4X3hza19jc3VtX3VubmVjZXNzYXJ5X2lubmVyOw0KKwl1NjQgcnhfeHNrX2Nz
dW1fbm9uZTsNCisJdTY0IHJ4X3hza19lY25fbWFyazsNCisJdTY0IHJ4X3hza19yZW1vdmVkX3Zs
YW5fcGFja2V0czsNCisJdTY0IHJ4X3hza194ZHBfZHJvcDsNCisJdTY0IHJ4X3hza194ZHBfcmVk
aXJlY3Q7DQorCXU2NCByeF94c2tfd3FlX2VycjsNCisJdTY0IHJ4X3hza19tcHdxZV9maWxsZXJf
Y3FlczsNCisJdTY0IHJ4X3hza19tcHdxZV9maWxsZXJfc3RyaWRlczsNCisJdTY0IHJ4X3hza19v
dmVyc2l6ZV9wa3RzX3N3X2Ryb3A7DQorCXU2NCByeF94c2tfYnVmZl9hbGxvY19lcnI7DQorCXU2
NCByeF94c2tfY3FlX2NvbXByZXNzX2Jsa3M7DQorCXU2NCByeF94c2tfY3FlX2NvbXByZXNzX3Br
dHM7DQorCXU2NCByeF94c2tfY29uZ3N0X3VtcjsNCisJdTY0IHJ4X3hza19hcmZzX2VycjsNCisJ
dTY0IHR4X3hza194bWl0Ow0KKwl1NjQgdHhfeHNrX21wd3FlOw0KKwl1NjQgdHhfeHNrX2lubG53
Ow0KKwl1NjQgdHhfeHNrX2Z1bGw7DQorCXU2NCB0eF94c2tfZXJyOw0KKwl1NjQgdHhfeHNrX2Nx
ZXM7DQogfTsNCiANCiBzdHJ1Y3QgbWx4NWVfcWNvdW50ZXJfc3RhdHMgew0KQEAgLTI1Niw2ICsy
ODUsNyBAQCBzdHJ1Y3QgbWx4NWVfY2hfc3RhdHMgew0KIAl1NjQgcG9sbDsNCiAJdTY0IGFybTsN
CiAJdTY0IGFmZl9jaGFuZ2U7DQorCXU2NCBmb3JjZV9pcnE7DQogCXU2NCBlcV9yZWFybTsNCiB9
Ow0KIA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29y
ZS9lbl90eHJ4LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5f
dHhyeC5jDQppbmRleCBkMmI4Y2U1ZGY1OWMuLjlhZTMyN2U4MGQ2ZCAxMDA2NDQNCi0tLSBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4LmMNCisrKyBiL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4LmMNCkBAIC0zMyw2
ICszMyw3IEBADQogI2luY2x1ZGUgPGxpbnV4L2lycS5oPg0KICNpbmNsdWRlICJlbi5oIg0KICNp
bmNsdWRlICJlbi94ZHAuaCINCisjaW5jbHVkZSAiZW4veHNrL3R4LmgiDQogDQogc3RhdGljIGlu
bGluZSBib29sIG1seDVlX2NoYW5uZWxfbm9fYWZmaW5pdHlfY2hhbmdlKHN0cnVjdCBtbHg1ZV9j
aGFubmVsICpjKQ0KIHsNCkBAIC04Nyw3ICs4OCwxMiBAQCBpbnQgbWx4NWVfbmFwaV9wb2xsKHN0
cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCkNCiAJc3RydWN0IG1seDVlX2NoYW5u
ZWwgKmMgPSBjb250YWluZXJfb2YobmFwaSwgc3RydWN0IG1seDVlX2NoYW5uZWwsDQogCQkJCQkg
ICAgICAgbmFwaSk7DQogCXN0cnVjdCBtbHg1ZV9jaF9zdGF0cyAqY2hfc3RhdHMgPSBjLT5zdGF0
czsNCisJc3RydWN0IG1seDVlX3hkcHNxICp4c2tzcSA9ICZjLT54c2tzcTsNCisJc3RydWN0IG1s
eDVlX3JxICp4c2tycSA9ICZjLT54c2tycTsNCiAJc3RydWN0IG1seDVlX3JxICpycSA9ICZjLT5y
cTsNCisJYm9vbCB4c2tfb3BlbiA9IHRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBj
LT5zdGF0ZSk7DQorCWJvb2wgYWZmX2NoYW5nZSA9IGZhbHNlOw0KKwlib29sIGJ1c3lfeHNrID0g
ZmFsc2U7DQogCWJvb2wgYnVzeSA9IGZhbHNlOw0KIAlpbnQgd29ya19kb25lID0gMDsNCiAJaW50
IGk7DQpAQCAtMTAzLDE4ICsxMDksMzIgQEAgaW50IG1seDVlX25hcGlfcG9sbChzdHJ1Y3QgbmFw
aV9zdHJ1Y3QgKm5hcGksIGludCBidWRnZXQpDQogCQlidXN5IHw9IG1seDVlX3BvbGxfeGRwc3Ff
Y3EoJmMtPnJxX3hkcHNxLmNxKTsNCiANCiAJaWYgKGxpa2VseShidWRnZXQpKSB7IC8qIGJ1ZGdl
dD0wIG1lYW5zOiBkb24ndCBwb2xsIHJ4IHJpbmdzICovDQotCQl3b3JrX2RvbmUgPSBtbHg1ZV9w
b2xsX3J4X2NxKCZycS0+Y3EsIGJ1ZGdldCk7DQorCQlpZiAoeHNrX29wZW4pDQorCQkJd29ya19k
b25lID0gbWx4NWVfcG9sbF9yeF9jcSgmeHNrcnEtPmNxLCBidWRnZXQpOw0KKw0KKwkJaWYgKGxp
a2VseShidWRnZXQgLSB3b3JrX2RvbmUpKQ0KKwkJCXdvcmtfZG9uZSArPSBtbHg1ZV9wb2xsX3J4
X2NxKCZycS0+Y3EsIGJ1ZGdldCAtIHdvcmtfZG9uZSk7DQorDQogCQlidXN5IHw9IHdvcmtfZG9u
ZSA9PSBidWRnZXQ7DQogCX0NCiANCiAJbWx4NWVfcG9sbF9pY29fY3EoJmMtPmljb3NxLmNxKTsN
CiANCiAJYnVzeSB8PSBycS0+cG9zdF93cWVzKHJxKTsNCisJaWYgKHhza19vcGVuKSB7DQorCQlt
bHg1ZV9wb2xsX2ljb19jcSgmYy0+eHNraWNvc3EuY3EpOw0KKwkJYnVzeSB8PSBtbHg1ZV9wb2xs
X3hkcHNxX2NxKCZ4c2tzcS0+Y3EpOw0KKwkJYnVzeV94c2sgfD0gbWx4NWVfeHNrX3R4KHhza3Nx
LCBNTFg1RV9UWF9YU0tfUE9MTF9CVURHRVQpOw0KKwkJYnVzeV94c2sgfD0geHNrcnEtPnBvc3Rf
d3Flcyh4c2tycSk7DQorCX0NCisNCisJYnVzeSB8PSBidXN5X3hzazsNCiANCiAJaWYgKGJ1c3kp
IHsNCiAJCWlmIChsaWtlbHkobWx4NWVfY2hhbm5lbF9ub19hZmZpbml0eV9jaGFuZ2UoYykpKQ0K
IAkJCXJldHVybiBidWRnZXQ7DQogCQljaF9zdGF0cy0+YWZmX2NoYW5nZSsrOw0KKwkJYWZmX2No
YW5nZSA9IHRydWU7DQogCQlpZiAoYnVkZ2V0ICYmIHdvcmtfZG9uZSA9PSBidWRnZXQpDQogCQkJ
d29ya19kb25lLS07DQogCX0NCkBAIC0xMzUsNiArMTU1LDE4IEBAIGludCBtbHg1ZV9uYXBpX3Bv
bGwoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0KQ0KIAltbHg1ZV9jcV9hcm0o
JmMtPmljb3NxLmNxKTsNCiAJbWx4NWVfY3FfYXJtKCZjLT54ZHBzcS5jcSk7DQogDQorCWlmICh4
c2tfb3Blbikgew0KKwkJbWx4NWVfaGFuZGxlX3J4X2RpbSh4c2tycSk7DQorCQltbHg1ZV9jcV9h
cm0oJmMtPnhza2ljb3NxLmNxKTsNCisJCW1seDVlX2NxX2FybSgmeHNrc3EtPmNxKTsNCisJCW1s
eDVlX2NxX2FybSgmeHNrcnEtPmNxKTsNCisJfQ0KKw0KKwlpZiAodW5saWtlbHkoYWZmX2NoYW5n
ZSAmJiBidXN5X3hzaykpIHsNCisJCW1seDVlX3RyaWdnZXJfaXJxKCZjLT5pY29zcSk7DQorCQlj
aF9zdGF0cy0+Zm9yY2VfaXJxKys7DQorCX0NCisNCiAJcmV0dXJuIHdvcmtfZG9uZTsNCiB9DQog
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2lw
b2liL2lwb2liLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvaXBv
aWIvaXBvaWIuYw0KaW5kZXggOWNhNDkyYjQzMGQ4Li5kYTgxYTVhN2I4ZTkgMTAwNjQ0DQotLS0g
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvaXBvaWIvaXBvaWIuYw0K
KysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2lwb2liL2lwb2li
LmMNCkBAIC04Nyw3ICs4Nyw3IEBAIGludCBtbHg1aV9pbml0KHN0cnVjdCBtbHg1X2NvcmVfZGV2
ICptZGV2LA0KIAltbHg1ZV9zZXRfbmV0ZGV2X210dV9ib3VuZGFyaWVzKHByaXYpOw0KIAluZXRk
ZXYtPm10dSA9IG5ldGRldi0+bWF4X210dTsNCiANCi0JbWx4NWVfYnVpbGRfbmljX3BhcmFtcyht
ZGV2LCAmcHJpdi0+cnNzX3BhcmFtcywgJnByaXYtPmNoYW5uZWxzLnBhcmFtcywNCisJbWx4NWVf
YnVpbGRfbmljX3BhcmFtcyhtZGV2LCBOVUxMLCAmcHJpdi0+cnNzX3BhcmFtcywgJnByaXYtPmNo
YW5uZWxzLnBhcmFtcywNCiAJCQkgICAgICAgbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMo
bmV0ZGV2KSwNCiAJCQkgICAgICAgbmV0ZGV2LT5tdHUpOw0KIAltbHg1aV9idWlsZF9uaWNfcGFy
YW1zKG1kZXYsICZwcml2LT5jaGFubmVscy5wYXJhbXMpOw0KQEAgLTM2NSw3ICszNjUsNyBAQCBz
dGF0aWMgaW50IG1seDVpX2luaXRfcngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCWlmIChl
cnIpDQogCQlnb3RvIGVycl9jbG9zZV9kcm9wX3JxOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVhdGVf
ZGlyZWN0X3JxdHMocHJpdik7DQorCWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhwcml2
LCBwcml2LT5kaXJlY3RfdGlyKTsNCiAJaWYgKGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lfaW5k
aXJlY3RfcnF0czsNCiANCkBAIC0zNzMsNyArMzczLDcgQEAgc3RhdGljIGludCBtbHg1aV9pbml0
X3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZGVz
dHJveV9kaXJlY3RfcnF0czsNCiANCi0JZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHBy
aXYpOw0KKwllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0
X3Rpcik7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9kZXN0cm95X2luZGlyZWN0X3RpcnM7DQog
DQpAQCAtMzg0LDExICszODQsMTEgQEAgc3RhdGljIGludCBtbHg1aV9pbml0X3J4KHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2KQ0KIAlyZXR1cm4gMDsNCiANCiBlcnJfZGVzdHJveV9kaXJlY3RfdGly
czoNCi0JbWx4NWVfZGVzdHJveV9kaXJlY3RfdGlycyhwcml2KTsNCisJbWx4NWVfZGVzdHJveV9k
aXJlY3RfdGlycyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiBlcnJfZGVzdHJveV9pbmRpcmVj
dF90aXJzOg0KIAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMocHJpdiwgdHJ1ZSk7DQogZXJy
X2Rlc3Ryb3lfZGlyZWN0X3JxdHM6DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdik7
DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQog
ZXJyX2Rlc3Ryb3lfaW5kaXJlY3RfcnF0czoNCiAJbWx4NWVfZGVzdHJveV9ycXQocHJpdiwgJnBy
aXYtPmluZGlyX3JxdCk7DQogZXJyX2Nsb3NlX2Ryb3BfcnE6DQpAQCAtNDAxLDkgKzQwMSw5IEBA
IHN0YXRpYyBpbnQgbWx4NWlfaW5pdF9yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiBzdGF0
aWMgdm9pZCBtbHg1aV9jbGVhbnVwX3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIHsNCiAJ
bWx4NWlfZGVzdHJveV9mbG93X3N0ZWVyaW5nKHByaXYpOw0KLQltbHg1ZV9kZXN0cm95X2RpcmVj
dF90aXJzKHByaXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYsIHByaXYtPmRp
cmVjdF90aXIpOw0KIAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMocHJpdiwgdHJ1ZSk7DQot
CW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdik7DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0
X3JxdHMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogCW1seDVlX2Rlc3Ryb3lfcnF0KHByaXYs
ICZwcml2LT5pbmRpcl9ycXQpOw0KIAltbHg1ZV9jbG9zZV9kcm9wX3JxKCZwcml2LT5kcm9wX3Jx
KTsNCiAJbWx4NWVfZGVzdHJveV9xX2NvdW50ZXJzKHByaXYpOw0KLS0gDQoyLjE5LjENCg0K
