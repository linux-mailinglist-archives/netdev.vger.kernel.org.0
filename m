Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id E6BBB25DDAA
	for <lists+netdev@lfdr.de>; Fri,  4 Sep 2020 17:27:38 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1730848AbgIDP1h (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 4 Sep 2020 11:27:37 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:40978 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1730224AbgIDP1f (ORCPT
        <rfc822;netdev@vger.kernel.org>); Fri, 4 Sep 2020 11:27:35 -0400
Received: from mail-out.m-online.net (mail-out.m-online.net [IPv6:2001:a60:0:28:0:1:25:1])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 2BC91C061244
        for <netdev@vger.kernel.org>; Fri,  4 Sep 2020 08:27:35 -0700 (PDT)
Received: from frontend01.mail.m-online.net (unknown [192.168.8.182])
        by mail-out.m-online.net (Postfix) with ESMTP id 4BjhPc0NjQz1rsMt;
        Fri,  4 Sep 2020 17:27:26 +0200 (CEST)
Received: from localhost (dynscan1.mnet-online.de [192.168.6.70])
        by mail.m-online.net (Postfix) with ESMTP id 4BjhPV5RFqz1qvJx;
        Fri,  4 Sep 2020 17:27:26 +0200 (CEST)
X-Virus-Scanned: amavisd-new at mnet-online.de
Received: from mail.mnet-online.de ([192.168.8.182])
        by localhost (dynscan1.mail.m-online.net [192.168.6.70]) (amavisd-new, port 10024)
        with ESMTP id Kf3Gla1NFOGd; Fri,  4 Sep 2020 17:27:25 +0200 (CEST)
X-Auth-Info: aFzghDXI8M9qxm1AT993wOhluzB0V7Ffp56KLWYmLEA=
Received: from [IPv6:::1] (p578adb1c.dip0.t-ipconnect.de [87.138.219.28])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by mail.mnet-online.de (Postfix) with ESMTPSA;
        Fri,  4 Sep 2020 17:27:25 +0200 (CEST)
Subject: Re: [PATCH] net: fec: Fix PHY init after phy_reset_after_clk_enable()
To:     Andrew Lunn <andrew@lunn.ch>
Cc:     netdev@vger.kernel.org,
        Christoph Niedermaier <cniedermaier@dh-electronics.com>,
        "David S . Miller" <davem@davemloft.net>,
        NXP Linux Team <linux-imx@nxp.com>,
        Richard Leitner <richard.leitner@skidata.com>,
        Shawn Guo <shawnguo@kernel.org>
References: <20200903202712.143878-1-marex@denx.de>
 <20200903210011.GD3112546@lunn.ch>
 <b6397b39-c897-6e0a-6bf7-b6b24908de1a@denx.de>
 <20200903215331.GG3112546@lunn.ch>
 <02ce2afb-7b9f-ba35-63a5-7496c7a39e6e@denx.de>
 <20200903220847.GI3112546@lunn.ch>
 <c67eb631-a16d-0b52-c2f8-92d017e39258@denx.de>
 <20200904140245.GO3112546@lunn.ch>
From:   Marek Vasut <marex@denx.de>
Message-ID: <b305a989-d9c3-f02a-6935-81c6bcc084c5@denx.de>
Date:   Fri, 4 Sep 2020 17:26:14 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.12.0
MIME-Version: 1.0
In-Reply-To: <20200904140245.GO3112546@lunn.ch>
Content-Type: text/plain; charset=utf-8
Content-Language: en-US
Content-Transfer-Encoding: 7bit
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

On 9/4/20 4:02 PM, Andrew Lunn wrote:
> On Fri, Sep 04, 2020 at 12:45:44AM +0200, Marek Vasut wrote:
>> On 9/4/20 12:08 AM, Andrew Lunn wrote:
>>>>> b4 am 20200903043947.3272453-1-f.fainelli@gmail.com
>>>>
>>>> That might be a fix for the long run, but I doubt there's any chance to
>>>> backport it all to stable, is there ?
>>>
>>> No. For stable we need something simpler.
>>
>> Like this patch ?
> 
> Yes.
> 
> But i would like to see a Tested-By: or similar from Richard
> Leitner. Why does the current code work for his system? Does your
> change break it?

I have the IRQ line connected and described in DT. The reset clears the
IRQ settings done by the SMSC PHY driver. The PHY works fine if I use
polling, because then even if no IRQs are generated by the PHY, the PHY
framework reads the status updates from the PHY periodically and the
default settings of the PHY somehow work (even if they are slightly
incorrect). I suspect that's how Richard had it working.
