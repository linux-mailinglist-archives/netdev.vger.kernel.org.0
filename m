Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 21336315DD
	for <lists+netdev@lfdr.de>; Fri, 31 May 2019 22:10:04 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727486AbfEaUKB (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 31 May 2019 16:10:01 -0400
Received: from mail-eopbgr60043.outbound.protection.outlook.com ([40.107.6.43]:15081
        "EHLO EUR04-DB3-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727476AbfEaUKB (ORCPT <rfc822;netdev@vger.kernel.org>);
        Fri, 31 May 2019 16:10:01 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=5KsAqA/18zQLRyLpIIjvxzTqcONYUjovQudclT+UAHI=;
 b=LR8R4YujpMuwFpvY/NiqQy1MAW9Ba00NEU5fAKAqEpNqP23Q6pNFR5h0vU8Jd7x9DGqf2BF/LP0mRTDOPdunZglrOfHoeSQzT5Y32q9rUKWRMXN9dlruKBFFQ8+MeGh+/FbTT+PcK3F6/OJi63f0S7kyLTt+Zc+bBFMK20dV7eM=
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com (20.178.125.223) by
 VI1PR05MB5600.eurprd05.prod.outlook.com (20.177.203.32) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1922.16; Fri, 31 May 2019 20:09:30 +0000
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::dd31:2532:9adf:9b38]) by VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::dd31:2532:9adf:9b38%6]) with mapi id 15.20.1922.021; Fri, 31 May 2019
 20:09:30 +0000
From:   Saeed Mahameed <saeedm@mellanox.com>
To:     "David S. Miller" <davem@davemloft.net>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        Yevgeny Kliteynik <kliteyn@mellanox.com>,
        Oz Shlomo <ozsh@mellanox.com>,
        Saeed Mahameed <saeedm@mellanox.com>
Subject: [net-next 5/9] net/mlx5e: Geneve, Keep tunnel info as pointer to the
 original struct
Thread-Topic: [net-next 5/9] net/mlx5e: Geneve, Keep tunnel info as pointer to
 the original struct
Thread-Index: AQHVF+zBwyCswkXvl0yP96G8e007Uw==
Date:   Fri, 31 May 2019 20:09:30 +0000
Message-ID: <20190531200838.25184-6-saeedm@mellanox.com>
References: <20190531200838.25184-1-saeedm@mellanox.com>
In-Reply-To: <20190531200838.25184-1-saeedm@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.21.0
x-originating-ip: [209.116.155.178]
x-clientproxiedby: BYAPR07CA0086.namprd07.prod.outlook.com
 (2603:10b6:a03:12b::27) To VI1PR05MB5902.eurprd05.prod.outlook.com
 (2603:10a6:803:df::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=saeedm@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: cfd90cc6-7d45-45f8-01c0-08d6e603e3c3
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(5600148)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);SRVR:VI1PR05MB5600;
x-ms-traffictypediagnostic: VI1PR05MB5600:
x-microsoft-antispam-prvs: <VI1PR05MB5600C39B067F474AAE16B66ABE190@VI1PR05MB5600.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:9508;
x-forefront-prvs: 00540983E2
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(39860400002)(376002)(366004)(136003)(396003)(346002)(189003)(199004)(99286004)(52116002)(2616005)(6116002)(6512007)(107886003)(486006)(54906003)(386003)(476003)(76176011)(186003)(26005)(3846002)(5024004)(11346002)(305945005)(81166006)(66066001)(256004)(6506007)(4326008)(25786009)(6486002)(102836004)(6436002)(66946007)(8936002)(64756008)(7736002)(8676002)(53936002)(66476007)(73956011)(446003)(66556008)(81156014)(66446008)(6916009)(1076003)(68736007)(2906002)(86362001)(71190400001)(14454004)(5660300002)(316002)(508600001)(36756003)(50226002)(71200400001);DIR:OUT;SFP:1101;SCL:1;SRVR:VI1PR05MB5600;H:VI1PR05MB5902.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: iLDmUAQAXHXbAlV43i+v7C7iyiiU8+xZJC+nVs0PDNYtl9NS8OjRnFlbDppd9aT9MVyXtx/Bqe0vkJHiJpJL8pI9LvvLitWBcbdezJyZP3WcFO7Z7b3QpFHwx6IUvHXtIqahlmsELM9OWOCT6KTZZUwsac15dMrza3bFB40q1uzvc7qNbI4/rGF8pXa6O9Ks2JO5c834X6776sKMzmmHV1zcvZ5BEI5BMq9g+2NDc+l2l7UchatVEYtRHy2UQXQl+tdpXDpqheL5aGTKeP3Ve/VRIcQHqrh+mOiKbjzc3rwS34q3FUkFBxKe0iz8eAv5u2D1jBVDQ9k9X5hmCnNy0HrUBa2xj+2quqjs6XQIc0dqoNzepiLHSYOmoCIn7aiQ3i4zAHZgmjNatHHLJOs5J014JJyrBQF23Oe+QNZU6TA=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: cfd90cc6-7d45-45f8-01c0-08d6e603e3c3
X-MS-Exchange-CrossTenant-originalarrivaltime: 31 May 2019 20:09:30.6578
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: saeedm@mellanox.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VI1PR05MB5600
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogWWV2Z2VueSBLbGl0ZXluaWsgPGtsaXRleW5AbWVsbGFub3guY29tPg0KDQpJbiBtbHg1
ZSBlbmNhcCBlbnRyeSBzdHJ1Y3R1cmUsIElQIHR1bm5lbCBpbmZvIGRhdGEgc3RydWN0dXJlIGlz
IGNvcGllZA0KYnkgdmFsdWUuIFRoaXMgYXBwcm9hY2ggd29ya2VkIHRpbGwgbm93LCBidXQgaXQg
YnJlYWtzIHdoZW4gdGhlcmUgYXJlDQplbmNhcHN1bGF0aW9uIG9wdGlvbnMsIHN1Y2ggYXMgaW4g
Y2FzZSBvZiBHZW5ldmUuDQoNClRoZXNlIG9wdGlvbnMgYXJlIHN0b3JlZCBpbiB0aGUgc3RydWN0
dXJlIHRoYXQgaXMgYWxsb2NhdGVkIGFkamFjZW50IHRvDQp0aGUgSVAgdHVubmVsIGluZm8gc3Ry
dWN0LCBhbmQgbm90IHBvaW50ZWQgYXQgYnkgYW55IGZpZWxkIGluIHRoYXQgc3RydWN0Lg0KVGhl
cmVmb3JlLCB3aGVuIGNvcHlpbmcgdGhlIHN0cnVjdCBieSB2YWx1ZSwgd2UgbG9vc2UgdGhlIGFk
ZHJlc3Mgb2YgdGhlDQpvcmlnaW5hbCBzdHJ1Y3QgYW5kIGNhbid0IGdldCB0byB0aGUgZW5jYXBz
dWxhdGlvbiBvcHRpb25zLg0KDQpGaXggdGhlIHByb2JsZW0gYnkgc3RvcmluZyB0aGUgcG9pbnRl
ciB0byB0aGUgdHVubmVsIGluZm8gZGF0YSBpbnN0ZWFkLg0KDQpSZXZpZXdlZC1ieTogT3ogU2hs
b21vIDxvenNoQG1lbGxhbm94LmNvbT4NClNpZ25lZC1vZmYtYnk6IFlldmdlbnkgS2xpdGV5bmlr
IDxrbGl0ZXluQG1lbGxhbm94LmNvbT4NClNpZ25lZC1vZmYtYnk6IFNhZWVkIE1haGFtZWVkIDxz
YWVlZG1AbWVsbGFub3guY29tPg0KLS0tDQogLi4uL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1
L2NvcmUvZW4vdGNfdHVuLmMgICB8IDE1ICsrKysrKysrLS0tLS0tLQ0KIGRyaXZlcnMvbmV0L2V0
aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuaCAgfCAgMiArLQ0KIGRyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90Yy5jICAgfCAxNCArKysrKysrLS0tLS0t
LQ0KIDMgZmlsZXMgY2hhbmdlZCwgMTYgaW5zZXJ0aW9ucygrKSwgMTUgZGVsZXRpb25zKC0pDQoN
CmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4v
dGNfdHVuLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNf
dHVuLmMNCmluZGV4IGZlNWQ0ZDdmMTVlZC4uMjAwNGQwNGM0YzQ2IDEwMDY0NA0KLS0tIGEvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3RjX3R1bi5jDQorKysgYi9k
cml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmMNCkBAIC0x
NDEsNyArMTQxLDggQEAgc3RhdGljIGludCBtbHg1ZV9yb3V0ZV9sb29rdXBfaXB2NihzdHJ1Y3Qg
bWx4NWVfcHJpdiAqcHJpdiwNCiAJcmV0dXJuIDA7DQogfQ0KIA0KLXN0YXRpYyBpbnQgbWx4NWVf
Z2VuX3Z4bGFuX2hlYWRlcihjaGFyIGJ1ZltdLCBzdHJ1Y3QgaXBfdHVubmVsX2tleSAqdHVuX2tl
eSkNCitzdGF0aWMgaW50IG1seDVlX2dlbl92eGxhbl9oZWFkZXIoY2hhciBidWZbXSwNCisJCQkJ
ICBjb25zdCBzdHJ1Y3QgaXBfdHVubmVsX2tleSAqdHVuX2tleSkNCiB7DQogCV9fYmUzMiB0dW5f
aWQgPSB0dW5uZWxfaWRfdG9fa2V5MzIodHVuX2tleS0+dHVuX2lkKTsNCiAJc3RydWN0IHVkcGhk
ciAqdWRwID0gKHN0cnVjdCB1ZHBoZHIgKikoYnVmKTsNCkBAIC0xNTUsNyArMTU2LDcgQEAgc3Rh
dGljIGludCBtbHg1ZV9nZW5fdnhsYW5faGVhZGVyKGNoYXIgYnVmW10sIHN0cnVjdCBpcF90dW5u
ZWxfa2V5ICp0dW5fa2V5KQ0KIAlyZXR1cm4gMDsNCiB9DQogDQotc3RhdGljIGludCBtbHg1ZV9n
ZW5fZ3JlX2hlYWRlcihjaGFyIGJ1ZltdLCBzdHJ1Y3QgaXBfdHVubmVsX2tleSAqdHVuX2tleSkN
CitzdGF0aWMgaW50IG1seDVlX2dlbl9ncmVfaGVhZGVyKGNoYXIgYnVmW10sIGNvbnN0IHN0cnVj
dCBpcF90dW5uZWxfa2V5ICp0dW5fa2V5KQ0KIHsNCiAJX19iZTMyIHR1bl9pZCA9IHR1bm5lbF9p
ZF90b19rZXkzMih0dW5fa2V5LT50dW5faWQpOw0KIAlpbnQgaGRyX2xlbjsNCkBAIC0xODMsNyAr
MTg0LDcgQEAgc3RhdGljIGludCBtbHg1ZV9nZW5faXBfdHVubmVsX2hlYWRlcihjaGFyIGJ1Zltd
LCBfX3U4ICppcF9wcm90bywNCiAJCQkJICAgICAgc3RydWN0IG1seDVlX2VuY2FwX2VudHJ5ICpl
KQ0KIHsNCiAJaW50IGVyciA9IDA7DQotCXN0cnVjdCBpcF90dW5uZWxfa2V5ICprZXkgPSAmZS0+
dHVuX2luZm8ua2V5Ow0KKwljb25zdCBzdHJ1Y3QgaXBfdHVubmVsX2tleSAqa2V5ID0gJmUtPnR1
bl9pbmZvLT5rZXk7DQogDQogCWlmIChlLT50dW5uZWxfdHlwZSA9PSBNTFg1RV9UQ19UVU5ORUxf
VFlQRV9WWExBTikgew0KIAkJKmlwX3Byb3RvID0gSVBQUk9UT19VRFA7DQpAQCAtMjI5LDcgKzIz
MCw3IEBAIGludCBtbHg1ZV90Y190dW5fY3JlYXRlX2hlYWRlcl9pcHY0KHN0cnVjdCBtbHg1ZV9w
cml2ICpwcml2LA0KIAkJCQkgICAgc3RydWN0IG1seDVlX2VuY2FwX2VudHJ5ICplKQ0KIHsNCiAJ
aW50IG1heF9lbmNhcF9zaXplID0gTUxYNV9DQVBfRVNXKHByaXYtPm1kZXYsIG1heF9lbmNhcF9o
ZWFkZXJfc2l6ZSk7DQotCXN0cnVjdCBpcF90dW5uZWxfa2V5ICp0dW5fa2V5ID0gJmUtPnR1bl9p
bmZvLmtleTsNCisJY29uc3Qgc3RydWN0IGlwX3R1bm5lbF9rZXkgKnR1bl9rZXkgPSAmZS0+dHVu
X2luZm8tPmtleTsNCiAJc3RydWN0IG5ldF9kZXZpY2UgKm91dF9kZXYsICpyb3V0ZV9kZXY7DQog
CXN0cnVjdCBuZWlnaGJvdXIgKm4gPSBOVUxMOw0KIAlzdHJ1Y3QgZmxvd2k0IGZsNCA9IHt9Ow0K
QEAgLTM0NSw3ICszNDYsNyBAQCBpbnQgbWx4NWVfdGNfdHVuX2NyZWF0ZV9oZWFkZXJfaXB2Nihz
dHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJCQkJICAgIHN0cnVjdCBtbHg1ZV9lbmNhcF9lbnRy
eSAqZSkNCiB7DQogCWludCBtYXhfZW5jYXBfc2l6ZSA9IE1MWDVfQ0FQX0VTVyhwcml2LT5tZGV2
LCBtYXhfZW5jYXBfaGVhZGVyX3NpemUpOw0KLQlzdHJ1Y3QgaXBfdHVubmVsX2tleSAqdHVuX2tl
eSA9ICZlLT50dW5faW5mby5rZXk7DQorCWNvbnN0IHN0cnVjdCBpcF90dW5uZWxfa2V5ICp0dW5f
a2V5ID0gJmUtPnR1bl9pbmZvLT5rZXk7DQogCXN0cnVjdCBuZXRfZGV2aWNlICpvdXRfZGV2LCAq
cm91dGVfZGV2Ow0KIAlzdHJ1Y3QgbmVpZ2hib3VyICpuID0gTlVMTDsNCiAJc3RydWN0IGZsb3dp
NiBmbDYgPSB7fTsNCkBAIC00ODksNyArNDkwLDcgQEAgaW50IG1seDVlX3RjX3R1bl9pbml0X2Vu
Y2FwX2F0dHIoc3RydWN0IG5ldF9kZXZpY2UgKnR1bm5lbF9kZXYsDQogCWUtPnR1bm5lbF90eXBl
ID0gbWx4NWVfdGNfdHVuX2dldF90eXBlKHR1bm5lbF9kZXYpOw0KIA0KIAlpZiAoZS0+dHVubmVs
X3R5cGUgPT0gTUxYNUVfVENfVFVOTkVMX1RZUEVfVlhMQU4pIHsNCi0JCWludCBkc3RfcG9ydCA9
ICBiZTE2X3RvX2NwdShlLT50dW5faW5mby5rZXkudHBfZHN0KTsNCisJCWludCBkc3RfcG9ydCA9
IGJlMTZfdG9fY3B1KGUtPnR1bl9pbmZvLT5rZXkudHBfZHN0KTsNCiANCiAJCWlmICghbWx4NV92
eGxhbl9sb29rdXBfcG9ydChwcml2LT5tZGV2LT52eGxhbiwgZHN0X3BvcnQpKSB7DQogCQkJTkxf
U0VUX0VSUl9NU0dfTU9EKGV4dGFjaywNCkBAIC01MDMsNyArNTA0LDcgQEAgaW50IG1seDVlX3Rj
X3R1bl9pbml0X2VuY2FwX2F0dHIoc3RydWN0IG5ldF9kZXZpY2UgKnR1bm5lbF9kZXYsDQogCQll
LT50dW5uZWxfaGxlbiA9IFZYTEFOX0hMRU47DQogCX0gZWxzZSBpZiAoZS0+dHVubmVsX3R5cGUg
PT0gTUxYNUVfVENfVFVOTkVMX1RZUEVfR1JFVEFQKSB7DQogCQllLT5yZWZvcm1hdF90eXBlID0g
TUxYNV9SRUZPUk1BVF9UWVBFX0wyX1RPX05WR1JFOw0KLQkJZS0+dHVubmVsX2hsZW4gPSBncmVf
Y2FsY19obGVuKGUtPnR1bl9pbmZvLmtleS50dW5fZmxhZ3MpOw0KKwkJZS0+dHVubmVsX2hsZW4g
PSBncmVfY2FsY19obGVuKGUtPnR1bl9pbmZvLT5rZXkudHVuX2ZsYWdzKTsNCiAJfSBlbHNlIHsN
CiAJCWUtPnJlZm9ybWF0X3R5cGUgPSAtMTsNCiAJCWUtPnR1bm5lbF9obGVuID0gLTE7DQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3JlcC5o
IGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3JlcC5oDQppbmRl
eCBlMzQ1NzNmZDg4YzEuLjU0NzJiYjRhMGI1MSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0
aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuaA0KKysrIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3JlcC5oDQpAQCAtMTUwLDcgKzE1MCw3IEBAIHN0
cnVjdCBtbHg1ZV9lbmNhcF9lbnRyeSB7DQogCXN0cnVjdCBobGlzdF9ub2RlIGVuY2FwX2hsaXN0
Ow0KIAlzdHJ1Y3QgbGlzdF9oZWFkIGZsb3dzOw0KIAl1MzIgZW5jYXBfaWQ7DQotCXN0cnVjdCBp
cF90dW5uZWxfaW5mbyB0dW5faW5mbzsNCisJY29uc3Qgc3RydWN0IGlwX3R1bm5lbF9pbmZvICp0
dW5faW5mbzsNCiAJdW5zaWduZWQgY2hhciBoX2Rlc3RbRVRIX0FMRU5dOwkvKiBkZXN0aW5hdGlv
biBldGggYWRkcgkqLw0KIA0KIAlzdHJ1Y3QgbmV0X2RldmljZSAqb3V0X2RldjsNCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fdGMuYyBiL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90Yy5jDQppbmRleCA4ZTJk
OGU3MzVmYWEuLjhiMDZjOThjZDQzNiAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0
L21lbGxhbm94L21seDUvY29yZS9lbl90Yy5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9t
ZWxsYW5veC9tbHg1L2NvcmUvZW5fdGMuYw0KQEAgLTEyNiw3ICsxMjYsNyBAQCBzdHJ1Y3QgbWx4
NWVfdGNfZmxvdyB7DQogfTsNCiANCiBzdHJ1Y3QgbWx4NWVfdGNfZmxvd19wYXJzZV9hdHRyIHsN
Ci0Jc3RydWN0IGlwX3R1bm5lbF9pbmZvIHR1bl9pbmZvW01MWDVfTUFYX0ZMT1dfRldEX1ZQT1JU
U107DQorCWNvbnN0IHN0cnVjdCBpcF90dW5uZWxfaW5mbyAqdHVuX2luZm9bTUxYNV9NQVhfRkxP
V19GV0RfVlBPUlRTXTsNCiAJc3RydWN0IG5ldF9kZXZpY2UgKmZpbHRlcl9kZXY7DQogCXN0cnVj
dCBtbHg1X2Zsb3dfc3BlYyBzcGVjOw0KIAlpbnQgbnVtX21vZF9oZHJfYWN0aW9uczsNCkBAIC0y
NTY4LDcgKzI1NjgsNyBAQCBzdGF0aWMgaW50IHBhcnNlX3RjX25pY19hY3Rpb25zKHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2LA0KIH0NCiANCiBzdHJ1Y3QgZW5jYXBfa2V5IHsNCi0Jc3RydWN0IGlw
X3R1bm5lbF9rZXkgKmlwX3R1bl9rZXk7DQorCWNvbnN0IHN0cnVjdCBpcF90dW5uZWxfa2V5ICpp
cF90dW5fa2V5Ow0KIAlpbnQgdHVubmVsX3R5cGU7DQogfTsNCiANCkBAIC0yNjEyLDcgKzI2MTIs
NyBAQCBzdGF0aWMgaW50IG1seDVlX2F0dGFjaF9lbmNhcChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJp
diwNCiAJc3RydWN0IG1seDVfZXN3aXRjaCAqZXN3ID0gcHJpdi0+bWRldi0+cHJpdi5lc3dpdGNo
Ow0KIAlzdHJ1Y3QgbWx4NV9lc3dfZmxvd19hdHRyICphdHRyID0gZmxvdy0+ZXN3X2F0dHI7DQog
CXN0cnVjdCBtbHg1ZV90Y19mbG93X3BhcnNlX2F0dHIgKnBhcnNlX2F0dHI7DQotCXN0cnVjdCBp
cF90dW5uZWxfaW5mbyAqdHVuX2luZm87DQorCWNvbnN0IHN0cnVjdCBpcF90dW5uZWxfaW5mbyAq
dHVuX2luZm87DQogCXN0cnVjdCBlbmNhcF9rZXkga2V5LCBlX2tleTsNCiAJc3RydWN0IG1seDVl
X2VuY2FwX2VudHJ5ICplOw0KIAl1bnNpZ25lZCBzaG9ydCBmYW1pbHk7DQpAQCAtMjYyMSw3ICsy
NjIxLDcgQEAgc3RhdGljIGludCBtbHg1ZV9hdHRhY2hfZW5jYXAoc3RydWN0IG1seDVlX3ByaXYg
KnByaXYsDQogCWludCBlcnIgPSAwOw0KIA0KIAlwYXJzZV9hdHRyID0gYXR0ci0+cGFyc2VfYXR0
cjsNCi0JdHVuX2luZm8gPSAmcGFyc2VfYXR0ci0+dHVuX2luZm9bb3V0X2luZGV4XTsNCisJdHVu
X2luZm8gPSBwYXJzZV9hdHRyLT50dW5faW5mb1tvdXRfaW5kZXhdOw0KIAlmYW1pbHkgPSBpcF90
dW5uZWxfaW5mb19hZih0dW5faW5mbyk7DQogCWtleS5pcF90dW5fa2V5ID0gJnR1bl9pbmZvLT5r
ZXk7DQogCWtleS50dW5uZWxfdHlwZSA9IG1seDVlX3RjX3R1bl9nZXRfdHlwZShtaXJyZWRfZGV2
KTsNCkBAIC0yNjMwLDcgKzI2MzAsNyBAQCBzdGF0aWMgaW50IG1seDVlX2F0dGFjaF9lbmNhcChz
dHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiANCiAJaGFzaF9mb3JfZWFjaF9wb3NzaWJsZV9yY3Uo
ZXN3LT5vZmZsb2Fkcy5lbmNhcF90YmwsIGUsDQogCQkJCSAgIGVuY2FwX2hsaXN0LCBoYXNoX2tl
eSkgew0KLQkJZV9rZXkuaXBfdHVuX2tleSA9ICZlLT50dW5faW5mby5rZXk7DQorCQllX2tleS5p
cF90dW5fa2V5ID0gJmUtPnR1bl9pbmZvLT5rZXk7DQogCQllX2tleS50dW5uZWxfdHlwZSA9IGUt
PnR1bm5lbF90eXBlOw0KIAkJaWYgKCFjbXBfZW5jYXBfaW5mbygmZV9rZXksICZrZXkpKSB7DQog
CQkJZm91bmQgPSB0cnVlOw0KQEAgLTI2NDYsNyArMjY0Niw3IEBAIHN0YXRpYyBpbnQgbWx4NWVf
YXR0YWNoX2VuY2FwKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAlpZiAoIWUpDQogCQlyZXR1
cm4gLUVOT01FTTsNCiANCi0JZS0+dHVuX2luZm8gPSAqdHVuX2luZm87DQorCWUtPnR1bl9pbmZv
ID0gdHVuX2luZm87DQogCWVyciA9IG1seDVlX3RjX3R1bl9pbml0X2VuY2FwX2F0dHIobWlycmVk
X2RldiwgcHJpdiwgZSwgZXh0YWNrKTsNCiAJaWYgKGVycikNCiAJCWdvdG8gb3V0X2VycjsNCkBA
IC0yODg1LDcgKzI4ODUsNyBAQCBzdGF0aWMgaW50IHBhcnNlX3RjX2ZkYl9hY3Rpb25zKHN0cnVj
dCBtbHg1ZV9wcml2ICpwcml2LA0KIAkJCX0gZWxzZSBpZiAoZW5jYXApIHsNCiAJCQkJcGFyc2Vf
YXR0ci0+bWlycmVkX2lmaW5kZXhbYXR0ci0+b3V0X2NvdW50XSA9DQogCQkJCQlvdXRfZGV2LT5p
ZmluZGV4Ow0KLQkJCQlwYXJzZV9hdHRyLT50dW5faW5mb1thdHRyLT5vdXRfY291bnRdID0gKmlu
Zm87DQorCQkJCXBhcnNlX2F0dHItPnR1bl9pbmZvW2F0dHItPm91dF9jb3VudF0gPSBpbmZvOw0K
IAkJCQllbmNhcCA9IGZhbHNlOw0KIAkJCQlhdHRyLT5kZXN0c1thdHRyLT5vdXRfY291bnRdLmZs
YWdzIHw9DQogCQkJCQlNTFg1X0VTV19ERVNUX0VOQ0FQOw0KLS0gDQoyLjIxLjANCg0K
