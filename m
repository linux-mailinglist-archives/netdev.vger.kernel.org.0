Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id B489F50FF7
	for <lists+netdev@lfdr.de>; Mon, 24 Jun 2019 17:11:13 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1731168AbfFXPLD (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Mon, 24 Jun 2019 11:11:03 -0400
Received: from mail-eopbgr810078.outbound.protection.outlook.com ([40.107.81.78]:6080
        "EHLO NAM01-BY2-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1726749AbfFXPLC (ORCPT <rfc822;netdev@vger.kernel.org>);
        Mon, 24 Jun 2019 11:11:02 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=AQUANTIA1COM.onmicrosoft.com; s=selector1-AQUANTIA1COM-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=jEbELdY2DtN086QfNtCd6aobfuXl7KXiicnDLObv8JQ=;
 b=I9j/wQtlseMHs9JWnIDStH/JlBvmDCjhfD/gDu0BZjx7tDHNufBUcQXm/+g7t+sOqsDUYQPFjrZ8zQWuXVh32oQpUQKhiRB0epl+42WHlc5kVsBHVZLAaVopDKIq8qHEnUn3CQ7mn6/XFXhWfKk2mv6eFDPmAhMEaaGQuOPLsAs=
Received: from MWHPR11MB1968.namprd11.prod.outlook.com (10.175.55.144) by
 MWHPR11MB1614.namprd11.prod.outlook.com (10.172.56.140) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2008.16; Mon, 24 Jun 2019 15:10:57 +0000
Received: from MWHPR11MB1968.namprd11.prod.outlook.com
 ([fe80::eda4:c685:f6f8:8a1b]) by MWHPR11MB1968.namprd11.prod.outlook.com
 ([fe80::eda4:c685:f6f8:8a1b%7]) with mapi id 15.20.2008.017; Mon, 24 Jun 2019
 15:10:57 +0000
From:   Igor Russkikh <Igor.Russkikh@aquantia.com>
To:     "David S . Miller" <davem@davemloft.net>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        Igor Russkikh <Igor.Russkikh@aquantia.com>
Subject: [PATCH net-next v2 7/8] net: aquantia: vlan offloads logic in
 datapath
Thread-Topic: [PATCH net-next v2 7/8] net: aquantia: vlan offloads logic in
 datapath
Thread-Index: AQHVKp8G/Z2cQ2IaqEKKws/KBgLzkg==
Date:   Mon, 24 Jun 2019 15:10:56 +0000
Message-ID: <ee703274b30499e5b67043e2443ca5c81926b648.1561388549.git.igor.russkikh@aquantia.com>
References: <cover.1561388549.git.igor.russkikh@aquantia.com>
In-Reply-To: <cover.1561388549.git.igor.russkikh@aquantia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HE1P192CA0004.EURP192.PROD.OUTLOOK.COM (2603:10a6:3:fe::14)
 To MWHPR11MB1968.namprd11.prod.outlook.com (2603:10b6:300:113::16)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=Igor.Russkikh@aquantia.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [95.79.108.179]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 7e4e79c2-ebbd-4ce9-5a9b-08d6f8b6287d
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);SRVR:MWHPR11MB1614;
x-ms-traffictypediagnostic: MWHPR11MB1614:
x-microsoft-antispam-prvs: <MWHPR11MB1614224D0B96CF3B2E74BDE898E00@MWHPR11MB1614.namprd11.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:62;
x-forefront-prvs: 007814487B
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(346002)(136003)(39850400004)(396003)(366004)(376002)(189003)(199004)(186003)(8676002)(99286004)(26005)(72206003)(102836004)(6916009)(316002)(81156014)(478600001)(2616005)(476003)(66066001)(76176011)(81166006)(52116002)(66446008)(64756008)(73956011)(66946007)(6506007)(386003)(44832011)(50226002)(446003)(11346002)(486006)(8936002)(54906003)(6436002)(5660300002)(71200400001)(68736007)(107886003)(53936002)(6512007)(71190400001)(2906002)(66476007)(66556008)(86362001)(305945005)(36756003)(25786009)(256004)(118296001)(4326008)(14454004)(6116002)(3846002)(6486002)(7736002)(14444005);DIR:OUT;SFP:1101;SCL:1;SRVR:MWHPR11MB1614;H:MWHPR11MB1968.namprd11.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: aquantia.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: X2wLxCm1HktEVo5j+krulAG6/6jlU/Xii79wt5vyFam2D3kdcvXQNF6BDnEVWg9moYKBe/vJ0bXnraXilRU/RNovKqyF3WSajzcJ7XUr5J83sazb2rkpsIbm+eQfecH3B4KNIq30hfK7Ido40qJqJ6nSXwLcBS1nqi+IeJkhAwYNJ8+YD0YkrkX2U5DvuivNefx0ykv47J4+vAMdZBvnFHPrdBAIDLoA7AXFVMXXgGHdaJ9V7KrSOKUHwxozVczkMYDkjSywWuKrTK985DF5uFf99lih0hCI3wpuxqr6285QvXipZglurCmoZ2rMKQ/XvwsKNytTTk6cZkOY87tehYJmmPDCNdTcVWrOC6M1wLEGpmo3UZMLKRHMLktqFXjVN3i4Sdaf5acK606UD/NbI0frMZDdDZDOEzZNgVWClno=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: aquantia.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 7e4e79c2-ebbd-4ce9-5a9b-08d6f8b6287d
X-MS-Exchange-CrossTenant-originalarrivaltime: 24 Jun 2019 15:10:56.9346
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 83e2e134-991c-4ede-8ced-34d47e38e6b1
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: irusski@aquantia.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MWHPR11MB1614
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

VXBkYXRlIGRhdGFwYXRoIGJ5IGFkZGluZyBsb2dpYyByZWxhdGVkIHRvIGhhcmR3YXJlIGFzc2lz
dGVkDQp2bGFuIHN0cmlwL2luc2VydCBiZWhhdmlvdXIuDQoNClRlc3RlZC1ieTogTmlraXRhIERh
bmlsb3YgPG5kYW5pbG92QGFxdWFudGlhLmNvbT4NClNpZ25lZC1vZmYtYnk6IElnb3IgUnVzc2tp
a2ggPGlnb3IucnVzc2tpa2hAYXF1YW50aWEuY29tPg0KLS0tDQogLi4uL25ldC9ldGhlcm5ldC9h
cXVhbnRpYS9hdGxhbnRpYy9hcV9uaWMuYyAgIHwgMjMgKysrKystLS0NCiAuLi4vbmV0L2V0aGVy
bmV0L2FxdWFudGlhL2F0bGFudGljL2FxX3JpbmcuYyAgfCAgNCArKw0KIC4uLi9hcXVhbnRpYS9h
dGxhbnRpYy9od19hdGwvaHdfYXRsX2IwLmMgICAgICB8IDUyICsrKysrKysrKysrKysrLS0tLS0N
CiAzIGZpbGVzIGNoYW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygtKQ0KDQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvYXF1YW50aWEvYXRsYW50aWMvYXFfbmlj
LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9hcXVhbnRpYS9hdGxhbnRpYy9hcV9uaWMuYw0KaW5k
ZXggYWEwNTIxZThlNzFhLi43NDZmODVlNmRlMTMgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9l
dGhlcm5ldC9hcXVhbnRpYS9hdGxhbnRpYy9hcV9uaWMuYw0KKysrIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvYXF1YW50aWEvYXRsYW50aWMvYXFfbmljLmMNCkBAIC00MjksMjYgKzQyOSwzNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IGFxX25pY19tYXBfc2tiKHN0cnVjdCBhcV9uaWNfcyAqc2VsZiwN
CiAJdW5zaWduZWQgaW50IGR4ID0gcmluZy0+c3dfdGFpbDsNCiAJc3RydWN0IGFxX3JpbmdfYnVm
Zl9zICpmaXJzdCA9IE5VTEw7DQogCXN0cnVjdCBhcV9yaW5nX2J1ZmZfcyAqZHhfYnVmZiA9ICZy
aW5nLT5idWZmX3JpbmdbZHhdOw0KKwlib29sIG5lZWRfY29udGV4dF90YWcgPSBmYWxzZTsNCisN
CisJZHhfYnVmZi0+ZmxhZ3MgPSAwVTsNCiANCiAJaWYgKHVubGlrZWx5KHNrYl9pc19nc28oc2ti
KSkpIHsNCi0JCWR4X2J1ZmYtPmZsYWdzID0gMFU7DQorCQlkeF9idWZmLT5tc3MgPSBza2Jfc2hp
bmZvKHNrYiktPmdzb19zaXplOw0KKwkJZHhfYnVmZi0+aXNfZ3NvID0gMVU7DQogCQlkeF9idWZm
LT5sZW5fcGt0ID0gc2tiLT5sZW47DQogCQlkeF9idWZmLT5sZW5fbDIgPSBFVEhfSExFTjsNCiAJ
CWR4X2J1ZmYtPmxlbl9sMyA9IGlwX2hkcmxlbihza2IpOw0KIAkJZHhfYnVmZi0+bGVuX2w0ID0g
dGNwX2hkcmxlbihza2IpOw0KLQkJZHhfYnVmZi0+bXNzID0gc2tiX3NoaW5mbyhza2IpLT5nc29f
c2l6ZTsNCi0JCWR4X2J1ZmYtPmlzX2dzbyA9IDFVOw0KIAkJZHhfYnVmZi0+ZW9wX2luZGV4ID0g
MHhmZmZmVTsNCi0NCiAJCWR4X2J1ZmYtPmlzX2lwdjYgPQ0KIAkJCShpcF9oZHIoc2tiKS0+dmVy
c2lvbiA9PSA2KSA/IDFVIDogMFU7DQorCQluZWVkX2NvbnRleHRfdGFnID0gdHJ1ZTsNCisJfQ0K
IA0KKwlpZiAoc2VsZi0+YXFfbmljX2NmZy5pc192bGFuX3R4X2luc2VydCAmJiBza2Jfdmxhbl90
YWdfcHJlc2VudChza2IpKSB7DQorCQlkeF9idWZmLT52bGFuX3R4X3RhZyA9IHNrYl92bGFuX3Rh
Z19nZXQoc2tiKTsNCisJCWR4X2J1ZmYtPmxlbl9wa3QgPSBza2ItPmxlbjsNCisJCWR4X2J1ZmYt
PmlzX3ZsYW4gPSAxVTsNCisJCW5lZWRfY29udGV4dF90YWcgPSB0cnVlOw0KKwl9DQorDQorCWlm
IChuZWVkX2NvbnRleHRfdGFnKSB7DQogCQlkeCA9IGFxX3JpbmdfbmV4dF9keChyaW5nLCBkeCk7
DQogCQlkeF9idWZmID0gJnJpbmctPmJ1ZmZfcmluZ1tkeF07DQorCQlkeF9idWZmLT5mbGFncyA9
IDBVOw0KIAkJKytyZXQ7DQogCX0NCiANCi0JZHhfYnVmZi0+ZmxhZ3MgPSAwVTsNCiAJZHhfYnVm
Zi0+bGVuID0gc2tiX2hlYWRsZW4oc2tiKTsNCiAJZHhfYnVmZi0+cGEgPSBkbWFfbWFwX3Npbmds
ZShhcV9uaWNfZ2V0X2RldihzZWxmKSwNCiAJCQkJICAgICBza2ItPmRhdGEsDQpAQCAtNTM3LDcg
KzU0OCw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgYXFfbmljX21hcF9za2Ioc3RydWN0IGFxX25p
Y19zICpzZWxmLA0KIAkgICAgIC0tcmV0LCBkeCA9IGFxX3JpbmdfbmV4dF9keChyaW5nLCBkeCkp
IHsNCiAJCWR4X2J1ZmYgPSAmcmluZy0+YnVmZl9yaW5nW2R4XTsNCiANCi0JCWlmICghZHhfYnVm
Zi0+aXNfZ3NvICYmIGR4X2J1ZmYtPnBhKSB7DQorCQlpZiAoIWR4X2J1ZmYtPmlzX2dzbyAmJiAh
ZHhfYnVmZi0+aXNfdmxhbiAmJiBkeF9idWZmLT5wYSkgew0KIAkJCWlmICh1bmxpa2VseShkeF9i
dWZmLT5pc19zb3ApKSB7DQogCQkJCWRtYV91bm1hcF9zaW5nbGUoYXFfbmljX2dldF9kZXYoc2Vs
ZiksDQogCQkJCQkJIGR4X2J1ZmYtPnBhLA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L2FxdWFudGlhL2F0bGFudGljL2FxX3JpbmcuYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2Fx
dWFudGlhL2F0bGFudGljL2FxX3JpbmcuYw0KaW5kZXggMmE3YjkxZWQxN2M1Li4zOTAxZDc5OTRj
YTEgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9hcXVhbnRpYS9hdGxhbnRpYy9h
cV9yaW5nLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2FxdWFudGlhL2F0bGFudGljL2Fx
X3JpbmcuYw0KQEAgLTQwOSw2ICs0MDksMTAgQEAgaW50IGFxX3JpbmdfcnhfY2xlYW4oc3RydWN0
IGFxX3JpbmdfcyAqc2VsZiwNCiAJCQl9DQogCQl9DQogDQorCQlpZiAoYnVmZi0+aXNfdmxhbikN
CisJCQlfX3ZsYW5faHdhY2NlbF9wdXRfdGFnKHNrYiwgaHRvbnMoRVRIX1BfODAyMVEpLA0KKwkJ
CQkJICAgICAgIGJ1ZmYtPnZsYW5fcnhfdGFnKTsNCisNCiAJCXNrYi0+cHJvdG9jb2wgPSBldGhf
dHlwZV90cmFucyhza2IsIG5kZXYpOw0KIA0KIAkJYXFfcnhfY2hlY2tzdW0oc2VsZiwgYnVmZiwg
c2tiKTsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9hcXVhbnRpYS9hdGxhbnRp
Yy9od19hdGwvaHdfYXRsX2IwLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9hcXVhbnRpYS9hdGxh
bnRpYy9od19hdGwvaHdfYXRsX2IwLmMNCmluZGV4IDc3MzM0NTM3MWJjZi4uMWQyMTY3NTdiYjlk
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvYXF1YW50aWEvYXRsYW50aWMvaHdf
YXRsL2h3X2F0bF9iMC5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9hcXVhbnRpYS9hdGxh
bnRpYy9od19hdGwvaHdfYXRsX2IwLmMNCkBAIC0yNDcsNiArMjQ3LDkgQEAgc3RhdGljIGludCBo
d19hdGxfYjBfaHdfb2ZmbG9hZF9zZXQoc3RydWN0IGFxX2h3X3MgKnNlbGYsDQogCS8qIExTTyBv
ZmZsb2FkcyovDQogCWh3X2F0bF90ZG1fbGFyZ2Vfc2VuZF9vZmZsb2FkX2VuX3NldChzZWxmLCAw
eEZGRkZGRkZGVSk7DQogDQorCS8qIE91dGVyIFZMQU4gdGFnIG9mZmxvYWQgKi8NCisJaHdfYXRs
X3Jwb19vdXRlcl92bGFuX3RhZ19tb2RlX3NldChzZWxmLCAxVSk7DQorDQogLyogTFJPIG9mZmxv
YWRzICovDQogCXsNCiAJCXVuc2lnbmVkIGludCB2YWwgPSAoOFUgPCBIV19BVExfQjBfTFJPX1JY
RF9NQVgpID8gMHgzVSA6DQpAQCAtNDg5LDYgKzQ5Miw3IEBAIHN0YXRpYyBpbnQgaHdfYXRsX2Iw
X2h3X3JpbmdfdHhfeG1pdChzdHJ1Y3QgYXFfaHdfcyAqc2VsZiwNCiAJdW5zaWduZWQgaW50IGJ1
ZmZfcGFfbGVuID0gMFU7DQogCXVuc2lnbmVkIGludCBwa3RfbGVuID0gMFU7DQogCXVuc2lnbmVk
IGludCBmcmFnX2NvdW50ID0gMFU7DQorCWJvb2wgaXNfdmxhbiA9IGZhbHNlOw0KIAlib29sIGlz
X2dzbyA9IGZhbHNlOw0KIA0KIAlidWZmID0gJnJpbmctPmJ1ZmZfcmluZ1tyaW5nLT5zd190YWls
XTsNCkBAIC01MDQsMzUgKzUwOCw0MyBAQCBzdGF0aWMgaW50IGh3X2F0bF9iMF9od19yaW5nX3R4
X3htaXQoc3RydWN0IGFxX2h3X3MgKnNlbGYsDQogCQlidWZmID0gJnJpbmctPmJ1ZmZfcmluZ1ty
aW5nLT5zd190YWlsXTsNCiANCiAJCWlmIChidWZmLT5pc19nc28pIHsNCisJCQl0eGQtPmN0bCB8
PSBIV19BVExfQjBfVFhEX0NUTF9DTURfVENQOw0KKwkJCXR4ZC0+Y3RsIHw9IEhXX0FUTF9CMF9U
WERfQ1RMX0RFU0NfVFlQRV9UWEM7DQogCQkJdHhkLT5jdGwgfD0gKGJ1ZmYtPmxlbl9sMyA8PCAz
MSkgfA0KLQkJCQkoYnVmZi0+bGVuX2wyIDw8IDI0KSB8DQotCQkJCUhXX0FUTF9CMF9UWERfQ1RM
X0NNRF9UQ1AgfA0KLQkJCQlIV19BVExfQjBfVFhEX0NUTF9ERVNDX1RZUEVfVFhDOw0KLQkJCXR4
ZC0+Y3RsMiB8PSAoYnVmZi0+bXNzIDw8IDE2KSB8DQotCQkJCShidWZmLT5sZW5fbDQgPDwgOCkg
fA0KLQkJCQkoYnVmZi0+bGVuX2wzID4+IDEpOw0KKwkJCQkgICAgKGJ1ZmYtPmxlbl9sMiA8PCAy
NCk7DQorCQkJdHhkLT5jdGwyIHw9IChidWZmLT5tc3MgPDwgMTYpOw0KKwkJCWlzX2dzbyA9IHRy
dWU7DQogDQogCQkJcGt0X2xlbiAtPSAoYnVmZi0+bGVuX2w0ICsNCiAJCQkJICAgIGJ1ZmYtPmxl
bl9sMyArDQogCQkJCSAgICBidWZmLT5sZW5fbDIpOw0KLQkJCWlzX2dzbyA9IHRydWU7DQotDQog
CQkJaWYgKGJ1ZmYtPmlzX2lwdjYpDQogCQkJCXR4ZC0+Y3RsIHw9IEhXX0FUTF9CMF9UWERfQ1RM
X0NNRF9JUFY2Ow0KLQkJfSBlbHNlIHsNCisJCQl0eGQtPmN0bDIgfD0gKGJ1ZmYtPmxlbl9sNCA8
PCA4KSB8DQorCQkJCSAgICAgKGJ1ZmYtPmxlbl9sMyA+PiAxKTsNCisJCX0NCisJCWlmIChidWZm
LT5pc192bGFuKSB7DQorCQkJdHhkLT5jdGwgfD0gSFdfQVRMX0IwX1RYRF9DVExfREVTQ19UWVBF
X1RYQzsNCisJCQl0eGQtPmN0bCB8PSBidWZmLT52bGFuX3R4X3RhZyA8PCA0Ow0KKwkJCWlzX3Zs
YW4gPSB0cnVlOw0KKwkJfQ0KKwkJaWYgKCFidWZmLT5pc19nc28gJiYgIWJ1ZmYtPmlzX3ZsYW4p
IHsNCiAJCQlidWZmX3BhX2xlbiA9IGJ1ZmYtPmxlbjsNCiANCiAJCQl0eGQtPmJ1Zl9hZGRyID0g
YnVmZi0+cGE7DQogCQkJdHhkLT5jdGwgfD0gKEhXX0FUTF9CMF9UWERfQ1RMX0JMRU4gJg0KIAkJ
CQkJCSgodTMyKWJ1ZmZfcGFfbGVuIDw8IDQpKTsNCiAJCQl0eGQtPmN0bCB8PSBIV19BVExfQjBf
VFhEX0NUTF9ERVNDX1RZUEVfVFhEOw0KKw0KIAkJCS8qIFBBWV9MRU4gKi8NCiAJCQl0eGQtPmN0
bDIgfD0gSFdfQVRMX0IwX1RYRF9DVEwyX0xFTiAmIChwa3RfbGVuIDw8IDE0KTsNCiANCi0JCQlp
ZiAoaXNfZ3NvKSB7DQotCQkJCXR4ZC0+Y3RsIHw9IEhXX0FUTF9CMF9UWERfQ1RMX0NNRF9MU087
DQorCQkJaWYgKGlzX2dzbyB8fCBpc192bGFuKSB7DQorCQkJCS8qIGVuYWJsZSB0eCBjb250ZXh0
ICovDQogCQkJCXR4ZC0+Y3RsMiB8PSBIV19BVExfQjBfVFhEX0NUTDJfQ1RYX0VOOw0KIAkJCX0N
CisJCQlpZiAoaXNfZ3NvKQ0KKwkJCQl0eGQtPmN0bCB8PSBIV19BVExfQjBfVFhEX0NUTF9DTURf
TFNPOw0KIA0KIAkJCS8qIFR4IGNoZWNrc3VtIG9mZmxvYWRzICovDQogCQkJaWYgKGJ1ZmYtPmlz
X2lwX2NzbykNCkBAIC01NDEsMTMgKzU1MywxNiBAQCBzdGF0aWMgaW50IGh3X2F0bF9iMF9od19y
aW5nX3R4X3htaXQoc3RydWN0IGFxX2h3X3MgKnNlbGYsDQogCQkJaWYgKGJ1ZmYtPmlzX3VkcF9j
c28gfHwgYnVmZi0+aXNfdGNwX2NzbykNCiAJCQkJdHhkLT5jdGwgfD0gSFdfQVRMX0IwX1RYRF9D
VExfQ01EX1RVQ1NPOw0KIA0KKwkJCWlmIChpc192bGFuKQ0KKwkJCQl0eGQtPmN0bCB8PSBIV19B
VExfQjBfVFhEX0NUTF9DTURfVkxBTjsNCisNCiAJCQlpZiAodW5saWtlbHkoYnVmZi0+aXNfZW9w
KSkgew0KIAkJCQl0eGQtPmN0bCB8PSBIV19BVExfQjBfVFhEX0NUTF9FT1A7DQogCQkJCXR4ZC0+
Y3RsIHw9IEhXX0FUTF9CMF9UWERfQ1RMX0NNRF9XQjsNCiAJCQkJaXNfZ3NvID0gZmFsc2U7DQor
CQkJCWlzX3ZsYW4gPSBmYWxzZTsNCiAJCQl9DQogCQl9DQotDQogCQlyaW5nLT5zd190YWlsID0g
YXFfcmluZ19uZXh0X2R4KHJpbmcsIHJpbmctPnN3X3RhaWwpOw0KIAl9DQogDQpAQCAtNjg1LDEx
ICs3MDAsMTUgQEAgc3RhdGljIGludCBod19hdGxfYjBfaHdfcmluZ19yeF9yZWNlaXZlKHN0cnVj
dCBhcV9od19zICpzZWxmLA0KIA0KIAkJYnVmZiA9ICZyaW5nLT5idWZmX3JpbmdbcmluZy0+aHdf
aGVhZF07DQogDQorCQlidWZmLT5mbGFncyA9IDBVOw0KKwkJYnVmZi0+aXNfaGFzaF9sNCA9IDBV
Ow0KKw0KIAkJcnhfc3RhdCA9ICgweDAwMDAwMDNDVSAmIHJ4ZF93Yi0+c3RhdHVzKSA+PiAyOw0K
IA0KIAkJaXNfcnhfY2hlY2tfc3VtX2VuYWJsZWQgPSAocnhkX3diLT50eXBlID4+IDE5KSAmIDB4
M1U7DQogDQotCQlwa3RfdHlwZSA9IDB4RkZVICYgKHJ4ZF93Yi0+dHlwZSA+PiA0KTsNCisJCXBr
dF90eXBlID0gKHJ4ZF93Yi0+dHlwZSAmIEhXX0FUTF9CMF9SWERfV0JfU1RBVF9QS1RUWVBFKSA+
Pg0KKwkJCSAgIEhXX0FUTF9CMF9SWERfV0JfU1RBVF9QS1RUWVBFX1NISUZUOw0KIA0KIAkJaWYg
KGlzX3J4X2NoZWNrX3N1bV9lbmFibGVkICYgQklUKDApICYmDQogCQkgICAgKDB4MFUgPT0gKHBr
dF90eXBlICYgMHgzVSkpKQ0KQEAgLTcxMCw2ICs3MjksMTMgQEAgc3RhdGljIGludCBod19hdGxf
YjBfaHdfcmluZ19yeF9yZWNlaXZlKHN0cnVjdCBhcV9od19zICpzZWxmLA0KIAkJCWJ1ZmYtPmlz
X2Nzb19lcnIgPSAwVTsNCiAJCX0NCiANCisJCWlmIChzZWxmLT5hcV9uaWNfY2ZnLT5pc192bGFu
X3J4X3N0cmlwICYmDQorCQkgICAgKChwa3RfdHlwZSAmIEhXX0FUTF9CMF9SWERfV0JfUEtUVFlQ
RV9WTEFOKSB8fA0KKwkJICAgICAocGt0X3R5cGUgJiBIV19BVExfQjBfUlhEX1dCX1BLVFRZUEVf
VkxBTl9ET1VCTEUpKSkgew0KKwkJCWJ1ZmYtPmlzX3ZsYW4gPSAxOw0KKwkJCWJ1ZmYtPnZsYW5f
cnhfdGFnID0gbGUxNl90b19jcHUocnhkX3diLT52bGFuKTsNCisJCX0NCisNCiAJCWlmICgocnhf
c3RhdCAmIEJJVCgwKSkgfHwgcnhkX3diLT50eXBlICYgMHgxMDAwVSkgew0KIAkJCS8qIE1BQyBl
cnJvciBvciBETUEgZXJyb3IgKi8NCiAJCQlidWZmLT5pc19lcnJvciA9IDFVOw0KLS0gDQoyLjE3
LjENCg0K
