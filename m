Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id C0A7F1840BA
	for <lists+netdev@lfdr.de>; Fri, 13 Mar 2020 07:03:45 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726406AbgCMGDP (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 13 Mar 2020 02:03:15 -0400
Received: from mail-eopbgr140055.outbound.protection.outlook.com ([40.107.14.55]:28672
        "EHLO EUR01-VE1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1725860AbgCMGDP (ORCPT <rfc822;netdev@vger.kernel.org>);
        Fri, 13 Mar 2020 02:03:15 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=m61jnuvFbuCNMOG1TjskbMy4LSvgNrNeLpU5xarYa5extK4ugJrRgKiDzJW4SUM9IMhQz7q5EU31JoqeIXcvwzVMH9ol3JkhzksRbRMe1cpAnJtPU8Nlw9HeaR2ztpb2kFJ1JxIatOCdrYNnwDPKjlnllez8swJKSuAfXdv8PeofPZFOMZrSJmNnUhrTncMZNQMx5XBdO3I/f/vdzrkXwfhqTE00nb4tHDBs5oQbV2qgpoALAZIysfD+s/oAp2+tXIbNfI3huN0up9T0fwRfy540nVrdXiudX97BQWCchREzsVl8Qs5Piwpchgl8lsRElKflIRtqZM5hu8zRogM8Gw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=uqQlhfowoCOaY8NHTrkaoA+vgQjUfgJkkH2+fA8CtIg=;
 b=ViZzFonqCYfq8ukHSFNMX/3N1/t35mr6a+7Nxo0yDxgrvSeDFpyO1Z9fx/RB1WWpTHcViFgvNg5YHEqPqUqP1Kb/UW+mySAM8X2/qhD+VetcM7Thoqa3okhb3NXRHu2kGK2gvOhVE4m0yLfbi01XhRWMXEdnFiJXaMsxIeqfqzUGh5TDMSsZnTfV5ms8lmQF30TJ5avGYoZ83yqbqYX2ztviaU6R0awKEM77Nawlgp3XWbbYvAfP1I8PImQmDSwbfw+UsmnUlMNxyBMAEPSo5+DVM/uED5FCB/lRKfMM4+jOIkca8pdcREw7CvHzW6u7Umk5mROZvggtv2wLBzPzfQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=nxp.com; dmarc=pass action=none header.from=nxp.com; dkim=pass
 header.d=nxp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=uqQlhfowoCOaY8NHTrkaoA+vgQjUfgJkkH2+fA8CtIg=;
 b=nAK84bExhVp7GAosPB8NuvDSoqoSpx57K1C+54CxlqQUhG4iq46iISt8hr61Q0mCexzOnjSkOeHNNCa2iuaaL7/9RiQAtLStP4JqF84Y9fUK9c0I+r/F3Wjelfw1Lu/+ZfXNwQqDXSmgVMq3dkQ2x3QwqE1WTou+cn8aLQopQWk=
Received: from VE1PR04MB6496.eurprd04.prod.outlook.com (20.179.232.221) by
 VE1PR04MB6751.eurprd04.prod.outlook.com (20.179.235.216) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2793.17; Fri, 13 Mar 2020 05:59:31 +0000
Received: from VE1PR04MB6496.eurprd04.prod.outlook.com
 ([fe80::8cb8:5c41:d843:b66d]) by VE1PR04MB6496.eurprd04.prod.outlook.com
 ([fe80::8cb8:5c41:d843:b66d%5]) with mapi id 15.20.2814.018; Fri, 13 Mar 2020
 05:59:31 +0000
From:   Po Liu <po.liu@nxp.com>
To:     Vinicius Costa Gomes <vinicius.gomes@intel.com>,
        "davem@davemloft.net" <davem@davemloft.net>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>
CC:     Claudiu Manoil <claudiu.manoil@nxp.com>,
        Vladimir Oltean <vladimir.oltean@nxp.com>,
        Alexandru Marginean <alexandru.marginean@nxp.com>,
        Xiaoliang Yang <xiaoliang.yang_1@nxp.com>,
        Roy Zang <roy.zang@nxp.com>, Mingkai Hu <mingkai.hu@nxp.com>,
        Jerry Huang <jerry.huang@nxp.com>, Leo Li <leoyang.li@nxp.com>,
        "michael.chan@broadcom.com" <michael.chan@broadcom.com>,
        "vishal@chelsio.com" <vishal@chelsio.com>,
        "saeedm@mellanox.com" <saeedm@mellanox.com>,
        "leon@kernel.org" <leon@kernel.org>,
        "jiri@mellanox.com" <jiri@mellanox.com>,
        "idosch@mellanox.com" <idosch@mellanox.com>,
        "alexandre.belloni@bootlin.com" <alexandre.belloni@bootlin.com>,
        "UNGLinuxDriver@microchip.com" <UNGLinuxDriver@microchip.com>,
        "kuba@kernel.org" <kuba@kernel.org>,
        "jhs@mojatatu.com" <jhs@mojatatu.com>,
        "xiyou.wangcong@gmail.com" <xiyou.wangcong@gmail.com>,
        "simon.horman@netronome.com" <simon.horman@netronome.com>,
        "pablo@netfilter.org" <pablo@netfilter.org>,
        "moshe@mellanox.com" <moshe@mellanox.com>,
        "m-karicheri2@ti.com" <m-karicheri2@ti.com>,
        "andre.guedes@linux.intel.com" <andre.guedes@linux.intel.com>
Subject: RE: [EXT] Re: [RFC,net-next  5/9] net: enetc: add tc flower psfp
 offload driver
Thread-Topic: [EXT] Re: [RFC,net-next  5/9] net: enetc: add tc flower psfp
 offload driver
Thread-Index: AQHV87lKpznc1rUAI0eb5Z2yXsBQiahFj7IAgABmaPA=
Date:   Fri, 13 Mar 2020 05:59:31 +0000
Message-ID: <VE1PR04MB6496A173B10DAEC741471BB092FA0@VE1PR04MB6496.eurprd04.prod.outlook.com>
References: <20200306125608.11717-1-Po.Liu@nxp.com>
 <20200306125608.11717-6-Po.Liu@nxp.com> <87y2s5gr0l.fsf@linux.intel.com>
In-Reply-To: <87y2s5gr0l.fsf@linux.intel.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: spf=none (sender IP is ) smtp.mailfrom=po.liu@nxp.com; 
x-originating-ip: [119.31.174.68]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 1d15b42e-0336-4c0e-7d0b-08d7c713b317
x-ms-traffictypediagnostic: VE1PR04MB6751:|VE1PR04MB6751:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <VE1PR04MB6751FF0B3C856FF4E2D6C8DD92FA0@VE1PR04MB6751.eurprd04.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:6790;
x-forefront-prvs: 034119E4F6
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(4636009)(396003)(346002)(136003)(376002)(39860400002)(366004)(199004)(478600001)(4326008)(66476007)(81166006)(8676002)(52536014)(2906002)(86362001)(66946007)(7416002)(66556008)(64756008)(81156014)(66446008)(8936002)(76116006)(316002)(71200400001)(54906003)(110136005)(55016002)(33656002)(5660300002)(9686003)(26005)(44832011)(6506007)(7696005)(186003)(30864003)(142933001)(579004)(559001);DIR:OUT;SFP:1101;SCL:1;SRVR:VE1PR04MB6751;H:VE1PR04MB6496.eurprd04.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;A:1;
received-spf: None (protection.outlook.com: nxp.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: jsMmXATO33ZQ5q+uylZx1IbLn12Fp8zS7BzXHcaFWZ+20RDKzWUGWjGwsiE43sRNT3xA1/vEBWZ/2wtcjwmHvSo/EdQTGnszXAlYQmyh5AnZmN/GehUISPDcYAIYrqqBfBk150ex2S9YsT+lPjZrfn44ywyQkeJuhBCMgMX+Co9WNK1Yya3t+Y261kDdwVc290e51kPwVdhdpkXF3KWhHGgMeSywPg4kA8MyNrHOJHBgebBtsEA9S1KA2gidLGFM58oUJUQmSOyzjXFs8Ne7YEN+cOE8BhaAraFRZrOeBX83zuzzI0q8nMF00bYoFIw2in3tLgxvMXf5Yj336OWE4PUuFaSvc9taAn7/Lc1pT1b5mv93FJolPFzbI23XOfxbXZF/P7LutnOwd1tPLdhH1qKvgvot1NNOAogJs8XMIn7t+LOOuLz+nwCV8GLqIyfQAdOVc9wRCvewEObW/YFXXM44WNWAaVx3nmXhDxk3OCLn4UUhMVJgFH24+f0pUsto
x-ms-exchange-antispam-messagedata: SFMK0DMvOWe8L+fNsmYnrmN3mueHCk00Dda1nseapbkOTMJxIvm+Hp0KkNr7/cB9tHK/3HZedJQ9V8viRCnfCFyHxqhEobyoHijsiXJ46adyobEL3/6WGCoIhgGOaJQwWqmEXFpvKiU8rONvktbjyw==
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 1d15b42e-0336-4c0e-7d0b-08d7c713b317
X-MS-Exchange-CrossTenant-originalarrivaltime: 13 Mar 2020 05:59:31.6573
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: pZE/n6VAbV1f0xiL2H/lCQUKj9xJ2M5bTuxdHYgXzVdyMW3Xr88KNxPAJpKZ7xZb
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VE1PR04MB6751
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

SGkgVmluaWNpdXMNCg0KPiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBWaW5p
Y2l1cyBDb3N0YSBHb21lcyA8dmluaWNpdXMuZ29tZXNAaW50ZWwuY29tPg0KPiBTZW50OiAyMDIw
5bm0M+aciDEz5pelIDY6MTQNCg0KPiA+ICBzdHJ1Y3QgZW5ldGNfY2JkIHsNCj4gPiAgICAgICB1
bmlvbnsNCj4gDQo+IFdyb25nIGlkZW50YXRpb24gaGVyZS4gU2hvdWxkIGJlIGZpeGVkIG9uIGEg
c2VwYXJhdGVkIHBhdGNoLg0KDQpUaGFua3MuIA0KDQo+IA0KPiA+ICBzdGF0aWMgdTE2IGVuZXRj
X2dldF9tYXhfZ2NsX2xlbihzdHJ1Y3QgZW5ldGNfaHcgKmh3KQ0KPiA+ICB7DQo+ID4gQEAgLTEw
OCwxMyArMTEwLDEzIEBAIHN0YXRpYyBpbnQgZW5ldGNfc2V0dXBfdGFwcmlvKHN0cnVjdCBuZXRf
ZGV2aWNlDQo+ICpuZGV2LA0KPiA+ICAgICAgIGdjbF9kYXRhLT5jdGUgPSBjcHVfdG9fbGUzMihh
ZG1pbl9jb25mLT5jeWNsZV90aW1lX2V4dGVuc2lvbik7DQo+ID4NCj4gPiAgICAgICBmb3IgKGkg
PSAwOyBpIDwgZ2NsX2xlbjsgaSsrKSB7DQo+ID4gLSAgICAgICAgICAgICBzdHJ1Y3QgdGNfdGFw
cmlvX3NjaGVkX2VudHJ5ICp0ZW1wX2VudHJ5Ow0KPiA+ICsgICAgICAgICAgICAgc3RydWN0IHRj
X3RhcHJpb19zY2hlZF9lbnRyeSAqdG87DQo+ID4gICAgICAgICAgICAgICBzdHJ1Y3QgZ2NlICp0
ZW1wX2djZSA9IGdjZSArIGk7DQo+ID4NCj4gPiAtICAgICAgICAgICAgIHRlbXBfZW50cnkgPSAm
YWRtaW5fY29uZi0+ZW50cmllc1tpXTsNCj4gPiArICAgICAgICAgICAgIHRvID0gJmFkbWluX2Nv
bmYtPmVudHJpZXNbaV07DQo+ID4NCj4gPiAtICAgICAgICAgICAgIHRlbXBfZ2NlLT5nYXRlID0g
KHU4KXRlbXBfZW50cnktPmdhdGVfbWFzazsNCj4gPiAtICAgICAgICAgICAgIHRlbXBfZ2NlLT5w
ZXJpb2QgPSBjcHVfdG9fbGUzMih0ZW1wX2VudHJ5LT5pbnRlcnZhbCk7DQo+ID4gKyAgICAgICAg
ICAgICB0ZW1wX2djZS0+Z2F0ZSA9ICh1OCl0by0+Z2F0ZV9tYXNrOw0KPiA+ICsgICAgICAgICAg
ICAgdGVtcF9nY2UtPnBlcmlvZCA9IGNwdV90b19sZTMyKHRvLT5pbnRlcnZhbCk7DQo+IA0KPiBU
aGVzZSBjaGFuZ2VzIHNlZW0gdW5yZWxhdGVkIHRvIHRoZSBzZXJpZXMuDQoNClRoYW5rcywgdGhl
c2Ugc2hvdWxkIGJlIG1pcyBvcGVyYXRpb24gYnkgcmVwbGFjZS4NCg0KPiANCj4gPiAgICAgICB9
DQo+ID4NCj4gPiAgICAgICBjYmQubGVuZ3RoID0gY3B1X3RvX2xlMTYoZGF0YV9zaXplKTsNCj4g
PiBAQCAtMzMxLDMgKzMzMywxMDcxIEBAIGludCBlbmV0Y19zZXR1cF90Y190eHRpbWUoc3RydWN0
IG5ldF9kZXZpY2UNCj4gKm5kZXYsIHZvaWQgKnR5cGVfZGF0YSkNCj4gPg0KPiA+ICAgICAgIHJl
dHVybiAwOw0KPiA+ICB9DQo+ID4gKw0KPiA+ICtlbnVtIHN0cmVhbWlkX3R5cGUgew0KPiA+ICsg
ICAgIFNUUkVBTUlEX1RZUEVfUkVTRVJWRUQgPSAwLA0KPiA+ICsgICAgIFNUUkVBTUlEX1RZUEVf
TlVMTCwNCj4gPiArICAgICBTVFJFQU1JRF9UWVBFX1NNQUMsDQo+ID4gK307DQo+ID4gKw0KPiA+
ICtlbnVtIHN0cmVhbWlkX3ZsYW5fdGFnZ2VkIHsNCj4gPiArICAgICBTVFJFQU1JRF9WTEFOX1JF
U0VSVkVEID0gMCwNCj4gPiArICAgICBTVFJFQU1JRF9WTEFOX1RBR0dFRCwNCj4gPiArICAgICBT
VFJFQU1JRF9WTEFOX1VOVEFHR0VELA0KPiA+ICsgICAgIFNUUkVBTUlEX1ZMQU5fQUxMLA0KPiA+
ICt9Ow0KPiA+ICsNCj4gPiArI2RlZmluZSBFTkVUQ19QU0ZQX1dJTERDQVJEIC0xDQo+ID4gKyNk
ZWZpbmUgSEFORExFX09GRlNFVCAxMDANCj4gPiArDQo+ID4gK2VudW0gZm9yd2FyZF90eXBlIHsN
Cj4gPiArICAgICBGSUxURVJfQUNUSU9OX1RZUEVfUFNGUCA9IEJJVCgwKSwNCj4gPiArICAgICBG
SUxURVJfQUNUSU9OX1RZUEVfQUNMID0gQklUKDEpLA0KPiA+ICsgICAgIEZJTFRFUl9BQ1RJT05f
VFlQRV9CT1RIID0gR0VOTUFTSygxLCAwKSwNCj4gPiArfTsNCj4gPiArDQo+ID4gKy8qIFRoaXMg
aXMgZm9yIGxpbWl0IG91dHB1dCB0eXBlIGZvciBpbnB1dCBhY3Rpb25zICovDQo+ID4gK3N0cnVj
dCBhY3Rpb25zX2Z3ZCB7DQo+ID4gKyAgICAgdTY0IGFjdGlvbnM7DQo+ID4gKyAgICAgdTY0IGtl
eXM7ICAgICAgIC8qIGluY2x1ZGUgdGhlIG11c3QgbmVlZGVkIGtleXMgKi8NCj4gPiArICAgICBl
bnVtIGZvcndhcmRfdHlwZSBvdXRwdXQ7DQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdHJ1Y3QgcHNm
cF9zdHJlYW1maWx0ZXJfY291bnRlcnMgew0KPiA+ICsgICAgIHU2NCBtYXRjaGluZ19mcmFtZXNf
Y291bnQ7DQo+ID4gKyAgICAgdTY0IHBhc3NpbmdfZnJhbWVzX2NvdW50Ow0KPiA+ICsgICAgIHU2
NCBub3RfcGFzc2luZ19mcmFtZXNfY291bnQ7DQo+ID4gKyAgICAgdTY0IHBhc3Npbmdfc2R1X2Nv
dW50Ow0KPiA+ICsgICAgIHU2NCBub3RfcGFzc2luZ19zZHVfY291bnQ7DQo+ID4gKyAgICAgdTY0
IHJlZF9mcmFtZXNfY291bnQ7DQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdHJ1Y3QgZW5ldGNfc3Ry
ZWFtaWQgew0KPiA+ICsgICAgIHUzMiBpbmRleDsNCj4gPiArICAgICB1bmlvbiB7DQo+ID4gKyAg
ICAgICAgICAgICB1OCBzcmNfbWFjWzZdOw0KPiA+ICsgICAgICAgICAgICAgdTggZHN0X21hY1s2
XTsNCj4gPiArICAgICB9Ow0KPiA+ICsgICAgIHU4IGZpbHRlcnR5cGU7DQo+ID4gKyAgICAgdTE2
IHZpZDsNCj4gPiArICAgICB1OCB0YWdnZWQ7DQo+ID4gKyAgICAgczMyIGhhbmRsZTsNCj4gPiAr
fTsNCj4gPiArDQo+ID4gK3N0cnVjdCBlbmV0Y19wc2ZwX2ZpbHRlciB7DQo+ID4gKyAgICAgdTMy
IGluZGV4Ow0KPiA+ICsgICAgIHMzMiBoYW5kbGU7DQo+ID4gKyAgICAgczggcHJpbzsNCj4gPiAr
ICAgICB1MzIgZ2F0ZV9pZDsNCj4gPiArICAgICBzMzIgbWV0ZXJfaWQ7DQo+ID4gKyAgICAgdTMy
IHJlZmNvdW50Ow0KPiANCj4gSXQgbWF5IGJlIG1vcmUgYXBwcm9wcmlhdGUgdG8gdXNlIDxsaW51
eC9yZWZjb3VudC5oPiBpbnN0ZWFkIG9mIHJvbGxpbmcNCj4geW91ciBvd24uDQoNCk9rLCB3aWxs
IHRyeS4gdGhhbmtzLg0KDQo+IA0KPiA+ICsgICAgIHN0cnVjdCBobGlzdF9ub2RlIG5vZGU7DQo+
ID4gK307DQo+ID4gKw0KPiA+ICtzdHJ1Y3QgZW5ldGNfcHNmcF9nYXRlIHsNCj4gPiArICAgICB1
MzIgaW5kZXg7DQo+ID4gKyAgICAgczggaW5pdF9pcHY7DQo+ID4gKyAgICAgdTY0IGJhc2V0aW1l
Ow0KPiA+ICsgICAgIHU2NCBjeWNsZXRpbWU7DQo+ID4gKyAgICAgdTY0IGN5Y2xldGltZXh0Ow0K
PiA+ICsgICAgIHUzMiBudW1fZW50cmllczsNCj4gPiArICAgICB1MzIgcmVmY291bnQ7DQo+ID4g
KyAgICAgc3RydWN0IGhsaXN0X25vZGUgbm9kZTsNCj4gPiArICAgICBzdHJ1Y3QgYWN0aW9uX2dh
dGVfZW50cnkgZW50cmllc1swXTsNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0cnVjdCBlbmV0Y19z
dHJlYW1fZmlsdGVyIHsNCj4gPiArICAgICBzdHJ1Y3QgZW5ldGNfc3RyZWFtaWQgc2lkOw0KPiA+
ICsgICAgIHUzMiBzZmlfaW5kZXg7DQo+ID4gKyAgICAgdTMyIHNnaV9pbmRleDsNCj4gPiArICAg
ICBzdHJ1Y3QgZmxvd19zdGF0cyBzdGF0czsNCj4gPiArICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSBu
b2RlOw0KPiA+ICt9Ow0KPiA+ICsNCj4gPiArc3RydWN0IGVuZXRjX3BzZnAgew0KPiA+ICsgICAg
IHVuc2lnbmVkIGxvbmcgZGV2X2JpdG1hcDsNCj4gPiArICAgICB1bnNpZ25lZCBsb25nICpwc2Zw
X3NmaV9iaXRtYXA7DQo+ID4gKyAgICAgc3RydWN0IGhsaXN0X2hlYWQgc3RyZWFtX2xpc3Q7DQo+
ID4gKyAgICAgc3RydWN0IGhsaXN0X2hlYWQgcHNmcF9maWx0ZXJfbGlzdDsNCj4gPiArICAgICBz
dHJ1Y3QgaGxpc3RfaGVhZCBwc2ZwX2dhdGVfbGlzdDsNCj4gPiArICAgICBzcGlubG9ja190IHBz
ZnBfbG9jazsgLyogc3BpbmxvY2sgZm9yIHRoZSBzdHJ1Y3QgZW5ldGNfcHNmcCByL3cgKi8NCj4g
PiArfTsNCj4gPiArDQo+ID4gK3N0cnVjdCBhY3Rpb25zX2Z3ZCBlbmV0Y19hY3RfZndkW10gPSB7
DQo+ID4gKyAgICAgew0KPiA+ICsgICAgICAgICAgICAgQklUKEZMT1dfQUNUSU9OX0dBVEUpLA0K
PiA+ICsgICAgICAgICAgICAgQklUKEZMT1dfRElTU0VDVE9SX0tFWV9FVEhfQUREUlMpLA0KPiA+
ICsgICAgICAgICAgICAgRklMVEVSX0FDVElPTl9UWVBFX1BTRlANCj4gPiArICAgICB9LA0KPiA+
ICsgICAgIC8qIGV4YW1wbGUgZm9yIEFDTCBhY3Rpb25zICovDQo+ID4gKyAgICAgew0KPiA+ICsg
ICAgICAgICAgICAgQklUKEZMT1dfQUNUSU9OX0RST1ApLA0KPiA+ICsgICAgICAgICAgICAgMCwN
Cj4gPiArICAgICAgICAgICAgIEZJTFRFUl9BQ1RJT05fVFlQRV9BQ0wNCj4gPiArICAgICB9DQo+
ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgc3RydWN0IGVuZXRjX3BzZnAgZXBzZnAgPSB7DQo+
ID4gKyAgICAgLnBzZnBfc2ZpX2JpdG1hcCA9IE5VTEwsDQo+ID4gK307DQo+IA0KPiBJcyBpdCBw
b3NzaWJsZSB0byBoYXZlIG1vcmUgdGhhbiBvbmUgdGhlc2UgY29udHJvbGxlcnMgaW4gdGhlIHNh
bWUNCj4gc3lzdGVtPyBJZiBpdCdzIHBvc3NpYmxlIHRvIGhhdmUgbW9yZSB0aGFuIG9uZSwgdGhp
cyBzaG91bGQgYmUgbW92ZWQgdG8NCj4gbGl2ZSB1bmRlciBhIHBlci1kZXZpY2Ugc3RydWN0Lg0K
PiANCg0KVGhlcmUgaXMgb25seSBvbmUgUWNpIGZvciBvbmUgY29udHJvbGxlciAoaGVyZSBpcyBv
bmUgRU5FVEMgY29udHJvbGxlciB3aXRoIG11bHRpIHBvcnRzKS4gRm9yIGVhY2ggc3RyZWFtIGdh
dGUvZmxvdyBtZXRlciBlbnRyeSBjb3VsZCBiZSBhc3NpZ25lZCB0byBhbnkgZW5ldGMgcG9ydC4g
DQpTbyB0aGUgZW5ldGMgcG9ydHMgc2hhcmluZyB0aGlzIHN0cnVjdHVyZS4gcHNmcF9zZmlfYml0
bWFwIG1lYW5zIHdoaWNoIGVudHJ5IGlzIGJlIG9jY3VwaWVkLg0KDQo+ID4gKw0KPiA+ICtzdGF0
aWMgTElTVF9IRUFEKGVuZXRjX2Jsb2NrX2NiX2xpc3QpOw0KPiA+ICsNCj4gPiArc3RhdGljIGlu
bGluZSBpbnQgZW5ldGNfZ2V0X3BvcnQoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdikNCj4g
PiArew0KPiA+ICsgICAgIHJldHVybiBwcml2LT5zaS0+cGRldi0+ZGV2Zm4gJiAweDc7DQo+ID4g
K30NCj4gPiArDQo+ID4gKy8qIFN0cmVhbSBJZGVudGl0eSBFbnRyeSBTZXQgRGVzY3JpcHRvciAq
Lw0KPiA+ICtzdGF0aWMgaW50IGVuZXRjX3N0cmVhbWlkX2h3X3NldChzdHJ1Y3QgZW5ldGNfbmRl
dl9wcml2ICpwcml2LA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
ZW5ldGNfc3RyZWFtaWQgKnNpZCwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dTggZW5hYmxlKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGVuZXRjX2NiZCBjYmQgPSB7LmNt
ZCA9IDB9Ow0KPiA+ICsgICAgIHN0cnVjdCBzdHJlYW1pZF9kYXRhICpzaV9kYXRhOw0KPiA+ICsg
ICAgIHN0cnVjdCBzdHJlYW1pZF9jb25mICpzaV9jb25mOw0KPiA+ICsgICAgIHUxNiBkYXRhX3Np
emU7DQo+ID4gKyAgICAgZG1hX2FkZHJfdCBkbWE7DQo+ID4gKyAgICAgaW50IGVycjsNCj4gPiAr
DQo+ID4gKyAgICAgaWYgKHNpZC0+aW5kZXggPj0gcHJpdi0+cHNmcF9jYXAubWF4X3N0cmVhbWlk
KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKw0KPiA+ICsgICAgIGlm
IChzaWQtPmZpbHRlcnR5cGUgIT0gU1RSRUFNSURfVFlQRV9OVUxMICYmDQo+ID4gKyAgICAgICAg
IHNpZC0+ZmlsdGVydHlwZSAhPSBTVFJFQU1JRF9UWVBFX1NNQUMpDQo+ID4gKyAgICAgICAgICAg
ICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIC8qIERpc2FibGUgb3BlcmF0
aW9uIGJlZm9yZSBlbmFibGUgKi8NCj4gPiArICAgICBjYmQuaW5kZXggPSBjcHVfdG9fbGUxNigo
dTE2KXNpZC0+aW5kZXgpOw0KPiA+ICsgICAgIGNiZC5jbHMgPSBCRENSX0NNRF9TVFJFQU1fSURF
TlRJRlk7DQo+ID4gKyAgICAgY2JkLnN0YXR1c19mbGFncyA9IDA7DQo+ID4gKw0KPiA+ICsgICAg
IGRhdGFfc2l6ZSA9IHNpemVvZihzdHJ1Y3Qgc3RyZWFtaWRfZGF0YSk7DQo+ID4gKyAgICAgc2lf
ZGF0YSA9IGt6YWxsb2MoZGF0YV9zaXplLCBfX0dGUF9ETUEgfCBHRlBfS0VSTkVMKTsNCj4gPiAr
ICAgICBjYmQubGVuZ3RoID0gY3B1X3RvX2xlMTYoZGF0YV9zaXplKTsNCj4gPiArDQo+ID4gKyAg
ICAgZG1hID0gZG1hX21hcF9zaW5nbGUoJnByaXYtPnNpLT5wZGV2LT5kZXYsIHNpX2RhdGEsDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9zaXplLCBETUFfRlJPTV9ERVZJQ0Up
Ow0KPiA+ICsgICAgIGlmIChkbWFfbWFwcGluZ19lcnJvcigmcHJpdi0+c2ktPnBkZXYtPmRldiwg
ZG1hKSkgew0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2Vycihwcml2LT5zaS0+bmRldiwgIkRN
QSBtYXBwaW5nIGZhaWxlZCFcbiIpOw0KPiA+ICsgICAgICAgICAgICAga2ZyZWUoc2lfZGF0YSk7
DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsNCj4gPiArICAgICB9DQo+ID4gKw0K
PiA+ICsgICAgIGNiZC5hZGRyWzBdID0gbG93ZXJfMzJfYml0cyhkbWEpOw0KPiA+ICsgICAgIGNi
ZC5hZGRyWzFdID0gdXBwZXJfMzJfYml0cyhkbWEpOw0KPiA+ICsgICAgIG1lbXNldChzaV9kYXRh
LT5kbWFjLCAweGZmLCBFVEhfQUxFTik7DQo+ID4gKyAgICAgc2lfZGF0YS0+dmlkX3ZpZG1fdGcg
PQ0KPiA+ICsgICAgICAgICAgICAgY3B1X3RvX2xlMTYoRU5FVENfQ0JEUl9TSURfVklEX01BU0sN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICsgKCgweDMgPDwgMTQpIHwgRU5FVENfQ0JE
Ul9TSURfVklETSkpOw0KPiA+ICsNCj4gPiArICAgICBzaV9jb25mID0gJmNiZC5zaWRfc2V0Ow0K
PiA+ICsgICAgIC8qIE9ubHkgb25lIHBvcnQgc3VwcG9ydGVkIGZvciBvbmUgZW50cnksIHNldCBp
dHNlbGYgKi8NCj4gPiArICAgICBzaV9jb25mLT5pcG9ydHMgPSAxIDw8IGVuZXRjX2dldF9wb3J0
KHByaXYpOw0KPiA+ICsgICAgIHNpX2NvbmYtPmlkX3R5cGUgPSAxOw0KPiA+ICsgICAgIHNpX2Nv
bmYtPm91aVsyXSA9IDB4MDsNCj4gPiArICAgICBzaV9jb25mLT5vdWlbMV0gPSAweDgwOw0KPiA+
ICsgICAgIHNpX2NvbmYtPm91aVswXSA9IDB4QzI7DQo+ID4gKw0KPiA+ICsgICAgIGVyciA9IGVu
ZXRjX3NlbmRfY21kKHByaXYtPnNpLCAmY2JkKTsNCj4gPiArICAgICBpZiAoZXJyKQ0KPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZW5hYmxl
KSB7DQo+ID4gKyAgICAgICAgICAgICBrZnJlZShzaV9kYXRhKTsNCj4gPiArICAgICAgICAgICAg
IHJldHVybiAwOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgLyogRW5hYmxlIHRoZSBl
bnRyeSBvdmVyd3JpdGUgYWdhaW4gaW5jYXNlIHNwYWNlIGZsdXNoZWQgYnkgaGFyZHdhcmUgKi8N
Cj4gPiArICAgICBtZW1zZXQoJmNiZCwgMCwgc2l6ZW9mKGNiZCkpOw0KPiA+ICsNCj4gPiArICAg
ICBjYmQuaW5kZXggPSBjcHVfdG9fbGUxNigodTE2KXNpZC0+aW5kZXgpOw0KPiA+ICsgICAgIGNi
ZC5jbWQgPSAwOw0KPiA+ICsgICAgIGNiZC5jbHMgPSBCRENSX0NNRF9TVFJFQU1fSURFTlRJRlk7
DQo+ID4gKyAgICAgY2JkLnN0YXR1c19mbGFncyA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIHNpX2Nv
bmYtPmVuID0gMHg4MDsNCj4gPiArICAgICBzaV9jb25mLT5zdHJlYW1faGFuZGxlID0gY3B1X3Rv
X2xlMzIoc2lkLT5oYW5kbGUpOw0KPiA+ICsgICAgIHNpX2NvbmYtPmlwb3J0cyA9IDEgPDwgZW5l
dGNfZ2V0X3BvcnQocHJpdik7DQo+ID4gKyAgICAgc2lfY29uZi0+aWRfdHlwZSA9IHNpZC0+Zmls
dGVydHlwZTsNCj4gPiArICAgICBzaV9jb25mLT5vdWlbMl0gPSAweDA7DQo+ID4gKyAgICAgc2lf
Y29uZi0+b3VpWzFdID0gMHg4MDsNCj4gPiArICAgICBzaV9jb25mLT5vdWlbMF0gPSAweEMyOw0K
PiA+ICsNCj4gPiArICAgICBtZW1zZXQoc2lfZGF0YSwgMCwgZGF0YV9zaXplKTsNCj4gPiArDQo+
ID4gKyAgICAgY2JkLmxlbmd0aCA9IGNwdV90b19sZTE2KGRhdGFfc2l6ZSk7DQo+ID4gKw0KPiA+
ICsgICAgIGNiZC5hZGRyWzBdID0gbG93ZXJfMzJfYml0cyhkbWEpOw0KPiA+ICsgICAgIGNiZC5h
ZGRyWzFdID0gdXBwZXJfMzJfYml0cyhkbWEpOw0KPiA+ICsNCj4gPiArICAgICAvKiBWSURNIGRl
ZmF1bHQgdG8gYmUgMS4NCj4gPiArICAgICAgKiBWSUQgTWF0Y2guIElmIHNldCAoYjEpIHRoZW4g
dGhlIFZJRCBtdXN0IG1hdGNoLCBvdGhlcndpc2UNCj4gPiArICAgICAgKiBhbnkgVklEIGlzIGNv
bnNpZGVyZWQgYSBtYXRjaC4gVklETSBzZXR0aW5nIGlzIG9ubHkgdXNlZA0KPiA+ICsgICAgICAq
IHdoZW4gVEcgaXMgc2V0IHRvIGIwMS4NCj4gPiArICAgICAgKi8NCj4gPiArICAgICBpZiAoc2lf
Y29uZi0+aWRfdHlwZSA9PSBTVFJFQU1JRF9UWVBFX05VTEwpIHsNCj4gPiArICAgICAgICAgICAg
IGV0aGVyX2FkZHJfY29weShzaV9kYXRhLT5kbWFjLCBzaWQtPmRzdF9tYWMpOw0KPiA+ICsgICAg
ICAgICAgICAgc2lfZGF0YS0+dmlkX3ZpZG1fdGcgPQ0KPiA+ICsgICAgICAgICAgICAgY3B1X3Rv
X2xlMTYoKHNpZC0+dmlkICYgRU5FVENfQ0JEUl9TSURfVklEX01BU0spICsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICgoKCh1MTYpKHNpZC0+dGFnZ2VkKSAmIDB4MykgPDwgMTQpDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgfCBFTkVUQ19DQkRSX1NJRF9WSURNKSk7DQo+
ID4gKyAgICAgfSBlbHNlIGlmIChzaV9jb25mLT5pZF90eXBlID09IFNUUkVBTUlEX1RZUEVfU01B
Qykgew0KPiA+ICsgICAgICAgICAgICAgZXRoZXJfYWRkcl9jb3B5KHNpX2RhdGEtPnNtYWMsIHNp
ZC0+c3JjX21hYyk7DQo+ID4gKyAgICAgICAgICAgICBzaV9kYXRhLT52aWRfdmlkbV90ZyA9DQo+
ID4gKyAgICAgICAgICAgICBjcHVfdG9fbGUxNigoc2lkLT52aWQgJiBFTkVUQ19DQkRSX1NJRF9W
SURfTUFTSykgKw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgKCgoKHUxNikoc2lkLT50
YWdnZWQpICYgMHgzKSA8PCAxNCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICB8IEVO
RVRDX0NCRFJfU0lEX1ZJRE0pKTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGVyciA9
IGVuZXRjX3NlbmRfY21kKHByaXYtPnNpLCAmY2JkKTsNCj4gPiArICAgICBrZnJlZShzaV9kYXRh
KTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIGVycjsNCj4gPiArfQ0KPiA+ICsNCj4gPiArLyog
U3RyZWFtIEZpbHRlciBJbnN0YW5jZSBTZXQgRGVzY3JpcHRvciAqLw0KPiA+ICtzdGF0aWMgaW50
IGVuZXRjX3N0cmVhbWZpbHRlcl9od19zZXQoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBlbmV0Y19wc2Zw
X2ZpbHRlciAqc2ZpLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTgg
ZW5hYmxlKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGVuZXRjX2NiZCBjYmQgPSB7LmNtZCA9
IDB9Ow0KPiA+ICsgICAgIHN0cnVjdCBzZmlfY29uZiAqc2ZpX2NvbmZpZzsNCj4gPiArDQo+ID4g
KyAgICAgY2JkLmluZGV4ID0gY3B1X3RvX2xlMTYoc2ZpLT5pbmRleCk7DQo+ID4gKyAgICAgY2Jk
LmNscyA9IEJEQ1JfQ01EX1NUUkVBTV9GSUxURVI7DQo+ID4gKyAgICAgY2JkLnN0YXR1c19mbGFn
cyA9IDB4ODA7DQo+ID4gKyAgICAgY2JkLmxlbmd0aCA9IGNwdV90b19sZTE2KDEpOw0KPiA+ICsN
Cj4gPiArICAgICBzZmlfY29uZmlnID0gJmNiZC5zZmlfY29uZjsNCj4gPiArICAgICBpZiAoIWVu
YWJsZSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXhpdDsNCj4gPiArDQo+ID4gKyAgICAgc2Zp
X2NvbmZpZy0+ZW4gPSAweDgwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoc2ZpLT5oYW5kbGUgPj0g
MCkgew0KPiA+ICsgICAgICAgICAgICAgc2ZpX2NvbmZpZy0+c3RyZWFtX2hhbmRsZSA9DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIGNwdV90b19sZTMyKHNmaS0+aGFuZGxlKTsNCj4gPiArICAg
ICAgICAgICAgIHNmaV9jb25maWctPnN0aG0gfD0gMHg4MDsNCj4gPiArICAgICB9DQo+ID4gKw0K
PiA+ICsgICAgIHNmaV9jb25maWctPnNnX2luc3RfdGFibGVfaW5kZXggPSBjcHVfdG9fbGUxNihz
ZmktPmdhdGVfaWQpOw0KPiA+ICsgICAgIHNmaV9jb25maWctPmlucHV0X3BvcnRzID0gMSA8PCBl
bmV0Y19nZXRfcG9ydChwcml2KTsNCj4gPiArDQo+ID4gKyAgICAgLyogVGhlIHByaW9yaXR5IHZh
bHVlIHdoaWNoIG1heSBiZSBtYXRjaGVkIGFnYWluc3QgdGhlDQo+ID4gKyAgICAgICogZnJhbWXi
gJlzIHByaW9yaXR5IHZhbHVlIHRvIGRldGVybWluZSBhIG1hdGNoIGZvciB0aGlzIGVudHJ5Lg0K
PiA+ICsgICAgICAqLw0KPiA+ICsgICAgIGlmIChzZmktPnByaW8gPj0gMCkNCj4gPiArICAgICAg
ICAgICAgIHNmaV9jb25maWctPm11bHRpIHw9IChzZmktPnByaW8gJiAweDcpIHwgMHg4Ow0KPiA+
ICsNCj4gPiArICAgICAvKiBGaWx0ZXIgVHlwZS4gSWRlbnRpZmllcyB0aGUgY29udGVudHMgb2Yg
dGhlIE1TRFUvRk1fSU5TVF9JTkRFWA0KPiA+ICsgICAgICAqIGZpZWxkIGFzIGJlaW5nIGVpdGhl
ciBhbiBNU0RVIHZhbHVlIG9yIGFuIGluZGV4IGludG8gdGhlIEZsb3cNCj4gPiArICAgICAgKiBN
ZXRlciBJbnN0YW5jZSB0YWJsZS4NCj4gPiArICAgICAgKiBUT0RPOiBubyBsaW1pdCBtYXggc2R1
DQo+ID4gKyAgICAgICovDQo+ID4gKw0KPiA+ICsgICAgIGlmIChzZmktPm1ldGVyX2lkID49IDAp
IHsNCj4gPiArICAgICAgICAgICAgIHNmaV9jb25maWctPmZtX2luc3RfdGFibGVfaW5kZXggPSBj
cHVfdG9fbGUxNihzZmktPm1ldGVyX2lkKTsNCj4gPiArICAgICAgICAgICAgIHNmaV9jb25maWct
Pm11bHRpIHw9IDB4ODA7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArZXhpdDoNCj4gPiArICAg
ICByZXR1cm4gZW5ldGNfc2VuZF9jbWQocHJpdi0+c2ksICZjYmQpOw0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzdGF0aWMgaW50IGVuZXRjX3N0cmVhbWNvdW50ZXJfaHdfZ2V0KHN0cnVjdCBlbmV0Y19u
ZGV2X3ByaXYgKnByaXYsDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dTMyIGluZGV4LA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBwc2ZwX3N0cmVhbWZpbHRlcl9jb3VudGVycyAqY250KQ0KPiA+ICt7DQo+ID4gKyAgICAgc3Ry
dWN0IGVuZXRjX2NiZCBjYmQgPSB7IC5jbWQgPSAyIH07DQo+ID4gKyAgICAgc3RydWN0IHNmaV9j
b3VudGVyX2RhdGEgKmRhdGFfYnVmOw0KPiA+ICsgICAgIGRtYV9hZGRyX3QgZG1hOw0KPiA+ICsg
ICAgIHUxNiBkYXRhX3NpemU7DQo+ID4gKyAgICAgaW50IGVycjsNCj4gPiArDQo+ID4gKyAgICAg
Y2JkLmluZGV4ID0gY3B1X3RvX2xlMTYoKHUxNilpbmRleCk7DQo+ID4gKyAgICAgY2JkLmNtZCA9
IDI7DQo+ID4gKyAgICAgY2JkLmNscyA9IEJEQ1JfQ01EX1NUUkVBTV9GSUxURVI7DQo+ID4gKyAg
ICAgY2JkLnN0YXR1c19mbGFncyA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGRhdGFfc2l6ZSA9IHNp
emVvZihzdHJ1Y3Qgc2ZpX2NvdW50ZXJfZGF0YSk7DQo+ID4gKyAgICAgZGF0YV9idWYgPSBremFs
bG9jKGRhdGFfc2l6ZSwgX19HRlBfRE1BIHwgR0ZQX0tFUk5FTCk7DQo+ID4gKyAgICAgaWYgKCFk
YXRhX2J1ZikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsNCj4gPiAr
ICAgICBkbWEgPSBkbWFfbWFwX3NpbmdsZSgmcHJpdi0+c2ktPnBkZXYtPmRldiwgZGF0YV9idWYs
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9zaXplLCBETUFfRlJPTV9ERVZJ
Q0UpOw0KPiA+ICsgICAgIGlmIChkbWFfbWFwcGluZ19lcnJvcigmcHJpdi0+c2ktPnBkZXYtPmRl
diwgZG1hKSkgew0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2Vycihwcml2LT5zaS0+bmRldiwg
IkRNQSBtYXBwaW5nIGZhaWxlZCFcbiIpOw0KPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVOT01F
TTsNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXhpdDsNCj4gPiArICAgICB9DQo+ID4gKyAgICAg
Y2JkLmFkZHJbMF0gPSBsb3dlcl8zMl9iaXRzKGRtYSk7DQo+ID4gKyAgICAgY2JkLmFkZHJbMV0g
PSB1cHBlcl8zMl9iaXRzKGRtYSk7DQo+ID4gKw0KPiA+ICsgICAgIGNiZC5sZW5ndGggPSBjcHVf
dG9fbGUxNihkYXRhX3NpemUpOw0KPiA+ICsNCj4gPiArICAgICBlcnIgPSBlbmV0Y19zZW5kX2Nt
ZChwcml2LT5zaSwgJmNiZCk7DQo+ID4gKyAgICAgaWYgKGVycikNCj4gPiArICAgICAgICAgICAg
IGdvdG8gZXhpdDsNCj4gPiArDQo+ID4gKyAgICAgY250LT5tYXRjaGluZ19mcmFtZXNfY291bnQg
PQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAoKHU2NClsZTMyX3RvX2NwdShkYXRhX2J1Zi0+
bWF0Y2hoKSA8PCAzMikNCj4gPiArICAgICAgICAgICAgICAgICAgICAgKyBkYXRhX2J1Zi0+bWF0
Y2hsOw0KPiA+ICsNCj4gPiArICAgICBjbnQtPm5vdF9wYXNzaW5nX3NkdV9jb3VudCA9DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICgodTY0KWxlMzJfdG9fY3B1KGRhdGFfYnVmLT5tc2R1X2Ry
b3BoKSA8PCAzMikNCj4gPiArICAgICAgICAgICAgICAgICAgICAgKyBkYXRhX2J1Zi0+bXNkdV9k
cm9wbDsNCj4gPiArDQo+ID4gKyAgICAgY250LT5wYXNzaW5nX3NkdV9jb3VudCA9IGNudC0+bWF0
Y2hpbmdfZnJhbWVzX2NvdW50DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBj
bnQtPm5vdF9wYXNzaW5nX3NkdV9jb3VudDsNCj4gPiArDQo+ID4gKyAgICAgY250LT5ub3RfcGFz
c2luZ19mcmFtZXNfY291bnQgPQ0KPiA+ICsgICAgICAgICAgICAgKCh1NjQpbGUzMl90b19jcHUo
ZGF0YV9idWYtPnN0cmVhbV9nYXRlX2Ryb3BoKSA8PCAzMikNCj4gPiArICAgICAgICAgICAgICsg
bGUzMl90b19jcHUoZGF0YV9idWYtPnN0cmVhbV9nYXRlX2Ryb3BsKTsNCj4gPiArDQo+ID4gKyAg
ICAgY250LT5wYXNzaW5nX2ZyYW1lc19jb3VudCA9IGNudC0+bWF0Y2hpbmdfZnJhbWVzX2NvdW50
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBjbnQtPm5vdF9wYXNzaW5nX3Nk
dV9jb3VudA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gY250LT5ub3RfcGFz
c2luZ19mcmFtZXNfY291bnQ7DQo+ID4gKw0KPiA+ICsgICAgIGNudC0+cmVkX2ZyYW1lc19jb3Vu
dCA9DQo+ID4gKyAgICAgICAgICAgICAoKHU2NClsZTMyX3RvX2NwdShkYXRhX2J1Zi0+Zmxvd19t
ZXRlcl9kcm9waCkgPDwgMzIpDQo+ID4gKyAgICAgICAgICAgICArIGxlMzJfdG9fY3B1KGRhdGFf
YnVmLT5mbG93X21ldGVyX2Ryb3BsKTsNCj4gPiArDQo+ID4gK2V4aXQ6DQo+ID4gKyAgICAga2Zy
ZWUoZGF0YV9idWYpOw0KPiA+ICsgICAgIHJldHVybiBlcnI7DQo+ID4gK30NCj4gPiArDQo+ID4g
K3N0YXRpYyBpbnQgZ2V0X3N0YXJ0X25zKHN0cnVjdCBlbmV0Y19uZGV2X3ByaXYgKnByaXYsIHU2
NCBjeWNsZSwgdTY0ICpzdGFydCkNCj4gPiArew0KPiA+ICsgICAgIHU2NCBub3dfbG8sIG5vd19o
aSwgbm93LCBuOw0KPiA+ICsNCj4gPiArICAgICBub3dfbG8gPSBlbmV0Y19yZCgmcHJpdi0+c2kt
Pmh3LCBFTkVUQ19TSUNUUjApOw0KPiA+ICsgICAgIG5vd19oaSA9IGVuZXRjX3JkKCZwcml2LT5z
aS0+aHcsIEVORVRDX1NJQ1RSMSk7DQo+ID4gKyAgICAgbm93ID0gbm93X2xvIHwgbm93X2hpIDw8
IDMyOw0KPiA+ICsNCj4gPiArICAgICBpZiAoV0FSTl9PTighY3ljbGUpKQ0KPiA+ICsgICAgICAg
ICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKw0KPiA+ICsgICAgIG4gPSBkaXY2NF91NjQobm93
LCBjeWNsZSk7DQo+ID4gKw0KPiA+ICsgICAgICpzdGFydCA9IChuICsgMSkgKiBjeWNsZTsNCj4g
PiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gKy8qIFN0cmVhbSBH
YXRlIEluc3RhbmNlIFNldCBEZXNjcmlwdG9yICovDQo+ID4gK3N0YXRpYyBpbnQgZW5ldGNfc3Ry
ZWFtZ2F0ZV9od19zZXQoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZW5ldGNfcHNmcF9nYXRlICpzZ2ksDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTggZW5hYmxlKQ0KPiA+ICt7DQo+
ID4gKyAgICAgc3RydWN0IGVuZXRjX2NiZCBjYmQgPSB7IC5jbWQgPSAwIH07DQo+ID4gKyAgICAg
c3RydWN0IHNnaV90YWJsZSAqc2dpX2NvbmZpZzsNCj4gPiArICAgICBzdHJ1Y3Qgc2djbF9jb25m
ICpzZ2NsX2NvbmZpZzsNCj4gPiArICAgICBzdHJ1Y3Qgc2djbF9kYXRhICpzZ2NsX2RhdGE7DQo+
ID4gKyAgICAgc3RydWN0IHNnY2UgKnNnY2U7DQo+ID4gKyAgICAgZG1hX2FkZHJfdCBkbWE7DQo+
ID4gKyAgICAgdTE2IGRhdGFfc2l6ZTsNCj4gPiArICAgICBpbnQgZXJyLCBpOw0KPiA+ICsNCj4g
PiArICAgICBjYmQuaW5kZXggPSBjcHVfdG9fbGUxNihzZ2ktPmluZGV4KTsNCj4gPiArICAgICBj
YmQuY21kID0gMDsNCj4gPiArICAgICBjYmQuY2xzID0gQkRDUl9DTURfU1RSRUFNX0dDTDsNCj4g
PiArICAgICBjYmQuc3RhdHVzX2ZsYWdzID0gMHg4MDsNCj4gPiArDQo+ID4gKyAgICAgLyogZGlz
YWJsZSAqLw0KPiA+ICsgICAgIGlmICghZW5hYmxlKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJu
IGVuZXRjX3NlbmRfY21kKHByaXYtPnNpLCAmY2JkKTsNCj4gPiArDQo+ID4gKyAgICAgLyogZW5h
YmxlICovDQo+ID4gKyAgICAgc2dpX2NvbmZpZyA9ICZjYmQuc2dpX3RhYmxlOw0KPiA+ICsNCj4g
PiArICAgICAvKiBLZWVwIG9wZW4gYmVmb3JlIGdhdGUgbGlzdCBzdGFydCAqLw0KPiA+ICsgICAg
IHNnaV9jb25maWctPm9jZ3RzdCA9IDB4ODA7DQo+ID4gKw0KPiA+ICsgICAgIHNnaV9jb25maWct
Pm9pcHYgPSAoc2dpLT5pbml0X2lwdiA8IDApID8NCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAweDAgOiAoKHNnaS0+aW5pdF9pcHYgJiAweDcpIHwgMHg4KTsNCj4gPiArDQo+ID4g
KyAgICAgc2dpX2NvbmZpZy0+ZW4gPSAweDgwOw0KPiA+ICsNCj4gPiArICAgICAvKiBCYXNpYyBj
b25maWcgKi8NCj4gPiArICAgICBlcnIgPSBlbmV0Y19zZW5kX2NtZChwcml2LT5zaSwgJmNiZCk7
DQo+ID4gKyAgICAgaWYgKGVycikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0K
PiA+ICsNCj4gPiArICAgICBpZiAoIXNnaS0+bnVtX2VudHJpZXMpDQo+ID4gKyAgICAgICAgICAg
ICByZXR1cm4gMDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHNnaS0+bnVtX2VudHJpZXMgPiBwcml2
LT5wc2ZwX2NhcC5tYXhfcHNmcF9nYXRlbGlzdCB8fA0KPiA+ICsgICAgICAgICAhc2dpLT5jeWNs
ZXRpbWUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gDQo+IFlvdSBhbHJl
YWR5IGNoZWNrIHRoaXMgd2hlbiAic2dpIiBpcyBjcmVhdGVkLCB0aGlzIGNoZWNrIGRvZXNuJ3Qg
c2VlbSB0bw0KPiBiZSBuZWVkZWQuIElmIGl0J3MgbmVlZGVkLCBpdCBzaG91bGQgYmUgbW92ZWQg
dG8gdGhlIHRvcCBvZiB0aGUNCj4gZnVuY3Rpb24uDQoNClllcywgc2hvdWxkIGJlIG1vdmUgdG8g
dXBwZXIgYWZ0ZXIgZGlzYWJsZSBvcGVyYXRpb24gc2luY2Ugc2dpIGVudHJpZXMgaXMgbm90IHNl
dCB3aGVuIGRpc2FibGUuDQoNCj4gDQo+ID4gKw0KPiA+ICsgICAgIG1lbXNldCgmY2JkLCAwLCBz
aXplb2YoY2JkKSk7DQo+ID4gKw0KPiA+ICsgICAgIGNiZC5pbmRleCA9IGNwdV90b19sZTE2KHNn
aS0+aW5kZXgpOw0KPiA+ICsgICAgIGNiZC5jbWQgPSAxOw0KPiA+ICsgICAgIGNiZC5jbHMgPSBC
RENSX0NNRF9TVFJFQU1fR0NMOw0KPiA+ICsgICAgIGNiZC5zdGF0dXNfZmxhZ3MgPSAwOw0KPiA+
ICsNCj4gPiArICAgICBzZ2NsX2NvbmZpZyA9ICZjYmQuc2djbF9jb25mOw0KPiA+ICsNCj4gPiAr
ICAgICBzZ2NsX2NvbmZpZy0+YWNsX2xlbiA9IChzZ2ktPm51bV9lbnRyaWVzIC0gMSkgJiAweDM7
DQo+ID4gKw0KPiA+ICsgICAgIGRhdGFfc2l6ZSA9IHN0cnVjdF9zaXplKHNnY2xfZGF0YSwgc2dj
bCwgc2dpLT5udW1fZW50cmllcyk7DQo+ID4gKw0KPiA+ICsgICAgIHNnY2xfZGF0YSA9IGt6YWxs
b2MoZGF0YV9zaXplLCBfX0dGUF9ETUEgfCBHRlBfS0VSTkVMKTsNCj4gPiArICAgICBpZiAoIXNn
Y2xfZGF0YSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsNCj4gPiAr
ICAgICBjYmQubGVuZ3RoID0gY3B1X3RvX2xlMTYoZGF0YV9zaXplKTsNCj4gPiArDQo+ID4gKyAg
ICAgZG1hID0gZG1hX21hcF9zaW5nbGUoJnByaXYtPnNpLT5wZGV2LT5kZXYsDQo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2djbF9kYXRhLCBkYXRhX3NpemUsDQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgRE1BX0ZST01fREVWSUNFKTsNCj4gPiArICAgICBpZiAoZG1hX21h
cHBpbmdfZXJyb3IoJnByaXYtPnNpLT5wZGV2LT5kZXYsIGRtYSkpIHsNCj4gPiArICAgICAgICAg
ICAgIG5ldGRldl9lcnIocHJpdi0+c2ktPm5kZXYsICJETUEgbWFwcGluZyBmYWlsZWQhXG4iKTsN
Cj4gPiArICAgICAgICAgICAgIGtmcmVlKHNnY2xfZGF0YSk7DQo+ID4gKyAgICAgICAgICAgICBy
ZXR1cm4gLUVOT01FTTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGNiZC5hZGRyWzBd
ID0gbG93ZXJfMzJfYml0cyhkbWEpOw0KPiA+ICsgICAgIGNiZC5hZGRyWzFdID0gdXBwZXJfMzJf
Yml0cyhkbWEpOw0KPiA+ICsNCj4gPiArICAgICBzZ2NlID0gJnNnY2xfZGF0YS0+c2djbFswXTsN
Cj4gPiArDQo+ID4gKyAgICAgc2djbF9jb25maWctPmFndHN0ID0gMHg4MDsNCj4gPiArDQo+ID4g
KyAgICAgc2djbF9kYXRhLT5jdCA9IGNwdV90b19sZTMyKHNnaS0+Y3ljbGV0aW1lKTsNCj4gPiAr
ICAgICBzZ2NsX2RhdGEtPmN0ZSA9IGNwdV90b19sZTMyKHNnaS0+Y3ljbGV0aW1leHQpOw0KPiA+
ICsNCj4gPiArICAgICBpZiAoc2dpLT5pbml0X2lwdiA+PSAwKQ0KPiA+ICsgICAgICAgICAgICAg
c2djbF9jb25maWctPmFpcHYgPSAoc2dpLT5pbml0X2lwdiAmIDB4NykgfCAweDg7DQo+ID4gKw0K
PiA+ICsgICAgIGZvciAoaSA9IDA7IGkgPCBzZ2ktPm51bV9lbnRyaWVzOyBpKyspIHsNCj4gPiAr
ICAgICAgICAgICAgIHN0cnVjdCBhY3Rpb25fZ2F0ZV9lbnRyeSAqZnJvbSA9ICZzZ2ktPmVudHJp
ZXNbaV07DQo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3Qgc2djZSAqdG8gPSAmc2djZVtpXTsNCj4g
PiArDQo+ID4gKyAgICAgICAgICAgICBpZiAoZnJvbS0+Z2F0ZV9zdGF0ZSkNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgdG8tPm11bHRpIHw9IDB4MTA7DQo+ID4gKw0KPiA+ICsgICAgICAgICAg
ICAgaWYgKGZyb20tPmlwdiA+PSAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB0by0+bXVs
dGkgfD0gKChmcm9tLT5pcHYgJiAweDcpIDw8IDUpIHwgMHgwODsNCj4gPiArDQo+ID4gKyAgICAg
ICAgICAgICBpZiAoZnJvbS0+bWF4b2N0ZXRzKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB0
by0+bXVsdGkgfD0gMHgwMTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICB0by0+aW50ZXJ2YWwg
PSBjcHVfdG9fbGUzMihmcm9tLT5pbnRlcnZhbCk7DQo+ID4gKyAgICAgICAgICAgICB0by0+bXNk
dVswXSA9IGZyb20tPm1heG9jdGV0cyAmIDB4RkY7DQo+ID4gKyAgICAgICAgICAgICB0by0+bXNk
dVsxXSA9IChmcm9tLT5tYXhvY3RldHMgPj4gOCkgJiAweEZGOw0KPiA+ICsgICAgICAgICAgICAg
dG8tPm1zZHVbMl0gPSAoZnJvbS0+bWF4b2N0ZXRzID4+IDE2KSAmIDB4RkY7DQo+ID4gKyAgICAg
fQ0KPiA+ICsNCj4gPiArICAgICAvKiBJZiBiYXNldGltZSBpcyAwLCBjYWxjdWxhdGUgc3RhcnQg
dGltZSAqLw0KPiA+ICsgICAgIGlmICghc2dpLT5iYXNldGltZSkgew0KPiA+ICsgICAgICAgICAg
ICAgdTY0IHN0YXJ0Ow0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGVyciA9IGdldF9zdGFydF9u
cyhwcml2LCBzZ2ktPmN5Y2xldGltZSwgJnN0YXJ0KTsNCj4gPiArICAgICAgICAgICAgIGlmIChl
cnIpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXhpdDsNCj4gPiArICAgICAgICAg
ICAgIHNnY2xfZGF0YS0+YnRsID0gY3B1X3RvX2xlMzIobG93ZXJfMzJfYml0cyhzdGFydCkpOw0K
PiA+ICsgICAgICAgICAgICAgc2djbF9kYXRhLT5idGggPSBjcHVfdG9fbGUzMih1cHBlcl8zMl9i
aXRzKHN0YXJ0KSk7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHUzMiBo
aSwgbG87DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaGkgPSB1cHBlcl8zMl9iaXRzKHNnaS0+
YmFzZXRpbWUpOw0KPiA+ICsgICAgICAgICAgICAgbG8gPSBsb3dlcl8zMl9iaXRzKHNnaS0+YmFz
ZXRpbWUpOw0KPiA+ICsgICAgICAgICAgICAgc2djbF9kYXRhLT5idGggPSBjcHVfdG9fbGUzMiho
aSk7DQo+ID4gKyAgICAgICAgICAgICBzZ2NsX2RhdGEtPmJ0bCA9IGNwdV90b19sZTMyKGxvKTsN
Cj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGVyciA9IGVuZXRjX3NlbmRfY21kKHByaXYt
PnNpLCAmY2JkKTsNCj4gPiArDQo+ID4gK2V4aXQ6DQo+ID4gKyAgICAga2ZyZWUoc2djbF9kYXRh
KTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIGVycjsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3Rh
dGljIHN0cnVjdCBlbmV0Y19zdHJlYW1fZmlsdGVyICplbmV0Y19nZXRfc3RyZWFtX2J5X2luZGV4
KHUzMiBpbmRleCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBlbmV0Y19zdHJlYW1fZmlsdGVy
ICpmOw0KPiA+ICsNCj4gPiArICAgICBobGlzdF9mb3JfZWFjaF9lbnRyeShmLCAmZXBzZnAuc3Ry
ZWFtX2xpc3QsIG5vZGUpDQo+ID4gKyAgICAgICAgICAgICBpZiAoZi0+c2lkLmluZGV4ID09IGlu
ZGV4KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjsNCj4gPiArDQo+ID4gKyAg
ICAgcmV0dXJuIE5VTEw7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzdHJ1Y3QgZW5ldGNf
cHNmcF9nYXRlICplbmV0Y19nZXRfZ2F0ZV9ieV9pbmRleCh1MzIgaW5kZXgpDQo+ID4gK3sNCj4g
PiArICAgICBzdHJ1Y3QgZW5ldGNfcHNmcF9nYXRlICpnOw0KPiA+ICsNCj4gPiArICAgICBobGlz
dF9mb3JfZWFjaF9lbnRyeShnLCAmZXBzZnAucHNmcF9nYXRlX2xpc3QsIG5vZGUpDQo+ID4gKyAg
ICAgICAgICAgICBpZiAoZy0+aW5kZXggPT0gaW5kZXgpDQo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiBnOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gTlVMTDsNCj4gPiArfQ0KPiA+
ICsNCj4gPiArc3RhdGljIHN0cnVjdCBlbmV0Y19wc2ZwX2ZpbHRlciAqZW5ldGNfZ2V0X2ZpbHRl
cl9ieV9pbmRleCh1MzIgaW5kZXgpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZW5ldGNfcHNm
cF9maWx0ZXIgKnM7DQo+ID4gKw0KPiA+ICsgICAgIGhsaXN0X2Zvcl9lYWNoX2VudHJ5KHMsICZl
cHNmcC5wc2ZwX2ZpbHRlcl9saXN0LCBub2RlKQ0KPiA+ICsgICAgICAgICAgICAgaWYgKHMtPmlu
ZGV4ID09IGluZGV4KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXR1cm4gczsNCj4gPiAr
DQo+ID4gKyAgICAgcmV0dXJuIE5VTEw7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzdHJ1
Y3QgZW5ldGNfcHNmcF9maWx0ZXINCj4gPiArICAgICAqZW5ldGNfcHNmcF9jaGVja19zZmkoc3Ry
dWN0IGVuZXRjX3BzZnBfZmlsdGVyICpzZmkpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZW5l
dGNfcHNmcF9maWx0ZXIgKnM7DQo+ID4gKw0KPiA+ICsgICAgIGhsaXN0X2Zvcl9lYWNoX2VudHJ5
KHMsICZlcHNmcC5wc2ZwX2ZpbHRlcl9saXN0LCBub2RlKQ0KPiA+ICsgICAgICAgICAgICAgaWYg
KHMtPmdhdGVfaWQgPT0gc2ZpLT5nYXRlX2lkICYmDQo+ID4gKyAgICAgICAgICAgICAgICAgcy0+
cHJpbyA9PSBzZmktPnByaW8gJiYNCj4gPiArICAgICAgICAgICAgICAgICBzLT5tZXRlcl9pZCA9
PSBzZmktPm1ldGVyX2lkKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXR1cm4gczsNCj4g
PiArDQo+ID4gKyAgICAgcmV0dXJuIE5VTEw7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBp
bnQgZW5ldGNfZ2V0X2ZyZWVfaW5kZXgoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdikNCj4g
PiArew0KPiA+ICsgICAgIHUzMiBtYXhfc2l6ZSA9IHByaXYtPnBzZnBfY2FwLm1heF9wc2ZwX2Zp
bHRlcjsNCj4gPiArICAgICB1bnNpZ25lZCBsb25nIGluZGV4Ow0KPiA+ICsNCj4gPiArICAgICBp
bmRleCA9IGZpbmRfZmlyc3RfemVyb19iaXQoZXBzZnAucHNmcF9zZmlfYml0bWFwLCBtYXhfc2l6
ZSk7DQo+ID4gKyAgICAgaWYgKGluZGV4ID09IG1heF9zaXplKQ0KPiA+ICsgICAgICAgICAgICAg
cmV0dXJuIC0xOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gaW5kZXg7DQo+ID4gK30NCj4gPiAr
DQo+ID4gK3N0YXRpYyB2b2lkIHJlZHVjZV9yZWZfc2ZpKHN0cnVjdCBlbmV0Y19uZGV2X3ByaXYg
KnByaXYsIHUzMiBpbmRleCkNCj4gDQo+IFBsZWFzZSB1c2UgdGhlIG1vcmUgdXN1YWwgaWRpb21z
LCBzb21ldGhpbmcgbGlrZSAic2ZpX3VucmVmKCkiIG9yDQo+ICJzdHJlYW1fZmlsdGVyX3VucmVm
Ii4NCg0KT2suIG1ha2Ugc2Vuc2UuDQoNCj4gDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZW5l
dGNfcHNmcF9maWx0ZXIgKnNmaTsNCj4gPiArDQo+ID4gKyAgICAgc2ZpID0gZW5ldGNfZ2V0X2Zp
bHRlcl9ieV9pbmRleChpbmRleCk7DQo+ID4gKyAgICAgV0FSTl9PTighc2ZpKTsNCj4gPiArICAg
ICBzZmktPnJlZmNvdW50LS07DQo+ID4gKw0KPiA+ICsgICAgIGlmICghc2ZpLT5yZWZjb3VudCkg
ew0KPiA+ICsgICAgICAgICAgICAgZW5ldGNfc3RyZWFtZmlsdGVyX2h3X3NldChwcml2LCBzZmks
IGZhbHNlKTsNCj4gPiArICAgICAgICAgICAgIGhsaXN0X2RlbCgmc2ZpLT5ub2RlKTsNCj4gPiAr
ICAgICAgICAgICAgIGtmcmVlKHNmaSk7DQo+ID4gKyAgICAgICAgICAgICBjbGVhcl9iaXQoc2Zp
LT5pbmRleCwgZXBzZnAucHNmcF9zZmlfYml0bWFwKTsNCj4gPiArICAgICB9DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyB2b2lkIHJlZHVjZV9yZWZfc2dpKHN0cnVjdCBlbmV0Y19uZGV2X3By
aXYgKnByaXYsIHUzMiBpbmRleCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBlbmV0Y19wc2Zw
X2dhdGUgKnNnaTsNCj4gPiArDQo+ID4gKyAgICAgc2dpID0gZW5ldGNfZ2V0X2dhdGVfYnlfaW5k
ZXgoaW5kZXgpOw0KPiA+ICsgICAgIFdBUk5fT04oIXNnaSk7DQo+ID4gKyAgICAgc2dpLT5yZWZj
b3VudC0tOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIXNnaS0+cmVmY291bnQpIHsNCj4gPiArICAg
ICAgICAgICAgIGVuZXRjX3N0cmVhbWdhdGVfaHdfc2V0KHByaXYsIHNnaSwgZmFsc2UpOw0KPiA+
ICsgICAgICAgICAgICAgaGxpc3RfZGVsKCZzZ2ktPm5vZGUpOw0KPiA+ICsgICAgICAgICAgICAg
a2ZyZWUoc2dpKTsNCj4gPiArICAgICB9DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lk
IHJlbW92ZV9vbmVfY2hhaW4oc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZW5ldGNfc3RyZWFtX2ZpbHRlciAqZmlsdGVy
KQ0KPiA+ICt7DQo+ID4gKyAgICAgcmVkdWNlX3JlZl9zZ2kocHJpdiwgZmlsdGVyLT5zZ2lfaW5k
ZXgpOw0KPiA+ICsgICAgIHJlZHVjZV9yZWZfc2ZpKHByaXYsIGZpbHRlci0+c2ZpX2luZGV4KTsN
Cj4gPiArDQo+ID4gKyAgICAgaGxpc3RfZGVsKCZmaWx0ZXItPm5vZGUpOw0KPiA+ICsgICAgIGtm
cmVlKGZpbHRlcik7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZW5ldGNfcHNmcF9o
d19zZXQoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgZW5ldGNfc3RyZWFtaWQgKnNpZCwNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgZW5ldGNfcHNmcF9maWx0ZXIgKnNmaSwNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZW5ldGNfcHNmcF9nYXRlICpzZ2kpDQo+ID4gK3sN
Cj4gPiArICAgICBpbnQgZXJyOw0KPiA+ICsNCj4gPiArICAgICBlcnIgPSBlbmV0Y19zdHJlYW1p
ZF9od19zZXQocHJpdiwgc2lkLCB0cnVlKTsNCj4gPiArICAgICBpZiAoZXJyKQ0KPiA+ICsgICAg
ICAgICAgICAgcmV0dXJuIGVycjsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHNmaSkgew0KPiA+ICsg
ICAgICAgICAgICAgZXJyID0gZW5ldGNfc3RyZWFtZmlsdGVyX2h3X3NldChwcml2LCBzZmksIHRy
dWUpOw0KPiA+ICsgICAgICAgICAgICAgaWYgKGVycikNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgZ290byByZXZlcnRfc2lkOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgZXJyID0g
ZW5ldGNfc3RyZWFtZ2F0ZV9od19zZXQocHJpdiwgc2dpLCB0cnVlKTsNCj4gPiArICAgICBpZiAo
ZXJyKQ0KPiA+ICsgICAgICAgICAgICAgZ290byByZXZlcnRfc2ZpOw0KPiA+ICsNCj4gPiArICAg
ICByZXR1cm4gMDsNCj4gPiArDQo+ID4gK3JldmVydF9zZmk6DQo+ID4gKyAgICAgaWYgKHNmaSAm
JiAhc2ZpLT5yZWZjb3VudCkNCj4gPiArICAgICAgICAgICAgIGVuZXRjX3N0cmVhbWZpbHRlcl9o
d19zZXQocHJpdiwgc2ZpLCBmYWxzZSk7DQo+ID4gK3JldmVydF9zaWQ6DQo+ID4gKyAgICAgZW5l
dGNfc3RyZWFtaWRfaHdfc2V0KHByaXYsIHNpZCwgZmFsc2UpOw0KPiA+ICsgICAgIHJldHVybiBl
cnI7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0cnVjdCBhY3Rpb25zX2Z3ZCAqZW5ldGNfY2hlY2tf
Zmxvd19hY3Rpb25zKHU2NCBhY3RzLCB1bnNpZ25lZCBpbnQNCj4gaW5wdXRrZXlzKQ0KPiA+ICt7
DQo+ID4gKyAgICAgaW50IGk7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDA7IGkgPCBBUlJB
WV9TSVpFKGVuZXRjX2FjdF9md2QpOyBpKyspDQo+ID4gKyAgICAgICAgICAgICBpZiAoYWN0cyA9
PSBlbmV0Y19hY3RfZndkW2ldLmFjdGlvbnMgJiYNCj4gPiArICAgICAgICAgICAgICAgICBpbnB1
dGtleXMgJiBlbmV0Y19hY3RfZndkW2ldLmtleXMpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IHJldHVybiAmZW5ldGNfYWN0X2Z3ZFtpXTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIE5VTEw7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZW5ldGNfcHNmcF9wYXJzZV9jbHNmbG93
ZXIoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgZmxvd19jbHNfb2ZmbG9hZCAqZikNCj4gPiArew0KPiA+
ICsgICAgIHN0cnVjdCBmbG93X3J1bGUgKnJ1bGUgPSBmbG93X2Nsc19vZmZsb2FkX2Zsb3dfcnVs
ZShmKTsNCj4gPiArICAgICBzdHJ1Y3QgbmV0bGlua19leHRfYWNrICpleHRhY2sgPSBmLT5jb21t
b24uZXh0YWNrOw0KPiA+ICsgICAgIHN0cnVjdCBlbmV0Y19zdHJlYW1fZmlsdGVyICpmaWx0ZXIs
ICpvbGRfZmlsdGVyOw0KPiA+ICsgICAgIHN0cnVjdCBlbmV0Y19wc2ZwX2ZpbHRlciAqc2ZpLCAq
b2xkX3NmaTsNCj4gPiArICAgICBzdHJ1Y3QgZW5ldGNfcHNmcF9nYXRlICpzZ2ksICpvbGRfc2dp
Ow0KPiA+ICsgICAgIHN0cnVjdCBmbG93X2FjdGlvbl9lbnRyeSAqZW50cnk7DQo+ID4gKyAgICAg
c3RydWN0IGFjdGlvbl9nYXRlX2VudHJ5ICplOw0KPiA+ICsgICAgIHU4IHNmaV9vdmVyd3JpdGUg
PSAwOw0KPiA+ICsgICAgIGludCBlbnRyaWVzX3NpemU7DQo+ID4gKyAgICAgaW50IGksIGVycjsN
Cj4gPiArDQo+ID4gKyAgICAgaWYgKGYtPmNvbW1vbi5jaGFpbl9pbmRleCA+PSBwcml2LT5wc2Zw
X2NhcC5tYXhfc3RyZWFtaWQpIHsNCj4gPiArICAgICAgICAgICAgIE5MX1NFVF9FUlJfTVNHX01P
RChleHRhY2ssICJObyBTdHJlYW0gaWRlbnRpZnkgcmVzb3VyY2UhIik7DQo+ID4gKyAgICAgICAg
ICAgICByZXR1cm4gLUVOT1NQQzsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGZsb3df
YWN0aW9uX2Zvcl9lYWNoKGksIGVudHJ5LCAmcnVsZS0+YWN0aW9uKQ0KPiA+ICsgICAgICAgICAg
ICAgaWYgKGVudHJ5LT5pZCA9PSBGTE9XX0FDVElPTl9HQVRFKQ0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBicmVhazsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGVudHJ5LT5pZCAhPSBGTE9XX0FD
VElPTl9HQVRFKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKw0KPiA+
ICsgICAgIGZpbHRlciA9IGt6YWxsb2Moc2l6ZW9mKCpmaWx0ZXIpLCBHRlBfS0VSTkVMKTsNCj4g
PiArICAgICBpZiAoIWZpbHRlcikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0K
PiA+ICsNCj4gPiArICAgICBmaWx0ZXItPnNpZC5pbmRleCA9IGYtPmNvbW1vbi5jaGFpbl9pbmRl
eDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGZsb3dfcnVsZV9tYXRjaF9rZXkocnVsZSwgRkxPV19E
SVNTRUNUT1JfS0VZX0VUSF9BRERSUykpIHsNCj4gPiArICAgICAgICAgICAgIHN0cnVjdCBmbG93
X21hdGNoX2V0aF9hZGRycyBtYXRjaDsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBmbG93X3J1
bGVfbWF0Y2hfZXRoX2FkZHJzKHJ1bGUsICZtYXRjaCk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAg
ICAgaWYgKCFpc196ZXJvX2V0aGVyX2FkZHIobWF0Y2gubWFzay0+ZHN0KSkgew0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICBldGhlcl9hZGRyX2NvcHkoZmlsdGVyLT5zaWQuZHN0X21hYywgbWF0
Y2gua2V5LT5kc3QpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBmaWx0ZXItPnNpZC5maWx0
ZXJ0eXBlID0gU1RSRUFNSURfVFlQRV9OVUxMOw0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsN
Cj4gPiArICAgICAgICAgICAgIGlmICghaXNfemVyb19ldGhlcl9hZGRyKG1hdGNoLm1hc2stPnNy
YykpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZXRoZXJfYWRkcl9jb3B5KGZpbHRlci0+
c2lkLnNyY19tYWMsIG1hdGNoLmtleS0+c3JjKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ZmlsdGVyLT5zaWQuZmlsdGVydHlwZSA9IFNUUkVBTUlEX1RZUEVfU01BQzsNCj4gPiArICAgICAg
ICAgICAgIH0NCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgTkxfU0VUX0VS
Ul9NU0dfTU9EKGV4dGFjaywgIlVuc3VwcG9ydGVkLCBtdXN0DQo+IEVUSF9BRERSUyIpOw0KPiA+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAr
ICAgICBpZiAoZmxvd19ydWxlX21hdGNoX2tleShydWxlLCBGTE9XX0RJU1NFQ1RPUl9LRVlfVkxB
TikpIHsNCj4gPiArICAgICAgICAgICAgIHN0cnVjdCBmbG93X21hdGNoX3ZsYW4gbWF0Y2g7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgZmxvd19ydWxlX21hdGNoX3ZsYW4ocnVsZSwgJm1hdGNo
KTsNCj4gPiArICAgICAgICAgICAgIGlmIChtYXRjaC5tYXNrLT52bGFuX3ByaW9yaXR5KSB7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaC5tYXNrLT52bGFuX3ByaW9yaXR5ICE9
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAoVkxBTl9QUklPX01BU0sgPj4gVkxBTl9Q
UklPX1NISUZUKSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5MX1NFVF9F
UlJfTVNHX01PRChleHRhY2ssICJPbmx5IGZ1bGwgbWFzayBpcw0KPiBzdXBwb3J0ZWQgZm9yIFZM
QU4gcHJpb3JpdHkiKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSAt
RUlOVkFMOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZnJlZV9maWx0
ZXI7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgIH0NCj4g
PiArDQo+ID4gKyAgICAgICAgICAgICBpZiAobWF0Y2gubWFzay0+dmxhbl90cGlkKSB7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaC5tYXNrLT52bGFuX3RwaWQgIT0gVkxBTl9W
SURfTUFTSykgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5MX1NFVF9FUlJf
TVNHX01PRChleHRhY2ssICJPbmx5IGZ1bGwgbWFzayBpcw0KPiBzdXBwb3J0ZWQgZm9yIFZMQU4g
aWQiKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFMOw0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZnJlZV9maWx0ZXI7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IGZpbHRlci0+c2lkLnZpZCA9IG1hdGNoLmtleS0+dmxhbl90cGlkOw0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICBpZiAoIWZpbHRlci0+c2lkLnZpZCkNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBmaWx0ZXItPnNpZC50YWdnZWQgPSBTVFJFQU1JRF9WTEFOX1VOVEFHR0VEOw0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZmlsdGVyLT5zaWQudGFnZ2VkID0gU1RSRUFNSURfVkxBTl9UQUdHRUQ7DQo+ID4g
KyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIGZp
bHRlci0+c2lkLnRhZ2dlZCA9IFNUUkVBTUlEX1ZMQU5fQUxMOw0KPiA+ICsgICAgIH0NCj4gPiAr
DQo+ID4gKyAgICAgLyogcGFyc2luZyBnYXRlIGFjdGlvbiAqLw0KPiA+ICsgICAgIGlmIChlbnRy
eS0+Z2F0ZS5pbmRleCA+PSBwcml2LT5wc2ZwX2NhcC5tYXhfcHNmcF9nYXRlKSB7DQo+ID4gKyAg
ICAgICAgICAgICBOTF9TRVRfRVJSX01TR19NT0QoZXh0YWNrLCAiTm8gU3RyZWFtIEdhdGUgcmVz
b3VyY2UhIik7DQo+ID4gKyAgICAgICAgICAgICBlcnIgPSAtRU5PU1BDOw0KPiA+ICsgICAgICAg
ICAgICAgZ290byBmcmVlX2ZpbHRlcjsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGlm
IChlbnRyeS0+Z2F0ZS5udW1fZW50cmllcyA+PSBwcml2LT5wc2ZwX2NhcC5tYXhfcHNmcF9nYXRl
bGlzdCkgew0KPiA+ICsgICAgICAgICAgICAgTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywgIk5v
IFN0cmVhbSBHYXRlIHJlc291cmNlISIpOw0KPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVOT1NQ
QzsNCj4gPiArICAgICAgICAgICAgIGdvdG8gZnJlZV9maWx0ZXI7DQo+ID4gKyAgICAgfQ0KPiA+
ICsNCj4gPiArICAgICBlbnRyaWVzX3NpemUgPSBzdHJ1Y3Rfc2l6ZShzZ2ksIGVudHJpZXMsIGVu
dHJ5LT5nYXRlLm51bV9lbnRyaWVzKTsNCj4gPiArICAgICBzZ2kgPSBremFsbG9jKGVudHJpZXNf
c2l6ZSwgR0ZQX0tFUk5FTCk7DQo+ID4gKyAgICAgaWYgKCFzZ2kpIHsNCj4gPiArICAgICAgICAg
ICAgIGVyciA9IC1FTk9NRU07DQo+ID4gKyAgICAgICAgICAgICBnb3RvIGZyZWVfZmlsdGVyOw0K
PiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgc2dpLT5pbmRleCA9IGVudHJ5LT5nYXRlLmlu
ZGV4Ow0KPiA+ICsgICAgIHNnaS0+aW5pdF9pcHYgPSBlbnRyeS0+Z2F0ZS5wcmlvOw0KPiA+ICsg
ICAgIHNnaS0+YmFzZXRpbWUgPSBlbnRyeS0+Z2F0ZS5iYXNldGltZTsNCj4gPiArICAgICBzZ2kt
PmN5Y2xldGltZSA9IGVudHJ5LT5nYXRlLmN5Y2xldGltZTsNCj4gPiArICAgICBzZ2ktPm51bV9l
bnRyaWVzID0gZW50cnktPmdhdGUubnVtX2VudHJpZXM7DQo+ID4gKw0KPiA+ICsgICAgIGUgPSBz
Z2ktPmVudHJpZXM7DQo+ID4gKyAgICAgZm9yIChpID0gMDsgaSA8IGVudHJ5LT5nYXRlLm51bV9l
bnRyaWVzOyBpKyspIHsNCj4gPiArICAgICAgICAgICAgIGVbaV0uZ2F0ZV9zdGF0ZSA9IGVudHJ5
LT5nYXRlLmVudHJpZXNbaV0uZ2F0ZV9zdGF0ZTsNCj4gPiArICAgICAgICAgICAgIGVbaV0uaW50
ZXJ2YWwgPSBlbnRyeS0+Z2F0ZS5lbnRyaWVzW2ldLmludGVydmFsOw0KPiA+ICsgICAgICAgICAg
ICAgZVtpXS5pcHYgPSBlbnRyeS0+Z2F0ZS5lbnRyaWVzW2ldLmlwdjsNCj4gPiArICAgICAgICAg
ICAgIGVbaV0ubWF4b2N0ZXRzID0gZW50cnktPmdhdGUuZW50cmllc1tpXS5tYXhvY3RldHM7DQo+
ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBmaWx0ZXItPnNnaV9pbmRleCA9IHNnaS0+aW5k
ZXg7DQo+ID4gKw0KPiA+ICsgICAgIHNmaSA9IGt6YWxsb2Moc2l6ZW9mKCpzZmkpLCBHRlBfS0VS
TkVMKTsNCj4gPiArICAgICBpZiAoIXNmaSkgew0KPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVO
T01FTTsNCj4gPiArICAgICAgICAgICAgIGdvdG8gZnJlZV9nYXRlOw0KPiA+ICsgICAgIH0NCj4g
PiArDQo+ID4gKyAgICAgc2ZpLT5nYXRlX2lkID0gc2dpLT5pbmRleDsNCj4gPiArDQo+ID4gKyAg
ICAgLyogZmxvdyBtZXRlciBub3Qgc3VwcG9ydCB5ZXQgKi8NCj4gPiArICAgICBzZmktPm1ldGVy
X2lkID0gRU5FVENfUFNGUF9XSUxEQ0FSRDsNCj4gPiArDQo+ID4gKyAgICAgLyogcHJpbyByZWYg
dGhlIGZpbHRlciBwcmlvICovDQo+ID4gKyAgICAgaWYgKGYtPmNvbW1vbi5wcmlvICYmIGYtPmNv
bW1vbi5wcmlvIDw9IEJJVCgzKSkNCj4gPiArICAgICAgICAgICAgIHNmaS0+cHJpbyA9IGYtPmNv
bW1vbi5wcmlvIC0gMTsNCj4gPiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICBzZmktPnBy
aW8gPSBFTkVUQ19QU0ZQX1dJTERDQVJEOw0KPiA+ICsNCj4gPiArICAgICBvbGRfc2ZpID0gZW5l
dGNfcHNmcF9jaGVja19zZmkoc2ZpKTsNCj4gPiArICAgICBpZiAoIW9sZF9zZmkpIHsNCj4gPiAr
ICAgICAgICAgICAgIGludCBpbmRleDsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBpbmRleCA9
IGVuZXRjX2dldF9mcmVlX2luZGV4KHByaXYpOw0KPiA+ICsgICAgICAgICAgICAgaWYgKHNmaS0+
aGFuZGxlIDwgMCkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBOTF9TRVRfRVJSX01TR19N
T0QoZXh0YWNrLCAiTm8gU3RyZWFtIEZpbHRlciByZXNvdXJjZSEiKTsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgZXJyID0gLUVOT1NQQzsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZ290
byBmcmVlX3NmaTsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAgICAg
ICBzZmktPmluZGV4ID0gaW5kZXg7DQo+ID4gKyAgICAgICAgICAgICBzZmktPmhhbmRsZSA9IGlu
ZGV4ICsgSEFORExFX09GRlNFVDsNCj4gPiArICAgICAgICAgICAgIC8qIFVwZGF0ZSB0aGUgc3Ry
ZWFtIGZpbHRlciBoYW5kbGUgYWxzbyAqLw0KPiA+ICsgICAgICAgICAgICAgZmlsdGVyLT5zaWQu
aGFuZGxlID0gc2ZpLT5oYW5kbGU7DQo+ID4gKyAgICAgICAgICAgICBmaWx0ZXItPnNmaV9pbmRl
eCA9IHNmaS0+aW5kZXg7DQo+ID4gKyAgICAgICAgICAgICBzZmlfb3ZlcndyaXRlID0gMDsNCj4g
PiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgZmlsdGVyLT5zZmlfaW5kZXggPSBv
bGRfc2ZpLT5pbmRleDsNCj4gPiArICAgICAgICAgICAgIGZpbHRlci0+c2lkLmhhbmRsZSA9IG9s
ZF9zZmktPmhhbmRsZTsNCj4gPiArICAgICAgICAgICAgIHNmaV9vdmVyd3JpdGUgPSAxOw0KPiA+
ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgZXJyID0gZW5ldGNfcHNmcF9od19zZXQocHJpdiwg
JmZpbHRlci0+c2lkLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNmaV9vdmVy
d3JpdGUgPyBOVUxMIDogc2ZpLCBzZ2kpOw0KPiA+ICsgICAgIGlmIChlcnIpDQo+ID4gKyAgICAg
ICAgICAgICBnb3RvIGZyZWVfc2ZpOw0KPiA+ICsNCj4gPiArICAgICBzcGluX2xvY2soJmVwc2Zw
LnBzZnBfbG9jayk7DQo+ID4gKyAgICAgb2xkX3NnaSA9IGVuZXRjX2dldF9nYXRlX2J5X2luZGV4
KGZpbHRlci0+c2dpX2luZGV4KTsNCj4gPiArICAgICBpZiAob2xkX3NnaSkgew0KPiA+ICsgICAg
ICAgICAgICAgc2dpLT5yZWZjb3VudCA9IG9sZF9zZ2ktPnJlZmNvdW50Ow0KPiA+ICsgICAgICAg
ICAgICAgaGxpc3RfZGVsKCZvbGRfc2dpLT5ub2RlKTsNCj4gPiArICAgICAgICAgICAgIGtmcmVl
KG9sZF9zZ2kpOw0KPiANCj4gSSBkb24ndCB1bmRlcnN0YW5kIHdoYXQgeW91IGFyZSB0cnlpbmcg
dG8gYWNoaWV2ZSBoZXJlLiBCdXQgdGhlcmUgc2hvdWxkDQo+IGJlIGEgY2xlYW5lciB3YXkuDQoN
ClRoZSBjb2RlIGhlcmUgaXMgdG8gcmVtb3ZlIHRoZSBvbGQgc3RyZWFtIGdhdGUgaW5zdGFuY2Ug
aW4gbGlzdC4gV2hhdCBldmVyIGl0IGlzIGV4aXN0ZWQsIHdpbGwgbGluayBhIG5ldyBsaXN0IHRv
IHJlcGxhY2UgdGhlIG9sZCBzZXR0aW5nIGJ1dCBzdGlsbCBuZWVkIHRoZSBiaW5kIGNvdW50LiAN
ClNpbmNlIHRoZSBvbGQgZmlsdGVyIG1heSBkaWZmZXJlbnQgd2l0aCBuZXcgZ2F0ZSBpbnN0YW5j
ZSwgZnJvbSB1c2VyIHZpZXcsIHNob3VsZCBrbm93IHRoZXkgYXJlIHNldHRpbmcgbmV3IG9uZSB3
aXRoIHNhbWUgaW5kZXgsIGFuZCB3b3VsZCByZXBsYWNlZCBieSBuZXcgZ2F0ZSBzZXR0aW5nLiBC
dXQgb2xkIGZpbHRlciBzdGlsbCB3b3JraW5nLg0KSSB3b3VsZCBjaGVjayBhZ2FpbiBmb3IgaW1w
cm92ZW1lbnQgaWYgaXQgY2FuIGJlIG1vcmUgY2xlYXIuDQoNCj4gDQo+ID4gKyAgICAgfQ0KPiA+
ICsNCj4gPiArICAgICBzZ2ktPnJlZmNvdW50Kys7DQo+ID4gKyAgICAgaGxpc3RfYWRkX2hlYWQo
JnNnaS0+bm9kZSwgJmVwc2ZwLnBzZnBfZ2F0ZV9saXN0KTsNCj4gPiArDQo+ID4gKyAgICAgaWYg
KCFvbGRfc2ZpKSB7DQo+ID4gKyAgICAgICAgICAgICBobGlzdF9hZGRfaGVhZCgmc2ZpLT5ub2Rl
LCAmZXBzZnAucHNmcF9maWx0ZXJfbGlzdCk7DQo+ID4gKyAgICAgICAgICAgICBzZXRfYml0KHNm
aS0+aW5kZXgsIGVwc2ZwLnBzZnBfc2ZpX2JpdG1hcCk7DQo+ID4gKyAgICAgICAgICAgICBzZmkt
PnJlZmNvdW50Kys7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIGtmcmVl
KHNmaSk7DQo+ID4gKyAgICAgICAgICAgICBvbGRfc2ZpLT5yZWZjb3VudCsrOw0KPiA+ICsgICAg
IH0NCj4gPiArDQo+ID4gKyAgICAgb2xkX2ZpbHRlciA9IGVuZXRjX2dldF9zdHJlYW1fYnlfaW5k
ZXgoZmlsdGVyLT5zaWQuaW5kZXgpOw0KPiA+ICsgICAgIGlmIChvbGRfZmlsdGVyKQ0KPiA+ICsg
ICAgICAgICAgICAgcmVtb3ZlX29uZV9jaGFpbihwcml2LCBvbGRfZmlsdGVyKTsNCj4gPiArDQo+
ID4gKyAgICAgZmlsdGVyLT5zdGF0cy5sYXN0dXNlZCA9IGppZmZpZXM7DQo+ID4gKyAgICAgaGxp
c3RfYWRkX2hlYWQoJmZpbHRlci0+bm9kZSwgJmVwc2ZwLnN0cmVhbV9saXN0KTsNCj4gPiArDQo+
ID4gKyAgICAgc3Bpbl91bmxvY2soJmVwc2ZwLnBzZnBfbG9jayk7DQo+ID4gKw0KPiA+ICsgICAg
IHJldHVybiAwOw0KPiA+ICsNCj4gPiArZnJlZV9zZmk6DQo+ID4gKyAgICAga2ZyZWUoc2ZpKTsN
Cj4gPiArZnJlZV9nYXRlOg0KPiA+ICsgICAgIGtmcmVlKHNnaSk7DQo+ID4gK2ZyZWVfZmlsdGVy
Og0KPiA+ICsgICAgIGtmcmVlKGZpbHRlcik7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBlcnI7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZW5ldGNfY29uZmlnX2Nsc2Zsb3dlcihz
dHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2LA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGZsb3dfY2xzX29mZmxvYWQgKmNsc19mbG93ZXIpDQo+ID4gK3sNCj4g
PiArICAgICBzdHJ1Y3QgZmxvd19ydWxlICpydWxlID0gZmxvd19jbHNfb2ZmbG9hZF9mbG93X3J1
bGUoY2xzX2Zsb3dlcik7DQo+ID4gKyAgICAgc3RydWN0IG5ldGxpbmtfZXh0X2FjayAqZXh0YWNr
ID0gY2xzX2Zsb3dlci0+Y29tbW9uLmV4dGFjazsNCj4gPiArICAgICBzdHJ1Y3QgZmxvd19kaXNz
ZWN0b3IgKmRpc3NlY3RvciA9IHJ1bGUtPm1hdGNoLmRpc3NlY3RvcjsNCj4gPiArICAgICBzdHJ1
Y3QgZmxvd19hY3Rpb24gKmFjdGlvbiA9ICZydWxlLT5hY3Rpb247DQo+ID4gKyAgICAgc3RydWN0
IGZsb3dfYWN0aW9uX2VudHJ5ICplbnRyeTsNCj4gPiArICAgICBzdHJ1Y3QgYWN0aW9uc19md2Qg
KmZ3ZDsNCj4gPiArICAgICB1NjQgYWN0aW9ucyA9IDA7DQo+ID4gKyAgICAgaW50IGksIGVycjsN
Cj4gPiArDQo+ID4gKyAgICAgaWYgKCFmbG93X2FjdGlvbl9oYXNfZW50cmllcyhhY3Rpb24pKSB7
DQo+ID4gKyAgICAgICAgICAgICBOTF9TRVRfRVJSX01TR19NT0QoZXh0YWNrLCAiQXQgbGVhc3Qg
b25lIGFjdGlvbiBpcyBuZWVkZWQiKTsNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFM
Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgZmxvd19hY3Rpb25fZm9yX2VhY2goaSwg
ZW50cnksIGFjdGlvbikNCj4gPiArICAgICAgICAgICAgIGFjdGlvbnMgfD0gQklUKGVudHJ5LT5p
ZCk7DQo+ID4gKw0KPiA+ICsgICAgIGZ3ZCA9IGVuZXRjX2NoZWNrX2Zsb3dfYWN0aW9ucyhhY3Rp
b25zLCBkaXNzZWN0b3ItPnVzZWRfa2V5cyk7DQo+ID4gKyAgICAgaWYgKCFmd2QpIHsNCj4gPiAr
ICAgICAgICAgICAgIE5MX1NFVF9FUlJfTVNHX01PRChleHRhY2ssICJVbnN1cHBvcnRlZCBmaWx0
ZXIgdHlwZSEiKTsNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiAr
ICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGlmIChmd2QtPm91dHB1dCAmIEZJTFRFUl9BQ1RJT05f
VFlQRV9QU0ZQKSB7DQo+ID4gKyAgICAgICAgICAgICBlcnIgPSBlbmV0Y19wc2ZwX3BhcnNlX2Ns
c2Zsb3dlcihwcml2LCBjbHNfZmxvd2VyKTsNCj4gPiArICAgICAgICAgICAgIGlmIChlcnIpIHsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywgIklu
dmFsaWQgUFNGUCBpbnB1dHMiKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVy
cjsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAg
ICAgICAgTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywgIlVuc3VwcG9ydGVkIGFjdGlvbnMiKTsN
Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArICAgICB9DQo+ID4g
Kw0KPiA+ICsgICAgIHJldHVybiAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGVu
ZXRjX3BzZnBfZGVzdHJveV9jbHNmbG93ZXIoc3RydWN0IGVuZXRjX25kZXZfcHJpdiAqcHJpdiwN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBmbG93X2Ns
c19vZmZsb2FkICpmKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGVuZXRjX3N0cmVhbV9maWx0
ZXIgKmZpbHRlcjsNCj4gPiArICAgICBzdHJ1Y3QgbmV0bGlua19leHRfYWNrICpleHRhY2sgPSBm
LT5jb21tb24uZXh0YWNrOw0KPiA+ICsgICAgIGludCBlcnI7DQo+ID4gKw0KPiA+ICsgICAgIGlm
IChmLT5jb21tb24uY2hhaW5faW5kZXggPj0gcHJpdi0+cHNmcF9jYXAubWF4X3N0cmVhbWlkKSB7
DQo+ID4gKyAgICAgICAgICAgICBOTF9TRVRfRVJSX01TR19NT0QoZXh0YWNrLCAiTm8gU3RyZWFt
IGlkZW50aWZ5IHJlc291cmNlISIpOw0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9TUEM7
DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBmaWx0ZXIgPSBlbmV0Y19nZXRfc3RyZWFt
X2J5X2luZGV4KGYtPmNvbW1vbi5jaGFpbl9pbmRleCk7DQo+ID4gKyAgICAgaWYgKCFmaWx0ZXIp
DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gPiArDQo+ID4gKyAgICAgZXJy
ID0gZW5ldGNfc3RyZWFtaWRfaHdfc2V0KHByaXYsICZmaWx0ZXItPnNpZCwgZmFsc2UpOw0KPiA+
ICsgICAgIGlmIChlcnIpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOw0KPiA+ICsNCj4g
PiArICAgICByZW1vdmVfb25lX2NoYWluKHByaXYsIGZpbHRlcik7DQo+ID4gKw0KPiA+ICsgICAg
IHJldHVybiAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGVuZXRjX2Rlc3Ryb3lf
Y2xzZmxvd2VyKHN0cnVjdCBlbmV0Y19uZGV2X3ByaXYgKnByaXYsDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGZsb3dfY2xzX29mZmxvYWQgKmYpDQo+ID4gK3sN
Cj4gPiArICAgICByZXR1cm4gZW5ldGNfcHNmcF9kZXN0cm95X2Nsc2Zsb3dlcihwcml2LCBmKTsN
Cj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBlbmV0Y19wc2ZwX2dldF9zdGF0cyhzdHJ1
Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2LA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBmbG93X2Nsc19vZmZsb2FkICpmKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0
IHBzZnBfc3RyZWFtZmlsdGVyX2NvdW50ZXJzIGNvdW50ZXJzID0ge307DQo+ID4gKyAgICAgc3Ry
dWN0IGVuZXRjX3N0cmVhbV9maWx0ZXIgKmZpbHRlcjsNCj4gPiArICAgICBzdHJ1Y3QgZmxvd19z
dGF0cyBzdGF0cyA9IHt9Ow0KPiA+ICsgICAgIGludCBlcnI7DQo+ID4gKw0KPiA+ICsgICAgIGZp
bHRlciA9IGVuZXRjX2dldF9zdHJlYW1fYnlfaW5kZXgoZi0+Y29tbW9uLmNoYWluX2luZGV4KTsN
Cj4gPiArICAgICBpZiAoIWZpbHRlcikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFM
Ow0KPiA+ICsNCj4gPiArICAgICBlcnIgPSBlbmV0Y19zdHJlYW1jb3VudGVyX2h3X2dldChwcml2
LCBmaWx0ZXItPnNmaV9pbmRleCwgJmNvdW50ZXJzKTsNCj4gPiArICAgICBpZiAoZXJyKQ0KPiA+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKw0KPiA+ICsgICAgIHNwaW5fbG9j
aygmZXBzZnAucHNmcF9sb2NrKTsNCj4gPiArICAgICBzdGF0cy5wa3RzID0gY291bnRlcnMubWF0
Y2hpbmdfZnJhbWVzX2NvdW50IC0gZmlsdGVyLT5zdGF0cy5wa3RzOw0KPiA+ICsgICAgIHN0YXRz
LmRyb3BwZWQgPSBjb3VudGVycy5ub3RfcGFzc2luZ19mcmFtZXNfY291bnQgLQ0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyLT5zdGF0cy5kcm9wcGVkOw0K
PiA+ICsgICAgIHN0YXRzLmxhc3R1c2VkID0gZmlsdGVyLT5zdGF0cy5sYXN0dXNlZDsNCj4gPiAr
ICAgICBmaWx0ZXItPnN0YXRzLnBrdHMgKz0gc3RhdHMucGt0czsNCj4gPiArICAgICBmaWx0ZXIt
PnN0YXRzLmRyb3BwZWQgKz0gc3RhdHMuZHJvcHBlZDsNCj4gPiArDQo+ID4gKyAgICAgc3Bpbl91
bmxvY2soJmVwc2ZwLnBzZnBfbG9jayk7DQo+ID4gKw0KPiA+ICsgICAgIGZsb3dfc3RhdHNfdXBk
YXRlKCZmLT5zdGF0cywgMHgwLCBzdGF0cy5wa3RzLCBzdGF0cy5sYXN0dXNlZCwNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBzdGF0cy5kcm9wcGVkKTsNCj4gPiArDQo+ID4gKyAgICAgcmV0
dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZW5ldGNfc2V0dXBfdGNfY2xz
X2Zsb3dlcihzdHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2LA0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGZsb3dfY2xzX29mZmxvYWQgKmNsc19mbG93ZXIp
DQo+ID4gK3sNCj4gPiArICAgICBzd2l0Y2ggKGNsc19mbG93ZXItPmNvbW1hbmQpIHsNCj4gPiAr
ICAgICBjYXNlIEZMT1dfQ0xTX1JFUExBQ0U6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZW5l
dGNfY29uZmlnX2Nsc2Zsb3dlcihwcml2LCBjbHNfZmxvd2VyKTsNCj4gPiArICAgICBjYXNlIEZM
T1dfQ0xTX0RFU1RST1k6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZW5ldGNfZGVzdHJveV9j
bHNmbG93ZXIocHJpdiwgY2xzX2Zsb3dlcik7DQo+ID4gKyAgICAgY2FzZSBGTE9XX0NMU19TVEFU
UzoNCj4gPiArICAgICAgICAgICAgIHJldHVybiBlbmV0Y19wc2ZwX2dldF9zdGF0cyhwcml2LCBj
bHNfZmxvd2VyKTsNCj4gPiArICAgICBkZWZhdWx0Og0KPiA+ICsgICAgICAgICAgICAgcmV0dXJu
IC1FT1BOT1RTVVBQOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGlu
bGluZSB2b2lkIGNsZWFuX3BzZnBfc2ZpX2JpdG1hcCh2b2lkKQ0KPiA+ICt7DQo+ID4gKyAgICAg
Yml0bWFwX2ZyZWUoZXBzZnAucHNmcF9zZmlfYml0bWFwKTsNCj4gPiArICAgICBlcHNmcC5wc2Zw
X3NmaV9iaXRtYXAgPSBOVUxMOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBjbGVh
bl9zdHJlYW1fbGlzdCh2b2lkKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGVuZXRjX3N0cmVh
bV9maWx0ZXIgKnM7DQo+ID4gKyAgICAgc3RydWN0IGhsaXN0X25vZGUgKnRtcDsNCj4gPiArDQo+
ID4gKyAgICAgaGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShzLCB0bXAsICZlcHNmcC5zdHJlYW1f
bGlzdCwgbm9kZSkgew0KPiA+ICsgICAgICAgICAgICAgaGxpc3RfZGVsKCZzLT5ub2RlKTsNCj4g
PiArICAgICAgICAgICAgIGtmcmVlKHMpOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4g
PiArc3RhdGljIHZvaWQgY2xlYW5fc2ZpX2xpc3Qodm9pZCkNCj4gPiArew0KPiA+ICsgICAgIHN0
cnVjdCBlbmV0Y19wc2ZwX2ZpbHRlciAqc2ZpOw0KPiA+ICsgICAgIHN0cnVjdCBobGlzdF9ub2Rl
ICp0bXA7DQo+ID4gKw0KPiA+ICsgICAgIGhsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoc2ZpLCB0
bXAsICZlcHNmcC5wc2ZwX2ZpbHRlcl9saXN0LCBub2RlKSB7DQo+ID4gKyAgICAgICAgICAgICBo
bGlzdF9kZWwoJnNmaS0+bm9kZSk7DQo+ID4gKyAgICAgICAgICAgICBrZnJlZShzZmkpOw0KPiA+
ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgY2xlYW5fc2dpX2xpc3Qo
dm9pZCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBlbmV0Y19wc2ZwX2dhdGUgKnNnaTsNCj4g
PiArICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqdG1wOw0KPiA+ICsNCj4gPiArICAgICBobGlzdF9m
b3JfZWFjaF9lbnRyeV9zYWZlKHNnaSwgdG1wLCAmZXBzZnAucHNmcF9nYXRlX2xpc3QsIG5vZGUp
IHsNCj4gPiArICAgICAgICAgICAgIGhsaXN0X2RlbCgmc2dpLT5ub2RlKTsNCj4gPiArICAgICAg
ICAgICAgIGtmcmVlKHNnaSk7DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0
aWMgdm9pZCBjbGVhbl9wc2ZwX2FsbCh2b2lkKQ0KPiA+ICt7DQo+ID4gKyAgICAgLyogRGlzYWJs
ZSBhbGwgbGlzdCBub2RlcyBhbmQgZnJlZSBhbGwgbWVtb3J5ICovDQo+ID4gKyAgICAgY2xlYW5f
c2ZpX2xpc3QoKTsNCj4gPiArICAgICBjbGVhbl9zZ2lfbGlzdCgpOw0KPiA+ICsgICAgIGNsZWFu
X3N0cmVhbV9saXN0KCk7DQo+ID4gKyAgICAgZXBzZnAuZGV2X2JpdG1hcCA9IDA7DQo+ID4gKyAg
ICAgY2xlYW5fcHNmcF9zZmlfYml0bWFwKCk7DQo+ID4gK30NCj4gPiArDQo+ID4gK2ludCBlbmV0
Y19zZXR1cF90Y19ibG9ja19jYihlbnVtIHRjX3NldHVwX3R5cGUgdHlwZSwgdm9pZCAqdHlwZV9k
YXRhLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqY2JfcHJpdikNCj4gPiAr
ew0KPiA+ICsgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpuZGV2ID0gY2JfcHJpdjsNCj4gPiArDQo+
ID4gKyAgICAgaWYgKCF0Y19jYW5fb2ZmbG9hZChuZGV2KSkNCj4gPiArICAgICAgICAgICAgIHJl
dHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAgc3dpdGNoICh0eXBlKSB7DQo+ID4g
KyAgICAgY2FzZSBUQ19TRVRVUF9DTFNGTE9XRVI6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4g
ZW5ldGNfc2V0dXBfdGNfY2xzX2Zsb3dlcihuZXRkZXZfcHJpdihuZGV2KSwgdHlwZV9kYXRhKTsN
Cj4gPiArICAgICBkZWZhdWx0Og0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQ
Ow0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiAraW50IGVuZXRjX3BzZnBfaW5pdChz
dHJ1Y3QgZW5ldGNfbmRldl9wcml2ICpwcml2KQ0KPiA+ICt7DQo+ID4gKyAgICAgaWYgKGVwc2Zw
LnBzZnBfc2ZpX2JpdG1hcCkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAwOw0KPiA+ICsNCj4g
PiArICAgICBlcHNmcC5wc2ZwX3NmaV9iaXRtYXAgPSBiaXRtYXBfemFsbG9jKHByaXYtPnBzZnBf
Y2FwLm1heF9wc2ZwX2ZpbHRlciwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEdGUF9LRVJORUwpOw0KPiA+ICsgICAgIGlmICghZXBzZnAucHNmcF9zZmlf
Yml0bWFwKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+ID4gKw0KPiA+ICsg
ICAgIHNwaW5fbG9ja19pbml0KCZlcHNmcC5wc2ZwX2xvY2spOw0KPiA+ICsNCj4gPiArICAgICBp
ZiAobGlzdF9lbXB0eSgmZW5ldGNfYmxvY2tfY2JfbGlzdCkpDQo+ID4gKyAgICAgICAgICAgICBl
cHNmcC5kZXZfYml0bWFwID0gMDsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30N
Cj4gPiArDQo+ID4gK2ludCBlbmV0Y19wc2ZwX2NsZWFuKHN0cnVjdCBlbmV0Y19uZGV2X3ByaXYg
KnByaXYpDQo+ID4gK3sNCj4gPiArICAgICBpZiAoIWxpc3RfZW1wdHkoJmVuZXRjX2Jsb2NrX2Ni
X2xpc3QpKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FQlVTWTsNCj4gPiArDQo+ID4gKyAg
ICAgY2xlYW5fcHNmcF9hbGwoKTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30N
Cj4gPiArDQo+ID4gK2ludCBlbmV0Y19zZXR1cF90Y19wc2ZwKHN0cnVjdCBuZXRfZGV2aWNlICpu
ZGV2LCB2b2lkICp0eXBlX2RhdGEpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZW5ldGNfbmRl
dl9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYobmRldik7DQo+ID4gKyAgICAgc3RydWN0IGZsb3df
YmxvY2tfb2ZmbG9hZCAqZiA9IHR5cGVfZGF0YTsNCj4gPiArICAgICBpbnQgZXJyOw0KPiA+ICsN
Cj4gPiArICAgICBlcnIgPSBmbG93X2Jsb2NrX2NiX3NldHVwX3NpbXBsZShmLCAmZW5ldGNfYmxv
Y2tfY2JfbGlzdCwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBl
bmV0Y19zZXR1cF90Y19ibG9ja19jYiwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBuZGV2LCBuZGV2LCB0cnVlKTsNCj4gPiArICAgICBpZiAoZXJyKQ0KPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIGVycjsNCj4gPiArDQo+ID4gKyAgICAgc3dpdGNoIChmLT5jb21t
YW5kKSB7DQo+ID4gKyAgICAgY2FzZSBGTE9XX0JMT0NLX0JJTkQ6DQo+ID4gKyAgICAgICAgICAg
ICBzZXRfYml0KGVuZXRjX2dldF9wb3J0KHByaXYpLCAmZXBzZnAuZGV2X2JpdG1hcCk7DQo+ID4g
KyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNlIEZMT1dfQkxPQ0tfVU5CSU5EOg0K
PiA+ICsgICAgICAgICAgICAgY2xlYXJfYml0KGVuZXRjX2dldF9wb3J0KHByaXYpLCAmZXBzZnAu
ZGV2X2JpdG1hcCk7DQo+ID4gKyAgICAgICAgICAgICBpZiAoIWVwc2ZwLmRldl9iaXRtYXApDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIGNsZWFuX3BzZnBfYWxsKCk7DQo+ID4gKyAgICAgICAg
ICAgICBicmVhazsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiAwOw0KPiA+
ICt9DQo+ID4gLS0NCj4gPiAyLjE3LjENCj4gPg0KPiANCj4gLS0NCj4gVmluaWNpdXMNCg0KQnIs
DQpQbyBMaXUNCg0K
