Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 0AE9A210E79
	for <lists+netdev@lfdr.de>; Wed,  1 Jul 2020 17:08:20 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1731782AbgGAPII (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Wed, 1 Jul 2020 11:08:08 -0400
Received: from mail-bn8nam12on2056.outbound.protection.outlook.com ([40.107.237.56]:52640
        "EHLO NAM12-BN8-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1731505AbgGAPIG (ORCPT <rfc822;netdev@vger.kernel.org>);
        Wed, 1 Jul 2020 11:08:06 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=f3N0xfmAo2VSAK0oEkCaZ7XhYerd0NTbmlNwzv7Ntbx0ZXfhopyvaxDIpvdmmMH7VaI3M4lmkA0+zP3NDSbr4Z8bFbixCLHYzOV+33/AW5CGlqQH/thwKxUsTOtB2kFruiS3ChU039Ik5D2qNA4Q396vTz689pX0qzByssvhvHhJX5oR9nHdKstRKTeC2izfOYzBwRpwg4uU6wjQL7ayayW0UGOXxkouk1njaPs15wvdoYodxzVLJLorrhB5dLeJ4I+IfegGHpbLpJj5760miUjcmQA7BUMSNdA3IWUEb2OO2ytRlHZa+dval598lmGpWRuBqnJYFnDA9s+tetDt2g==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=UtD0cyg1AwDPlfHg4FnZVxekirUg22mwS3DkXlRmuyQ=;
 b=WJ63vbK4CaMAZP/JBbKBGBSCOs+EmTGYrVibbCRGKr5P1agQfd6sgMLiVebYLl15RqDGWmr+BPVN12vxeJ2foeBQUDSB1aO2Twn0MYF01QSjBaPYuBwrBmBUQhNjipeAtmROYGSjhfA7iLa4snWSMcsfjGmfEsBDKxSjn6EVxeGoBZMUeT2JAP5kcwnL+XmEy/ib2b+YigkZERMGENTctPvx0GZrylBkepJQKl57gTah6qq3dx/x/gCUXhGW3ih+u3AP2wNGns+077rQIKoIjyY5mfx4G8qhx3l0ooIeEWAsdijPOXnZhbkW1FPNttdMsUPGwaR4GiBKLJjtzAUcTw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=UtD0cyg1AwDPlfHg4FnZVxekirUg22mwS3DkXlRmuyQ=;
 b=bBbuc2uzrlMuwcKEzoD1g6oEa4yk29Os0XDospeQCvzYWpsHs9aEtTJpqD3N+1BPtfHlu0aNzCgove43RgNJ9v9ltZq2XV+rILL6sh503cPN2LiutUIkYn5FPeEIyL2A30VQ6y0PV83ly1/lk8LUBBsILsGO5n+2Gbc/3RX7Zys=
Authentication-Results: driverdev.osuosl.org; dkim=none (message not signed)
 header.d=none;driverdev.osuosl.org; dmarc=none action=none
 header.from=silabs.com;
Received: from SN6PR11MB2718.namprd11.prod.outlook.com (2603:10b6:805:63::18)
 by SA0PR11MB4736.namprd11.prod.outlook.com (2603:10b6:806:9f::14) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3153.22; Wed, 1 Jul
 2020 15:08:01 +0000
Received: from SN6PR11MB2718.namprd11.prod.outlook.com
 ([fe80::c504:2d66:a8f7:2336]) by SN6PR11MB2718.namprd11.prod.outlook.com
 ([fe80::c504:2d66:a8f7:2336%7]) with mapi id 15.20.3131.033; Wed, 1 Jul 2020
 15:08:01 +0000
From:   Jerome Pouiller <Jerome.Pouiller@silabs.com>
To:     devel@driverdev.osuosl.org, linux-wireless@vger.kernel.org
Cc:     netdev@vger.kernel.org, linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Kalle Valo <kvalo@codeaurora.org>,
        "David S . Miller" <davem@davemloft.net>,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH 01/13] staging: wfx: associate tx_queues to vifs
Date:   Wed,  1 Jul 2020 17:06:55 +0200
Message-Id: <20200701150707.222985-2-Jerome.Pouiller@silabs.com>
X-Mailer: git-send-email 2.27.0
In-Reply-To: <20200701150707.222985-1-Jerome.Pouiller@silabs.com>
References: <20200701150707.222985-1-Jerome.Pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-ClientProxiedBy: DM5PR07CA0143.namprd07.prod.outlook.com
 (2603:10b6:3:13e::33) To SN6PR11MB2718.namprd11.prod.outlook.com
 (2603:10b6:805:63::18)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from pc-42.silabs.com (2a01:e35:2435:66a0:544b:f17b:7ae8:fb7) by DM5PR07CA0143.namprd07.prod.outlook.com (2603:10b6:3:13e::33) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3153.21 via Frontend Transport; Wed, 1 Jul 2020 15:07:59 +0000
X-Mailer: git-send-email 2.27.0
X-Originating-IP: [2a01:e35:2435:66a0:544b:f17b:7ae8:fb7]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 4cbc051a-6dde-4b79-5f82-08d81dd08b87
X-MS-TrafficTypeDiagnostic: SA0PR11MB4736:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <SA0PR11MB4736E486F280ACE7748B52AC936C0@SA0PR11MB4736.namprd11.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:4502;
X-Forefront-PRVS: 04519BA941
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: meqVVAlpX5sR0XOIRvEVsng322DN0aZWvW2NwwtPMKdfp/3ZNH7OTi+VS+t9ZmFCha98cfcpSVxys0f5N6CKxXpO4JsdySv88JhtoQtDxmFOGd24UaxvseVf+ILfaTnqemIm6UPF7ndGmEZ6G6fwWbLpUKW2evL2MqtjWsSPUs0KdmQSrSuao84l8G0THsW4bn5qzwyUfuAWyl/5lBPesgkFDFWOnV80G4tibeLRVi1w0NOlBTQVcm7pIm+K4nqXyY3pX3maWNgkk8ElbTjjecMkULtKkrESgxKsL5UAqjHVBCzQei/NSXcwYSe9T6al2VQXeF+X8qjvLLrln9Z1Eg==
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:SN6PR11MB2718.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFTY:;SFS:(39850400004)(366004)(346002)(376002)(396003)(136003)(5660300002)(6486002)(86362001)(6666004)(66574015)(36756003)(2906002)(186003)(83380400001)(16526019)(30864003)(8936002)(66556008)(66476007)(107886003)(4326008)(8676002)(2616005)(1076003)(478600001)(316002)(54906003)(66946007)(52116002)(7696005);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData: eH/2rMKUkIJ0rBVKV97oHCcx28XGNPoo92DRovCXq6avmidMKSCgGNWtfk5sGS07WLTF7s61wHNUVJYX5ol8SyOTHf6ocjbDt96cd4AYABPfrHh2J3vevaj5oAbQr+5uvyyWWLkg7uIgyOdM5IZykYg01IVLvbE0mytI0xbZcA4kJHqWI/UVNrpMrxPUXDQmnbf43t9AQE6FAd/GzvfZYtQpBXag+Rx7WsfLknPRtpL8xZoVoQYTFRdyDIT4BARDEptpthTF+rVlm3svH0BPox/wMnk4T4daya9zz6LXW/U6lPW5nCbqpPFQQkloD6n0ebLJ2WoVNa1VsM4G4i8tdR9Jrlr+ZHLFyVhcwCvsdYGYpplJKgV24pDUT/Hhe5G87SsNguYvZ8whVe8poVOONHTPXsxnyQFOuZ8GRejN6SmMKloUHdCATAB5XC4gJ3yeYLxfKjqrgIAbDaalekclzcS4/cj/DMfmoHsrmugZ3FoH6GqDgLmukMf0HYXeayTWKdrSxG3uhoZT3m6DqLawpibX/3y2qrOV9+8jeYwchdc=
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 4cbc051a-6dde-4b79-5f82-08d81dd08b87
X-MS-Exchange-CrossTenant-AuthSource: SN6PR11MB2718.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 01 Jul 2020 15:08:01.0109
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: mmY6j64hEaL1Fd7C29ZpnAE9c5w9JADVz7O6/fYIN2sujaKsqR087+DJZawhuaUm69obUrwPY0iM0MhXv+da+Q==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SA0PR11MB4736
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKVGhl
IGRldmljZSBoYW5kbGVzIDQgcXVldWVzIChvbmUgcGVyIEFDKSBmb3IgZWFjaCB2aXJ0dWFsIGlu
dGVyZmFjZSAoYW5kCm1heGltdW0gNCB2aXJ0dWFsIGludGVyZmFjZXMpLiBVbnRpbCBub3cgdGhl
IGRyaXZlciB1bmlmaWVkIHRoZSBxdWV1ZSBvZgphbGwgaW50ZXJmYWNlcyBhbmQgaGFuZGxlZCBv
bmx5IDQgcXVldWVzIGZvciB3aG9sZSBkZXZpY2UuCgpUaGlzIGFyY2hpdGVjdHVyZSBkaWQgbm90
IGFsbG93IHRvIGJhbGFuY2UgdGhlIHRyYWZmaWMgYmV0d2VlbiB0aGUgdmlmLiBTbywKdGhpcyBw
YXRjaCByZWxvY2F0ZSB0aGUgcXVldWVzIGludG8gdGhlIHZpZiBhbmQgY2hhbmdlIHRoZSBBUEkg
YWNjb3JkaW5nbHkuCgpTaWduZWQtb2ZmLWJ5OiBKw6lyw7RtZSBQb3VpbGxlciA8amVyb21lLnBv
dWlsbGVyQHNpbGFicy5jb20+Ci0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9kYXRhX3R4LmMgfCAg
NTcgKysrKysrKysrLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy93ZngvbWFpbi5jICAgIHwgICAzICst
CiBkcml2ZXJzL3N0YWdpbmcvd2Z4L3F1ZXVlLmMgICB8IDE0MSArKysrKysrKysrKysrKystLS0t
LS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL3N0YWdpbmcvd2Z4L3F1ZXVlLmggICB8ICAxNSArKy0t
CiBkcml2ZXJzL3N0YWdpbmcvd2Z4L3N0YS5jICAgICB8ICAgNCArLQogZHJpdmVycy9zdGFnaW5n
L3dmeC93ZnguaCAgICAgfCAgIDIgKy0KIDYgZmlsZXMgY2hhbmdlZCwgMTExIGluc2VydGlvbnMo
KyksIDExMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L2Rh
dGFfdHguYyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV90eC5jCmluZGV4IGYwNDJlZjM2YjQw
OGUuLmNlMzA0OGM5NDk2MWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV90
eC5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvZGF0YV90eC5jCkBAIC00MDgsNyArNDA4LDcg
QEAgc3RhdGljIGludCB3ZnhfdHhfaW5uZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBp
ZWVlODAyMTFfc3RhICpzdGEsCiAKIAkvLyBBdXhpbGlhcnkgb3BlcmF0aW9ucwogCXdmeF90eF9t
YW5hZ2VfcG0od3ZpZiwgaGRyLCB0eF9wcml2LCBzdGEpOwotCXdmeF90eF9xdWV1ZXNfcHV0KHd2
aWYtPndkZXYsIHNrYik7CisJd2Z4X3R4X3F1ZXVlc19wdXQod3ZpZiwgc2tiKTsKIAlpZiAodHhf
aW5mby0+ZmxhZ3MgJiBJRUVFODAyMTFfVFhfQ1RMX1NFTkRfQUZURVJfRFRJTSkKIAkJc2NoZWR1
bGVfd29yaygmd3ZpZi0+dXBkYXRlX3RpbV93b3JrKTsKIAl3ZnhfYmhfcmVxdWVzdF90eCh3dmlm
LT53ZGV2KTsKQEAgLTUzOSw3ICs1MzksNyBAQCB2b2lkIHdmeF90eF9jb25maXJtX2NiKHN0cnVj
dCB3ZnhfdmlmICp3dmlmLCBjb25zdCBzdHJ1Y3QgaGlmX2NuZl90eCAqYXJnKQogCWNvbnN0IHN0
cnVjdCB3ZnhfdHhfcHJpdiAqdHhfcHJpdjsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwogCi0Jc2ti
ID0gd2Z4X3BlbmRpbmdfZ2V0KHd2aWYtPndkZXYsIGFyZy0+cGFja2V0X2lkKTsKKwlza2IgPSB3
ZnhfcGVuZGluZ19nZXQod3ZpZiwgYXJnLT5wYWNrZXRfaWQpOwogCWlmICghc2tiKSB7CiAJCWRl
dl93YXJuKHd2aWYtPndkZXYtPmRldiwgInJlY2VpdmVkIHVua25vd24gcGFja2V0X2lkICglIy44
eCkgZnJvbSBjaGlwXG4iLAogCQkJIGFyZy0+cGFja2V0X2lkKTsKQEAgLTU4MiwzNCArNTgyLDUw
IEBAIHZvaWQgd2Z4X3R4X2NvbmZpcm1fY2Ioc3RydWN0IHdmeF92aWYgKnd2aWYsIGNvbnN0IHN0
cnVjdCBoaWZfY25mX3R4ICphcmcpCiAJd2Z4X3NrYl9kdG9yKHd2aWYsIHNrYik7CiB9CiAKK3N0
YXRpYyB2b2lkIHdmeF9mbHVzaF92aWYoc3RydWN0IHdmeF92aWYgKnd2aWYsIHUzMiBxdWV1ZXMs
CisJCQkgIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpCit7CisJc3RydWN0IHdmeF9xdWV1
ZSAqcXVldWU7CisJaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7
IGkrKykgeworCQlpZiAoIShCSVQoaSkgJiBxdWV1ZXMpKQorCQkJY29udGludWU7CisJCXF1ZXVl
ID0gJnd2aWYtPnR4X3F1ZXVlW2ldOworCQlpZiAoZHJvcHBlZCkKKwkJCXdmeF90eF9xdWV1ZV9k
cm9wKHd2aWYsIHF1ZXVlLCBkcm9wcGVkKTsKKwl9CisJaWYgKHd2aWYtPndkZXYtPmNoaXBfZnJv
emVuKQorCQlyZXR1cm47CisJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyBpKysp
IHsKKwkJaWYgKCEoQklUKGkpICYgcXVldWVzKSkKKwkJCWNvbnRpbnVlOworCQlxdWV1ZSA9ICZ3
dmlmLT50eF9xdWV1ZVtpXTsKKwkJaWYgKHdhaXRfZXZlbnRfdGltZW91dCh3dmlmLT53ZGV2LT50
eF9kZXF1ZXVlLAorCQkJCSAgICAgICB3ZnhfdHhfcXVldWVfZW1wdHkod3ZpZiwgcXVldWUpLAor
CQkJCSAgICAgICBtc2Vjc190b19qaWZmaWVzKDEwMDApKSA8PSAwKQorCQkJZGV2X3dhcm4od3Zp
Zi0+d2Rldi0+ZGV2LAorCQkJCSAiZnJhbWVzIHF1ZXVlZCB3aGlsZSBmbHVzaGluZyB0eCBxdWV1
ZXM/Iik7CisJfQorfQorCiB2b2lkIHdmeF9mbHVzaChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywg
c3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKIAkgICAgICAgdTMyIHF1ZXVlcywgYm9vbCBkcm9w
KQogewogCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0gaHctPnByaXY7CiAJc3RydWN0IHNrX2J1ZmZf
aGVhZCBkcm9wcGVkOwotCXN0cnVjdCB3ZnhfcXVldWUgKnF1ZXVlOwogCXN0cnVjdCB3Znhfdmlm
ICp3dmlmOwogCXN0cnVjdCBoaWZfbXNnICpoaWY7CiAJc3RydWN0IHNrX2J1ZmYgKnNrYjsKLQlp
bnQgdmlmX2lkID0gLTE7Ci0JaW50IGk7CiAKLQlpZiAodmlmKQotCQl2aWZfaWQgPSAoKHN0cnVj
dCB3ZnhfdmlmICopdmlmLT5kcnZfcHJpdiktPmlkOwogCXNrYl9xdWV1ZV9oZWFkX2luaXQoJmRy
b3BwZWQpOwotCWZvciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfTlVNX0FDUzsgaSsrKSB7Ci0JCWlm
ICghKEJJVChpKSAmIHF1ZXVlcykpCi0JCQljb250aW51ZTsKLQkJcXVldWUgPSAmd2Rldi0+dHhf
cXVldWVbaV07Ci0JCWlmIChkcm9wKQotCQkJd2Z4X3R4X3F1ZXVlX2Ryb3Aod2RldiwgcXVldWUs
IHZpZl9pZCwgJmRyb3BwZWQpOwotCQlpZiAod2Rldi0+Y2hpcF9mcm96ZW4pCi0JCQljb250aW51
ZTsKLQkJaWYgKHdhaXRfZXZlbnRfdGltZW91dCh3ZGV2LT50eF9kZXF1ZXVlLAotCQkJCSAgICAg
ICB3ZnhfdHhfcXVldWVfZW1wdHkod2RldiwgcXVldWUsIHZpZl9pZCksCi0JCQkJICAgICAgIG1z
ZWNzX3RvX2ppZmZpZXMoMTAwMCkpIDw9IDApCi0JCQlkZXZfd2Fybih3ZGV2LT5kZXYsCi0JCQkJ
ICJmcmFtZXMgcXVldWVkIHdoaWxlIGZsdXNoaW5nIHR4IHF1ZXVlcz8iKTsKKwlpZiAodmlmKSB7
CisJCXd2aWYgPSAoc3RydWN0IHdmeF92aWYgKil2aWYtPmRydl9wcml2OworCQl3ZnhfZmx1c2hf
dmlmKHd2aWYsIHF1ZXVlcywgZHJvcCA/ICZkcm9wcGVkIDogTlVMTCk7CisJfSBlbHNlIHsKKwkJ
d3ZpZiA9IE5VTEw7CisJCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkg
IT0gTlVMTCkKKwkJCXdmeF9mbHVzaF92aWYod3ZpZiwgcXVldWVzLCBkcm9wID8gJmRyb3BwZWQg
OiBOVUxMKTsKIAl9CiAJd2Z4X3R4X2ZsdXNoKHdkZXYpOwogCWlmICh3ZGV2LT5jaGlwX2Zyb3pl
bikKQEAgLTYyMyw0ICs2MzksMyBAQCB2b2lkIHdmeF9mbHVzaChzdHJ1Y3QgaWVlZTgwMjExX2h3
ICpodywgc3RydWN0IGllZWU4MDIxMV92aWYgKnZpZiwKIAkJd2Z4X3NrYl9kdG9yKHd2aWYsIHNr
Yik7CiAJfQogfQotCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvd2Z4L21haW4uYyBiL2Ry
aXZlcnMvc3RhZ2luZy93ZngvbWFpbi5jCmluZGV4IDZiZDk2ZjQ3NjM4ODQuLjgwZTQ0NzRjYzMz
MTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvbWFpbi5jCisrKyBiL2RyaXZlcnMv
c3RhZ2luZy93ZngvbWFpbi5jCkBAIC0zNDksOCArMzQ5LDkgQEAgc3RydWN0IHdmeF9kZXYgKndm
eF9pbml0X2NvbW1vbihzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJaW5pdF9jb21wbGV0aW9uKCZ3ZGV2
LT5maXJtd2FyZV9yZWFkeSk7CiAJSU5JVF9ERUxBWUVEX1dPUksoJndkZXYtPmNvb2xpbmdfdGlt
ZW91dF93b3JrLAogCQkJICB3ZnhfY29vbGluZ190aW1lb3V0X3dvcmspOworCXNrYl9xdWV1ZV9o
ZWFkX2luaXQoJndkZXYtPnR4X3BlbmRpbmcpOworCWluaXRfd2FpdHF1ZXVlX2hlYWQoJndkZXYt
PnR4X2RlcXVldWUpOwogCXdmeF9pbml0X2hpZl9jbWQoJndkZXYtPmhpZl9jbWQpOwotCXdmeF90
eF9xdWV1ZXNfaW5pdCh3ZGV2KTsKIAogCWlmIChkZXZtX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGV2
LCB3ZnhfZnJlZV9jb21tb24sIHdkZXYpKQogCQlyZXR1cm4gTlVMTDsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvc3RhZ2luZy93ZngvcXVldWUuYyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvcXVldWUuYwpp
bmRleCA5M2VhMmI3MmZlYmQwLi43ZWMzNjU5OGQ5YTgzIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0
YWdpbmcvd2Z4L3F1ZXVlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9xdWV1ZS5jCkBAIC01
Nyw4NCArNTcsNTcgQEAgdm9pZCB3ZnhfdHhfbG9ja19mbHVzaChzdHJ1Y3Qgd2Z4X2RldiAqd2Rl
dikKIAl3ZnhfdHhfZmx1c2god2Rldik7CiB9CiAKLXZvaWQgd2Z4X3R4X3F1ZXVlc19pbml0KHN0
cnVjdCB3ZnhfZGV2ICp3ZGV2KQordm9pZCB3ZnhfdHhfcXVldWVzX2luaXQoc3RydWN0IHdmeF92
aWYgKnd2aWYpCiB7CiAJaW50IGk7CiAKLQlza2JfcXVldWVfaGVhZF9pbml0KCZ3ZGV2LT50eF9w
ZW5kaW5nKTsKLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZ3ZGV2LT50eF9kZXF1ZXVlKTsKIAlmb3Ig
KGkgPSAwOyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7ICsraSkgewotCQlza2JfcXVldWVfaGVhZF9p
bml0KCZ3ZGV2LT50eF9xdWV1ZVtpXS5ub3JtYWwpOwotCQlza2JfcXVldWVfaGVhZF9pbml0KCZ3
ZGV2LT50eF9xdWV1ZVtpXS5jYWIpOworCQlza2JfcXVldWVfaGVhZF9pbml0KCZ3dmlmLT50eF9x
dWV1ZVtpXS5ub3JtYWwpOworCQlza2JfcXVldWVfaGVhZF9pbml0KCZ3dmlmLT50eF9xdWV1ZVtp
XS5jYWIpOwogCX0KIH0KIAotdm9pZCB3ZnhfdHhfcXVldWVzX2NoZWNrX2VtcHR5KHN0cnVjdCB3
ZnhfZGV2ICp3ZGV2KQordm9pZCB3ZnhfdHhfcXVldWVzX2NoZWNrX2VtcHR5KHN0cnVjdCB3Znhf
dmlmICp3dmlmKQogewogCWludCBpOwogCi0JV0FSTl9PTighc2tiX3F1ZXVlX2VtcHR5X2xvY2ts
ZXNzKCZ3ZGV2LT50eF9wZW5kaW5nKSk7CiAJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1f
QUNTOyArK2kpIHsKLQkJV0FSTl9PTihhdG9taWNfcmVhZCgmd2Rldi0+dHhfcXVldWVbaV0ucGVu
ZGluZ19mcmFtZXMpKTsKLQkJV0FSTl9PTighc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3ZGV2
LT50eF9xdWV1ZVtpXS5ub3JtYWwpKTsKLQkJV0FSTl9PTighc2tiX3F1ZXVlX2VtcHR5X2xvY2ts
ZXNzKCZ3ZGV2LT50eF9xdWV1ZVtpXS5jYWIpKTsKKwkJV0FSTl9PTihhdG9taWNfcmVhZCgmd3Zp
Zi0+dHhfcXVldWVbaV0ucGVuZGluZ19mcmFtZXMpKTsKKwkJV0FSTl9PTighc2tiX3F1ZXVlX2Vt
cHR5X2xvY2tsZXNzKCZ3dmlmLT50eF9xdWV1ZVtpXS5ub3JtYWwpKTsKKwkJV0FSTl9PTighc2ti
X3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3dmlmLT50eF9xdWV1ZVtpXS5jYWIpKTsKIAl9CiB9CiAK
LXN0YXRpYyBib29sIF9fd2Z4X3R4X3F1ZXVlX2VtcHR5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAot
CQkJCSBzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpza2JfcXVldWUsIGludCB2aWZfaWQpCitib29sIHdm
eF90eF9xdWV1ZV9lbXB0eShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgc3RydWN0IHdmeF9xdWV1ZSAq
cXVldWUpCiB7Ci0Jc3RydWN0IGhpZl9tc2cgKmhpZl9tc2c7Ci0Jc3RydWN0IHNrX2J1ZmYgKnNr
YjsKLQotCXNwaW5fbG9ja19iaCgmc2tiX3F1ZXVlLT5sb2NrKTsKLQlza2JfcXVldWVfd2Fsayhz
a2JfcXVldWUsIHNrYikgewotCQloaWZfbXNnID0gKHN0cnVjdCBoaWZfbXNnICopc2tiLT5kYXRh
OwotCQlpZiAodmlmX2lkIDwgMCB8fCBoaWZfbXNnLT5pbnRlcmZhY2UgPT0gdmlmX2lkKSB7Ci0J
CQlzcGluX3VubG9ja19iaCgmc2tiX3F1ZXVlLT5sb2NrKTsKLQkJCXJldHVybiBmYWxzZTsKLQkJ
fQotCX0KLQlzcGluX3VubG9ja19iaCgmc2tiX3F1ZXVlLT5sb2NrKTsKLQlyZXR1cm4gdHJ1ZTsK
LX0KLQotYm9vbCB3ZnhfdHhfcXVldWVfZW1wdHkoc3RydWN0IHdmeF9kZXYgKndkZXYsCi0JCQlz
dHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwgaW50IHZpZl9pZCkKLXsKLQlyZXR1cm4gX193ZnhfdHhf
cXVldWVfZW1wdHkod2RldiwgJnF1ZXVlLT5ub3JtYWwsIHZpZl9pZCkgJiYKLQkgICAgICAgX193
ZnhfdHhfcXVldWVfZW1wdHkod2RldiwgJnF1ZXVlLT5jYWIsIHZpZl9pZCk7CisJcmV0dXJuIHNr
Yl9xdWV1ZV9lbXB0eSgmcXVldWUtPm5vcm1hbCkgJiYgc2tiX3F1ZXVlX2VtcHR5KCZxdWV1ZS0+
Y2FiKTsKIH0KIAotc3RhdGljIHZvaWQgX193ZnhfdHhfcXVldWVfZHJvcChzdHJ1Y3Qgd2Z4X2Rl
diAqd2RldiwKLQkJCQlzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpza2JfcXVldWUsIGludCB2aWZfaWQs
CitzdGF0aWMgdm9pZCBfX3dmeF90eF9xdWV1ZV9kcm9wKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAor
CQkJCXN0cnVjdCBza19idWZmX2hlYWQgKnNrYl9xdWV1ZSwKIAkJCQlzdHJ1Y3Qgc2tfYnVmZl9o
ZWFkICpkcm9wcGVkKQogewogCXN0cnVjdCBza19idWZmICpza2IsICp0bXA7Ci0Jc3RydWN0IGhp
Zl9tc2cgKmhpZl9tc2c7CiAKIAlzcGluX2xvY2tfYmgoJnNrYl9xdWV1ZS0+bG9jayk7CiAJc2ti
X3F1ZXVlX3dhbGtfc2FmZShza2JfcXVldWUsIHNrYiwgdG1wKSB7Ci0JCWhpZl9tc2cgPSAoc3Ry
dWN0IGhpZl9tc2cgKilza2ItPmRhdGE7Ci0JCWlmICh2aWZfaWQgPCAwIHx8IGhpZl9tc2ctPmlu
dGVyZmFjZSA9PSB2aWZfaWQpIHsKLQkJCV9fc2tiX3VubGluayhza2IsIHNrYl9xdWV1ZSk7Ci0J
CQlza2JfcXVldWVfaGVhZChkcm9wcGVkLCBza2IpOwotCQl9CisJCV9fc2tiX3VubGluayhza2Is
IHNrYl9xdWV1ZSk7CisJCXNrYl9xdWV1ZV9oZWFkKGRyb3BwZWQsIHNrYik7CiAJfQogCXNwaW5f
dW5sb2NrX2JoKCZza2JfcXVldWUtPmxvY2spOwogfQogCi12b2lkIHdmeF90eF9xdWV1ZV9kcm9w
KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwKLQkJICAgICAg
IGludCB2aWZfaWQsIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpCit2b2lkIHdmeF90eF9x
dWV1ZV9kcm9wKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwK
KwkJICAgICAgIHN0cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpCiB7Ci0JX193ZnhfdHhfcXVl
dWVfZHJvcCh3ZGV2LCAmcXVldWUtPmNhYiwgdmlmX2lkLCBkcm9wcGVkKTsKLQlfX3dmeF90eF9x
dWV1ZV9kcm9wKHdkZXYsICZxdWV1ZS0+bm9ybWFsLCB2aWZfaWQsIGRyb3BwZWQpOwotCXdha2Vf
dXAoJndkZXYtPnR4X2RlcXVldWUpOworCV9fd2Z4X3R4X3F1ZXVlX2Ryb3Aod3ZpZiwgJnF1ZXVl
LT5jYWIsIGRyb3BwZWQpOworCV9fd2Z4X3R4X3F1ZXVlX2Ryb3Aod3ZpZiwgJnF1ZXVlLT5ub3Jt
YWwsIGRyb3BwZWQpOworCXdha2VfdXAoJnd2aWYtPndkZXYtPnR4X2RlcXVldWUpOwogfQogCi12
b2lkIHdmeF90eF9xdWV1ZXNfcHV0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiKQordm9pZCB3ZnhfdHhfcXVldWVzX3B1dChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgc3Ry
dWN0IHNrX2J1ZmYgKnNrYikKIHsKLQlzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSA9ICZ3ZGV2LT50
eF9xdWV1ZVtza2JfZ2V0X3F1ZXVlX21hcHBpbmcoc2tiKV07CisJc3RydWN0IHdmeF9xdWV1ZSAq
cXVldWUgPSAmd3ZpZi0+dHhfcXVldWVbc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYildOwogCXN0
cnVjdCBpZWVlODAyMTFfdHhfaW5mbyAqdHhfaW5mbyA9IElFRUU4MDIxMV9TS0JfQ0Ioc2tiKTsK
IAogCWlmICh0eF9pbmZvLT5mbGFncyAmIElFRUU4MDIxMV9UWF9DVExfU0VORF9BRlRFUl9EVElN
KQpAQCAtMTQ2LDM5ICsxMTksNDUgQEAgdm9pZCB3ZnhfdHhfcXVldWVzX3B1dChzdHJ1Y3Qgd2Z4
X2RldiAqd2Rldiwgc3RydWN0IHNrX2J1ZmYgKnNrYikKIHZvaWQgd2Z4X3BlbmRpbmdfZHJvcChz
dHJ1Y3Qgd2Z4X2RldiAqd2Rldiwgc3RydWN0IHNrX2J1ZmZfaGVhZCAqZHJvcHBlZCkKIHsKIAlz
dHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZTsKKwlzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZjsKKwlzdHJ1Y3Qg
aGlmX21zZyAqaGlmOwogCXN0cnVjdCBza19idWZmICpza2I7CiAKIAlXQVJOKCF3ZGV2LT5jaGlw
X2Zyb3plbiwgIiVzIHNob3VsZCBvbmx5IGJlIHVzZWQgdG8gcmVjb3ZlciBhIGZyb3plbiBkZXZp
Y2UiLAogCSAgICAgX19mdW5jX18pOwogCXdoaWxlICgoc2tiID0gc2tiX2RlcXVldWUoJndkZXYt
PnR4X3BlbmRpbmcpKSAhPSBOVUxMKSB7Ci0JCXF1ZXVlID0gJndkZXYtPnR4X3F1ZXVlW3NrYl9n
ZXRfcXVldWVfbWFwcGluZyhza2IpXTsKLQkJV0FSTl9PTihza2JfZ2V0X3F1ZXVlX21hcHBpbmco
c2tiKSA+IDMpOwotCQlXQVJOX09OKCFhdG9taWNfcmVhZCgmcXVldWUtPnBlbmRpbmdfZnJhbWVz
KSk7Ci0JCWF0b21pY19kZWMoJnF1ZXVlLT5wZW5kaW5nX2ZyYW1lcyk7CisJCWhpZiA9IChzdHJ1
Y3QgaGlmX21zZyAqKXNrYi0+ZGF0YTsKKwkJd3ZpZiA9IHdkZXZfdG9fd3ZpZih3ZGV2LCBoaWYt
PmludGVyZmFjZSk7CisJCWlmICh3dmlmKSB7CisJCQlxdWV1ZSA9ICZ3dmlmLT50eF9xdWV1ZVtz
a2JfZ2V0X3F1ZXVlX21hcHBpbmcoc2tiKV07CisJCQlXQVJOX09OKHNrYl9nZXRfcXVldWVfbWFw
cGluZyhza2IpID4gMyk7CisJCQlXQVJOX09OKCFhdG9taWNfcmVhZCgmcXVldWUtPnBlbmRpbmdf
ZnJhbWVzKSk7CisJCQlhdG9taWNfZGVjKCZxdWV1ZS0+cGVuZGluZ19mcmFtZXMpOworCQl9CiAJ
CXNrYl9xdWV1ZV9oZWFkKGRyb3BwZWQsIHNrYik7CiAJfQogfQogCi1zdHJ1Y3Qgc2tfYnVmZiAq
d2Z4X3BlbmRpbmdfZ2V0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgcGFja2V0X2lkKQorc3Ry
dWN0IHNrX2J1ZmYgKndmeF9wZW5kaW5nX2dldChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgdTMyIHBh
Y2tldF9pZCkKIHsKIAlzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZTsKIAlzdHJ1Y3QgaGlmX3JlcV90
eCAqcmVxOwogCXN0cnVjdCBza19idWZmICpza2I7CiAKLQlzcGluX2xvY2tfYmgoJndkZXYtPnR4
X3BlbmRpbmcubG9jayk7Ci0Jc2tiX3F1ZXVlX3dhbGsoJndkZXYtPnR4X3BlbmRpbmcsIHNrYikg
eworCXNwaW5fbG9ja19iaCgmd3ZpZi0+d2Rldi0+dHhfcGVuZGluZy5sb2NrKTsKKwlza2JfcXVl
dWVfd2Fsaygmd3ZpZi0+d2Rldi0+dHhfcGVuZGluZywgc2tiKSB7CiAJCXJlcSA9IHdmeF9za2Jf
dHhyZXEoc2tiKTsKIAkJaWYgKHJlcS0+cGFja2V0X2lkID09IHBhY2tldF9pZCkgewotCQkJc3Bp
bl91bmxvY2tfYmgoJndkZXYtPnR4X3BlbmRpbmcubG9jayk7Ci0JCQlxdWV1ZSA9ICZ3ZGV2LT50
eF9xdWV1ZVtza2JfZ2V0X3F1ZXVlX21hcHBpbmcoc2tiKV07CisJCQlzcGluX3VubG9ja19iaCgm
d3ZpZi0+d2Rldi0+dHhfcGVuZGluZy5sb2NrKTsKKwkJCXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVl
W3NrYl9nZXRfcXVldWVfbWFwcGluZyhza2IpXTsKIAkJCVdBUk5fT04oc2tiX2dldF9xdWV1ZV9t
YXBwaW5nKHNrYikgPiAzKTsKIAkJCVdBUk5fT04oIWF0b21pY19yZWFkKCZxdWV1ZS0+cGVuZGlu
Z19mcmFtZXMpKTsKIAkJCWF0b21pY19kZWMoJnF1ZXVlLT5wZW5kaW5nX2ZyYW1lcyk7Ci0JCQlz
a2JfdW5saW5rKHNrYiwgJndkZXYtPnR4X3BlbmRpbmcpOworCQkJc2tiX3VubGluayhza2IsICZ3
dmlmLT53ZGV2LT50eF9wZW5kaW5nKTsKIAkJCXJldHVybiBza2I7CiAJCX0KIAl9Ci0Jc3Bpbl91
bmxvY2tfYmgoJndkZXYtPnR4X3BlbmRpbmcubG9jayk7CisJc3Bpbl91bmxvY2tfYmgoJnd2aWYt
PndkZXYtPnR4X3BlbmRpbmcubG9jayk7CiAJV0FSTigxLCAiY2Fubm90IGZpbmQgcGFja2V0IGlu
IHBlbmRpbmcgcXVldWUiKTsKIAlyZXR1cm4gTlVMTDsKIH0KQEAgLTIyMSw3ICsyMDAsNiBAQCB1
bnNpZ25lZCBpbnQgd2Z4X3BlbmRpbmdfZ2V0X3BrdF91c19kZWxheShzdHJ1Y3Qgd2Z4X2RldiAq
d2RldiwKIAogYm9vbCB3ZnhfdHhfcXVldWVzX2hhc19jYWIoc3RydWN0IHdmeF92aWYgKnd2aWYp
CiB7Ci0Jc3RydWN0IHdmeF9kZXYgKndkZXYgPSB3dmlmLT53ZGV2OwogCWludCBpOwogCiAJaWYg
KHd2aWYtPnZpZi0+dHlwZSAhPSBOTDgwMjExX0lGVFlQRV9BUCkKQEAgLTIyOSwzMyArMjA3LDM5
IEBAIGJvb2wgd2Z4X3R4X3F1ZXVlc19oYXNfY2FiKHN0cnVjdCB3ZnhfdmlmICp3dmlmKQogCWZv
ciAoaSA9IDA7IGkgPCBJRUVFODAyMTFfTlVNX0FDUzsgKytpKQogCQkvLyBOb3RlOiBzaW5jZSBv
bmx5IEFQIGNhbiBoYXZlIG1jYXN0IGZyYW1lcyBpbiBxdWV1ZSBhbmQgb25seQogCQkvLyBvbmUg
dmlmIGNhbiBiZSBBUCwgYWxsIHF1ZXVlZCBmcmFtZXMgaGFzIHNhbWUgaW50ZXJmYWNlIGlkCi0J
CWlmICghc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZ3ZGV2LT50eF9xdWV1ZVtpXS5jYWIpKQor
CQlpZiAoIXNrYl9xdWV1ZV9lbXB0eV9sb2NrbGVzcygmd3ZpZi0+dHhfcXVldWVbaV0uY2FiKSkK
IAkJCXJldHVybiB0cnVlOwogCXJldHVybiBmYWxzZTsKIH0KIAogc3RhdGljIHN0cnVjdCBza19i
dWZmICp3ZnhfdHhfcXVldWVzX2dldF9za2Ioc3RydWN0IHdmeF9kZXYgKndkZXYpCiB7Ci0Jc3Ry
dWN0IHdmeF9xdWV1ZSAqc29ydGVkX3F1ZXVlc1tJRUVFODAyMTFfTlVNX0FDU107CisJc3RydWN0
IHdmeF9xdWV1ZSAqcXVldWVzW0lFRUU4MDIxMV9OVU1fQUNTICogQVJSQVlfU0laRSh3ZGV2LT52
aWYpXTsKKwlpbnQgaSwgaiwgbnVtX3F1ZXVlcyA9IDA7CiAJc3RydWN0IHdmeF92aWYgKnd2aWY7
CiAJc3RydWN0IGhpZl9tc2cgKmhpZjsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCWludCBpLCBq
OwogCi0JLy8gYnViYmxlIHNvcnQKLQlmb3IgKGkgPSAwOyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7
IGkrKykgewotCQlzb3J0ZWRfcXVldWVzW2ldID0gJndkZXYtPnR4X3F1ZXVlW2ldOwotCQlmb3Ig
KGogPSBpOyBqID4gMDsgai0tKQotCQkJaWYgKGF0b21pY19yZWFkKCZzb3J0ZWRfcXVldWVzW2pd
LT5wZW5kaW5nX2ZyYW1lcykgPAotCQkJICAgIGF0b21pY19yZWFkKCZzb3J0ZWRfcXVldWVzW2og
LSAxXS0+cGVuZGluZ19mcmFtZXMpKQotCQkJCXN3YXAoc29ydGVkX3F1ZXVlc1tqIC0gMV0sIHNv
cnRlZF9xdWV1ZXNbal0pOworCS8vIHNvcnQgdGhlIHF1ZXVlcworCXd2aWYgPSBOVUxMOworCXdo
aWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgeworCQlmb3Ig
KGkgPSAwOyBpIDwgSUVFRTgwMjExX05VTV9BQ1M7IGkrKykgeworCQkJV0FSTl9PTihudW1fcXVl
dWVzID49IEFSUkFZX1NJWkUocXVldWVzKSk7CisJCQlxdWV1ZXNbbnVtX3F1ZXVlc10gPSAmd3Zp
Zi0+dHhfcXVldWVbaV07CisJCQlmb3IgKGogPSBudW1fcXVldWVzOyBqID4gMDsgai0tKQorCQkJ
CWlmIChhdG9taWNfcmVhZCgmcXVldWVzW2pdLT5wZW5kaW5nX2ZyYW1lcykgPAorCQkJCSAgICBh
dG9taWNfcmVhZCgmcXVldWVzW2ogLSAxXS0+cGVuZGluZ19mcmFtZXMpKQorCQkJCQlzd2FwKHF1
ZXVlc1tqIC0gMV0sIHF1ZXVlc1tqXSk7CisJCQludW1fcXVldWVzKys7CisJCX0KIAl9CisKIAl3
dmlmID0gTlVMTDsKIAl3aGlsZSAoKHd2aWYgPSB3dmlmX2l0ZXJhdGUod2Rldiwgd3ZpZikpICE9
IE5VTEwpIHsKIAkJaWYgKCF3dmlmLT5hZnRlcl9kdGltX3R4X2FsbG93ZWQpCiAJCQljb250aW51
ZTsKLQkJZm9yIChpID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyBpKyspIHsKLQkJCXNrYiA9
IHNrYl9kZXF1ZXVlKCZzb3J0ZWRfcXVldWVzW2ldLT5jYWIpOworCQlmb3IgKGkgPSAwOyBpIDwg
bnVtX3F1ZXVlczsgaSsrKSB7CisJCQlza2IgPSBza2JfZGVxdWV1ZSgmcXVldWVzW2ldLT5jYWIp
OwogCQkJaWYgKCFza2IpCiAJCQkJY29udGludWU7CiAJCQkvLyBOb3RlOiBzaW5jZSBvbmx5IEFQ
IGNhbiBoYXZlIG1jYXN0IGZyYW1lcyBpbiBxdWV1ZQpAQCAtMjYzLDIxICsyNDcsMjAgQEAgc3Rh
dGljIHN0cnVjdCBza19idWZmICp3ZnhfdHhfcXVldWVzX2dldF9za2Ioc3RydWN0IHdmeF9kZXYg
KndkZXYpCiAJCQkvLyBzYW1lIGludGVyZmFjZSBpZAogCQkJaGlmID0gKHN0cnVjdCBoaWZfbXNn
ICopc2tiLT5kYXRhOwogCQkJV0FSTl9PTihoaWYtPmludGVyZmFjZSAhPSB3dmlmLT5pZCk7Ci0J
CQlXQVJOX09OKHNvcnRlZF9xdWV1ZXNbaV0gIT0KLQkJCQkmd2Rldi0+dHhfcXVldWVbc2tiX2dl
dF9xdWV1ZV9tYXBwaW5nKHNrYildKTsKLQkJCWF0b21pY19pbmMoJnNvcnRlZF9xdWV1ZXNbaV0t
PnBlbmRpbmdfZnJhbWVzKTsKKwkJCVdBUk5fT04ocXVldWVzW2ldICE9CisJCQkJJnd2aWYtPnR4
X3F1ZXVlW3NrYl9nZXRfcXVldWVfbWFwcGluZyhza2IpXSk7CisJCQlhdG9taWNfaW5jKCZxdWV1
ZXNbaV0tPnBlbmRpbmdfZnJhbWVzKTsKIAkJCXJldHVybiBza2I7CiAJCX0KIAkJLy8gTm8gbW9y
ZSBtdWx0aWNhc3QgdG8gc2VudAogCQl3dmlmLT5hZnRlcl9kdGltX3R4X2FsbG93ZWQgPSBmYWxz
ZTsKIAkJc2NoZWR1bGVfd29yaygmd3ZpZi0+dXBkYXRlX3RpbV93b3JrKTsKIAl9Ci0JZm9yIChp
ID0gMDsgaSA8IElFRUU4MDIxMV9OVU1fQUNTOyBpKyspIHsKLQkJc2tiID0gc2tiX2RlcXVldWUo
JnNvcnRlZF9xdWV1ZXNbaV0tPm5vcm1hbCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX3F1ZXVl
czsgaSsrKSB7CisJCXNrYiA9IHNrYl9kZXF1ZXVlKCZxdWV1ZXNbaV0tPm5vcm1hbCk7CiAJCWlm
IChza2IpIHsKLQkJCVdBUk5fT04oc29ydGVkX3F1ZXVlc1tpXSAhPQotCQkJCSZ3ZGV2LT50eF9x
dWV1ZVtza2JfZ2V0X3F1ZXVlX21hcHBpbmcoc2tiKV0pOwotCQkJYXRvbWljX2luYygmc29ydGVk
X3F1ZXVlc1tpXS0+cGVuZGluZ19mcmFtZXMpOworCQkJYXRvbWljX2luYygmcXVldWVzW2ldLT5w
ZW5kaW5nX2ZyYW1lcyk7CiAJCQlyZXR1cm4gc2tiOwogCQl9CiAJfQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9zdGFnaW5nL3dmeC9xdWV1ZS5oIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9xdWV1ZS5oCmlu
ZGV4IDBjM2I3MjQ0NDk4ZTMuLmRmYmJlNGIxMTExMTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3Rh
Z2luZy93ZngvcXVldWUuaAorKysgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3F1ZXVlLmgKQEAgLTI1
LDE4ICsyNSwxNyBAQCB2b2lkIHdmeF90eF91bmxvY2soc3RydWN0IHdmeF9kZXYgKndkZXYpOwog
dm9pZCB3ZnhfdHhfZmx1c2goc3RydWN0IHdmeF9kZXYgKndkZXYpOwogdm9pZCB3ZnhfdHhfbG9j
a19mbHVzaChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7CiAKLXZvaWQgd2Z4X3R4X3F1ZXVlc19pbml0
KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2KTsKLXZvaWQgd2Z4X3R4X3F1ZXVlc19jaGVja19lbXB0eShz
dHJ1Y3Qgd2Z4X2RldiAqd2Rldik7Cit2b2lkIHdmeF90eF9xdWV1ZXNfaW5pdChzdHJ1Y3Qgd2Z4
X3ZpZiAqd3ZpZik7Cit2b2lkIHdmeF90eF9xdWV1ZXNfY2hlY2tfZW1wdHkoc3RydWN0IHdmeF92
aWYgKnd2aWYpOwogYm9vbCB3ZnhfdHhfcXVldWVzX2hhc19jYWIoc3RydWN0IHdmeF92aWYgKnd2
aWYpOwotdm9pZCB3ZnhfdHhfcXVldWVzX3B1dChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldiwgc3RydWN0
IHNrX2J1ZmYgKnNrYik7Cit2b2lkIHdmeF90eF9xdWV1ZXNfcHV0KHN0cnVjdCB3ZnhfdmlmICp3
dmlmLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKTsKIHN0cnVjdCBoaWZfbXNnICp3ZnhfdHhfcXVldWVz
X2dldChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldik7CiAKLWJvb2wgd2Z4X3R4X3F1ZXVlX2VtcHR5KHN0
cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwKLQkJCWludCB2aWZf
aWQpOwotdm9pZCB3ZnhfdHhfcXVldWVfZHJvcChzdHJ1Y3Qgd2Z4X2RldiAqd2Rldiwgc3RydWN0
IHdmeF9xdWV1ZSAqcXVldWUsCi0JCSAgICAgICBpbnQgdmlmX2lkLCBzdHJ1Y3Qgc2tfYnVmZl9o
ZWFkICpkcm9wcGVkKTsKK2Jvb2wgd2Z4X3R4X3F1ZXVlX2VtcHR5KHN0cnVjdCB3ZnhfdmlmICp3
dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSk7Cit2b2lkIHdmeF90eF9xdWV1ZV9kcm9wKHN0
cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgd2Z4X3F1ZXVlICpxdWV1ZSwKKwkJICAgICAgIHN0
cnVjdCBza19idWZmX2hlYWQgKmRyb3BwZWQpOwogCi1zdHJ1Y3Qgc2tfYnVmZiAqd2Z4X3BlbmRp
bmdfZ2V0KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCB1MzIgcGFja2V0X2lkKTsKK3N0cnVjdCBza19i
dWZmICp3ZnhfcGVuZGluZ19nZXQoc3RydWN0IHdmeF92aWYgKnd2aWYsIHUzMiBwYWNrZXRfaWQp
Owogdm9pZCB3ZnhfcGVuZGluZ19kcm9wKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tf
YnVmZl9oZWFkICpkcm9wcGVkKTsKIHVuc2lnbmVkIGludCB3ZnhfcGVuZGluZ19nZXRfcGt0X3Vz
X2RlbGF5KHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LAogCQkJCQkgIHN0cnVjdCBza19idWZmICpza2Ip
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYyBiL2RyaXZlcnMvc3RhZ2lu
Zy93Zngvc3RhLmMKaW5kZXggZDg1NWQ4N2MyMTAyOC4uODVkNGJjMjk0OTg4MiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3N0
YS5jCkBAIC04MDUsNiArODA1LDcgQEAgaW50IHdmeF9hZGRfaW50ZXJmYWNlKHN0cnVjdCBpZWVl
ODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmKQogCiAJaGlmX3NldF9tYWNh
ZGRyKHd2aWYsIHZpZi0+YWRkcik7CiAKKwl3ZnhfdHhfcXVldWVzX2luaXQod3ZpZik7CiAJd2Z4
X3R4X3BvbGljeV9pbml0KHd2aWYpOwogCXd2aWYgPSBOVUxMOwogCXdoaWxlICgod3ZpZiA9IHd2
aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgewpAQCAtODIzLDYgKzgyNCw3IEBAIHZv
aWQgd2Z4X3JlbW92ZV9pbnRlcmZhY2Uoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBp
ZWVlODAyMTFfdmlmICp2aWYpCiAJc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92
aWYgKil2aWYtPmRydl9wcml2OwogCiAJd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ3dmlm
LT5zZXRfcG1fbW9kZV9jb21wbGV0ZSwgbXNlY3NfdG9famlmZmllcygzMDApKTsKKwl3ZnhfdHhf
cXVldWVzX2NoZWNrX2VtcHR5KHd2aWYpOwogCiAJbXV0ZXhfbG9jaygmd2Rldi0+Y29uZl9tdXRl
eCk7CiAJV0FSTih3dmlmLT5saW5rX2lkX21hcCAhPSAxLCAiY29ycnVwdGVkIHN0YXRlIik7CkBA
IC04NTUsNSArODU3LDUgQEAgdm9pZCB3Znhfc3RvcChzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodykK
IHsKIAlzdHJ1Y3Qgd2Z4X2RldiAqd2RldiA9IGh3LT5wcml2OwogCi0Jd2Z4X3R4X3F1ZXVlc19j
aGVja19lbXB0eSh3ZGV2KTsKKwlXQVJOX09OKCFza2JfcXVldWVfZW1wdHlfbG9ja2xlc3MoJndk
ZXYtPnR4X3BlbmRpbmcpKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy93Zngvd2Z4
LmggYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3dmeC5oCmluZGV4IDczZTIxNjczM2NlNGYuLjBjNDRi
NzMzZWY2ZmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93Zngvd2Z4LmgKKysrIGIvZHJp
dmVycy9zdGFnaW5nL3dmeC93ZnguaApAQCAtNDgsNyArNDgsNiBAQCBzdHJ1Y3Qgd2Z4X2RldiB7
CiAJc3RydWN0IG11dGV4CQljb25mX211dGV4OwogCiAJc3RydWN0IHdmeF9oaWZfY21kCWhpZl9j
bWQ7Ci0Jc3RydWN0IHdmeF9xdWV1ZQl0eF9xdWV1ZVs0XTsKIAlzdHJ1Y3Qgc2tfYnVmZl9oZWFk
CXR4X3BlbmRpbmc7CiAJd2FpdF9xdWV1ZV9oZWFkX3QJdHhfZGVxdWV1ZTsKIAlhdG9taWNfdAkJ
dHhfbG9jazsKQEAgLTc1LDYgKzc0LDcgQEAgc3RydWN0IHdmeF92aWYgewogCiAJc3RydWN0IGRl
bGF5ZWRfd29yawliZWFjb25fbG9zc193b3JrOwogCisJc3RydWN0IHdmeF9xdWV1ZQl0eF9xdWV1
ZVs0XTsKIAlzdHJ1Y3QgdHhfcG9saWN5X2NhY2hlCXR4X3BvbGljeV9jYWNoZTsKIAlzdHJ1Y3Qg
d29ya19zdHJ1Y3QJdHhfcG9saWN5X3VwbG9hZF93b3JrOwogCi0tIAoyLjI3LjAKCg==
