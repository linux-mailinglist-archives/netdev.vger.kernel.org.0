Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 91292315E3
	for <lists+netdev@lfdr.de>; Fri, 31 May 2019 22:10:31 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727515AbfEaUKJ (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 31 May 2019 16:10:09 -0400
Received: from mail-eopbgr60041.outbound.protection.outlook.com ([40.107.6.41]:7493
        "EHLO EUR04-DB3-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727494AbfEaUKI (ORCPT <rfc822;netdev@vger.kernel.org>);
        Fri, 31 May 2019 16:10:08 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=FHayWoHAGD/jbourFbKfwGxZFTHGos+8+F+woIrmQmQ=;
 b=oAgQw7tOssVlpQtAHVdKvAToSIJTgTmDNPvyuacqS5vg5xjuVd+8cSYIxUnFfgbE41kYtN5VHwzsZCo1fYeo2adShEw2ORgsUfmMWSQKcr7x4LrtewD5MWECkHDcwElMs23BSSJ7PpBjL79Q+xFLVeytUWggb0GMMB3QSKFOUCM=
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com (20.178.125.223) by
 VI1PR05MB5600.eurprd05.prod.outlook.com (20.177.203.32) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1922.16; Fri, 31 May 2019 20:09:35 +0000
Received: from VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::dd31:2532:9adf:9b38]) by VI1PR05MB5902.eurprd05.prod.outlook.com
 ([fe80::dd31:2532:9adf:9b38%6]) with mapi id 15.20.1922.021; Fri, 31 May 2019
 20:09:35 +0000
From:   Saeed Mahameed <saeedm@mellanox.com>
To:     "David S. Miller" <davem@davemloft.net>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        Yevgeny Kliteynik <kliteyn@mellanox.com>,
        Oz Shlomo <ozsh@mellanox.com>,
        Saeed Mahameed <saeedm@mellanox.com>
Subject: [net-next 7/9] net/mlx5e: Geneve, Add support for encap/decap flows
 offload
Thread-Topic: [net-next 7/9] net/mlx5e: Geneve, Add support for encap/decap
 flows offload
Thread-Index: AQHVF+zEIqn60mpr+USKd4UoLbRHMQ==
Date:   Fri, 31 May 2019 20:09:35 +0000
Message-ID: <20190531200838.25184-8-saeedm@mellanox.com>
References: <20190531200838.25184-1-saeedm@mellanox.com>
In-Reply-To: <20190531200838.25184-1-saeedm@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.21.0
x-originating-ip: [209.116.155.178]
x-clientproxiedby: BYAPR07CA0086.namprd07.prod.outlook.com
 (2603:10b6:a03:12b::27) To VI1PR05MB5902.eurprd05.prod.outlook.com
 (2603:10a6:803:df::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=saeedm@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: a285e4c7-cf03-4b3a-ecac-08d6e603e69f
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(5600148)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);SRVR:VI1PR05MB5600;
x-ms-traffictypediagnostic: VI1PR05MB5600:
x-microsoft-antispam-prvs: <VI1PR05MB5600ED018A19276CA8A6B366BE190@VI1PR05MB5600.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 00540983E2
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(39860400002)(376002)(366004)(136003)(396003)(346002)(189003)(199004)(99286004)(52116002)(2616005)(6116002)(6512007)(14444005)(107886003)(486006)(54906003)(386003)(476003)(76176011)(186003)(26005)(3846002)(11346002)(305945005)(81166006)(66066001)(256004)(6506007)(4326008)(25786009)(6486002)(102836004)(6436002)(66946007)(8936002)(64756008)(7736002)(8676002)(53936002)(66476007)(73956011)(30864003)(446003)(66556008)(81156014)(66446008)(6916009)(1076003)(68736007)(2906002)(86362001)(71190400001)(14454004)(5660300002)(316002)(508600001)(36756003)(50226002)(53946003)(71200400001)(309714004);DIR:OUT;SFP:1101;SCL:1;SRVR:VI1PR05MB5600;H:VI1PR05MB5902.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: y1GSQ2S3YNrPWDkv2km9AA0QoQrCmue4girrEIEXHRPqObjJ6p+kvEHnMsuFM5QAK7JgoTRkPVyQq8+VoLinvFjm8KGU4piucB63R+qqyMhrpU+bHpZ9Ptm52lNBudWtFvDY4SEhITLx3rxmjHLa7ROWgXV6YYjevD/2nFOogUgLhTpwyp/JscVa1Fs70bYs2r66Nqva/aKInv4SDR8x16cNLvOV8FFpyoqtP7/PEG1bZ9cq9aTLpUNI2/AILvrw0aTOPPrRUUUrJlfT/+4AB+htSlSsImNvPN4XUyHUZKzE67+RJ+cEhT2Lf8ubdlyguzy7EijPcGZsoC+9EghRSBhXcYYcsg3hrSRd7ryQCpngMjY8GAKdHOD6TpBR5OU5lWR6FV6xAc4sQGLrQ3CMvBUuJ8nR0nt+64br4LgHR9M=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: a285e4c7-cf03-4b3a-ecac-08d6e603e69f
X-MS-Exchange-CrossTenant-originalarrivaltime: 31 May 2019 20:09:35.2782
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: saeedm@mellanox.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VI1PR05MB5600
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogWWV2Z2VueSBLbGl0ZXluaWsgPGtsaXRleW5AbWVsbGFub3guY29tPg0KDQpBZGQgSFcg
b2ZmbG9hZGluZyBzdXBwb3J0IGZvciBmbG93cyB3aXRoIEdlbmV2ZSBlbmNhcC9kZWNhcC4NCg0K
Tm90ZXMgYWJvdXQgZGVjYXAgZmxvd3Mgd2l0aCBHZW5ldmUgVExWIE9wdGlvbnM6DQogIC0gU3Vw
cG9ydCBvZmZsb2FkaW5nIG9mIDMyLWJpdCBvcHRpb25zIGRhdGEgb25seQ0KICAtIEF0IGFueSBn
aXZlbiB0aW1lLCBvbmx5IG9uZSBjb21iaW5hdGlvbiBvZiBjbGFzcy90eXBlIHBhcmFtZXRlcnMN
CiAgICBjYW4gYmUgb2ZmbG9hZGVkLCBidXQgdGhlIHNhbWUgY2xhc3MvdHlwZSBjb21iaW5hdGlv
biBjYW4gaGF2ZQ0KICAgIG1hbnkgZGlmZmVyZW50IGZsb3dzIG9mZmxvYWRlZCB3aXRoIGRpZmZl
cmVudCAzMi1iaXQgb3B0aW9uIGRhdGENCiAgLSBPcHRpb25zIHdpdGggdmFsdWUgb2YgMCBjYW4n
dCBiZSBvZmZsb2FkZWQNCg0KUmV2aWV3ZWQtYnk6IE96IFNobG9tbyA8b3pzaEBtZWxsYW5veC5j
b20+DQpTaWduZWQtb2ZmLWJ5OiBZZXZnZW55IEtsaXRleW5payA8a2xpdGV5bkBtZWxsYW5veC5j
b20+DQpTaWduZWQtb2ZmLWJ5OiBTYWVlZCBNYWhhbWVlZCA8c2FlZWRtQG1lbGxhbm94LmNvbT4N
Ci0tLQ0KIC4uLi9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL01ha2VmaWxlICB8ICAg
MyArLQ0KIC4uLi9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmMgICB8ICAg
MyArDQogLi4uL2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi90Y190dW4uaCAgIHwgICAy
ICsNCiAuLi4vbWVsbGFub3gvbWx4NS9jb3JlL2VuL3RjX3R1bl9nZW5ldmUuYyAgICAgfCAzMzUg
KysrKysrKysrKysrKysrKysrDQogLi4uL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUv
ZW5fdGMuYyAgIHwgIDIzICstDQogNSBmaWxlcyBjaGFuZ2VkLCAzNjMgaW5zZXJ0aW9ucygrKSwg
MyBkZWxldGlvbnMoLSkNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuL3RjX3R1bl9nZW5ldmUuYw0KDQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL01ha2VmaWxlIGIvZHJpdmVycy9u
ZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL01ha2VmaWxlDQppbmRleCBmMWYyMjJmYzY3
ZTIuLjBhMzQyMjNlODg2NyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9NYWtlZmlsZQ0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL01ha2VmaWxlDQpAQCAtMzIsNyArMzIsOCBAQCBtbHg1X2NvcmUtJChDT05G
SUdfTUxYNV9FTl9BUkZTKSAgICAgKz0gZW5fYXJmcy5vDQogbWx4NV9jb3JlLSQoQ09ORklHX01M
WDVfRU5fUlhORkMpICAgICs9IGVuX2ZzX2V0aHRvb2wubw0KIG1seDVfY29yZS0kKENPTkZJR19N
TFg1X0NPUkVfRU5fRENCKSArPSBlbl9kY2JubC5vIGVuL3BvcnRfYnVmZmVyLm8NCiBtbHg1X2Nv
cmUtJChDT05GSUdfTUxYNV9FU1dJVENIKSAgICAgKz0gZW5fcmVwLm8gZW5fdGMubyBlbi90Y190
dW4ubyBsaWIvcG9ydF90dW4ubyBsYWdfbXAubyBcDQotCQkJCQlsaWIvZ2VuZXZlLm8gZW4vdGNf
dHVuX3Z4bGFuLm8gZW4vdGNfdHVuX2dyZS5vDQorCQkJCQlsaWIvZ2VuZXZlLm8gZW4vdGNfdHVu
X3Z4bGFuLm8gZW4vdGNfdHVuX2dyZS5vIFwNCisJCQkJCWVuL3RjX3R1bl9nZW5ldmUubw0KIA0K
ICMNCiAjIENvcmUgZXh0cmENCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5v
eC9tbHg1L2NvcmUvZW4vdGNfdHVuLmMNCmluZGV4IDZmMzFiNjg3NjMxNi4uYjA5OTk2OGIyYjdh
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vu
L3RjX3R1bi5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUv
ZW4vdGNfdHVuLmMNCkBAIC0zLDEyICszLDE1IEBADQogDQogI2luY2x1ZGUgPG5ldC92eGxhbi5o
Pg0KICNpbmNsdWRlIDxuZXQvZ3JlLmg+DQorI2luY2x1ZGUgPG5ldC9nZW5ldmUuaD4NCiAjaW5j
bHVkZSAiZW4vdGNfdHVuLmgiDQogDQogc3RydWN0IG1seDVlX3RjX3R1bm5lbCAqbWx4NWVfZ2V0
X3RjX3R1bihzdHJ1Y3QgbmV0X2RldmljZSAqdHVubmVsX2RldikNCiB7DQogCWlmIChuZXRpZl9p
c192eGxhbih0dW5uZWxfZGV2KSkNCiAJCXJldHVybiAmdnhsYW5fdHVubmVsOw0KKwllbHNlIGlm
IChuZXRpZl9pc19nZW5ldmUodHVubmVsX2RldikpDQorCQlyZXR1cm4gJmdlbmV2ZV90dW5uZWw7
DQogCWVsc2UgaWYgKG5ldGlmX2lzX2dyZXRhcCh0dW5uZWxfZGV2KSB8fA0KIAkJIG5ldGlmX2lz
X2lwNmdyZXRhcCh0dW5uZWxfZGV2KSkNCiAJCXJldHVybiAmZ3JlX3R1bm5lbDsNCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmgg
Yi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmgNCmlu
ZGV4IGNhMWQzMzcwYjQyOS4uM2M0OGY3ZTYyNTA1IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3RjX3R1bi5oDQorKysgYi9kcml2ZXJzL25l
dC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuLmgNCkBAIC0xNCw2ICsxNCw3
IEBADQogZW51bSB7DQogCU1MWDVFX1RDX1RVTk5FTF9UWVBFX1VOS05PV04sDQogCU1MWDVFX1RD
X1RVTk5FTF9UWVBFX1ZYTEFOLA0KKwlNTFg1RV9UQ19UVU5ORUxfVFlQRV9HRU5FVkUsDQogCU1M
WDVFX1RDX1RVTk5FTF9UWVBFX0dSRVRBUCwNCiB9Ow0KIA0KQEAgLTQzLDYgKzQ0LDcgQEAgc3Ry
dWN0IG1seDVlX3RjX3R1bm5lbCB7DQogfTsNCiANCiBleHRlcm4gc3RydWN0IG1seDVlX3RjX3R1
bm5lbCB2eGxhbl90dW5uZWw7DQorZXh0ZXJuIHN0cnVjdCBtbHg1ZV90Y190dW5uZWwgZ2VuZXZl
X3R1bm5lbDsNCiBleHRlcm4gc3RydWN0IG1seDVlX3RjX3R1bm5lbCBncmVfdHVubmVsOw0KIA0K
IHN0cnVjdCBtbHg1ZV90Y190dW5uZWwgKm1seDVlX2dldF90Y190dW4oc3RydWN0IG5ldF9kZXZp
Y2UgKnR1bm5lbF9kZXYpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9lbi90Y190dW5fZ2VuZXZlLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9t
ZWxsYW5veC9tbHg1L2NvcmUvZW4vdGNfdHVuX2dlbmV2ZS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0
NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4yMzhhZTg1ZDA3Y2MNCi0tLSAvZGV2L251bGwNCisrKyBi
L2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi90Y190dW5fZ2VuZXZl
LmMNCkBAIC0wLDAgKzEsMzM1IEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAgT1IgTGludXgtT3BlbklCDQorLyogQ29weXJpZ2h0IChjKSAyMDE4IE1lbGxhbm94IFRlY2hu
b2xvZ2llcy4gKi8NCisNCisjaW5jbHVkZSA8bmV0L2dlbmV2ZS5oPg0KKyNpbmNsdWRlICJsaWIv
Z2VuZXZlLmgiDQorI2luY2x1ZGUgImVuL3RjX3R1bi5oIg0KKw0KKyNkZWZpbmUgTUxYNUVfR0VO
RVZFX1ZFUiAwDQorDQorc3RhdGljIGJvb2wgbWx4NWVfdGNfdHVuX2Nhbl9vZmZsb2FkX2dlbmV2
ZShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCit7DQorCXJldHVybiAhIShNTFg1X0NBUF9HRU4o
cHJpdi0+bWRldiwgZmxleF9wYXJzZXJfcHJvdG9jb2xzKSAmIE1MWDVfRkxFWF9QUk9UT19HRU5F
VkUpOw0KK30NCisNCitzdGF0aWMgaW50IG1seDVlX3RjX3R1bl9jYWxjX2hsZW5fZ2VuZXZlKHN0
cnVjdCBtbHg1ZV9lbmNhcF9lbnRyeSAqZSkNCit7DQorCXJldHVybiBzaXplb2Yoc3RydWN0IHVk
cGhkcikgKw0KKwkgICAgICAgc2l6ZW9mKHN0cnVjdCBnZW5ldmVoZHIpICsNCisJICAgICAgIGUt
PnR1bl9pbmZvLT5vcHRpb25zX2xlbjsNCit9DQorDQorc3RhdGljIGludCBtbHg1ZV90Y190dW5f
Y2hlY2tfdWRwX2Rwb3J0X2dlbmV2ZShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkJCSAg
ICAgICBzdHJ1Y3QgdGNfY2xzX2Zsb3dlcl9vZmZsb2FkICpmKQ0KK3sNCisJc3RydWN0IGZsb3df
cnVsZSAqcnVsZSA9IHRjX2Nsc19mbG93ZXJfb2ZmbG9hZF9mbG93X3J1bGUoZik7DQorCXN0cnVj
dCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjayA9IGYtPmNvbW1vbi5leHRhY2s7DQorCXN0cnVjdCBm
bG93X21hdGNoX3BvcnRzIGVuY19wb3J0czsNCisNCisJaWYgKCFmbG93X3J1bGVfbWF0Y2hfa2V5
KHJ1bGUsIEZMT1dfRElTU0VDVE9SX0tFWV9FTkNfUE9SVFMpKQ0KKwkJcmV0dXJuIC1FT1BOT1RT
VVBQOw0KKw0KKwlmbG93X3J1bGVfbWF0Y2hfZW5jX3BvcnRzKHJ1bGUsICZlbmNfcG9ydHMpOw0K
Kw0KKwkvKiBDdXJyZW50bHkgd2Ugc3VwcG9ydCBvbmx5IGRlZmF1bHQgR0VORVZFDQorCSAqIHBv
cnQsIHNvIHVkcCBkc3QgcG9ydCBtdXN0IG1hdGNoLg0KKwkgKi8NCisJaWYgKGJlMTZfdG9fY3B1
KGVuY19wb3J0cy5rZXktPmRzdCkgIT0gR0VORVZFX1VEUF9QT1JUKSB7DQorCQlOTF9TRVRfRVJS
X01TR19NT0QoZXh0YWNrLA0KKwkJCQkgICAiTWF0Y2hlZCBVRFAgZHN0IHBvcnQgaXMgbm90IHJl
Z2lzdGVyZWQgYXMgYSBHRU5FVkUgcG9ydCIpOw0KKwkJbmV0ZGV2X3dhcm4ocHJpdi0+bmV0ZGV2
LA0KKwkJCSAgICAiVURQIHBvcnQgJWQgaXMgbm90IHJlZ2lzdGVyZWQgYXMgYSBHRU5FVkUgcG9y
dFxuIiwNCisJCQkgICAgYmUxNl90b19jcHUoZW5jX3BvcnRzLmtleS0+ZHN0KSk7DQorCQlyZXR1
cm4gLUVPUE5PVFNVUFA7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQg
bWx4NWVfdGNfdHVuX3BhcnNlX3VkcF9wb3J0c19nZW5ldmUoc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsDQorCQkJCQkgICAgICAgc3RydWN0IG1seDVfZmxvd19zcGVjICpzcGVjLA0KKwkJCQkJICAg
ICAgIHN0cnVjdCB0Y19jbHNfZmxvd2VyX29mZmxvYWQgKmYsDQorCQkJCQkgICAgICAgdm9pZCAq
aGVhZGVyc19jLA0KKwkJCQkJICAgICAgIHZvaWQgKmhlYWRlcnNfdikNCit7DQorCWludCBlcnI7
DQorDQorCWVyciA9IG1seDVlX3RjX3R1bl9wYXJzZV91ZHBfcG9ydHMocHJpdiwgc3BlYywgZiwg
aGVhZGVyc19jLCBoZWFkZXJzX3YpOw0KKwlpZiAoZXJyKQ0KKwkJcmV0dXJuIGVycjsNCisNCisJ
cmV0dXJuIG1seDVlX3RjX3R1bl9jaGVja191ZHBfZHBvcnRfZ2VuZXZlKHByaXYsIGYpOw0KK30N
CisNCitzdGF0aWMgaW50IG1seDVlX3RjX3R1bl9pbml0X2VuY2FwX2F0dHJfZ2VuZXZlKHN0cnVj
dCBuZXRfZGV2aWNlICp0dW5uZWxfZGV2LA0KKwkJCQkJICAgICAgIHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2LA0KKwkJCQkJICAgICAgIHN0cnVjdCBtbHg1ZV9lbmNhcF9lbnRyeSAqZSwNCisJCQkJ
CSAgICAgICBzdHJ1Y3QgbmV0bGlua19leHRfYWNrICpleHRhY2spDQorew0KKwllLT50dW5uZWwg
PSAmZ2VuZXZlX3R1bm5lbDsNCisNCisJLyogUmVmb3JtYXQgdHlwZSBmb3IgR0VORVZFIGVuY2Fw
IGlzIHNpbWlsYXIgdG8gVlhMQU46DQorCSAqIGluIGJvdGggY2FzZXMgdGhlIEhXIGFkZHMgaW4g
dGhlIHNhbWUgcGxhY2UgYQ0KKwkgKiBkZWZpbmVkIGVuY2Fwc3VsYXRpb24gaGVhZGVyIHRoYXQg
dGhlIFNXIHByb3ZpZGVzLg0KKwkgKi8NCisJZS0+cmVmb3JtYXRfdHlwZSA9IE1MWDVfUkVGT1JN
QVRfVFlQRV9MMl9UT19WWExBTjsNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1s
eDVlX3R1bm5lbF9pZF90b192bmkoX19iZTY0IHR1bl9pZCwgX191OCAqdm5pKQ0KK3sNCisjaWZk
ZWYgX19CSUdfRU5ESUFODQorCXZuaVswXSA9IChfX2ZvcmNlIF9fdTgpKHR1bl9pZCA+PiAxNik7
DQorCXZuaVsxXSA9IChfX2ZvcmNlIF9fdTgpKHR1bl9pZCA+PiA4KTsNCisJdm5pWzJdID0gKF9f
Zm9yY2UgX191OCl0dW5faWQ7DQorI2Vsc2UNCisJdm5pWzBdID0gKF9fZm9yY2UgX191OCkoKF9f
Zm9yY2UgdTY0KXR1bl9pZCA+PiA0MCk7DQorCXZuaVsxXSA9IChfX2ZvcmNlIF9fdTgpKChfX2Zv
cmNlIHU2NCl0dW5faWQgPj4gNDgpOw0KKwl2bmlbMl0gPSAoX19mb3JjZSBfX3U4KSgoX19mb3Jj
ZSB1NjQpdHVuX2lkID4+IDU2KTsNCisjZW5kaWYNCit9DQorDQorc3RhdGljIGludCBtbHg1ZV9n
ZW5faXBfdHVubmVsX2hlYWRlcl9nZW5ldmUoY2hhciBidWZbXSwNCisJCQkJCSAgICAgX191OCAq
aXBfcHJvdG8sDQorCQkJCQkgICAgIHN0cnVjdCBtbHg1ZV9lbmNhcF9lbnRyeSAqZSkNCit7DQor
CWNvbnN0IHN0cnVjdCBpcF90dW5uZWxfaW5mbyAqdHVuX2luZm8gPSBlLT50dW5faW5mbzsNCisJ
c3RydWN0IHVkcGhkciAqdWRwID0gKHN0cnVjdCB1ZHBoZHIgKikoYnVmKTsNCisJc3RydWN0IGdl
bmV2ZWhkciAqZ2VuZXZlaDsNCisNCisJZ2VuZXZlaCA9IChzdHJ1Y3QgZ2VuZXZlaGRyICopKChj
aGFyICopdWRwICsgc2l6ZW9mKHN0cnVjdCB1ZHBoZHIpKTsNCisNCisJKmlwX3Byb3RvID0gSVBQ
Uk9UT19VRFA7DQorDQorCXVkcC0+ZGVzdCA9IHR1bl9pbmZvLT5rZXkudHBfZHN0Ow0KKw0KKwlt
ZW1zZXQoZ2VuZXZlaCwgMCwgc2l6ZW9mKCpnZW5ldmVoKSk7DQorCWdlbmV2ZWgtPnZlciA9IE1M
WDVFX0dFTkVWRV9WRVI7DQorCWdlbmV2ZWgtPm9wdF9sZW4gPSB0dW5faW5mby0+b3B0aW9uc19s
ZW4gLyA0Ow0KKwlnZW5ldmVoLT5vYW0gPSAhISh0dW5faW5mby0+a2V5LnR1bl9mbGFncyAmIFRV
Tk5FTF9PQU0pOw0KKwlnZW5ldmVoLT5jcml0aWNhbCA9ICEhKHR1bl9pbmZvLT5rZXkudHVuX2Zs
YWdzICYgVFVOTkVMX0NSSVRfT1BUKTsNCisJbWx4NWVfdHVubmVsX2lkX3RvX3ZuaSh0dW5faW5m
by0+a2V5LnR1bl9pZCwgZ2VuZXZlaC0+dm5pKTsNCisJZ2VuZXZlaC0+cHJvdG9fdHlwZSA9IGh0
b25zKEVUSF9QX1RFQik7DQorDQorCWlmICh0dW5faW5mby0+a2V5LnR1bl9mbGFncyAmIFRVTk5F
TF9HRU5FVkVfT1BUKSB7DQorCQlpZiAoIWdlbmV2ZWgtPm9wdF9sZW4pDQorCQkJcmV0dXJuIC1F
T1BOT1RTVVBQOw0KKwkJaXBfdHVubmVsX2luZm9fb3B0c19nZXQoZ2VuZXZlaC0+b3B0aW9ucywg
dHVuX2luZm8pOw0KKwl9DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IG1seDVl
X3RjX3R1bl9wYXJzZV9nZW5ldmVfdm5pKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCQkJ
IHN0cnVjdCBtbHg1X2Zsb3dfc3BlYyAqc3BlYywNCisJCQkJCSBzdHJ1Y3QgdGNfY2xzX2Zsb3dl
cl9vZmZsb2FkICpmKQ0KK3sNCisJc3RydWN0IGZsb3dfcnVsZSAqcnVsZSA9IHRjX2Nsc19mbG93
ZXJfb2ZmbG9hZF9mbG93X3J1bGUoZik7DQorCXN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFj
ayA9IGYtPmNvbW1vbi5leHRhY2s7DQorCXN0cnVjdCBmbG93X21hdGNoX2VuY19rZXlpZCBlbmNf
a2V5aWQ7DQorCXZvaWQgKm1pc2NfYywgKm1pc2NfdjsNCisNCisJbWlzY19jID0gTUxYNV9BRERS
X09GKGZ0ZV9tYXRjaF9wYXJhbSwgc3BlYy0+bWF0Y2hfY3JpdGVyaWEsIG1pc2NfcGFyYW1ldGVy
cyk7DQorCW1pc2NfdiA9IE1MWDVfQUREUl9PRihmdGVfbWF0Y2hfcGFyYW0sIHNwZWMtPm1hdGNo
X3ZhbHVlLCBtaXNjX3BhcmFtZXRlcnMpOw0KKw0KKwlpZiAoIWZsb3dfcnVsZV9tYXRjaF9rZXko
cnVsZSwgRkxPV19ESVNTRUNUT1JfS0VZX0VOQ19LRVlJRCkpDQorCQlyZXR1cm4gMDsNCisNCisJ
Zmxvd19ydWxlX21hdGNoX2VuY19rZXlpZChydWxlLCAmZW5jX2tleWlkKTsNCisNCisJaWYgKCFl
bmNfa2V5aWQubWFzay0+a2V5aWQpDQorCQlyZXR1cm4gMDsNCisNCisJaWYgKCFNTFg1X0NBUF9F
U1dfRkxPV1RBQkxFX0ZEQihwcml2LT5tZGV2LCBmdF9maWVsZF9zdXBwb3J0Lm91dGVyX2dlbmV2
ZV92bmkpKSB7DQorCQlOTF9TRVRfRVJSX01TR19NT0QoZXh0YWNrLCAiTWF0Y2hpbmcgb24gR0VO
RVZFIFZOSSBpcyBub3Qgc3VwcG9ydGVkIik7DQorCQluZXRkZXZfd2Fybihwcml2LT5uZXRkZXYs
ICJNYXRjaGluZyBvbiBHRU5FVkUgVk5JIGlzIG5vdCBzdXBwb3J0ZWRcbiIpOw0KKwkJcmV0dXJu
IC1FT1BOT1RTVVBQOw0KKwl9DQorDQorCU1MWDVfU0VUKGZ0ZV9tYXRjaF9zZXRfbWlzYywgbWlz
Y19jLCBnZW5ldmVfdm5pLCBiZTMyX3RvX2NwdShlbmNfa2V5aWQubWFzay0+a2V5aWQpKTsNCisJ
TUxYNV9TRVQoZnRlX21hdGNoX3NldF9taXNjLCBtaXNjX3YsIGdlbmV2ZV92bmksIGJlMzJfdG9f
Y3B1KGVuY19rZXlpZC5rZXktPmtleWlkKSk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0
aWMgaW50IG1seDVlX3RjX3R1bl9wYXJzZV9nZW5ldmVfb3B0aW9ucyhzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdiwNCisJCQkJCSAgICAgc3RydWN0IG1seDVfZmxvd19zcGVjICpzcGVjLA0KKwkJCQkJ
ICAgICBzdHJ1Y3QgdGNfY2xzX2Zsb3dlcl9vZmZsb2FkICpmKQ0KK3sNCisJdTggbWF4X3Rsdl9v
cHRpb25fZGF0YV9sZW4gPSBNTFg1X0NBUF9HRU4ocHJpdi0+bWRldiwgbWF4X2dlbmV2ZV90bHZf
b3B0aW9uX2RhdGFfbGVuKTsNCisJdTggbWF4X3Rsdl9vcHRpb25zID0gTUxYNV9DQVBfR0VOKHBy
aXYtPm1kZXYsIG1heF9nZW5ldmVfdGx2X29wdGlvbnMpOw0KKwlzdHJ1Y3QgZmxvd19ydWxlICpy
dWxlID0gdGNfY2xzX2Zsb3dlcl9vZmZsb2FkX2Zsb3dfcnVsZShmKTsNCisJc3RydWN0IG5ldGxp
bmtfZXh0X2FjayAqZXh0YWNrID0gZi0+Y29tbW9uLmV4dGFjazsNCisJdm9pZCAqbWlzY19jLCAq
bWlzY192LCAqbWlzY18zX2MsICptaXNjXzNfdjsNCisJc3RydWN0IGdlbmV2ZV9vcHQgKm9wdGlv
bl9rZXksICpvcHRpb25fbWFzazsNCisJX19iZTMyIG9wdF9kYXRhX2tleSA9IDAsIG9wdF9kYXRh
X21hc2sgPSAwOw0KKwlzdHJ1Y3QgZmxvd19tYXRjaF9lbmNfb3B0cyBlbmNfb3B0czsNCisJaW50
IHJlcyA9IDA7DQorDQorCW1pc2NfYyA9IE1MWDVfQUREUl9PRihmdGVfbWF0Y2hfcGFyYW0sIHNw
ZWMtPm1hdGNoX2NyaXRlcmlhLCBtaXNjX3BhcmFtZXRlcnMpOw0KKwltaXNjX3YgPSBNTFg1X0FE
RFJfT0YoZnRlX21hdGNoX3BhcmFtLCBzcGVjLT5tYXRjaF92YWx1ZSwgbWlzY19wYXJhbWV0ZXJz
KTsNCisJbWlzY18zX2MgPSBNTFg1X0FERFJfT0YoZnRlX21hdGNoX3BhcmFtLCBzcGVjLT5tYXRj
aF9jcml0ZXJpYSwgbWlzY19wYXJhbWV0ZXJzXzMpOw0KKwltaXNjXzNfdiA9IE1MWDVfQUREUl9P
RihmdGVfbWF0Y2hfcGFyYW0sIHNwZWMtPm1hdGNoX3ZhbHVlLCBtaXNjX3BhcmFtZXRlcnNfMyk7
DQorDQorCWlmICghZmxvd19ydWxlX21hdGNoX2tleShydWxlLCBGTE9XX0RJU1NFQ1RPUl9LRVlf
RU5DX09QVFMpKQ0KKwkJcmV0dXJuIDA7DQorDQorCWZsb3dfcnVsZV9tYXRjaF9lbmNfb3B0cyhy
dWxlLCAmZW5jX29wdHMpOw0KKw0KKwlpZiAobWVtY2hyX2ludigmZW5jX29wdHMubWFzay0+ZGF0
YSwgMCwgc2l6ZW9mKGVuY19vcHRzLm1hc2stPmRhdGEpKSAmJg0KKwkgICAgIU1MWDVfQ0FQX0VT
V19GTE9XVEFCTEVfRkRCKHByaXYtPm1kZXYsDQorCQkJCQlmdF9maWVsZF9zdXBwb3J0LmdlbmV2
ZV90bHZfb3B0aW9uXzBfZGF0YSkpIHsNCisJCU5MX1NFVF9FUlJfTVNHX01PRChleHRhY2ssDQor
CQkJCSAgICJNYXRjaGluZyBvbiBHRU5FVkUgb3B0aW9ucyBpcyBub3Qgc3VwcG9ydGVkIik7DQor
CQluZXRkZXZfd2Fybihwcml2LT5uZXRkZXYsDQorCQkJICAgICJNYXRjaGluZyBvbiBHRU5FVkUg
b3B0aW9ucyBpcyBub3Qgc3VwcG9ydGVkXG4iKTsNCisJCXJldHVybiAtRU9QTk9UU1VQUDsNCisJ
fQ0KKw0KKwkvKiBtYWtlIHN1cmUgdGhhdCB3ZSdyZSB0YWxraW5nIGFib3V0IEdFTkVWRSBvcHRp
b25zICovDQorDQorCWlmIChlbmNfb3B0cy5rZXktPmRzdF9vcHRfdHlwZSAhPSBUVU5ORUxfR0VO
RVZFX09QVCkgew0KKwkJTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywNCisJCQkJICAgIk1hdGNo
aW5nIG9uIEdFTkVWRSBvcHRpb25zOiBvcHRpb24gdHlwZSBpcyBub3QgR0VORVZFIik7DQorCQlu
ZXRkZXZfd2Fybihwcml2LT5uZXRkZXYsDQorCQkJICAgICJNYXRjaGluZyBvbiBHRU5FVkUgb3B0
aW9uczogb3B0aW9uIHR5cGUgaXMgbm90IEdFTkVWRVxuIik7DQorCQlyZXR1cm4gLUVPUE5PVFNV
UFA7DQorCX0NCisNCisJaWYgKGVuY19vcHRzLm1hc2stPmxlbiAmJg0KKwkgICAgIU1MWDVfQ0FQ
X0VTV19GTE9XVEFCTEVfRkRCKHByaXYtPm1kZXYsDQorCQkJCQlmdF9maWVsZF9zdXBwb3J0Lm91
dGVyX2dlbmV2ZV9vcHRfbGVuKSkgew0KKwkJTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywgIk1h
dGNoaW5nIG9uIEdFTkVWRSBvcHRpb25zIGxlbiBpcyBub3Qgc3VwcG9ydGVkIik7DQorCQluZXRk
ZXZfd2Fybihwcml2LT5uZXRkZXYsDQorCQkJICAgICJNYXRjaGluZyBvbiBHRU5FVkUgb3B0aW9u
cyBsZW4gaXMgbm90IHN1cHBvcnRlZFxuIik7DQorCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQorCX0N
CisNCisJLyogbWF4X2dlbmV2ZV90bHZfb3B0aW9uX2RhdGFfbGVuIGNvbWVzIGluIG11bHRpcGxl
cyBvZiA0IGJ5dGVzLCBhbmQgaXQNCisJICogZG9lc24ndCBpbmNsdWRlIHRoZSBUTFYgb3B0aW9u
IGhlYWRlci4gJ2dlbmV2ZV9vcHRfbGVuJyBpcyBhIHRvdGFsDQorCSAqIGxlbiBvZiBhbGwgdGhl
IG9wdGlvbnMsIGluY2x1ZGluZyB0aGUgaGVhZGVycywgYWxzbyBtdWx0aXBsZXMgb2YgNA0KKwkg
KiBieXRlcy4gTGVuIHRoYXQgY29tZXMgZnJvbSB0aGUgZGlzc2VjdG9yIGlzIGluIGJ5dGVzLg0K
KwkgKi8NCisNCisJaWYgKChlbmNfb3B0cy5rZXktPmxlbiAvIDQpID4gKChtYXhfdGx2X29wdGlv
bl9kYXRhX2xlbiArIDEpICogbWF4X3Rsdl9vcHRpb25zKSkgew0KKwkJTkxfU0VUX0VSUl9NU0df
TU9EKGV4dGFjaywNCisJCQkJICAgIk1hdGNoaW5nIG9uIEdFTkVWRSBvcHRpb25zOiB1bnN1cHBv
cnRlZCBvcHRpb25zIGxlbiIpOw0KKwkJbmV0ZGV2X3dhcm4ocHJpdi0+bmV0ZGV2LA0KKwkJCSAg
ICAiTWF0Y2hpbmcgb24gR0VORVZFIG9wdGlvbnM6IHVuc3VwcG9ydGVkIG9wdGlvbnMgbGVuIChs
ZW49JWQpXG4iLA0KKwkJCSAgICBlbmNfb3B0cy5rZXktPmxlbik7DQorCQlyZXR1cm4gLUVPUE5P
VFNVUFA7DQorCX0NCisNCisJTUxYNV9TRVQoZnRlX21hdGNoX3NldF9taXNjLCBtaXNjX2MsIGdl
bmV2ZV9vcHRfbGVuLCBlbmNfb3B0cy5tYXNrLT5sZW4gLyA0KTsNCisJTUxYNV9TRVQoZnRlX21h
dGNoX3NldF9taXNjLCBtaXNjX3YsIGdlbmV2ZV9vcHRfbGVuLCBlbmNfb3B0cy5rZXktPmxlbiAv
IDQpOw0KKw0KKwkvKiB3ZSBzdXBwb3J0IG1hdGNoaW5nIG9uIG9uZSBvcHRpb24gb25seSwgc28g
anVzdCBnZXQgaXQgKi8NCisJb3B0aW9uX2tleSA9IChzdHJ1Y3QgZ2VuZXZlX29wdCAqKSZlbmNf
b3B0cy5rZXktPmRhdGFbMF07DQorCW9wdGlvbl9tYXNrID0gKHN0cnVjdCBnZW5ldmVfb3B0ICop
JmVuY19vcHRzLm1hc2stPmRhdGFbMF07DQorDQorCWlmIChvcHRpb25fa2V5LT5sZW5ndGggPiBt
YXhfdGx2X29wdGlvbl9kYXRhX2xlbikgew0KKwkJTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywN
CisJCQkJICAgIk1hdGNoaW5nIG9uIEdFTkVWRSBvcHRpb25zOiB1bnN1cHBvcnRlZCBvcHRpb24g
bGVuIik7DQorCQluZXRkZXZfd2Fybihwcml2LT5uZXRkZXYsDQorCQkJICAgICJNYXRjaGluZyBv
biBHRU5FVkUgb3B0aW9uczogdW5zdXBwb3J0ZWQgb3B0aW9uIGxlbiAoa2V5PSVkLCBtYXNrPSVk
KVxuIiwNCisJCQkgICAgb3B0aW9uX2tleS0+bGVuZ3RoLCBvcHRpb25fbWFzay0+bGVuZ3RoKTsN
CisJCXJldHVybiAtRU9QTk9UU1VQUDsNCisJfQ0KKw0KKwkvKiBkYXRhIGNhbid0IGJlIGFsbCAw
IC0gZmFpbCB0byBvZmZsb2FkIHN1Y2ggcnVsZSAqLw0KKwlpZiAoIW1lbWNocl9pbnYob3B0aW9u
X2tleS0+b3B0X2RhdGEsIDAsIG9wdGlvbl9rZXktPmxlbmd0aCAqIDQpKSB7DQorCQlOTF9TRVRf
RVJSX01TR19NT0QoZXh0YWNrLA0KKwkJCQkgICAiTWF0Y2hpbmcgb24gR0VORVZFIG9wdGlvbnM6
IGNhbid0IG1hdGNoIG9uIDAgZGF0YSBmaWVsZCIpOw0KKwkJbmV0ZGV2X3dhcm4ocHJpdi0+bmV0
ZGV2LA0KKwkJCSAgICAiTWF0Y2hpbmcgb24gR0VORVZFIG9wdGlvbnM6IGNhbid0IG1hdGNoIG9u
IDAgZGF0YSBmaWVsZFxuIik7DQorCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQorCX0NCisNCisJLyog
YWRkIG5ldyBHRU5FVkUgVExWIG9wdGlvbnMgb2JqZWN0ICovDQorCXJlcyA9IG1seDVfZ2VuZXZl
X3Rsdl9vcHRpb25fYWRkKHByaXYtPm1kZXYtPmdlbmV2ZSwgb3B0aW9uX2tleSk7DQorCWlmIChy
ZXMpIHsNCisJCU5MX1NFVF9FUlJfTVNHX01PRChleHRhY2ssDQorCQkJCSAgICJNYXRjaGluZyBv
biBHRU5FVkUgb3B0aW9uczogZmFpbGVkIGNyZWF0aW5nIFRMViBvcHQgb2JqZWN0Iik7DQorCQlu
ZXRkZXZfd2Fybihwcml2LT5uZXRkZXYsDQorCQkJICAgICJNYXRjaGluZyBvbiBHRU5FVkUgb3B0
aW9uczogZmFpbGVkIGNyZWF0aW5nIFRMViBvcHQgb2JqZWN0IChjbGFzczp0eXBlOmxlbiA9IDB4
JXg6MHgleDolZClcbiIsDQorCQkJICAgIGJlMTZfdG9fY3B1KG9wdGlvbl9rZXktPm9wdF9jbGFz
cyksDQorCQkJICAgIG9wdGlvbl9rZXktPnR5cGUsIG9wdGlvbl9rZXktPmxlbmd0aCk7DQorCQly
ZXR1cm4gcmVzOw0KKwl9DQorDQorCS8qIEluIGdlbmVyYWwsIGFmdGVyIGNyZWF0aW5nIHRoZSBv
YmplY3QsIG5lZWQgdG8gcXVlcnkgaXQNCisJICogaW4gb3JkZXIgdG8gY2hlY2sgd2hpY2ggb3B0
aW9uIGRhdGEgdG8gc2V0IGluIG1pc2MzLg0KKwkgKiBCdXQgd2Ugc3VwcG9ydCBvbmx5IGdlbmV2
ZV90bHZfb3B0aW9uXzBfZGF0YSwgc28gbm8NCisJICogcG9pbnQgcXVlcnlpbmcgYXQgdGhpcyBz
dGFnZS4NCisJICovDQorDQorCW1lbWNweSgmb3B0X2RhdGFfa2V5LCBvcHRpb25fa2V5LT5vcHRf
ZGF0YSwgb3B0aW9uX2tleS0+bGVuZ3RoICogNCk7DQorCW1lbWNweSgmb3B0X2RhdGFfbWFzaywg
b3B0aW9uX21hc2stPm9wdF9kYXRhLCBvcHRpb25fbWFzay0+bGVuZ3RoICogNCk7DQorCU1MWDVf
U0VUKGZ0ZV9tYXRjaF9zZXRfbWlzYzMsIG1pc2NfM192LA0KKwkJIGdlbmV2ZV90bHZfb3B0aW9u
XzBfZGF0YSwgYmUzMl90b19jcHUob3B0X2RhdGFfa2V5KSk7DQorCU1MWDVfU0VUKGZ0ZV9tYXRj
aF9zZXRfbWlzYzMsIG1pc2NfM19jLA0KKwkJIGdlbmV2ZV90bHZfb3B0aW9uXzBfZGF0YSwgYmUz
Ml90b19jcHUob3B0X2RhdGFfbWFzaykpOw0KKw0KKwlzcGVjLT5tYXRjaF9jcml0ZXJpYV9lbmFi
bGUgfD0gTUxYNV9NQVRDSF9NSVNDX1BBUkFNRVRFUlNfMzsNCisNCisJcmV0dXJuIDA7DQorfQ0K
Kw0KK3N0YXRpYyBpbnQgbWx4NWVfdGNfdHVuX3BhcnNlX2dlbmV2ZV9wYXJhbXMoc3RydWN0IG1s
eDVlX3ByaXYgKnByaXYsDQorCQkJCQkgICAgc3RydWN0IG1seDVfZmxvd19zcGVjICpzcGVjLA0K
KwkJCQkJICAgIHN0cnVjdCB0Y19jbHNfZmxvd2VyX29mZmxvYWQgKmYpDQorew0KKwl2b2lkICpt
aXNjX2MgPSBNTFg1X0FERFJfT0YoZnRlX21hdGNoX3BhcmFtLCBzcGVjLT5tYXRjaF9jcml0ZXJp
YSwgbWlzY19wYXJhbWV0ZXJzKTsNCisJdm9pZCAqbWlzY192ID0gTUxYNV9BRERSX09GKGZ0ZV9t
YXRjaF9wYXJhbSwgc3BlYy0+bWF0Y2hfdmFsdWUsICBtaXNjX3BhcmFtZXRlcnMpOw0KKwlzdHJ1
Y3QgbmV0bGlua19leHRfYWNrICpleHRhY2sgPSBmLT5jb21tb24uZXh0YWNrOw0KKw0KKwkvKiBt
YXRjaCBvbiBPQU0gLSBwYWNrZXRzIHdpdGggT0FNIGJpdCBvbiBzaG91bGQgTk9UIGJlIG9mZmxv
YWRlZCAqLw0KKw0KKwlpZiAoIU1MWDVfQ0FQX0VTV19GTE9XVEFCTEVfRkRCKHByaXYtPm1kZXYs
IGZ0X2ZpZWxkX3N1cHBvcnQub3V0ZXJfZ2VuZXZlX29hbSkpIHsNCisJCU5MX1NFVF9FUlJfTVNH
X01PRChleHRhY2ssICJNYXRjaGluZyBvbiBHRU5FVkUgT0FNIGlzIG5vdCBzdXBwb3J0ZWQiKTsN
CisJCW5ldGRldl93YXJuKHByaXYtPm5ldGRldiwgIk1hdGNoaW5nIG9uIEdFTkVWRSBPQU0gaXMg
bm90IHN1cHBvcnRlZFxuIik7DQorCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQorCX0NCisJTUxYNV9T
RVRfVE9fT05FUyhmdGVfbWF0Y2hfc2V0X21pc2MsIG1pc2NfYywgZ2VuZXZlX29hbSk7DQorCU1M
WDVfU0VUKGZ0ZV9tYXRjaF9zZXRfbWlzYywgbWlzY192LCBnZW5ldmVfb2FtLCAwKTsNCisNCisJ
LyogTWF0Y2ggb24gR0VORVZFIHByb3RvY29sLiBXZSBzdXBwb3J0IG9ubHkgVHJhbnNwYXJlbnQg
RXRoIEJyaWRnZS4gKi8NCisNCisJaWYgKE1MWDVfQ0FQX0VTV19GTE9XVEFCTEVfRkRCKHByaXYt
Pm1kZXYsDQorCQkJCSAgICAgICBmdF9maWVsZF9zdXBwb3J0Lm91dGVyX2dlbmV2ZV9wcm90b2Nv
bF90eXBlKSkgew0KKwkJTUxYNV9TRVRfVE9fT05FUyhmdGVfbWF0Y2hfc2V0X21pc2MsIG1pc2Nf
YywgZ2VuZXZlX3Byb3RvY29sX3R5cGUpOw0KKwkJTUxYNV9TRVQoZnRlX21hdGNoX3NldF9taXNj
LCBtaXNjX3YsIGdlbmV2ZV9wcm90b2NvbF90eXBlLCBFVEhfUF9URUIpOw0KKwl9DQorDQorCXJl
dHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IG1seDVlX3RjX3R1bl9wYXJzZV9nZW5ldmUoc3Ry
dWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJCSAgICAgc3RydWN0IG1seDVfZmxvd19zcGVjICpz
cGVjLA0KKwkJCQkgICAgIHN0cnVjdCB0Y19jbHNfZmxvd2VyX29mZmxvYWQgKmYsDQorCQkJCSAg
ICAgdm9pZCAqaGVhZGVyc19jLA0KKwkJCQkgICAgIHZvaWQgKmhlYWRlcnNfdikNCit7DQorCWlu
dCBlcnI7DQorDQorCWVyciA9IG1seDVlX3RjX3R1bl9wYXJzZV9nZW5ldmVfcGFyYW1zKHByaXYs
IHNwZWMsIGYpOw0KKwlpZiAoZXJyKQ0KKwkJcmV0dXJuIGVycjsNCisNCisJZXJyID0gbWx4NWVf
dGNfdHVuX3BhcnNlX2dlbmV2ZV92bmkocHJpdiwgc3BlYywgZik7DQorCWlmIChlcnIpDQorCQly
ZXR1cm4gZXJyOw0KKw0KKwlyZXR1cm4gbWx4NWVfdGNfdHVuX3BhcnNlX2dlbmV2ZV9vcHRpb25z
KHByaXYsIHNwZWMsIGYpOw0KK30NCisNCitzdHJ1Y3QgbWx4NWVfdGNfdHVubmVsIGdlbmV2ZV90
dW5uZWwgPSB7DQorCS50dW5uZWxfdHlwZSAgICAgICAgICA9IE1MWDVFX1RDX1RVTk5FTF9UWVBF
X0dFTkVWRSwNCisJLm1hdGNoX2xldmVsICAgICAgICAgID0gTUxYNV9NQVRDSF9MNCwNCisJLmNh
bl9vZmZsb2FkICAgICAgICAgID0gbWx4NWVfdGNfdHVuX2Nhbl9vZmZsb2FkX2dlbmV2ZSwNCisJ
LmNhbGNfaGxlbiAgICAgICAgICAgID0gbWx4NWVfdGNfdHVuX2NhbGNfaGxlbl9nZW5ldmUsDQor
CS5pbml0X2VuY2FwX2F0dHIgICAgICA9IG1seDVlX3RjX3R1bl9pbml0X2VuY2FwX2F0dHJfZ2Vu
ZXZlLA0KKwkuZ2VuZXJhdGVfaXBfdHVuX2hkciAgPSBtbHg1ZV9nZW5faXBfdHVubmVsX2hlYWRl
cl9nZW5ldmUsDQorCS5wYXJzZV91ZHBfcG9ydHMgICAgICA9IG1seDVlX3RjX3R1bl9wYXJzZV91
ZHBfcG9ydHNfZ2VuZXZlLA0KKwkucGFyc2VfdHVubmVsICAgICAgICAgPSBtbHg1ZV90Y190dW5f
cGFyc2VfZ2VuZXZlLA0KK307DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL2VuX3RjLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9t
bHg1L2NvcmUvZW5fdGMuYw0KaW5kZXggOTE1ZjBhYmMyMWUyLi4xNTFlNTVjOGMxY2EgMTAwNjQ0
DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fdGMuYw0K
KysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3RjLmMNCkBA
IC01Myw2ICs1Myw3IEBADQogI2luY2x1ZGUgImVuL3BvcnQuaCINCiAjaW5jbHVkZSAiZW4vdGNf
dHVuLmgiDQogI2luY2x1ZGUgImxpYi9kZXZjb20uaCINCisjaW5jbHVkZSAibGliL2dlbmV2ZS5o
Ig0KIA0KIHN0cnVjdCBtbHg1X25pY19mbG93X2F0dHIgew0KIAl1MzIgYWN0aW9uOw0KQEAgLTEw
NjMsNiArMTA2NCwxOSBAQCBtbHg1ZV90Y19hZGRfZmRiX2Zsb3coc3RydWN0IG1seDVlX3ByaXYg
KnByaXYsDQogCXJldHVybiBlcnI7DQogfQ0KIA0KK3N0YXRpYyBib29sIG1seDVfZmxvd19oYXNf
Z2VuZXZlX29wdChzdHJ1Y3QgbWx4NWVfdGNfZmxvdyAqZmxvdykNCit7DQorCXN0cnVjdCBtbHg1
X2Zsb3dfc3BlYyAqc3BlYyA9ICZmbG93LT5lc3dfYXR0ci0+cGFyc2VfYXR0ci0+c3BlYzsNCisJ
dm9pZCAqaGVhZGVyc192ID0gTUxYNV9BRERSX09GKGZ0ZV9tYXRjaF9wYXJhbSwNCisJCQkJICAg
ICAgIHNwZWMtPm1hdGNoX3ZhbHVlLA0KKwkJCQkgICAgICAgbWlzY19wYXJhbWV0ZXJzXzMpOw0K
Kwl1MzIgZ2VuZXZlX3Rsdl9vcHRfMF9kYXRhID0gTUxYNV9HRVQoZnRlX21hdGNoX3NldF9taXNj
MywNCisJCQkJCSAgICAgaGVhZGVyc192LA0KKwkJCQkJICAgICBnZW5ldmVfdGx2X29wdGlvbl8w
X2RhdGEpOw0KKw0KKwlyZXR1cm4gISFnZW5ldmVfdGx2X29wdF8wX2RhdGE7DQorfQ0KKw0KIHN0
YXRpYyB2b2lkIG1seDVlX3RjX2RlbF9mZGJfZmxvdyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwN
CiAJCQkJICBzdHJ1Y3QgbWx4NWVfdGNfZmxvdyAqZmxvdykNCiB7DQpAQCAtMTA4NCw2ICsxMDk4
LDkgQEAgc3RhdGljIHZvaWQgbWx4NWVfdGNfZGVsX2ZkYl9mbG93KHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2LA0KIAkJCW1seDVlX3RjX3Vub2ZmbG9hZF9mZGJfcnVsZXMoZXN3LCBmbG93LCBhdHRy
KTsNCiAJfQ0KIA0KKwlpZiAobWx4NV9mbG93X2hhc19nZW5ldmVfb3B0KGZsb3cpKQ0KKwkJbWx4
NV9nZW5ldmVfdGx2X29wdGlvbl9kZWwocHJpdi0+bWRldi0+Z2VuZXZlKTsNCisNCiAJbWx4NV9l
c3dpdGNoX2RlbF92bGFuX2FjdGlvbihlc3csIGF0dHIpOw0KIA0KIAlmb3IgKG91dF9pbmRleCA9
IDA7IG91dF9pbmRleCA8IE1MWDVfTUFYX0ZMT1dfRldEX1ZQT1JUUzsgb3V0X2luZGV4KyspDQpA
QCAtMTQ5NCw3ICsxNTExLDggQEAgc3RhdGljIGludCBfX3BhcnNlX2Nsc19mbG93ZXIoc3RydWN0
IG1seDVlX3ByaXYgKnByaXYsDQogCSAgICAgIEJJVChGTE9XX0RJU1NFQ1RPUl9LRVlfRU5DX0NP
TlRST0wpIHwNCiAJICAgICAgQklUKEZMT1dfRElTU0VDVE9SX0tFWV9UQ1ApIHwNCiAJICAgICAg
QklUKEZMT1dfRElTU0VDVE9SX0tFWV9JUCkgIHwNCi0JICAgICAgQklUKEZMT1dfRElTU0VDVE9S
X0tFWV9FTkNfSVApKSkgew0KKwkgICAgICBCSVQoRkxPV19ESVNTRUNUT1JfS0VZX0VOQ19JUCkg
fA0KKwkgICAgICBCSVQoRkxPV19ESVNTRUNUT1JfS0VZX0VOQ19PUFRTKSkpIHsNCiAJCU5MX1NF
VF9FUlJfTVNHX01PRChleHRhY2ssICJVbnN1cHBvcnRlZCBrZXkiKTsNCiAJCW5ldGRldl93YXJu
KHByaXYtPm5ldGRldiwgIlVuc3VwcG9ydGVkIGtleSB1c2VkOiAweCV4XG4iLA0KIAkJCSAgICBk
aXNzZWN0b3ItPnVzZWRfa2V5cyk7DQpAQCAtMTUwNCw3ICsxNTIyLDggQEAgc3RhdGljIGludCBf
X3BhcnNlX2Nsc19mbG93ZXIoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQogCWlmIChmbG93X3J1
bGVfbWF0Y2hfa2V5KHJ1bGUsIEZMT1dfRElTU0VDVE9SX0tFWV9FTkNfSVBWNF9BRERSUykgfHwN
CiAJICAgIGZsb3dfcnVsZV9tYXRjaF9rZXkocnVsZSwgRkxPV19ESVNTRUNUT1JfS0VZX0VOQ19J
UFY2X0FERFJTKSB8fA0KIAkgICAgZmxvd19ydWxlX21hdGNoX2tleShydWxlLCBGTE9XX0RJU1NF
Q1RPUl9LRVlfRU5DX0tFWUlEKSB8fA0KLQkgICAgZmxvd19ydWxlX21hdGNoX2tleShydWxlLCBG
TE9XX0RJU1NFQ1RPUl9LRVlfRU5DX1BPUlRTKSkgew0KKwkgICAgZmxvd19ydWxlX21hdGNoX2tl
eShydWxlLCBGTE9XX0RJU1NFQ1RPUl9LRVlfRU5DX1BPUlRTKSB8fA0KKwkgICAgZmxvd19ydWxl
X21hdGNoX2tleShydWxlLCBGTE9XX0RJU1NFQ1RPUl9LRVlfRU5DX09QVFMpKSB7DQogCQlpZiAo
cGFyc2VfdHVubmVsX2F0dHIocHJpdiwgc3BlYywgZiwgZmlsdGVyX2RldiwgdHVubmVsX21hdGNo
X2xldmVsKSkNCiAJCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQogDQotLSANCjIuMjEuMA0KDQo=
