Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 8B62E47807D
	for <lists+netdev@lfdr.de>; Fri, 17 Dec 2021 00:22:45 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S237275AbhLPXWj (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Thu, 16 Dec 2021 18:22:39 -0500
Received: from mail-eopbgr60136.outbound.protection.outlook.com ([40.107.6.136]:46664
        "EHLO EUR04-DB3-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S234193AbhLPXWi (ORCPT <rfc822;netdev@vger.kernel.org>);
        Thu, 16 Dec 2021 18:22:38 -0500
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=oHYLEchT6tX+T1/5mYbdWy2uoFBzjPwbAXfWcNPaBoa5Lx83QjRL5w8Q2jEt4RaK4MfKD3O6K0K0RQH2ckZxom5FMuRIu53gTiBEvb63MtHigX5ebB3aoOJC1J/QVHlvRAhonFZmxUT+VbixR2endD4skLWbPTro0pcHzUp7MBjwa2OLhJ937QKZBlxuLXJcmujKBB9KewFpfCNFy+3uuMYXvqP/qkL+p9g4yiJINJaYMk/TTMLyMuu6C9rxwWXRiKS5Adc6EsoIKSoUlAvpWm3jzaJIJ2solKo5ovDMahDituTUqFC4Tkk4JFLdCxqk9bqk/rBuJtUfrOEVSGrgZQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=8dkOPuCMCxMQz1urLmjWwVp2lwdJdY/Gm/oOiHLEMnY=;
 b=UjyK4AOc+VTvescdGcfyKhv1WKhPX66K/zl61Fmi7rnaItOdDUVH6qTGMqB9sLMplX6v9Ol/PjkmZ/EN1BWbYy5pdBzQtCtn3p7to/3D+41z1QvG4wpYElz7mnE7uyzoFpyd96BzJ/vszZ0AA6H+iNuMTnsC3JVCGtISGA+p2JnBLa7WK1edMCBoeDnNyNeGS/EDLoZ+7yxIdMQBLnDHydMy6cwY6GZRp3ulC0l1JyV/UTLkax36mluH+R0t7n/j87x7bSZuiflnV8WH/hkWvVKg0Heleqsmc3V4adEljYbUp8yBpZOf2VimBHem2xqbZyuCZkVNjdmlqB6m4aLVlw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=bang-olufsen.dk; dmarc=pass action=none
 header.from=bang-olufsen.dk; dkim=pass header.d=bang-olufsen.dk; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=bang-olufsen.dk;
 s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=8dkOPuCMCxMQz1urLmjWwVp2lwdJdY/Gm/oOiHLEMnY=;
 b=sKpMhGr6BIutrLerNDTKjV+vjR5spmWmfXAX6wB7BJB8aoUnDi+P1mMGSEXLBC3No3TZzQUV8msOoxmRUUIWk7zmZEc2QtYbeLdGs/gANZSwYphgJ1K9fkbvITGVltVGW2NX1UrIepuMSxbIjDr3jR7xuGS4el5q2T2QsvLjmJA=
Received: from AM6PR03MB3943.eurprd03.prod.outlook.com (2603:10a6:20b:26::24)
 by AM6PR03MB4919.eurprd03.prod.outlook.com (2603:10a6:20b:85::32) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4801.14; Thu, 16 Dec
 2021 23:22:33 +0000
Received: from AM6PR03MB3943.eurprd03.prod.outlook.com
 ([fe80::9d54:99ff:d6f4:9c63]) by AM6PR03MB3943.eurprd03.prod.outlook.com
 ([fe80::9d54:99ff:d6f4:9c63%3]) with mapi id 15.20.4778.018; Thu, 16 Dec 2021
 23:22:33 +0000
From:   =?utf-8?B?QWx2aW4gxaBpcHJhZ2E=?= <ALSI@bang-olufsen.dk>
To:     "luizluca@gmail.com" <luizluca@gmail.com>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>
CC:     "linus.walleij@linaro.org" <linus.walleij@linaro.org>,
        "andrew@lunn.ch" <andrew@lunn.ch>,
        "vivien.didelot@gmail.com" <vivien.didelot@gmail.com>,
        "f.fainelli@gmail.com" <f.fainelli@gmail.com>,
        "olteanv@gmail.com" <olteanv@gmail.com>,
        "arinc.unal@arinc9.com" <arinc.unal@arinc9.com>
Subject: Re: [PATCH net-next 03/13] net: dsa: realtek: rename realtek_smi to
 realtek_priv
Thread-Topic: [PATCH net-next 03/13] net: dsa: realtek: rename realtek_smi to
 realtek_priv
Thread-Index: AQHX8rmFSia/J++nT0WJmZ2chAlSgaw1wieA
Date:   Thu, 16 Dec 2021 23:22:33 +0000
Message-ID: <4a95c493-5ea3-5f2d-b57a-70674b10a7f0@bang-olufsen.dk>
References: <20211216201342.25587-1-luizluca@gmail.com>
 <20211216201342.25587-4-luizluca@gmail.com>
In-Reply-To: <20211216201342.25587-4-luizluca@gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101
 Thunderbird/91.4.0
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=bang-olufsen.dk;
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 2650d506-6c6a-4017-d50e-08d9c0eaf06f
x-ms-traffictypediagnostic: AM6PR03MB4919:EE_
x-microsoft-antispam-prvs: <AM6PR03MB4919FA0F1F44324F5C442B2983779@AM6PR03MB4919.eurprd03.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:154;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: Hgd1qXUWrUKMTLNlRgYLnuPvYROf9l5inQANkWL6Lmkdhj/1eJEUusx5Y+m7KISRAoUoFlH2poDbKOSnVdBVK5WZZT6XxmN3+nEvYj2dMcjOU2V8oxFD+OPeMI+NP9v0aqFx6jlnD6GIr24Ade92Xe27VL3nzlT/qEAQpDEGFQpgSjXykQFVJLiExMDX7gxbEaCKZsRb5114maj/iPdxciVma/Q0pXJUiIYD+V94YUiow46sTOT7A0Z95BOH7NDtJGLRfmR1PnJuEaaVGbWw7+JgdG+IquFYUOQnkWo2rOKHFilRU3KnUdvV3iOGWX5qKwxxi5V09KuxQp7d20dE2eI+1d3RxaMgPZdiQsa4o9stmAllbuAw6apxsTx4L+O4R0eY3ckgqAhT0XaAvcmp8bwD7OatASaW7LE4w59D5xMDk/It2TltniV2EzU2KoChF1vTrvU/ZKc9n2g+F0SpbaYmWrUeq52vbpW/Dolh/b75t0/ne+Jlidm+7axq8UPAAexxtIjuSeb2ldPyykSB7HmMjKGbyiowtnkxvPHke3m+zlQueoZzDA+x7+bXM6XpI4ZecnVZDMmqh79BY6hYq38sSQd5ZkF6d+TS530ePMYbkIFqZY4Ipsor4HruPksGiOt5yV6ssLTAnqi1FN/chd+RTBPDE6TTJc6qiYBWdYV8Q72m3BOf+wL64BDyzs99+ksie7YXKqM9JFINAG2KSHbFWmwF2tM1yYoOQIpHRtN2JJsMath7jhiA3c7GKsVJPxS9xO3zNFppPuRQB17guCAV/8TJcF65LCGByjp0YfI=
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:AM6PR03MB3943.eurprd03.prod.outlook.com;PTR:;CAT:NONE;SFS:(4636009)(366004)(186003)(38100700002)(54906003)(26005)(85202003)(91956017)(8976002)(76116006)(2906002)(64756008)(8936002)(6486002)(31686004)(66476007)(66556008)(66946007)(30864003)(6512007)(4326008)(71200400001)(83380400001)(66446008)(8676002)(66574015)(85182001)(6506007)(316002)(508600001)(5660300002)(31696002)(2616005)(53546011)(110136005)(122000001)(86362001)(38070700005)(36756003)(45980500001)(43740500002)(559001)(579004)(309714004);DIR:OUT;SFP:1102;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?dVM3TEpMOWlvQmIxNlVyNC9oRWdoRnVKczdOTzVOa1lYWHg0WGhmck1VRXlh?=
 =?utf-8?B?aHlZbkRlamhnODNubTBWV1NIZ3BMVXhiZWd5YTExYmFsYnlmRWZGMG0zby9F?=
 =?utf-8?B?Vm5WY0RnMWkyWGk5c3BRaFh6Tk5jeUIxZWZ1ZzZNdkNtRjlzV0RvTC96aTNB?=
 =?utf-8?B?S3JUREk2YkxsUHYzbHRtdDlVRTJoSjF0NUNZYjBaR0RaOXA5Q2VXK29ZeWpY?=
 =?utf-8?B?TmpwZWFVRytYVThGUGQ1QWxwNlBsbERWcG5Fd0ZEYVhRQzhrVVptangyT0oy?=
 =?utf-8?B?SytFVFNneXBCTVY2SHdQMEVTcWdkcWk4YUJHVDFYVDhpNEp1ODhQazBTWWll?=
 =?utf-8?B?MDZ6UGdNTTV6RUhpYUZsRlRkZDFDMGkzcnlMOENsVkdpUGhZVGdNRk5ZUzZ0?=
 =?utf-8?B?THBnRDhpUmdCWEs1Zi9iQ3J4TFJXRlJlTjViTGphNG95a200M3hBUkJtV3Ba?=
 =?utf-8?B?SS9TQjA1UGU1eVRoUG0wL0IralZqcU8yNTlXNGZvQS95V3BWRVV3ZDkyK3E4?=
 =?utf-8?B?SUQ1T1ZncDFONDhBZHJ3a1hQMWVySFlGVmgvbm5nWlJYWm5udm5keFZoVnhR?=
 =?utf-8?B?QmczKzltQ2MrMEo0aDhPYkZEeTE5U3hVa1A0bEdTcWZKYmJTLzBqVUJmejJ5?=
 =?utf-8?B?enkzVnZHTEd3N2N0V3NQUUxLQndyZ3lNaWlpUTMrZ0xmZUp2YXpFbGhvWDFq?=
 =?utf-8?B?RGtiSFl3TDNmK1c2TElTUCttbk1rcW5FVkErYmtWS0kxT0s4d0dYeDZuVEFQ?=
 =?utf-8?B?eFoxN0lQSWM2NHFuV3MrTm1GT3lwdE8xMEltUWdrdi82TVAvUVdMWTNDQTJs?=
 =?utf-8?B?eUJ3RXZWaDVKWWNuV0RyYzkzTnBWMHE5MTcwTFFLOTVEUGVYbUQ2TzNLMmJr?=
 =?utf-8?B?S3NYcUlycHVWa0xVdkxYM3plcGtNZTllYmxmZENUS2RLL1k5VFNGall2UlVP?=
 =?utf-8?B?aC9RN3ZrOGFPbkJxL3RWVnFFZXZpeCtNdW43WE84V3VMQU5iRnVkTTR3ZWpO?=
 =?utf-8?B?VE1XbGxUTzZpVHFZRnJMak9OZm9BTE1vV09OOVlMVEF0MzBlWVdmNnhab1Fr?=
 =?utf-8?B?OVJiTk44M0R2ZFUwSmhiMkJIV2JQMHJiZGlUMVVrWERwNTBFcUwwajVoQ1Rn?=
 =?utf-8?B?NVdUWEZ1NGdCa3QxZFJUMnR5RUtpMWdDMVFxVldudEdkM1k0eC8zSzdzb2Mz?=
 =?utf-8?B?Zm9lQ3hRYjNRakFkNTB6bit5UTJOeEJzd1dhTzhjb3QxaVFNWUN1NnYrSURl?=
 =?utf-8?B?M2NZZStLMC90eG41UTdkVDRmckR6dUJ5VWYzeDFxSFlUM0h0SzJMalljTThV?=
 =?utf-8?B?MFhVZXR1L1EvQTFLL3YrelNMRW41TThCMWV5YTNnWHFYQm9oeDNMUTk5NzhP?=
 =?utf-8?B?WUpsUmtNZGZUZWZZTkhRTkFxQ0R4SFFLRkdwYkkwcnM2ZGNsU2tZZ3c5MkpY?=
 =?utf-8?B?SGZBZVlqTGEwdUprd0psSFQxNVVvZWYxNTUxczlCTi9LK3M4dUtDeTkyK0ZS?=
 =?utf-8?B?SVlmQnI5bmJWRXBHYXlGQjd3RCtQMDlQSVlYUVc3UkRXNlFvZWdDL1VSYWEz?=
 =?utf-8?B?dGdBZWFkbktXMnNOTFcrTUZ2bTVKNE9teXVlZGlYeWdZTWI0Qm5NaThJelp1?=
 =?utf-8?B?eDlEMFRXejhsak4xUFAvRElYNmFGSThsNi9YRnhzZXc4cktLbFN3K21rM3Vy?=
 =?utf-8?B?UEwwUkJiNEIwSlV3cC91TkVhYWVSeUQwWi9Qei9LaUhuZTlibEgvbmVReXU5?=
 =?utf-8?B?N0ZZNG1mak1sTXEvYTlaTG04YVNJdnpFY3ZXeVFYYWVWaHVobzU0QkwwRjB4?=
 =?utf-8?B?K2hrTWRCS3VPby9pV1ZrT2ZneUpTbmdMOG5pdTRyMUZtYU5rZUduS0xyVmFO?=
 =?utf-8?B?RHhqUm9YdFpNSHQ0bFc4VXlYQUtXcmNqUFpZQkt6N3RqSE93VHp0WldubkFH?=
 =?utf-8?B?WVRXZStJd0tvLy9DVVRzSm1FTVNzeUx3UEZydGw2NG8zcVMyUFhqSVBDREQ1?=
 =?utf-8?B?MitJN1JOcDhtZ0F1OTRuR21zaW5iS3lQeDB0M01YNlJPRzN1Q2pPazFZTk9K?=
 =?utf-8?B?L1ppMHgvc29aZnYzb1BmN3NNNHp0WUF4ODJRQU5WZ1YvOGp1ejFpUjhwd00r?=
 =?utf-8?B?eStlMk1iSTByUElCZ1pyaGpWSDB6b041VElIQ0c5S3dEYktKTUt6cnc2TlNv?=
 =?utf-8?Q?0DksfOb061Urp+kLGWkRShA=3D?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <F412BA26684E0B4EBE8C3B9A533A8FB2@eurprd03.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: bang-olufsen.dk
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: AM6PR03MB3943.eurprd03.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 2650d506-6c6a-4017-d50e-08d9c0eaf06f
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Dec 2021 23:22:33.6548
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 210d08b8-83f7-470a-bc96-381193ca14a1
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: e+nJWYSAdBAX0D539LyxyOSe0VlV/3pTycCLrDYc5UvCXKRtTlPd15iPCAyoDnhjD8wYKnukqtUfCtXQWMPJEQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM6PR03MB4919
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

SGkgTHVpeiwNCg0KT24gMTIvMTYvMjEgMjE6MTMsIGx1aXpsdWNhQGdtYWlsLmNvbSB3cm90ZToN
Cj4gRnJvbTogTHVpeiBBbmdlbG8gRGFyb3MgZGUgTHVjYSA8bHVpemx1Y2FAZ21haWwuY29tPg0K
PiANCj4gSW4gcHJlcGFyYXRpb24gdG8gYWRkaW5nIG90aGVyIGludGVyZmFjZXMsIHRoZSBwcml2
YXRlIGRhdGEgc3RydWN0dXJlDQo+IHdhcyByZW5hbWVkIHRvIHByaXYuIEFsc28gdGhlIG9ubHkg
dHdvIGRpcmVjdCBjYWxscyBmcm9tIHN1YmRyaXZlcnMNCj4gdG8gcmVhbHRlay1zbWkgbGliIHdl
cmUgY29udmVydGVkIGludG8gcmVmZXJlbmNlcyBpbnNpZGUgcHJpdi4NCg0KTWF5YmUgc3BsaXQg
dGhpcyBwYXRjaCB0byBzZXBhcmF0ZSB0aGUgY2h1cm4gZnJvbSB0aGUgbW9yZSBpbnRlcmVzdGlu
ZyANCmNoYW5nZSwgd2hpY2ggSSBndWVzcyBpcyBuZWVkZWQgdG8gc3VwcG9ydCBkaWZmZXJlbnQg
YnVzIHR5cGVzIGZvciB0aGUgDQpzdWJkcml2ZXJzLg0KDQpTZWUgc29tZSBjb21tZW50cyBpbmxp
bmUgYmVsb3csIHJlbGF0ZWQgdG8gdGhhdCBsYXR0ZXIgY2hhbmdlLg0KDQo+IA0KPiBUZXN0ZWQt
Ynk6IEFyxLFuw6cgw5xOQUwgPGFyaW5jLnVuYWxAYXJpbmM5LmNvbT4NCj4gU2lnbmVkLW9mZi1i
eTogTHVpeiBBbmdlbG8gRGFyb3MgZGUgTHVjYSA8bHVpemx1Y2FAZ21haWwuY29tPg0KPiAtLS0N
Cj4gICBkcml2ZXJzL25ldC9kc2EvcmVhbHRlay9yZWFsdGVrLXNtaS1jb3JlLmMgICAgfCAzMTQg
KysrKysrKy0tLS0tLS0NCj4gICAuLi4vcmVhbHRlay97cmVhbHRlay1zbWktY29yZS5oID0+IHJl
YWx0ZWsuaH0gfCAgNzEgKystLQ0KPiAgIGRyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjVt
Yi5jICAgICAgICAgICB8IDQwMCArKysrKysrKystLS0tLS0tLS0NCj4gICBkcml2ZXJzL25ldC9k
c2EvcmVhbHRlay9ydGw4MzY2LmMgICAgICAgICAgICAgfCAxNjQgKysrLS0tLQ0KPiAgIGRyaXZl
cnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjZyYi5jICAgICAgICAgICB8IDM5MCArKysrKysrKy0t
LS0tLS0tLQ0KPiAgIDUgZmlsZXMgY2hhbmdlZCwgNjY5IGluc2VydGlvbnMoKyksIDY3MCBkZWxl
dGlvbnMoLSkNCj4gICByZW5hbWUgZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsve3JlYWx0ZWstc21p
LWNvcmUuaCA9PiByZWFsdGVrLmh9ICg1NiUpDQo+IA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9u
ZXQvZHNhL3JlYWx0ZWsvcmVhbHRlay1zbWktY29yZS5jIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0
ZWsvcmVhbHRlay1zbWktY29yZS5jDQo+IGluZGV4IGFhZTQ2YWRhOGQ4My4uMmM3OGViNWMwYmRj
IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL25ldC9kc2EvcmVhbHRlay9yZWFsdGVrLXNtaS1jb3Jl
LmMNCj4gKysrIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsvcmVhbHRlay1zbWktY29yZS5jDQo+
IEBAIC00MCwxMDUgKzQwLDEwNSBAQA0KPiAgICNpbmNsdWRlIDxsaW51eC9iaXRvcHMuaD4NCj4g
ICAjaW5jbHVkZSA8bGludXgvaWZfYnJpZGdlLmg+DQo+ICAgDQo+IC0jaW5jbHVkZSAicmVhbHRl
ay1zbWktY29yZS5oIg0KPiArI2luY2x1ZGUgInJlYWx0ZWsuaCINCj4gICANCj4gICAjZGVmaW5l
IFJFQUxURUtfU01JX0FDS19SRVRSWV9DT1VOVAkJNQ0KPiAgICNkZWZpbmUgUkVBTFRFS19TTUlf
SFdfU1RPUF9ERUxBWQkJMjUJLyogbXNlY3MgKi8NCj4gICAjZGVmaW5lIFJFQUxURUtfU01JX0hX
X1NUQVJUX0RFTEFZCQkxMDAJLyogbXNlY3MgKi8NCj4gICANCj4gLXN0YXRpYyBpbmxpbmUgdm9p
ZCByZWFsdGVrX3NtaV9jbGtfZGVsYXkoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICtzdGF0
aWMgaW5saW5lIHZvaWQgcmVhbHRla19zbWlfY2xrX2RlbGF5KHN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYpDQo+ICAgew0KPiAtCW5kZWxheShzbWktPmNsa19kZWxheSk7DQo+ICsJbmRlbGF5KHBy
aXYtPmNsa19kZWxheSk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIHZvaWQgcmVhbHRla19zbWlf
c3RhcnQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICtzdGF0aWMgdm9pZCByZWFsdGVrX3Nt
aV9zdGFydChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gICAJLyogU2V0IEdQ
SU8gcGlucyB0byBvdXRwdXQgbW9kZSwgd2l0aCBpbml0aWFsIHN0YXRlOg0KPiAgIAkgKiBTQ0sg
PSAwLCBTREEgPSAxDQo+ICAgCSAqLw0KPiAtCWdwaW9kX2RpcmVjdGlvbl9vdXRwdXQoc21pLT5t
ZGMsIDApOw0KPiAtCWdwaW9kX2RpcmVjdGlvbl9vdXRwdXQoc21pLT5tZGlvLCAxKTsNCj4gLQly
ZWFsdGVrX3NtaV9jbGtfZGVsYXkoc21pKTsNCj4gKwlncGlvZF9kaXJlY3Rpb25fb3V0cHV0KHBy
aXYtPm1kYywgMCk7DQo+ICsJZ3Bpb2RfZGlyZWN0aW9uX291dHB1dChwcml2LT5tZGlvLCAxKTsN
Cj4gKwlyZWFsdGVrX3NtaV9jbGtfZGVsYXkocHJpdik7DQo+ICAgDQo+ICAgCS8qIENMSyAxOiAw
IC0+IDEsIDEgLT4gMCAqLw0KPiAtCWdwaW9kX3NldF92YWx1ZShzbWktPm1kYywgMSk7DQo+IC0J
cmVhbHRla19zbWlfY2xrX2RlbGF5KHNtaSk7DQo+IC0JZ3Bpb2Rfc2V0X3ZhbHVlKHNtaS0+bWRj
LCAwKTsNCj4gLQlyZWFsdGVrX3NtaV9jbGtfZGVsYXkoc21pKTsNCj4gKwlncGlvZF9zZXRfdmFs
dWUocHJpdi0+bWRjLCAxKTsNCj4gKwlyZWFsdGVrX3NtaV9jbGtfZGVsYXkocHJpdik7DQo+ICsJ
Z3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1kYywgMCk7DQo+ICsJcmVhbHRla19zbWlfY2xrX2RlbGF5
KHByaXYpOw0KPiAgIA0KPiAgIAkvKiBDTEsgMjogKi8NCj4gLQlncGlvZF9zZXRfdmFsdWUoc21p
LT5tZGMsIDEpOw0KPiAtCXJlYWx0ZWtfc21pX2Nsa19kZWxheShzbWkpOw0KPiAtCWdwaW9kX3Nl
dF92YWx1ZShzbWktPm1kaW8sIDApOw0KPiAtCXJlYWx0ZWtfc21pX2Nsa19kZWxheShzbWkpOw0K
PiAtCWdwaW9kX3NldF92YWx1ZShzbWktPm1kYywgMCk7DQo+IC0JcmVhbHRla19zbWlfY2xrX2Rl
bGF5KHNtaSk7DQo+IC0JZ3Bpb2Rfc2V0X3ZhbHVlKHNtaS0+bWRpbywgMSk7DQo+ICsJZ3Bpb2Rf
c2V0X3ZhbHVlKHByaXYtPm1kYywgMSk7DQo+ICsJcmVhbHRla19zbWlfY2xrX2RlbGF5KHByaXYp
Ow0KPiArCWdwaW9kX3NldF92YWx1ZShwcml2LT5tZGlvLCAwKTsNCj4gKwlyZWFsdGVrX3NtaV9j
bGtfZGVsYXkocHJpdik7DQo+ICsJZ3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1kYywgMCk7DQo+ICsJ
cmVhbHRla19zbWlfY2xrX2RlbGF5KHByaXYpOw0KPiArCWdwaW9kX3NldF92YWx1ZShwcml2LT5t
ZGlvLCAxKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgdm9pZCByZWFsdGVrX3NtaV9zdG9wKHN0
cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiArc3RhdGljIHZvaWQgcmVhbHRla19zbWlfc3RvcChz
dHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gLQlyZWFsdGVrX3NtaV9jbGtfZGVs
YXkoc21pKTsNCj4gLQlncGlvZF9zZXRfdmFsdWUoc21pLT5tZGlvLCAwKTsNCj4gLQlncGlvZF9z
ZXRfdmFsdWUoc21pLT5tZGMsIDEpOw0KPiAtCXJlYWx0ZWtfc21pX2Nsa19kZWxheShzbWkpOw0K
PiAtCWdwaW9kX3NldF92YWx1ZShzbWktPm1kaW8sIDEpOw0KPiAtCXJlYWx0ZWtfc21pX2Nsa19k
ZWxheShzbWkpOw0KPiAtCWdwaW9kX3NldF92YWx1ZShzbWktPm1kYywgMSk7DQo+IC0JcmVhbHRl
a19zbWlfY2xrX2RlbGF5KHNtaSk7DQo+IC0JZ3Bpb2Rfc2V0X3ZhbHVlKHNtaS0+bWRjLCAwKTsN
Cj4gLQlyZWFsdGVrX3NtaV9jbGtfZGVsYXkoc21pKTsNCj4gLQlncGlvZF9zZXRfdmFsdWUoc21p
LT5tZGMsIDEpOw0KPiArCXJlYWx0ZWtfc21pX2Nsa19kZWxheShwcml2KTsNCj4gKwlncGlvZF9z
ZXRfdmFsdWUocHJpdi0+bWRpbywgMCk7DQo+ICsJZ3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1kYywg
MSk7DQo+ICsJcmVhbHRla19zbWlfY2xrX2RlbGF5KHByaXYpOw0KPiArCWdwaW9kX3NldF92YWx1
ZShwcml2LT5tZGlvLCAxKTsNCj4gKwlyZWFsdGVrX3NtaV9jbGtfZGVsYXkocHJpdik7DQo+ICsJ
Z3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1kYywgMSk7DQo+ICsJcmVhbHRla19zbWlfY2xrX2RlbGF5
KHByaXYpOw0KPiArCWdwaW9kX3NldF92YWx1ZShwcml2LT5tZGMsIDApOw0KPiArCXJlYWx0ZWtf
c21pX2Nsa19kZWxheShwcml2KTsNCj4gKwlncGlvZF9zZXRfdmFsdWUocHJpdi0+bWRjLCAxKTsN
Cj4gICANCj4gICAJLyogQWRkIGEgY2xpY2sgKi8NCj4gLQlyZWFsdGVrX3NtaV9jbGtfZGVsYXko
c21pKTsNCj4gLQlncGlvZF9zZXRfdmFsdWUoc21pLT5tZGMsIDApOw0KPiAtCXJlYWx0ZWtfc21p
X2Nsa19kZWxheShzbWkpOw0KPiAtCWdwaW9kX3NldF92YWx1ZShzbWktPm1kYywgMSk7DQo+ICsJ
cmVhbHRla19zbWlfY2xrX2RlbGF5KHByaXYpOw0KPiArCWdwaW9kX3NldF92YWx1ZShwcml2LT5t
ZGMsIDApOw0KPiArCXJlYWx0ZWtfc21pX2Nsa19kZWxheShwcml2KTsNCj4gKwlncGlvZF9zZXRf
dmFsdWUocHJpdi0+bWRjLCAxKTsNCj4gICANCj4gICAJLyogU2V0IEdQSU8gcGlucyB0byBpbnB1
dCBtb2RlICovDQo+IC0JZ3Bpb2RfZGlyZWN0aW9uX2lucHV0KHNtaS0+bWRpbyk7DQo+IC0JZ3Bp
b2RfZGlyZWN0aW9uX2lucHV0KHNtaS0+bWRjKTsNCj4gKwlncGlvZF9kaXJlY3Rpb25faW5wdXQo
cHJpdi0+bWRpbyk7DQo+ICsJZ3Bpb2RfZGlyZWN0aW9uX2lucHV0KHByaXYtPm1kYyk7DQo+ICAg
fQ0KPiAgIA0KPiAtc3RhdGljIHZvaWQgcmVhbHRla19zbWlfd3JpdGVfYml0cyhzdHJ1Y3QgcmVh
bHRla19zbWkgKnNtaSwgdTMyIGRhdGEsIHUzMiBsZW4pDQo+ICtzdGF0aWMgdm9pZCByZWFsdGVr
X3NtaV93cml0ZV9iaXRzKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIHUzMiBkYXRhLCB1MzIg
bGVuKQ0KPiAgIHsNCj4gICAJZm9yICg7IGxlbiA+IDA7IGxlbi0tKSB7DQo+IC0JCXJlYWx0ZWtf
c21pX2Nsa19kZWxheShzbWkpOw0KPiArCQlyZWFsdGVrX3NtaV9jbGtfZGVsYXkocHJpdik7DQo+
ICAgDQo+ICAgCQkvKiBQcmVwYXJlIGRhdGEgKi8NCj4gLQkJZ3Bpb2Rfc2V0X3ZhbHVlKHNtaS0+
bWRpbywgISEoZGF0YSAmICgxIDw8IChsZW4gLSAxKSkpKTsNCj4gLQkJcmVhbHRla19zbWlfY2xr
X2RlbGF5KHNtaSk7DQo+ICsJCWdwaW9kX3NldF92YWx1ZShwcml2LT5tZGlvLCAhIShkYXRhICYg
KDEgPDwgKGxlbiAtIDEpKSkpOw0KPiArCQlyZWFsdGVrX3NtaV9jbGtfZGVsYXkocHJpdik7DQo+
ICAgDQo+ICAgCQkvKiBDbG9ja2luZyAqLw0KPiAtCQlncGlvZF9zZXRfdmFsdWUoc21pLT5tZGMs
IDEpOw0KPiAtCQlyZWFsdGVrX3NtaV9jbGtfZGVsYXkoc21pKTsNCj4gLQkJZ3Bpb2Rfc2V0X3Zh
bHVlKHNtaS0+bWRjLCAwKTsNCj4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1kYywgMSk7DQo+
ICsJCXJlYWx0ZWtfc21pX2Nsa19kZWxheShwcml2KTsNCj4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlKHBy
aXYtPm1kYywgMCk7DQo+ICAgCX0NCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgdm9pZCByZWFsdGVr
X3NtaV9yZWFkX2JpdHMoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHUzMiBsZW4sIHUzMiAqZGF0
YSkNCj4gK3N0YXRpYyB2b2lkIHJlYWx0ZWtfc21pX3JlYWRfYml0cyhzdHJ1Y3QgcmVhbHRla19w
cml2ICpwcml2LCB1MzIgbGVuLCB1MzIgKmRhdGEpDQo+ICAgew0KPiAtCWdwaW9kX2RpcmVjdGlv
bl9pbnB1dChzbWktPm1kaW8pOw0KPiArCWdwaW9kX2RpcmVjdGlvbl9pbnB1dChwcml2LT5tZGlv
KTsNCj4gICANCj4gICAJZm9yICgqZGF0YSA9IDA7IGxlbiA+IDA7IGxlbi0tKSB7DQo+ICAgCQl1
MzIgdTsNCj4gICANCj4gLQkJcmVhbHRla19zbWlfY2xrX2RlbGF5KHNtaSk7DQo+ICsJCXJlYWx0
ZWtfc21pX2Nsa19kZWxheShwcml2KTsNCj4gICANCj4gICAJCS8qIENsb2NraW5nICovDQo+IC0J
CWdwaW9kX3NldF92YWx1ZShzbWktPm1kYywgMSk7DQo+IC0JCXJlYWx0ZWtfc21pX2Nsa19kZWxh
eShzbWkpOw0KPiAtCQl1ID0gISFncGlvZF9nZXRfdmFsdWUoc21pLT5tZGlvKTsNCj4gLQkJZ3Bp
b2Rfc2V0X3ZhbHVlKHNtaS0+bWRjLCAwKTsNCj4gKwkJZ3Bpb2Rfc2V0X3ZhbHVlKHByaXYtPm1k
YywgMSk7DQo+ICsJCXJlYWx0ZWtfc21pX2Nsa19kZWxheShwcml2KTsNCj4gKwkJdSA9ICEhZ3Bp
b2RfZ2V0X3ZhbHVlKHByaXYtPm1kaW8pOw0KPiArCQlncGlvZF9zZXRfdmFsdWUocHJpdi0+bWRj
LCAwKTsNCj4gICANCj4gICAJCSpkYXRhIHw9ICh1IDw8IChsZW4gLSAxKSk7DQo+ICAgCX0NCj4g
ICANCj4gLQlncGlvZF9kaXJlY3Rpb25fb3V0cHV0KHNtaS0+bWRpbywgMCk7DQo+ICsJZ3Bpb2Rf
ZGlyZWN0aW9uX291dHB1dChwcml2LT5tZGlvLCAwKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMg
aW50IHJlYWx0ZWtfc21pX3dhaXRfZm9yX2FjayhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4g
K3N0YXRpYyBpbnQgcmVhbHRla19zbWlfd2FpdF9mb3JfYWNrKHN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYpDQo+ICAgew0KPiAgIAlpbnQgcmV0cnlfY250Ow0KPiAgIA0KPiBAQCAtMTQ2LDEyICsx
NDYsMTIgQEAgc3RhdGljIGludCByZWFsdGVrX3NtaV93YWl0X2Zvcl9hY2soc3RydWN0IHJlYWx0
ZWtfc21pICpzbWkpDQo+ICAgCWRvIHsNCj4gICAJCXUzMiBhY2s7DQo+ICAgDQo+IC0JCXJlYWx0
ZWtfc21pX3JlYWRfYml0cyhzbWksIDEsICZhY2spOw0KPiArCQlyZWFsdGVrX3NtaV9yZWFkX2Jp
dHMocHJpdiwgMSwgJmFjayk7DQo+ICAgCQlpZiAoYWNrID09IDApDQo+ICAgCQkJYnJlYWs7DQo+
ICAgDQo+ICAgCQlpZiAoKytyZXRyeV9jbnQgPiBSRUFMVEVLX1NNSV9BQ0tfUkVUUllfQ09VTlQp
IHsNCj4gLQkJCWRldl9lcnIoc21pLT5kZXYsICJBQ0sgdGltZW91dFxuIik7DQo+ICsJCQlkZXZf
ZXJyKHByaXYtPmRldiwgIkFDSyB0aW1lb3V0XG4iKTsNCj4gICAJCQlyZXR1cm4gLUVUSU1FRE9V
VDsNCj4gICAJCX0NCj4gICAJfSB3aGlsZSAoMSk7DQo+IEBAIC0xNTksMTMxICsxNTksMTMxIEBA
IHN0YXRpYyBpbnQgcmVhbHRla19zbWlfd2FpdF9mb3JfYWNrKHN0cnVjdCByZWFsdGVrX3NtaSAq
c21pKQ0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJlYWx0ZWtf
c21pX3dyaXRlX2J5dGUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHU4IGRhdGEpDQo+ICtzdGF0
aWMgaW50IHJlYWx0ZWtfc21pX3dyaXRlX2J5dGUoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwg
dTggZGF0YSkNCj4gICB7DQo+IC0JcmVhbHRla19zbWlfd3JpdGVfYml0cyhzbWksIGRhdGEsIDgp
Ow0KPiAtCXJldHVybiByZWFsdGVrX3NtaV93YWl0X2Zvcl9hY2soc21pKTsNCj4gKwlyZWFsdGVr
X3NtaV93cml0ZV9iaXRzKHByaXYsIGRhdGEsIDgpOw0KPiArCXJldHVybiByZWFsdGVrX3NtaV93
YWl0X2Zvcl9hY2socHJpdik7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCByZWFsdGVrX3Nt
aV93cml0ZV9ieXRlX25vYWNrKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCB1OCBkYXRhKQ0KPiAr
c3RhdGljIGludCByZWFsdGVrX3NtaV93cml0ZV9ieXRlX25vYWNrKHN0cnVjdCByZWFsdGVrX3By
aXYgKnByaXYsIHU4IGRhdGEpDQo+ICAgew0KPiAtCXJlYWx0ZWtfc21pX3dyaXRlX2JpdHMoc21p
LCBkYXRhLCA4KTsNCj4gKwlyZWFsdGVrX3NtaV93cml0ZV9iaXRzKHByaXYsIGRhdGEsIDgpOw0K
PiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJlYWx0ZWtfc21pX3Jl
YWRfYnl0ZTAoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHU4ICpkYXRhKQ0KPiArc3RhdGljIGlu
dCByZWFsdGVrX3NtaV9yZWFkX2J5dGUwKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIHU4ICpk
YXRhKQ0KPiAgIHsNCj4gICAJdTMyIHQ7DQo+ICAgDQo+ICAgCS8qIFJlYWQgZGF0YSAqLw0KPiAt
CXJlYWx0ZWtfc21pX3JlYWRfYml0cyhzbWksIDgsICZ0KTsNCj4gKwlyZWFsdGVrX3NtaV9yZWFk
X2JpdHMocHJpdiwgOCwgJnQpOw0KPiAgIAkqZGF0YSA9ICh0ICYgMHhmZik7DQo+ICAgDQo+ICAg
CS8qIFNlbmQgYW4gQUNLICovDQo+IC0JcmVhbHRla19zbWlfd3JpdGVfYml0cyhzbWksIDB4MDAs
IDEpOw0KPiArCXJlYWx0ZWtfc21pX3dyaXRlX2JpdHMocHJpdiwgMHgwMCwgMSk7DQo+ICAgDQo+
ICAgCXJldHVybiAwOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcmVhbHRla19zbWlfcmVh
ZF9ieXRlMShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTggKmRhdGEpDQo+ICtzdGF0aWMgaW50
IHJlYWx0ZWtfc21pX3JlYWRfYnl0ZTEoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgdTggKmRh
dGEpDQo+ICAgew0KPiAgIAl1MzIgdDsNCj4gICANCj4gICAJLyogUmVhZCBkYXRhICovDQo+IC0J
cmVhbHRla19zbWlfcmVhZF9iaXRzKHNtaSwgOCwgJnQpOw0KPiArCXJlYWx0ZWtfc21pX3JlYWRf
Yml0cyhwcml2LCA4LCAmdCk7DQo+ICAgCSpkYXRhID0gKHQgJiAweGZmKTsNCj4gICANCj4gICAJ
LyogU2VuZCBhbiBBQ0sgKi8NCj4gLQlyZWFsdGVrX3NtaV93cml0ZV9iaXRzKHNtaSwgMHgwMSwg
MSk7DQo+ICsJcmVhbHRla19zbWlfd3JpdGVfYml0cyhwcml2LCAweDAxLCAxKTsNCj4gICANCj4g
ICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCByZWFsdGVrX3NtaV9yZWFk
X3JlZyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTMyIGFkZHIsIHUzMiAqZGF0YSkNCj4gK3N0
YXRpYyBpbnQgcmVhbHRla19zbWlfcmVhZF9yZWcoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwg
dTMyIGFkZHIsIHUzMiAqZGF0YSkNCj4gICB7DQo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+
ICAgCXU4IGxvID0gMDsNCj4gICAJdTggaGkgPSAwOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAt
CXNwaW5fbG9ja19pcnFzYXZlKCZzbWktPmxvY2ssIGZsYWdzKTsNCj4gKwlzcGluX2xvY2tfaXJx
c2F2ZSgmcHJpdi0+bG9jaywgZmxhZ3MpOw0KPiAgIA0KPiAtCXJlYWx0ZWtfc21pX3N0YXJ0KHNt
aSk7DQo+ICsJcmVhbHRla19zbWlfc3RhcnQocHJpdik7DQo+ICAgDQo+ICAgCS8qIFNlbmQgUkVB
RCBjb21tYW5kICovDQo+IC0JcmV0ID0gcmVhbHRla19zbWlfd3JpdGVfYnl0ZShzbWksIHNtaS0+
Y21kX3JlYWQpOw0KPiArCXJldCA9IHJlYWx0ZWtfc21pX3dyaXRlX2J5dGUocHJpdiwgcHJpdi0+
Y21kX3JlYWQpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBvdXQ7DQo+ICAgDQo+ICAgCS8q
IFNldCBBRERSWzc6MF0gKi8NCj4gLQlyZXQgPSByZWFsdGVrX3NtaV93cml0ZV9ieXRlKHNtaSwg
YWRkciAmIDB4ZmYpOw0KPiArCXJldCA9IHJlYWx0ZWtfc21pX3dyaXRlX2J5dGUocHJpdiwgYWRk
ciAmIDB4ZmYpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBvdXQ7DQo+ICAgDQo+ICAgCS8q
IFNldCBBRERSWzE1OjhdICovDQo+IC0JcmV0ID0gcmVhbHRla19zbWlfd3JpdGVfYnl0ZShzbWks
IGFkZHIgPj4gOCk7DQo+ICsJcmV0ID0gcmVhbHRla19zbWlfd3JpdGVfYnl0ZShwcml2LCBhZGRy
ID4+IDgpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBvdXQ7DQo+ICAgDQo+ICAgCS8qIFJl
YWQgREFUQVs3OjBdICovDQo+IC0JcmVhbHRla19zbWlfcmVhZF9ieXRlMChzbWksICZsbyk7DQo+
ICsJcmVhbHRla19zbWlfcmVhZF9ieXRlMChwcml2LCAmbG8pOw0KPiAgIAkvKiBSZWFkIERBVEFb
MTU6OF0gKi8NCj4gLQlyZWFsdGVrX3NtaV9yZWFkX2J5dGUxKHNtaSwgJmhpKTsNCj4gKwlyZWFs
dGVrX3NtaV9yZWFkX2J5dGUxKHByaXYsICZoaSk7DQo+ICAgDQo+ICAgCSpkYXRhID0gKCh1MzIp
bG8pIHwgKCgodTMyKWhpKSA8PCA4KTsNCj4gICANCj4gICAJcmV0ID0gMDsNCj4gICANCj4gICAg
b3V0Og0KPiAtCXJlYWx0ZWtfc21pX3N0b3Aoc21pKTsNCj4gLQlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZzbWktPmxvY2ssIGZsYWdzKTsNCj4gKwlyZWFsdGVrX3NtaV9zdG9wKHByaXYpOw0KPiAr
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnByaXYtPmxvY2ssIGZsYWdzKTsNCj4gICANCj4gICAJ
cmV0dXJuIHJldDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJlYWx0ZWtfc21pX3dyaXRl
X3JlZyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwNCj4gK3N0YXRpYyBpbnQgcmVhbHRla19zbWlf
d3JpdGVfcmVnKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsDQo+ICAgCQkJCSB1MzIgYWRkciwg
dTMyIGRhdGEsIGJvb2wgYWNrKQ0KPiAgIHsNCj4gICAJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4g
ICAJaW50IHJldDsNCj4gICANCj4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmc21pLT5sb2NrLCBmbGFn
cyk7DQo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJnByaXYtPmxvY2ssIGZsYWdzKTsNCj4gICANCj4g
LQlyZWFsdGVrX3NtaV9zdGFydChzbWkpOw0KPiArCXJlYWx0ZWtfc21pX3N0YXJ0KHByaXYpOw0K
PiAgIA0KPiAgIAkvKiBTZW5kIFdSSVRFIGNvbW1hbmQgKi8NCj4gLQlyZXQgPSByZWFsdGVrX3Nt
aV93cml0ZV9ieXRlKHNtaSwgc21pLT5jbWRfd3JpdGUpOw0KPiArCXJldCA9IHJlYWx0ZWtfc21p
X3dyaXRlX2J5dGUocHJpdiwgcHJpdi0+Y21kX3dyaXRlKTsNCj4gICAJaWYgKHJldCkNCj4gICAJ
CWdvdG8gb3V0Ow0KPiAgIA0KPiAgIAkvKiBTZXQgQUREUls3OjBdICovDQo+IC0JcmV0ID0gcmVh
bHRla19zbWlfd3JpdGVfYnl0ZShzbWksIGFkZHIgJiAweGZmKTsNCj4gKwlyZXQgPSByZWFsdGVr
X3NtaV93cml0ZV9ieXRlKHByaXYsIGFkZHIgJiAweGZmKTsNCj4gICAJaWYgKHJldCkNCj4gICAJ
CWdvdG8gb3V0Ow0KPiAgIA0KPiAgIAkvKiBTZXQgQUREUlsxNTo4XSAqLw0KPiAtCXJldCA9IHJl
YWx0ZWtfc21pX3dyaXRlX2J5dGUoc21pLCBhZGRyID4+IDgpOw0KPiArCXJldCA9IHJlYWx0ZWtf
c21pX3dyaXRlX2J5dGUocHJpdiwgYWRkciA+PiA4KTsNCj4gICAJaWYgKHJldCkNCj4gICAJCWdv
dG8gb3V0Ow0KPiAgIA0KPiAgIAkvKiBXcml0ZSBEQVRBWzc6MF0gKi8NCj4gLQlyZXQgPSByZWFs
dGVrX3NtaV93cml0ZV9ieXRlKHNtaSwgZGF0YSAmIDB4ZmYpOw0KPiArCXJldCA9IHJlYWx0ZWtf
c21pX3dyaXRlX2J5dGUocHJpdiwgZGF0YSAmIDB4ZmYpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJ
Z290byBvdXQ7DQo+ICAgDQo+ICAgCS8qIFdyaXRlIERBVEFbMTU6OF0gKi8NCj4gICAJaWYgKGFj
aykNCj4gLQkJcmV0ID0gcmVhbHRla19zbWlfd3JpdGVfYnl0ZShzbWksIGRhdGEgPj4gOCk7DQo+
ICsJCXJldCA9IHJlYWx0ZWtfc21pX3dyaXRlX2J5dGUocHJpdiwgZGF0YSA+PiA4KTsNCj4gICAJ
ZWxzZQ0KPiAtCQlyZXQgPSByZWFsdGVrX3NtaV93cml0ZV9ieXRlX25vYWNrKHNtaSwgZGF0YSA+
PiA4KTsNCj4gKwkJcmV0ID0gcmVhbHRla19zbWlfd3JpdGVfYnl0ZV9ub2Fjayhwcml2LCBkYXRh
ID4+IDgpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBvdXQ7DQo+ICAgDQo+ICAgCXJldCA9
IDA7DQo+ICAgDQo+ICAgIG91dDoNCj4gLQlyZWFsdGVrX3NtaV9zdG9wKHNtaSk7DQo+IC0Jc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmc21pLT5sb2NrLCBmbGFncyk7DQo+ICsJcmVhbHRla19zbWlf
c3RvcChwcml2KTsNCj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwcml2LT5sb2NrLCBmbGFn
cyk7DQo+ICAgDQo+ICAgCXJldHVybiByZXQ7DQo+ICAgfQ0KPiBAQCAtMjkyLDEwICsyOTIsMTAg
QEAgc3RhdGljIGludCByZWFsdGVrX3NtaV93cml0ZV9yZWcoc3RydWN0IHJlYWx0ZWtfc21pICpz
bWksDQo+ICAgICogaXMgd2hlbiBpc3N1ZWluZyBzb2Z0IHJlc2V0LiBTaW5jZSB0aGUgZGV2aWNl
IHJlc2V0IGFzIHNvb24gYXMgd2Ugd3JpdGUNCj4gICAgKiB0aGF0IGJpdCwgbm8gQUNLIHdpbGwg
Y29tZSBiYWNrIGZvciBuYXR1cmFsIHJlYXNvbnMuDQo+ICAgICovDQo+IC1pbnQgcmVhbHRla19z
bWlfd3JpdGVfcmVnX25vYWNrKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCB1MzIgYWRkciwNCj4g
K2ludCByZWFsdGVrX3NtaV93cml0ZV9yZWdfbm9hY2soc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJp
diwgdTMyIGFkZHIsDQo+ICAgCQkJCXUzMiBkYXRhKQ0KPiAgIHsNCj4gLQlyZXR1cm4gcmVhbHRl
a19zbWlfd3JpdGVfcmVnKHNtaSwgYWRkciwgZGF0YSwgZmFsc2UpOw0KPiArCXJldHVybiByZWFs
dGVrX3NtaV93cml0ZV9yZWcocHJpdiwgYWRkciwgZGF0YSwgZmFsc2UpOw0KPiAgIH0NCj4gICBF
WFBPUlRfU1lNQk9MX0dQTChyZWFsdGVrX3NtaV93cml0ZV9yZWdfbm9hY2spOw0KDQpJZiB5b3Ug
bWFrZSB0aGVzZSBmdW5jdGlvbnMgcHJpdmF0ZSB0aGVuIHlvdSBkb24ndCBuZWVkIHRvIEVYUE9S
VF9TWU1CT0wgDQphbnltb3JlLg0KDQo+ICAgDQo+IEBAIC0zMDMsMTYgKzMwMywxNiBAQCBFWFBP
UlRfU1lNQk9MX0dQTChyZWFsdGVrX3NtaV93cml0ZV9yZWdfbm9hY2spOw0KPiAgIA0KPiAgIHN0
YXRpYyBpbnQgcmVhbHRla19zbWlfd3JpdGUodm9pZCAqY3R4LCB1MzIgcmVnLCB1MzIgdmFsKQ0K
PiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGN0eDsNCj4gKwlzdHJ1Y3QgcmVh
bHRla19wcml2ICpwcml2ID0gY3R4Ow0KPiAgIA0KPiAtCXJldHVybiByZWFsdGVrX3NtaV93cml0
ZV9yZWcoc21pLCByZWcsIHZhbCwgdHJ1ZSk7DQo+ICsJcmV0dXJuIHJlYWx0ZWtfc21pX3dyaXRl
X3JlZyhwcml2LCByZWcsIHZhbCwgdHJ1ZSk7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQg
cmVhbHRla19zbWlfcmVhZCh2b2lkICpjdHgsIHUzMiByZWcsIHUzMiAqdmFsKQ0KPiAgIHsNCj4g
LQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGN0eDsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2
ICpwcml2ID0gY3R4Ow0KPiAgIA0KPiAtCXJldHVybiByZWFsdGVrX3NtaV9yZWFkX3JlZyhzbWks
IHJlZywgdmFsKTsNCj4gKwlyZXR1cm4gcmVhbHRla19zbWlfcmVhZF9yZWcocHJpdiwgcmVnLCB2
YWwpOw0KPiAgIH0NCj4gICANCj4gICBzdGF0aWMgY29uc3Qgc3RydWN0IHJlZ21hcF9jb25maWcg
cmVhbHRla19zbWlfbWRpb19yZWdtYXBfY29uZmlnID0gew0KPiBAQCAtMzI5LDQ5ICszMjksNDkg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCByZWdtYXBfY29uZmlnIHJlYWx0ZWtfc21pX21kaW9fcmVn
bWFwX2NvbmZpZyA9IHsNCj4gICANCj4gICBzdGF0aWMgaW50IHJlYWx0ZWtfc21pX21kaW9fcmVh
ZChzdHJ1Y3QgbWlpX2J1cyAqYnVzLCBpbnQgYWRkciwgaW50IHJlZ251bSkNCj4gICB7DQo+IC0J
c3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBidXMtPnByaXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtf
cHJpdiAqcHJpdiA9IGJ1cy0+cHJpdjsNCj4gICANCj4gLQlyZXR1cm4gc21pLT5vcHMtPnBoeV9y
ZWFkKHNtaSwgYWRkciwgcmVnbnVtKTsNCj4gKwlyZXR1cm4gcHJpdi0+b3BzLT5waHlfcmVhZChw
cml2LCBhZGRyLCByZWdudW0pOw0KPiAgIH0NCj4gICANCj4gICBzdGF0aWMgaW50IHJlYWx0ZWtf
c21pX21kaW9fd3JpdGUoc3RydWN0IG1paV9idXMgKmJ1cywgaW50IGFkZHIsIGludCByZWdudW0s
DQo+ICAgCQkJCSAgdTE2IHZhbCkNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpzbWkg
PSBidXMtPnByaXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiA9IGJ1cy0+cHJpdjsN
Cj4gICANCj4gLQlyZXR1cm4gc21pLT5vcHMtPnBoeV93cml0ZShzbWksIGFkZHIsIHJlZ251bSwg
dmFsKTsNCj4gKwlyZXR1cm4gcHJpdi0+b3BzLT5waHlfd3JpdGUocHJpdiwgYWRkciwgcmVnbnVt
LCB2YWwpOw0KPiAgIH0NCj4gICANCj4gLWludCByZWFsdGVrX3NtaV9zZXR1cF9tZGlvKHN0cnVj
dCByZWFsdGVrX3NtaSAqc21pKQ0KPiAraW50IHJlYWx0ZWtfc21pX3NldHVwX21kaW8oc3RydWN0
IHJlYWx0ZWtfcHJpdiAqcHJpdikNCj4gICB7DQo+ICAgCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbWRp
b19ucDsNCj4gICAJaW50IHJldDsNCj4gICANCj4gLQltZGlvX25wID0gb2ZfZ2V0X2NvbXBhdGli
bGVfY2hpbGQoc21pLT5kZXYtPm9mX25vZGUsICJyZWFsdGVrLHNtaS1tZGlvIik7DQo+ICsJbWRp
b19ucCA9IG9mX2dldF9jb21wYXRpYmxlX2NoaWxkKHByaXYtPmRldi0+b2Zfbm9kZSwgInJlYWx0
ZWssc21pLW1kaW8iKTsNCj4gICAJaWYgKCFtZGlvX25wKSB7DQo+IC0JCWRldl9lcnIoc21pLT5k
ZXYsICJubyBNRElPIGJ1cyBub2RlXG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsICJubyBN
RElPIGJ1cyBub2RlXG4iKTsNCj4gICAJCXJldHVybiAtRU5PREVWOw0KPiAgIAl9DQo+ICAgDQo+
IC0Jc21pLT5zbGF2ZV9taWlfYnVzID0gZGV2bV9tZGlvYnVzX2FsbG9jKHNtaS0+ZGV2KTsNCj4g
LQlpZiAoIXNtaS0+c2xhdmVfbWlpX2J1cykgew0KPiArCXByaXYtPnNsYXZlX21paV9idXMgPSBk
ZXZtX21kaW9idXNfYWxsb2MocHJpdi0+ZGV2KTsNCj4gKwlpZiAoIXByaXYtPnNsYXZlX21paV9i
dXMpIHsNCj4gICAJCXJldCA9IC1FTk9NRU07DQo+ICAgCQlnb3RvIGVycl9wdXRfbm9kZTsNCj4g
ICAJfQ0KPiAtCXNtaS0+c2xhdmVfbWlpX2J1cy0+cHJpdiA9IHNtaTsNCj4gLQlzbWktPnNsYXZl
X21paV9idXMtPm5hbWUgPSAiU01JIHNsYXZlIE1JSSI7DQo+IC0Jc21pLT5zbGF2ZV9taWlfYnVz
LT5yZWFkID0gcmVhbHRla19zbWlfbWRpb19yZWFkOw0KPiAtCXNtaS0+c2xhdmVfbWlpX2J1cy0+
d3JpdGUgPSByZWFsdGVrX3NtaV9tZGlvX3dyaXRlOw0KPiAtCXNucHJpbnRmKHNtaS0+c2xhdmVf
bWlpX2J1cy0+aWQsIE1JSV9CVVNfSURfU0laRSwgIlNNSS0lZCIsDQo+IC0JCSBzbWktPmRzLT5p
bmRleCk7DQo+IC0Jc21pLT5zbGF2ZV9taWlfYnVzLT5kZXYub2Zfbm9kZSA9IG1kaW9fbnA7DQo+
IC0Jc21pLT5zbGF2ZV9taWlfYnVzLT5wYXJlbnQgPSBzbWktPmRldjsNCj4gLQlzbWktPmRzLT5z
bGF2ZV9taWlfYnVzID0gc21pLT5zbGF2ZV9taWlfYnVzOw0KPiAtDQo+IC0JcmV0ID0gZGV2bV9v
Zl9tZGlvYnVzX3JlZ2lzdGVyKHNtaS0+ZGV2LCBzbWktPnNsYXZlX21paV9idXMsIG1kaW9fbnAp
Ow0KPiArCXByaXYtPnNsYXZlX21paV9idXMtPnByaXYgPSBwcml2Ow0KPiArCXByaXYtPnNsYXZl
X21paV9idXMtPm5hbWUgPSAiU01JIHNsYXZlIE1JSSI7DQo+ICsJcHJpdi0+c2xhdmVfbWlpX2J1
cy0+cmVhZCA9IHJlYWx0ZWtfc21pX21kaW9fcmVhZDsNCj4gKwlwcml2LT5zbGF2ZV9taWlfYnVz
LT53cml0ZSA9IHJlYWx0ZWtfc21pX21kaW9fd3JpdGU7DQo+ICsJc25wcmludGYocHJpdi0+c2xh
dmVfbWlpX2J1cy0+aWQsIE1JSV9CVVNfSURfU0laRSwgIlNNSS0lZCIsDQo+ICsJCSBwcml2LT5k
cy0+aW5kZXgpOw0KPiArCXByaXYtPnNsYXZlX21paV9idXMtPmRldi5vZl9ub2RlID0gbWRpb19u
cDsNCj4gKwlwcml2LT5zbGF2ZV9taWlfYnVzLT5wYXJlbnQgPSBwcml2LT5kZXY7DQo+ICsJcHJp
di0+ZHMtPnNsYXZlX21paV9idXMgPSBwcml2LT5zbGF2ZV9taWlfYnVzOw0KPiArDQo+ICsJcmV0
ID0gZGV2bV9vZl9tZGlvYnVzX3JlZ2lzdGVyKHByaXYtPmRldiwgcHJpdi0+c2xhdmVfbWlpX2J1
cywgbWRpb19ucCk7DQo+ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgInVu
YWJsZSB0byByZWdpc3RlciBNRElPIGJ1cyAlc1xuIiwNCj4gLQkJCXNtaS0+c2xhdmVfbWlpX2J1
cy0+aWQpOw0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwgInVuYWJsZSB0byByZWdpc3RlciBNRElP
IGJ1cyAlc1xuIiwNCj4gKwkJCXByaXYtPnNsYXZlX21paV9idXMtPmlkKTsNCj4gICAJCWdvdG8g
ZXJyX3B1dF9ub2RlOw0KPiAgIAl9DQo+ICAgDQo+IEBAIC0zODUsNzYgKzM4NSw3NiBAQCBpbnQg
cmVhbHRla19zbWlfc2V0dXBfbWRpbyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gICANCj4g
ICBzdGF0aWMgaW50IHJlYWx0ZWtfc21pX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpDQo+ICAgew0KPiAtCWNvbnN0IHN0cnVjdCByZWFsdGVrX3NtaV92YXJpYW50ICp2YXI7DQo+
ICsJY29uc3Qgc3RydWN0IHJlYWx0ZWtfdmFyaWFudCAqdmFyOw0KPiAgIAlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSAmcGRldi0+ZGV2Ow0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pOw0KPiArCXN0
cnVjdCByZWFsdGVrX3ByaXYgKnByaXY7DQo+ICAgCXN0cnVjdCBkZXZpY2Vfbm9kZSAqbnA7DQo+
ICAgCWludCByZXQ7DQo+ICAgDQo+ICAgCXZhciA9IG9mX2RldmljZV9nZXRfbWF0Y2hfZGF0YShk
ZXYpOw0KPiAgIAlucCA9IGRldi0+b2Zfbm9kZTsNCj4gICANCj4gLQlzbWkgPSBkZXZtX2t6YWxs
b2MoZGV2LCBzaXplb2YoKnNtaSkgKyB2YXItPmNoaXBfZGF0YV9zeiwgR0ZQX0tFUk5FTCk7DQo+
IC0JaWYgKCFzbWkpDQo+ICsJcHJpdiA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqcHJpdikg
KyB2YXItPmNoaXBfZGF0YV9zeiwgR0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFwcml2KQ0KPiAgIAkJ
cmV0dXJuIC1FTk9NRU07DQo+IC0Jc21pLT5jaGlwX2RhdGEgPSAodm9pZCAqKXNtaSArIHNpemVv
Zigqc21pKTsNCj4gLQlzbWktPm1hcCA9IGRldm1fcmVnbWFwX2luaXQoZGV2LCBOVUxMLCBzbWks
DQo+ICsJcHJpdi0+Y2hpcF9kYXRhID0gKHZvaWQgKilwcml2ICsgc2l6ZW9mKCpwcml2KTsNCj4g
Kwlwcml2LT5tYXAgPSBkZXZtX3JlZ21hcF9pbml0KGRldiwgTlVMTCwgcHJpdiwNCj4gICAJCQkJ
ICAgICZyZWFsdGVrX3NtaV9tZGlvX3JlZ21hcF9jb25maWcpOw0KPiAtCWlmIChJU19FUlIoc21p
LT5tYXApKSB7DQo+IC0JCXJldCA9IFBUUl9FUlIoc21pLT5tYXApOw0KPiArCWlmIChJU19FUlIo
cHJpdi0+bWFwKSkgew0KPiArCQlyZXQgPSBQVFJfRVJSKHByaXYtPm1hcCk7DQo+ICAgCQlkZXZf
ZXJyKGRldiwgInJlZ21hcCBpbml0IGZhaWxlZDogJWRcbiIsIHJldCk7DQo+ICAgCQlyZXR1cm4g
cmV0Ow0KPiAgIAl9DQo+ICAgDQo+ICAgCS8qIExpbmsgZm9yd2FyZCBhbmQgYmFja3dhcmQgKi8N
Cj4gLQlzbWktPmRldiA9IGRldjsNCj4gLQlzbWktPmNsa19kZWxheSA9IHZhci0+Y2xrX2RlbGF5
Ow0KPiAtCXNtaS0+Y21kX3JlYWQgPSB2YXItPmNtZF9yZWFkOw0KPiAtCXNtaS0+Y21kX3dyaXRl
ID0gdmFyLT5jbWRfd3JpdGU7DQo+IC0Jc21pLT5vcHMgPSB2YXItPm9wczsNCj4gKwlwcml2LT5k
ZXYgPSBkZXY7DQo+ICsJcHJpdi0+Y2xrX2RlbGF5ID0gdmFyLT5jbGtfZGVsYXk7DQo+ICsJcHJp
di0+Y21kX3JlYWQgPSB2YXItPmNtZF9yZWFkOw0KPiArCXByaXYtPmNtZF93cml0ZSA9IHZhci0+
Y21kX3dyaXRlOw0KPiArCXByaXYtPm9wcyA9IHZhci0+b3BzOw0KPiAgIA0KPiAtCWRldl9zZXRf
ZHJ2ZGF0YShkZXYsIHNtaSk7DQo+IC0Jc3Bpbl9sb2NrX2luaXQoJnNtaS0+bG9jayk7DQo+ICsJ
ZGV2X3NldF9kcnZkYXRhKGRldiwgcHJpdik7DQo+ICsJc3Bpbl9sb2NrX2luaXQoJnByaXYtPmxv
Y2spOw0KPiAgIA0KPiAgIAkvKiBUT0RPOiBpZiBwb3dlciBpcyBzb2Z0d2FyZSBjb250cm9sbGVk
LCBzZXQgdXAgYW55IHJlZ3VsYXRvcnMgaGVyZSAqLw0KPiAgIA0KPiAgIAkvKiBBc3NlcnQgdGhl
biBkZWFzc2VydCBSRVNFVCAqLw0KPiAtCXNtaS0+cmVzZXQgPSBkZXZtX2dwaW9kX2dldF9vcHRp
b25hbChkZXYsICJyZXNldCIsIEdQSU9EX09VVF9ISUdIKTsNCj4gLQlpZiAoSVNfRVJSKHNtaS0+
cmVzZXQpKSB7DQo+ICsJcHJpdi0+cmVzZXQgPSBkZXZtX2dwaW9kX2dldF9vcHRpb25hbChkZXYs
ICJyZXNldCIsIEdQSU9EX09VVF9ISUdIKTsNCj4gKwlpZiAoSVNfRVJSKHByaXYtPnJlc2V0KSkg
ew0KPiAgIAkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gZ2V0IFJFU0VUIEdQSU9cbiIpOw0KPiAt
CQlyZXR1cm4gUFRSX0VSUihzbWktPnJlc2V0KTsNCj4gKwkJcmV0dXJuIFBUUl9FUlIocHJpdi0+
cmVzZXQpOw0KPiAgIAl9DQo+ICAgCW1zbGVlcChSRUFMVEVLX1NNSV9IV19TVE9QX0RFTEFZKTsN
Cj4gLQlncGlvZF9zZXRfdmFsdWUoc21pLT5yZXNldCwgMCk7DQo+ICsJZ3Bpb2Rfc2V0X3ZhbHVl
KHByaXYtPnJlc2V0LCAwKTsNCj4gICAJbXNsZWVwKFJFQUxURUtfU01JX0hXX1NUQVJUX0RFTEFZ
KTsNCj4gICAJZGV2X2luZm8oZGV2LCAiZGVhc3NlcnRlZCBSRVNFVFxuIik7DQo+ICAgDQo+ICAg
CS8qIEZldGNoIE1ESU8gcGlucyAqLw0KPiAtCXNtaS0+bWRjID0gZGV2bV9ncGlvZF9nZXRfb3B0
aW9uYWwoZGV2LCAibWRjIiwgR1BJT0RfT1VUX0xPVyk7DQo+IC0JaWYgKElTX0VSUihzbWktPm1k
YykpDQo+IC0JCXJldHVybiBQVFJfRVJSKHNtaS0+bWRjKTsNCj4gLQlzbWktPm1kaW8gPSBkZXZt
X2dwaW9kX2dldF9vcHRpb25hbChkZXYsICJtZGlvIiwgR1BJT0RfT1VUX0xPVyk7DQo+IC0JaWYg
KElTX0VSUihzbWktPm1kaW8pKQ0KPiAtCQlyZXR1cm4gUFRSX0VSUihzbWktPm1kaW8pOw0KPiAr
CXByaXYtPm1kYyA9IGRldm1fZ3Bpb2RfZ2V0X29wdGlvbmFsKGRldiwgIm1kYyIsIEdQSU9EX09V
VF9MT1cpOw0KPiArCWlmIChJU19FUlIocHJpdi0+bWRjKSkNCj4gKwkJcmV0dXJuIFBUUl9FUlIo
cHJpdi0+bWRjKTsNCj4gKwlwcml2LT5tZGlvID0gZGV2bV9ncGlvZF9nZXRfb3B0aW9uYWwoZGV2
LCAibWRpbyIsIEdQSU9EX09VVF9MT1cpOw0KPiArCWlmIChJU19FUlIocHJpdi0+bWRpbykpDQo+
ICsJCXJldHVybiBQVFJfRVJSKHByaXYtPm1kaW8pOw0KPiAgIA0KPiAtCXNtaS0+bGVkc19kaXNh
YmxlZCA9IG9mX3Byb3BlcnR5X3JlYWRfYm9vbChucCwgInJlYWx0ZWssZGlzYWJsZS1sZWRzIik7
DQo+ICsJcHJpdi0+bGVkc19kaXNhYmxlZCA9IG9mX3Byb3BlcnR5X3JlYWRfYm9vbChucCwgInJl
YWx0ZWssZGlzYWJsZS1sZWRzIik7DQo+ICAgDQo+IC0JcmV0ID0gc21pLT5vcHMtPmRldGVjdChz
bWkpOw0KPiArCXJldCA9IHByaXYtPm9wcy0+ZGV0ZWN0KHByaXYpOw0KPiAgIAlpZiAocmV0KSB7
DQo+ICAgCQlkZXZfZXJyKGRldiwgInVuYWJsZSB0byBkZXRlY3Qgc3dpdGNoXG4iKTsNCj4gICAJ
CXJldHVybiByZXQ7DQo+ICAgCX0NCj4gICANCj4gLQlzbWktPmRzID0gZGV2bV9remFsbG9jKGRl
diwgc2l6ZW9mKCpzbWktPmRzKSwgR0ZQX0tFUk5FTCk7DQo+IC0JaWYgKCFzbWktPmRzKQ0KPiAr
CXByaXYtPmRzID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpwcml2LT5kcyksIEdGUF9LRVJO
RUwpOw0KPiArCWlmICghcHJpdi0+ZHMpDQo+ICAgCQlyZXR1cm4gLUVOT01FTTsNCj4gICANCj4g
LQlzbWktPmRzLT5kZXYgPSBkZXY7DQo+IC0Jc21pLT5kcy0+bnVtX3BvcnRzID0gc21pLT5udW1f
cG9ydHM7DQo+IC0Jc21pLT5kcy0+cHJpdiA9IHNtaTsNCj4gKwlwcml2LT5kcy0+ZGV2ID0gZGV2
Ow0KPiArCXByaXYtPmRzLT5udW1fcG9ydHMgPSBwcml2LT5udW1fcG9ydHM7DQo+ICsJcHJpdi0+
ZHMtPnByaXYgPSBwcml2Ow0KPiAgIA0KPiAtCXNtaS0+ZHMtPm9wcyA9IHZhci0+ZHNfb3BzOw0K
PiAtCXJldCA9IGRzYV9yZWdpc3Rlcl9zd2l0Y2goc21pLT5kcyk7DQo+ICsJcHJpdi0+ZHMtPm9w
cyA9IHZhci0+ZHNfb3BzOw0KPiArCXJldCA9IGRzYV9yZWdpc3Rlcl9zd2l0Y2gocHJpdi0+ZHMp
Ow0KPiAgIAlpZiAocmV0KSB7DQo+ICAgCQlkZXZfZXJyX3Byb2JlKGRldiwgcmV0LCAidW5hYmxl
IHRvIHJlZ2lzdGVyIHN3aXRjaFxuIik7DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiBAQCAtNDY0LDE1
ICs0NjQsMTUgQEAgc3RhdGljIGludCByZWFsdGVrX3NtaV9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgcmVhbHRla19zbWlfcmVtb3ZlKHN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpDQo+ICAgew0KPiAtCXN0cnVjdCByZWFsdGVrX3Nt
aSAqc21pID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7DQo+ICsJc3RydWN0IHJlYWx0ZWtf
cHJpdiAqcHJpdiA9IHBsYXRmb3JtX2dldF9kcnZkYXRhKHBkZXYpOw0KPiAgIA0KPiAtCWlmICgh
c21pKQ0KPiArCWlmICghcHJpdikNCj4gICAJCXJldHVybiAwOw0KPiAgIA0KPiAtCWRzYV91bnJl
Z2lzdGVyX3N3aXRjaChzbWktPmRzKTsNCj4gLQlpZiAoc21pLT5zbGF2ZV9taWlfYnVzKQ0KPiAt
CQlvZl9ub2RlX3B1dChzbWktPnNsYXZlX21paV9idXMtPmRldi5vZl9ub2RlKTsNCj4gLQlncGlv
ZF9zZXRfdmFsdWUoc21pLT5yZXNldCwgMSk7DQo+ICsJZHNhX3VucmVnaXN0ZXJfc3dpdGNoKHBy
aXYtPmRzKTsNCj4gKwlpZiAocHJpdi0+c2xhdmVfbWlpX2J1cykNCj4gKwkJb2Zfbm9kZV9wdXQo
cHJpdi0+c2xhdmVfbWlpX2J1cy0+ZGV2Lm9mX25vZGUpOw0KPiArCWdwaW9kX3NldF92YWx1ZShw
cml2LT5yZXNldCwgMSk7DQo+ICAgDQo+ICAgCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIE5V
TEwpOw0KPiAgIA0KPiBAQCAtNDgxLDEyICs0ODEsMTIgQEAgc3RhdGljIGludCByZWFsdGVrX3Nt
aV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikNCj4gICANCj4gICBzdGF0aWMg
dm9pZCByZWFsdGVrX3NtaV9zaHV0ZG93bihzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQ0K
PiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IHBsYXRmb3JtX2dldF9kcnZkYXRh
KHBkZXYpOw0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBwbGF0Zm9ybV9nZXRfZHJ2
ZGF0YShwZGV2KTsNCj4gICANCj4gLQlpZiAoIXNtaSkNCj4gKwlpZiAoIXByaXYpDQo+ICAgCQly
ZXR1cm47DQo+ICAgDQo+IC0JZHNhX3N3aXRjaF9zaHV0ZG93bihzbWktPmRzKTsNCj4gKwlkc2Ff
c3dpdGNoX3NodXRkb3duKHByaXYtPmRzKTsNCj4gICANCj4gICAJcGxhdGZvcm1fc2V0X2RydmRh
dGEocGRldiwgTlVMTCk7DQo+ICAgfQ0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZHNhL3Jl
YWx0ZWsvcmVhbHRlay1zbWktY29yZS5oIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsvcmVhbHRl
ay5oDQo+IHNpbWlsYXJpdHkgaW5kZXggNTYlDQo+IHJlbmFtZSBmcm9tIGRyaXZlcnMvbmV0L2Rz
YS9yZWFsdGVrL3JlYWx0ZWstc21pLWNvcmUuaA0KPiByZW5hbWUgdG8gZHJpdmVycy9uZXQvZHNh
L3JlYWx0ZWsvcmVhbHRlay5oDQo+IGluZGV4IDViZmE1M2UyNDgwYS4uNzY2ZTc5MTUxYTZjIDEw
MDY0NA0KPiAtLS0gYS9kcml2ZXJzL25ldC9kc2EvcmVhbHRlay9yZWFsdGVrLXNtaS1jb3JlLmgN
Cj4gKysrIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsvcmVhbHRlay5oDQo+IEBAIC0xMyw3ICsx
Myw3IEBADQo+ICAgI2luY2x1ZGUgPGxpbnV4L2dwaW8vY29uc3VtZXIuaD4NCj4gICAjaW5jbHVk
ZSA8bmV0L2RzYS5oPg0KPiAgIA0KPiAtc3RydWN0IHJlYWx0ZWtfc21pX29wczsNCj4gK3N0cnVj
dCByZWFsdGVrX29wczsNCj4gICBzdHJ1Y3QgZGVudHJ5Ow0KPiAgIHN0cnVjdCBpbm9kZTsNCj4g
ICBzdHJ1Y3QgZmlsZTsNCj4gQEAgLTQzLDcgKzQzLDcgQEAgc3RydWN0IHJ0bDgzNjZfdmxhbl80
ayB7DQo+ICAgCXU4CWZpZDsNCj4gICB9Ow0KPiAgIA0KPiAtc3RydWN0IHJlYWx0ZWtfc21pIHsN
Cj4gK3N0cnVjdCByZWFsdGVrX3ByaXYgew0KPiAgIAlzdHJ1Y3QgZGV2aWNlCQkqZGV2Ow0KPiAg
IAlzdHJ1Y3QgZ3Bpb19kZXNjCSpyZXNldDsNCj4gICAJc3RydWN0IGdwaW9fZGVzYwkqbWRjOw0K
PiBAQCAtNjUsNyArNjUsOSBAQCBzdHJ1Y3QgcmVhbHRla19zbWkgew0KPiAgIAl1bnNpZ25lZCBp
bnQJCW51bV9taWJfY291bnRlcnM7DQo+ICAgCXN0cnVjdCBydGw4MzY2X21pYl9jb3VudGVyICpt
aWJfY291bnRlcnM7DQo+ICAgDQo+IC0JY29uc3Qgc3RydWN0IHJlYWx0ZWtfc21pX29wcyAqb3Bz
Ow0KPiArCWNvbnN0IHN0cnVjdCByZWFsdGVrX29wcyAqb3BzOw0KPiArCWludCAJCSAJKCpzZXR1
cF9pbnRlcmZhY2UpKHN0cnVjdCBkc2Ffc3dpdGNoICpkcyk7DQo+ICsJaW50IAkJCSgqd3JpdGVf
cmVnX25vYWNrKShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCB1MzIgYWRkciwgdTMyIGRhdGEp
Ow0KPiAgIA0KPiAgIAlpbnQJCQl2bGFuX2VuYWJsZWQ7DQo+ICAgCWludAkJCXZsYW40a19lbmFi
bGVkOw0KPiBAQCAtNzUsNjAgKzc3LDU1IEBAIHN0cnVjdCByZWFsdGVrX3NtaSB7DQo+ICAgfTsN
Cj4gICANCj4gICAvKioNCj4gLSAqIHN0cnVjdCByZWFsdGVrX3NtaV9vcHMgLSB2dGFibGUgZm9y
IHRoZSBwZXItU01JLWNoaXB0eXBlIG9wZXJhdGlvbnMNCj4gKyAqIHN0cnVjdCByZWFsdGVrX29w
cyAtIHZ0YWJsZSBmb3IgdGhlIHBlci1TTUktY2hpcHR5cGUgb3BlcmF0aW9ucw0KPiAgICAqIEBk
ZXRlY3Q6IGRldGVjdHMgdGhlIGNoaXB0eXBlDQo+ICAgICovDQo+IC1zdHJ1Y3QgcmVhbHRla19z
bWlfb3BzIHsNCj4gLQlpbnQJKCpkZXRlY3QpKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKTsNCj4g
LQlpbnQJKCpyZXNldF9jaGlwKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSk7DQo+IC0JaW50CSgq
c2V0dXApKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKTsNCj4gLQl2b2lkCSgqY2xlYW51cCkoc3Ry
dWN0IHJlYWx0ZWtfc21pICpzbWkpOw0KPiAtCWludAkoKmdldF9taWJfY291bnRlcikoc3RydWN0
IHJlYWx0ZWtfc21pICpzbWksDQo+ICtzdHJ1Y3QgcmVhbHRla19vcHMgew0KPiArCWludAkoKmRl
dGVjdCkoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdik7DQo+ICsJaW50CSgqcmVzZXRfY2hpcCko
c3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdik7DQo+ICsJaW50CSgqc2V0dXApKHN0cnVjdCByZWFs
dGVrX3ByaXYgKnByaXYpOw0KPiArCXZvaWQJKCpjbGVhbnVwKShzdHJ1Y3QgcmVhbHRla19wcml2
ICpwcml2KTsNCj4gKwlpbnQJKCpnZXRfbWliX2NvdW50ZXIpKHN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYsDQo+ICAgCQkJCSAgIGludCBwb3J0LA0KPiAgIAkJCQkgICBzdHJ1Y3QgcnRsODM2Nl9t
aWJfY291bnRlciAqbWliLA0KPiAgIAkJCQkgICB1NjQgKm1pYnZhbHVlKTsNCj4gLQlpbnQJKCpn
ZXRfdmxhbl9tYykoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHUzMiBpbmRleCwNCj4gKwlpbnQJ
KCpnZXRfdmxhbl9tYykoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgdTMyIGluZGV4LA0KPiAg
IAkJCSAgICAgICBzdHJ1Y3QgcnRsODM2Nl92bGFuX21jICp2bGFubWMpOw0KPiAtCWludAkoKnNl
dF92bGFuX21jKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTMyIGluZGV4LA0KPiArCWludAko
KnNldF92bGFuX21jKShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCB1MzIgaW5kZXgsDQo+ICAg
CQkJICAgICAgIGNvbnN0IHN0cnVjdCBydGw4MzY2X3ZsYW5fbWMgKnZsYW5tYyk7DQo+IC0JaW50
CSgqZ2V0X3ZsYW5fNGspKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCB1MzIgdmlkLA0KPiArCWlu
dAkoKmdldF92bGFuXzRrKShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCB1MzIgdmlkLA0KPiAg
IAkJCSAgICAgICBzdHJ1Y3QgcnRsODM2Nl92bGFuXzRrICp2bGFuNGspOw0KPiAtCWludAkoKnNl
dF92bGFuXzRrKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwNCj4gKwlpbnQJKCpzZXRfdmxhbl80
aykoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwNCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0
IHJ0bDgzNjZfdmxhbl80ayAqdmxhbjRrKTsNCj4gLQlpbnQJKCpnZXRfbWNfaW5kZXgpKHN0cnVj
dCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwgaW50ICp2YWwpOw0KPiAtCWludAkoKnNldF9t
Y19pbmRleCkoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwb3J0LCBpbnQgaW5kZXgpOw0K
PiAtCWJvb2wJKCppc192bGFuX3ZhbGlkKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdW5zaWdu
ZWQgaW50IHZsYW4pOw0KPiAtCWludAkoKmVuYWJsZV92bGFuKShzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSwgYm9vbCBlbmFibGUpOw0KPiAtCWludAkoKmVuYWJsZV92bGFuNGspKHN0cnVjdCByZWFs
dGVrX3NtaSAqc21pLCBib29sIGVuYWJsZSk7DQo+IC0JaW50CSgqZW5hYmxlX3BvcnQpKHN0cnVj
dCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwgYm9vbCBlbmFibGUpOw0KPiAtCWludAkoKnBo
eV9yZWFkKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwgaW50IHJlZ251bSk7DQo+
IC0JaW50CSgqcGh5X3dyaXRlKShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwgaW50
IHJlZ251bSwNCj4gKwlpbnQJKCpnZXRfbWNfaW5kZXgpKHN0cnVjdCByZWFsdGVrX3ByaXYgKnBy
aXYsIGludCBwb3J0LCBpbnQgKnZhbCk7DQo+ICsJaW50CSgqc2V0X21jX2luZGV4KShzdHJ1Y3Qg
cmVhbHRla19wcml2ICpwcml2LCBpbnQgcG9ydCwgaW50IGluZGV4KTsNCj4gKwlib29sCSgqaXNf
dmxhbl92YWxpZCkoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgdW5zaWduZWQgaW50IHZsYW4p
Ow0KPiArCWludAkoKmVuYWJsZV92bGFuKShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBib29s
IGVuYWJsZSk7DQo+ICsJaW50CSgqZW5hYmxlX3ZsYW40aykoc3RydWN0IHJlYWx0ZWtfcHJpdiAq
cHJpdiwgYm9vbCBlbmFibGUpOw0KPiArCWludAkoKmVuYWJsZV9wb3J0KShzdHJ1Y3QgcmVhbHRl
a19wcml2ICpwcml2LCBpbnQgcG9ydCwgYm9vbCBlbmFibGUpOw0KPiArCWludAkoKnBoeV9yZWFk
KShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBpbnQgcGh5LCBpbnQgcmVnbnVtKTsNCj4gKwlp
bnQJKCpwaHlfd3JpdGUpKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIGludCBwaHksIGludCBy
ZWdudW0sDQo+ICAgCQkJICAgICB1MTYgdmFsKTsNCj4gICB9Ow0KPiAgIA0KPiAtc3RydWN0IHJl
YWx0ZWtfc21pX3ZhcmlhbnQgew0KPiArc3RydWN0IHJlYWx0ZWtfdmFyaWFudCB7DQo+ICAgCWNv
bnN0IHN0cnVjdCBkc2Ffc3dpdGNoX29wcyAqZHNfb3BzOw0KPiAtCWNvbnN0IHN0cnVjdCByZWFs
dGVrX3NtaV9vcHMgKm9wczsNCj4gKwljb25zdCBzdHJ1Y3QgcmVhbHRla19vcHMgKm9wczsNCj4g
ICAJdW5zaWduZWQgaW50IGNsa19kZWxheTsNCj4gICAJdTggY21kX3JlYWQ7DQo+ICAgCXU4IGNt
ZF93cml0ZTsNCj4gICAJc2l6ZV90IGNoaXBfZGF0YV9zejsNCj4gICB9Ow0KPiAgIA0KPiAtLyog
U01JIGNvcmUgY2FsbHMgKi8NCj4gLWludCByZWFsdGVrX3NtaV93cml0ZV9yZWdfbm9hY2soc3Ry
dWN0IHJlYWx0ZWtfc21pICpzbWksIHUzMiBhZGRyLA0KPiAtCQkJCXUzMiBkYXRhKTsNCj4gLWlu
dCByZWFsdGVrX3NtaV9zZXR1cF9tZGlvKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKTsNCj4gLQ0K
PiAgIC8qIFJUTDgzNjYgbGlicmFyeSBoZWxwZXJzICovDQo+IC1pbnQgcnRsODM2Nl9tY19pc191
c2VkKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgbWNfaW5kZXgsIGludCAqdXNlZCk7DQo+
IC1pbnQgcnRsODM2Nl9zZXRfdmxhbihzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHZpZCwg
dTMyIG1lbWJlciwNCj4gK2ludCBydGw4MzY2X21jX2lzX3VzZWQoc3RydWN0IHJlYWx0ZWtfcHJp
diAqcHJpdiwgaW50IG1jX2luZGV4LCBpbnQgKnVzZWQpOw0KPiAraW50IHJ0bDgzNjZfc2V0X3Zs
YW4oc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgaW50IHZpZCwgdTMyIG1lbWJlciwNCj4gICAJ
CSAgICAgdTMyIHVudGFnLCB1MzIgZmlkKTsNCj4gLWludCBydGw4MzY2X3NldF9wdmlkKHN0cnVj
dCByZWFsdGVrX3NtaSAqc21pLCB1bnNpZ25lZCBpbnQgcG9ydCwNCj4gK2ludCBydGw4MzY2X3Nl
dF9wdmlkKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIHVuc2lnbmVkIGludCBwb3J0LA0KPiAg
IAkJICAgICB1bnNpZ25lZCBpbnQgdmlkKTsNCj4gLWludCBydGw4MzY2X2VuYWJsZV92bGFuNGso
c3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGJvb2wgZW5hYmxlKTsNCj4gLWludCBydGw4MzY2X2Vu
YWJsZV92bGFuKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBib29sIGVuYWJsZSk7DQo+IC1pbnQg
cnRsODM2Nl9yZXNldF92bGFuKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKTsNCj4gK2ludCBydGw4
MzY2X2VuYWJsZV92bGFuNGsoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgYm9vbCBlbmFibGUp
Ow0KPiAraW50IHJ0bDgzNjZfZW5hYmxlX3ZsYW4oc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwg
Ym9vbCBlbmFibGUpOw0KPiAraW50IHJ0bDgzNjZfcmVzZXRfdmxhbihzdHJ1Y3QgcmVhbHRla19w
cml2ICpwcml2KTsNCj4gICBpbnQgcnRsODM2Nl92bGFuX2FkZChzdHJ1Y3QgZHNhX3N3aXRjaCAq
ZHMsIGludCBwb3J0LA0KPiAgIAkJICAgICBjb25zdCBzdHJ1Y3Qgc3dpdGNoZGV2X29ial9wb3J0
X3ZsYW4gKnZsYW4sDQo+ICAgCQkgICAgIHN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjayk7
DQo+IEBAIC0xMzksNyArMTM2LDcgQEAgdm9pZCBydGw4MzY2X2dldF9zdHJpbmdzKHN0cnVjdCBk
c2Ffc3dpdGNoICpkcywgaW50IHBvcnQsIHUzMiBzdHJpbmdzZXQsDQo+ICAgaW50IHJ0bDgzNjZf
Z2V0X3NzZXRfY291bnQoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwgaW50IHNzZXQp
Ow0KPiAgIHZvaWQgcnRsODM2Nl9nZXRfZXRodG9vbF9zdGF0cyhzdHJ1Y3QgZHNhX3N3aXRjaCAq
ZHMsIGludCBwb3J0LCB1aW50NjRfdCAqZGF0YSk7DQo+ICAgDQo+IC1leHRlcm4gY29uc3Qgc3Ry
dWN0IHJlYWx0ZWtfc21pX3ZhcmlhbnQgcnRsODM2NnJiX3ZhcmlhbnQ7DQo+IC1leHRlcm4gY29u
c3Qgc3RydWN0IHJlYWx0ZWtfc21pX3ZhcmlhbnQgcnRsODM2NW1iX3ZhcmlhbnQ7DQo+ICtleHRl
cm4gY29uc3Qgc3RydWN0IHJlYWx0ZWtfdmFyaWFudCBydGw4MzY2cmJfdmFyaWFudDsNCj4gK2V4
dGVybiBjb25zdCBzdHJ1Y3QgcmVhbHRla192YXJpYW50IHJ0bDgzNjVtYl92YXJpYW50Ow0KPiAg
IA0KPiAgICNlbmRpZiAvKiAgX1JFQUxURUtfU01JX0ggKi8NCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjVtYi5jIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsv
cnRsODM2NW1iLmMNCj4gaW5kZXggM2I3Mjk1NDQ3OThiLi5mNTYyYTZlZmI1NzQgMTAwNjQ0DQo+
IC0tLSBhL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjVtYi5jDQo+ICsrKyBiL2RyaXZl
cnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjVtYi5jDQo+IEBAIC05OSw3ICs5OSw3IEBADQo+ICAg
I2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPg0KPiAgICNpbmNsdWRlIDxsaW51eC9pZl9icmlkZ2Uu
aD4NCj4gICANCj4gLSNpbmNsdWRlICJyZWFsdGVrLXNtaS1jb3JlLmgiDQo+ICsjaW5jbHVkZSAi
cmVhbHRlay5oIg0KPiAgIA0KPiAgIC8qIENoaXAtc3BlY2lmaWMgZGF0YSBhbmQgbGltaXRzICov
DQo+ICAgI2RlZmluZSBSVEw4MzY1TUJfQ0hJUF9JRF84MzY1TUJfVkMJCTB4NjM2Nw0KPiBAQCAt
NTE2LDcgKzUxNiw3IEBAIHN0cnVjdCBydGw4MzY1bWJfY3B1IHsNCj4gICANCj4gICAvKioNCj4g
ICAgKiBzdHJ1Y3QgcnRsODM2NW1iX3BvcnQgLSBwcml2YXRlIHBlci1wb3J0IGRhdGENCj4gLSAq
IEBzbWk6IHBvaW50ZXIgdG8gcGFyZW50IHJlYWx0ZWtfc21pIGRhdGENCj4gKyAqIEBwcml2OiBw
b2ludGVyIHRvIHBhcmVudCByZWFsdGVrX3ByaXYgZGF0YQ0KPiAgICAqIEBpbmRleDogRFNBIHBv
cnQgaW5kZXgsIHNhbWUgYXMgZHNhX3BvcnQ6OmluZGV4DQo+ICAgICogQHN0YXRzOiBsaW5rIHN0
YXRpc3RpY3MgcG9wdWxhdGVkIGJ5IHJ0bDgzNjVtYl9zdGF0c19wb2xsLCByZWFkeSBmb3IgYXRv
bWljDQo+ICAgICogICAgICAgICBhY2Nlc3MgdmlhIHJ0bDgzNjVtYl9nZXRfc3RhdHM2NA0KPiBA
QCAtNTI0LDcgKzUyNCw3IEBAIHN0cnVjdCBydGw4MzY1bWJfY3B1IHsNCj4gICAgKiBAbWliX3dv
cms6IGRlbGF5ZWQgd29yayBmb3IgcG9sbGluZyBNSUIgY291bnRlcnMNCj4gICAgKi8NCj4gICBz
dHJ1Y3QgcnRsODM2NW1iX3BvcnQgew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pOw0KPiAr
CXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXY7DQo+ICAgCXVuc2lnbmVkIGludCBpbmRleDsNCj4g
ICAJc3RydWN0IHJ0bmxfbGlua19zdGF0czY0IHN0YXRzOw0KPiAgIAlzcGlubG9ja190IHN0YXRz
X2xvY2s7DQo+IEBAIC01MzMsNyArNTMzLDcgQEAgc3RydWN0IHJ0bDgzNjVtYl9wb3J0IHsNCj4g
ICANCj4gICAvKioNCj4gICAgKiBzdHJ1Y3QgcnRsODM2NW1iIC0gcHJpdmF0ZSBjaGlwLXNwZWNp
ZmljIGRyaXZlciBkYXRhDQo+IC0gKiBAc21pOiBwb2ludGVyIHRvIHBhcmVudCByZWFsdGVrX3Nt
aSBkYXRhDQo+ICsgKiBAcHJpdjogcG9pbnRlciB0byBwYXJlbnQgcmVhbHRla19wcml2IGRhdGEN
Cj4gICAgKiBAaXJxOiByZWdpc3RlcmVkIElSUSBvciB6ZXJvDQo+ICAgICogQGNoaXBfaWQ6IGNo
aXAgaWRlbnRpZmllcg0KPiAgICAqIEBjaGlwX3ZlcjogY2hpcCBzaWxpY29uIHJldmlzaW9uDQo+
IEBAIC01NDgsNyArNTQ4LDcgQEAgc3RydWN0IHJ0bDgzNjVtYl9wb3J0IHsNCj4gICAgKiBQcml2
YXRlIGRhdGEgZm9yIHRoaXMgZHJpdmVyLg0KPiAgICAqLw0KPiAgIHN0cnVjdCBydGw4MzY1bWIg
ew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pOw0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXY7DQo+ICAgCWludCBpcnE7DQo+ICAgCXUzMiBjaGlwX2lkOw0KPiAgIAl1MzIgY2hpcF92
ZXI7DQo+IEBAIC01NjEsMTYgKzU2MSwxNiBAQCBzdHJ1Y3QgcnRsODM2NW1iIHsNCj4gICAJc2l6
ZV90IGphbV9zaXplOw0KPiAgIH07DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjVtYl9waHlf
cG9sbF9idXN5KHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiArc3RhdGljIGludCBydGw4MzY1
bWJfcGh5X3BvbGxfYnVzeShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gICAJ
dTMyIHZhbDsNCj4gICANCj4gLQlyZXR1cm4gcmVnbWFwX3JlYWRfcG9sbF90aW1lb3V0KHNtaS0+
bWFwLA0KPiArCXJldHVybiByZWdtYXBfcmVhZF9wb2xsX3RpbWVvdXQocHJpdi0+bWFwLA0KPiAg
IAkJCQkJUlRMODM2NU1CX0lORElSRUNUX0FDQ0VTU19TVEFUVVNfUkVHLA0KPiAgIAkJCQkJdmFs
LCAhdmFsLCAxMCwgMTAwKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjVtYl9w
aHlfb2NwX3ByZXBhcmUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwaHksDQo+ICtzdGF0
aWMgaW50IHJ0bDgzNjVtYl9waHlfb2NwX3ByZXBhcmUoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJp
diwgaW50IHBoeSwNCj4gICAJCQkJICAgICB1MzIgb2NwX2FkZHIpDQo+ICAgew0KPiAgIAl1MzIg
dmFsOw0KPiBAQCAtNTc5LDcgKzU3OSw3IEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX3BoeV9vY3Bf
cHJlcGFyZShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwNCj4gICAJLyogU2V0IE9D
UCBwcmVmaXggKi8NCj4gICAJdmFsID0gRklFTERfR0VUKFJUTDgzNjVNQl9QSFlfT0NQX0FERFJf
UFJFRklYX01BU0ssIG9jcF9hZGRyKTsNCj4gICAJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKA0K
PiAtCQlzbWktPm1hcCwgUlRMODM2NU1CX0dQSFlfT0NQX01TQl8wX1JFRywNCj4gKwkJcHJpdi0+
bWFwLCBSVEw4MzY1TUJfR1BIWV9PQ1BfTVNCXzBfUkVHLA0KPiAgIAkJUlRMODM2NU1CX0dQSFlf
T0NQX01TQl8wX0NGR19DUFVfT0NQQURSX01BU0ssDQo+ICAgCQlGSUVMRF9QUkVQKFJUTDgzNjVN
Ql9HUEhZX09DUF9NU0JfMF9DRkdfQ1BVX09DUEFEUl9NQVNLLCB2YWwpKTsNCj4gICAJaWYgKHJl
dCkNCj4gQEAgLTU5Miw3ICs1OTIsNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9waHlfb2NwX3By
ZXBhcmUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwaHksDQo+ICAgCQkJICBvY3BfYWRk
ciA+PiAxKTsNCj4gICAJdmFsIHw9IEZJRUxEX1BSRVAoUlRMODM2NU1CX0lORElSRUNUX0FDQ0VT
U19BRERSRVNTX09DUEFEUl85XzZfTUFTSywNCj4gICAJCQkgIG9jcF9hZGRyID4+IDYpOw0KPiAt
CXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgUlRMODM2NU1CX0lORElSRUNUX0FDQ0VTU19B
RERSRVNTX1JFRywNCj4gKwlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY1TUJf
SU5ESVJFQ1RfQUNDRVNTX0FERFJFU1NfUkVHLA0KPiAgIAkJCSAgIHZhbCk7DQo+ICAgCWlmIChy
ZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiBAQCAtNjAwLDE3ICs2MDAsMTcgQEAgc3RhdGljIGlu
dCBydGw4MzY1bWJfcGh5X29jcF9wcmVwYXJlKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQg
cGh5LA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjVt
Yl9waHlfb2NwX3JlYWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwaHksDQo+ICtzdGF0
aWMgaW50IHJ0bDgzNjVtYl9waHlfb2NwX3JlYWQoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwg
aW50IHBoeSwNCj4gICAJCQkJICB1MzIgb2NwX2FkZHIsIHUxNiAqZGF0YSkNCj4gICB7DQo+ICAg
CXUzMiB2YWw7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2NW1iX3BoeV9w
b2xsX2J1c3koc21pKTsNCj4gKwlyZXQgPSBydGw4MzY1bWJfcGh5X3BvbGxfYnVzeShwcml2KTsN
Cj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2
NW1iX3BoeV9vY3BfcHJlcGFyZShzbWksIHBoeSwgb2NwX2FkZHIpOw0KPiArCXJldCA9IHJ0bDgz
NjVtYl9waHlfb2NwX3ByZXBhcmUocHJpdiwgcGh5LCBvY3BfYWRkcik7DQo+ICAgCWlmIChyZXQp
DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAtNjE5LDE2ICs2MTksMTYgQEAgc3RhdGlj
IGludCBydGw4MzY1bWJfcGh5X29jcF9yZWFkKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQg
cGh5LA0KPiAgIAkJCSBSVEw4MzY1TUJfSU5ESVJFQ1RfQUNDRVNTX0NUUkxfQ01EX1ZBTFVFKSB8
DQo+ICAgCSAgICAgIEZJRUxEX1BSRVAoUlRMODM2NU1CX0lORElSRUNUX0FDQ0VTU19DVFJMX1JX
X01BU0ssDQo+ICAgCQkJIFJUTDgzNjVNQl9JTkRJUkVDVF9BQ0NFU1NfQ1RSTF9SV19SRUFEKTsN
Cj4gLQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIFJUTDgzNjVNQl9JTkRJUkVDVF9BQ0NF
U1NfQ1RSTF9SRUcsIHZhbCk7DQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRM
ODM2NU1CX0lORElSRUNUX0FDQ0VTU19DVFJMX1JFRywgdmFsKTsNCj4gICAJaWYgKHJldCkNCj4g
ICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2NW1iX3BoeV9wb2xsX2J1c3ko
c21pKTsNCj4gKwlyZXQgPSBydGw4MzY1bWJfcGh5X3BvbGxfYnVzeShwcml2KTsNCj4gICAJaWYg
KHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCS8qIEdldCBQSFkgcmVnaXN0ZXIg
ZGF0YSAqLw0KPiAtCXJldCA9IHJlZ21hcF9yZWFkKHNtaS0+bWFwLCBSVEw4MzY1TUJfSU5ESVJF
Q1RfQUNDRVNTX1JFQURfREFUQV9SRUcsDQo+ICsJcmV0ID0gcmVnbWFwX3JlYWQocHJpdi0+bWFw
LCBSVEw4MzY1TUJfSU5ESVJFQ1RfQUNDRVNTX1JFQURfREFUQV9SRUcsDQo+ICAgCQkJICAmdmFs
KTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+IEBAIC02MzgsMjIgKzYzOCwy
MiBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9waHlfb2NwX3JlYWQoc3RydWN0IHJlYWx0ZWtfc21p
ICpzbWksIGludCBwaHksDQo+ICAgCXJldHVybiAwOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBp
bnQgcnRsODM2NW1iX3BoeV9vY3Bfd3JpdGUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBw
aHksDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9waHlfb2NwX3dyaXRlKHN0cnVjdCByZWFsdGVr
X3ByaXYgKnByaXYsIGludCBwaHksDQo+ICAgCQkJCSAgIHUzMiBvY3BfYWRkciwgdTE2IGRhdGEp
DQo+ICAgew0KPiAgIAl1MzIgdmFsOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAtCXJldCA9IHJ0
bDgzNjVtYl9waHlfcG9sbF9idXN5KHNtaSk7DQo+ICsJcmV0ID0gcnRsODM2NW1iX3BoeV9wb2xs
X2J1c3kocHJpdik7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAt
CXJldCA9IHJ0bDgzNjVtYl9waHlfb2NwX3ByZXBhcmUoc21pLCBwaHksIG9jcF9hZGRyKTsNCj4g
KwlyZXQgPSBydGw4MzY1bWJfcGh5X29jcF9wcmVwYXJlKHByaXYsIHBoeSwgb2NwX2FkZHIpOw0K
PiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJLyogU2V0IFBIWSBy
ZWdpc3RlciBkYXRhICovDQo+IC0JcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+bWFwLCBSVEw4MzY1
TUJfSU5ESVJFQ1RfQUNDRVNTX1dSSVRFX0RBVEFfUkVHLA0KPiArCXJldCA9IHJlZ21hcF93cml0
ZShwcml2LT5tYXAsIFJUTDgzNjVNQl9JTkRJUkVDVF9BQ0NFU1NfV1JJVEVfREFUQV9SRUcsDQo+
ICAgCQkJICAgZGF0YSk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiBAQCAt
NjYzLDE4ICs2NjMsMTggQEAgc3RhdGljIGludCBydGw4MzY1bWJfcGh5X29jcF93cml0ZShzdHJ1
Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwNCj4gICAJCQkgUlRMODM2NU1CX0lORElSRUNU
X0FDQ0VTU19DVFJMX0NNRF9WQUxVRSkgfA0KPiAgIAkgICAgICBGSUVMRF9QUkVQKFJUTDgzNjVN
Ql9JTkRJUkVDVF9BQ0NFU1NfQ1RSTF9SV19NQVNLLA0KPiAgIAkJCSBSVEw4MzY1TUJfSU5ESVJF
Q1RfQUNDRVNTX0NUUkxfUldfV1JJVEUpOw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1h
cCwgUlRMODM2NU1CX0lORElSRUNUX0FDQ0VTU19DVFJMX1JFRywgdmFsKTsNCj4gKwlyZXQgPSBy
ZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY1TUJfSU5ESVJFQ1RfQUNDRVNTX0NUUkxfUkVH
LCB2YWwpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gLQlyZXQg
PSBydGw4MzY1bWJfcGh5X3BvbGxfYnVzeShzbWkpOw0KPiArCXJldCA9IHJ0bDgzNjVtYl9waHlf
cG9sbF9idXN5KHByaXYpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICAN
Cj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY1bWJfcGh5
X3JlYWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwaHksIGludCByZWdudW0pDQo+ICtz
dGF0aWMgaW50IHJ0bDgzNjVtYl9waHlfcmVhZChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBp
bnQgcGh5LCBpbnQgcmVnbnVtKQ0KPiAgIHsNCj4gICAJdTMyIG9jcF9hZGRyOw0KPiAgIAl1MTYg
dmFsOw0KPiBAQCAtNjg4LDIxICs2ODgsMjEgQEAgc3RhdGljIGludCBydGw4MzY1bWJfcGh5X3Jl
YWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwaHksIGludCByZWdudW0pDQo+ICAgDQo+
ICAgCW9jcF9hZGRyID0gUlRMODM2NU1CX1BIWV9PQ1BfQUREUl9QSFlSRUdfQkFTRSArIHJlZ251
bSAqIDI7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2NW1iX3BoeV9vY3BfcmVhZChzbWksIHBoeSwg
b2NwX2FkZHIsICZ2YWwpOw0KPiArCXJldCA9IHJ0bDgzNjVtYl9waHlfb2NwX3JlYWQocHJpdiwg
cGh5LCBvY3BfYWRkciwgJnZhbCk7DQo+ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2X2VycihzbWkt
PmRldiwNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsDQo+ICAgCQkJImZhaWxlZCB0byByZWFkIFBI
WSVkIHJlZyAlMDJ4IEAgJTA0eCwgcmV0ICVkXG4iLCBwaHksDQo+ICAgCQkJcmVnbnVtLCBvY3Bf
YWRkciwgcmV0KTsNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgCX0NCj4gICANCj4gLQlkZXZfZGJn
KHNtaS0+ZGV2LCAicmVhZCBQSFklZCByZWdpc3RlciAweCUwMnggQCAlMDR4LCB2YWwgPC0gJTA0
eFxuIiwNCj4gKwlkZXZfZGJnKHByaXYtPmRldiwgInJlYWQgUEhZJWQgcmVnaXN0ZXIgMHglMDJ4
IEAgJTA0eCwgdmFsIDwtICUwNHhcbiIsDQo+ICAgCQlwaHksIHJlZ251bSwgb2NwX2FkZHIsIHZh
bCk7DQo+ICAgDQo+ICAgCXJldHVybiB2YWw7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBy
dGw4MzY1bWJfcGh5X3dyaXRlKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcGh5LCBpbnQg
cmVnbnVtLA0KPiArc3RhdGljIGludCBydGw4MzY1bWJfcGh5X3dyaXRlKHN0cnVjdCByZWFsdGVr
X3ByaXYgKnByaXYsIGludCBwaHksIGludCByZWdudW0sDQo+ICAgCQkJICAgICAgIHUxNiB2YWwp
DQo+ICAgew0KPiAgIAl1MzIgb2NwX2FkZHI7DQo+IEBAIC03MTYsMTUgKzcxNiwxNSBAQCBzdGF0
aWMgaW50IHJ0bDgzNjVtYl9waHlfd3JpdGUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBw
aHksIGludCByZWdudW0sDQo+ICAgDQo+ICAgCW9jcF9hZGRyID0gUlRMODM2NU1CX1BIWV9PQ1Bf
QUREUl9QSFlSRUdfQkFTRSArIHJlZ251bSAqIDI7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2NW1i
X3BoeV9vY3Bfd3JpdGUoc21pLCBwaHksIG9jcF9hZGRyLCB2YWwpOw0KPiArCXJldCA9IHJ0bDgz
NjVtYl9waHlfb2NwX3dyaXRlKHByaXYsIHBoeSwgb2NwX2FkZHIsIHZhbCk7DQo+ICAgCWlmIChy
ZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsDQo+
ICAgCQkJImZhaWxlZCB0byB3cml0ZSBQSFklZCByZWcgJTAyeCBAICUwNHgsIHJldCAlZFxuIiwg
cGh5LA0KPiAgIAkJCXJlZ251bSwgb2NwX2FkZHIsIHJldCk7DQo+ICAgCQlyZXR1cm4gcmV0Ow0K
PiAgIAl9DQo+ICAgDQo+IC0JZGV2X2RiZyhzbWktPmRldiwgIndyaXRlIFBIWSVkIHJlZ2lzdGVy
IDB4JTAyeCBAICUwNHgsIHZhbCAtPiAlMDR4XG4iLA0KPiArCWRldl9kYmcocHJpdi0+ZGV2LCAi
d3JpdGUgUEhZJWQgcmVnaXN0ZXIgMHglMDJ4IEAgJTA0eCwgdmFsIC0+ICUwNHhcbiIsDQo+ICAg
CQlwaHksIHJlZ251bSwgb2NwX2FkZHIsIHZhbCk7DQo+ICAgDQo+ICAgCXJldHVybiAwOw0KPiBA
QCAtNzM3LDcgKzczNyw3IEBAIHJ0bDgzNjVtYl9nZXRfdGFnX3Byb3RvY29sKHN0cnVjdCBkc2Ff
c3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgCXJldHVybiBEU0FfVEFHX1BST1RPX1JUTDhfNDsN
Cj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjVtYl9leHRfY29uZmlnX3JnbWlpKHN0
cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwNCj4gK3N0YXRpYyBpbnQgcnRsODM2NW1i
X2V4dF9jb25maWdfcmdtaWkoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgaW50IHBvcnQsDQo+
ICAgCQkJCSAgICAgIHBoeV9pbnRlcmZhY2VfdCBpbnRlcmZhY2UpDQo+ICAgew0KPiAgIAlzdHJ1
Y3QgZGV2aWNlX25vZGUgKmRuOw0KPiBAQCAtNzQ4LDE0ICs3NDgsMTQgQEAgc3RhdGljIGludCBy
dGw4MzY1bWJfZXh0X2NvbmZpZ19yZ21paShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBv
cnQsDQo+ICAgCXUzMiB2YWw7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+IC0JaWYgKHBvcnQgPT0g
c21pLT5jcHVfcG9ydCkgew0KPiArCWlmIChwb3J0ID09IHByaXYtPmNwdV9wb3J0KSB7DQo+ICAg
CQlleHRfcG9ydCA9IDE7DQo+ICAgCX0gZWxzZSB7DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJv
bmx5IG9uZSBFWFQgcG9ydCBpcyBjdXJyZW50bHkgc3VwcG9ydGVkXG4iKTsNCj4gKwkJZGV2X2Vy
cihwcml2LT5kZXYsICJvbmx5IG9uZSBFWFQgcG9ydCBpcyBjdXJyZW50bHkgc3VwcG9ydGVkXG4i
KTsNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAgIAl9DQo+ICAgDQo+IC0JZHAgPSBkc2FfdG9f
cG9ydChzbWktPmRzLCBwb3J0KTsNCj4gKwlkcCA9IGRzYV90b19wb3J0KHByaXYtPmRzLCBwb3J0
KTsNCj4gICAJZG4gPSBkcC0+ZG47DQo+ICAgDQo+ICAgCS8qIFNldCB0aGUgUkdNSUkgVFgvUlgg
ZGVsYXkNCj4gQEAgLTc4Niw3ICs3ODYsNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9leHRfY29u
ZmlnX3JnbWlpKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwNCj4gICAJCWlmICh2
YWwgPT0gMCB8fCB2YWwgPT0gMikNCj4gICAJCQl0eF9kZWxheSA9IHZhbCAvIDI7DQo+ICAgCQll
bHNlDQo+IC0JCQlkZXZfd2FybihzbWktPmRldiwNCj4gKwkJCWRldl93YXJuKHByaXYtPmRldiwN
Cj4gICAJCQkJICJFWFQgcG9ydCBUWCBkZWxheSBtdXN0IGJlIDAgb3IgMiBuc1xuIik7DQo+ICAg
CX0NCj4gICANCj4gQEAgLTc5NiwxMiArNzk2LDEyIEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX2V4
dF9jb25maWdfcmdtaWkoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwb3J0LA0KPiAgIAkJ
aWYgKHZhbCA8PSA3KQ0KPiAgIAkJCXJ4X2RlbGF5ID0gdmFsOw0KPiAgIAkJZWxzZQ0KPiAtCQkJ
ZGV2X3dhcm4oc21pLT5kZXYsDQo+ICsJCQlkZXZfd2Fybihwcml2LT5kZXYsDQo+ICAgCQkJCSAi
RVhUIHBvcnQgUlggZGVsYXkgbXVzdCBiZSAwIHRvIDIuMSBuc1xuIik7DQo+ICAgCX0NCj4gICAN
Cj4gICAJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKA0KPiAtCQlzbWktPm1hcCwgUlRMODM2NU1C
X0VYVF9SR01YRl9SRUcoZXh0X3BvcnQpLA0KPiArCQlwcml2LT5tYXAsIFJUTDgzNjVNQl9FWFRf
UkdNWEZfUkVHKGV4dF9wb3J0KSwNCj4gICAJCVJUTDgzNjVNQl9FWFRfUkdNWEZfVFhERUxBWV9N
QVNLIHwNCj4gICAJCQlSVEw4MzY1TUJfRVhUX1JHTVhGX1JYREVMQVlfTUFTSywNCj4gICAJCUZJ
RUxEX1BSRVAoUlRMODM2NU1CX0VYVF9SR01YRl9UWERFTEFZX01BU0ssIHR4X2RlbGF5KSB8DQo+
IEBAIC04MTAsNyArODEwLDcgQEAgc3RhdGljIGludCBydGw4MzY1bWJfZXh0X2NvbmZpZ19yZ21p
aShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBvcnQsDQo+ICAgCQlyZXR1cm4gcmV0Ow0K
PiAgIA0KPiAgIAlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoDQo+IC0JCXNtaS0+bWFwLCBSVEw4
MzY1TUJfRElHSVRBTF9JTlRFUkZBQ0VfU0VMRUNUX1JFRyhleHRfcG9ydCksDQo+ICsJCXByaXYt
Pm1hcCwgUlRMODM2NU1CX0RJR0lUQUxfSU5URVJGQUNFX1NFTEVDVF9SRUcoZXh0X3BvcnQpLA0K
PiAgIAkJUlRMODM2NU1CX0RJR0lUQUxfSU5URVJGQUNFX1NFTEVDVF9NT0RFX01BU0soZXh0X3Bv
cnQpLA0KPiAgIAkJUlRMODM2NU1CX0VYVF9QT1JUX01PREVfUkdNSUkNCj4gICAJCQk8PCBSVEw4
MzY1TUJfRElHSVRBTF9JTlRFUkZBQ0VfU0VMRUNUX01PREVfT0ZGU0VUKA0KPiBAQCAtODIxLDcg
KzgyMSw3IEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX2V4dF9jb25maWdfcmdtaWkoc3RydWN0IHJl
YWx0ZWtfc21pICpzbWksIGludCBwb3J0LA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+
IC1zdGF0aWMgaW50IHJ0bDgzNjVtYl9leHRfY29uZmlnX2ZvcmNlbW9kZShzdHJ1Y3QgcmVhbHRl
a19zbWkgKnNtaSwgaW50IHBvcnQsDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9leHRfY29uZmln
X2ZvcmNlbW9kZShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBpbnQgcG9ydCwNCj4gICAJCQkJ
CSAgYm9vbCBsaW5rLCBpbnQgc3BlZWQsIGludCBkdXBsZXgsDQo+ICAgCQkJCQkgIGJvb2wgdHhf
cGF1c2UsIGJvb2wgcnhfcGF1c2UpDQo+ICAgew0KPiBAQCAtODM0LDEwICs4MzQsMTAgQEAgc3Rh
dGljIGludCBydGw4MzY1bWJfZXh0X2NvbmZpZ19mb3JjZW1vZGUoc3RydWN0IHJlYWx0ZWtfc21p
ICpzbWksIGludCBwb3J0LA0KPiAgIAlpbnQgdmFsOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAt
CWlmIChwb3J0ID09IHNtaS0+Y3B1X3BvcnQpIHsNCj4gKwlpZiAocG9ydCA9PSBwcml2LT5jcHVf
cG9ydCkgew0KPiAgIAkJZXh0X3BvcnQgPSAxOw0KPiAgIAl9IGVsc2Ugew0KPiAtCQlkZXZfZXJy
KHNtaS0+ZGV2LCAib25seSBvbmUgRVhUIHBvcnQgaXMgY3VycmVudGx5IHN1cHBvcnRlZFxuIik7
DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAib25seSBvbmUgRVhUIHBvcnQgaXMgY3VycmVudGx5
IHN1cHBvcnRlZFxuIik7DQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsNCj4gICAJfQ0KPiAgIA0KPiBA
QCAtODU0LDcgKzg1NCw3IEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX2V4dF9jb25maWdfZm9yY2Vt
b2RlKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwNCj4gICAJCX0gZWxzZSBpZiAo
c3BlZWQgPT0gU1BFRURfMTApIHsNCj4gICAJCQlyX3NwZWVkID0gUlRMODM2NU1CX1BPUlRfU1BF
RURfMTBNOw0KPiAgIAkJfSBlbHNlIHsNCj4gLQkJCWRldl9lcnIoc21pLT5kZXYsICJ1bnN1cHBv
cnRlZCBwb3J0IHNwZWVkICVzXG4iLA0KPiArCQkJZGV2X2Vycihwcml2LT5kZXYsICJ1bnN1cHBv
cnRlZCBwb3J0IHNwZWVkICVzXG4iLA0KPiAgIAkJCQlwaHlfc3BlZWRfdG9fc3RyKHNwZWVkKSk7
DQo+ICAgCQkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgCQl9DQo+IEBAIC04NjQsNyArODY0LDcgQEAg
c3RhdGljIGludCBydGw4MzY1bWJfZXh0X2NvbmZpZ19mb3JjZW1vZGUoc3RydWN0IHJlYWx0ZWtf
c21pICpzbWksIGludCBwb3J0LA0KPiAgIAkJfSBlbHNlIGlmIChkdXBsZXggPT0gRFVQTEVYX0hB
TEYpIHsNCj4gICAJCQlyX2R1cGxleCA9IDA7DQo+ICAgCQl9IGVsc2Ugew0KPiAtCQkJZGV2X2Vy
cihzbWktPmRldiwgInVuc3VwcG9ydGVkIGR1cGxleCAlc1xuIiwNCj4gKwkJCWRldl9lcnIocHJp
di0+ZGV2LCAidW5zdXBwb3J0ZWQgZHVwbGV4ICVzXG4iLA0KPiAgIAkJCQlwaHlfZHVwbGV4X3Rv
X3N0cihkdXBsZXgpKTsNCj4gICAJCQlyZXR1cm4gLUVJTlZBTDsNCj4gICAJCX0NCj4gQEAgLTg4
Niw3ICs4ODYsNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9leHRfY29uZmlnX2ZvcmNlbW9kZShz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBvcnQsDQo+ICAgCSAgICAgIEZJRUxEX1BSRVAo
UlRMODM2NU1CX0RJR0lUQUxfSU5URVJGQUNFX0ZPUkNFX0RVUExFWF9NQVNLLA0KPiAgIAkJCSBy
X2R1cGxleCkgfA0KPiAgIAkgICAgICBGSUVMRF9QUkVQKFJUTDgzNjVNQl9ESUdJVEFMX0lOVEVS
RkFDRV9GT1JDRV9TUEVFRF9NQVNLLCByX3NwZWVkKTsNCj4gLQlyZXQgPSByZWdtYXBfd3JpdGUo
c21pLT5tYXAsDQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwNCj4gICAJCQkgICBS
VEw4MzY1TUJfRElHSVRBTF9JTlRFUkZBQ0VfRk9SQ0VfUkVHKGV4dF9wb3J0KSwNCj4gICAJCQkg
ICB2YWwpOw0KPiAgIAlpZiAocmV0KQ0KPiBAQCAtOTE2LDcgKzkxNiw3IEBAIHN0YXRpYyB2b2lk
IHJ0bDgzNjVtYl9waHlsaW5rX3ZhbGlkYXRlKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBv
cnQsDQo+ICAgCQkJCSAgICAgICB1bnNpZ25lZCBsb25nICpzdXBwb3J0ZWQsDQo+ICAgCQkJCSAg
ICAgICBzdHJ1Y3QgcGh5bGlua19saW5rX3N0YXRlICpzdGF0ZSkNCj4gICB7DQo+IC0Jc3RydWN0
IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpw
cml2ID0gZHMtPnByaXY7DQo+ICAgCV9fRVRIVE9PTF9ERUNMQVJFX0xJTktfTU9ERV9NQVNLKG1h
c2spID0geyAwIH07DQo+ICAgDQo+ICAgCS8qIGluY2x1ZGUvbGludXgvcGh5bGluay5oIHNheXM6
DQo+IEBAIC05MjUsNyArOTI1LDcgQEAgc3RhdGljIHZvaWQgcnRsODM2NW1iX3BoeWxpbmtfdmFs
aWRhdGUoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJICovDQo+ICAgCWlm
IChzdGF0ZS0+aW50ZXJmYWNlICE9IFBIWV9JTlRFUkZBQ0VfTU9ERV9OQSAmJg0KPiAgIAkgICAg
IXJ0bDgzNjVtYl9waHlfbW9kZV9zdXBwb3J0ZWQoZHMsIHBvcnQsIHN0YXRlLT5pbnRlcmZhY2Up
KSB7DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJwaHkgbW9kZSAlcyBpcyB1bnN1cHBvcnRlZCBv
biBwb3J0ICVkXG4iLA0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwgInBoeSBtb2RlICVzIGlzIHVu
c3VwcG9ydGVkIG9uIHBvcnQgJWRcbiIsDQo+ICAgCQkJcGh5X21vZGVzKHN0YXRlLT5pbnRlcmZh
Y2UpLCBwb3J0KTsNCj4gICAJCWxpbmttb2RlX3plcm8oc3VwcG9ydGVkKTsNCj4gICAJCXJldHVy
bjsNCj4gQEAgLTk1MSwyNiArOTUxLDI2IEBAIHN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9waHlsaW5r
X21hY19jb25maWcoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCQkJCSB1
bnNpZ25lZCBpbnQgbW9kZSwNCj4gICAJCQkJCSBjb25zdCBzdHJ1Y3QgcGh5bGlua19saW5rX3N0
YXRlICpzdGF0ZSkNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+cHJp
djsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMtPnByaXY7DQo+ICAgCWludCBy
ZXQ7DQo+ICAgDQo+ICAgCWlmICghcnRsODM2NW1iX3BoeV9tb2RlX3N1cHBvcnRlZChkcywgcG9y
dCwgc3RhdGUtPmludGVyZmFjZSkpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgInBoeSBtb2Rl
ICVzIGlzIHVuc3VwcG9ydGVkIG9uIHBvcnQgJWRcbiIsDQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2
LCAicGh5IG1vZGUgJXMgaXMgdW5zdXBwb3J0ZWQgb24gcG9ydCAlZFxuIiwNCj4gICAJCQlwaHlf
bW9kZXMoc3RhdGUtPmludGVyZmFjZSksIHBvcnQpOw0KPiAgIAkJcmV0dXJuOw0KPiAgIAl9DQo+
ICAgDQo+ICAgCWlmIChtb2RlICE9IE1MT19BTl9QSFkgJiYgbW9kZSAhPSBNTE9fQU5fRklYRUQp
IHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsDQo+ICAg
CQkJInBvcnQgJWQgc3VwcG9ydHMgb25seSBjb252ZW50aW9uYWwgUEhZIG9yIGZpeGVkLWxpbmtc
biIsDQo+ICAgCQkJcG9ydCk7DQo+ICAgCQlyZXR1cm47DQo+ICAgCX0NCj4gICANCj4gICAJaWYg
KHBoeV9pbnRlcmZhY2VfbW9kZV9pc19yZ21paShzdGF0ZS0+aW50ZXJmYWNlKSkgew0KPiAtCQly
ZXQgPSBydGw4MzY1bWJfZXh0X2NvbmZpZ19yZ21paShzbWksIHBvcnQsIHN0YXRlLT5pbnRlcmZh
Y2UpOw0KPiArCQlyZXQgPSBydGw4MzY1bWJfZXh0X2NvbmZpZ19yZ21paShwcml2LCBwb3J0LCBz
dGF0ZS0+aW50ZXJmYWNlKTsNCj4gICAJCWlmIChyZXQpDQo+IC0JCQlkZXZfZXJyKHNtaS0+ZGV2
LA0KPiArCQkJZGV2X2Vycihwcml2LT5kZXYsDQo+ICAgCQkJCSJmYWlsZWQgdG8gY29uZmlndXJl
IFJHTUlJIG1vZGUgb24gcG9ydCAlZDogJWRcbiIsDQo+ICAgCQkJCXBvcnQsIHJldCk7DQo+ICAg
CQlyZXR1cm47DQo+IEBAIC05ODUsMjAgKzk4NSwyMCBAQCBzdGF0aWMgdm9pZCBydGw4MzY1bWJf
cGh5bGlua19tYWNfbGlua19kb3duKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+
ICAgCQkJCQkgICAgdW5zaWduZWQgaW50IG1vZGUsDQo+ICAgCQkJCQkgICAgcGh5X2ludGVyZmFj
ZV90IGludGVyZmFjZSkNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+
cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMtPnByaXY7DQo+ICAgCXN0
cnVjdCBydGw4MzY1bWJfcG9ydCAqcDsNCj4gICAJc3RydWN0IHJ0bDgzNjVtYiAqbWI7DQo+ICAg
CWludCByZXQ7DQo+ICAgDQo+IC0JbWIgPSBzbWktPmNoaXBfZGF0YTsNCj4gKwltYiA9IHByaXYt
PmNoaXBfZGF0YTsNCj4gICAJcCA9ICZtYi0+cG9ydHNbcG9ydF07DQo+ICAgCWNhbmNlbF9kZWxh
eWVkX3dvcmtfc3luYygmcC0+bWliX3dvcmspOw0KPiAgIA0KPiAgIAlpZiAocGh5X2ludGVyZmFj
ZV9tb2RlX2lzX3JnbWlpKGludGVyZmFjZSkpIHsNCj4gLQkJcmV0ID0gcnRsODM2NW1iX2V4dF9j
b25maWdfZm9yY2Vtb2RlKHNtaSwgcG9ydCwgZmFsc2UsIDAsIDAsDQo+ICsJCXJldCA9IHJ0bDgz
NjVtYl9leHRfY29uZmlnX2ZvcmNlbW9kZShwcml2LCBwb3J0LCBmYWxzZSwgMCwgMCwNCj4gICAJ
CQkJCQkgICAgIGZhbHNlLCBmYWxzZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAtCQkJZGV2X2Vycihz
bWktPmRldiwNCj4gKwkJCWRldl9lcnIocHJpdi0+ZGV2LA0KPiAgIAkJCQkiZmFpbGVkIHRvIHJl
c2V0IGZvcmNlZCBtb2RlIG9uIHBvcnQgJWQ6ICVkXG4iLA0KPiAgIAkJCQlwb3J0LCByZXQpOw0K
PiAgIA0KPiBAQCAtMTAxMywyMSArMTAxMywyMSBAQCBzdGF0aWMgdm9pZCBydGw4MzY1bWJfcGh5
bGlua19tYWNfbGlua191cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMsIGludCBwb3J0LA0KPiAgIAkJ
CQkJICBpbnQgZHVwbGV4LCBib29sIHR4X3BhdXNlLA0KPiAgIAkJCQkJICBib29sIHJ4X3BhdXNl
KQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0
cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJc3RydWN0IHJ0bDgzNjVt
Yl9wb3J0ICpwOw0KPiAgIAlzdHJ1Y3QgcnRsODM2NW1iICptYjsNCj4gICAJaW50IHJldDsNCj4g
ICANCj4gLQltYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiArCW1iID0gcHJpdi0+Y2hpcF9kYXRhOw0K
PiAgIAlwID0gJm1iLT5wb3J0c1twb3J0XTsNCj4gICAJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZw
LT5taWJfd29yaywgMCk7DQo+ICAgDQo+ICAgCWlmIChwaHlfaW50ZXJmYWNlX21vZGVfaXNfcmdt
aWkoaW50ZXJmYWNlKSkgew0KPiAtCQlyZXQgPSBydGw4MzY1bWJfZXh0X2NvbmZpZ19mb3JjZW1v
ZGUoc21pLCBwb3J0LCB0cnVlLCBzcGVlZCwNCj4gKwkJcmV0ID0gcnRsODM2NW1iX2V4dF9jb25m
aWdfZm9yY2Vtb2RlKHByaXYsIHBvcnQsIHRydWUsIHNwZWVkLA0KPiAgIAkJCQkJCSAgICAgZHVw
bGV4LCB0eF9wYXVzZSwNCj4gICAJCQkJCQkgICAgIHJ4X3BhdXNlKTsNCj4gICAJCWlmIChyZXQp
DQo+IC0JCQlkZXZfZXJyKHNtaS0+ZGV2LA0KPiArCQkJZGV2X2Vycihwcml2LT5kZXYsDQo+ICAg
CQkJCSJmYWlsZWQgdG8gZm9yY2UgbW9kZSBvbiBwb3J0ICVkOiAlZFxuIiwgcG9ydCwNCj4gICAJ
CQkJcmV0KTsNCj4gICANCj4gQEAgLTEwMzgsNyArMTAzOCw3IEBAIHN0YXRpYyB2b2lkIHJ0bDgz
NjVtYl9waHlsaW5rX21hY19saW5rX3VwKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQs
DQo+ICAgc3RhdGljIHZvaWQgcnRsODM2NW1iX3BvcnRfc3RwX3N0YXRlX3NldChzdHJ1Y3QgZHNh
X3N3aXRjaCAqZHMsIGludCBwb3J0LA0KPiAgIAkJCQkJIHU4IHN0YXRlKQ0KPiAgIHsNCj4gLQlz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3By
aXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJZW51bSBydGw4MzY1bWJfc3RwX3N0YXRlIHZhbDsN
Cj4gICAJaW50IG1zdGkgPSAwOw0KPiAgIA0KPiBAQCAtMTA1NywzNiArMTA1NywzNiBAQCBzdGF0
aWMgdm9pZCBydGw4MzY1bWJfcG9ydF9zdHBfc3RhdGVfc2V0KHN0cnVjdCBkc2Ffc3dpdGNoICpk
cywgaW50IHBvcnQsDQo+ICAgCQl2YWwgPSBSVEw4MzY1TUJfU1RQX1NUQVRFX0ZPUldBUkRJTkc7
DQo+ICAgCQlicmVhazsNCj4gICAJZGVmYXVsdDoNCj4gLQkJZGV2X2VycihzbWktPmRldiwgImlu
dmFsaWQgU1RQIHN0YXRlOiAldVxuIiwgc3RhdGUpOw0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwg
ImludmFsaWQgU1RQIHN0YXRlOiAldVxuIiwgc3RhdGUpOw0KPiAgIAkJcmV0dXJuOw0KPiAgIAl9
DQo+ICAgDQo+IC0JcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY1TUJfTVNUSV9D
VFJMX1JFRyhtc3RpLCBwb3J0KSwNCj4gKwlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBS
VEw4MzY1TUJfTVNUSV9DVFJMX1JFRyhtc3RpLCBwb3J0KSwNCj4gICAJCQkgICBSVEw4MzY1TUJf
TVNUSV9DVFJMX1BPUlRfU1RBVEVfTUFTSyhwb3J0KSwNCj4gICAJCQkgICB2YWwgPDwgUlRMODM2
NU1CX01TVElfQ1RSTF9QT1JUX1NUQVRFX09GRlNFVChwb3J0KSk7DQo+ICAgfQ0KPiAgIA0KPiAt
c3RhdGljIGludCBydGw4MzY1bWJfcG9ydF9zZXRfbGVhcm5pbmcoc3RydWN0IHJlYWx0ZWtfc21p
ICpzbWksIGludCBwb3J0LA0KPiArc3RhdGljIGludCBydGw4MzY1bWJfcG9ydF9zZXRfbGVhcm5p
bmcoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgaW50IHBvcnQsDQo+ICAgCQkJCSAgICAgICBi
b29sIGVuYWJsZSkNCj4gICB7DQo+IC0Jc3RydWN0IHJ0bDgzNjVtYiAqbWIgPSBzbWktPmNoaXBf
ZGF0YTsNCj4gKwlzdHJ1Y3QgcnRsODM2NW1iICptYiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICAN
Cj4gICAJLyogRW5hYmxlL2Rpc2FibGUgbGVhcm5pbmcgYnkgbGltaXRpbmcgdGhlIG51bWJlciBv
ZiBMMiBhZGRyZXNzZXMgdGhlDQo+ICAgCSAqIHBvcnQgY2FuIGxlYXJuLiBSZWFsdGVrIGRvY3Vt
ZW50YXRpb24gc3RhdGVzIHRoYXQgYSBsaW1pdCBvZiB6ZXJvDQo+ICAgCSAqIGRpc2FibGVzIGxl
YXJuaW5nLiBXaGVuIGVuYWJsaW5nIGxlYXJuaW5nLCBzZXQgaXQgdG8gdGhlIGNoaXAncw0KPiAg
IAkgKiBtYXhpbXVtLg0KPiAgIAkgKi8NCj4gLQlyZXR1cm4gcmVnbWFwX3dyaXRlKHNtaS0+bWFw
LCBSVEw4MzY1TUJfTFVUX1BPUlRfTEVBUk5fTElNSVRfUkVHKHBvcnQpLA0KPiArCXJldHVybiBy
ZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY1TUJfTFVUX1BPUlRfTEVBUk5fTElNSVRfUkVH
KHBvcnQpLA0KPiAgIAkJCSAgICBlbmFibGUgPyBtYi0+bGVhcm5fbGltaXRfbWF4IDogMCk7DQo+
ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY1bWJfcG9ydF9zZXRfaXNvbGF0aW9uKHN0
cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgcG9ydCwNCj4gK3N0YXRpYyBpbnQgcnRsODM2NW1i
X3BvcnRfc2V0X2lzb2xhdGlvbihzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBpbnQgcG9ydCwN
Cj4gICAJCQkJCXUzMiBtYXNrKQ0KPiAgIHsNCj4gLQlyZXR1cm4gcmVnbWFwX3dyaXRlKHNtaS0+
bWFwLCBSVEw4MzY1TUJfUE9SVF9JU09MQVRJT05fUkVHKHBvcnQpLCBtYXNrKTsNCj4gKwlyZXR1
cm4gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRMODM2NU1CX1BPUlRfSVNPTEFUSU9OX1JFRyhw
b3J0KSwgbWFzayk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY1bWJfbWliX2Nv
dW50ZXJfcmVhZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBvcnQsDQo+ICtzdGF0aWMg
aW50IHJ0bDgzNjVtYl9taWJfY291bnRlcl9yZWFkKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYs
IGludCBwb3J0LA0KPiAgIAkJCQkgICAgICB1MzIgb2Zmc2V0LCB1MzIgbGVuZ3RoLCB1NjQgKm1p
YnZhbHVlKQ0KPiAgIHsNCj4gICAJdTY0IHRtcHZhbHVlID0gMDsNCj4gQEAgLTEwOTgsMTMgKzEw
OTgsMTMgQEAgc3RhdGljIGludCBydGw4MzY1bWJfbWliX2NvdW50ZXJfcmVhZChzdHJ1Y3QgcmVh
bHRla19zbWkgKnNtaSwgaW50IHBvcnQsDQo+ICAgCSAqIGFuZCB0aGVuIHBvbGwgdGhlIGNvbnRy
b2wgcmVnaXN0ZXIgYmVmb3JlIHJlYWRpbmcgdGhlIHZhbHVlIGZyb20gc29tZQ0KPiAgIAkgKiBj
b3VudGVyIHJlZ2lzdGVycy4NCj4gICAJICovDQo+IC0JcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+
bWFwLCBSVEw4MzY1TUJfTUlCX0FERFJFU1NfUkVHLA0KPiArCXJldCA9IHJlZ21hcF93cml0ZShw
cml2LT5tYXAsIFJUTDgzNjVNQl9NSUJfQUREUkVTU19SRUcsDQo+ICAgCQkJICAgUlRMODM2NU1C
X01JQl9BRERSRVNTKHBvcnQsIG9mZnNldCkpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJu
IHJldDsNCj4gICANCj4gICAJLyogUG9sbCBmb3IgY29tcGxldGlvbiAqLw0KPiAtCXJldCA9IHJl
Z21hcF9yZWFkX3BvbGxfdGltZW91dChzbWktPm1hcCwgUlRMODM2NU1CX01JQl9DVFJMMF9SRUcs
IHZhbCwNCj4gKwlyZXQgPSByZWdtYXBfcmVhZF9wb2xsX3RpbWVvdXQocHJpdi0+bWFwLCBSVEw4
MzY1TUJfTUlCX0NUUkwwX1JFRywgdmFsLA0KPiAgIAkJCQkgICAgICAgISh2YWwgJiBSVEw4MzY1
TUJfTUlCX0NUUkwwX0JVU1lfTUFTSyksDQo+ICAgCQkJCSAgICAgICAxMCwgMTAwKTsNCj4gICAJ
aWYgKHJldCkNCj4gQEAgLTExMjYsNyArMTEyNiw3IEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX21p
Yl9jb3VudGVyX3JlYWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwb3J0LA0KPiAgIA0K
PiAgIAkvKiBSZWFkIHRoZSBNSUIgY291bnRlciAxNiBiaXRzIGF0IGEgdGltZSAqLw0KPiAgIAlm
b3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsNCj4gLQkJcmV0ID0gcmVnbWFwX3JlYWQoc21p
LT5tYXAsDQo+ICsJCXJldCA9IHJlZ21hcF9yZWFkKHByaXYtPm1hcCwNCj4gICAJCQkJICBSVEw4
MzY1TUJfTUlCX0NPVU5URVJfUkVHKG9mZnNldCAtIGkpLCAmdmFsKTsNCj4gICAJCWlmIChyZXQp
DQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gQEAgLTExNDIsMjEgKzExNDIsMjEgQEAgc3RhdGljIGlu
dCBydGw4MzY1bWJfbWliX2NvdW50ZXJfcmVhZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50
IHBvcnQsDQo+ICAgDQo+ICAgc3RhdGljIHZvaWQgcnRsODM2NW1iX2dldF9ldGh0b29sX3N0YXRz
KHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsIHU2NCAqZGF0YSkNCj4gICB7DQo+IC0J
c3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19w
cml2ICpwcml2ID0gZHMtPnByaXY7DQo+ICAgCXN0cnVjdCBydGw4MzY1bWIgKm1iOw0KPiAgIAlp
bnQgcmV0Ow0KPiAgIAlpbnQgaTsNCj4gICANCj4gLQltYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiAr
CW1iID0gcHJpdi0+Y2hpcF9kYXRhOw0KPiAgIA0KPiAgIAltdXRleF9sb2NrKCZtYi0+bWliX2xv
Y2spOw0KPiAgIAlmb3IgKGkgPSAwOyBpIDwgUlRMODM2NU1CX01JQl9FTkQ7IGkrKykgew0KPiAg
IAkJc3RydWN0IHJ0bDgzNjVtYl9taWJfY291bnRlciAqbWliID0gJnJ0bDgzNjVtYl9taWJfY291
bnRlcnNbaV07DQo+ICAgDQo+IC0JCXJldCA9IHJ0bDgzNjVtYl9taWJfY291bnRlcl9yZWFkKHNt
aSwgcG9ydCwgbWliLT5vZmZzZXQsDQo+ICsJCXJldCA9IHJ0bDgzNjVtYl9taWJfY291bnRlcl9y
ZWFkKHByaXYsIHBvcnQsIG1pYi0+b2Zmc2V0LA0KPiAgIAkJCQkJCSBtaWItPmxlbmd0aCwgJmRh
dGFbaV0pOw0KPiAgIAkJaWYgKHJldCkgew0KPiAtCQkJZGV2X2VycihzbWktPmRldiwNCj4gKwkJ
CWRldl9lcnIocHJpdi0+ZGV2LA0KPiAgIAkJCQkiZmFpbGVkIHRvIHJlYWQgcG9ydCAlZCBjb3Vu
dGVyczogJWRcbiIsIHBvcnQsDQo+ICAgCQkJCXJldCk7DQo+ICAgCQkJYnJlYWs7DQo+IEBAIC0x
MTkwLDE1ICsxMTkwLDE1IEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX2dldF9zc2V0X2NvdW50KHN0
cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsIGludCBzc2V0KQ0KPiAgIHN0YXRpYyB2b2lk
IHJ0bDgzNjVtYl9nZXRfcGh5X3N0YXRzKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQs
DQo+ICAgCQkJCSAgICBzdHJ1Y3QgZXRodG9vbF9ldGhfcGh5X3N0YXRzICpwaHlfc3RhdHMpDQo+
ICAgew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pID0gZHMtPnByaXY7DQo+ICsJc3RydWN0
IHJlYWx0ZWtfcHJpdiAqcHJpdiA9IGRzLT5wcml2Ow0KPiAgIAlzdHJ1Y3QgcnRsODM2NW1iX21p
Yl9jb3VudGVyICptaWI7DQo+ICAgCXN0cnVjdCBydGw4MzY1bWIgKm1iOw0KPiAgIA0KPiAtCW1i
ID0gc21pLT5jaGlwX2RhdGE7DQo+ICsJbWIgPSBwcml2LT5jaGlwX2RhdGE7DQo+ICAgCW1pYiA9
ICZydGw4MzY1bWJfbWliX2NvdW50ZXJzW1JUTDgzNjVNQl9NSUJfZG90M1N0YXRzU3ltYm9sRXJy
b3JzXTsNCj4gICANCj4gICAJbXV0ZXhfbG9jaygmbWItPm1pYl9sb2NrKTsNCj4gLQlydGw4MzY1
bWJfbWliX2NvdW50ZXJfcmVhZChzbWksIHBvcnQsIG1pYi0+b2Zmc2V0LCBtaWItPmxlbmd0aCwN
Cj4gKwlydGw4MzY1bWJfbWliX2NvdW50ZXJfcmVhZChwcml2LCBwb3J0LCBtaWItPm9mZnNldCwg
bWliLT5sZW5ndGgsDQo+ICAgCQkJCSAgICZwaHlfc3RhdHMtPlN5bWJvbEVycm9yRHVyaW5nQ2Fy
cmllcik7DQo+ICAgCW11dGV4X3VubG9jaygmbWItPm1pYl9sb2NrKTsNCj4gICB9DQo+IEBAIC0x
MjI2LDEyICsxMjI2LDEyIEBAIHN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9nZXRfbWFjX3N0YXRzKHN0
cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgCQlbUlRMODM2NU1CX01JQl9kb3Qz
U3RhdHNFeGNlc3NpdmVDb2xsaXNpb25zXSA9IDEsDQo+ICAgDQo+ICAgCX07DQo+IC0Jc3RydWN0
IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpw
cml2ID0gZHMtPnByaXY7DQo+ICAgCXN0cnVjdCBydGw4MzY1bWIgKm1iOw0KPiAgIAlpbnQgcmV0
Ow0KPiAgIAlpbnQgaTsNCj4gICANCj4gLQltYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiArCW1iID0g
cHJpdi0+Y2hpcF9kYXRhOw0KPiAgIA0KPiAgIAltdXRleF9sb2NrKCZtYi0+bWliX2xvY2spOw0K
PiAgIAlmb3IgKGkgPSAwOyBpIDwgUlRMODM2NU1CX01JQl9FTkQ7IGkrKykgew0KPiBAQCAtMTI0
MSw3ICsxMjQxLDcgQEAgc3RhdGljIHZvaWQgcnRsODM2NW1iX2dldF9tYWNfc3RhdHMoc3RydWN0
IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCWlmICghY250W2ldKQ0KPiAgIAkJCWNv
bnRpbnVlOw0KPiAgIA0KPiAtCQlyZXQgPSBydGw4MzY1bWJfbWliX2NvdW50ZXJfcmVhZChzbWks
IHBvcnQsIG1pYi0+b2Zmc2V0LA0KPiArCQlyZXQgPSBydGw4MzY1bWJfbWliX2NvdW50ZXJfcmVh
ZChwcml2LCBwb3J0LCBtaWItPm9mZnNldCwNCj4gICAJCQkJCQkgbWliLT5sZW5ndGgsICZjbnRb
aV0pOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlicmVhazsNCj4gQEAgLTEyOTEsMjAgKzEyOTEs
MjAgQEAgc3RhdGljIHZvaWQgcnRsODM2NW1iX2dldF9tYWNfc3RhdHMoc3RydWN0IGRzYV9zd2l0
Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICBzdGF0aWMgdm9pZCBydGw4MzY1bWJfZ2V0X2N0cmxfc3Rh
dHMoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCQkJICAgICBzdHJ1Y3Qg
ZXRodG9vbF9ldGhfY3RybF9zdGF0cyAqY3RybF9zdGF0cykNCj4gICB7DQo+IC0Jc3RydWN0IHJl
YWx0ZWtfc21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2
ID0gZHMtPnByaXY7DQo+ICAgCXN0cnVjdCBydGw4MzY1bWJfbWliX2NvdW50ZXIgKm1pYjsNCj4g
ICAJc3RydWN0IHJ0bDgzNjVtYiAqbWI7DQo+ICAgDQo+IC0JbWIgPSBzbWktPmNoaXBfZGF0YTsN
Cj4gKwltYiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICAJbWliID0gJnJ0bDgzNjVtYl9taWJfY291
bnRlcnNbUlRMODM2NU1CX01JQl9kb3QzQ29udHJvbEluVW5rbm93bk9wY29kZXNdOw0KPiAgIA0K
PiAgIAltdXRleF9sb2NrKCZtYi0+bWliX2xvY2spOw0KPiAtCXJ0bDgzNjVtYl9taWJfY291bnRl
cl9yZWFkKHNtaSwgcG9ydCwgbWliLT5vZmZzZXQsIG1pYi0+bGVuZ3RoLA0KPiArCXJ0bDgzNjVt
Yl9taWJfY291bnRlcl9yZWFkKHByaXYsIHBvcnQsIG1pYi0+b2Zmc2V0LCBtaWItPmxlbmd0aCwN
Cj4gICAJCQkJICAgJmN0cmxfc3RhdHMtPlVuc3VwcG9ydGVkT3Bjb2Rlc1JlY2VpdmVkKTsNCj4g
ICAJbXV0ZXhfdW5sb2NrKCZtYi0+bWliX2xvY2spOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyB2
b2lkIHJ0bDgzNjVtYl9zdGF0c191cGRhdGUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBw
b3J0KQ0KPiArc3RhdGljIHZvaWQgcnRsODM2NW1iX3N0YXRzX3VwZGF0ZShzdHJ1Y3QgcmVhbHRl
a19wcml2ICpwcml2LCBpbnQgcG9ydCkNCj4gICB7DQo+ICAgCXU2NCBjbnRbUlRMODM2NU1CX01J
Ql9FTkRdID0gew0KPiAgIAkJW1JUTDgzNjVNQl9NSUJfaWZPdXRPY3RldHNdID0gMSwNCj4gQEAg
LTEzMjMsNyArMTMyMyw3IEBAIHN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9zdGF0c191cGRhdGUoc3Ry
dWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwb3J0KQ0KPiAgIAkJW1JUTDgzNjVNQl9NSUJfZG90
M1N0YXRzRkNTRXJyb3JzXSA9IDEsDQo+ICAgCQlbUlRMODM2NU1CX01JQl9kb3QzU3RhdHNMYXRl
Q29sbGlzaW9uc10gPSAxLA0KPiAgIAl9Ow0KPiAtCXN0cnVjdCBydGw4MzY1bWIgKm1iID0gc21p
LT5jaGlwX2RhdGE7DQo+ICsJc3RydWN0IHJ0bDgzNjVtYiAqbWIgPSBwcml2LT5jaGlwX2RhdGE7
DQo+ICAgCXN0cnVjdCBydG5sX2xpbmtfc3RhdHM2NCAqc3RhdHM7DQo+ICAgCWludCByZXQ7DQo+
ICAgCWludCBpOw0KPiBAQCAtMTMzOCw3ICsxMzM4LDcgQEAgc3RhdGljIHZvaWQgcnRsODM2NW1i
X3N0YXRzX3VwZGF0ZShzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBvcnQpDQo+ICAgCQlp
ZiAoIWNudFtpXSkNCj4gICAJCQljb250aW51ZTsNCj4gICANCj4gLQkJcmV0ID0gcnRsODM2NW1i
X21pYl9jb3VudGVyX3JlYWQoc21pLCBwb3J0LCBjLT5vZmZzZXQsDQo+ICsJCXJldCA9IHJ0bDgz
NjVtYl9taWJfY291bnRlcl9yZWFkKHByaXYsIHBvcnQsIGMtPm9mZnNldCwNCj4gICAJCQkJCQkg
Yy0+bGVuZ3RoLCAmY250W2ldKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJYnJlYWs7DQo+IEBA
IC0xMzg4LDkgKzEzODgsOSBAQCBzdGF0aWMgdm9pZCBydGw4MzY1bWJfc3RhdHNfcG9sbChzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQo+ICAgCXN0cnVjdCBydGw4MzY1bWJfcG9ydCAqcCA9IGNv
bnRhaW5lcl9vZih0b19kZWxheWVkX3dvcmsod29yayksDQo+ICAgCQkJCQkJc3RydWN0IHJ0bDgz
NjVtYl9wb3J0LA0KPiAgIAkJCQkJCW1pYl93b3JrKTsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSA9IHAtPnNtaTsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gcC0+cHJpdjsN
Cj4gICANCj4gLQlydGw4MzY1bWJfc3RhdHNfdXBkYXRlKHNtaSwgcC0+aW5kZXgpOw0KPiArCXJ0
bDgzNjVtYl9zdGF0c191cGRhdGUocHJpdiwgcC0+aW5kZXgpOw0KPiAgIA0KPiAgIAlzY2hlZHVs
ZV9kZWxheWVkX3dvcmsoJnAtPm1pYl93b3JrLCBSVEw4MzY1TUJfU1RBVFNfSU5URVJWQUxfSklG
RklFUyk7DQo+ICAgfQ0KPiBAQCAtMTM5OCwxMSArMTM5OCwxMSBAQCBzdGF0aWMgdm9pZCBydGw4
MzY1bWJfc3RhdHNfcG9sbChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQo+ICAgc3RhdGljIHZv
aWQgcnRsODM2NW1iX2dldF9zdGF0czY0KHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQs
DQo+ICAgCQkJCSAgc3RydWN0IHJ0bmxfbGlua19zdGF0czY0ICpzKQ0KPiAgIHsNCj4gLQlzdHJ1
Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYgPSBkcy0+cHJpdjsNCj4gICAJc3RydWN0IHJ0bDgzNjVtYl9wb3J0ICpwOw0KPiAgIAlz
dHJ1Y3QgcnRsODM2NW1iICptYjsNCj4gICANCj4gLQltYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiAr
CW1iID0gcHJpdi0+Y2hpcF9kYXRhOw0KPiAgIAlwID0gJm1iLT5wb3J0c1twb3J0XTsNCj4gICAN
Cj4gICAJc3Bpbl9sb2NrKCZwLT5zdGF0c19sb2NrKTsNCj4gQEAgLTE0MTAsOSArMTQxMCw5IEBA
IHN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9nZXRfc3RhdHM2NChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMs
IGludCBwb3J0LA0KPiAgIAlzcGluX3VubG9jaygmcC0+c3RhdHNfbG9jayk7DQo+ICAgfQ0KPiAg
IA0KPiAtc3RhdGljIHZvaWQgcnRsODM2NW1iX3N0YXRzX3NldHVwKHN0cnVjdCByZWFsdGVrX3Nt
aSAqc21pKQ0KPiArc3RhdGljIHZvaWQgcnRsODM2NW1iX3N0YXRzX3NldHVwKHN0cnVjdCByZWFs
dGVrX3ByaXYgKnByaXYpDQo+ICAgew0KPiAtCXN0cnVjdCBydGw4MzY1bWIgKm1iID0gc21pLT5j
aGlwX2RhdGE7DQo+ICsJc3RydWN0IHJ0bDgzNjVtYiAqbWIgPSBwcml2LT5jaGlwX2RhdGE7DQo+
ICAgCWludCBpOw0KPiAgIA0KPiAgIAkvKiBQZXItY2hpcCBnbG9iYWwgbXV0ZXggdG8gcHJvdGVj
dCBNSUIgY291bnRlciBhY2Nlc3MsIHNpbmNlIGRvaW5nDQo+IEBAIC0xNDIwLDEwICsxNDIwLDEw
IEBAIHN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9zdGF0c19zZXR1cChzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSkNCj4gICAJICovDQo+ICAgCW11dGV4X2luaXQoJm1iLT5taWJfbG9jayk7DQo+ICAgDQo+
IC0JZm9yIChpID0gMDsgaSA8IHNtaS0+bnVtX3BvcnRzOyBpKyspIHsNCj4gKwlmb3IgKGkgPSAw
OyBpIDwgcHJpdi0+bnVtX3BvcnRzOyBpKyspIHsNCj4gICAJCXN0cnVjdCBydGw4MzY1bWJfcG9y
dCAqcCA9ICZtYi0+cG9ydHNbaV07DQo+ICAgDQo+IC0JCWlmIChkc2FfaXNfdW51c2VkX3BvcnQo
c21pLT5kcywgaSkpDQo+ICsJCWlmIChkc2FfaXNfdW51c2VkX3BvcnQocHJpdi0+ZHMsIGkpKQ0K
PiAgIAkJCWNvbnRpbnVlOw0KPiAgIA0KPiAgIAkJLyogUGVyLXBvcnQgc3BpbmxvY2sgdG8gcHJv
dGVjdCB0aGUgc3RhdHM2NCBkYXRhICovDQo+IEBAIC0xNDM2LDQ1ICsxNDM2LDQ1IEBAIHN0YXRp
YyB2b2lkIHJ0bDgzNjVtYl9zdGF0c19zZXR1cChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4g
ICAJfQ0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyB2b2lkIHJ0bDgzNjVtYl9zdGF0c190ZWFyZG93
bihzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gK3N0YXRpYyB2b2lkIHJ0bDgzNjVtYl9zdGF0
c190ZWFyZG93bihzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gLQlzdHJ1Y3Qg
cnRsODM2NW1iICptYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiArCXN0cnVjdCBydGw4MzY1bWIgKm1i
ID0gcHJpdi0+Y2hpcF9kYXRhOw0KPiAgIAlpbnQgaTsNCj4gICANCj4gLQlmb3IgKGkgPSAwOyBp
IDwgc21pLT5udW1fcG9ydHM7IGkrKykgew0KPiArCWZvciAoaSA9IDA7IGkgPCBwcml2LT5udW1f
cG9ydHM7IGkrKykgew0KPiAgIAkJc3RydWN0IHJ0bDgzNjVtYl9wb3J0ICpwID0gJm1iLT5wb3J0
c1tpXTsNCj4gICANCj4gLQkJaWYgKGRzYV9pc191bnVzZWRfcG9ydChzbWktPmRzLCBpKSkNCj4g
KwkJaWYgKGRzYV9pc191bnVzZWRfcG9ydChwcml2LT5kcywgaSkpDQo+ICAgCQkJY29udGludWU7
DQo+ICAgDQo+ICAgCQljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJnAtPm1pYl93b3JrKTsNCj4g
ICAJfQ0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NW1iX2dldF9hbmRfY2xlYXJf
c3RhdHVzX3JlZyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTMyIHJlZywNCj4gK3N0YXRpYyBp
bnQgcnRsODM2NW1iX2dldF9hbmRfY2xlYXJfc3RhdHVzX3JlZyhzdHJ1Y3QgcmVhbHRla19wcml2
ICpwcml2LCB1MzIgcmVnLA0KPiAgIAkJCQkJICAgICAgdTMyICp2YWwpDQo+ICAgew0KPiAgIAlp
bnQgcmV0Ow0KPiAgIA0KPiAtCXJldCA9IHJlZ21hcF9yZWFkKHNtaS0+bWFwLCByZWcsIHZhbCk7
DQo+ICsJcmV0ID0gcmVnbWFwX3JlYWQocHJpdi0+bWFwLCByZWcsIHZhbCk7DQo+ICAgCWlmIChy
ZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAtCXJldHVybiByZWdtYXBfd3JpdGUoc21p
LT5tYXAsIHJlZywgKnZhbCk7DQo+ICsJcmV0dXJuIHJlZ21hcF93cml0ZShwcml2LT5tYXAsIHJl
ZywgKnZhbCk7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpcnFyZXR1cm5fdCBydGw4MzY1bWJf
aXJxKGludCBpcnEsIHZvaWQgKmRhdGEpDQo+ICAgew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAq
c21pID0gZGF0YTsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZGF0YTsNCj4gICAJ
dW5zaWduZWQgbG9uZyBsaW5lX2NoYW5nZXMgPSAwOw0KPiAgIAlzdHJ1Y3QgcnRsODM2NW1iICpt
YjsNCj4gICAJdTMyIHN0YXQ7DQo+ICAgCWludCBsaW5lOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0K
PiAtCW1iID0gc21pLT5jaGlwX2RhdGE7DQo+ICsJbWIgPSBwcml2LT5jaGlwX2RhdGE7DQo+ICAg
DQo+IC0JcmV0ID0gcnRsODM2NW1iX2dldF9hbmRfY2xlYXJfc3RhdHVzX3JlZyhzbWksIFJUTDgz
NjVNQl9JTlRSX1NUQVRVU19SRUcsDQo+ICsJcmV0ID0gcnRsODM2NW1iX2dldF9hbmRfY2xlYXJf
c3RhdHVzX3JlZyhwcml2LCBSVEw4MzY1TUJfSU5UUl9TVEFUVVNfUkVHLA0KPiAgIAkJCQkJCSAm
c3RhdCk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlnb3RvIG91dF9lcnJvcjsNCj4gQEAgLTE0ODUs
MTQgKzE0ODUsMTQgQEAgc3RhdGljIGlycXJldHVybl90IHJ0bDgzNjVtYl9pcnEoaW50IGlycSwg
dm9pZCAqZGF0YSkNCj4gICAJCXUzMiB2YWw7DQo+ICAgDQo+ICAgCQlyZXQgPSBydGw4MzY1bWJf
Z2V0X2FuZF9jbGVhcl9zdGF0dXNfcmVnKA0KPiAtCQkJc21pLCBSVEw4MzY1TUJfUE9SVF9MSU5L
VVBfSU5EX1JFRywgJnZhbCk7DQo+ICsJCQlwcml2LCBSVEw4MzY1TUJfUE9SVF9MSU5LVVBfSU5E
X1JFRywgJnZhbCk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCWdvdG8gb3V0X2Vycm9yOw0KPiAg
IA0KPiAgIAkJbGlua3VwX2luZCA9IEZJRUxEX0dFVChSVEw4MzY1TUJfUE9SVF9MSU5LVVBfSU5E
X01BU0ssIHZhbCk7DQo+ICAgDQo+ICAgCQlyZXQgPSBydGw4MzY1bWJfZ2V0X2FuZF9jbGVhcl9z
dGF0dXNfcmVnKA0KPiAtCQkJc21pLCBSVEw4MzY1TUJfUE9SVF9MSU5LRE9XTl9JTkRfUkVHLCAm
dmFsKTsNCj4gKwkJCXByaXYsIFJUTDgzNjVNQl9QT1JUX0xJTktET1dOX0lORF9SRUcsICZ2YWwp
Ow0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlnb3RvIG91dF9lcnJvcjsNCj4gICANCj4gQEAgLTE1
MDQsOCArMTUwNCw4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBydGw4MzY1bWJfaXJxKGludCBpcnEs
IHZvaWQgKmRhdGEpDQo+ICAgCWlmICghbGluZV9jaGFuZ2VzKQ0KPiAgIAkJZ290byBvdXRfbm9u
ZTsNCj4gICANCj4gLQlmb3JfZWFjaF9zZXRfYml0KGxpbmUsICZsaW5lX2NoYW5nZXMsIHNtaS0+
bnVtX3BvcnRzKSB7DQo+IC0JCWludCBjaGlsZF9pcnEgPSBpcnFfZmluZF9tYXBwaW5nKHNtaS0+
aXJxZG9tYWluLCBsaW5lKTsNCj4gKwlmb3JfZWFjaF9zZXRfYml0KGxpbmUsICZsaW5lX2NoYW5n
ZXMsIHByaXYtPm51bV9wb3J0cykgew0KPiArCQlpbnQgY2hpbGRfaXJxID0gaXJxX2ZpbmRfbWFw
cGluZyhwcml2LT5pcnFkb21haW4sIGxpbmUpOw0KPiAgIA0KPiAgIAkJaGFuZGxlX25lc3RlZF9p
cnEoY2hpbGRfaXJxKTsNCj4gICAJfQ0KPiBAQCAtMTUxMyw3ICsxNTEzLDcgQEAgc3RhdGljIGly
cXJldHVybl90IHJ0bDgzNjVtYl9pcnEoaW50IGlycSwgdm9pZCAqZGF0YSkNCj4gICAJcmV0dXJu
IElSUV9IQU5ETEVEOw0KPiAgIA0KPiAgIG91dF9lcnJvcjoNCj4gLQlkZXZfZXJyKHNtaS0+ZGV2
LCAiZmFpbGVkIHRvIHJlYWQgaW50ZXJydXB0IHN0YXR1czogJWRcbiIsIHJldCk7DQo+ICsJZGV2
X2Vycihwcml2LT5kZXYsICJmYWlsZWQgdG8gcmVhZCBpbnRlcnJ1cHQgc3RhdHVzOiAlZFxuIiwg
cmV0KTsNCj4gICANCj4gICBvdXRfbm9uZToNCj4gICAJcmV0dXJuIElSUV9OT05FOw0KPiBAQCAt
MTU0OCwyNyArMTU0OCwyNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGlycV9kb21haW5fb3BzIHJ0
bDgzNjVtYl9pcnFkb21haW5fb3BzID0gew0KPiAgIAkueGxhdGUgPSBpcnFfZG9tYWluX3hsYXRl
X29uZWNlbGwsDQo+ICAgfTsNCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NW1iX3NldF9pcnFf
ZW5hYmxlKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBib29sIGVuYWJsZSkNCj4gK3N0YXRpYyBp
bnQgcnRsODM2NW1iX3NldF9pcnFfZW5hYmxlKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIGJv
b2wgZW5hYmxlKQ0KPiAgIHsNCj4gLQlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFw
LCBSVEw4MzY1TUJfSU5UUl9DVFJMX1JFRywNCj4gKwlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRz
KHByaXYtPm1hcCwgUlRMODM2NU1CX0lOVFJfQ1RSTF9SRUcsDQo+ICAgCQkJCSAgUlRMODM2NU1C
X0lOVFJfTElOS19DSEFOR0VfTUFTSywNCj4gICAJCQkJICBGSUVMRF9QUkVQKFJUTDgzNjVNQl9J
TlRSX0xJTktfQ0hBTkdFX01BU0ssDQo+ICAgCQkJCQkgICAgIGVuYWJsZSA/IDEgOiAwKSk7DQo+
ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY1bWJfaXJxX2VuYWJsZShzdHJ1Y3QgcmVh
bHRla19zbWkgKnNtaSkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NW1iX2lycV9lbmFibGUoc3RydWN0
IHJlYWx0ZWtfcHJpdiAqcHJpdikNCj4gICB7DQo+IC0JcmV0dXJuIHJ0bDgzNjVtYl9zZXRfaXJx
X2VuYWJsZShzbWksIHRydWUpOw0KPiArCXJldHVybiBydGw4MzY1bWJfc2V0X2lycV9lbmFibGUo
cHJpdiwgdHJ1ZSk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY1bWJfaXJxX2Rp
c2FibGUoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9p
cnFfZGlzYWJsZShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gLQlyZXR1cm4g
cnRsODM2NW1iX3NldF9pcnFfZW5hYmxlKHNtaSwgZmFsc2UpOw0KPiArCXJldHVybiBydGw4MzY1
bWJfc2V0X2lycV9lbmFibGUocHJpdiwgZmFsc2UpOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBp
bnQgcnRsODM2NW1iX2lycV9zZXR1cChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gK3N0YXRp
YyBpbnQgcnRsODM2NW1iX2lycV9zZXR1cChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAg
IHsNCj4gLQlzdHJ1Y3QgcnRsODM2NW1iICptYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiArCXN0cnVj
dCBydGw4MzY1bWIgKm1iID0gcHJpdi0+Y2hpcF9kYXRhOw0KPiAgIAlzdHJ1Y3QgZGV2aWNlX25v
ZGUgKmludGM7DQo+ICAgCXUzMiBpcnFfdHJpZzsNCj4gICAJaW50IHZpcnE7DQo+IEBAIC0xNTc3
LDkgKzE1NzcsOSBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9pcnFfc2V0dXAoc3RydWN0IHJlYWx0
ZWtfc21pICpzbWkpDQo+ICAgCWludCByZXQ7DQo+ICAgCWludCBpOw0KPiAgIA0KPiAtCWludGMg
PSBvZl9nZXRfY2hpbGRfYnlfbmFtZShzbWktPmRldi0+b2Zfbm9kZSwgImludGVycnVwdC1jb250
cm9sbGVyIik7DQo+ICsJaW50YyA9IG9mX2dldF9jaGlsZF9ieV9uYW1lKHByaXYtPmRldi0+b2Zf
bm9kZSwgImludGVycnVwdC1jb250cm9sbGVyIik7DQo+ICAgCWlmICghaW50Yykgew0KPiAtCQlk
ZXZfZXJyKHNtaS0+ZGV2LCAibWlzc2luZyBjaGlsZCBpbnRlcnJ1cHQtY29udHJvbGxlciBub2Rl
XG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsICJtaXNzaW5nIGNoaWxkIGludGVycnVwdC1j
b250cm9sbGVyIG5vZGVcbiIpOw0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgCX0NCj4gICAN
Cj4gQEAgLTE1ODcsMjQgKzE1ODcsMjQgQEAgc3RhdGljIGludCBydGw4MzY1bWJfaXJxX3NldHVw
KHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiAgIAlpcnEgPSBvZl9pcnFfZ2V0KGludGMsIDAp
Ow0KPiAgIAlpZiAoaXJxIDw9IDApIHsNCj4gICAJCWlmIChpcnEgIT0gLUVQUk9CRV9ERUZFUikN
Cj4gLQkJCWRldl9lcnIoc21pLT5kZXYsICJmYWlsZWQgdG8gZ2V0IHBhcmVudCBpcnE6ICVkXG4i
LA0KPiArCQkJZGV2X2Vycihwcml2LT5kZXYsICJmYWlsZWQgdG8gZ2V0IHBhcmVudCBpcnE6ICVk
XG4iLA0KPiAgIAkJCQlpcnEpOw0KPiAgIAkJcmV0ID0gaXJxID8gaXJxIDogLUVJTlZBTDsNCj4g
ICAJCWdvdG8gb3V0X3B1dF9ub2RlOw0KPiAgIAl9DQo+ICAgDQo+IC0Jc21pLT5pcnFkb21haW4g
PSBpcnFfZG9tYWluX2FkZF9saW5lYXIoaW50Yywgc21pLT5udW1fcG9ydHMsDQo+IC0JCQkJCSAg
ICAgICAmcnRsODM2NW1iX2lycWRvbWFpbl9vcHMsIHNtaSk7DQo+IC0JaWYgKCFzbWktPmlycWRv
bWFpbikgew0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAiZmFpbGVkIHRvIGFkZCBpcnEgZG9tYWlu
XG4iKTsNCj4gKwlwcml2LT5pcnFkb21haW4gPSBpcnFfZG9tYWluX2FkZF9saW5lYXIoaW50Yywg
cHJpdi0+bnVtX3BvcnRzLA0KPiArCQkJCQkgICAgICAgJnJ0bDgzNjVtYl9pcnFkb21haW5fb3Bz
LCBwcml2KTsNCj4gKwlpZiAoIXByaXYtPmlycWRvbWFpbikgew0KPiArCQlkZXZfZXJyKHByaXYt
PmRldiwgImZhaWxlZCB0byBhZGQgaXJxIGRvbWFpblxuIik7DQo+ICAgCQlyZXQgPSAtRU5PTUVN
Ow0KPiAgIAkJZ290byBvdXRfcHV0X25vZGU7DQo+ICAgCX0NCj4gICANCj4gLQlmb3IgKGkgPSAw
OyBpIDwgc21pLT5udW1fcG9ydHM7IGkrKykgew0KPiAtCQl2aXJxID0gaXJxX2NyZWF0ZV9tYXBw
aW5nKHNtaS0+aXJxZG9tYWluLCBpKTsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+bnVtX3Bv
cnRzOyBpKyspIHsNCj4gKwkJdmlycSA9IGlycV9jcmVhdGVfbWFwcGluZyhwcml2LT5pcnFkb21h
aW4sIGkpOw0KPiAgIAkJaWYgKCF2aXJxKSB7DQo+IC0JCQlkZXZfZXJyKHNtaS0+ZGV2LA0KPiAr
CQkJZGV2X2Vycihwcml2LT5kZXYsDQo+ICAgCQkJCSJmYWlsZWQgdG8gY3JlYXRlIGlycSBkb21h
aW4gbWFwcGluZ1xuIik7DQo+ICAgCQkJcmV0ID0gLUVJTlZBTDsNCj4gICAJCQlnb3RvIG91dF9y
ZW1vdmVfaXJxZG9tYWluOw0KPiBAQCAtMTYyNSw0MCArMTYyNSw0MCBAQCBzdGF0aWMgaW50IHJ0
bDgzNjVtYl9pcnFfc2V0dXAoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICAgCQl2YWwgPSBS
VEw4MzY1TUJfSU5UUl9QT0xBUklUWV9MT1c7DQo+ICAgCQlicmVhazsNCj4gICAJZGVmYXVsdDoN
Cj4gLQkJZGV2X2VycihzbWktPmRldiwgInVuc3VwcG9ydGVkIGlycSB0cmlnZ2VyIHR5cGUgJXVc
biIsDQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAidW5zdXBwb3J0ZWQgaXJxIHRyaWdnZXIgdHlw
ZSAldVxuIiwNCj4gICAJCQlpcnFfdHJpZyk7DQo+ICAgCQlyZXQgPSAtRUlOVkFMOw0KPiAgIAkJ
Z290byBvdXRfcmVtb3ZlX2lycWRvbWFpbjsNCj4gICAJfQ0KPiAgIA0KPiAtCXJldCA9IHJlZ21h
cF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2NU1CX0lOVFJfUE9MQVJJVFlfUkVHLA0KPiAr
CXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjVNQl9JTlRSX1BPTEFS
SVRZX1JFRywNCj4gICAJCQkJIFJUTDgzNjVNQl9JTlRSX1BPTEFSSVRZX01BU0ssDQo+ICAgCQkJ
CSBGSUVMRF9QUkVQKFJUTDgzNjVNQl9JTlRSX1BPTEFSSVRZX01BU0ssIHZhbCkpOw0KPiAgIAlp
ZiAocmV0KQ0KPiAgIAkJZ290byBvdXRfcmVtb3ZlX2lycWRvbWFpbjsNCj4gICANCj4gICAJLyog
RGlzYWJsZSB0aGUgaW50ZXJydXB0IGluIGNhc2UgdGhlIGNoaXAgaGFzIGl0IGVuYWJsZWQgb24g
cmVzZXQgKi8NCj4gLQlyZXQgPSBydGw4MzY1bWJfaXJxX2Rpc2FibGUoc21pKTsNCj4gKwlyZXQg
PSBydGw4MzY1bWJfaXJxX2Rpc2FibGUocHJpdik7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlnb3Rv
IG91dF9yZW1vdmVfaXJxZG9tYWluOw0KPiAgIA0KPiAgIAkvKiBDbGVhciB0aGUgaW50ZXJydXB0
IHN0YXR1cyByZWdpc3RlciAqLw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgUlRM
ODM2NU1CX0lOVFJfU1RBVFVTX1JFRywNCj4gKwlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFw
LCBSVEw4MzY1TUJfSU5UUl9TVEFUVVNfUkVHLA0KPiAgIAkJCSAgIFJUTDgzNjVNQl9JTlRSX0FM
TF9NQVNLKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCWdvdG8gb3V0X3JlbW92ZV9pcnFkb21haW47
DQo+ICAgDQo+ICAgCXJldCA9IHJlcXVlc3RfdGhyZWFkZWRfaXJxKGlycSwgTlVMTCwgcnRsODM2
NW1iX2lycSwgSVJRRl9PTkVTSE9ULA0KPiAtCQkJCSAgICJydGw4MzY1bWIiLCBzbWkpOw0KPiAr
CQkJCSAgICJydGw4MzY1bWIiLCBwcml2KTsNCj4gICAJaWYgKHJldCkgew0KPiAtCQlkZXZfZXJy
KHNtaS0+ZGV2LCAiZmFpbGVkIHRvIHJlcXVlc3QgaXJxOiAlZFxuIiwgcmV0KTsNCj4gKwkJZGV2
X2Vycihwcml2LT5kZXYsICJmYWlsZWQgdG8gcmVxdWVzdCBpcnE6ICVkXG4iLCByZXQpOw0KPiAg
IAkJZ290byBvdXRfcmVtb3ZlX2lycWRvbWFpbjsNCj4gICAJfQ0KPiAgIA0KPiAgIAkvKiBTdG9y
ZSB0aGUgaXJxIHNvIHRoYXQgd2Uga25vdyB0byBmcmVlIGl0IGR1cmluZyB0ZWFyZG93biAqLw0K
PiAgIAltYi0+aXJxID0gaXJxOw0KPiAgIA0KPiAtCXJldCA9IHJ0bDgzNjVtYl9pcnFfZW5hYmxl
KHNtaSk7DQo+ICsJcmV0ID0gcnRsODM2NW1iX2lycV9lbmFibGUocHJpdik7DQo+ICAgCWlmIChy
ZXQpDQo+ICAgCQlnb3RvIG91dF9mcmVlX2lycTsNCj4gICANCj4gQEAgLTE2NjcsMTcgKzE2Njcs
MTcgQEAgc3RhdGljIGludCBydGw4MzY1bWJfaXJxX3NldHVwKHN0cnVjdCByZWFsdGVrX3NtaSAq
c21pKQ0KPiAgIAlyZXR1cm4gMDsNCj4gICANCj4gICBvdXRfZnJlZV9pcnE6DQo+IC0JZnJlZV9p
cnEobWItPmlycSwgc21pKTsNCj4gKwlmcmVlX2lycShtYi0+aXJxLCBwcml2KTsNCj4gICAJbWIt
PmlycSA9IDA7DQo+ICAgDQo+ICAgb3V0X3JlbW92ZV9pcnFkb21haW46DQo+IC0JZm9yIChpID0g
MDsgaSA8IHNtaS0+bnVtX3BvcnRzOyBpKyspIHsNCj4gLQkJdmlycSA9IGlycV9maW5kX21hcHBp
bmcoc21pLT5pcnFkb21haW4sIGkpOw0KPiArCWZvciAoaSA9IDA7IGkgPCBwcml2LT5udW1fcG9y
dHM7IGkrKykgew0KPiArCQl2aXJxID0gaXJxX2ZpbmRfbWFwcGluZyhwcml2LT5pcnFkb21haW4s
IGkpOw0KPiAgIAkJaXJxX2Rpc3Bvc2VfbWFwcGluZyh2aXJxKTsNCj4gICAJfQ0KPiAgIA0KPiAt
CWlycV9kb21haW5fcmVtb3ZlKHNtaS0+aXJxZG9tYWluKTsNCj4gLQlzbWktPmlycWRvbWFpbiA9
IE5VTEw7DQo+ICsJaXJxX2RvbWFpbl9yZW1vdmUocHJpdi0+aXJxZG9tYWluKTsNCj4gKwlwcml2
LT5pcnFkb21haW4gPSBOVUxMOw0KPiAgIA0KPiAgIG91dF9wdXRfbm9kZToNCj4gICAJb2Zfbm9k
ZV9wdXQoaW50Yyk7DQo+IEBAIC0xNjg1LDM2ICsxNjg1LDM2IEBAIHN0YXRpYyBpbnQgcnRsODM2
NW1iX2lycV9zZXR1cChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gICAJcmV0dXJuIHJldDsN
Cj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgdm9pZCBydGw4MzY1bWJfaXJxX3RlYXJkb3duKHN0cnVj
dCByZWFsdGVrX3NtaSAqc21pKQ0KPiArc3RhdGljIHZvaWQgcnRsODM2NW1iX2lycV90ZWFyZG93
bihzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcnRsODM2NW1i
ICptYiA9IHNtaS0+Y2hpcF9kYXRhOw0KPiArCXN0cnVjdCBydGw4MzY1bWIgKm1iID0gcHJpdi0+
Y2hpcF9kYXRhOw0KPiAgIAlpbnQgdmlycTsNCj4gICAJaW50IGk7DQo+ICAgDQo+ICAgCWlmICht
Yi0+aXJxKSB7DQo+IC0JCWZyZWVfaXJxKG1iLT5pcnEsIHNtaSk7DQo+ICsJCWZyZWVfaXJxKG1i
LT5pcnEsIHByaXYpOw0KPiAgIAkJbWItPmlycSA9IDA7DQo+ICAgCX0NCj4gICANCj4gLQlpZiAo
c21pLT5pcnFkb21haW4pIHsNCj4gLQkJZm9yIChpID0gMDsgaSA8IHNtaS0+bnVtX3BvcnRzOyBp
KyspIHsNCj4gLQkJCXZpcnEgPSBpcnFfZmluZF9tYXBwaW5nKHNtaS0+aXJxZG9tYWluLCBpKTsN
Cj4gKwlpZiAocHJpdi0+aXJxZG9tYWluKSB7DQo+ICsJCWZvciAoaSA9IDA7IGkgPCBwcml2LT5u
dW1fcG9ydHM7IGkrKykgew0KPiArCQkJdmlycSA9IGlycV9maW5kX21hcHBpbmcocHJpdi0+aXJx
ZG9tYWluLCBpKTsNCj4gICAJCQlpcnFfZGlzcG9zZV9tYXBwaW5nKHZpcnEpOw0KPiAgIAkJfQ0K
PiAgIA0KPiAtCQlpcnFfZG9tYWluX3JlbW92ZShzbWktPmlycWRvbWFpbik7DQo+IC0JCXNtaS0+
aXJxZG9tYWluID0gTlVMTDsNCj4gKwkJaXJxX2RvbWFpbl9yZW1vdmUocHJpdi0+aXJxZG9tYWlu
KTsNCj4gKwkJcHJpdi0+aXJxZG9tYWluID0gTlVMTDsNCj4gICAJfQ0KPiAgIH0NCj4gICANCj4g
LXN0YXRpYyBpbnQgcnRsODM2NW1iX2NwdV9jb25maWcoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkp
DQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9jcHVfY29uZmlnKHN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYpDQo+ICAgew0KPiAtCXN0cnVjdCBydGw4MzY1bWIgKm1iID0gc21pLT5jaGlwX2RhdGE7
DQo+ICsJc3RydWN0IHJ0bDgzNjVtYiAqbWIgPSBwcml2LT5jaGlwX2RhdGE7DQo+ICAgCXN0cnVj
dCBydGw4MzY1bWJfY3B1ICpjcHUgPSAmbWItPmNwdTsNCj4gICAJdTMyIHZhbDsNCj4gICAJaW50
IHJldDsNCj4gICANCj4gLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoc21pLT5tYXAsIFJUTDgz
NjVNQl9DUFVfUE9SVF9NQVNLX1JFRywNCj4gKwlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJp
di0+bWFwLCBSVEw4MzY1TUJfQ1BVX1BPUlRfTUFTS19SRUcsDQo+ICAgCQkJCSBSVEw4MzY1TUJf
Q1BVX1BPUlRfTUFTS19NQVNLLA0KPiAgIAkJCQkgRklFTERfUFJFUChSVEw4MzY1TUJfQ1BVX1BP
UlRfTUFTS19NQVNLLA0KPiAgIAkJCQkJICAgIGNwdS0+bWFzaykpOw0KPiBAQCAtMTcyOSwyMyAr
MTcyOSwyMyBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9jcHVfY29uZmlnKHN0cnVjdCByZWFsdGVr
X3NtaSAqc21pKQ0KPiAgIAkgICAgICBGSUVMRF9QUkVQKFJUTDgzNjVNQl9DUFVfQ1RSTF9UUkFQ
X1BPUlRfTUFTSywgY3B1LT50cmFwX3BvcnQpIHwNCj4gICAJICAgICAgRklFTERfUFJFUChSVEw4
MzY1TUJfQ1BVX0NUUkxfVFJBUF9QT1JUX0VYVF9NQVNLLA0KPiAgIAkJCSBjcHUtPnRyYXBfcG9y
dCA+PiAzKTsNCj4gLQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIFJUTDgzNjVNQl9DUFVf
Q1RSTF9SRUcsIHZhbCk7DQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRMODM2
NU1CX0NQVV9DVFJMX1JFRywgdmFsKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7
DQo+ICAgDQo+ICAgCXJldHVybiAwOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2
NW1iX3N3aXRjaF9pbml0KHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiArc3RhdGljIGludCBy
dGw4MzY1bWJfc3dpdGNoX2luaXQoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdikNCj4gICB7DQo+
IC0Jc3RydWN0IHJ0bDgzNjVtYiAqbWIgPSBzbWktPmNoaXBfZGF0YTsNCj4gKwlzdHJ1Y3QgcnRs
ODM2NW1iICptYiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICAJaW50IHJldDsNCj4gICAJaW50IGk7
DQo+ICAgDQo+ICAgCS8qIERvIGFueSBjaGlwLXNwZWNpZmljIGluaXQgamFtIGJlZm9yZSBnZXR0
aW5nIHRvIHRoZSBjb21tb24gc3R1ZmYgKi8NCj4gICAJaWYgKG1iLT5qYW1fdGFibGUpIHsNCj4g
ICAJCWZvciAoaSA9IDA7IGkgPCBtYi0+amFtX3NpemU7IGkrKykgew0KPiAtCQkJcmV0ID0gcmVn
bWFwX3dyaXRlKHNtaS0+bWFwLCBtYi0+amFtX3RhYmxlW2ldLnJlZywNCj4gKwkJCXJldCA9IHJl
Z21hcF93cml0ZShwcml2LT5tYXAsIG1iLT5qYW1fdGFibGVbaV0ucmVnLA0KPiAgIAkJCQkJICAg
bWItPmphbV90YWJsZVtpXS52YWwpOw0KPiAgIAkJCWlmIChyZXQpDQo+ICAgCQkJCXJldHVybiBy
ZXQ7DQo+IEBAIC0xNzU0LDcgKzE3NTQsNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjVtYl9zd2l0Y2hf
aW5pdChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gICANCj4gICAJLyogQ29tbW9uIGluaXQg
amFtICovDQo+ICAgCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHJ0bDgzNjVtYl9pbml0X2ph
bV9jb21tb24pOyBpKyspIHsNCj4gLQkJcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+bWFwLCBydGw4
MzY1bWJfaW5pdF9qYW1fY29tbW9uW2ldLnJlZywNCj4gKwkJcmV0ID0gcmVnbWFwX3dyaXRlKHBy
aXYtPm1hcCwgcnRsODM2NW1iX2luaXRfamFtX2NvbW1vbltpXS5yZWcsDQo+ICAgCQkJCSAgIHJ0
bDgzNjVtYl9pbml0X2phbV9jb21tb25baV0udmFsKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJ
cmV0dXJuIHJldDsNCj4gQEAgLTE3NjMsMTEgKzE3NjMsMTEgQEAgc3RhdGljIGludCBydGw4MzY1
bWJfc3dpdGNoX2luaXQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICAgCXJldHVybiAwOw0K
PiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NW1iX3Jlc2V0X2NoaXAoc3RydWN0IHJl
YWx0ZWtfc21pICpzbWkpDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9yZXNldF9jaGlwKHN0cnVj
dCByZWFsdGVrX3ByaXYgKnByaXYpDQo+ICAgew0KPiAgIAl1MzIgdmFsOw0KPiAgIA0KPiAtCXJl
YWx0ZWtfc21pX3dyaXRlX3JlZ19ub2FjayhzbWksIFJUTDgzNjVNQl9DSElQX1JFU0VUX1JFRywN
Cj4gKwlwcml2LT53cml0ZV9yZWdfbm9hY2socHJpdiwgUlRMODM2NU1CX0NISVBfUkVTRVRfUkVH
LA0KPiAgIAkJCQkgICAgRklFTERfUFJFUChSVEw4MzY1TUJfQ0hJUF9SRVNFVF9IV19NQVNLLA0K
PiAgIAkJCQkJICAgICAgIDEpKTsNCg0Kd3JpdGVfcmVnX25vYWNrIGlzbid0IHNldCBhbnl3aGVy
ZSBpbiB0aGlzIHBhdGNoLCBzbyB0aGlzIGlzIA0KZGVyZWZlcmVuY2luZyBOVUxMLg0KDQo+ICAg
DQo+IEBAIC0xNzc1LDYzICsxNzc1LDYzIEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX3Jlc2V0X2No
aXAoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICAgCSAqIGZvciAxMDAgbXMgYmVmb3JlIGFj
Y2Vzc2luZyBhbnkgcmVnaXN0ZXJzIHRvIHByZXZlbnQgQUNLIHRpbWVvdXRzLg0KPiAgIAkgKi8N
Cj4gICAJbXNsZWVwKDEwMCk7DQo+IC0JcmV0dXJuIHJlZ21hcF9yZWFkX3BvbGxfdGltZW91dChz
bWktPm1hcCwgUlRMODM2NU1CX0NISVBfUkVTRVRfUkVHLCB2YWwsDQo+ICsJcmV0dXJuIHJlZ21h
cF9yZWFkX3BvbGxfdGltZW91dChwcml2LT5tYXAsIFJUTDgzNjVNQl9DSElQX1JFU0VUX1JFRywg
dmFsLA0KPiAgIAkJCQkJISh2YWwgJiBSVEw4MzY1TUJfQ0hJUF9SRVNFVF9IV19NQVNLKSwNCj4g
ICAJCQkJCTIwMDAwLCAxZTYpOw0KPiAgIH0NCj4gICANCj4gICBzdGF0aWMgaW50IHJ0bDgzNjVt
Yl9zZXR1cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgew0KPiAtCXN0cnVjdCByZWFsdGVr
X3NtaSAqc21pID0gZHMtPnByaXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiA9IGRz
LT5wcml2Ow0KPiAgIAlzdHJ1Y3QgcnRsODM2NW1iICptYjsNCj4gICAJaW50IHJldDsNCj4gICAJ
aW50IGk7DQo+ICAgDQo+IC0JbWIgPSBzbWktPmNoaXBfZGF0YTsNCj4gKwltYiA9IHByaXYtPmNo
aXBfZGF0YTsNCj4gICANCj4gLQlyZXQgPSBydGw4MzY1bWJfcmVzZXRfY2hpcChzbWkpOw0KPiAr
CXJldCA9IHJ0bDgzNjVtYl9yZXNldF9jaGlwKHByaXYpOw0KPiAgIAlpZiAocmV0KSB7DQo+IC0J
CWRldl9lcnIoc21pLT5kZXYsICJmYWlsZWQgdG8gcmVzZXQgY2hpcDogJWRcbiIsIHJldCk7DQo+
ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAiZmFpbGVkIHRvIHJlc2V0IGNoaXA6ICVkXG4iLCByZXQp
Ow0KPiAgIAkJZ290byBvdXRfZXJyb3I7DQo+ICAgCX0NCj4gICANCj4gICAJLyogQ29uZmlndXJl
IHN3aXRjaCB0byB2ZW5kb3ItZGVmaW5lZCBpbml0aWFsIHN0YXRlICovDQo+IC0JcmV0ID0gcnRs
ODM2NW1iX3N3aXRjaF9pbml0KHNtaSk7DQo+ICsJcmV0ID0gcnRsODM2NW1iX3N3aXRjaF9pbml0
KHByaXYpOw0KPiAgIAlpZiAocmV0KSB7DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJmYWlsZWQg
dG8gaW5pdGlhbGl6ZSBzd2l0Y2g6ICVkXG4iLCByZXQpOw0KPiArCQlkZXZfZXJyKHByaXYtPmRl
diwgImZhaWxlZCB0byBpbml0aWFsaXplIHN3aXRjaDogJWRcbiIsIHJldCk7DQo+ICAgCQlnb3Rv
IG91dF9lcnJvcjsNCj4gICAJfQ0KPiAgIA0KPiAgIAkvKiBTZXQgdXAgY2FzY2FkaW5nIElSUXMg
Ki8NCj4gLQlyZXQgPSBydGw4MzY1bWJfaXJxX3NldHVwKHNtaSk7DQo+ICsJcmV0ID0gcnRsODM2
NW1iX2lycV9zZXR1cChwcml2KTsNCj4gICAJaWYgKHJldCA9PSAtRVBST0JFX0RFRkVSKQ0KPiAg
IAkJcmV0dXJuIHJldDsNCj4gICAJZWxzZSBpZiAocmV0KQ0KPiAtCQlkZXZfaW5mbyhzbWktPmRl
diwgIm5vIGludGVycnVwdCBzdXBwb3J0XG4iKTsNCj4gKwkJZGV2X2luZm8ocHJpdi0+ZGV2LCAi
bm8gaW50ZXJydXB0IHN1cHBvcnRcbiIpOw0KPiAgIA0KPiAgIAkvKiBDb25maWd1cmUgQ1BVIHRh
Z2dpbmcgKi8NCj4gLQlyZXQgPSBydGw4MzY1bWJfY3B1X2NvbmZpZyhzbWkpOw0KPiArCXJldCA9
IHJ0bDgzNjVtYl9jcHVfY29uZmlnKHByaXYpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBv
dXRfdGVhcmRvd25faXJxOw0KPiAgIA0KPiAgIAkvKiBDb25maWd1cmUgcG9ydHMgKi8NCj4gLQlm
b3IgKGkgPSAwOyBpIDwgc21pLT5udW1fcG9ydHM7IGkrKykgew0KPiArCWZvciAoaSA9IDA7IGkg
PCBwcml2LT5udW1fcG9ydHM7IGkrKykgew0KPiAgIAkJc3RydWN0IHJ0bDgzNjVtYl9wb3J0ICpw
ID0gJm1iLT5wb3J0c1tpXTsNCj4gICANCj4gLQkJaWYgKGRzYV9pc191bnVzZWRfcG9ydChzbWkt
PmRzLCBpKSkNCj4gKwkJaWYgKGRzYV9pc191bnVzZWRfcG9ydChwcml2LT5kcywgaSkpDQo+ICAg
CQkJY29udGludWU7DQo+ICAgDQo+ICAgCQkvKiBTZXQgdXAgcGVyLXBvcnQgcHJpdmF0ZSBkYXRh
ICovDQo+IC0JCXAtPnNtaSA9IHNtaTsNCj4gKwkJcC0+cHJpdiA9IHByaXY7DQo+ICAgCQlwLT5p
bmRleCA9IGk7DQo+ICAgDQo+ICAgCQkvKiBGb3J3YXJkIG9ubHkgdG8gdGhlIENQVSAqLw0KPiAt
CQlyZXQgPSBydGw4MzY1bWJfcG9ydF9zZXRfaXNvbGF0aW9uKHNtaSwgaSwgQklUKHNtaS0+Y3B1
X3BvcnQpKTsNCj4gKwkJcmV0ID0gcnRsODM2NW1iX3BvcnRfc2V0X2lzb2xhdGlvbihwcml2LCBp
LCBCSVQocHJpdi0+Y3B1X3BvcnQpKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJZ290byBvdXRf
dGVhcmRvd25faXJxOw0KPiAgIA0KPiAgIAkJLyogRGlzYWJsZSBsZWFybmluZyAqLw0KPiAtCQly
ZXQgPSBydGw4MzY1bWJfcG9ydF9zZXRfbGVhcm5pbmcoc21pLCBpLCBmYWxzZSk7DQo+ICsJCXJl
dCA9IHJ0bDgzNjVtYl9wb3J0X3NldF9sZWFybmluZyhwcml2LCBpLCBmYWxzZSk7DQo+ICAgCQlp
ZiAocmV0KQ0KPiAgIAkJCWdvdG8gb3V0X3RlYXJkb3duX2lycTsNCj4gICANCj4gQEAgLTE4Mzks
MjkgKzE4MzksMzEgQEAgc3RhdGljIGludCBydGw4MzY1bWJfc2V0dXAoc3RydWN0IGRzYV9zd2l0
Y2ggKmRzKQ0KPiAgIAkJICogcG9ydHMgd2lsbCBzdGlsbCBmb3J3YXJkIGZyYW1lcyB0byB0aGUg
Q1BVIGRlc3BpdGUgYmVpbmcNCj4gICAJCSAqIGFkbWluaXN0cmF0aXZlbHkgZG93biBieSBkZWZh
dWx0Lg0KPiAgIAkJICovDQo+IC0JCXJ0bDgzNjVtYl9wb3J0X3N0cF9zdGF0ZV9zZXQoc21pLT5k
cywgaSwgQlJfU1RBVEVfRElTQUJMRUQpOw0KPiArCQlydGw4MzY1bWJfcG9ydF9zdHBfc3RhdGVf
c2V0KHByaXYtPmRzLCBpLCBCUl9TVEFURV9ESVNBQkxFRCk7DQo+ICAgCX0NCj4gICANCj4gICAJ
LyogU2V0IG1heGltdW0gcGFja2V0IGxlbmd0aCB0byAxNTM2IGJ5dGVzICovDQo+IC0JcmV0ID0g
cmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY1TUJfQ0ZHMF9NQVhfTEVOX1JFRywN
Cj4gKwlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY1TUJfQ0ZHMF9N
QVhfTEVOX1JFRywNCj4gICAJCQkJIFJUTDgzNjVNQl9DRkcwX01BWF9MRU5fTUFTSywNCj4gICAJ
CQkJIEZJRUxEX1BSRVAoUlRMODM2NU1CX0NGRzBfTUFYX0xFTl9NQVNLLCAxNTM2KSk7DQo+ICAg
CWlmIChyZXQpDQo+ICAgCQlnb3RvIG91dF90ZWFyZG93bl9pcnE7DQo+ICAgDQo+IC0JcmV0ID0g
cmVhbHRla19zbWlfc2V0dXBfbWRpbyhzbWkpOw0KPiAtCWlmIChyZXQpIHsNCj4gLQkJZGV2X2Vy
cihzbWktPmRldiwgImNvdWxkIG5vdCBzZXQgdXAgTURJTyBidXNcbiIpOw0KPiAtCQlnb3RvIG91
dF90ZWFyZG93bl9pcnE7DQo+ICsJaWYgKHByaXYtPnNldHVwX2ludGVyZmFjZSAhPSBOVUxMKSB7
DQoNClRoaXMgaXMgYWxzbyBub3Qgc2V0LiBEaWQgaXQgbGFuZCBpbiBhbm90aGVyIHBhdGNoPw0K
DQo+ICsJCXJldCA9IHByaXYtPnNldHVwX2ludGVyZmFjZShkcyk7DQo+ICsJCWlmIChyZXQpIHsN
Cj4gKwkJCWRldl9lcnIocHJpdi0+ZGV2LCAiY291bGQgbm90IHNldCB1cCBNRElPIGJ1c1xuIik7
DQo+ICsJCQlnb3RvIG91dF90ZWFyZG93bl9pcnE7DQo+ICsJCX0NCj4gICAJfQ0KPiAgIA0KPiAg
IAkvKiBTdGFydCBzdGF0aXN0aWNzIGNvdW50ZXIgcG9sbGluZyAqLw0KPiAtCXJ0bDgzNjVtYl9z
dGF0c19zZXR1cChzbWkpOw0KPiArCXJ0bDgzNjVtYl9zdGF0c19zZXR1cChwcml2KTsNCj4gICAN
Cj4gICAJcmV0dXJuIDA7DQo+ICAgDQo+ICAgb3V0X3RlYXJkb3duX2lycToNCj4gLQlydGw4MzY1
bWJfaXJxX3RlYXJkb3duKHNtaSk7DQo+ICsJcnRsODM2NW1iX2lycV90ZWFyZG93bihwcml2KTsN
Cj4gICANCj4gICBvdXRfZXJyb3I6DQo+ICAgCXJldHVybiByZXQ7DQo+IEBAIC0xODY5LDEwICsx
ODcxLDEwIEBAIHN0YXRpYyBpbnQgcnRsODM2NW1iX3NldHVwKHN0cnVjdCBkc2Ffc3dpdGNoICpk
cykNCj4gICANCj4gICBzdGF0aWMgdm9pZCBydGw4MzY1bWJfdGVhcmRvd24oc3RydWN0IGRzYV9z
d2l0Y2ggKmRzKQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2
Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICANCj4gLQly
dGw4MzY1bWJfc3RhdHNfdGVhcmRvd24oc21pKTsNCj4gLQlydGw4MzY1bWJfaXJxX3RlYXJkb3du
KHNtaSk7DQo+ICsJcnRsODM2NW1iX3N0YXRzX3RlYXJkb3duKHByaXYpOw0KPiArCXJ0bDgzNjVt
Yl9pcnFfdGVhcmRvd24ocHJpdik7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgcnRsODM2
NW1iX2dldF9jaGlwX2lkX2FuZF92ZXIoc3RydWN0IHJlZ21hcCAqbWFwLCB1MzIgKmlkLCB1MzIg
KnZlcikNCj4gQEAgLTE5MDIsNDAgKzE5MDQsNDAgQEAgc3RhdGljIGludCBydGw4MzY1bWJfZ2V0
X2NoaXBfaWRfYW5kX3ZlcihzdHJ1Y3QgcmVnbWFwICptYXAsIHUzMiAqaWQsIHUzMiAqdmVyKQ0K
PiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjVtYl9kZXRl
Y3Qoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjVtYl9kZXRl
Y3Qoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdikNCj4gICB7DQo+IC0Jc3RydWN0IHJ0bDgzNjVt
YiAqbWIgPSBzbWktPmNoaXBfZGF0YTsNCj4gKwlzdHJ1Y3QgcnRsODM2NW1iICptYiA9IHByaXYt
PmNoaXBfZGF0YTsNCj4gICAJdTMyIGNoaXBfaWQ7DQo+ICAgCXUzMiBjaGlwX3ZlcjsNCj4gICAJ
aW50IHJldDsNCj4gICANCj4gLQlyZXQgPSBydGw4MzY1bWJfZ2V0X2NoaXBfaWRfYW5kX3Zlcihz
bWktPm1hcCwgJmNoaXBfaWQsICZjaGlwX3Zlcik7DQo+ICsJcmV0ID0gcnRsODM2NW1iX2dldF9j
aGlwX2lkX2FuZF92ZXIocHJpdi0+bWFwLCAmY2hpcF9pZCwgJmNoaXBfdmVyKTsNCj4gICAJaWYg
KHJldCkgew0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAiZmFpbGVkIHRvIHJlYWQgY2hpcCBpZCBh
bmQgdmVyc2lvbjogJWRcbiIsDQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAiZmFpbGVkIHRvIHJl
YWQgY2hpcCBpZCBhbmQgdmVyc2lvbjogJWRcbiIsDQo+ICAgCQkJcmV0KTsNCj4gICAJCXJldHVy
biByZXQ7DQo+ICAgCX0NCj4gICANCj4gICAJc3dpdGNoIChjaGlwX2lkKSB7DQo+ICAgCWNhc2Ug
UlRMODM2NU1CX0NISVBfSURfODM2NU1CX1ZDOg0KPiAtCQlkZXZfaW5mbyhzbWktPmRldiwNCj4g
KwkJZGV2X2luZm8ocHJpdi0+ZGV2LA0KPiAgIAkJCSAiZm91bmQgYW4gUlRMODM2NU1CLVZDIHN3
aXRjaCAodmVyPTB4JTA0eClcbiIsDQo+ICAgCQkJIGNoaXBfdmVyKTsNCj4gICANCj4gLQkJc21p
LT5jcHVfcG9ydCA9IFJUTDgzNjVNQl9DUFVfUE9SVF9OVU1fODM2NU1CX1ZDOw0KPiAtCQlzbWkt
Pm51bV9wb3J0cyA9IHNtaS0+Y3B1X3BvcnQgKyAxOw0KPiArCQlwcml2LT5jcHVfcG9ydCA9IFJU
TDgzNjVNQl9DUFVfUE9SVF9OVU1fODM2NU1CX1ZDOw0KPiArCQlwcml2LT5udW1fcG9ydHMgPSBw
cml2LT5jcHVfcG9ydCArIDE7DQo+ICAgDQo+IC0JCW1iLT5zbWkgPSBzbWk7DQo+ICsJCW1iLT5w
cml2ID0gcHJpdjsNCj4gICAJCW1iLT5jaGlwX2lkID0gY2hpcF9pZDsNCj4gICAJCW1iLT5jaGlw
X3ZlciA9IGNoaXBfdmVyOw0KPiAtCQltYi0+cG9ydF9tYXNrID0gQklUKHNtaS0+bnVtX3BvcnRz
KSAtIDE7DQo+ICsJCW1iLT5wb3J0X21hc2sgPSBCSVQocHJpdi0+bnVtX3BvcnRzKSAtIDE7DQo+
ICAgCQltYi0+bGVhcm5fbGltaXRfbWF4ID0gUlRMODM2NU1CX0xFQVJOX0xJTUlUX01BWF84MzY1
TUJfVkM7DQo+ICAgCQltYi0+amFtX3RhYmxlID0gcnRsODM2NW1iX2luaXRfamFtXzgzNjVtYl92
YzsNCj4gICAJCW1iLT5qYW1fc2l6ZSA9IEFSUkFZX1NJWkUocnRsODM2NW1iX2luaXRfamFtXzgz
NjVtYl92Yyk7DQo+ICAgDQo+ICAgCQltYi0+Y3B1LmVuYWJsZSA9IDE7DQo+IC0JCW1iLT5jcHUu
bWFzayA9IEJJVChzbWktPmNwdV9wb3J0KTsNCj4gLQkJbWItPmNwdS50cmFwX3BvcnQgPSBzbWkt
PmNwdV9wb3J0Ow0KPiArCQltYi0+Y3B1Lm1hc2sgPSBCSVQocHJpdi0+Y3B1X3BvcnQpOw0KPiAr
CQltYi0+Y3B1LnRyYXBfcG9ydCA9IHByaXYtPmNwdV9wb3J0Ow0KPiAgIAkJbWItPmNwdS5pbnNl
cnQgPSBSVEw4MzY1TUJfQ1BVX0lOU0VSVF9UT19BTEw7DQo+ICAgCQltYi0+Y3B1LnBvc2l0aW9u
ID0gUlRMODM2NU1CX0NQVV9QT1NfQUZURVJfU0E7DQo+ICAgCQltYi0+Y3B1LnJ4X2xlbmd0aCA9
IFJUTDgzNjVNQl9DUFVfUlhMRU5fNjRCWVRFUzsNCj4gQEAgLTE5NDMsNyArMTk0NSw3IEBAIHN0
YXRpYyBpbnQgcnRsODM2NW1iX2RldGVjdChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gICAN
Cj4gICAJCWJyZWFrOw0KPiAgIAlkZWZhdWx0Og0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LA0KPiAr
CQlkZXZfZXJyKHByaXYtPmRldiwNCj4gICAJCQkiZm91bmQgYW4gdW5rbm93biBSZWFsdGVrIHN3
aXRjaCAoaWQ9MHglMDR4LCB2ZXI9MHglMDR4KVxuIiwNCj4gICAJCQljaGlwX2lkLCBjaGlwX3Zl
cik7DQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsNCj4gQEAgLTE5NzAsMTUgKzE5NzIsMTUgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkc2Ffc3dpdGNoX29wcyBydGw4MzY1bWJfc3dpdGNoX29wcyA9IHsN
Cj4gICAJLmdldF9zdGF0czY0ID0gcnRsODM2NW1iX2dldF9zdGF0czY0LA0KPiAgIH07DQo+ICAg
DQo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IHJlYWx0ZWtfc21pX29wcyBydGw4MzY1bWJfc21pX29w
cyA9IHsNCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcmVhbHRla19vcHMgcnRsODM2NW1iX29wcyA9
IHsNCj4gICAJLmRldGVjdCA9IHJ0bDgzNjVtYl9kZXRlY3QsDQo+ICAgCS5waHlfcmVhZCA9IHJ0
bDgzNjVtYl9waHlfcmVhZCwNCj4gICAJLnBoeV93cml0ZSA9IHJ0bDgzNjVtYl9waHlfd3JpdGUs
DQo+ICAgfTsNCj4gICANCj4gLWNvbnN0IHN0cnVjdCByZWFsdGVrX3NtaV92YXJpYW50IHJ0bDgz
NjVtYl92YXJpYW50ID0gew0KPiArY29uc3Qgc3RydWN0IHJlYWx0ZWtfdmFyaWFudCBydGw4MzY1
bWJfdmFyaWFudCA9IHsNCj4gICAJLmRzX29wcyA9ICZydGw4MzY1bWJfc3dpdGNoX29wcywNCj4g
LQkub3BzID0gJnJ0bDgzNjVtYl9zbWlfb3BzLA0KPiArCS5vcHMgPSAmcnRsODM2NW1iX29wcywN
Cj4gICAJLmNsa19kZWxheSA9IDEwLA0KPiAgIAkuY21kX3JlYWQgPSAweGI5LA0KPiAgIAkuY21k
X3dyaXRlID0gMHhiOCwNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0
bDgzNjYuYyBiL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjYuYw0KPiBpbmRleCBiZGI4
ZDhkMzQ4ODAuLmRjNWY3NWJlMzAxNyAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9uZXQvZHNhL3Jl
YWx0ZWsvcnRsODM2Ni5jDQo+ICsrKyBiL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjYu
Yw0KPiBAQCAtMTEsMTggKzExLDE4IEBADQo+ICAgI2luY2x1ZGUgPGxpbnV4L2lmX2JyaWRnZS5o
Pg0KPiAgICNpbmNsdWRlIDxuZXQvZHNhLmg+DQo+ICAgDQo+IC0jaW5jbHVkZSAicmVhbHRlay1z
bWktY29yZS5oIg0KPiArI2luY2x1ZGUgInJlYWx0ZWsuaCINCj4gICANCj4gLWludCBydGw4MzY2
X21jX2lzX3VzZWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBtY19pbmRleCwgaW50ICp1
c2VkKQ0KPiAraW50IHJ0bDgzNjZfbWNfaXNfdXNlZChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2
LCBpbnQgbWNfaW5kZXgsIGludCAqdXNlZCkNCj4gICB7DQo+ICAgCWludCByZXQ7DQo+ICAgCWlu
dCBpOw0KPiAgIA0KPiAgIAkqdXNlZCA9IDA7DQo+IC0JZm9yIChpID0gMDsgaSA8IHNtaS0+bnVt
X3BvcnRzOyBpKyspIHsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+bnVtX3BvcnRzOyBpKysp
IHsNCj4gICAJCWludCBpbmRleCA9IDA7DQo+ICAgDQo+IC0JCXJldCA9IHNtaS0+b3BzLT5nZXRf
bWNfaW5kZXgoc21pLCBpLCAmaW5kZXgpOw0KPiArCQlyZXQgPSBwcml2LT5vcHMtPmdldF9tY19p
bmRleChwcml2LCBpLCAmaW5kZXgpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gcmV0
Ow0KPiAgIA0KPiBAQCAtMzgsMTMgKzM4LDEzIEBAIEVYUE9SVF9TWU1CT0xfR1BMKHJ0bDgzNjZf
bWNfaXNfdXNlZCk7DQo+ICAgDQo+ICAgLyoqDQo+ICAgICogcnRsODM2Nl9vYnRhaW5fbWMoKSAt
IHJldHJpZXZlIG9yIGFsbG9jYXRlIGEgVkxBTiBtZW1iZXIgY29uZmlndXJhdGlvbg0KPiAtICog
QHNtaTogdGhlIFJlYWx0ZWsgU01JIGRldmljZSBpbnN0YW5jZQ0KPiArICogQHByaXY6IHRoZSBS
ZWFsdGVrIFNNSSBkZXZpY2UgaW5zdGFuY2UNCj4gICAgKiBAdmlkOiB0aGUgVkxBTiBJRCB0byBs
b29rIHVwIG9yIGFsbG9jYXRlDQo+ICAgICogQHZsYW5tYzogdGhlIHBvaW50ZXIgd2lsbCBiZSBh
c3NpZ25lZCB0byBhIHBvaW50ZXIgdG8gYSB2YWxpZCBtZW1iZXIgY29uZmlnDQo+ICAgICogaWYg
c3VjY2Vzc2Z1bA0KPiAgICAqIEByZXR1cm46IGluZGV4IG9mIGEgbmV3IG1lbWJlciBjb25maWcg
b3IgbmVnYXRpdmUgZXJyb3IgbnVtYmVyDQo+ICAgICovDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjZf
b2J0YWluX21jKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQgdmlkLA0KPiArc3RhdGljIGlu
dCBydGw4MzY2X29idGFpbl9tYyhzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBpbnQgdmlkLA0K
PiAgIAkJCSAgICAgc3RydWN0IHJ0bDgzNjZfdmxhbl9tYyAqdmxhbm1jKQ0KPiAgIHsNCj4gICAJ
c3RydWN0IHJ0bDgzNjZfdmxhbl80ayB2bGFuNGs7DQo+IEBAIC01MiwxMCArNTIsMTAgQEAgc3Rh
dGljIGludCBydGw4MzY2X29idGFpbl9tYyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHZp
ZCwNCj4gICAJaW50IGk7DQo+ICAgDQo+ICAgCS8qIFRyeSB0byBmaW5kIGFuIGV4aXN0aW5nIG1l
bWJlciBjb25maWcgZW50cnkgZm9yIHRoaXMgVklEICovDQo+IC0JZm9yIChpID0gMDsgaSA8IHNt
aS0+bnVtX3ZsYW5fbWM7IGkrKykgew0KPiAtCQlyZXQgPSBzbWktPm9wcy0+Z2V0X3ZsYW5fbWMo
c21pLCBpLCB2bGFubWMpOw0KPiArCWZvciAoaSA9IDA7IGkgPCBwcml2LT5udW1fdmxhbl9tYzsg
aSsrKSB7DQo+ICsJCXJldCA9IHByaXYtPm9wcy0+Z2V0X3ZsYW5fbWMocHJpdiwgaSwgdmxhbm1j
KTsNCj4gICAJCWlmIChyZXQpIHsNCj4gLQkJCWRldl9lcnIoc21pLT5kZXYsICJlcnJvciBzZWFy
Y2hpbmcgZm9yIFZMQU4gTUMgJWQgZm9yIFZJRCAlZFxuIiwNCj4gKwkJCWRldl9lcnIocHJpdi0+
ZGV2LCAiZXJyb3Igc2VhcmNoaW5nIGZvciBWTEFOIE1DICVkIGZvciBWSUQgJWRcbiIsDQo+ICAg
CQkJCWksIHZpZCk7DQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAJCX0NCj4gQEAgLTY1LDE5ICs2
NSwxOSBAQCBzdGF0aWMgaW50IHJ0bDgzNjZfb2J0YWluX21jKHN0cnVjdCByZWFsdGVrX3NtaSAq
c21pLCBpbnQgdmlkLA0KPiAgIAl9DQo+ICAgDQo+ICAgCS8qIFdlIGhhdmUgbm8gTUMgZW50cnkg
Zm9yIHRoaXMgVklELCB0cnkgdG8gZmluZCBhbiBlbXB0eSBvbmUgKi8NCj4gLQlmb3IgKGkgPSAw
OyBpIDwgc21pLT5udW1fdmxhbl9tYzsgaSsrKSB7DQo+IC0JCXJldCA9IHNtaS0+b3BzLT5nZXRf
dmxhbl9tYyhzbWksIGksIHZsYW5tYyk7DQo+ICsJZm9yIChpID0gMDsgaSA8IHByaXYtPm51bV92
bGFuX21jOyBpKyspIHsNCj4gKwkJcmV0ID0gcHJpdi0+b3BzLT5nZXRfdmxhbl9tYyhwcml2LCBp
LCB2bGFubWMpOw0KPiAgIAkJaWYgKHJldCkgew0KPiAtCQkJZGV2X2VycihzbWktPmRldiwgImVy
cm9yIHNlYXJjaGluZyBmb3IgVkxBTiBNQyAlZCBmb3IgVklEICVkXG4iLA0KPiArCQkJZGV2X2Vy
cihwcml2LT5kZXYsICJlcnJvciBzZWFyY2hpbmcgZm9yIFZMQU4gTUMgJWQgZm9yIFZJRCAlZFxu
IiwNCj4gICAJCQkJaSwgdmlkKTsNCj4gICAJCQlyZXR1cm4gcmV0Ow0KPiAgIAkJfQ0KPiAgIA0K
PiAgIAkJaWYgKHZsYW5tYy0+dmlkID09IDAgJiYgdmxhbm1jLT5tZW1iZXIgPT0gMCkgew0KPiAg
IAkJCS8qIFVwZGF0ZSB0aGUgZW50cnkgZnJvbSB0aGUgNEsgdGFibGUgKi8NCj4gLQkJCXJldCA9
IHNtaS0+b3BzLT5nZXRfdmxhbl80ayhzbWksIHZpZCwgJnZsYW40ayk7DQo+ICsJCQlyZXQgPSBw
cml2LT5vcHMtPmdldF92bGFuXzRrKHByaXYsIHZpZCwgJnZsYW40ayk7DQo+ICAgCQkJaWYgKHJl
dCkgew0KPiAtCQkJCWRldl9lcnIoc21pLT5kZXYsICJlcnJvciBsb29raW5nIGZvciA0SyBWTEFO
IE1DICVkIGZvciBWSUQgJWRcbiIsDQo+ICsJCQkJZGV2X2Vycihwcml2LT5kZXYsICJlcnJvciBs
b29raW5nIGZvciA0SyBWTEFOIE1DICVkIGZvciBWSUQgJWRcbiIsDQo+ICAgCQkJCQlpLCB2aWQp
Ow0KPiAgIAkJCQlyZXR1cm4gcmV0Ow0KPiAgIAkJCX0NCj4gQEAgLTg2LDMwICs4NiwzMCBAQCBz
dGF0aWMgaW50IHJ0bDgzNjZfb2J0YWluX21jKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBpbnQg
dmlkLA0KPiAgIAkJCXZsYW5tYy0+bWVtYmVyID0gdmxhbjRrLm1lbWJlcjsNCj4gICAJCQl2bGFu
bWMtPnVudGFnID0gdmxhbjRrLnVudGFnOw0KPiAgIAkJCXZsYW5tYy0+ZmlkID0gdmxhbjRrLmZp
ZDsNCj4gLQkJCXJldCA9IHNtaS0+b3BzLT5zZXRfdmxhbl9tYyhzbWksIGksIHZsYW5tYyk7DQo+
ICsJCQlyZXQgPSBwcml2LT5vcHMtPnNldF92bGFuX21jKHByaXYsIGksIHZsYW5tYyk7DQo+ICAg
CQkJaWYgKHJldCkgew0KPiAtCQkJCWRldl9lcnIoc21pLT5kZXYsICJ1bmFibGUgdG8gc2V0L3Vw
ZGF0ZSBWTEFOIE1DICVkIGZvciBWSUQgJWRcbiIsDQo+ICsJCQkJZGV2X2Vycihwcml2LT5kZXYs
ICJ1bmFibGUgdG8gc2V0L3VwZGF0ZSBWTEFOIE1DICVkIGZvciBWSUQgJWRcbiIsDQo+ICAgCQkJ
CQlpLCB2aWQpOw0KPiAgIAkJCQlyZXR1cm4gcmV0Ow0KPiAgIAkJCX0NCj4gICANCj4gLQkJCWRl
dl9kYmcoc21pLT5kZXYsICJjcmVhdGVkIG5ldyBNQyBhdCBpbmRleCAlZCBmb3IgVklEICVkXG4i
LA0KPiArCQkJZGV2X2RiZyhwcml2LT5kZXYsICJjcmVhdGVkIG5ldyBNQyBhdCBpbmRleCAlZCBm
b3IgVklEICVkXG4iLA0KPiAgIAkJCQlpLCB2aWQpOw0KPiAgIAkJCXJldHVybiBpOw0KPiAgIAkJ
fQ0KPiAgIAl9DQo+ICAgDQo+ICAgCS8qIE1DIHRhYmxlIGlzIGZ1bGwsIHRyeSB0byBmaW5kIGFu
IHVudXNlZCBlbnRyeSBhbmQgcmVwbGFjZSBpdCAqLw0KPiAtCWZvciAoaSA9IDA7IGkgPCBzbWkt
Pm51bV92bGFuX21jOyBpKyspIHsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+bnVtX3ZsYW5f
bWM7IGkrKykgew0KPiAgIAkJaW50IHVzZWQ7DQo+ICAgDQo+IC0JCXJldCA9IHJ0bDgzNjZfbWNf
aXNfdXNlZChzbWksIGksICZ1c2VkKTsNCj4gKwkJcmV0ID0gcnRsODM2Nl9tY19pc191c2VkKHBy
aXYsIGksICZ1c2VkKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAN
Cj4gICAJCWlmICghdXNlZCkgew0KPiAgIAkJCS8qIFVwZGF0ZSB0aGUgZW50cnkgZnJvbSB0aGUg
NEsgdGFibGUgKi8NCj4gLQkJCXJldCA9IHNtaS0+b3BzLT5nZXRfdmxhbl80ayhzbWksIHZpZCwg
JnZsYW40ayk7DQo+ICsJCQlyZXQgPSBwcml2LT5vcHMtPmdldF92bGFuXzRrKHByaXYsIHZpZCwg
JnZsYW40ayk7DQo+ICAgCQkJaWYgKHJldCkNCj4gICAJCQkJcmV0dXJuIHJldDsNCj4gICANCj4g
QEAgLTExNywyMyArMTE3LDIzIEBAIHN0YXRpYyBpbnQgcnRsODM2Nl9vYnRhaW5fbWMoc3RydWN0
IHJlYWx0ZWtfc21pICpzbWksIGludCB2aWQsDQo+ICAgCQkJdmxhbm1jLT5tZW1iZXIgPSB2bGFu
NGsubWVtYmVyOw0KPiAgIAkJCXZsYW5tYy0+dW50YWcgPSB2bGFuNGsudW50YWc7DQo+ICAgCQkJ
dmxhbm1jLT5maWQgPSB2bGFuNGsuZmlkOw0KPiAtCQkJcmV0ID0gc21pLT5vcHMtPnNldF92bGFu
X21jKHNtaSwgaSwgdmxhbm1jKTsNCj4gKwkJCXJldCA9IHByaXYtPm9wcy0+c2V0X3ZsYW5fbWMo
cHJpdiwgaSwgdmxhbm1jKTsNCj4gICAJCQlpZiAocmV0KSB7DQo+IC0JCQkJZGV2X2VycihzbWkt
PmRldiwgInVuYWJsZSB0byBzZXQvdXBkYXRlIFZMQU4gTUMgJWQgZm9yIFZJRCAlZFxuIiwNCj4g
KwkJCQlkZXZfZXJyKHByaXYtPmRldiwgInVuYWJsZSB0byBzZXQvdXBkYXRlIFZMQU4gTUMgJWQg
Zm9yIFZJRCAlZFxuIiwNCj4gICAJCQkJCWksIHZpZCk7DQo+ICAgCQkJCXJldHVybiByZXQ7DQo+
ICAgCQkJfQ0KPiAtCQkJZGV2X2RiZyhzbWktPmRldiwgInJlY3ljbGVkIE1DIGF0IGluZGV4ICVp
IGZvciBWSUQgJWRcbiIsDQo+ICsJCQlkZXZfZGJnKHByaXYtPmRldiwgInJlY3ljbGVkIE1DIGF0
IGluZGV4ICVpIGZvciBWSUQgJWRcbiIsDQo+ICAgCQkJCWksIHZpZCk7DQo+ICAgCQkJcmV0dXJu
IGk7DQo+ICAgCQl9DQo+ICAgCX0NCj4gICANCj4gLQlkZXZfZXJyKHNtaS0+ZGV2LCAiYWxsIFZM
QU4gbWVtYmVyIGNvbmZpZ3VyYXRpb25zIGFyZSBpbiB1c2VcbiIpOw0KPiArCWRldl9lcnIocHJp
di0+ZGV2LCAiYWxsIFZMQU4gbWVtYmVyIGNvbmZpZ3VyYXRpb25zIGFyZSBpbiB1c2VcbiIpOw0K
PiAgIAlyZXR1cm4gLUVOT1NQQzsNCj4gICB9DQo+ICAgDQo+IC1pbnQgcnRsODM2Nl9zZXRfdmxh
bihzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHZpZCwgdTMyIG1lbWJlciwNCj4gK2ludCBy
dGw4MzY2X3NldF92bGFuKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIGludCB2aWQsIHUzMiBt
ZW1iZXIsDQo+ICAgCQkgICAgIHUzMiB1bnRhZywgdTMyIGZpZCkNCj4gICB7DQo+ICAgCXN0cnVj
dCBydGw4MzY2X3ZsYW5fbWMgdmxhbm1jOw0KPiBAQCAtMTQxLDMxICsxNDEsMzEgQEAgaW50IHJ0
bDgzNjZfc2V0X3ZsYW4oc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCB2aWQsIHUzMiBtZW1i
ZXIsDQo+ICAgCWludCBtYzsNCj4gICAJaW50IHJldDsNCj4gICANCj4gLQlpZiAoIXNtaS0+b3Bz
LT5pc192bGFuX3ZhbGlkKHNtaSwgdmlkKSkNCj4gKwlpZiAoIXByaXYtPm9wcy0+aXNfdmxhbl92
YWxpZChwcml2LCB2aWQpKQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+IC0JZGV2X2Ri
ZyhzbWktPmRldiwNCj4gKwlkZXZfZGJnKHByaXYtPmRldiwNCj4gICAJCSJzZXR0aW5nIFZMQU4l
ZCA0ayBtZW1iZXJzOiAweCUwMngsIHVudGFnZ2VkOiAweCUwMnhcbiIsDQo+ICAgCQl2aWQsIG1l
bWJlciwgdW50YWcpOw0KPiAgIA0KPiAgIAkvKiBVcGRhdGUgdGhlIDRLIHRhYmxlICovDQo+IC0J
cmV0ID0gc21pLT5vcHMtPmdldF92bGFuXzRrKHNtaSwgdmlkLCAmdmxhbjRrKTsNCj4gKwlyZXQg
PSBwcml2LT5vcHMtPmdldF92bGFuXzRrKHByaXYsIHZpZCwgJnZsYW40ayk7DQo+ICAgCWlmIChy
ZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAl2bGFuNGsubWVtYmVyIHw9IG1lbWJl
cjsNCj4gICAJdmxhbjRrLnVudGFnIHw9IHVudGFnOw0KPiAgIAl2bGFuNGsuZmlkID0gZmlkOw0K
PiAtCXJldCA9IHNtaS0+b3BzLT5zZXRfdmxhbl80ayhzbWksICZ2bGFuNGspOw0KPiArCXJldCA9
IHByaXYtPm9wcy0+c2V0X3ZsYW5fNGsocHJpdiwgJnZsYW40ayk7DQo+ICAgCWlmIChyZXQpDQo+
ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAtCWRldl9kYmcoc21pLT5kZXYsDQo+ICsJZGV2X2Ri
Zyhwcml2LT5kZXYsDQo+ICAgCQkicmVzdWx0aW5nIFZMQU4lZCA0ayBtZW1iZXJzOiAweCUwMngs
IHVudGFnZ2VkOiAweCUwMnhcbiIsDQo+ICAgCQl2aWQsIHZsYW40ay5tZW1iZXIsIHZsYW40ay51
bnRhZyk7DQo+ICAgDQo+ICAgCS8qIEZpbmQgb3IgYWxsb2NhdGUgYSBtZW1iZXIgY29uZmlnIGZv
ciB0aGlzIFZJRCAqLw0KPiAtCXJldCA9IHJ0bDgzNjZfb2J0YWluX21jKHNtaSwgdmlkLCAmdmxh
bm1jKTsNCj4gKwlyZXQgPSBydGw4MzY2X29idGFpbl9tYyhwcml2LCB2aWQsICZ2bGFubWMpOw0K
PiAgIAlpZiAocmV0IDwgMCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgCW1jID0gcmV0Ow0KPiBA
QCAtMTc2LDEyICsxNzYsMTIgQEAgaW50IHJ0bDgzNjZfc2V0X3ZsYW4oc3RydWN0IHJlYWx0ZWtf
c21pICpzbWksIGludCB2aWQsIHUzMiBtZW1iZXIsDQo+ICAgCXZsYW5tYy5maWQgPSBmaWQ7DQo+
ICAgDQo+ICAgCS8qIENvbW1pdCB1cGRhdGVzIHRvIHRoZSBNQyBlbnRyeSAqLw0KPiAtCXJldCA9
IHNtaS0+b3BzLT5zZXRfdmxhbl9tYyhzbWksIG1jLCAmdmxhbm1jKTsNCj4gKwlyZXQgPSBwcml2
LT5vcHMtPnNldF92bGFuX21jKHByaXYsIG1jLCAmdmxhbm1jKTsNCj4gICAJaWYgKHJldCkNCj4g
LQkJZGV2X2VycihzbWktPmRldiwgImZhaWxlZCB0byBjb21taXQgY2hhbmdlcyB0byBWTEFOIE1D
IGluZGV4ICVkIGZvciBWSUQgJWRcbiIsDQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAiZmFpbGVk
IHRvIGNvbW1pdCBjaGFuZ2VzIHRvIFZMQU4gTUMgaW5kZXggJWQgZm9yIFZJRCAlZFxuIiwNCj4g
ICAJCQltYywgdmlkKTsNCj4gICAJZWxzZQ0KPiAtCQlkZXZfZGJnKHNtaS0+ZGV2LA0KPiArCQlk
ZXZfZGJnKHByaXYtPmRldiwNCj4gICAJCQkicmVzdWx0aW5nIFZMQU4lZCBNQyBtZW1iZXJzOiAw
eCUwMngsIHVudGFnZ2VkOiAweCUwMnhcbiIsDQo+ICAgCQkJdmlkLCB2bGFubWMubWVtYmVyLCB2
bGFubWMudW50YWcpOw0KPiAgIA0KPiBAQCAtMTg5LDM3ICsxODksMzcgQEAgaW50IHJ0bDgzNjZf
c2V0X3ZsYW4oc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCB2aWQsIHUzMiBtZW1iZXIsDQo+
ICAgfQ0KPiAgIEVYUE9SVF9TWU1CT0xfR1BMKHJ0bDgzNjZfc2V0X3ZsYW4pOw0KPiAgIA0KPiAt
aW50IHJ0bDgzNjZfc2V0X3B2aWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHVuc2lnbmVkIGlu
dCBwb3J0LA0KPiAraW50IHJ0bDgzNjZfc2V0X3B2aWQoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJp
diwgdW5zaWduZWQgaW50IHBvcnQsDQo+ICAgCQkgICAgIHVuc2lnbmVkIGludCB2aWQpDQo+ICAg
ew0KPiAgIAlzdHJ1Y3QgcnRsODM2Nl92bGFuX21jIHZsYW5tYzsNCj4gICAJaW50IG1jOw0KPiAg
IAlpbnQgcmV0Ow0KPiAgIA0KPiAtCWlmICghc21pLT5vcHMtPmlzX3ZsYW5fdmFsaWQoc21pLCB2
aWQpKQ0KPiArCWlmICghcHJpdi0+b3BzLT5pc192bGFuX3ZhbGlkKHByaXYsIHZpZCkpDQo+ICAg
CQlyZXR1cm4gLUVJTlZBTDsNCj4gICANCj4gICAJLyogRmluZCBvciBhbGxvY2F0ZSBhIG1lbWJl
ciBjb25maWcgZm9yIHRoaXMgVklEICovDQo+IC0JcmV0ID0gcnRsODM2Nl9vYnRhaW5fbWMoc21p
LCB2aWQsICZ2bGFubWMpOw0KPiArCXJldCA9IHJ0bDgzNjZfb2J0YWluX21jKHByaXYsIHZpZCwg
JnZsYW5tYyk7DQo+ICAgCWlmIChyZXQgPCAwKQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICAJbWMg
PSByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gc21pLT5vcHMtPnNldF9tY19pbmRleChzbWksIHBvcnQs
IG1jKTsNCj4gKwlyZXQgPSBwcml2LT5vcHMtPnNldF9tY19pbmRleChwcml2LCBwb3J0LCBtYyk7
DQo+ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgInNldCBQVklEOiBmYWls
ZWQgdG8gc2V0IE1DIGluZGV4ICVkIGZvciBwb3J0ICVkXG4iLA0KPiArCQlkZXZfZXJyKHByaXYt
PmRldiwgInNldCBQVklEOiBmYWlsZWQgdG8gc2V0IE1DIGluZGV4ICVkIGZvciBwb3J0ICVkXG4i
LA0KPiAgIAkJCW1jLCBwb3J0KTsNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgCX0NCj4gICANCj4g
LQlkZXZfZGJnKHNtaS0+ZGV2LCAic2V0IFBWSUQ6IHRoZSBQVklEIGZvciBwb3J0ICVkIHNldCB0
byAlZCB1c2luZyBleGlzdGluZyBNQyBpbmRleCAlZFxuIiwNCj4gKwlkZXZfZGJnKHByaXYtPmRl
diwgInNldCBQVklEOiB0aGUgUFZJRCBmb3IgcG9ydCAlZCBzZXQgdG8gJWQgdXNpbmcgZXhpc3Rp
bmcgTUMgaW5kZXggJWRcbiIsDQo+ICAgCQlwb3J0LCB2aWQsIG1jKTsNCj4gICANCj4gICAJcmV0
dXJuIDA7DQo+ICAgfQ0KPiAgIEVYUE9SVF9TWU1CT0xfR1BMKHJ0bDgzNjZfc2V0X3B2aWQpOw0K
PiAgIA0KPiAtaW50IHJ0bDgzNjZfZW5hYmxlX3ZsYW40ayhzdHJ1Y3QgcmVhbHRla19zbWkgKnNt
aSwgYm9vbCBlbmFibGUpDQo+ICtpbnQgcnRsODM2Nl9lbmFibGVfdmxhbjRrKHN0cnVjdCByZWFs
dGVrX3ByaXYgKnByaXYsIGJvb2wgZW5hYmxlKQ0KPiAgIHsNCj4gICAJaW50IHJldDsNCj4gICAN
Cj4gQEAgLTIyOSw1MiArMjI5LDUyIEBAIGludCBydGw4MzY2X2VuYWJsZV92bGFuNGsoc3RydWN0
IHJlYWx0ZWtfc21pICpzbWksIGJvb2wgZW5hYmxlKQ0KPiAgIAkgKi8NCj4gICAJaWYgKGVuYWJs
ZSkgew0KPiAgIAkJLyogTWFrZSBzdXJlIFZMQU4gaXMgT04gKi8NCj4gLQkJcmV0ID0gc21pLT5v
cHMtPmVuYWJsZV92bGFuKHNtaSwgdHJ1ZSk7DQo+ICsJCXJldCA9IHByaXYtPm9wcy0+ZW5hYmxl
X3ZsYW4ocHJpdiwgdHJ1ZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJldHVybiByZXQ7DQo+
ICAgDQo+IC0JCXNtaS0+dmxhbl9lbmFibGVkID0gdHJ1ZTsNCj4gKwkJcHJpdi0+dmxhbl9lbmFi
bGVkID0gdHJ1ZTsNCj4gICAJfQ0KPiAgIA0KPiAtCXJldCA9IHNtaS0+b3BzLT5lbmFibGVfdmxh
bjRrKHNtaSwgZW5hYmxlKTsNCj4gKwlyZXQgPSBwcml2LT5vcHMtPmVuYWJsZV92bGFuNGsocHJp
diwgZW5hYmxlKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0J
c21pLT52bGFuNGtfZW5hYmxlZCA9IGVuYWJsZTsNCj4gKwlwcml2LT52bGFuNGtfZW5hYmxlZCA9
IGVuYWJsZTsNCj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIEVYUE9SVF9TWU1CT0xfR1BMKHJ0
bDgzNjZfZW5hYmxlX3ZsYW40ayk7DQo+ICAgDQo+IC1pbnQgcnRsODM2Nl9lbmFibGVfdmxhbihz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgYm9vbCBlbmFibGUpDQo+ICtpbnQgcnRsODM2Nl9lbmFi
bGVfdmxhbihzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBib29sIGVuYWJsZSkNCj4gICB7DQo+
ICAgCWludCByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gc21pLT5vcHMtPmVuYWJsZV92bGFuKHNtaSwg
ZW5hYmxlKTsNCj4gKwlyZXQgPSBwcml2LT5vcHMtPmVuYWJsZV92bGFuKHByaXYsIGVuYWJsZSk7
DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAtCXNtaS0+dmxhbl9l
bmFibGVkID0gZW5hYmxlOw0KPiArCXByaXYtPnZsYW5fZW5hYmxlZCA9IGVuYWJsZTsNCj4gICAN
Cj4gICAJLyogSWYgd2UgdHVybiBWTEFOIG9mZiwgbWFrZSBzdXJlIHRoYXQgd2UgdHVybiBvZmYN
Cj4gICAJICogNGsgVkxBTiBhcyB3ZWxsLCBpZiB0aGF0IGhhcHBlbmVkIHRvIGJlIG9uLg0KPiAg
IAkgKi8NCj4gICAJaWYgKCFlbmFibGUpIHsNCj4gLQkJc21pLT52bGFuNGtfZW5hYmxlZCA9IGZh
bHNlOw0KPiAtCQlyZXQgPSBzbWktPm9wcy0+ZW5hYmxlX3ZsYW40ayhzbWksIGZhbHNlKTsNCj4g
KwkJcHJpdi0+dmxhbjRrX2VuYWJsZWQgPSBmYWxzZTsNCj4gKwkJcmV0ID0gcHJpdi0+b3BzLT5l
bmFibGVfdmxhbjRrKHByaXYsIGZhbHNlKTsNCj4gICAJfQ0KPiAgIA0KPiAgIAlyZXR1cm4gcmV0
Ow0KPiAgIH0NCj4gICBFWFBPUlRfU1lNQk9MX0dQTChydGw4MzY2X2VuYWJsZV92bGFuKTsNCj4g
ICANCj4gLWludCBydGw4MzY2X3Jlc2V0X3ZsYW4oc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+
ICtpbnQgcnRsODM2Nl9yZXNldF92bGFuKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYpDQo+ICAg
ew0KPiAgIAlzdHJ1Y3QgcnRsODM2Nl92bGFuX21jIHZsYW5tYzsNCj4gICAJaW50IHJldDsNCj4g
ICAJaW50IGk7DQo+ICAgDQo+IC0JcnRsODM2Nl9lbmFibGVfdmxhbihzbWksIGZhbHNlKTsNCj4g
LQlydGw4MzY2X2VuYWJsZV92bGFuNGsoc21pLCBmYWxzZSk7DQo+ICsJcnRsODM2Nl9lbmFibGVf
dmxhbihwcml2LCBmYWxzZSk7DQo+ICsJcnRsODM2Nl9lbmFibGVfdmxhbjRrKHByaXYsIGZhbHNl
KTsNCj4gICANCj4gICAJLyogQ2xlYXIgdGhlIDE2IFZMQU4gbWVtYmVyIGNvbmZpZ3VyYXRpb25z
ICovDQo+ICAgCXZsYW5tYy52aWQgPSAwOw0KPiBAQCAtMjgyLDggKzI4Miw4IEBAIGludCBydGw4
MzY2X3Jlc2V0X3ZsYW4oc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICAgCXZsYW5tYy5tZW1i
ZXIgPSAwOw0KPiAgIAl2bGFubWMudW50YWcgPSAwOw0KPiAgIAl2bGFubWMuZmlkID0gMDsNCj4g
LQlmb3IgKGkgPSAwOyBpIDwgc21pLT5udW1fdmxhbl9tYzsgaSsrKSB7DQo+IC0JCXJldCA9IHNt
aS0+b3BzLT5zZXRfdmxhbl9tYyhzbWksIGksICZ2bGFubWMpOw0KPiArCWZvciAoaSA9IDA7IGkg
PCBwcml2LT5udW1fdmxhbl9tYzsgaSsrKSB7DQo+ICsJCXJldCA9IHByaXYtPm9wcy0+c2V0X3Zs
YW5fbWMocHJpdiwgaSwgJnZsYW5tYyk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJldHVybiBy
ZXQ7DQo+ICAgCX0NCj4gQEAgLTI5OCwxMiArMjk4LDEyIEBAIGludCBydGw4MzY2X3ZsYW5fYWRk
KHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgew0KPiAgIAlib29sIHVudGFn
Z2VkID0gISEodmxhbi0+ZmxhZ3MgJiBCUklER0VfVkxBTl9JTkZPX1VOVEFHR0VEKTsNCj4gICAJ
Ym9vbCBwdmlkID0gISEodmxhbi0+ZmxhZ3MgJiBCUklER0VfVkxBTl9JTkZPX1BWSUQpOw0KPiAt
CXN0cnVjdCByZWFsdGVrX3NtaSAqc21pID0gZHMtPnByaXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtf
cHJpdiAqcHJpdiA9IGRzLT5wcml2Ow0KPiAgIAl1MzIgbWVtYmVyID0gMDsNCj4gICAJdTMyIHVu
dGFnID0gMDsNCj4gICAJaW50IHJldDsNCj4gICANCj4gLQlpZiAoIXNtaS0+b3BzLT5pc192bGFu
X3ZhbGlkKHNtaSwgdmxhbi0+dmlkKSkgew0KPiArCWlmICghcHJpdi0+b3BzLT5pc192bGFuX3Zh
bGlkKHByaXYsIHZsYW4tPnZpZCkpIHsNCj4gICAJCU5MX1NFVF9FUlJfTVNHX01PRChleHRhY2ss
ICJWTEFOIElEIG5vdCB2YWxpZCIpOw0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgCX0NCj4g
QEAgLTMxMiwxMyArMzEyLDEzIEBAIGludCBydGw4MzY2X3ZsYW5fYWRkKHN0cnVjdCBkc2Ffc3dp
dGNoICpkcywgaW50IHBvcnQsDQo+ICAgCSAqIEZJWE1FOiB3aGF0J3Mgd2l0aCB0aGlzIDRrIGJ1
c2luZXNzPw0KPiAgIAkgKiBKdXN0IHJ0bDgzNjZfZW5hYmxlX3ZsYW4oKSBzZWVtcyBpbmNvbmNs
dXNpdmUuDQo+ICAgCSAqLw0KPiAtCXJldCA9IHJ0bDgzNjZfZW5hYmxlX3ZsYW40ayhzbWksIHRy
dWUpOw0KPiArCXJldCA9IHJ0bDgzNjZfZW5hYmxlX3ZsYW40ayhwcml2LCB0cnVlKTsNCj4gICAJ
aWYgKHJldCkgew0KPiAgIAkJTkxfU0VUX0VSUl9NU0dfTU9EKGV4dGFjaywgIkZhaWxlZCB0byBl
bmFibGUgVkxBTiA0SyIpOw0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICAJfQ0KPiAgIA0KPiAtCWRl
dl9kYmcoc21pLT5kZXYsICJhZGQgVkxBTiAlZCBvbiBwb3J0ICVkLCAlcywgJXNcbiIsDQo+ICsJ
ZGV2X2RiZyhwcml2LT5kZXYsICJhZGQgVkxBTiAlZCBvbiBwb3J0ICVkLCAlcywgJXNcbiIsDQo+
ICAgCQl2bGFuLT52aWQsIHBvcnQsIHVudGFnZ2VkID8gInVudGFnZ2VkIiA6ICJ0YWdnZWQiLA0K
PiAgIAkJcHZpZCA/ICJQVklEIiA6ICJubyBQVklEIik7DQo+ICAgDQo+IEBAIC0zMjcsMTggKzMy
NywxOCBAQCBpbnQgcnRsODM2Nl92bGFuX2FkZChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMsIGludCBw
b3J0LA0KPiAgIAlpZiAodW50YWdnZWQpDQo+ICAgCQl1bnRhZyB8PSBCSVQocG9ydCk7DQo+ICAg
DQo+IC0JcmV0ID0gcnRsODM2Nl9zZXRfdmxhbihzbWksIHZsYW4tPnZpZCwgbWVtYmVyLCB1bnRh
ZywgMCk7DQo+ICsJcmV0ID0gcnRsODM2Nl9zZXRfdmxhbihwcml2LCB2bGFuLT52aWQsIG1lbWJl
ciwgdW50YWcsIDApOw0KPiAgIAlpZiAocmV0KSB7DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJm
YWlsZWQgdG8gc2V0IHVwIFZMQU4gJTA0eCIsIHZsYW4tPnZpZCk7DQo+ICsJCWRldl9lcnIocHJp
di0+ZGV2LCAiZmFpbGVkIHRvIHNldCB1cCBWTEFOICUwNHgiLCB2bGFuLT52aWQpOw0KPiAgIAkJ
cmV0dXJuIHJldDsNCj4gICAJfQ0KPiAgIA0KPiAgIAlpZiAoIXB2aWQpDQo+ICAgCQlyZXR1cm4g
MDsNCj4gICANCj4gLQlyZXQgPSBydGw4MzY2X3NldF9wdmlkKHNtaSwgcG9ydCwgdmxhbi0+dmlk
KTsNCj4gKwlyZXQgPSBydGw4MzY2X3NldF9wdmlkKHByaXYsIHBvcnQsIHZsYW4tPnZpZCk7DQo+
ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgImZhaWxlZCB0byBzZXQgUFZJ
RCBvbiBwb3J0ICVkIHRvIFZMQU4gJTA0eCIsDQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAiZmFp
bGVkIHRvIHNldCBQVklEIG9uIHBvcnQgJWQgdG8gVkxBTiAlMDR4IiwNCj4gICAJCQlwb3J0LCB2
bGFuLT52aWQpOw0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICAJfQ0KPiBAQCAtMzUwLDE1ICszNTAs
MTUgQEAgRVhQT1JUX1NZTUJPTF9HUEwocnRsODM2Nl92bGFuX2FkZCk7DQo+ICAgaW50IHJ0bDgz
NjZfdmxhbl9kZWwoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCSAgICAg
Y29uc3Qgc3RydWN0IHN3aXRjaGRldl9vYmpfcG9ydF92bGFuICp2bGFuKQ0KPiAgIHsNCj4gLQlz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3By
aXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJaW50IHJldCwgaTsNCj4gICANCj4gLQlkZXZfZGJn
KHNtaS0+ZGV2LCAiZGVsIFZMQU4gJWQgb24gcG9ydCAlZFxuIiwgdmxhbi0+dmlkLCBwb3J0KTsN
Cj4gKwlkZXZfZGJnKHByaXYtPmRldiwgImRlbCBWTEFOICVkIG9uIHBvcnQgJWRcbiIsIHZsYW4t
PnZpZCwgcG9ydCk7DQo+ICAgDQo+IC0JZm9yIChpID0gMDsgaSA8IHNtaS0+bnVtX3ZsYW5fbWM7
IGkrKykgew0KPiArCWZvciAoaSA9IDA7IGkgPCBwcml2LT5udW1fdmxhbl9tYzsgaSsrKSB7DQo+
ICAgCQlzdHJ1Y3QgcnRsODM2Nl92bGFuX21jIHZsYW5tYzsNCj4gICANCj4gLQkJcmV0ID0gc21p
LT5vcHMtPmdldF92bGFuX21jKHNtaSwgaSwgJnZsYW5tYyk7DQo+ICsJCXJldCA9IHByaXYtPm9w
cy0+Z2V0X3ZsYW5fbWMocHJpdiwgaSwgJnZsYW5tYyk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJ
CXJldHVybiByZXQ7DQo+ICAgDQo+IEBAIC0zNzYsOSArMzc2LDkgQEAgaW50IHJ0bDgzNjZfdmxh
bl9kZWwoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCQkJdmxhbm1jLnBy
aW9yaXR5ID0gMDsNCj4gICAJCQkJdmxhbm1jLmZpZCA9IDA7DQo+ICAgCQkJfQ0KPiAtCQkJcmV0
ID0gc21pLT5vcHMtPnNldF92bGFuX21jKHNtaSwgaSwgJnZsYW5tYyk7DQo+ICsJCQlyZXQgPSBw
cml2LT5vcHMtPnNldF92bGFuX21jKHByaXYsIGksICZ2bGFubWMpOw0KPiAgIAkJCWlmIChyZXQp
IHsNCj4gLQkJCQlkZXZfZXJyKHNtaS0+ZGV2LA0KPiArCQkJCWRldl9lcnIocHJpdi0+ZGV2LA0K
PiAgIAkJCQkJImZhaWxlZCB0byByZW1vdmUgVkxBTiAlMDR4XG4iLA0KPiAgIAkJCQkJdmxhbi0+
dmlkKTsNCj4gICAJCQkJcmV0dXJuIHJldDsNCj4gQEAgLTM5NCwxNSArMzk0LDE1IEBAIEVYUE9S
VF9TWU1CT0xfR1BMKHJ0bDgzNjZfdmxhbl9kZWwpOw0KPiAgIHZvaWQgcnRsODM2Nl9nZXRfc3Ry
aW5ncyhzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMsIGludCBwb3J0LCB1MzIgc3RyaW5nc2V0LA0KPiAg
IAkJCSB1aW50OF90ICpkYXRhKQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9
IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsNCj4g
ICAJc3RydWN0IHJ0bDgzNjZfbWliX2NvdW50ZXIgKm1pYjsNCj4gICAJaW50IGk7DQo+ICAgDQo+
IC0JaWYgKHBvcnQgPj0gc21pLT5udW1fcG9ydHMpDQo+ICsJaWYgKHBvcnQgPj0gcHJpdi0+bnVt
X3BvcnRzKQ0KPiAgIAkJcmV0dXJuOw0KPiAgIA0KPiAtCWZvciAoaSA9IDA7IGkgPCBzbWktPm51
bV9taWJfY291bnRlcnM7IGkrKykgew0KPiAtCQltaWIgPSAmc21pLT5taWJfY291bnRlcnNbaV07
DQo+ICsJZm9yIChpID0gMDsgaSA8IHByaXYtPm51bV9taWJfY291bnRlcnM7IGkrKykgew0KPiAr
CQltaWIgPSAmcHJpdi0+bWliX2NvdW50ZXJzW2ldOw0KPiAgIAkJc3RybmNweShkYXRhICsgaSAq
IEVUSF9HU1RSSU5HX0xFTiwNCj4gICAJCQltaWItPm5hbWUsIEVUSF9HU1RSSU5HX0xFTik7DQo+
ICAgCX0NCj4gQEAgLTQxMSwzNSArNDExLDM1IEBAIEVYUE9SVF9TWU1CT0xfR1BMKHJ0bDgzNjZf
Z2V0X3N0cmluZ3MpOw0KPiAgIA0KPiAgIGludCBydGw4MzY2X2dldF9zc2V0X2NvdW50KHN0cnVj
dCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsIGludCBzc2V0KQ0KPiAgIHsNCj4gLQlzdHJ1Y3Qg
cmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnBy
aXYgPSBkcy0+cHJpdjsNCj4gICANCj4gICAJLyogV2Ugb25seSBzdXBwb3J0IFNTX1NUQVRTICov
DQo+ICAgCWlmIChzc2V0ICE9IEVUSF9TU19TVEFUUykNCj4gICAJCXJldHVybiAwOw0KPiAtCWlm
IChwb3J0ID49IHNtaS0+bnVtX3BvcnRzKQ0KPiArCWlmIChwb3J0ID49IHByaXYtPm51bV9wb3J0
cykNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAgIA0KPiAtCXJldHVybiBzbWktPm51bV9taWJf
Y291bnRlcnM7DQo+ICsJcmV0dXJuIHByaXYtPm51bV9taWJfY291bnRlcnM7DQo+ICAgfQ0KPiAg
IEVYUE9SVF9TWU1CT0xfR1BMKHJ0bDgzNjZfZ2V0X3NzZXRfY291bnQpOw0KPiAgIA0KPiAgIHZv
aWQgcnRsODM2Nl9nZXRfZXRodG9vbF9zdGF0cyhzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMsIGludCBw
b3J0LCB1aW50NjRfdCAqZGF0YSkNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpzbWkg
PSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMtPnByaXY7DQo+
ICAgCWludCBpOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAtCWlmIChwb3J0ID49IHNtaS0+bnVt
X3BvcnRzKQ0KPiArCWlmIChwb3J0ID49IHByaXYtPm51bV9wb3J0cykNCj4gICAJCXJldHVybjsN
Cj4gICANCj4gLQlmb3IgKGkgPSAwOyBpIDwgc21pLT5udW1fbWliX2NvdW50ZXJzOyBpKyspIHsN
Cj4gKwlmb3IgKGkgPSAwOyBpIDwgcHJpdi0+bnVtX21pYl9jb3VudGVyczsgaSsrKSB7DQo+ICAg
CQlzdHJ1Y3QgcnRsODM2Nl9taWJfY291bnRlciAqbWliOw0KPiAgIAkJdTY0IG1pYnZhbHVlID0g
MDsNCj4gICANCj4gLQkJbWliID0gJnNtaS0+bWliX2NvdW50ZXJzW2ldOw0KPiAtCQlyZXQgPSBz
bWktPm9wcy0+Z2V0X21pYl9jb3VudGVyKHNtaSwgcG9ydCwgbWliLCAmbWlidmFsdWUpOw0KPiAr
CQltaWIgPSAmcHJpdi0+bWliX2NvdW50ZXJzW2ldOw0KPiArCQlyZXQgPSBwcml2LT5vcHMtPmdl
dF9taWJfY291bnRlcihwcml2LCBwb3J0LCBtaWIsICZtaWJ2YWx1ZSk7DQo+ICAgCQlpZiAocmV0
KSB7DQo+IC0JCQlkZXZfZXJyKHNtaS0+ZGV2LCAiZXJyb3IgcmVhZGluZyBNSUIgY291bnRlciAl
c1xuIiwNCj4gKwkJCWRldl9lcnIocHJpdi0+ZGV2LCAiZXJyb3IgcmVhZGluZyBNSUIgY291bnRl
ciAlc1xuIiwNCj4gICAJCQkJbWliLT5uYW1lKTsNCj4gICAJCX0NCj4gICAJCWRhdGFbaV0gPSBt
aWJ2YWx1ZTsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjZy
Yi5jIGIvZHJpdmVycy9uZXQvZHNhL3JlYWx0ZWsvcnRsODM2NnJiLmMNCj4gaW5kZXggZWNjMTli
ZDUxMTVmLi5iMTYzNWMyMDI3NmIgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvbmV0L2RzYS9yZWFs
dGVrL3J0bDgzNjZyYi5jDQo+ICsrKyBiL2RyaXZlcnMvbmV0L2RzYS9yZWFsdGVrL3J0bDgzNjZy
Yi5jDQo+IEBAIC0yMSw3ICsyMSw3IEBADQo+ICAgI2luY2x1ZGUgPGxpbnV4L29mX2lycS5oPg0K
PiAgICNpbmNsdWRlIDxsaW51eC9yZWdtYXAuaD4NCj4gICANCj4gLSNpbmNsdWRlICJyZWFsdGVr
LXNtaS1jb3JlLmgiDQo+ICsjaW5jbHVkZSAicmVhbHRlay5oIg0KPiAgIA0KPiAgICNkZWZpbmUg
UlRMODM2NlJCX1BPUlRfTlVNX0NQVQkJNQ0KPiAgICNkZWZpbmUgUlRMODM2NlJCX05VTV9QT1JU
UwkJNg0KPiBAQCAtMzk2LDcgKzM5Niw3IEBAIHN0YXRpYyBzdHJ1Y3QgcnRsODM2Nl9taWJfY291
bnRlciBydGw4MzY2cmJfbWliX2NvdW50ZXJzW10gPSB7DQo+ICAgCXsgMCwgNzAsIDIsICJJZk91
dEJyb2FkY2FzdFBrdHMiCQkJfSwNCj4gICB9Ow0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY2
cmJfZ2V0X21pYl9jb3VudGVyKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLA0KPiArc3RhdGljIGlu
dCBydGw4MzY2cmJfZ2V0X21pYl9jb3VudGVyKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsDQo+
ICAgCQkJCSAgICAgaW50IHBvcnQsDQo+ICAgCQkJCSAgICAgc3RydWN0IHJ0bDgzNjZfbWliX2Nv
dW50ZXIgKm1pYiwNCj4gICAJCQkJICAgICB1NjQgKm1pYnZhbHVlKQ0KPiBAQCAtNDEyLDEyICs0
MTIsMTIgQEAgc3RhdGljIGludCBydGw4MzY2cmJfZ2V0X21pYl9jb3VudGVyKHN0cnVjdCByZWFs
dGVrX3NtaSAqc21pLA0KPiAgIAkvKiBXcml0aW5nIGFjY2VzcyBjb3VudGVyIGFkZHJlc3MgZmly
c3QNCj4gICAJICogdGhlbiBBU0lDIHdpbGwgcHJlcGFyZSA2NGJpdHMgY291bnRlciB3YWl0IGZv
ciBiZWluZyByZXRyaXZlZA0KPiAgIAkgKi8NCj4gLQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5t
YXAsIGFkZHIsIDApOyAvKiBXcml0ZSB3aGF0ZXZlciAqLw0KPiArCXJldCA9IHJlZ21hcF93cml0
ZShwcml2LT5tYXAsIGFkZHIsIDApOyAvKiBXcml0ZSB3aGF0ZXZlciAqLw0KPiAgIAlpZiAocmV0
KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJLyogUmVhZCBNSUIgY29udHJvbCByZWdp
c3RlciAqLw0KPiAtCXJldCA9IHJlZ21hcF9yZWFkKHNtaS0+bWFwLCBSVEw4MzY2UkJfTUlCX0NU
UkxfUkVHLCAmdmFsKTsNCj4gKwlyZXQgPSByZWdtYXBfcmVhZChwcml2LT5tYXAsIFJUTDgzNjZS
Ql9NSUJfQ1RSTF9SRUcsICZ2YWwpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIC1FSU87
DQo+ICAgDQo+IEBAIC00MzAsNyArNDMwLDcgQEAgc3RhdGljIGludCBydGw4MzY2cmJfZ2V0X21p
Yl9jb3VudGVyKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLA0KPiAgIAkvKiBSZWFkIGVhY2ggaW5k
aXZpZHVhbCBNSUIgMTYgYml0cyBhdCB0aGUgdGltZSAqLw0KPiAgIAkqbWlidmFsdWUgPSAwOw0K
PiAgIAlmb3IgKGkgPSBtaWItPmxlbmd0aDsgaSA+IDA7IGktLSkgew0KPiAtCQlyZXQgPSByZWdt
YXBfcmVhZChzbWktPm1hcCwgYWRkciArIChpIC0gMSksICZ2YWwpOw0KPiArCQlyZXQgPSByZWdt
YXBfcmVhZChwcml2LT5tYXAsIGFkZHIgKyAoaSAtIDEpLCAmdmFsKTsNCj4gICAJCWlmIChyZXQp
DQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAJCSptaWJ2YWx1ZSA9ICgqbWlidmFsdWUgPDwgMTYp
IHwgKHZhbCAmIDB4RkZGRik7DQo+IEBAIC00NTUsMzggKzQ1NSwzOCBAQCBzdGF0aWMgdTMyIHJ0
bDgzNjZyYl9nZXRfaXJxbWFzayhzdHJ1Y3QgaXJxX2RhdGEgKmQpDQo+ICAgDQo+ICAgc3RhdGlj
IHZvaWQgcnRsODM2NnJiX21hc2tfaXJxKHN0cnVjdCBpcnFfZGF0YSAqZCkNCj4gICB7DQo+IC0J
c3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBpcnFfZGF0YV9nZXRfaXJxX2NoaXBfZGF0YShkKTsN
Cj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gaXJxX2RhdGFfZ2V0X2lycV9jaGlwX2Rh
dGEoZCk7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRz
KHNtaS0+bWFwLCBSVEw4MzY2UkJfSU5URVJSVVBUX01BU0tfUkVHLA0KPiArCXJldCA9IHJlZ21h
cF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZSQl9JTlRFUlJVUFRfTUFTS19SRUcsDQo+
ICAgCQkJCSBydGw4MzY2cmJfZ2V0X2lycW1hc2soZCksIDApOw0KPiAgIAlpZiAocmV0KQ0KPiAt
CQlkZXZfZXJyKHNtaS0+ZGV2LCAiY291bGQgbm90IG1hc2sgSVJRXG4iKTsNCj4gKwkJZGV2X2Vy
cihwcml2LT5kZXYsICJjb3VsZCBub3QgbWFzayBJUlFcbiIpOw0KPiAgIH0NCj4gICANCj4gICBz
dGF0aWMgdm9pZCBydGw4MzY2cmJfdW5tYXNrX2lycShzdHJ1Y3QgaXJxX2RhdGEgKmQpDQo+ICAg
ew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pID0gaXJxX2RhdGFfZ2V0X2lycV9jaGlwX2Rh
dGEoZCk7DQo+ICsJc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiA9IGlycV9kYXRhX2dldF9pcnFf
Y2hpcF9kYXRhKGQpOw0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAtCXJldCA9IHJlZ21hcF91cGRh
dGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX0lOVEVSUlVQVF9NQVNLX1JFRywNCj4gKwlyZXQg
PSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfSU5URVJSVVBUX01BU0tf
UkVHLA0KPiAgIAkJCQkgcnRsODM2NnJiX2dldF9pcnFtYXNrKGQpLA0KPiAgIAkJCQkgcnRsODM2
NnJiX2dldF9pcnFtYXNrKGQpKTsNCj4gICAJaWYgKHJldCkNCj4gLQkJZGV2X2VycihzbWktPmRl
diwgImNvdWxkIG5vdCB1bm1hc2sgSVJRXG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsICJj
b3VsZCBub3QgdW5tYXNrIElSUVxuIik7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpcnFyZXR1
cm5fdCBydGw4MzY2cmJfaXJxKGludCBpcnEsIHZvaWQgKmRhdGEpDQo+ICAgew0KPiAtCXN0cnVj
dCByZWFsdGVrX3NtaSAqc21pID0gZGF0YTsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2
ID0gZGF0YTsNCj4gICAJdTMyIHN0YXQ7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+ICAgCS8qIFRo
aXMgY2xlYXJzIHRoZSBJUlEgc3RhdHVzIHJlZ2lzdGVyICovDQo+IC0JcmV0ID0gcmVnbWFwX3Jl
YWQoc21pLT5tYXAsIFJUTDgzNjZSQl9JTlRFUlJVUFRfU1RBVFVTX1JFRywNCj4gKwlyZXQgPSBy
ZWdtYXBfcmVhZChwcml2LT5tYXAsIFJUTDgzNjZSQl9JTlRFUlJVUFRfU1RBVFVTX1JFRywNCj4g
ICAJCQkgICZzdGF0KTsNCj4gICAJaWYgKHJldCkgew0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAi
Y2FuJ3QgcmVhZCBpbnRlcnJ1cHQgc3RhdHVzXG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYs
ICJjYW4ndCByZWFkIGludGVycnVwdCBzdGF0dXNcbiIpOw0KPiAgIAkJcmV0dXJuIElSUV9OT05F
Ow0KPiAgIAl9DQo+ICAgCXN0YXQgJj0gUlRMODM2NlJCX0lOVEVSUlVQVF9WQUxJRDsNCj4gQEAg
LTUwMiw3ICs1MDIsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgcnRsODM2NnJiX2lycShpbnQgaXJx
LCB2b2lkICpkYXRhKQ0KPiAgIAkJICovDQo+ICAgCQlpZiAobGluZSA8IDEyICYmIGxpbmUgPiA1
KQ0KPiAgIAkJCWxpbmUgLT0gNTsNCj4gLQkJY2hpbGRfaXJxID0gaXJxX2ZpbmRfbWFwcGluZyhz
bWktPmlycWRvbWFpbiwgbGluZSk7DQo+ICsJCWNoaWxkX2lycSA9IGlycV9maW5kX21hcHBpbmco
cHJpdi0+aXJxZG9tYWluLCBsaW5lKTsNCj4gICAJCWhhbmRsZV9uZXN0ZWRfaXJxKGNoaWxkX2ly
cSk7DQo+ICAgCX0NCj4gICAJcmV0dXJuIElSUV9IQU5ETEVEOw0KPiBAQCAtNTM4LDcgKzUzOCw3
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaXJxX2RvbWFpbl9vcHMgcnRsODM2NnJiX2lycWRvbWFp
bl9vcHMgPSB7DQo+ICAgCS54bGF0ZSAgPSBpcnFfZG9tYWluX3hsYXRlX29uZWNlbGwsDQo+ICAg
fTsNCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwX2Nhc2NhZGVkX2lycShzdHJ1
Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwX2Nhc2Nh
ZGVkX2lycShzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gICAJc3RydWN0IGRl
dmljZV9ub2RlICppbnRjOw0KPiAgIAl1bnNpZ25lZCBsb25nIGlycV90cmlnOw0KPiBAQCAtNTQ3
LDI0ICs1NDcsMjQgQEAgc3RhdGljIGludCBydGw4MzY2cmJfc2V0dXBfY2FzY2FkZWRfaXJxKHN0
cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiAgIAl1MzIgdmFsOw0KPiAgIAlpbnQgaTsNCj4gICAN
Cj4gLQlpbnRjID0gb2ZfZ2V0X2NoaWxkX2J5X25hbWUoc21pLT5kZXYtPm9mX25vZGUsICJpbnRl
cnJ1cHQtY29udHJvbGxlciIpOw0KPiArCWludGMgPSBvZl9nZXRfY2hpbGRfYnlfbmFtZShwcml2
LT5kZXYtPm9mX25vZGUsICJpbnRlcnJ1cHQtY29udHJvbGxlciIpOw0KPiAgIAlpZiAoIWludGMp
IHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgIm1pc3NpbmcgY2hpbGQgaW50ZXJydXB0LWNvbnRy
b2xsZXIgbm9kZVxuIik7DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAibWlzc2luZyBjaGlsZCBp
bnRlcnJ1cHQtY29udHJvbGxlciBub2RlXG4iKTsNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAg
IAl9DQo+ICAgCS8qIFJCODM2NlJCIElSUXMgY2FzY2FkZSBvZmYgdGhpcyBvbmUgKi8NCj4gICAJ
aXJxID0gb2ZfaXJxX2dldChpbnRjLCAwKTsNCj4gICAJaWYgKGlycSA8PSAwKSB7DQo+IC0JCWRl
dl9lcnIoc21pLT5kZXYsICJmYWlsZWQgdG8gZ2V0IHBhcmVudCBJUlFcbiIpOw0KPiArCQlkZXZf
ZXJyKHByaXYtPmRldiwgImZhaWxlZCB0byBnZXQgcGFyZW50IElSUVxuIik7DQo+ICAgCQlyZXQg
PSBpcnEgPyBpcnEgOiAtRUlOVkFMOw0KPiAgIAkJZ290byBvdXRfcHV0X25vZGU7DQo+ICAgCX0N
Cj4gICANCj4gICAJLyogVGhpcyBjbGVhcnMgdGhlIElSUSBzdGF0dXMgcmVnaXN0ZXIgKi8NCj4g
LQlyZXQgPSByZWdtYXBfcmVhZChzbWktPm1hcCwgUlRMODM2NlJCX0lOVEVSUlVQVF9TVEFUVVNf
UkVHLA0KPiArCXJldCA9IHJlZ21hcF9yZWFkKHByaXYtPm1hcCwgUlRMODM2NlJCX0lOVEVSUlVQ
VF9TVEFUVVNfUkVHLA0KPiAgIAkJCSAgJnZhbCk7DQo+ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2
X2VycihzbWktPmRldiwgImNhbid0IHJlYWQgaW50ZXJydXB0IHN0YXR1c1xuIik7DQo+ICsJCWRl
dl9lcnIocHJpdi0+ZGV2LCAiY2FuJ3QgcmVhZCBpbnRlcnJ1cHQgc3RhdHVzXG4iKTsNCj4gICAJ
CWdvdG8gb3V0X3B1dF9ub2RlOw0KPiAgIAl9DQo+ICAgDQo+IEBAIC01NzMsNDggKzU3Myw0OCBA
QCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1cF9jYXNjYWRlZF9pcnEoc3RydWN0IHJlYWx0ZWtf
c21pICpzbWkpDQo+ICAgCXN3aXRjaCAoaXJxX3RyaWcpIHsNCj4gICAJY2FzZSBJUlFGX1RSSUdH
RVJfUklTSU5HOg0KPiAgIAljYXNlIElSUUZfVFJJR0dFUl9ISUdIOg0KPiAtCQlkZXZfaW5mbyhz
bWktPmRldiwgImFjdGl2ZSBoaWdoL3Jpc2luZyBJUlFcbiIpOw0KPiArCQlkZXZfaW5mbyhwcml2
LT5kZXYsICJhY3RpdmUgaGlnaC9yaXNpbmcgSVJRXG4iKTsNCj4gICAJCXZhbCA9IDA7DQo+ICAg
CQlicmVhazsNCj4gICAJY2FzZSBJUlFGX1RSSUdHRVJfRkFMTElORzoNCj4gICAJY2FzZSBJUlFG
X1RSSUdHRVJfTE9XOg0KPiAtCQlkZXZfaW5mbyhzbWktPmRldiwgImFjdGl2ZSBsb3cvZmFsbGlu
ZyBJUlFcbiIpOw0KPiArCQlkZXZfaW5mbyhwcml2LT5kZXYsICJhY3RpdmUgbG93L2ZhbGxpbmcg
SVJRXG4iKTsNCj4gICAJCXZhbCA9IFJUTDgzNjZSQl9JTlRFUlJVUFRfUE9MQVJJVFk7DQo+ICAg
CQlicmVhazsNCj4gICAJfQ0KPiAtCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwg
UlRMODM2NlJCX0lOVEVSUlVQVF9DT05UUk9MX1JFRywNCj4gKwlyZXQgPSByZWdtYXBfdXBkYXRl
X2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfSU5URVJSVVBUX0NPTlRST0xfUkVHLA0KPiAgIAkJ
CQkgUlRMODM2NlJCX0lOVEVSUlVQVF9QT0xBUklUWSwNCj4gICAJCQkJIHZhbCk7DQo+ICAgCWlm
IChyZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgImNvdWxkIG5vdCBjb25maWd1cmUgSVJR
IHBvbGFyaXR5XG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYsICJjb3VsZCBub3QgY29uZmln
dXJlIElSUSBwb2xhcml0eVxuIik7DQo+ICAgCQlnb3RvIG91dF9wdXRfbm9kZTsNCj4gICAJfQ0K
PiAgIA0KPiAtCXJldCA9IGRldm1fcmVxdWVzdF90aHJlYWRlZF9pcnEoc21pLT5kZXYsIGlycSwg
TlVMTCwNCj4gKwlyZXQgPSBkZXZtX3JlcXVlc3RfdGhyZWFkZWRfaXJxKHByaXYtPmRldiwgaXJx
LCBOVUxMLA0KPiAgIAkJCQkJcnRsODM2NnJiX2lycSwgSVJRRl9PTkVTSE9ULA0KPiAtCQkJCQki
UlRMODM2NlJCIiwgc21pKTsNCj4gKwkJCQkJIlJUTDgzNjZSQiIsIHByaXYpOw0KPiAgIAlpZiAo
cmV0KSB7DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJ1bmFibGUgdG8gcmVxdWVzdCBpcnE6ICVk
XG4iLCByZXQpOw0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwgInVuYWJsZSB0byByZXF1ZXN0IGly
cTogJWRcbiIsIHJldCk7DQo+ICAgCQlnb3RvIG91dF9wdXRfbm9kZTsNCj4gICAJfQ0KPiAtCXNt
aS0+aXJxZG9tYWluID0gaXJxX2RvbWFpbl9hZGRfbGluZWFyKGludGMsDQo+ICsJcHJpdi0+aXJx
ZG9tYWluID0gaXJxX2RvbWFpbl9hZGRfbGluZWFyKGludGMsDQo+ICAgCQkJCQkgICAgICAgUlRM
ODM2NlJCX05VTV9JTlRFUlJVUFQsDQo+ICAgCQkJCQkgICAgICAgJnJ0bDgzNjZyYl9pcnFkb21h
aW5fb3BzLA0KPiAtCQkJCQkgICAgICAgc21pKTsNCj4gLQlpZiAoIXNtaS0+aXJxZG9tYWluKSB7
DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJmYWlsZWQgdG8gY3JlYXRlIElSUSBkb21haW5cbiIp
Ow0KPiArCQkJCQkgICAgICAgcHJpdik7DQo+ICsJaWYgKCFwcml2LT5pcnFkb21haW4pIHsNCj4g
KwkJZGV2X2Vycihwcml2LT5kZXYsICJmYWlsZWQgdG8gY3JlYXRlIElSUSBkb21haW5cbiIpOw0K
PiAgIAkJcmV0ID0gLUVJTlZBTDsNCj4gICAJCWdvdG8gb3V0X3B1dF9ub2RlOw0KPiAgIAl9DQo+
IC0JZm9yIChpID0gMDsgaSA8IHNtaS0+bnVtX3BvcnRzOyBpKyspDQo+IC0JCWlycV9zZXRfcGFy
ZW50KGlycV9jcmVhdGVfbWFwcGluZyhzbWktPmlycWRvbWFpbiwgaSksIGlycSk7DQo+ICsJZm9y
IChpID0gMDsgaSA8IHByaXYtPm51bV9wb3J0czsgaSsrKQ0KPiArCQlpcnFfc2V0X3BhcmVudChp
cnFfY3JlYXRlX21hcHBpbmcocHJpdi0+aXJxZG9tYWluLCBpKSwgaXJxKTsNCj4gICANCj4gICBv
dXRfcHV0X25vZGU6DQo+ICAgCW9mX25vZGVfcHV0KGludGMpOw0KPiAgIAlyZXR1cm4gcmV0Ow0K
PiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NnJiX3NldF9hZGRyKHN0cnVjdCByZWFs
dGVrX3NtaSAqc21pKQ0KPiArc3RhdGljIGludCBydGw4MzY2cmJfc2V0X2FkZHIoc3RydWN0IHJl
YWx0ZWtfcHJpdiAqcHJpdikNCj4gICB7DQo+ICAgCXU4IGFkZHJbRVRIX0FMRU5dOw0KPiAgIAl1
MTYgdmFsOw0KPiBAQCAtNjIyLDE4ICs2MjIsMTggQEAgc3RhdGljIGludCBydGw4MzY2cmJfc2V0
X2FkZHIoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICAgDQo+ICAgCWV0aF9yYW5kb21fYWRk
cihhZGRyKTsNCj4gICANCj4gLQlkZXZfaW5mbyhzbWktPmRldiwgInNldCBNQUM6ICUwMlg6JTAy
WDolMDJYOiUwMlg6JTAyWDolMDJYXG4iLA0KPiArCWRldl9pbmZvKHByaXYtPmRldiwgInNldCBN
QUM6ICUwMlg6JTAyWDolMDJYOiUwMlg6JTAyWDolMDJYXG4iLA0KPiAgIAkJIGFkZHJbMF0sIGFk
ZHJbMV0sIGFkZHJbMl0sIGFkZHJbM10sIGFkZHJbNF0sIGFkZHJbNV0pOw0KPiAgIAl2YWwgPSBh
ZGRyWzBdIDw8IDggfCBhZGRyWzFdOw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwg
UlRMODM2NlJCX1NNQVIwLCB2YWwpOw0KPiArCXJldCA9IHJlZ21hcF93cml0ZShwcml2LT5tYXAs
IFJUTDgzNjZSQl9TTUFSMCwgdmFsKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7
DQo+ICAgCXZhbCA9IGFkZHJbMl0gPDwgOCB8IGFkZHJbM107DQo+IC0JcmV0ID0gcmVnbWFwX3dy
aXRlKHNtaS0+bWFwLCBSVEw4MzY2UkJfU01BUjEsIHZhbCk7DQo+ICsJcmV0ID0gcmVnbWFwX3dy
aXRlKHByaXYtPm1hcCwgUlRMODM2NlJCX1NNQVIxLCB2YWwpOw0KPiAgIAlpZiAocmV0KQ0KPiAg
IAkJcmV0dXJuIHJldDsNCj4gICAJdmFsID0gYWRkcls0XSA8PCA4IHwgYWRkcls1XTsNCj4gLQly
ZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIFJUTDgzNjZSQl9TTUFSMiwgdmFsKTsNCj4gKwly
ZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY2UkJfU01BUjIsIHZhbCk7DQo+ICAg
CWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAtNzY1LDcgKzc2NSw3IEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgcnRsODM2NnJiX2phbV90YmxfZW50cnkgcnRsODM2NnJiX2dy
ZWVuX2phbVtdID0gew0KPiAgIA0KPiAgIC8qIEZ1bmN0aW9uIHRoYXQgamFtcyB0aGUgdGFibGVz
IGluIHRoZSBwcm9wZXIgcmVnaXN0ZXJzICovDQo+ICAgc3RhdGljIGludCBydGw4MzY2cmJfamFt
X3RhYmxlKGNvbnN0IHN0cnVjdCBydGw4MzY2cmJfamFtX3RibF9lbnRyeSAqamFtX3RhYmxlLA0K
PiAtCQkJICAgICAgIGludCBqYW1fc2l6ZSwgc3RydWN0IHJlYWx0ZWtfc21pICpzbWksDQo+ICsJ
CQkgICAgICAgaW50IGphbV9zaXplLCBzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LA0KPiAgIAkJ
CSAgICAgICBib29sIHdyaXRlX2RiZykNCj4gICB7DQo+ICAgCXUzMiB2YWw7DQo+IEBAIC03NzQs
MTMgKzc3NCwxMyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9qYW1fdGFibGUoY29uc3Qgc3RydWN0
IHJ0bDgzNjZyYl9qYW1fdGJsX2VudHJ5ICpqYW1fdGFibGUsDQo+ICAgDQo+ICAgCWZvciAoaSA9
IDA7IGkgPCBqYW1fc2l6ZTsgaSsrKSB7DQo+ICAgCQlpZiAoKGphbV90YWJsZVtpXS5yZWcgJiAw
eEJFMDApID09IDB4QkUwMCkgew0KPiAtCQkJcmV0ID0gcmVnbWFwX3JlYWQoc21pLT5tYXAsDQo+
ICsJCQlyZXQgPSByZWdtYXBfcmVhZChwcml2LT5tYXAsDQo+ICAgCQkJCQkgIFJUTDgzNjZSQl9Q
SFlfQUNDRVNTX0JVU1lfUkVHLA0KPiAgIAkJCQkJICAmdmFsKTsNCj4gICAJCQlpZiAocmV0KQ0K
PiAgIAkJCQlyZXR1cm4gcmV0Ow0KPiAgIAkJCWlmICghKHZhbCAmIFJUTDgzNjZSQl9QSFlfSU5U
X0JVU1kpKSB7DQo+IC0JCQkJcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+bWFwLA0KPiArCQkJCXJl
dCA9IHJlZ21hcF93cml0ZShwcml2LT5tYXAsDQo+ICAgCQkJCQkJUlRMODM2NlJCX1BIWV9BQ0NF
U1NfQ1RSTF9SRUcsDQo+ICAgCQkJCQkJUlRMODM2NlJCX1BIWV9DVFJMX1dSSVRFKTsNCj4gICAJ
CQkJaWYgKHJldCkNCj4gQEAgLTc4OCwxMCArNzg4LDEwIEBAIHN0YXRpYyBpbnQgcnRsODM2NnJi
X2phbV90YWJsZShjb25zdCBzdHJ1Y3QgcnRsODM2NnJiX2phbV90YmxfZW50cnkgKmphbV90YWJs
ZSwNCj4gICAJCQl9DQo+ICAgCQl9DQo+ICAgCQlpZiAod3JpdGVfZGJnKQ0KPiAtCQkJZGV2X2Ri
ZyhzbWktPmRldiwgImphbSAlMDR4IGludG8gcmVnaXN0ZXIgJTA0eFxuIiwNCj4gKwkJCWRldl9k
YmcocHJpdi0+ZGV2LCAiamFtICUwNHggaW50byByZWdpc3RlciAlMDR4XG4iLA0KPiAgIAkJCQlq
YW1fdGFibGVbaV0udmFsLA0KPiAgIAkJCQlqYW1fdGFibGVbaV0ucmVnKTsNCj4gLQkJcmV0ID0g
cmVnbWFwX3dyaXRlKHNtaS0+bWFwLA0KPiArCQlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFw
LA0KPiAgIAkJCQkgICBqYW1fdGFibGVbaV0ucmVnLA0KPiAgIAkJCQkgICBqYW1fdGFibGVbaV0u
dmFsKTsNCj4gICAJCWlmIChyZXQpDQo+IEBAIC04MDIsNyArODAyLDcgQEAgc3RhdGljIGludCBy
dGw4MzY2cmJfamFtX3RhYmxlKGNvbnN0IHN0cnVjdCBydGw4MzY2cmJfamFtX3RibF9lbnRyeSAq
amFtX3RhYmxlLA0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwKHN0cnVjdCBk
c2Ffc3dpdGNoICpkcykNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+
cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMtPnByaXY7DQo+ICAgCWNv
bnN0IHN0cnVjdCBydGw4MzY2cmJfamFtX3RibF9lbnRyeSAqamFtX3RhYmxlOw0KPiAgIAlzdHJ1
Y3QgcnRsODM2NnJiICpyYjsNCj4gICAJdTMyIGNoaXBfdmVyID0gMDsNCj4gQEAgLTgxMiwxMSAr
ODEyLDExIEBAIHN0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwKHN0cnVjdCBkc2Ffc3dpdGNoICpk
cykNCj4gICAJaW50IHJldDsNCj4gICAJaW50IGk7DQo+ICAgDQo+IC0JcmIgPSBzbWktPmNoaXBf
ZGF0YTsNCj4gKwlyYiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICANCj4gLQlyZXQgPSByZWdtYXBf
cmVhZChzbWktPm1hcCwgUlRMODM2NlJCX0NISVBfSURfUkVHLCAmY2hpcF9pZCk7DQo+ICsJcmV0
ID0gcmVnbWFwX3JlYWQocHJpdi0+bWFwLCBSVEw4MzY2UkJfQ0hJUF9JRF9SRUcsICZjaGlwX2lk
KTsNCj4gICAJaWYgKHJldCkgew0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAidW5hYmxlIHRvIHJl
YWQgY2hpcCBpZFxuIik7DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAidW5hYmxlIHRvIHJlYWQg
Y2hpcCBpZFxuIik7DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIAl9DQo+ICAgDQo+IEBAIC04MjQs
MTggKzgyNCwxOCBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1cChzdHJ1Y3QgZHNhX3N3aXRj
aCAqZHMpDQo+ICAgCWNhc2UgUlRMODM2NlJCX0NISVBfSURfODM2NjoNCj4gICAJCWJyZWFrOw0K
PiAgIAlkZWZhdWx0Og0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAidW5rbm93biBjaGlwIGlkICgl
MDR4KVxuIiwgY2hpcF9pZCk7DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAidW5rbm93biBjaGlw
IGlkICglMDR4KVxuIiwgY2hpcF9pZCk7DQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsNCj4gICAJfQ0K
PiAgIA0KPiAtCXJldCA9IHJlZ21hcF9yZWFkKHNtaS0+bWFwLCBSVEw4MzY2UkJfQ0hJUF9WRVJT
SU9OX0NUUkxfUkVHLA0KPiArCXJldCA9IHJlZ21hcF9yZWFkKHByaXYtPm1hcCwgUlRMODM2NlJC
X0NISVBfVkVSU0lPTl9DVFJMX1JFRywNCj4gICAJCQkgICZjaGlwX3Zlcik7DQo+ICAgCWlmIChy
ZXQpIHsNCj4gLQkJZGV2X2VycihzbWktPmRldiwgInVuYWJsZSB0byByZWFkIGNoaXAgdmVyc2lv
blxuIik7DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAidW5hYmxlIHRvIHJlYWQgY2hpcCB2ZXJz
aW9uXG4iKTsNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgCX0NCj4gICANCj4gLQlkZXZfaW5mbyhz
bWktPmRldiwgIlJUTCUwNHggdmVyICV1IGNoaXAgZm91bmRcbiIsDQo+ICsJZGV2X2luZm8ocHJp
di0+ZGV2LCAiUlRMJTA0eCB2ZXIgJXUgY2hpcCBmb3VuZFxuIiwNCj4gICAJCSBjaGlwX2lkLCBj
aGlwX3ZlciAmIFJUTDgzNjZSQl9DSElQX1ZFUlNJT05fTUFTSyk7DQo+ICAgDQo+ICAgCS8qIERv
IHRoZSBpbml0IGRhbmNlIHVzaW5nIHRoZSByaWdodCBqYW0gdGFibGUgKi8NCj4gQEAgLTg3Miwy
MCArODcyLDIwIEBAIHN0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwKHN0cnVjdCBkc2Ffc3dpdGNo
ICpkcykNCj4gICAJCWphbV9zaXplID0gQVJSQVlfU0laRShydGw4MzY2cmJfaW5pdF9qYW1fZGdu
MzUwMCk7DQo+ICAgCX0NCj4gICANCj4gLQlyZXQgPSBydGw4MzY2cmJfamFtX3RhYmxlKGphbV90
YWJsZSwgamFtX3NpemUsIHNtaSwgdHJ1ZSk7DQo+ICsJcmV0ID0gcnRsODM2NnJiX2phbV90YWJs
ZShqYW1fdGFibGUsIGphbV9zaXplLCBwcml2LCB0cnVlKTsNCj4gICAJaWYgKHJldCkNCj4gICAJ
CXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCS8qIElzb2xhdGUgYWxsIHVzZXIgcG9ydHMgc28gdGhl
eSBjYW4gb25seSBzZW5kIHBhY2tldHMgdG8gaXRzZWxmIGFuZCB0aGUgQ1BVIHBvcnQgKi8NCj4g
ICAJZm9yIChpID0gMDsgaSA8IFJUTDgzNjZSQl9QT1JUX05VTV9DUFU7IGkrKykgew0KPiAtCQly
ZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIFJUTDgzNjZSQl9QT1JUX0lTTyhpKSwNCj4gKwkJ
cmV0ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRMODM2NlJCX1BPUlRfSVNPKGkpLA0KPiAg
IAkJCQkgICBSVEw4MzY2UkJfUE9SVF9JU09fUE9SVFMoQklUKFJUTDgzNjZSQl9QT1JUX05VTV9D
UFUpKSB8DQo+ICAgCQkJCSAgIFJUTDgzNjZSQl9QT1JUX0lTT19FTik7DQo+ICAgCQlpZiAocmV0
KQ0KPiAgIAkJCXJldHVybiByZXQ7DQo+ICAgCX0NCj4gICAJLyogQ1BVIHBvcnQgY2FuIHNlbmQg
cGFja2V0cyB0byBhbGwgcG9ydHMgKi8NCj4gLQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAs
IFJUTDgzNjZSQl9QT1JUX0lTTyhSVEw4MzY2UkJfUE9SVF9OVU1fQ1BVKSwNCj4gKwlyZXQgPSBy
ZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY2UkJfUE9SVF9JU08oUlRMODM2NlJCX1BPUlRf
TlVNX0NQVSksDQo+ICAgCQkJICAgUlRMODM2NlJCX1BPUlRfSVNPX1BPUlRTKGRzYV91c2VyX3Bv
cnRzKGRzKSkgfA0KPiAgIAkJCSAgIFJUTDgzNjZSQl9QT1JUX0lTT19FTik7DQo+ICAgCWlmIChy
ZXQpDQo+IEBAIC04OTMsMjYgKzg5MywyNiBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1cChz
dHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgDQo+ICAgCS8qIFNldCB1cCB0aGUgImdyZWVuIGV0
aGVybmV0IiBmZWF0dXJlICovDQo+ICAgCXJldCA9IHJ0bDgzNjZyYl9qYW1fdGFibGUocnRsODM2
NnJiX2dyZWVuX2phbSwNCj4gLQkJCQkgIEFSUkFZX1NJWkUocnRsODM2NnJiX2dyZWVuX2phbSks
IHNtaSwgZmFsc2UpOw0KPiArCQkJCSAgQVJSQVlfU0laRShydGw4MzY2cmJfZ3JlZW5famFtKSwg
cHJpdiwgZmFsc2UpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4g
LQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsDQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHBy
aXYtPm1hcCwNCj4gICAJCQkgICBSVEw4MzY2UkJfR1JFRU5fRkVBVFVSRV9SRUcsDQo+ICAgCQkJ
ICAgKGNoaXBfdmVyID09IDEpID8gMHgwMDA3IDogMHgwMDAzKTsNCj4gICAJaWYgKHJldCkNCj4g
ICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCS8qIFZlbmRvciBkcml2ZXIgc2V0cyAweDI0MCBp
biByZWdpc3RlcnMgMHhjIGFuZCAweGQgKHVuZG9jdW1lbnRlZCkgKi8NCj4gLQlyZXQgPSByZWdt
YXBfd3JpdGUoc21pLT5tYXAsIDB4MGMsIDB4MjQwKTsNCj4gKwlyZXQgPSByZWdtYXBfd3JpdGUo
cHJpdi0+bWFwLCAweDBjLCAweDI0MCk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0
Ow0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgMHgwZCwgMHgyNDApOw0KPiArCXJl
dCA9IHJlZ21hcF93cml0ZShwcml2LT5tYXAsIDB4MGQsIDB4MjQwKTsNCj4gICAJaWYgKHJldCkN
Cj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCS8qIFNldCBzb21lIHJhbmRvbSBNQUMgYWRk
cmVzcyAqLw0KPiAtCXJldCA9IHJ0bDgzNjZyYl9zZXRfYWRkcihzbWkpOw0KPiArCXJldCA9IHJ0
bDgzNjZyYl9zZXRfYWRkcihwcml2KTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7
DQo+ICAgDQo+IEBAIC05MjEsMjEgKzkyMSwyMSBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1
cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgCSAqIElmIHlvdSBzZXQgUlRMODM2OFJCX0NQ
VV9OT19UQUcgKGJpdCAxNSkgaW4gdGhpcyByZWdpc3RlcnMNCj4gICAJICogdGhlIGN1c3RvbSB0
YWcgaXMgdHVybmVkIG9mZi4NCj4gICAJICovDQo+IC0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRz
KHNtaS0+bWFwLCBSVEw4MzY4UkJfQ1BVX0NUUkxfUkVHLA0KPiArCXJldCA9IHJlZ21hcF91cGRh
dGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjhSQl9DUFVfQ1RSTF9SRUcsDQo+ICAgCQkJCSAweEZG
RkYsDQo+IC0JCQkJIEJJVChzbWktPmNwdV9wb3J0KSk7DQo+ICsJCQkJIEJJVChwcml2LT5jcHVf
cG9ydCkpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJLyog
TWFrZSBzdXJlIHdlIGRlZmF1bHQtZW5hYmxlIHRoZSBmaXhlZCBDUFUgcG9ydCAqLw0KPiAtCXJl
dCA9IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX1BFQ1IsDQo+IC0JCQkJ
IEJJVChzbWktPmNwdV9wb3J0KSwNCj4gKwlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+
bWFwLCBSVEw4MzY2UkJfUEVDUiwNCj4gKwkJCQkgQklUKHByaXYtPmNwdV9wb3J0KSwNCj4gICAJ
CQkJIDApOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJLyog
U2V0IG1heGltdW0gcGFja2V0IGxlbmd0aCB0byAxNTM2IGJ5dGVzICovDQo+IC0JcmV0ID0gcmVn
bWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfU0dDUiwNCj4gKwlyZXQgPSByZWdt
YXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfU0dDUiwNCj4gICAJCQkJIFJUTDgz
NjZSQl9TR0NSX01BWF9MRU5HVEhfTUFTSywNCj4gICAJCQkJIFJUTDgzNjZSQl9TR0NSX01BWF9M
RU5HVEhfMTUzNik7DQo+ICAgCWlmIChyZXQpDQo+IEBAIC05NDUsMTMgKzk0NSwxMyBAQCBzdGF0
aWMgaW50IHJ0bDgzNjZyYl9zZXR1cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgCQlyYi0+
bWF4X210dVtpXSA9IDE1MzI7DQo+ICAgDQo+ICAgCS8qIERpc2FibGUgbGVhcm5pbmcgZm9yIGFs
bCBwb3J0cyAqLw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgUlRMODM2NlJCX1BP
UlRfTEVBUk5ESVNfQ1RSTCwNCj4gKwlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4
MzY2UkJfUE9SVF9MRUFSTkRJU19DVFJMLA0KPiAgIAkJCSAgIFJUTDgzNjZSQl9QT1JUX0FMTCk7
DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAkvKiBFbmFibGUg
YXV0byBhZ2VpbmcgZm9yIGFsbCBwb3J0cyAqLw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWkt
Pm1hcCwgUlRMODM2NlJCX1NFQ1VSSVRZX0NUUkwsIDApOw0KPiArCXJldCA9IHJlZ21hcF93cml0
ZShwcml2LT5tYXAsIFJUTDgzNjZSQl9TRUNVUklUWV9DVFJMLCAwKTsNCj4gICAJaWYgKHJldCkN
Cj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IEBAIC05NjIsMzAgKzk2MiwzMCBAQCBzdGF0aWMg
aW50IHJ0bDgzNjZyYl9zZXR1cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgCSAqIGNvbm5l
Y3RlZCB0byBzb21ldGhpbmcgZXhvdGljIHN1Y2ggYXMgZmliZXIsIHRoZW4gdGhpcyBtaWdodA0K
PiAgIAkgKiBiZSB3b3J0aCBleHBlcmltZW50aW5nIHdpdGguDQo+ICAgCSAqLw0KPiAtCXJldCA9
IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX1BNQzAsDQo+ICsJcmV0ID0g
cmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwgUlRMODM2NlJCX1BNQzAsDQo+ICAgCQkJCSBS
VEw4MzY2UkJfUE1DMF9QNF9JT01PREVfTUFTSywNCj4gICAJCQkJIDAgPDwgUlRMODM2NlJCX1BN
QzBfUDRfSU9NT0RFX1NISUZUKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+
ICAgDQo+ICAgCS8qIEFjY2VwdCBhbGwgcGFja2V0cyBieSBkZWZhdWx0LCB3ZSBlbmFibGUgZmls
dGVyaW5nIG9uLWRlbWFuZCAqLw0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgUlRM
ODM2NlJCX1ZMQU5fSU5HUkVTU19DVFJMMV9SRUcsDQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHBy
aXYtPm1hcCwgUlRMODM2NlJCX1ZMQU5fSU5HUkVTU19DVFJMMV9SRUcsDQo+ICAgCQkJICAgMCk7
DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAtCXJldCA9IHJlZ21hcF93cml0
ZShzbWktPm1hcCwgUlRMODM2NlJCX1ZMQU5fSU5HUkVTU19DVFJMMl9SRUcsDQo+ICsJcmV0ID0g
cmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRMODM2NlJCX1ZMQU5fSU5HUkVTU19DVFJMMl9SRUcs
DQo+ICAgCQkJICAgMCk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0K
PiAgIAkvKiBEb24ndCBkcm9wIHBhY2tldHMgd2hvc2UgREEgaGFzIG5vdCBiZWVuIGxlYXJuZWQg
Ki8NCj4gLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoc21pLT5tYXAsIFJUTDgzNjZSQl9TU0NS
MiwNCj4gKwlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfU1ND
UjIsDQo+ICAgCQkJCSBSVEw4MzY2UkJfU1NDUjJfRFJPUF9VTktOT1dOX0RBLCAwKTsNCj4gICAJ
aWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCS8qIFNldCBibGlua2luZywg
VE9ETzogbWFrZSB0aGlzIGNvbmZpZ3VyYWJsZSAqLw0KPiAtCXJldCA9IHJlZ21hcF91cGRhdGVf
Yml0cyhzbWktPm1hcCwgUlRMODM2NlJCX0xFRF9CTElOS1JBVEVfUkVHLA0KPiArCXJldCA9IHJl
Z21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZSQl9MRURfQkxJTktSQVRFX1JFRywN
Cj4gICAJCQkJIFJUTDgzNjZSQl9MRURfQkxJTktSQVRFX01BU0ssDQo+ICAgCQkJCSBSVEw4MzY2
UkJfTEVEX0JMSU5LUkFURV81Nk1TKTsNCj4gICAJaWYgKHJldCkNCj4gQEAgLTk5NiwxNSArOTk2
LDE1IEBAIHN0YXRpYyBpbnQgcnRsODM2NnJiX3NldHVwKHN0cnVjdCBkc2Ffc3dpdGNoICpkcykN
Cj4gICAJICogYmVoYXZpb3VyIChubyBpbmRpdmlkdWFsIGNvbmZpZykgYnV0IHdlIGNhbiBzZXQg
dXAgZWFjaA0KPiAgIAkgKiBMRUQgc2VwYXJhdGVseS4NCj4gICAJICovDQo+IC0JaWYgKHNtaS0+
bGVkc19kaXNhYmxlZCkgew0KPiArCWlmIChwcml2LT5sZWRzX2Rpc2FibGVkKSB7DQo+ICAgCQkv
KiBUdXJuIGV2ZXJ5dGhpbmcgb2ZmICovDQo+IC0JCXJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1h
cCwNCj4gKwkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwNCj4gICAJCQkJICAgUlRMODM2
NlJCX0xFRF8wXzFfQ1RSTF9SRUcsDQo+ICAgCQkJCSAgIDB4MEZGRiwgMCk7DQo+IC0JCXJlZ21h
cF91cGRhdGVfYml0cyhzbWktPm1hcCwNCj4gKwkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1h
cCwNCj4gICAJCQkJICAgUlRMODM2NlJCX0xFRF8yXzNfQ1RSTF9SRUcsDQo+ICAgCQkJCSAgIDB4
MEZGRiwgMCk7DQo+IC0JCXJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwNCj4gKwkJcmVnbWFw
X3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwNCj4gICAJCQkJICAgUlRMODM2NlJCX0lOVEVSUlVQVF9D
T05UUk9MX1JFRywNCj4gICAJCQkJICAgUlRMODM2NlJCX1A0X1JHTUlJX0xFRCwNCj4gICAJCQkJ
ICAgMCk7DQo+IEBAIC0xMDE0LDcgKzEwMTQsNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1
cChzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMpDQo+ICAgCQl2YWwgPSBSVEw4MzY2UkJfTEVEX0ZPUkNF
Ow0KPiAgIAl9DQo+ICAgCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsNCj4gLQkJcmV0ID0gcmVn
bWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLA0KPiArCQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMo
cHJpdi0+bWFwLA0KPiAgIAkJCQkJIFJUTDgzNjZSQl9MRURfQ1RSTF9SRUcsDQo+ICAgCQkJCQkg
MHhmIDw8IChpICogNCksDQo+ICAgCQkJCQkgdmFsIDw8IChpICogNCkpOw0KPiBAQCAtMTAyMiwx
NyArMTAyMiwxNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXR1cChzdHJ1Y3QgZHNhX3N3aXRj
aCAqZHMpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAJfQ0KPiAgIA0KPiAtCXJldCA9IHJ0bDgz
NjZfcmVzZXRfdmxhbihzbWkpOw0KPiArCXJldCA9IHJ0bDgzNjZfcmVzZXRfdmxhbihwcml2KTsN
Cj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gcnRsODM2
NnJiX3NldHVwX2Nhc2NhZGVkX2lycShzbWkpOw0KPiArCXJldCA9IHJ0bDgzNjZyYl9zZXR1cF9j
YXNjYWRlZF9pcnEocHJpdik7DQo+ICAgCWlmIChyZXQpDQo+IC0JCWRldl9pbmZvKHNtaS0+ZGV2
LCAibm8gaW50ZXJydXB0IHN1cHBvcnRcbiIpOw0KPiArCQlkZXZfaW5mbyhwcml2LT5kZXYsICJu
byBpbnRlcnJ1cHQgc3VwcG9ydFxuIik7DQo+ICAgDQo+IC0JcmV0ID0gcmVhbHRla19zbWlfc2V0
dXBfbWRpbyhzbWkpOw0KPiArCXJldCA9IHByaXYtPnNldHVwX2ludGVyZmFjZShkcyk7DQo+ICAg
CWlmIChyZXQpIHsNCj4gLQkJZGV2X2luZm8oc21pLT5kZXYsICJjb3VsZCBub3Qgc2V0IHVwIE1E
SU8gYnVzXG4iKTsNCj4gKwkJZGV2X2luZm8ocHJpdi0+ZGV2LCAiY291bGQgbm90IHNldCB1cCBN
RElPIGJ1c1xuIik7DQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsNCj4gICAJfQ0KPiAgIA0KPiBAQCAt
MTA1MiwzNSArMTA1MiwzNSBAQCBydGw4MzY2cmJfbWFjX2xpbmtfdXAoc3RydWN0IGRzYV9zd2l0
Y2ggKmRzLCBpbnQgcG9ydCwgdW5zaWduZWQgaW50IG1vZGUsDQo+ICAgCQkgICAgICBwaHlfaW50
ZXJmYWNlX3QgaW50ZXJmYWNlLCBzdHJ1Y3QgcGh5X2RldmljZSAqcGh5ZGV2LA0KPiAgIAkJICAg
ICAgaW50IHNwZWVkLCBpbnQgZHVwbGV4LCBib29sIHR4X3BhdXNlLCBib29sIHJ4X3BhdXNlKQ0K
PiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVj
dCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJaW50IHJldDsNCj4gICANCj4g
LQlpZiAocG9ydCAhPSBzbWktPmNwdV9wb3J0KQ0KPiArCWlmIChwb3J0ICE9IHByaXYtPmNwdV9w
b3J0KQ0KPiAgIAkJcmV0dXJuOw0KPiAgIA0KPiAtCWRldl9kYmcoc21pLT5kZXYsICJNQUMgbGlu
ayB1cCBvbiBDUFUgcG9ydCAoJWQpXG4iLCBwb3J0KTsNCj4gKwlkZXZfZGJnKHByaXYtPmRldiwg
Ik1BQyBsaW5rIHVwIG9uIENQVSBwb3J0ICglZClcbiIsIHBvcnQpOw0KPiAgIA0KPiAgIAkvKiBG
b3JjZSB0aGUgZml4ZWQgQ1BVIHBvcnQgaW50byAxR2JpdCBtb2RlLCBubyBhdXRvbmVnb3RpYXRp
b24gKi8NCj4gLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoc21pLT5tYXAsIFJUTDgzNjZSQl9N
QUNfRk9SQ0VfQ1RSTF9SRUcsDQo+ICsJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1h
cCwgUlRMODM2NlJCX01BQ19GT1JDRV9DVFJMX1JFRywNCj4gICAJCQkJIEJJVChwb3J0KSwgQklU
KHBvcnQpKTsNCj4gICAJaWYgKHJldCkgew0KPiAtCQlkZXZfZXJyKHNtaS0+ZGV2LCAiZmFpbGVk
IHRvIGZvcmNlIDFHYml0IG9uIENQVSBwb3J0XG4iKTsNCj4gKwkJZGV2X2Vycihwcml2LT5kZXYs
ICJmYWlsZWQgdG8gZm9yY2UgMUdiaXQgb24gQ1BVIHBvcnRcbiIpOw0KPiAgIAkJcmV0dXJuOw0K
PiAgIAl9DQo+ICAgDQo+IC0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4
MzY2UkJfUEFBQ1IyLA0KPiArCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJU
TDgzNjZSQl9QQUFDUjIsDQo+ICAgCQkJCSAweEZGMDBVLA0KPiAgIAkJCQkgUlRMODM2NlJCX1BB
QUNSX0NQVV9QT1JUIDw8IDgpOw0KPiAgIAlpZiAocmV0KSB7DQo+IC0JCWRldl9lcnIoc21pLT5k
ZXYsICJmYWlsZWQgdG8gc2V0IFBBQUNSIG9uIENQVSBwb3J0XG4iKTsNCj4gKwkJZGV2X2Vycihw
cml2LT5kZXYsICJmYWlsZWQgdG8gc2V0IFBBQUNSIG9uIENQVSBwb3J0XG4iKTsNCj4gICAJCXJl
dHVybjsNCj4gICAJfQ0KPiAgIA0KPiAgIAkvKiBFbmFibGUgdGhlIENQVSBwb3J0ICovDQo+IC0J
cmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfUEVDUiwgQklUKHBv
cnQpLA0KPiArCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZSQl9Q
RUNSLCBCSVQocG9ydCksDQo+ICAgCQkJCSAwKTsNCj4gICAJaWYgKHJldCkgew0KPiAtCQlkZXZf
ZXJyKHNtaS0+ZGV2LCAiZmFpbGVkIHRvIGVuYWJsZSB0aGUgQ1BVIHBvcnRcbiIpOw0KPiArCQlk
ZXZfZXJyKHByaXYtPmRldiwgImZhaWxlZCB0byBlbmFibGUgdGhlIENQVSBwb3J0XG4iKTsNCj4g
ICAJCXJldHVybjsNCj4gICAJfQ0KPiAgIH0NCj4gQEAgLTEwODksOTkgKzEwODksOTkgQEAgc3Rh
dGljIHZvaWQNCj4gICBydGw4MzY2cmJfbWFjX2xpbmtfZG93bihzdHJ1Y3QgZHNhX3N3aXRjaCAq
ZHMsIGludCBwb3J0LCB1bnNpZ25lZCBpbnQgbW9kZSwNCj4gICAJCQlwaHlfaW50ZXJmYWNlX3Qg
aW50ZXJmYWNlKQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2
Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJaW50IHJl
dDsNCj4gICANCj4gLQlpZiAocG9ydCAhPSBzbWktPmNwdV9wb3J0KQ0KPiArCWlmIChwb3J0ICE9
IHByaXYtPmNwdV9wb3J0KQ0KPiAgIAkJcmV0dXJuOw0KPiAgIA0KPiAtCWRldl9kYmcoc21pLT5k
ZXYsICJNQUMgbGluayBkb3duIG9uIENQVSBwb3J0ICglZClcbiIsIHBvcnQpOw0KPiArCWRldl9k
YmcocHJpdi0+ZGV2LCAiTUFDIGxpbmsgZG93biBvbiBDUFUgcG9ydCAoJWQpXG4iLCBwb3J0KTsN
Cj4gICANCj4gICAJLyogRGlzYWJsZSB0aGUgQ1BVIHBvcnQgKi8NCj4gLQlyZXQgPSByZWdtYXBf
dXBkYXRlX2JpdHMoc21pLT5tYXAsIFJUTDgzNjZSQl9QRUNSLCBCSVQocG9ydCksDQo+ICsJcmV0
ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwgUlRMODM2NlJCX1BFQ1IsIEJJVChwb3J0
KSwNCj4gICAJCQkJIEJJVChwb3J0KSk7DQo+ICAgCWlmIChyZXQpIHsNCj4gLQkJZGV2X2Vycihz
bWktPmRldiwgImZhaWxlZCB0byBkaXNhYmxlIHRoZSBDUFUgcG9ydFxuIik7DQo+ICsJCWRldl9l
cnIocHJpdi0+ZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgdGhlIENQVSBwb3J0XG4iKTsNCj4gICAJ
CXJldHVybjsNCj4gICAJfQ0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyB2b2lkIHJiODM2NnJiX3Nl
dF9wb3J0X2xlZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwNCj4gK3N0YXRpYyB2b2lkIHJiODM2
NnJiX3NldF9wb3J0X2xlZChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LA0KPiAgIAkJCQkgIGlu
dCBwb3J0LCBib29sIGVuYWJsZSkNCj4gICB7DQo+ICAgCXUxNiB2YWwgPSBlbmFibGUgPyAweDNm
IDogMDsNCj4gICAJaW50IHJldDsNCj4gICANCj4gLQlpZiAoc21pLT5sZWRzX2Rpc2FibGVkKQ0K
PiArCWlmIChwcml2LT5sZWRzX2Rpc2FibGVkKQ0KPiAgIAkJcmV0dXJuOw0KPiAgIA0KPiAgIAlz
d2l0Y2ggKHBvcnQpIHsNCj4gICAJY2FzZSAwOg0KPiAtCQlyZXQgPSByZWdtYXBfdXBkYXRlX2Jp
dHMoc21pLT5tYXAsDQo+ICsJCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsDQo+
ICAgCQkJCQkgUlRMODM2NlJCX0xFRF8wXzFfQ1RSTF9SRUcsDQo+ICAgCQkJCQkgMHgzRiwgdmFs
KTsNCj4gICAJCWJyZWFrOw0KPiAgIAljYXNlIDE6DQo+IC0JCXJldCA9IHJlZ21hcF91cGRhdGVf
Yml0cyhzbWktPm1hcCwNCj4gKwkJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwN
Cj4gICAJCQkJCSBSVEw4MzY2UkJfTEVEXzBfMV9DVFJMX1JFRywNCj4gICAJCQkJCSAweDNGIDw8
IFJUTDgzNjZSQl9MRURfMV9PRkZTRVQsDQo+ICAgCQkJCQkgdmFsIDw8IFJUTDgzNjZSQl9MRURf
MV9PRkZTRVQpOw0KPiAgIAkJYnJlYWs7DQo+ICAgCWNhc2UgMjoNCj4gLQkJcmV0ID0gcmVnbWFw
X3VwZGF0ZV9iaXRzKHNtaS0+bWFwLA0KPiArCQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJp
di0+bWFwLA0KPiAgIAkJCQkJIFJUTDgzNjZSQl9MRURfMl8zX0NUUkxfUkVHLA0KPiAgIAkJCQkJ
IDB4M0YsIHZhbCk7DQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSAzOg0KPiAtCQlyZXQgPSByZWdt
YXBfdXBkYXRlX2JpdHMoc21pLT5tYXAsDQo+ICsJCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhw
cml2LT5tYXAsDQo+ICAgCQkJCQkgUlRMODM2NlJCX0xFRF8yXzNfQ1RSTF9SRUcsDQo+ICAgCQkJ
CQkgMHgzRiA8PCBSVEw4MzY2UkJfTEVEXzNfT0ZGU0VULA0KPiAgIAkJCQkJIHZhbCA8PCBSVEw4
MzY2UkJfTEVEXzNfT0ZGU0VUKTsNCj4gICAJCWJyZWFrOw0KPiAgIAljYXNlIDQ6DQo+IC0JCXJl
dCA9IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwNCj4gKwkJcmV0ID0gcmVnbWFwX3VwZGF0
ZV9iaXRzKHByaXYtPm1hcCwNCj4gICAJCQkJCSBSVEw4MzY2UkJfSU5URVJSVVBUX0NPTlRST0xf
UkVHLA0KPiAgIAkJCQkJIFJUTDgzNjZSQl9QNF9SR01JSV9MRUQsDQo+ICAgCQkJCQkgZW5hYmxl
ID8gUlRMODM2NlJCX1A0X1JHTUlJX0xFRCA6IDApOw0KPiAgIAkJYnJlYWs7DQo+ICAgCWRlZmF1
bHQ6DQo+IC0JCWRldl9lcnIoc21pLT5kZXYsICJubyBMRUQgZm9yIHBvcnQgJWRcbiIsIHBvcnQp
Ow0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwgIm5vIExFRCBmb3IgcG9ydCAlZFxuIiwgcG9ydCk7
DQo+ICAgCQlyZXR1cm47DQo+ICAgCX0NCj4gICAJaWYgKHJldCkNCj4gLQkJZGV2X2VycihzbWkt
PmRldiwgImVycm9yIHVwZGF0aW5nIExFRCBvbiBwb3J0ICVkXG4iLCBwb3J0KTsNCj4gKwkJZGV2
X2Vycihwcml2LT5kZXYsICJlcnJvciB1cGRhdGluZyBMRUQgb24gcG9ydCAlZFxuIiwgcG9ydCk7
DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQNCj4gICBydGw4MzY2cmJfcG9ydF9lbmFibGUo
c3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJCSAgICAgIHN0cnVjdCBwaHlf
ZGV2aWNlICpwaHkpDQo+ICAgew0KPiAtCXN0cnVjdCByZWFsdGVrX3NtaSAqc21pID0gZHMtPnBy
aXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiA9IGRzLT5wcml2Ow0KPiAgIAlpbnQg
cmV0Ow0KPiAgIA0KPiAtCWRldl9kYmcoc21pLT5kZXYsICJlbmFibGUgcG9ydCAlZFxuIiwgcG9y
dCk7DQo+IC0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfUEVD
UiwgQklUKHBvcnQpLA0KPiArCWRldl9kYmcocHJpdi0+ZGV2LCAiZW5hYmxlIHBvcnQgJWRcbiIs
IHBvcnQpOw0KPiArCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZS
Ql9QRUNSLCBCSVQocG9ydCksDQo+ICAgCQkJCSAwKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJl
dHVybiByZXQ7DQo+ICAgDQo+IC0JcmI4MzY2cmJfc2V0X3BvcnRfbGVkKHNtaSwgcG9ydCwgdHJ1
ZSk7DQo+ICsJcmI4MzY2cmJfc2V0X3BvcnRfbGVkKHByaXYsIHBvcnQsIHRydWUpOw0KPiAgIAly
ZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+ICAgc3RhdGljIHZvaWQNCj4gICBydGw4MzY2cmJfcG9y
dF9kaXNhYmxlKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQpDQo+ICAgew0KPiAtCXN0
cnVjdCByZWFsdGVrX3NtaSAqc21pID0gZHMtPnByaXY7DQo+ICsJc3RydWN0IHJlYWx0ZWtfcHJp
diAqcHJpdiA9IGRzLT5wcml2Ow0KPiAgIAlpbnQgcmV0Ow0KPiAgIA0KPiAtCWRldl9kYmcoc21p
LT5kZXYsICJkaXNhYmxlIHBvcnQgJWRcbiIsIHBvcnQpOw0KPiAtCXJldCA9IHJlZ21hcF91cGRh
dGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX1BFQ1IsIEJJVChwb3J0KSwNCj4gKwlkZXZfZGJn
KHByaXYtPmRldiwgImRpc2FibGUgcG9ydCAlZFxuIiwgcG9ydCk7DQo+ICsJcmV0ID0gcmVnbWFw
X3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwgUlRMODM2NlJCX1BFQ1IsIEJJVChwb3J0KSwNCj4gICAJ
CQkJIEJJVChwb3J0KSk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm47DQo+ICAgDQo+IC0J
cmI4MzY2cmJfc2V0X3BvcnRfbGVkKHNtaSwgcG9ydCwgZmFsc2UpOw0KPiArCXJiODM2NnJiX3Nl
dF9wb3J0X2xlZChwcml2LCBwb3J0LCBmYWxzZSk7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBp
bnQNCj4gQEAgLTExODksNyArMTE4OSw3IEBAIHJ0bDgzNjZyYl9wb3J0X2JyaWRnZV9qb2luKHN0
cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgCQkJICAgc3RydWN0IGRzYV9icmlk
Z2UgYnJpZGdlLA0KPiAgIAkJCSAgIGJvb2wgKnR4X2Z3ZF9vZmZsb2FkKQ0KPiAgIHsNCj4gLQlz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3By
aXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJdW5zaWduZWQgaW50IHBvcnRfYml0bWFwID0gMDsN
Cj4gICAJaW50IHJldCwgaTsNCj4gICANCj4gQEAgLTEyMDIsMTcgKzEyMDIsMTcgQEAgcnRsODM2
NnJiX3BvcnRfYnJpZGdlX2pvaW4oc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4g
ICAJCWlmICghZHNhX3BvcnRfb2ZmbG9hZHNfYnJpZGdlKGRzYV90b19wb3J0KGRzLCBpKSwgJmJy
aWRnZSkpDQo+ICAgCQkJY29udGludWU7DQo+ICAgCQkvKiBKb2luIHRoaXMgcG9ydCB0byBlYWNo
IG90aGVyIHBvcnQgb24gdGhlIGJyaWRnZSAqLw0KPiAtCQlyZXQgPSByZWdtYXBfdXBkYXRlX2Jp
dHMoc21pLT5tYXAsIFJUTDgzNjZSQl9QT1JUX0lTTyhpKSwNCj4gKwkJcmV0ID0gcmVnbWFwX3Vw
ZGF0ZV9iaXRzKHByaXYtPm1hcCwgUlRMODM2NlJCX1BPUlRfSVNPKGkpLA0KPiAgIAkJCQkJIFJU
TDgzNjZSQl9QT1JUX0lTT19QT1JUUyhCSVQocG9ydCkpLA0KPiAgIAkJCQkJIFJUTDgzNjZSQl9Q
T1JUX0lTT19QT1JUUyhCSVQocG9ydCkpKTsNCj4gICAJCWlmIChyZXQpDQo+IC0JCQlkZXZfZXJy
KHNtaS0+ZGV2LCAiZmFpbGVkIHRvIGpvaW4gcG9ydCAlZFxuIiwgcG9ydCk7DQo+ICsJCQlkZXZf
ZXJyKHByaXYtPmRldiwgImZhaWxlZCB0byBqb2luIHBvcnQgJWRcbiIsIHBvcnQpOw0KPiAgIA0K
PiAgIAkJcG9ydF9iaXRtYXAgfD0gQklUKGkpOw0KPiAgIAl9DQo+ICAgDQo+ICAgCS8qIFNldCB0
aGUgYml0cyBmb3IgdGhlIHBvcnRzIHdlIGNhbiBhY2Nlc3MgKi8NCj4gLQlyZXR1cm4gcmVnbWFw
X3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfUE9SVF9JU08ocG9ydCksDQo+ICsJcmV0
dXJuIHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZSQl9QT1JUX0lTTyhwb3J0
KSwNCj4gICAJCQkJICBSVEw4MzY2UkJfUE9SVF9JU09fUE9SVFMocG9ydF9iaXRtYXApLA0KPiAg
IAkJCQkgIFJUTDgzNjZSQl9QT1JUX0lTT19QT1JUUyhwb3J0X2JpdG1hcCkpOw0KPiAgIH0NCj4g
QEAgLTEyMjEsNyArMTIyMSw3IEBAIHN0YXRpYyB2b2lkDQo+ICAgcnRsODM2NnJiX3BvcnRfYnJp
ZGdlX2xlYXZlKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgCQkJICAgIHN0
cnVjdCBkc2FfYnJpZGdlIGJyaWRnZSkNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtfc21pICpz
bWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMtPnByaXY7
DQo+ICAgCXVuc2lnbmVkIGludCBwb3J0X2JpdG1hcCA9IDA7DQo+ICAgCWludCByZXQsIGk7DQo+
ICAgDQo+IEBAIC0xMjM0LDI4ICsxMjM0LDI4IEBAIHJ0bDgzNjZyYl9wb3J0X2JyaWRnZV9sZWF2
ZShzdHJ1Y3QgZHNhX3N3aXRjaCAqZHMsIGludCBwb3J0LA0KPiAgIAkJaWYgKCFkc2FfcG9ydF9v
ZmZsb2Fkc19icmlkZ2UoZHNhX3RvX3BvcnQoZHMsIGkpLCAmYnJpZGdlKSkNCj4gICAJCQljb250
aW51ZTsNCj4gICAJCS8qIFJlbW92ZSB0aGlzIHBvcnQgZnJvbSBhbnkgb3RoZXIgcG9ydCBvbiB0
aGUgYnJpZGdlICovDQo+IC0JCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRM
ODM2NlJCX1BPUlRfSVNPKGkpLA0KPiArCQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+
bWFwLCBSVEw4MzY2UkJfUE9SVF9JU08oaSksDQo+ICAgCQkJCQkgUlRMODM2NlJCX1BPUlRfSVNP
X1BPUlRTKEJJVChwb3J0KSksIDApOw0KPiAgIAkJaWYgKHJldCkNCj4gLQkJCWRldl9lcnIoc21p
LT5kZXYsICJmYWlsZWQgdG8gbGVhdmUgcG9ydCAlZFxuIiwgcG9ydCk7DQo+ICsJCQlkZXZfZXJy
KHByaXYtPmRldiwgImZhaWxlZCB0byBsZWF2ZSBwb3J0ICVkXG4iLCBwb3J0KTsNCj4gICANCj4g
ICAJCXBvcnRfYml0bWFwIHw9IEJJVChpKTsNCj4gICAJfQ0KPiAgIA0KPiAgIAkvKiBDbGVhciB0
aGUgYml0cyBmb3IgdGhlIHBvcnRzIHdlIGNhbiBub3QgYWNjZXNzLCBsZWF2ZSBvdXJzZWx2ZXMg
Ki8NCj4gLQlyZWdtYXBfdXBkYXRlX2JpdHMoc21pLT5tYXAsIFJUTDgzNjZSQl9QT1JUX0lTTyhw
b3J0KSwNCj4gKwlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfUE9SVF9J
U08ocG9ydCksDQo+ICAgCQkJICAgUlRMODM2NlJCX1BPUlRfSVNPX1BPUlRTKHBvcnRfYml0bWFw
KSwgMCk7DQo+ICAgfQ0KPiAgIA0KPiAgIC8qKg0KPiAgICAqIHJ0bDgzNjZyYl9kcm9wX3VudGFn
Z2VkKCkgLSBtYWtlIHRoZSBzd2l0Y2ggZHJvcCB1bnRhZ2dlZCBhbmQgQy10YWdnZWQgZnJhbWVz
DQo+IC0gKiBAc21pOiBTTUkgc3RhdGUgY29udGFpbmVyDQo+ICsgKiBAcHJpdjogU01JIHN0YXRl
IGNvbnRhaW5lcg0KPiAgICAqIEBwb3J0OiB0aGUgcG9ydCB0byBkcm9wIHVudGFnZ2VkIGFuZCBD
LXRhZ2dlZCBmcmFtZXMgb24NCj4gICAgKiBAZHJvcDogd2hldGhlciB0byBkcm9wIG9yIHBhc3Mg
dW50YWdnZWQgYW5kIEMtdGFnZ2VkIGZyYW1lcw0KPiAgICAqLw0KPiAtc3RhdGljIGludCBydGw4
MzY2cmJfZHJvcF91bnRhZ2dlZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBvcnQsIGJv
b2wgZHJvcCkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NnJiX2Ryb3BfdW50YWdnZWQoc3RydWN0IHJl
YWx0ZWtfcHJpdiAqcHJpdiwgaW50IHBvcnQsIGJvb2wgZHJvcCkNCj4gICB7DQo+IC0JcmV0dXJu
IHJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX1ZMQU5fSU5HUkVTU19DVFJM
MV9SRUcsDQo+ICsJcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZS
Ql9WTEFOX0lOR1JFU1NfQ1RSTDFfUkVHLA0KPiAgIAkJCQkgIFJUTDgzNjZSQl9WTEFOX0lOR1JF
U1NfQ1RSTDFfRFJPUChwb3J0KSwNCj4gICAJCQkJICBkcm9wID8gUlRMODM2NlJCX1ZMQU5fSU5H
UkVTU19DVFJMMV9EUk9QKHBvcnQpIDogMCk7DQo+ICAgfQ0KPiBAQCAtMTI2NCwxNyArMTI2NCwx
NyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl92bGFuX2ZpbHRlcmluZyhzdHJ1Y3QgZHNhX3N3aXRj
aCAqZHMsIGludCBwb3J0LA0KPiAgIAkJCQkgICAgYm9vbCB2bGFuX2ZpbHRlcmluZywNCj4gICAJ
CQkJICAgIHN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykNCj4gICB7DQo+IC0Jc3RydWN0
IHJlYWx0ZWtfc21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpw
cml2ID0gZHMtPnByaXY7DQo+ICAgCXN0cnVjdCBydGw4MzY2cmIgKnJiOw0KPiAgIAlpbnQgcmV0
Ow0KPiAgIA0KPiAtCXJiID0gc21pLT5jaGlwX2RhdGE7DQo+ICsJcmIgPSBwcml2LT5jaGlwX2Rh
dGE7DQo+ICAgDQo+IC0JZGV2X2RiZyhzbWktPmRldiwgInBvcnQgJWQ6ICVzIFZMQU4gZmlsdGVy
aW5nXG4iLCBwb3J0LA0KPiArCWRldl9kYmcocHJpdi0+ZGV2LCAicG9ydCAlZDogJXMgVkxBTiBm
aWx0ZXJpbmdcbiIsIHBvcnQsDQo+ICAgCQl2bGFuX2ZpbHRlcmluZyA/ICJlbmFibGUiIDogImRp
c2FibGUiKTsNCj4gICANCj4gICAJLyogSWYgdGhlIHBvcnQgaXMgbm90IGluIHRoZSBtZW1iZXIg
c2V0LCB0aGUgZnJhbWUgd2lsbCBiZSBkcm9wcGVkICovDQo+IC0JcmV0ID0gcmVnbWFwX3VwZGF0
ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfVkxBTl9JTkdSRVNTX0NUUkwyX1JFRywNCj4gKwly
ZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+bWFwLCBSVEw4MzY2UkJfVkxBTl9JTkdSRVNT
X0NUUkwyX1JFRywNCj4gICAJCQkJIEJJVChwb3J0KSwgdmxhbl9maWx0ZXJpbmcgPyBCSVQocG9y
dCkgOiAwKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+IEBAIC0xMjg0LDkg
KzEyODQsOSBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl92bGFuX2ZpbHRlcmluZyhzdHJ1Y3QgZHNh
X3N3aXRjaCAqZHMsIGludCBwb3J0LA0KPiAgIAkgKiBmaWx0ZXJpbmcgb24gYSBwb3J0LCB3ZSBu
ZWVkIHRvIGFjY2VwdCBhbnkgZnJhbWVzLg0KPiAgIAkgKi8NCj4gICAJaWYgKHZsYW5fZmlsdGVy
aW5nKQ0KPiAtCQlyZXQgPSBydGw4MzY2cmJfZHJvcF91bnRhZ2dlZChzbWksIHBvcnQsICFyYi0+
cHZpZF9lbmFibGVkW3BvcnRdKTsNCj4gKwkJcmV0ID0gcnRsODM2NnJiX2Ryb3BfdW50YWdnZWQo
cHJpdiwgcG9ydCwgIXJiLT5wdmlkX2VuYWJsZWRbcG9ydF0pOw0KPiAgIAllbHNlDQo+IC0JCXJl
dCA9IHJ0bDgzNjZyYl9kcm9wX3VudGFnZ2VkKHNtaSwgcG9ydCwgZmFsc2UpOw0KPiArCQlyZXQg
PSBydGw4MzY2cmJfZHJvcF91bnRhZ2dlZChwcml2LCBwb3J0LCBmYWxzZSk7DQo+ICAgDQo+ICAg
CXJldHVybiByZXQ7DQo+ICAgfQ0KPiBAQCAtMTMwOCwxMSArMTMwOCwxMSBAQCBydGw4MzY2cmJf
cG9ydF9icmlkZ2VfZmxhZ3Moc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwNCj4gICAJ
CQkgICAgc3RydWN0IHN3aXRjaGRldl9icnBvcnRfZmxhZ3MgZmxhZ3MsDQo+ICAgCQkJICAgIHN0
cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykNCj4gICB7DQo+IC0Jc3RydWN0IHJlYWx0ZWtf
c21pICpzbWkgPSBkcy0+cHJpdjsNCj4gKwlzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2ID0gZHMt
PnByaXY7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+ICAgCWlmIChmbGFncy5tYXNrICYgQlJfTEVB
Uk5JTkcpIHsNCj4gLQkJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2
UkJfUE9SVF9MRUFSTkRJU19DVFJMLA0KPiArCQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMocHJp
di0+bWFwLCBSVEw4MzY2UkJfUE9SVF9MRUFSTkRJU19DVFJMLA0KPiAgIAkJCQkJIEJJVChwb3J0
KSwNCj4gICAJCQkJCSAoZmxhZ3MudmFsICYgQlJfTEVBUk5JTkcpID8gMCA6IEJJVChwb3J0KSk7
DQo+ICAgCQlpZiAocmV0KQ0KPiBAQCAtMTMyNSw3ICsxMzI1LDcgQEAgcnRsODM2NnJiX3BvcnRf
YnJpZGdlX2ZsYWdzKHN0cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsDQo+ICAgc3RhdGlj
IHZvaWQNCj4gICBydGw4MzY2cmJfcG9ydF9zdHBfc3RhdGVfc2V0KHN0cnVjdCBkc2Ffc3dpdGNo
ICpkcywgaW50IHBvcnQsIHU4IHN0YXRlKQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJp
djsNCj4gICAJdTMyIHZhbDsNCj4gICAJaW50IGk7DQo+ICAgDQo+IEBAIC0xMzQ0LDEzICsxMzQ0
LDEzIEBAIHJ0bDgzNjZyYl9wb3J0X3N0cF9zdGF0ZV9zZXQoc3RydWN0IGRzYV9zd2l0Y2ggKmRz
LCBpbnQgcG9ydCwgdTggc3RhdGUpDQo+ICAgCQl2YWwgPSBSVEw4MzY2UkJfU1RQX1NUQVRFX0ZP
UldBUkRJTkc7DQo+ICAgCQlicmVhazsNCj4gICAJZGVmYXVsdDoNCj4gLQkJZGV2X2VycihzbWkt
PmRldiwgInVua25vd24gYnJpZGdlIHN0YXRlIHJlcXVlc3RlZFxuIik7DQo+ICsJCWRldl9lcnIo
cHJpdi0+ZGV2LCAidW5rbm93biBicmlkZ2Ugc3RhdGUgcmVxdWVzdGVkXG4iKTsNCj4gICAJCXJl
dHVybjsNCj4gICAJfQ0KPiAgIA0KPiAgIAkvKiBTZXQgdGhlIHNhbWUgc3RhdHVzIGZvciB0aGUg
cG9ydCBvbiBhbGwgdGhlIEZJRHMgKi8NCj4gICAJZm9yIChpID0gMDsgaSA8IFJUTDgzNjZSQl9O
VU1fRklEUzsgaSsrKSB7DQo+IC0JCXJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2
NlJCX1NUUF9TVEFURV9CQVNFICsgaSwNCj4gKwkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1h
cCwgUlRMODM2NlJCX1NUUF9TVEFURV9CQVNFICsgaSwNCj4gICAJCQkJICAgUlRMODM2NlJCX1NU
UF9TVEFURV9NQVNLKHBvcnQpLA0KPiAgIAkJCQkgICBSVEw4MzY2UkJfU1RQX1NUQVRFKHBvcnQs
IHZhbCkpOw0KPiAgIAl9DQo+IEBAIC0xMzU5LDI2ICsxMzU5LDI2IEBAIHJ0bDgzNjZyYl9wb3J0
X3N0cF9zdGF0ZV9zZXQoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9ydCwgdTggc3RhdGUp
DQo+ICAgc3RhdGljIHZvaWQNCj4gICBydGw4MzY2cmJfcG9ydF9mYXN0X2FnZShzdHJ1Y3QgZHNh
X3N3aXRjaCAqZHMsIGludCBwb3J0KQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgcmVhbHRla19zbWkgKnNt
aSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYgPSBkcy0+cHJpdjsN
Cj4gICANCj4gICAJLyogVGhpcyB3aWxsIGFnZSBvdXQgYW55IGxlYXJuZWQgTDIgZW50cmllcyAq
Lw0KPiAtCXJlZ21hcF91cGRhdGVfYml0cyhzbWktPm1hcCwgUlRMODM2NlJCX1NFQ1VSSVRZX0NU
UkwsDQo+ICsJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPm1hcCwgUlRMODM2NlJCX1NFQ1VSSVRZ
X0NUUkwsDQo+ICAgCQkJICAgQklUKHBvcnQpLCBCSVQocG9ydCkpOw0KPiAgIAkvKiBSZXN0b3Jl
IHRoZSBub3JtYWwgc3RhdGUgb2YgdGhpbmdzICovDQo+IC0JcmVnbWFwX3VwZGF0ZV9iaXRzKHNt
aS0+bWFwLCBSVEw4MzY2UkJfU0VDVVJJVFlfQ1RSTCwNCj4gKwlyZWdtYXBfdXBkYXRlX2JpdHMo
cHJpdi0+bWFwLCBSVEw4MzY2UkJfU0VDVVJJVFlfQ1RSTCwNCj4gICAJCQkgICBCSVQocG9ydCks
IDApOw0KPiAgIH0NCj4gICANCj4gICBzdGF0aWMgaW50IHJ0bDgzNjZyYl9jaGFuZ2VfbXR1KHN0
cnVjdCBkc2Ffc3dpdGNoICpkcywgaW50IHBvcnQsIGludCBuZXdfbXR1KQ0KPiAgIHsNCj4gLQlz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSA9IGRzLT5wcml2Ow0KPiArCXN0cnVjdCByZWFsdGVrX3By
aXYgKnByaXYgPSBkcy0+cHJpdjsNCj4gICAJc3RydWN0IHJ0bDgzNjZyYiAqcmI7DQo+ICAgCXVu
c2lnbmVkIGludCBtYXhfbXR1Ow0KPiAgIAl1MzIgbGVuOw0KPiAgIAlpbnQgaTsNCj4gICANCj4g
ICAJLyogQ2FjaGUgdGhlIHBlci1wb3J0IE1UVSBzZXR0aW5nICovDQo+IC0JcmIgPSBzbWktPmNo
aXBfZGF0YTsNCj4gKwlyYiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICAJcmItPm1heF9tdHVbcG9y
dF0gPSBuZXdfbXR1Ow0KPiAgIA0KPiAgIAkvKiBSb29mIG91dCB0aGUgTVRVIGZvciB0aGUgZW50
aXJlIHN3aXRjaCB0byB0aGUgZ3JlYXRlc3QNCj4gQEAgLTE0MDYsNyArMTQwNiw3IEBAIHN0YXRp
YyBpbnQgcnRsODM2NnJiX2NoYW5nZV9tdHUoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQgcG9y
dCwgaW50IG5ld19tdHUpDQo+ICAgCWVsc2UNCj4gICAJCWxlbiA9IFJUTDgzNjZSQl9TR0NSX01B
WF9MRU5HVEhfMTYwMDA7DQo+ICAgDQo+IC0JcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhzbWkt
Pm1hcCwgUlRMODM2NlJCX1NHQ1IsDQo+ICsJcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhwcml2
LT5tYXAsIFJUTDgzNjZSQl9TR0NSLA0KPiAgIAkJCQkgIFJUTDgzNjZSQl9TR0NSX01BWF9MRU5H
VEhfTUFTSywNCj4gICAJCQkJICBsZW4pOw0KPiAgIH0NCj4gQEAgLTE0MTksNyArMTQxOSw3IEBA
IHN0YXRpYyBpbnQgcnRsODM2NnJiX21heF9tdHUoc3RydWN0IGRzYV9zd2l0Y2ggKmRzLCBpbnQg
cG9ydCkNCj4gICAJcmV0dXJuIDE1OTk2Ow0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRs
ODM2NnJiX2dldF92bGFuXzRrKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCB1MzIgdmlkLA0KPiAr
c3RhdGljIGludCBydGw4MzY2cmJfZ2V0X3ZsYW5fNGsoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJp
diwgdTMyIHZpZCwNCj4gICAJCQkJIHN0cnVjdCBydGw4MzY2X3ZsYW5fNGsgKnZsYW40aykNCj4g
ICB7DQo+ICAgCXUzMiBkYXRhWzNdOw0KPiBAQCAtMTQzMiwxOSArMTQzMiwxOSBAQCBzdGF0aWMg
aW50IHJ0bDgzNjZyYl9nZXRfdmxhbl80ayhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTMyIHZp
ZCwNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAgIA0KPiAgIAkvKiB3cml0ZSBWSUQgKi8NCj4g
LQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIFJUTDgzNjZSQl9WTEFOX1RBQkxFX1dSSVRF
X0JBU0UsDQo+ICsJcmV0ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgUlRMODM2NlJCX1ZMQU5f
VEFCTEVfV1JJVEVfQkFTRSwNCj4gICAJCQkgICB2aWQgJiBSVEw4MzY2UkJfVkxBTl9WSURfTUFT
Syk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAkvKiB3cml0
ZSB0YWJsZSBhY2Nlc3MgY29udHJvbCB3b3JkICovDQo+IC0JcmV0ID0gcmVnbWFwX3dyaXRlKHNt
aS0+bWFwLCBSVEw4MzY2UkJfVEFCTEVfQUNDRVNTX0NUUkxfUkVHLA0KPiArCXJldCA9IHJlZ21h
cF93cml0ZShwcml2LT5tYXAsIFJUTDgzNjZSQl9UQUJMRV9BQ0NFU1NfQ1RSTF9SRUcsDQo+ICAg
CQkJICAgUlRMODM2NlJCX1RBQkxFX1ZMQU5fUkVBRF9DVFJMKTsNCj4gICAJaWYgKHJldCkNCj4g
ICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsNCj4g
LQkJcmV0ID0gcmVnbWFwX3JlYWQoc21pLT5tYXAsDQo+ICsJCXJldCA9IHJlZ21hcF9yZWFkKHBy
aXYtPm1hcCwNCj4gICAJCQkJICBSVEw4MzY2UkJfVkxBTl9UQUJMRV9SRUFEX0JBU0UgKyBpLA0K
PiAgIAkJCQkgICZkYXRhW2ldKTsNCj4gICAJCWlmIChyZXQpDQo+IEBAIC0xNDYwLDcgKzE0NjAs
NyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9nZXRfdmxhbl80ayhzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSwgdTMyIHZpZCwNCj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGlu
dCBydGw4MzY2cmJfc2V0X3ZsYW5fNGsoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksDQo+ICtzdGF0
aWMgaW50IHJ0bDgzNjZyYl9zZXRfdmxhbl80ayhzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LA0K
PiAgIAkJCQkgY29uc3Qgc3RydWN0IHJ0bDgzNjZfdmxhbl80ayAqdmxhbjRrKQ0KPiAgIHsNCj4g
ICAJdTMyIGRhdGFbM107DQo+IEBAIC0xNDgwLDcgKzE0ODAsNyBAQCBzdGF0aWMgaW50IHJ0bDgz
NjZyYl9zZXRfdmxhbl80ayhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwNCj4gICAJZGF0YVsyXSA9
IHZsYW40ay0+ZmlkICYgUlRMODM2NlJCX1ZMQU5fRklEX01BU0s7DQo+ICAgDQo+ICAgCWZvciAo
aSA9IDA7IGkgPCAzOyBpKyspIHsNCj4gLQkJcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+bWFwLA0K
PiArCQlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLA0KPiAgIAkJCQkgICBSVEw4MzY2UkJf
VkxBTl9UQUJMRV9XUklURV9CQVNFICsgaSwNCj4gICAJCQkJICAgZGF0YVtpXSk7DQo+ICAgCQlp
ZiAocmV0KQ0KPiBAQCAtMTQ4OCwxMyArMTQ4OCwxMyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9z
ZXRfdmxhbl80ayhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwNCj4gICAJfQ0KPiAgIA0KPiAgIAkv
KiB3cml0ZSB0YWJsZSBhY2Nlc3MgY29udHJvbCB3b3JkICovDQo+IC0JcmV0ID0gcmVnbWFwX3dy
aXRlKHNtaS0+bWFwLCBSVEw4MzY2UkJfVEFCTEVfQUNDRVNTX0NUUkxfUkVHLA0KPiArCXJldCA9
IHJlZ21hcF93cml0ZShwcml2LT5tYXAsIFJUTDgzNjZSQl9UQUJMRV9BQ0NFU1NfQ1RSTF9SRUcs
DQo+ICAgCQkJICAgUlRMODM2NlJCX1RBQkxFX1ZMQU5fV1JJVEVfQ1RSTCk7DQo+ICAgDQo+ICAg
CXJldHVybiByZXQ7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBydGw4MzY2cmJfZ2V0X3Zs
YW5fbWMoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHUzMiBpbmRleCwNCj4gK3N0YXRpYyBpbnQg
cnRsODM2NnJiX2dldF92bGFuX21jKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIHUzMiBpbmRl
eCwNCj4gICAJCQkJIHN0cnVjdCBydGw4MzY2X3ZsYW5fbWMgKnZsYW5tYykNCj4gICB7DQo+ICAg
CXUzMiBkYXRhWzNdOw0KPiBAQCAtMTUwNyw3ICsxNTA3LDcgQEAgc3RhdGljIGludCBydGw4MzY2
cmJfZ2V0X3ZsYW5fbWMoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHUzMiBpbmRleCwNCj4gICAJ
CXJldHVybiAtRUlOVkFMOw0KPiAgIA0KPiAgIAlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7DQo+
IC0JCXJldCA9IHJlZ21hcF9yZWFkKHNtaS0+bWFwLA0KPiArCQlyZXQgPSByZWdtYXBfcmVhZChw
cml2LT5tYXAsDQo+ICAgCQkJCSAgUlRMODM2NlJCX1ZMQU5fTUNfQkFTRShpbmRleCkgKyBpLA0K
PiAgIAkJCQkgICZkYXRhW2ldKTsNCj4gICAJCWlmIChyZXQpDQo+IEBAIC0xNTI1LDcgKzE1MjUs
NyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9nZXRfdmxhbl9tYyhzdHJ1Y3QgcmVhbHRla19zbWkg
KnNtaSwgdTMyIGluZGV4LA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMg
aW50IHJ0bDgzNjZyYl9zZXRfdmxhbl9tYyhzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgdTMyIGlu
ZGV4LA0KPiArc3RhdGljIGludCBydGw4MzY2cmJfc2V0X3ZsYW5fbWMoc3RydWN0IHJlYWx0ZWtf
cHJpdiAqcHJpdiwgdTMyIGluZGV4LA0KPiAgIAkJCQkgY29uc3Qgc3RydWN0IHJ0bDgzNjZfdmxh
bl9tYyAqdmxhbm1jKQ0KPiAgIHsNCj4gICAJdTMyIGRhdGFbM107DQo+IEBAIC0xNTQ5LDcgKzE1
NDksNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXRfdmxhbl9tYyhzdHJ1Y3QgcmVhbHRla19z
bWkgKnNtaSwgdTMyIGluZGV4LA0KPiAgIAlkYXRhWzJdID0gdmxhbm1jLT5maWQgJiBSVEw4MzY2
UkJfVkxBTl9GSURfTUFTSzsNCj4gICANCj4gICAJZm9yIChpID0gMDsgaSA8IDM7IGkrKykgew0K
PiAtCQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsDQo+ICsJCXJldCA9IHJlZ21hcF93cml0
ZShwcml2LT5tYXAsDQo+ICAgCQkJCSAgIFJUTDgzNjZSQl9WTEFOX01DX0JBU0UoaW5kZXgpICsg
aSwNCj4gICAJCQkJICAgZGF0YVtpXSk7DQo+ICAgCQlpZiAocmV0KQ0KPiBAQCAtMTU1OSwxNSAr
MTU1OSwxNSBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXRfdmxhbl9tYyhzdHJ1Y3QgcmVhbHRl
a19zbWkgKnNtaSwgdTMyIGluZGV4LA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1z
dGF0aWMgaW50IHJ0bDgzNjZyYl9nZXRfbWNfaW5kZXgoc3RydWN0IHJlYWx0ZWtfc21pICpzbWks
IGludCBwb3J0LCBpbnQgKnZhbCkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NnJiX2dldF9tY19pbmRl
eChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCBpbnQgcG9ydCwgaW50ICp2YWwpDQo+ICAgew0K
PiAgIAl1MzIgZGF0YTsNCj4gICAJaW50IHJldDsNCj4gICANCj4gLQlpZiAocG9ydCA+PSBzbWkt
Pm51bV9wb3J0cykNCj4gKwlpZiAocG9ydCA+PSBwcml2LT5udW1fcG9ydHMpDQo+ICAgCQlyZXR1
cm4gLUVJTlZBTDsNCj4gICANCj4gLQlyZXQgPSByZWdtYXBfcmVhZChzbWktPm1hcCwgUlRMODM2
NlJCX1BPUlRfVkxBTl9DVFJMX1JFRyhwb3J0KSwNCj4gKwlyZXQgPSByZWdtYXBfcmVhZChwcml2
LT5tYXAsIFJUTDgzNjZSQl9QT1JUX1ZMQU5fQ1RSTF9SRUcocG9ydCksDQo+ICAgCQkJICAmZGF0
YSk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiBAQCAtMTU3OCwxOSArMTU3
OCwxOSBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9nZXRfbWNfaW5kZXgoc3RydWN0IHJlYWx0ZWtf
c21pICpzbWksIGludCBwb3J0LCBpbnQgKnZhbCkNCj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAg
IA0KPiAtc3RhdGljIGludCBydGw4MzY2cmJfc2V0X21jX2luZGV4KHN0cnVjdCByZWFsdGVrX3Nt
aSAqc21pLCBpbnQgcG9ydCwgaW50IGluZGV4KQ0KPiArc3RhdGljIGludCBydGw4MzY2cmJfc2V0
X21jX2luZGV4KHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYsIGludCBwb3J0LCBpbnQgaW5kZXgp
DQo+ICAgew0KPiAgIAlzdHJ1Y3QgcnRsODM2NnJiICpyYjsNCj4gICAJYm9vbCBwdmlkX2VuYWJs
ZWQ7DQo+ICAgCWludCByZXQ7DQo+ICAgDQo+IC0JcmIgPSBzbWktPmNoaXBfZGF0YTsNCj4gKwly
YiA9IHByaXYtPmNoaXBfZGF0YTsNCj4gICAJcHZpZF9lbmFibGVkID0gISFpbmRleDsNCj4gICAN
Cj4gLQlpZiAocG9ydCA+PSBzbWktPm51bV9wb3J0cyB8fCBpbmRleCA+PSBSVEw4MzY2UkJfTlVN
X1ZMQU5TKQ0KPiArCWlmIChwb3J0ID49IHByaXYtPm51bV9wb3J0cyB8fCBpbmRleCA+PSBSVEw4
MzY2UkJfTlVNX1ZMQU5TKQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+IC0JcmV0ID0g
cmVnbWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLCBSVEw4MzY2UkJfUE9SVF9WTEFOX0NUUkxfUkVH
KHBvcnQpLA0KPiArCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZS
Ql9QT1JUX1ZMQU5fQ1RSTF9SRUcocG9ydCksDQo+ICAgCQkJCVJUTDgzNjZSQl9QT1JUX1ZMQU5f
Q1RSTF9NQVNLIDw8DQo+ICAgCQkJCQlSVEw4MzY2UkJfUE9SVF9WTEFOX0NUUkxfU0hJRlQocG9y
dCksDQo+ICAgCQkJCShpbmRleCAmIFJUTDgzNjZSQl9QT1JUX1ZMQU5fQ1RSTF9NQVNLKSA8PA0K
PiBAQCAtMTYwNCwxNyArMTYwNCwxNyBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9zZXRfbWNfaW5k
ZXgoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIGludCBwb3J0LCBpbnQgaW5kZXgpDQo+ICAgCSAq
IG5vdCBkcm9wIGFueSB1bnRhZ2dlZCBvciBDLXRhZ2dlZCBmcmFtZXMuIE1ha2Ugc3VyZSB0byB1
cGRhdGUgdGhlDQo+ICAgCSAqIGZpbHRlcmluZyBzZXR0aW5nLg0KPiAgIAkgKi8NCj4gLQlpZiAo
ZHNhX3BvcnRfaXNfdmxhbl9maWx0ZXJpbmcoZHNhX3RvX3BvcnQoc21pLT5kcywgcG9ydCkpKQ0K
PiAtCQlyZXQgPSBydGw4MzY2cmJfZHJvcF91bnRhZ2dlZChzbWksIHBvcnQsICFwdmlkX2VuYWJs
ZWQpOw0KPiArCWlmIChkc2FfcG9ydF9pc192bGFuX2ZpbHRlcmluZyhkc2FfdG9fcG9ydChwcml2
LT5kcywgcG9ydCkpKQ0KPiArCQlyZXQgPSBydGw4MzY2cmJfZHJvcF91bnRhZ2dlZChwcml2LCBw
b3J0LCAhcHZpZF9lbmFibGVkKTsNCj4gICANCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+ICAg
DQo+IC1zdGF0aWMgYm9vbCBydGw4MzY2cmJfaXNfdmxhbl92YWxpZChzdHJ1Y3QgcmVhbHRla19z
bWkgKnNtaSwgdW5zaWduZWQgaW50IHZsYW4pDQo+ICtzdGF0aWMgYm9vbCBydGw4MzY2cmJfaXNf
dmxhbl92YWxpZChzdHJ1Y3QgcmVhbHRla19wcml2ICpwcml2LCB1bnNpZ25lZCBpbnQgdmxhbikN
Cj4gICB7DQo+ICAgCXVuc2lnbmVkIGludCBtYXggPSBSVEw4MzY2UkJfTlVNX1ZMQU5TIC0gMTsN
Cj4gICANCj4gLQlpZiAoc21pLT52bGFuNGtfZW5hYmxlZCkNCj4gKwlpZiAocHJpdi0+dmxhbjRr
X2VuYWJsZWQpDQo+ICAgCQltYXggPSBSVEw4MzY2UkJfTlVNX1ZJRFMgLSAxOw0KPiAgIA0KPiAg
IAlpZiAodmxhbiA+IG1heCkNCj4gQEAgLTE2MjMsMjMgKzE2MjMsMjMgQEAgc3RhdGljIGJvb2wg
cnRsODM2NnJiX2lzX3ZsYW5fdmFsaWQoc3RydWN0IHJlYWx0ZWtfc21pICpzbWksIHVuc2lnbmVk
IGludCB2bGFuKQ0KPiAgIAlyZXR1cm4gdHJ1ZTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50
IHJ0bDgzNjZyYl9lbmFibGVfdmxhbihzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgYm9vbCBlbmFi
bGUpDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjZyYl9lbmFibGVfdmxhbihzdHJ1Y3QgcmVhbHRla19w
cml2ICpwcml2LCBib29sIGVuYWJsZSkNCj4gICB7DQo+IC0JZGV2X2RiZyhzbWktPmRldiwgIiVz
IFZMQU5cbiIsIGVuYWJsZSA/ICJlbmFibGUiIDogImRpc2FibGUiKTsNCj4gLQlyZXR1cm4gcmVn
bWFwX3VwZGF0ZV9iaXRzKHNtaS0+bWFwLA0KPiArCWRldl9kYmcocHJpdi0+ZGV2LCAiJXMgVkxB
TlxuIiwgZW5hYmxlID8gImVuYWJsZSIgOiAiZGlzYWJsZSIpOw0KPiArCXJldHVybiByZWdtYXBf
dXBkYXRlX2JpdHMocHJpdi0+bWFwLA0KPiAgIAkJCQkgIFJUTDgzNjZSQl9TR0NSLCBSVEw4MzY2
UkJfU0dDUl9FTl9WTEFOLA0KPiAgIAkJCQkgIGVuYWJsZSA/IFJUTDgzNjZSQl9TR0NSX0VOX1ZM
QU4gOiAwKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgzNjZyYl9lbmFibGVfdmxh
bjRrKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pLCBib29sIGVuYWJsZSkNCj4gK3N0YXRpYyBpbnQg
cnRsODM2NnJiX2VuYWJsZV92bGFuNGsoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgYm9vbCBl
bmFibGUpDQo+ICAgew0KPiAtCWRldl9kYmcoc21pLT5kZXYsICIlcyBWTEFOIDRrXG4iLCBlbmFi
bGUgPyAiZW5hYmxlIiA6ICJkaXNhYmxlIik7DQo+IC0JcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0
cyhzbWktPm1hcCwgUlRMODM2NlJCX1NHQ1IsDQo+ICsJZGV2X2RiZyhwcml2LT5kZXYsICIlcyBW
TEFOIDRrXG4iLCBlbmFibGUgPyAiZW5hYmxlIiA6ICJkaXNhYmxlIik7DQo+ICsJcmV0dXJuIHJl
Z21hcF91cGRhdGVfYml0cyhwcml2LT5tYXAsIFJUTDgzNjZSQl9TR0NSLA0KPiAgIAkJCQkgIFJU
TDgzNjZSQl9TR0NSX0VOX1ZMQU5fNEtUQiwNCj4gICAJCQkJICBlbmFibGUgPyBSVEw4MzY2UkJf
U0dDUl9FTl9WTEFOXzRLVEIgOiAwKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHJ0bDgz
NjZyYl9waHlfcmVhZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwgaW50IHJlZ251
bSkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NnJiX3BoeV9yZWFkKHN0cnVjdCByZWFsdGVrX3ByaXYg
KnByaXYsIGludCBwaHksIGludCByZWdudW0pDQo+ICAgew0KPiAgIAl1MzIgdmFsOw0KPiAgIAl1
MzIgcmVnOw0KPiBAQCAtMTY0OCwzMiArMTY0OCwzMiBAQCBzdGF0aWMgaW50IHJ0bDgzNjZyYl9w
aHlfcmVhZChzdHJ1Y3QgcmVhbHRla19zbWkgKnNtaSwgaW50IHBoeSwgaW50IHJlZ251bSkNCj4g
ICAJaWYgKHBoeSA+IFJUTDgzNjZSQl9QSFlfTk9fTUFYKQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7
DQo+ICAgDQo+IC0JcmV0ID0gcmVnbWFwX3dyaXRlKHNtaS0+bWFwLCBSVEw4MzY2UkJfUEhZX0FD
Q0VTU19DVFJMX1JFRywNCj4gKwlyZXQgPSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY2
UkJfUEhZX0FDQ0VTU19DVFJMX1JFRywNCj4gICAJCQkgICBSVEw4MzY2UkJfUEhZX0NUUkxfUkVB
RCk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAlyZWcgPSAw
eDgwMDAgfCAoMSA8PCAocGh5ICsgUlRMODM2NlJCX1BIWV9OT19PRkZTRVQpKSB8IHJlZ251bTsN
Cj4gICANCj4gLQlyZXQgPSByZWdtYXBfd3JpdGUoc21pLT5tYXAsIHJlZywgMCk7DQo+ICsJcmV0
ID0gcmVnbWFwX3dyaXRlKHByaXYtPm1hcCwgcmVnLCAwKTsNCj4gICAJaWYgKHJldCkgew0KPiAt
CQlkZXZfZXJyKHNtaS0+ZGV2LA0KPiArCQlkZXZfZXJyKHByaXYtPmRldiwNCj4gICAJCQkiZmFp
bGVkIHRvIHdyaXRlIFBIWSVkIHJlZyAlMDR4IEAgJTA0eCwgcmV0ICVkXG4iLA0KPiAgIAkJCXBo
eSwgcmVnbnVtLCByZWcsIHJldCk7DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIAl9DQo+ICAgDQo+
IC0JcmV0ID0gcmVnbWFwX3JlYWQoc21pLT5tYXAsIFJUTDgzNjZSQl9QSFlfQUNDRVNTX0RBVEFf
UkVHLCAmdmFsKTsNCj4gKwlyZXQgPSByZWdtYXBfcmVhZChwcml2LT5tYXAsIFJUTDgzNjZSQl9Q
SFlfQUNDRVNTX0RBVEFfUkVHLCAmdmFsKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiBy
ZXQ7DQo+ICAgDQo+IC0JZGV2X2RiZyhzbWktPmRldiwgInJlYWQgUEhZJWQgcmVnaXN0ZXIgMHgl
MDR4IEAgJTA4eCwgdmFsIDwtICUwNHhcbiIsDQo+ICsJZGV2X2RiZyhwcml2LT5kZXYsICJyZWFk
IFBIWSVkIHJlZ2lzdGVyIDB4JTA0eCBAICUwOHgsIHZhbCA8LSAlMDR4XG4iLA0KPiAgIAkJcGh5
LCByZWdudW0sIHJlZywgdmFsKTsNCj4gICANCj4gICAJcmV0dXJuIHZhbDsNCj4gICB9DQo+ICAg
DQo+IC1zdGF0aWMgaW50IHJ0bDgzNjZyYl9waHlfd3JpdGUoc3RydWN0IHJlYWx0ZWtfc21pICpz
bWksIGludCBwaHksIGludCByZWdudW0sDQo+ICtzdGF0aWMgaW50IHJ0bDgzNjZyYl9waHlfd3Jp
dGUoc3RydWN0IHJlYWx0ZWtfcHJpdiAqcHJpdiwgaW50IHBoeSwgaW50IHJlZ251bSwNCj4gICAJ
CQkgICAgICAgdTE2IHZhbCkNCj4gICB7DQo+ICAgCXUzMiByZWc7DQo+IEBAIC0xNjgyLDM0ICsx
NjgyLDM0IEBAIHN0YXRpYyBpbnQgcnRsODM2NnJiX3BoeV93cml0ZShzdHJ1Y3QgcmVhbHRla19z
bWkgKnNtaSwgaW50IHBoeSwgaW50IHJlZ251bSwNCj4gICAJaWYgKHBoeSA+IFJUTDgzNjZSQl9Q
SFlfTk9fTUFYKQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+IC0JcmV0ID0gcmVnbWFw
X3dyaXRlKHNtaS0+bWFwLCBSVEw4MzY2UkJfUEhZX0FDQ0VTU19DVFJMX1JFRywNCj4gKwlyZXQg
PSByZWdtYXBfd3JpdGUocHJpdi0+bWFwLCBSVEw4MzY2UkJfUEhZX0FDQ0VTU19DVFJMX1JFRywN
Cj4gICAJCQkgICBSVEw4MzY2UkJfUEhZX0NUUkxfV1JJVEUpOw0KPiAgIAlpZiAocmV0KQ0KPiAg
IAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJcmVnID0gMHg4MDAwIHwgKDEgPDwgKHBoeSArIFJU
TDgzNjZSQl9QSFlfTk9fT0ZGU0VUKSkgfCByZWdudW07DQo+ICAgDQo+IC0JZGV2X2RiZyhzbWkt
PmRldiwgIndyaXRlIFBIWSVkIHJlZ2lzdGVyIDB4JTA0eCBAICUwNHgsIHZhbCAtPiAlMDR4XG4i
LA0KPiArCWRldl9kYmcocHJpdi0+ZGV2LCAid3JpdGUgUEhZJWQgcmVnaXN0ZXIgMHglMDR4IEAg
JTA0eCwgdmFsIC0+ICUwNHhcbiIsDQo+ICAgCQlwaHksIHJlZ251bSwgcmVnLCB2YWwpOw0KPiAg
IA0KPiAtCXJldCA9IHJlZ21hcF93cml0ZShzbWktPm1hcCwgcmVnLCB2YWwpOw0KPiArCXJldCA9
IHJlZ21hcF93cml0ZShwcml2LT5tYXAsIHJlZywgdmFsKTsNCj4gICAJaWYgKHJldCkNCj4gICAJ
CXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCXJldHVybiAwOw0KPiAgIH0NCj4gICANCj4gLXN0YXRp
YyBpbnQgcnRsODM2NnJiX3Jlc2V0X2NoaXAoc3RydWN0IHJlYWx0ZWtfc21pICpzbWkpDQo+ICtz
dGF0aWMgaW50IHJ0bDgzNjZyYl9yZXNldF9jaGlwKHN0cnVjdCByZWFsdGVrX3ByaXYgKnByaXYp
DQo+ICAgew0KPiAgIAlpbnQgdGltZW91dCA9IDEwOw0KPiAgIAl1MzIgdmFsOw0KPiAgIAlpbnQg
cmV0Ow0KPiAgIA0KPiAtCXJlYWx0ZWtfc21pX3dyaXRlX3JlZ19ub2FjayhzbWksIFJUTDgzNjZS
Ql9SRVNFVF9DVFJMX1JFRywNCj4gKwlwcml2LT53cml0ZV9yZWdfbm9hY2socHJpdiwgUlRMODM2
NlJCX1JFU0VUX0NUUkxfUkVHLA0KPiAgIAkJCQkgICAgUlRMODM2NlJCX0NISVBfQ1RSTF9SRVNF
VF9IVyk7DQoNCkFsc28gTlVMTCBoZXJlLg0KDQo+ICAgCWRvIHsNCj4gICAJCXVzbGVlcF9yYW5n
ZSgyMDAwMCwgMjUwMDApOw0KPiAtCQlyZXQgPSByZWdtYXBfcmVhZChzbWktPm1hcCwgUlRMODM2
NlJCX1JFU0VUX0NUUkxfUkVHLCAmdmFsKTsNCj4gKwkJcmV0ID0gcmVnbWFwX3JlYWQocHJpdi0+
bWFwLCBSVEw4MzY2UkJfUkVTRVRfQ1RSTF9SRUcsICZ2YWwpOw0KPiAgIAkJaWYgKHJldCkNCj4g
ICAJCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAtMTcxOCwyMSArMTcxOCwyMSBAQCBzdGF0aWMg
aW50IHJ0bDgzNjZyYl9yZXNldF9jaGlwKHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiAgIAl9
IHdoaWxlICgtLXRpbWVvdXQpOw0KPiAgIA0KPiAgIAlpZiAoIXRpbWVvdXQpIHsNCj4gLQkJZGV2
X2VycihzbWktPmRldiwgInRpbWVvdXQgd2FpdGluZyBmb3IgdGhlIHN3aXRjaCB0byByZXNldFxu
Iik7DQo+ICsJCWRldl9lcnIocHJpdi0+ZGV2LCAidGltZW91dCB3YWl0aW5nIGZvciB0aGUgc3dp
dGNoIHRvIHJlc2V0XG4iKTsNCj4gICAJCXJldHVybiAtRUlPOw0KPiAgIAl9DQo+ICAgDQo+ICAg
CXJldHVybiAwOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQgcnRsODM2NnJiX2RldGVjdChz
dHJ1Y3QgcmVhbHRla19zbWkgKnNtaSkNCj4gK3N0YXRpYyBpbnQgcnRsODM2NnJiX2RldGVjdChz
dHJ1Y3QgcmVhbHRla19wcml2ICpwcml2KQ0KPiAgIHsNCj4gLQlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSBzbWktPmRldjsNCj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBwcml2LT5kZXY7DQo+ICAgCWlu
dCByZXQ7DQo+ICAgCXUzMiB2YWw7DQo+ICAgDQo+ICAgCS8qIERldGVjdCBkZXZpY2UgKi8NCj4g
LQlyZXQgPSByZWdtYXBfcmVhZChzbWktPm1hcCwgMHg1YywgJnZhbCk7DQo+ICsJcmV0ID0gcmVn
bWFwX3JlYWQocHJpdi0+bWFwLCAweDVjLCAmdmFsKTsNCj4gICAJaWYgKHJldCkgew0KPiAgIAkJ
ZGV2X2VycihkZXYsICJjYW4ndCBnZXQgY2hpcCBJRCAoJWQpXG4iLCByZXQpOw0KPiAgIAkJcmV0
dXJuIHJldDsNCj4gQEAgLTE3NDUsMTEgKzE3NDUsMTEgQEAgc3RhdGljIGludCBydGw4MzY2cmJf
ZGV0ZWN0KHN0cnVjdCByZWFsdGVrX3NtaSAqc21pKQ0KPiAgIAkJcmV0dXJuIC1FTk9ERVY7DQo+
ICAgCWNhc2UgMHg1OTM3Og0KPiAgIAkJZGV2X2luZm8oZGV2LCAiZm91bmQgYW4gUlRMODM2NlJC
IHN3aXRjaFxuIik7DQo+IC0JCXNtaS0+Y3B1X3BvcnQgPSBSVEw4MzY2UkJfUE9SVF9OVU1fQ1BV
Ow0KPiAtCQlzbWktPm51bV9wb3J0cyA9IFJUTDgzNjZSQl9OVU1fUE9SVFM7DQo+IC0JCXNtaS0+
bnVtX3ZsYW5fbWMgPSBSVEw4MzY2UkJfTlVNX1ZMQU5TOw0KPiAtCQlzbWktPm1pYl9jb3VudGVy
cyA9IHJ0bDgzNjZyYl9taWJfY291bnRlcnM7DQo+IC0JCXNtaS0+bnVtX21pYl9jb3VudGVycyA9
IEFSUkFZX1NJWkUocnRsODM2NnJiX21pYl9jb3VudGVycyk7DQo+ICsJCXByaXYtPmNwdV9wb3J0
ID0gUlRMODM2NlJCX1BPUlRfTlVNX0NQVTsNCj4gKwkJcHJpdi0+bnVtX3BvcnRzID0gUlRMODM2
NlJCX05VTV9QT1JUUzsNCj4gKwkJcHJpdi0+bnVtX3ZsYW5fbWMgPSBSVEw4MzY2UkJfTlVNX1ZM
QU5TOw0KPiArCQlwcml2LT5taWJfY291bnRlcnMgPSBydGw4MzY2cmJfbWliX2NvdW50ZXJzOw0K
PiArCQlwcml2LT5udW1fbWliX2NvdW50ZXJzID0gQVJSQVlfU0laRShydGw4MzY2cmJfbWliX2Nv
dW50ZXJzKTsNCj4gICAJCWJyZWFrOw0KPiAgIAlkZWZhdWx0Og0KPiAgIAkJZGV2X2luZm8oZGV2
LCAiZm91bmQgYW4gVW5rbm93biBSZWFsdGVrIHN3aXRjaCAoaWQ9MHglMDR4KVxuIiwNCj4gQEAg
LTE3NTcsNyArMTc1Nyw3IEBAIHN0YXRpYyBpbnQgcnRsODM2NnJiX2RldGVjdChzdHJ1Y3QgcmVh
bHRla19zbWkgKnNtaSkNCj4gICAJCWJyZWFrOw0KPiAgIAl9DQo+ICAgDQo+IC0JcmV0ID0gcnRs
ODM2NnJiX3Jlc2V0X2NoaXAoc21pKTsNCj4gKwlyZXQgPSBydGw4MzY2cmJfcmVzZXRfY2hpcChw
cml2KTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IEBAIC0xNzg3
LDcgKzE3ODcsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRzYV9zd2l0Y2hfb3BzIHJ0bDgzNjZy
Yl9zd2l0Y2hfb3BzID0gew0KPiAgIAkucG9ydF9tYXhfbXR1ID0gcnRsODM2NnJiX21heF9tdHUs
DQo+ICAgfTsNCj4gICANCj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgcmVhbHRla19zbWlfb3BzIHJ0
bDgzNjZyYl9zbWlfb3BzID0gew0KPiArc3RhdGljIGNvbnN0IHN0cnVjdCByZWFsdGVrX29wcyBy
dGw4MzY2cmJfb3BzID0gew0KPiAgIAkuZGV0ZWN0CQk9IHJ0bDgzNjZyYl9kZXRlY3QsDQo+ICAg
CS5nZXRfdmxhbl9tYwk9IHJ0bDgzNjZyYl9nZXRfdmxhbl9tYywNCj4gICAJLnNldF92bGFuX21j
CT0gcnRsODM2NnJiX3NldF92bGFuX21jLA0KPiBAQCAtMTgwMyw5ICsxODAzLDkgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCByZWFsdGVrX3NtaV9vcHMgcnRsODM2NnJiX3NtaV9vcHMgPSB7DQo+ICAg
CS5waHlfd3JpdGUJPSBydGw4MzY2cmJfcGh5X3dyaXRlLA0KPiAgIH07DQo+ICAgDQo+IC1jb25z
dCBzdHJ1Y3QgcmVhbHRla19zbWlfdmFyaWFudCBydGw4MzY2cmJfdmFyaWFudCA9IHsNCj4gK2Nv
bnN0IHN0cnVjdCByZWFsdGVrX3ZhcmlhbnQgcnRsODM2NnJiX3ZhcmlhbnQgPSB7DQo+ICAgCS5k
c19vcHMgPSAmcnRsODM2NnJiX3N3aXRjaF9vcHMsDQo+IC0JLm9wcyA9ICZydGw4MzY2cmJfc21p
X29wcywNCj4gKwkub3BzID0gJnJ0bDgzNjZyYl9vcHMsDQo+ICAgCS5jbGtfZGVsYXkgPSAxMCwN
Cj4gICAJLmNtZF9yZWFkID0gMHhhOSwNCj4gICAJLmNtZF93cml0ZSA9IDB4YTgsDQoNCg==
