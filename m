Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 352B51231AD
	for <lists+netdev@lfdr.de>; Tue, 17 Dec 2019 17:16:59 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728747AbfLQQQe (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Tue, 17 Dec 2019 11:16:34 -0500
Received: from mail-dm6nam12on2072.outbound.protection.outlook.com ([40.107.243.72]:33729
        "EHLO NAM12-DM6-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1728466AbfLQQQK (ORCPT <rfc822;netdev@vger.kernel.org>);
        Tue, 17 Dec 2019 11:16:10 -0500
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Cw8moinRmfBl4rIvr5wD/f+wKnvXjMtwzfRXftWaJuQRHBHOK2byJnzeMvv7AXcP+9N76S2tjSnV921k3niFYdJ1w9x+iQNo0HnkgwExZs0H70LFMRcGmxejO/PjpZtCoDZ/iH41olPxHULVQGi3brW5VYoj0pRlgPwhLRwj/sWikRHLcsSwnno2C1RoV2ca8v3/r5nWQDv82uiIgjyA3Ow7ydBPLbFjwws5oYOrawGZPEC0k8TuacJhkAGG5m62dKwbCALKMvYLL3b71zi3+9pjrLtNoIBjc5NgsM0JxgMwluHqljq3AlvugQzEAPiNryQYyLVv0MPkDjTlEunCLA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=abwaC/EprcvfAMIMK5YnQofxaQusI+LMGZvh/14CrDk=;
 b=HUg3/B/Jez9gNW+QWRRWj/XT9/GYLWDv1QolepVr3PvFbx3MzYAs/iJfe0GMATR3IIQdyzAw4Zoh0HPX0O0J0qoX9XGS5Gtx/rpAp4TgX/sWYt0YG6xU5bA1r/RLNM3QaLNYcyXVTt0Ltmp6XhKNA0N9xN+3Bqg5L2hsYnCwvdhAKCXsfY2EBT14TzMrqvMSg35fhjL9S0sxdgoIDi2/KKXUlFww7Shu5lxT+3DjUbm1P0byaHFvqGIlaBgD84Ymc536O/UxK6Ftqm0/LGueMt1rYn6oYPal+OFuym99VfbUoW0mo8whgSVn7FhaIFwMd8CTt+f1RLHql0q+Ocxh0g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=abwaC/EprcvfAMIMK5YnQofxaQusI+LMGZvh/14CrDk=;
 b=exMRO7/R725PSXgikY3Ua/9KMAo78ZiqYomyTM6m219NsrGN5uypbRZXUxsTS5VHGJ3/1rgph2EiktmiY0QGBsbPSWOfnxCItLhiAQDg4czaOYppizF1WlkKmiFqwhnuj0M8RewfR+0sNU9rOwfK1qRK6zT0WiFfVAm+vJvOrMU=
Received: from MN2PR11MB4063.namprd11.prod.outlook.com (10.255.180.22) by
 MN2PR11MB4477.namprd11.prod.outlook.com (52.135.36.93) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2538.17; Tue, 17 Dec 2019 16:16:01 +0000
Received: from MN2PR11MB4063.namprd11.prod.outlook.com
 ([fe80::f46c:e5b4:2a85:f0bf]) by MN2PR11MB4063.namprd11.prod.outlook.com
 ([fe80::f46c:e5b4:2a85:f0bf%4]) with mapi id 15.20.2538.019; Tue, 17 Dec 2019
 16:16:00 +0000
From:   =?utf-8?B?SsOpcsO0bWUgUG91aWxsZXI=?= <Jerome.Pouiller@silabs.com>
To:     "devel@driverdev.osuosl.org" <devel@driverdev.osuosl.org>,
        "linux-wireless@vger.kernel.org" <linux-wireless@vger.kernel.org>
CC:     "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Kalle Valo <kvalo@codeaurora.org>,
        "David S . Miller" <davem@davemloft.net>,
        =?utf-8?B?SsOpcsO0bWUgUG91aWxsZXI=?= <Jerome.Pouiller@silabs.com>
Subject: [PATCH v2 50/55] staging: wfx: rewrite wfx_hw_scan()
Thread-Topic: [PATCH v2 50/55] staging: wfx: rewrite wfx_hw_scan()
Thread-Index: AQHVtPU2YDzg5LD5lUmnp93AvrDBXg==
Date:   Tue, 17 Dec 2019 16:15:35 +0000
Message-ID: <20191217161318.31402-51-Jerome.Pouiller@silabs.com>
References: <20191217161318.31402-1-Jerome.Pouiller@silabs.com>
In-Reply-To: <20191217161318.31402-1-Jerome.Pouiller@silabs.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: PR0P264CA0174.FRAP264.PROD.OUTLOOK.COM
 (2603:10a6:100:1c::18) To MN2PR11MB4063.namprd11.prod.outlook.com
 (2603:10b6:208:13f::22)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=Jerome.Pouiller@silabs.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.24.0
x-originating-ip: [37.71.187.125]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: c928e248-e79d-41f5-7be7-08d7830c5959
x-ms-traffictypediagnostic: MN2PR11MB4477:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MN2PR11MB4477ECE1568B8819685D6E4C93500@MN2PR11MB4477.namprd11.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5236;
x-forefront-prvs: 02543CD7CD
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(376002)(346002)(396003)(136003)(366004)(39860400002)(199004)(189003)(1076003)(66574012)(186003)(107886003)(8676002)(30864003)(6506007)(86362001)(478600001)(85182001)(5660300002)(81156014)(26005)(4326008)(6486002)(8936002)(316002)(110136005)(54906003)(64756008)(66446008)(66946007)(2616005)(66556008)(66476007)(85202003)(36756003)(6512007)(2906002)(52116002)(6666004)(71200400001)(81166006);DIR:OUT;SFP:1101;SCL:1;SRVR:MN2PR11MB4477;H:MN2PR11MB4063.namprd11.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;A:1;MX:1;
received-spf: None (protection.outlook.com: silabs.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 0/Uj4GuW5hYQuFyjPq4L3AYJorDKvr1gOZ19LNxjQDMdlfjlUOj+6EuNzkhfhG/YL77KZTqNEVKpQ1C8VTJU4dKpF3/6ZsKYENEHk7eEKTMDZzswIxKhaRDOF+qtQzJiuV0vCkx8DXR1FwrSW0ul2FkYHd8o/ZrDpVcO1VRSJLTkFGGFizAD73oCvtX2R99pFEUOa9ARYJX3DgZlmyOOUWEBB4LnZ1k6ea4qqcPCq+4JSl7Cavqtn6VLiqOXEUKr81qYep21jwupdfNIqlzeZ7ny46ELqVu0lhviUGWAWv8HibISDB/gemeSkAK8MYH77JFsAwP06PpJdFQT1QKP1hRE8ZXgfEDPw7ReZRDOG8huVabI3X8KKDgkL5fX5JVeUiNhCN+PAAiM6kkC2h1ISVR9ddMnJBSYu6ZhxoRK++rSQeojpMVefhG9x2HlT9t/
Content-Type: text/plain; charset="utf-8"
Content-ID: <CAB1B1A4DDA47249830C0C5119212EF7@namprd11.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: c928e248-e79d-41f5-7be7-08d7830c5959
X-MS-Exchange-CrossTenant-originalarrivaltime: 17 Dec 2019 16:15:35.9796
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: UNSC6784cJbDyNIWK8YEfHtkr8ydgB2VXDGG9QCBG64lclOgs2pnZCGqWty5AII2YteYU/qQ6TrAX04Fuahs/g==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR11MB4477
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

RnJvbTogSsOpcsO0bWUgUG91aWxsZXIgPGplcm9tZS5wb3VpbGxlckBzaWxhYnMuY29tPgoKU2Nh
biByZXF1ZXN0cyBmcm9tIG1hYzgwMjExIG11c3QgYmUgc3BsaXR0ZWQgaW4gYSBmZXcgaGFyZHdh
cmUgcmVxdWVzdHMKKGl0IGlzIG5lY2Vzc2FyeSB0byBzcGxpdCBjaGFubmVscyB3aXRoIGFjdGl2
ZSBzY2FuIGFuZCBjaGFubmVscyB3aXRoCnBhc3NpdmUgc2NhbikuIEN1cnJlbnQgY29kZSBzY2hl
ZHVsZXMgYSB3b3JrX3N0cnVjdCBmb3IgZWFjaCBoYXJkd2FyZQpyZXF1ZXN0IGFuZCBvbmUgZGVs
YXllZF93b3JrIHRvIGhhbmRsZSBzY2FuIHRpbWVvdXQuCgpJdCBpcyBmYXIgc2ltcGxlciB0byBy
dW4gc2VuZCBhbGwgdGhlIGhhcmR3YXJlIHJlcXVlc3RzIHN5bmNocm9ub3VzbHkKYW5kIHJlcGxh
Y2UgZGVsYXllZF93b3JrIHdpdGggYSBzaW1wbGUgd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0
KCkuCgpTaWduZWQtb2ZmLWJ5OiBKw6lyw7RtZSBQb3VpbGxlciA8amVyb21lLnBvdWlsbGVyQHNp
bGFicy5jb20+Ci0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfcnguYyB8ICAgMiArLQogZHJp
dmVycy9zdGFnaW5nL3dmeC9zY2FuLmMgICB8IDIyNSArKysrKysrKysrLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQogZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmggICB8ICAyMyArLS0tCiBkcml2
ZXJzL3N0YWdpbmcvd2Z4L3N0YS5jICAgIHwgIDM5ICsrLS0tLQogZHJpdmVycy9zdGFnaW5nL3dm
eC93ZnguaCAgICB8ICAgNCArLQogNSBmaWxlcyBjaGFuZ2VkLCA4MSBpbnNlcnRpb25zKCspLCAy
MTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfcngu
YyBiL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3J4LmMKaW5kZXggOGEzY2NkYzYwYjdkLi40MDg5
NjdhNGM0NTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93ZngvaGlmX3J4LmMKKysrIGIv
ZHJpdmVycy9zdGFnaW5nL3dmeC9oaWZfcnguYwpAQCAtMjA2LDcgKzIwNiw3IEBAIHN0YXRpYyBp
bnQgaGlmX3NjYW5fY29tcGxldGVfaW5kaWNhdGlvbihzdHJ1Y3Qgd2Z4X2RldiAqd2RldiwKIAlj
b25zdCBzdHJ1Y3QgaGlmX2luZF9zY2FuX2NtcGwgKmJvZHkgPSBidWY7CiAKIAlXQVJOX09OKCF3
dmlmKTsKLQl3Znhfc2Nhbl9jb21wbGV0ZV9jYih3dmlmLCBib2R5KTsKKwl3Znhfc2Nhbl9jb21w
bGV0ZSh3dmlmLCBib2R5KTsKIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9z
dGFnaW5nL3dmeC9zY2FuLmMgYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3NjYW4uYwppbmRleCBjODJj
MDRmZjVkMDYuLmI3M2U2MWU4ZGE0NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9z
Y2FuLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmMKQEAgLTIyLDMzICsyMiw2IEBA
IHN0YXRpYyB2b2lkIF9faWVlZTgwMjExX3NjYW5fY29tcGxldGVkX2NvbXBhdChzdHJ1Y3QgaWVl
ZTgwMjExX2h3ICpodywKIAlpZWVlODAyMTFfc2Nhbl9jb21wbGV0ZWQoaHcsICZpbmZvKTsKIH0K
IAotc3RhdGljIHZvaWQgd2Z4X3NjYW5fcmVzdGFydF9kZWxheWVkKHN0cnVjdCB3ZnhfdmlmICp3
dmlmKQotewotCWlmICh3dmlmLT5kZWxheWVkX3Vuam9pbikgewotCQl3dmlmLT5kZWxheWVkX3Vu
am9pbiA9IGZhbHNlOwotCQlpZiAoIXNjaGVkdWxlX3dvcmsoJnd2aWYtPnVuam9pbl93b3JrKSkK
LQkJCXdmeF90eF91bmxvY2sod3ZpZi0+d2Rldik7Ci0JfSBlbHNlIGlmICh3dmlmLT5kZWxheWVk
X2xpbmtfbG9zcykgewotCQl3dmlmLT5kZWxheWVkX2xpbmtfbG9zcyA9IDA7Ci0JCXdmeF9jcW1f
YnNzbG9zc19zbSh3dmlmLCAxLCAwLCAwKTsKLQl9Ci19Ci0KLXN0YXRpYyBpbnQgd2Z4X3NjYW5f
c3RhcnQoc3RydWN0IHdmeF92aWYgKnd2aWYsCi0JCQkgIGludCBjaGFuX3N0YXJ0X2lkeCwgaW50
IGNoYW5fbnVtKQotewotCWludCB0bW87Ci0KLQlpZiAod3ZpZi0+c3RhdGUgPT0gV0ZYX1NUQVRF
X1BSRV9TVEEpCi0JCXJldHVybiAtRUJVU1k7Ci0KLQlhdG9taWNfc2V0KCZ3dmlmLT5zY2FuLmlu
X3Byb2dyZXNzLCAxKTsKLQotCXRtbyA9IGhpZl9zY2FuKHd2aWYsIHd2aWYtPnNjYW4ucmVxLCBj
aGFuX3N0YXJ0X2lkeCwgY2hhbl9udW0pOwotCXNjaGVkdWxlX2RlbGF5ZWRfd29yaygmd3ZpZi0+
c2Nhbi50aW1lb3V0LCB0bW8pOwotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IHVwZGF0ZV9w
cm9iZV90bXBsKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAogCQkJICAgICBzdHJ1Y3QgY2ZnODAyMTFf
c2Nhbl9yZXF1ZXN0ICpyZXEpCiB7CkBAIC02NSwxNTMgKzM4LDgxIEBAIHN0YXRpYyBpbnQgdXBk
YXRlX3Byb2JlX3RtcGwoc3RydWN0IHdmeF92aWYgKnd2aWYsCiAJcmV0dXJuIDA7CiB9CiAKLWlu
dCB3ZnhfaHdfc2NhbihzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywKLQkJICAgc3RydWN0IGllZWU4
MDIxMV92aWYgKnZpZiwKLQkJICAgc3RydWN0IGllZWU4MDIxMV9zY2FuX3JlcXVlc3QgKmh3X3Jl
cSkKK3N0YXRpYyBpbnQgc2VuZF9zY2FuX3JlcShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJCSBz
dHJ1Y3QgY2ZnODAyMTFfc2Nhbl9yZXF1ZXN0ICpyZXEsIGludCBzdGFydF9pZHgpCit7CisJaW50
IGksIHJldCwgdGltZW91dDsKKwlzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKmNoX3N0YXJ0LCAq
Y2hfY3VyOworCisJZm9yIChpID0gc3RhcnRfaWR4OyBpIDwgcmVxLT5uX2NoYW5uZWxzOyBpKysp
IHsKKwkJY2hfc3RhcnQgPSByZXEtPmNoYW5uZWxzW3N0YXJ0X2lkeF07CisJCWNoX2N1ciA9IHJl
cS0+Y2hhbm5lbHNbaV07CisJCVdBUk4oY2hfY3VyLT5iYW5kICE9IE5MODAyMTFfQkFORF8yR0ha
LCAiYmFuZCBub3Qgc3VwcG9ydGVkIik7CisJCWlmIChjaF9jdXItPm1heF9wb3dlciAhPSBjaF9z
dGFydC0+bWF4X3Bvd2VyKQorCQkJYnJlYWs7CisJCWlmICgoY2hfY3VyLT5mbGFncyBeIGNoX3N0
YXJ0LT5mbGFncykgJiBJRUVFODAyMTFfQ0hBTl9OT19JUikKKwkJCWJyZWFrOworCX0KKwl3Znhf
dHhfbG9ja19mbHVzaCh3dmlmLT53ZGV2KTsKKwlyZWluaXRfY29tcGxldGlvbigmd3ZpZi0+c2Nh
bl9jb21wbGV0ZSk7CisJcmV0ID0gaGlmX3NjYW4od3ZpZiwgcmVxLCBzdGFydF9pZHgsIGkgLSBz
dGFydF9pZHgpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCXRpbWVvdXQgPSByZXQ7
CisJcmV0ID0gd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZ3dmlmLT5zY2FuX2NvbXBsZXRl
LCB0aW1lb3V0KTsKKwlpZiAocmVxLT5jaGFubmVsc1tzdGFydF9pZHhdLT5tYXhfcG93ZXIgIT0g
d3ZpZi0+d2Rldi0+b3V0cHV0X3Bvd2VyKQorCQloaWZfc2V0X291dHB1dF9wb3dlcih3dmlmLCB3
dmlmLT53ZGV2LT5vdXRwdXRfcG93ZXIgKiAxMCk7CisJd2Z4X3R4X3VubG9jayh3dmlmLT53ZGV2
KTsKKwlpZiAoIXJldCkgeworCQlkZXZfbm90aWNlKHd2aWYtPndkZXYtPmRldiwgInNjYW4gdGlt
ZW91dFxuIik7CisJCWhpZl9zdG9wX3NjYW4od3ZpZik7CisJCXJldHVybiAtRVRJTUVET1VUOwor
CX0KKwlyZXR1cm4gaSAtIHN0YXJ0X2lkeDsKK30KKworaW50IHdmeF9od19zY2FuKHN0cnVjdCBp
ZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLAorCQlzdHJ1Y3QgaWVl
ZTgwMjExX3NjYW5fcmVxdWVzdCAqaHdfcmVxKQogewogCXN0cnVjdCB3ZnhfZGV2ICp3ZGV2ID0g
aHctPnByaXY7CiAJc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKikgdmlm
LT5kcnZfcHJpdjsKLQlzdHJ1Y3QgY2ZnODAyMTFfc2Nhbl9yZXF1ZXN0ICpyZXEgPSAmaHdfcmVx
LT5yZXE7Ci0JaW50IGksIHJldDsKKwlpbnQgY2hhbl9jdXIsIHJldDsKIAotCWlmICghd3ZpZikK
LQkJcmV0dXJuIC1FSU5WQUw7CisJV0FSTl9PTihod19yZXEtPnJlcS5uX2NoYW5uZWxzID4gSElG
X0FQSV9NQVhfTkJfQ0hBTk5FTFMpOwogCi0JaWYgKHd2aWYtPnN0YXRlID09IFdGWF9TVEFURV9B
UCkKKwlpZiAodmlmLT50eXBlID09IE5MODAyMTFfSUZUWVBFX0FQKQogCQlyZXR1cm4gLUVPUE5P
VFNVUFA7CiAKLQlpZiAocmVxLT5uX3NzaWRzID09IDEgJiYgIXJlcS0+c3NpZHNbMF0uc3NpZF9s
ZW4pCi0JCXJlcS0+bl9zc2lkcyA9IDA7Ci0KLQlpZiAocmVxLT5uX3NzaWRzID4gSElGX0FQSV9N
QVhfTkJfU1NJRFMpCi0JCXJldHVybiAtRUlOVkFMOworCWlmICh3dmlmLT5zdGF0ZSA9PSBXRlhf
U1RBVEVfUFJFX1NUQSkKKwkJcmV0dXJuIC1FQlVTWTsKIAorCW11dGV4X2xvY2soJnd2aWYtPnNj
YW5fbG9jayk7CiAJbXV0ZXhfbG9jaygmd2Rldi0+Y29uZl9tdXRleCk7Ci0KLQlyZXQgPSB1cGRh
dGVfcHJvYmVfdG1wbCh3dmlmLCByZXEpOwotCWlmIChyZXQpCi0JCWdvdG8gZmFpbGVkOwotCi0J
cmV0ID0gd2Z4X2Z3ZF9wcm9iZV9yZXEod3ZpZiwgdHJ1ZSk7Ci0JaWYgKHJldCkKLQkJZ290byBm
YWlsZWQ7Ci0KLQl3ZnhfdHhfbG9ja19mbHVzaCh3ZGV2KTsKLQotCVdBUk4od3ZpZi0+c2Nhbi5y
ZXEsICJ1bmV4cGVjdGVkIGNvbmN1cnJlbnQgc2NhbiIpOwotCXd2aWYtPnNjYW4ucmVxID0gcmVx
OwotCXd2aWYtPnNjYW4ubl9zc2lkcyA9IDA7Ci0Jd3ZpZi0+c2Nhbi5zdGF0dXMgPSAwOwotCXd2
aWYtPnNjYW4uYmVnaW4gPSAmcmVxLT5jaGFubmVsc1swXTsKLQl3dmlmLT5zY2FuLmN1cnIgPSB3
dmlmLT5zY2FuLmJlZ2luOwotCXd2aWYtPnNjYW4uZW5kID0gJnJlcS0+Y2hhbm5lbHNbcmVxLT5u
X2NoYW5uZWxzXTsKLQl3dmlmLT5zY2FuLm91dHB1dF9wb3dlciA9IHdkZXYtPm91dHB1dF9wb3dl
cjsKLQotCWZvciAoaSA9IDA7IGkgPCByZXEtPm5fc3NpZHM7ICsraSkgewotCQlzdHJ1Y3QgaGlm
X3NzaWRfZGVmICpkc3QgPSAmd3ZpZi0+c2Nhbi5zc2lkc1t3dmlmLT5zY2FuLm5fc3NpZHNdOwot
Ci0JCW1lbWNweSgmZHN0LT5zc2lkWzBdLCByZXEtPnNzaWRzW2ldLnNzaWQsIHNpemVvZihkc3Qt
PnNzaWQpKTsKLQkJZHN0LT5zc2lkX2xlbmd0aCA9IHJlcS0+c3NpZHNbaV0uc3NpZF9sZW47Ci0J
CSsrd3ZpZi0+c2Nhbi5uX3NzaWRzOwotCX0KLQlzY2hlZHVsZV93b3JrKCZ3dmlmLT5zY2FuLndv
cmspOwotCi1mYWlsZWQ6CisJdXBkYXRlX3Byb2JlX3RtcGwod3ZpZiwgJmh3X3JlcS0+cmVxKTsK
Kwl3ZnhfZndkX3Byb2JlX3JlcSh3dmlmLCB0cnVlKTsKKwljaGFuX2N1ciA9IDA7CisJZG8gewor
CQlyZXQgPSBzZW5kX3NjYW5fcmVxKHd2aWYsICZod19yZXEtPnJlcSwgY2hhbl9jdXIpOworCQlp
ZiAocmV0ID4gMCkKKwkJCWNoYW5fY3VyICs9IHJldDsKKwl9IHdoaWxlIChyZXQgPiAwICYmIGNo
YW5fY3VyIDwgaHdfcmVxLT5yZXEubl9jaGFubmVscyk7CisJX19pZWVlODAyMTFfc2Nhbl9jb21w
bGV0ZWRfY29tcGF0KGh3LCByZXQgPCAwKTsKIAltdXRleF91bmxvY2soJndkZXYtPmNvbmZfbXV0
ZXgpOwotCXJldHVybiByZXQ7Ci19Ci0KLXZvaWQgd2Z4X3NjYW5fd29yayhzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKndvcmspCi17Ci0Jc3RydWN0IHdmeF92aWYgKnd2aWYgPSBjb250YWluZXJfb2Yod29y
aywgc3RydWN0IHdmeF92aWYsIHNjYW4ud29yayk7Ci0Jc3RydWN0IGllZWU4MDIxMV9jaGFubmVs
ICoqaXQ7Ci0Jc3RydWN0IGllZWU4MDIxMV9jaGFubmVsICpmaXJzdDsKLQlpbnQgaTsKLQotCWRv
d24oJnd2aWYtPnNjYW4ubG9jayk7Ci0JbXV0ZXhfbG9jaygmd3ZpZi0+d2Rldi0+Y29uZl9tdXRl
eCk7Ci0KLQotCWlmICghd3ZpZi0+c2Nhbi5yZXEgfHwgd3ZpZi0+c2Nhbi5jdXJyID09IHd2aWYt
PnNjYW4uZW5kKSB7Ci0JCWlmICh3dmlmLT5zY2FuLm91dHB1dF9wb3dlciAhPSB3dmlmLT53ZGV2
LT5vdXRwdXRfcG93ZXIpCi0JCQloaWZfc2V0X291dHB1dF9wb3dlcih3dmlmLAotCQkJCQkgICAg
IHd2aWYtPndkZXYtPm91dHB1dF9wb3dlciAqIDEwKTsKLQotCQlpZiAod3ZpZi0+c2Nhbi5zdGF0
dXMgPCAwKQotCQkJZGV2X3dhcm4od3ZpZi0+d2Rldi0+ZGV2LCAic2NhbiBmYWlsZWRcbiIpOwot
CQllbHNlIGlmICh3dmlmLT5zY2FuLnJlcSkKLQkJCWRldl9kYmcod3ZpZi0+d2Rldi0+ZGV2LCAi
c2NhbiBjb21wbGV0ZWRcbiIpOwotCQllbHNlCi0JCQlkZXZfZGJnKHd2aWYtPndkZXYtPmRldiwg
InNjYW4gY2FuY2VsZWRcbiIpOwotCi0JCXd2aWYtPnNjYW4ucmVxID0gTlVMTDsKLQkJd2Z4X3Nj
YW5fcmVzdGFydF9kZWxheWVkKHd2aWYpOwotCQl3ZnhfdHhfdW5sb2NrKHd2aWYtPndkZXYpOwot
CQltdXRleF91bmxvY2soJnd2aWYtPndkZXYtPmNvbmZfbXV0ZXgpOwotCQlfX2llZWU4MDIxMV9z
Y2FuX2NvbXBsZXRlZF9jb21wYXQod3ZpZi0+d2Rldi0+aHcsCi0JCQkJCQkgIHd2aWYtPnNjYW4u
c3RhdHVzID8gMSA6IDApOwotCQl1cCgmd3ZpZi0+c2Nhbi5sb2NrKTsKLQkJcmV0dXJuOwotCX0K
LQlmaXJzdCA9ICp3dmlmLT5zY2FuLmN1cnI7Ci0KLQlmb3IgKGl0ID0gd3ZpZi0+c2Nhbi5jdXJy
ICsgMSwgaSA9IDE7Ci0JICAgICBpdCAhPSB3dmlmLT5zY2FuLmVuZCAmJiBpIDwgSElGX0FQSV9N
QVhfTkJfQ0hBTk5FTFM7Ci0JICAgICArK2l0LCArK2kpIHsKLQkJaWYgKCgqaXQpLT5iYW5kICE9
IGZpcnN0LT5iYW5kKQotCQkJYnJlYWs7Ci0JCWlmICgoKCppdCktPmZsYWdzIF4gZmlyc3QtPmZs
YWdzKSAmCi0JCQkJSUVFRTgwMjExX0NIQU5fTk9fSVIpCi0JCQlicmVhazsKLQkJaWYgKCEoZmly
c3QtPmZsYWdzICYgSUVFRTgwMjExX0NIQU5fTk9fSVIpICYmCi0JCSAgICAoKml0KS0+bWF4X3Bv
d2VyICE9IGZpcnN0LT5tYXhfcG93ZXIpCi0JCQlicmVhazsKLQl9Ci0JaWYgKCEoZmlyc3QtPmZs
YWdzICYgSUVFRTgwMjExX0NIQU5fTk9fSVIpICYmCi0JICAgIHd2aWYtPnNjYW4ub3V0cHV0X3Bv
d2VyICE9IGZpcnN0LT5tYXhfcG93ZXIpIHsKLQkJd3ZpZi0+c2Nhbi5vdXRwdXRfcG93ZXIgPSBm
aXJzdC0+bWF4X3Bvd2VyOwotCQloaWZfc2V0X291dHB1dF9wb3dlcih3dmlmLCB3dmlmLT5zY2Fu
Lm91dHB1dF9wb3dlciAqIDEwKTsKLQl9Ci0Jd3ZpZi0+c2Nhbi5zdGF0dXMgPSB3Znhfc2Nhbl9z
dGFydCh3dmlmLAotCQkJCQkgICB3dmlmLT5zY2FuLmN1cnIgLSB3dmlmLT5zY2FuLmJlZ2luLAot
CQkJCQkgICBpdCAtIHd2aWYtPnNjYW4uY3Vycik7Ci0JaWYgKHd2aWYtPnNjYW4uc3RhdHVzKQot
CQlnb3RvIGZhaWw7Ci0Jd3ZpZi0+c2Nhbi5jdXJyID0gaXQ7Ci0JbXV0ZXhfdW5sb2NrKCZ3dmlm
LT53ZGV2LT5jb25mX211dGV4KTsKLQlyZXR1cm47Ci0KLWZhaWw6Ci0Jd3ZpZi0+c2Nhbi5jdXJy
ID0gd3ZpZi0+c2Nhbi5lbmQ7Ci0JbXV0ZXhfdW5sb2NrKCZ3dmlmLT53ZGV2LT5jb25mX211dGV4
KTsKLQl1cCgmd3ZpZi0+c2Nhbi5sb2NrKTsKLQlzY2hlZHVsZV93b3JrKCZ3dmlmLT5zY2FuLndv
cmspOwotfQotCi12b2lkIHdmeF9zY2FuX2NvbXBsZXRlX2NiKHN0cnVjdCB3ZnhfdmlmICp3dmlm
LAotCQkJICBjb25zdCBzdHJ1Y3QgaGlmX2luZF9zY2FuX2NtcGwgKmFyZykKLXsKLQlpZiAoY2Fu
Y2VsX2RlbGF5ZWRfd29ya19zeW5jKCZ3dmlmLT5zY2FuLnRpbWVvdXQpID4gMCkgewotCQl3dmlm
LT5zY2FuLnN0YXR1cyA9IDE7Ci0JCXNjaGVkdWxlX3dvcmsoJnd2aWYtPnNjYW4udGltZW91dC53
b3JrKTsKKwltdXRleF91bmxvY2soJnd2aWYtPnNjYW5fbG9jayk7CisJaWYgKHd2aWYtPmRlbGF5
ZWRfdW5qb2luKSB7CisJCXd2aWYtPmRlbGF5ZWRfdW5qb2luID0gZmFsc2U7CisJCXdmeF90eF9s
b2NrKHdkZXYpOworCQlpZiAoIXNjaGVkdWxlX3dvcmsoJnd2aWYtPnVuam9pbl93b3JrKSkKKwkJ
CXdmeF90eF91bmxvY2sod2Rldik7CisJfSBlbHNlIGlmICh3dmlmLT5kZWxheWVkX2xpbmtfbG9z
cykgeworCQl3dmlmLT5kZWxheWVkX2xpbmtfbG9zcyA9IGZhbHNlOworCQl3ZnhfY3FtX2Jzc2xv
c3Nfc20od3ZpZiwgMSwgMCwgMCk7CiAJfQorCXJldHVybiAwOwogfQogCi12b2lkIHdmeF9zY2Fu
X3RpbWVvdXQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQordm9pZCB3Znhfc2Nhbl9jb21wbGV0
ZShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKKwkJICAgICAgIGNvbnN0IHN0cnVjdCBoaWZfaW5kX3Nj
YW5fY21wbCAqYXJnKQogewotCXN0cnVjdCB3ZnhfdmlmICp3dmlmID0gY29udGFpbmVyX29mKHdv
cmssIHN0cnVjdCB3ZnhfdmlmLAotCQkJCQkgICAgc2Nhbi50aW1lb3V0LndvcmspOwotCi0JaWYg
KGF0b21pY194Y2hnKCZ3dmlmLT5zY2FuLmluX3Byb2dyZXNzLCAwKSkgewotCQlpZiAod3ZpZi0+
c2Nhbi5zdGF0dXMgPiAwKSB7Ci0JCQl3dmlmLT5zY2FuLnN0YXR1cyA9IDA7Ci0JCX0gZWxzZSBp
ZiAoIXd2aWYtPnNjYW4uc3RhdHVzKSB7Ci0JCQlkZXZfd2Fybih3dmlmLT53ZGV2LT5kZXYsICJ0
aW1lb3V0IHdhaXRpbmcgZm9yIHNjYW4gY29tcGxldGUgbm90aWZpY2F0aW9uXG4iKTsKLQkJCXd2
aWYtPnNjYW4uc3RhdHVzID0gLUVUSU1FRE9VVDsKLQkJCXd2aWYtPnNjYW4uY3VyciA9IHd2aWYt
PnNjYW4uZW5kOwotCQkJaGlmX3N0b3Bfc2Nhbih3dmlmKTsKLQkJfQotCQl1cCgmd3ZpZi0+c2Nh
bi5sb2NrKTsKLQkJd2Z4X3NjYW5fd29yaygmd3ZpZi0+c2Nhbi53b3JrKTsKLQl9CisJY29tcGxl
dGUoJnd2aWYtPnNjYW5fY29tcGxldGUpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5n
L3dmeC9zY2FuLmggYi9kcml2ZXJzL3N0YWdpbmcvd2Z4L3NjYW4uaAppbmRleCBlNzFlNWYwZjUy
MmUuLjAzYmM2YzdlNTYyZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmgK
KysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC9zY2FuLmgKQEAgLTgsOCArOCw2IEBACiAjaWZuZGVm
IFdGWF9TQ0FOX0gKICNkZWZpbmUgV0ZYX1NDQU5fSAogCi0jaW5jbHVkZSA8bGludXgvc2VtYXBo
b3JlLmg+Ci0jaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+CiAjaW5jbHVkZSA8bmV0L21hYzgw
MjExLmg+CiAKICNpbmNsdWRlICJoaWZfYXBpX2NtZC5oIgpAQCAtMTcsMjYgKzE1LDkgQEAKIHN0
cnVjdCB3ZnhfZGV2Owogc3RydWN0IHdmeF92aWY7CiAKLXN0cnVjdCB3Znhfc2NhbiB7Ci0Jc3Ry
dWN0IHNlbWFwaG9yZSBsb2NrOwotCXN0cnVjdCB3b3JrX3N0cnVjdCB3b3JrOwotCXN0cnVjdCBk
ZWxheWVkX3dvcmsgdGltZW91dDsKLQlzdHJ1Y3QgY2ZnODAyMTFfc2Nhbl9yZXF1ZXN0ICpyZXE7
Ci0Jc3RydWN0IGllZWU4MDIxMV9jaGFubmVsICoqYmVnaW47Ci0Jc3RydWN0IGllZWU4MDIxMV9j
aGFubmVsICoqY3VycjsKLQlzdHJ1Y3QgaWVlZTgwMjExX2NoYW5uZWwgKiplbmQ7Ci0Jc3RydWN0
IGhpZl9zc2lkX2RlZiBzc2lkc1tISUZfQVBJX01BWF9OQl9TU0lEU107Ci0JaW50IG91dHB1dF9w
b3dlcjsKLQlpbnQgbl9zc2lkczsKLQlpbnQgc3RhdHVzOwotCWF0b21pY190IGluX3Byb2dyZXNz
OwotfTsKLQogaW50IHdmeF9od19zY2FuKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBzdHJ1Y3Qg
aWVlZTgwMjExX3ZpZiAqdmlmLAogCQlzdHJ1Y3QgaWVlZTgwMjExX3NjYW5fcmVxdWVzdCAqcmVx
KTsKLXZvaWQgd2Z4X3NjYW5fd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspOwotdm9pZCB3
Znhfc2Nhbl90aW1lb3V0KHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yayk7Ci12b2lkIHdmeF9zY2Fu
X2NvbXBsZXRlX2NiKHN0cnVjdCB3ZnhfdmlmICp3dmlmLAotCQkJICBjb25zdCBzdHJ1Y3QgaGlm
X2luZF9zY2FuX2NtcGwgKmFyZyk7Cit2b2lkIHdmeF9zY2FuX2NvbXBsZXRlKHN0cnVjdCB3Znhf
dmlmICp3dmlmLAorCQkgICAgICAgY29uc3Qgc3RydWN0IGhpZl9pbmRfc2Nhbl9jbXBsICppbmQp
OwogCiAjZW5kaWYgLyogV0ZYX1NDQU5fSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5n
L3dmeC9zdGEuYyBiL2RyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMKaW5kZXggYmEzZTgxZmQ0Nzdi
Li4xNmY1ZGI4NzMyNzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93Zngvc3RhLmMKKysr
IGIvZHJpdmVycy9zdGFnaW5nL3dmeC9zdGEuYwpAQCAtMjc3LDEzICsyNzcsMTMgQEAgdm9pZCB3
ZnhfY29uZmlndXJlX2ZpbHRlcihzdHJ1Y3QgaWVlZTgwMjExX2h3ICpodywKIAkqdG90YWxfZmxh
Z3MgJj0gRklGX09USEVSX0JTUyB8IEZJRl9GQ1NGQUlMIHwgRklGX1BST0JFX1JFUTsKIAogCXdo
aWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgewotCQlkb3du
KCZ3dmlmLT5zY2FuLmxvY2spOworCQltdXRleF9sb2NrKCZ3dmlmLT5zY2FuX2xvY2spOwogCQl3
dmlmLT5maWx0ZXJfYnNzaWQgPSAoKnRvdGFsX2ZsYWdzICYKIAkJCQkgICAgICAoRklGX09USEVS
X0JTUyB8IEZJRl9QUk9CRV9SRVEpKSA/IDAgOiAxOwogCQl3dmlmLT5kaXNhYmxlX2JlYWNvbl9m
aWx0ZXIgPSAhKCp0b3RhbF9mbGFncyAmIEZJRl9QUk9CRV9SRVEpOwogCQl3ZnhfZndkX3Byb2Jl
X3JlcSh3dmlmLCB0cnVlKTsKIAkJd2Z4X3VwZGF0ZV9maWx0ZXJpbmcod3ZpZik7Ci0JCXVwKCZ3
dmlmLT5zY2FuLmxvY2spOworCQltdXRleF91bmxvY2soJnd2aWYtPnNjYW5fbG9jayk7CiAJfQog
fQogCkBAIC00MzMsOSArNDMzLDkgQEAgc3RhdGljIHZvaWQgd2Z4X2V2ZW50X2hhbmRsZXJfd29y
ayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJCXN3aXRjaCAoZXZlbnQtPmV2dC5ldmVudF9p
ZCkgewogCQljYXNlIEhJRl9FVkVOVF9JTkRfQlNTTE9TVDoKIAkJCWNhbmNlbF93b3JrX3N5bmMo
Jnd2aWYtPnVuam9pbl93b3JrKTsKLQkJCWlmICghZG93bl90cnlsb2NrKCZ3dmlmLT5zY2FuLmxv
Y2spKSB7CisJCQlpZiAobXV0ZXhfdHJ5bG9jaygmd3ZpZi0+c2Nhbl9sb2NrKSkgewogCQkJCXdm
eF9jcW1fYnNzbG9zc19zbSh3dmlmLCAxLCAwLCAwKTsKLQkJCQl1cCgmd3ZpZi0+c2Nhbi5sb2Nr
KTsKKwkJCQltdXRleF91bmxvY2soJnd2aWYtPnNjYW5fbG9jayk7CiAJCQl9IGVsc2UgewogCQkJ
CS8qIFNjYW4gaXMgaW4gcHJvZ3Jlc3MuIERlbGF5IHJlcG9ydGluZy4KIAkJCQkgKiBTY2FuIGNv
bXBsZXRlIHdpbGwgdHJpZ2dlciBic3NfbG9zc193b3JrCkBAIC01MDEsNyArNTAxLDcgQEAgc3Rh
dGljIHZvaWQgd2Z4X2RvX3Vuam9pbihzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZikKIHsKIAltdXRleF9s
b2NrKCZ3dmlmLT53ZGV2LT5jb25mX211dGV4KTsKIAotCWlmIChhdG9taWNfcmVhZCgmd3ZpZi0+
c2Nhbi5pbl9wcm9ncmVzcykpIHsKKwlpZiAoIW11dGV4X3RyeWxvY2soJnd2aWYtPnNjYW5fbG9j
aykpIHsKIAkJaWYgKHd2aWYtPmRlbGF5ZWRfdW5qb2luKQogCQkJZGV2X2RiZyh3dmlmLT53ZGV2
LT5kZXYsCiAJCQkJImRlbGF5ZWQgdW5qb2luIGlzIGFscmVhZHkgc2NoZWR1bGVkXG4iKTsKQEAg
LTUwOSw2ICs1MDksNyBAQCBzdGF0aWMgdm9pZCB3ZnhfZG9fdW5qb2luKHN0cnVjdCB3Znhfdmlm
ICp3dmlmKQogCQkJd3ZpZi0+ZGVsYXllZF91bmpvaW4gPSB0cnVlOwogCQlnb3RvIGRvbmU7CiAJ
fQorCW11dGV4X3VubG9jaygmd3ZpZi0+c2Nhbl9sb2NrKTsKIAogCXd2aWYtPmRlbGF5ZWRfbGlu
a19sb3NzID0gZmFsc2U7CiAKQEAgLTYxMywxNCArNjE0LDYgQEAgc3RhdGljIHZvaWQgd2Z4X2Rv
X2pvaW4oc3RydWN0IHdmeF92aWYgKnd2aWYpCiAKIAltdXRleF9sb2NrKCZ3dmlmLT53ZGV2LT5j
b25mX211dGV4KTsKIAotCS8qIFVuZGVyIHRoZSBjb25mIGxvY2s6IGNoZWNrIHNjYW4gc3RhdHVz
IGFuZAotCSAqIGJhaWwgb3V0IGlmIGl0IGlzIGluIHByb2dyZXNzLgotCSAqLwotCWlmIChhdG9t
aWNfcmVhZCgmd3ZpZi0+c2Nhbi5pbl9wcm9ncmVzcykpIHsKLQkJd2Z4X3R4X3VubG9jayh3dmlm
LT53ZGV2KTsKLQkJZ290byBkb25lX3B1dDsKLQl9Ci0KIAkvKiBTYW5pdHkgY2hlY2sgYmFzaWMg
cmF0ZXMgKi8KIAlpZiAoIWpvaW4uYmFzaWNfcmF0ZV9zZXQpCiAJCWpvaW4uYmFzaWNfcmF0ZV9z
ZXQgPSA3OwpAQCAtNjg0LDcgKzY3Nyw2IEBAIHN0YXRpYyB2b2lkIHdmeF9kb19qb2luKHN0cnVj
dCB3ZnhfdmlmICp3dmlmKQogCX0KIAl3ZnhfdXBkYXRlX2ZpbHRlcmluZyh3dmlmKTsKIAotZG9u
ZV9wdXQ6CiAJbXV0ZXhfdW5sb2NrKCZ3dmlmLT53ZGV2LT5jb25mX211dGV4KTsKIAlpZiAoYnNz
KQogCQljZmc4MDIxMV9wdXRfYnNzKHd2aWYtPndkZXYtPmh3LT53aXBoeSwgYnNzKTsKQEAgLTEz
NDYsNyArMTMzOCw3IEBAIGludCB3ZnhfY29uZmlnKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCB1
MzIgY2hhbmdlZCkKIAkJcmV0dXJuIDA7CiAJfQogCi0JZG93bigmd3ZpZi0+c2Nhbi5sb2NrKTsK
KwltdXRleF9sb2NrKCZ3dmlmLT5zY2FuX2xvY2spOwogCW11dGV4X2xvY2soJndkZXYtPmNvbmZf
bXV0ZXgpOwogCWlmIChjaGFuZ2VkICYgSUVFRTgwMjExX0NPTkZfQ0hBTkdFX1BPV0VSKSB7CiAJ
CXdkZXYtPm91dHB1dF9wb3dlciA9IGNvbmYtPnBvd2VyX2xldmVsOwpAQCAtMTM2MSw3ICsxMzUz
LDcgQEAgaW50IHdmeF9jb25maWcoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHUzMiBjaGFuZ2Vk
KQogCX0KIAogCW11dGV4X3VubG9jaygmd2Rldi0+Y29uZl9tdXRleCk7Ci0JdXAoJnd2aWYtPnNj
YW4ubG9jayk7CisJbXV0ZXhfdW5sb2NrKCZ3dmlmLT5zY2FuX2xvY2spOwogCXJldHVybiByZXQ7
CiB9CiAKQEAgLTE0MTksMTAgKzE0MTEsNiBAQCBpbnQgd2Z4X2FkZF9pbnRlcmZhY2Uoc3RydWN0
IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYpCiAJd3ZpZi0+d2Vw
X2RlZmF1bHRfa2V5X2lkID0gLTE7CiAJSU5JVF9XT1JLKCZ3dmlmLT53ZXBfa2V5X3dvcmssIHdm
eF93ZXBfa2V5X3dvcmspOwogCi0Jc2VtYV9pbml0KCZ3dmlmLT5zY2FuLmxvY2ssIDEpOwotCUlO
SVRfV09SSygmd3ZpZi0+c2Nhbi53b3JrLCB3Znhfc2Nhbl93b3JrKTsKLQlJTklUX0RFTEFZRURf
V09SSygmd3ZpZi0+c2Nhbi50aW1lb3V0LCB3Znhfc2Nhbl90aW1lb3V0KTsKLQogCXNwaW5fbG9j
a19pbml0KCZ3dmlmLT5ldmVudF9xdWV1ZV9sb2NrKTsKIAlJTklUX0xJU1RfSEVBRCgmd3ZpZi0+
ZXZlbnRfcXVldWUpOwogCUlOSVRfV09SSygmd3ZpZi0+ZXZlbnRfaGFuZGxlcl93b3JrLCB3Znhf
ZXZlbnRfaGFuZGxlcl93b3JrKTsKQEAgLTE0MzUsOCArMTQyMywxMSBAQCBpbnQgd2Z4X2FkZF9p
bnRlcmZhY2Uoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2
aWYpCiAJSU5JVF9XT1JLKCZ3dmlmLT5ic3NfcGFyYW1zX3dvcmssIHdmeF9ic3NfcGFyYW1zX3dv
cmspOwogCUlOSVRfV09SSygmd3ZpZi0+c2V0X2N0c193b3JrLCB3Znhfc2V0X2N0c193b3JrKTsK
IAlJTklUX1dPUksoJnd2aWYtPnVuam9pbl93b3JrLCB3ZnhfdW5qb2luX3dvcmspOwotCiAJSU5J
VF9XT1JLKCZ3dmlmLT50eF9wb2xpY3lfdXBsb2FkX3dvcmssIHdmeF90eF9wb2xpY3lfdXBsb2Fk
X3dvcmspOworCisJbXV0ZXhfaW5pdCgmd3ZpZi0+c2Nhbl9sb2NrKTsKKwlpbml0X2NvbXBsZXRp
b24oJnd2aWYtPnNjYW5fY29tcGxldGUpOworCiAJbXV0ZXhfdW5sb2NrKCZ3ZGV2LT5jb25mX211
dGV4KTsKIAogCWhpZl9zZXRfbWFjYWRkcih3dmlmLCB2aWYtPmFkZHIpOwpAQCAtMTQ2MiwxMCAr
MTQ1Myw2IEBAIHZvaWQgd2Z4X3JlbW92ZV9pbnRlcmZhY2Uoc3RydWN0IGllZWU4MDIxMV9odyAq
aHcsCiAJc3RydWN0IHdmeF92aWYgKnd2aWYgPSAoc3RydWN0IHdmeF92aWYgKikgdmlmLT5kcnZf
cHJpdjsKIAlpbnQgaTsKIAotCS8vIElmIHNjYW4gaXMgaW4gcHJvZ3Jlc3MsIHN0b3AgaXQKLQl3
aGlsZSAoZG93bl90cnlsb2NrKCZ3dmlmLT5zY2FuLmxvY2spKQotCQlzY2hlZHVsZSgpOwotCXVw
KCZ3dmlmLT5zY2FuLmxvY2spOwogCXdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmd3ZpZi0+
c2V0X3BtX21vZGVfY29tcGxldGUsIG1zZWNzX3RvX2ppZmZpZXMoMzAwKSk7CiAKIAltdXRleF9s
b2NrKCZ3ZGV2LT5jb25mX211dGV4KTsKQEAgLTE1MDUsOCArMTQ5Miw2IEBAIHZvaWQgd2Z4X3Jl
bW92ZV9pbnRlcmZhY2Uoc3RydWN0IGllZWU4MDIxMV9odyAqaHcsCiAJLyogRklYTUU6IEluIGFk
ZCB0byByZXNldCBNQUMgYWRkcmVzcywgdHJ5IHRvIHJlc2V0IGludGVyZmFjZSAqLwogCWhpZl9z
ZXRfbWFjYWRkcih3dmlmLCBOVUxMKTsKIAotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmd3Zp
Zi0+c2Nhbi50aW1lb3V0KTsKLQogCXdmeF9jcW1fYnNzbG9zc19zbSh3dmlmLCAwLCAwLCAwKTsK
IAljYW5jZWxfd29ya19zeW5jKCZ3dmlmLT51bmpvaW5fd29yayk7CiAJY2FuY2VsX2RlbGF5ZWRf
d29ya19zeW5jKCZ3dmlmLT5saW5rX2lkX2djX3dvcmspOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9z
dGFnaW5nL3dmeC93ZnguaCBiL2RyaXZlcnMvc3RhZ2luZy93Zngvd2Z4LmgKaW5kZXggMzVmNWRk
YzJlZWIzLi4zMzU2ZDBjYmY3YWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy93Zngvd2Z4
LmgKKysrIGIvZHJpdmVycy9zdGFnaW5nL3dmeC93ZnguaApAQCAtMTI1LDcgKzEyNSw5IEBAIHN0
cnVjdCB3ZnhfdmlmIHsKIAlib29sCQkJZGVsYXllZF91bmpvaW47CiAJc3RydWN0IHdvcmtfc3Ry
dWN0CXVuam9pbl93b3JrOwogCi0Jc3RydWN0IHdmeF9zY2FuCQlzY2FuOworCS8qIGF2b2lkIHNv
bWUgb3BlcmF0aW9ucyBpbiBwYXJhbGxlbCB3aXRoIHNjYW4gKi8KKwlzdHJ1Y3QgbXV0ZXgJCXNj
YW5fbG9jazsKKwlzdHJ1Y3QgY29tcGxldGlvbglzY2FuX2NvbXBsZXRlOwogCiAJc3RydWN0IGNv
bXBsZXRpb24Jc2V0X3BtX21vZGVfY29tcGxldGU7CiAKLS0gCjIuMjQuMAoK
