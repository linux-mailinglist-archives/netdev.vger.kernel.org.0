Return-Path: <netdev-owner@vger.kernel.org>
X-Original-To: lists+netdev@lfdr.de
Delivered-To: lists+netdev@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 189C3294FB
	for <lists+netdev@lfdr.de>; Fri, 24 May 2019 11:39:51 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2390262AbfEXJjt (ORCPT <rfc822;lists+netdev@lfdr.de>);
        Fri, 24 May 2019 05:39:49 -0400
Received: from mail-eopbgr40088.outbound.protection.outlook.com ([40.107.4.88]:62290
        "EHLO EUR03-DB5-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S2389913AbfEXJjs (ORCPT <rfc822;netdev@vger.kernel.org>);
        Fri, 24 May 2019 05:39:48 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=Mellanox.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Y6lJZv8mYjwkVbf8gh0Gexs4xZFp6xQVpb5eUuoQALs=;
 b=NAcTO/ZAUdtRlVyUdAuguelhrgeLhni7lCgLth3Ng7ssxB0/6MTLWy2gmgWDPnYWJWhBtVViQvKgSqoSi/Pa0vXEk8PDHQs9SxvPtzXcdkQEal5+U/YfUZfzVyG/86mX2v3VKHeBJEGwKfyyDB61gwWDCcDnnyU7r6Wleg6it6I=
Received: from AM6PR05MB5879.eurprd05.prod.outlook.com (20.179.0.76) by
 AM6PR05MB4294.eurprd05.prod.outlook.com (52.135.160.158) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1900.18; Fri, 24 May 2019 09:35:43 +0000
Received: from AM6PR05MB5879.eurprd05.prod.outlook.com
 ([fe80::3cb0:9252:d790:51e2]) by AM6PR05MB5879.eurprd05.prod.outlook.com
 ([fe80::3cb0:9252:d790:51e2%7]) with mapi id 15.20.1922.019; Fri, 24 May 2019
 09:35:43 +0000
From:   Maxim Mikityanskiy <maximmi@mellanox.com>
To:     Alexei Starovoitov <ast@kernel.org>,
        Daniel Borkmann <daniel@iogearbox.net>,
        =?utf-8?B?QmrDtnJuIFTDtnBlbA==?= <bjorn.topel@intel.com>,
        Magnus Karlsson <magnus.karlsson@intel.com>
CC:     "bpf@vger.kernel.org" <bpf@vger.kernel.org>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>,
        "David S. Miller" <davem@davemloft.net>,
        Saeed Mahameed <saeedm@mellanox.com>,
        Jonathan Lemon <bsd@fb.com>,
        Tariq Toukan <tariqt@mellanox.com>,
        Martin KaFai Lau <kafai@fb.com>,
        Song Liu <songliubraving@fb.com>, Yonghong Song <yhs@fb.com>,
        Jakub Kicinski <jakub.kicinski@netronome.com>,
        Maciej Fijalkowski <maciejromanfijalkowski@gmail.com>,
        Maxim Mikityanskiy <maximmi@mellanox.com>
Subject: [PATCH bpf-next v3 16/16] net/mlx5e: Add XSK support
Thread-Topic: [PATCH bpf-next v3 16/16] net/mlx5e: Add XSK support
Thread-Index: AQHVEhQOz1lNmAltTEqWQK7EecpFoQ==
Date:   Fri, 24 May 2019 09:35:42 +0000
Message-ID: <20190524093431.20887-17-maximmi@mellanox.com>
References: <20190524093431.20887-1-maximmi@mellanox.com>
In-Reply-To: <20190524093431.20887-1-maximmi@mellanox.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: LO2P265CA0126.GBRP265.PROD.OUTLOOK.COM
 (2603:10a6:600:9f::18) To AM6PR05MB5879.eurprd05.prod.outlook.com
 (2603:10a6:20b:a2::12)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=maximmi@mellanox.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.19.1
x-originating-ip: [141.226.120.58]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 87201105-8067-4f86-6348-08d6e02b3092
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(4618075)(2017052603328)(7193020);SRVR:AM6PR05MB4294;
x-ms-traffictypediagnostic: AM6PR05MB4294:
x-microsoft-antispam-prvs: <AM6PR05MB429460A1C2684F619244E3BCD1020@AM6PR05MB4294.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 0047BC5ADE
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(136003)(39860400002)(396003)(366004)(346002)(376002)(199004)(189003)(66476007)(99286004)(478600001)(76176011)(66556008)(66946007)(14454004)(68736007)(6506007)(64756008)(386003)(66446008)(36756003)(316002)(54906003)(110136005)(73956011)(107886003)(26005)(486006)(71200400001)(71190400001)(52116002)(11346002)(446003)(186003)(305945005)(7736002)(2616005)(2906002)(476003)(6436002)(5660300002)(53936002)(50226002)(7416002)(30864003)(8676002)(102836004)(1076003)(8936002)(256004)(66066001)(86362001)(25786009)(6486002)(6512007)(53946003)(4326008)(81166006)(3846002)(6116002)(81156014)(14444005)(559001)(579004)(569006);DIR:OUT;SFP:1101;SCL:1;SRVR:AM6PR05MB4294;H:AM6PR05MB5879.eurprd05.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;A:1;MX:1;
received-spf: None (protection.outlook.com: mellanox.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: Hm+r/nDOpiRgjXhZr2oX+7beEHcvtnS7Thx7gIL6VPKqyPjc3JzDURzUnStjCjpPcsoncFK2DqosekkEAGtirBVfN0Rww1/9p9u71aCDod42L5sYAes4d0WhJsSGjJauZM7lUWjxj4gKHp+p69QrBiYXP4piREHmnGHs9cwE7WGnikeTQhgVu8uQhq597tORJFvr39vaBFMLyoQynMQZNIVoa/WC4Uf4wFLKIwhohHzSn5XmDFBfc8EqW3U2QQBxZhlaNdcUpqQGK/i5HoPjPDh1lU98rOB3JYEfrcU0y0aJS2Pux6NDXSflEFnlcEBWxy7pdH1Jgs+8ykmREYQeeX4kzYdSZY/QplhixFoGb8MGFc7hdR9qEYhij56FPjFQLBGXCHv3zK0q4+8EEiWC0VYxmegEJTvK0eZ8eTZfsLI=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Mellanox.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 87201105-8067-4f86-6348-08d6e02b3092
X-MS-Exchange-CrossTenant-originalarrivaltime: 24 May 2019 09:35:42.8506
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: a652971c-7d2e-4d9b-a6a4-d149256f461b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM6PR05MB4294
Sender: netdev-owner@vger.kernel.org
Precedence: bulk
List-ID: <netdev.vger.kernel.org>
X-Mailing-List: netdev@vger.kernel.org

VGhpcyBjb21taXQgYWRkcyBzdXBwb3J0IGZvciBBRl9YRFAgemVyby1jb3B5IFJYIGFuZCBUWC4N
Cg0KV2UgY3JlYXRlIGEgZGVkaWNhdGVkIFhTSyBSUSBpbnNpZGUgdGhlIGNoYW5uZWwsIGl0IG1l
YW5zIHRoYXQgdHdvDQpSUXMgYXJlIHJ1bm5pbmcgc2ltdWx0YW5lb3VzbHk6IG9uZSBmb3Igbm9u
LVhTSyB0cmFmZmljIGFuZCB0aGUgb3RoZXINCmZvciBYU0sgdHJhZmZpYy4gVGhleSBuZWVkIHRv
IGJlIGRpc3Rpbmd1aXNoZWQgdGhvdWdoLiBVc2UgdGhlIE1TQiBvZg0KdGhlIDMyLWJpdCBxdWV1
ZSBpbmRleCB0byBpbmRpY2F0ZSBpdCdzIHRoZSBYU0sgUlEgaW4gYW4gWERQIHByb2dyYW0uDQpX
aGVuIGNvbmZpZ3VyaW5nIGZsb3cgc3RlZXJpbmcgd2l0aCBldGh0b29sLCB1c2UgYHVzZXItZGVm
IDFgIHRvIHNlbGVjdA0KdGhlIFhTSyBSUSwgZS5nLjoNCg0KZXRodG9vbCAtTiBldGgwIGZsb3ct
dHlwZSB1ZHA0IGRzdC1wb3J0IDQyNDIgYWN0aW9uIDMgdXNlci1kZWYgMQ0KDQpYU0sgcmVxdWly
ZXMgZGlmZmVyZW50IHBhZ2UgYWxsb2NhdGlvbiBhbmQgcmVsZWFzZSByb3V0aW5lcy4gU3VjaA0K
ZnVuY3Rpb25zIGFzIG1seDVlX3thbGxvYyxmcmVlfV9yeF9tcHdxZSBhbmQgbWx4NWVfe2dldCxw
dXR9X3J4X2ZyYWcgYXJlDQpnZW5lcmljIGVub3VnaCB0byBiZSB1c2VkIGZvciBib3RoIHJlZ3Vs
YXIgYW5kIFhTSyBSUXMsIGFuZCB0aGV5IHVzZSB0aGUNCm1seDVlX3BhZ2Vfe2FsbG9jLHJlbGVh
c2V9IHdyYXBwZXJzIGFyb3VuZCB0aGUgcmVhbCBhbGxvY2F0aW9uDQpmdW5jdGlvbnMuIEZ1bmN0
aW9uIHBvaW50ZXJzIGFyZSBub3QgdXNlZCB0byBhdm9pZCBsb3NpbmcgdGhlDQpwZXJmb3JtYW5j
ZSB3aXRoIHJldHBvbGluZXMuIFdoZXJldmVyIGl0J3MgY2VydGFpbiB0aGF0IHRoZSByZWd1bGFy
DQoobm9uLVhTSykgcGFnZSByZWxlYXNlIGZ1bmN0aW9uIHNob3VsZCBiZSB1c2VkLCBpdCdzIGNh
bGxlZCBkaXJlY3RseS4NCg0KT25seSB0aGUgc3RhdHMgdGhhdCBjb3VsZCBiZSBtZWFuaW5nZnVs
IGZvciBYU0sgYXJlIGV4cG9zZWQgdG8gdGhlDQp1c2Vyc3BhY2UuIFRob3NlIHRoYXQgZG9uJ3Qg
dGFrZSBwYXJ0IGluIHRoZSBYU0sgZmxvdyBhcmUgbm90DQpjb25zaWRlcmVkLg0KDQpOb3RlIHRo
YXQgd2UgZG9uJ3Qgd2FpdCBmb3IgV1FFcyBvbiB0aGUgWFNLIFJRICh1bmxpa2UgdGhlIHJlZ3Vs
YXIgUlEpLA0KYmVjYXVzZSB0aGUgbmV3ZXIgeGRwc29jayBzYW1wbGUgZG9lc24ndCBwcm92aWRl
IGFueSBGaWxsIFJpbmcgZW50cmllcw0KYXQgdGhlIHNldHVwIHN0YWdlLg0KDQpXZSBjcmVhdGUg
YSBkZWRpY2F0ZWQgWFNLIFNRIGluIHRoZSBjaGFubmVsLiBUaGlzIHNlcGFyYXRpb24gaGFzIGl0
cw0KYWR2YW50YWdlczoNCg0KMS4gV2hlbiB0aGUgVU1FTSBpcyBjbG9zZWQsIHRoZSBYU0sgU1Eg
Y2FuIGFsc28gYmUgY2xvc2VkIGFuZCBzdG9wDQpyZWNlaXZpbmcgY29tcGxldGlvbnMuIElmIGFu
IGV4aXN0aW5nIFNRIHdhcyB1c2VkIGZvciBYU0ssIGl0IHdvdWxkDQpjb250aW51ZSByZWNlaXZp
bmcgY29tcGxldGlvbnMgZm9yIHRoZSBwYWNrZXRzIG9mIHRoZSBjbG9zZWQgc29ja2V0LiBJZg0K
YSBuZXcgVU1FTSB3YXMgb3BlbmVkIGF0IHRoYXQgcG9pbnQsIGl0IHdvdWxkIHN0YXJ0IGdldHRp
bmcgY29tcGxldGlvbnMNCnRoYXQgZG9uJ3QgYmVsb25nIHRvIGl0Lg0KDQoyLiBDYWxjdWxhdGlu
ZyBzdGF0aXN0aWNzIHNlcGFyYXRlbHkuDQoNCldoZW4gdGhlIHVzZXJzcGFjZSBraWNrcyB0aGUg
VFgsIHRoZSBkcml2ZXIgdHJpZ2dlcnMgYSBoYXJkd2FyZQ0KaW50ZXJydXB0IGJ5IHBvc3Rpbmcg
YSBOT1AgdG8gYSBkZWRpY2F0ZWQgWFNLIElDTyAoaW50ZXJuYWwgY29udHJvbA0Kb3BlcmF0aW9u
cykgU1EsIGluIG9yZGVyIHRvIHRyaWdnZXIgTkFQSSBvbiB0aGUgcmlnaHQgQ1BVIGNvcmUuIFRo
aXMgWFNLDQpJQ08gU1EgaXMgcHJvdGVjdGVkIGJ5IGEgc3BpbmxvY2ssIGFzIHRoZSB1c2Vyc3Bh
Y2UgYXBwbGljYXRpb24gbWF5IGtpY2sNCnRoZSBUWCBmcm9tIGFueSBjb3JlLg0KDQpTdG9yZSB0
aGUgcG9pbnRlcnMgdG8gdGhlIFVNRU1zIGluIHRoZSBuZXQgZGV2aWNlIHByaXZhdGUgY29udGV4
dCwNCmluZGVwZW5kZW50bHkgZnJvbSB0aGUga2VybmVsLiBUaGlzIHdheSB0aGUgZHJpdmVyIGNh
biBkaXN0aW5ndWlzaA0KYmV0d2VlbiB0aGUgemVyby1jb3B5IGFuZCBub24temVyby1jb3B5IFVN
RU1zLiBUaGUga2VybmVsIGZ1bmN0aW9uDQp4ZHBfZ2V0X3VtZW1fZnJvbV9xaWQgZG9lcyBub3Qg
Y2FyZSBhYm91dCB0aGlzIGRpZmZlcmVuY2UsIGJ1dCB0aGUNCmRyaXZlciBpcyBvbmx5IGludGVy
ZXN0ZWQgaW4gemVyby1jb3B5IFVNRU1zLCBwYXJ0aWN1bGFybHksIG9uIHRoZQ0KY2xlYW51cCBp
dCBkZXRlcm1pbmVzIHdoZXRoZXIgdG8gY2xvc2UgdGhlIFhTSyBSUSBhbmQgU1Egb3Igbm90IGJ5
DQpsb29raW5nIGF0IHRoZSBwcmVzZW5jZSBvZiB0aGUgVU1FTS4gVXNlIHN0YXRlX2xvY2sgdG8g
cHJvdGVjdCB0aGUNCmFjY2VzcyB0byB0aGlzIGFyZWEgb2YgVU1FTSBwb2ludGVycy4NCg0KTFJP
IGlzbid0IGNvbXBhdGlibGUgd2l0aCBYRFAsIGJ1dCB0aGVyZSBtYXkgYmUgYWN0aXZlIFVNRU1z
IHdoaWxlDQpYRFAgaXMgb2ZmLiBJZiB0aGlzIGlzIHRoZSBjYXNlLCBkb24ndCBhbGxvdyBMUk8g
dG8gZW5zdXJlIFhEUCBjYW4NCmJlIHJlZW5hYmxlZCBhdCBhbnkgdGltZS4NCg0KVGhlIHZhbGlk
YXRpb24gb2YgWFNLIHBhcmFtZXRlcnMgdHlwaWNhbGx5IGhhcHBlbnMgd2hlbiBYU0sgcXVldWVz
DQpvcGVuLiBIb3dldmVyLCB3aGVuIHRoZSBpbnRlcmZhY2UgaXMgZG93biBvciB0aGUgWERQIHBy
b2dyYW0gaXNuJ3QNCnNldCwgaXQncyBzdGlsbCBwb3NzaWJsZSB0byBoYXZlIGFjdGl2ZSBBRl9Y
RFAgc29ja2V0cyBhbmQgZXZlbiB0bw0Kb3BlbiBuZXcsIGJ1dCB0aGUgWFNLIHF1ZXVlcyB3aWxs
IGJlIGNsb3NlZC4gVG8gY292ZXIgdGhlc2UgY2FzZXMsDQpwZXJmb3JtIHRoZSB2YWxpZGF0aW9u
IGFsc28gaW4gdGhlc2UgZmxvd3M6DQoNCjEuIEEgbmV3IFVNRU0gaXMgcmVnaXN0ZXJlZCwgYnV0
IHRoZSBYU0sgcXVldWVzIGFyZW4ndCBnb2luZyB0byBiZQ0KY3JlYXRlZCBkdWUgdG8gbWlzc2lu
ZyBYRFAgcHJvZ3JhbSBvciBpbnRlcmZhY2UgYmVpbmcgZG93bi4NCg0KMi4gTVRVIGNoYW5nZXMg
d2hpbGUgdGhlcmUgYXJlIFVNRU1zIHJlZ2lzdGVyZWQuDQoNCkhhdmluZyB0aGlzIGVhcmx5IGNo
ZWNrIHByZXZlbnRzIG1seDVlX29wZW5fY2hhbm5lbHMgZnJvbSBmYWlsaW5nDQphdCBhIGxhdGVy
IHN0YWdlLCB3aGVyZSByZWNvdmVyeSBpcyBpbXBvc3NpYmxlIGFuZCB0aGUgYXBwbGljYXRpb24N
CmhhcyBubyBjaGFuY2UgdG8gaGFuZGxlIHRoZSBlcnJvciwgYmVjYXVzZSBpdCBnb3QgdGhlIHN1
Y2Nlc3NmdWwNCnJldHVybiB2YWx1ZSBmb3IgYW4gTVRVIGNoYW5nZSBvciBYU0sgb3BlbiBvcGVy
YXRpb24uDQoNClNpZ25lZC1vZmYtYnk6IE1heGltIE1pa2l0eWFuc2tpeSA8bWF4aW1taUBtZWxs
YW5veC5jb20+DQpSZXZpZXdlZC1ieTogVGFyaXEgVG91a2FuIDx0YXJpcXRAbWVsbGFub3guY29t
Pg0KQWNrZWQtYnk6IFNhZWVkIE1haGFtZWVkIDxzYWVlZG1AbWVsbGFub3guY29tPg0KLS0tDQog
Li4uL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvTWFrZWZpbGUgIHwgICAyICstDQog
ZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuLmggIHwgIDkwICsrKy0N
CiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5jICAgfCAgNTMgKy0N
CiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5oICAgfCAgNDYgKy0N
CiAuLi4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94ZHAuYyAgfCAxMDMgKysr
LQ0KIC4uLi9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hkcC5oICB8ICAxOCAr
LQ0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL01ha2VmaWxlICAgICAgICB8ICAgMSAr
DQogLi4uL2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguYyAgIHwgMTkyICsr
KysrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9yeC5oICAgfCAg
MjcgKw0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmMgICAgICAgICB8IDIy
MyArKysrKysrKw0KIC4uLi9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmggICAgICAg
ICB8ICAyNSArDQogLi4uL2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdHguYyAg
IHwgMTA4ICsrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay90eC5o
ICAgfCAgMTUgKw0KIC4uLi9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3VtZW0u
YyB8IDI1MiArKysrKysrKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hz
ay91bWVtLmggfCAgMzQgKysNCiAuLi4vZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX2V0
aHRvb2wuYyAgfCAgMjEgKy0NCiAuLi4vbWVsbGFub3gvbWx4NS9jb3JlL2VuX2ZzX2V0aHRvb2wu
YyAgICAgICAgfCAgNDQgKy0NCiAuLi4vbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9l
bl9tYWluLmMgfCA1MDYgKysrKysrKysrKysrLS0tLS0tDQogLi4uL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW5fcmVwLmMgIHwgIDEyICstDQogLi4uL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW5fcnguYyAgIHwgIDc3ICsrLQ0KIC4uLi9ldGhlcm5ldC9tZWxsYW5v
eC9tbHg1L2NvcmUvZW5fc3RhdHMuYyAgICB8IDExNSArKystDQogLi4uL2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9lbl9zdGF0cy5oICAgIHwgIDMwICsrDQogLi4uL25ldC9ldGhlcm5ldC9t
ZWxsYW5veC9tbHg1L2NvcmUvZW5fdHhyeC5jIHwgIDM0ICstDQogLi4uL2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9pcG9pYi9pcG9pYi5jIHwgIDE0ICstDQogMjQgZmlsZXMgY2hhbmdlZCwg
MTc5MSBpbnNlcnRpb25zKCspLCAyNTEgZGVsZXRpb25zKC0pDQogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svTWFrZWZpbGUN
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9j
b3JlL2VuL3hzay9yeC5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbmV0L2V0aGVybmV0
L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmMNCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vu
L3hzay9zZXR1cC5oDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbi94c2svdHguYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4LmgNCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay91
bWVtLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gv
bWx4NS9jb3JlL2VuL3hzay91bWVtLmgNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9NYWtlZmlsZSBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9NYWtlZmlsZQ0KaW5kZXggMjQzMzY4ZGMyM2RiLi45Njk0Y2QxZWE3
NTkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUv
TWFrZWZpbGUNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9N
YWtlZmlsZQ0KQEAgLTIzLDcgKzIzLDcgQEAgbWx4NV9jb3JlLXkgOj0JbWFpbi5vIGNtZC5vIGRl
YnVnZnMubyBmdy5vIGVxLm8gdWFyLm8gcGFnZWFsbG9jLm8gXA0KIG1seDVfY29yZS0kKENPTkZJ
R19NTFg1X0NPUkVfRU4pICs9IGVuX21haW4ubyBlbl9jb21tb24ubyBlbl9mcy5vIGVuX2V0aHRv
b2wubyBcDQogCQllbl90eC5vIGVuX3J4Lm8gZW5fZGltLm8gZW5fdHhyeC5vIGVuL3hkcC5vIGVu
X3N0YXRzLm8gXA0KIAkJZW5fc2VsZnRlc3QubyBlbi9wb3J0Lm8gZW4vbW9uaXRvcl9zdGF0cy5v
IGVuL3JlcG9ydGVyX3R4Lm8gXA0KLQkJZW4vcGFyYW1zLm8NCisJCWVuL3BhcmFtcy5vIGVuL3hz
ay91bWVtLm8gZW4veHNrL3NldHVwLm8gZW4veHNrL3J4Lm8gZW4veHNrL3R4Lm8NCiANCiAjDQog
IyBOZXRkZXYgZXh0cmENCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5v
eC9tbHg1L2NvcmUvZW4uaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29y
ZS9lbi5oDQppbmRleCA4Y2IyOGU1NjA0ZjAuLjI2ZjE2MGMwOWJlOSAxMDA2NDQNCi0tLSBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi5oDQorKysgYi9kcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4uaA0KQEAgLTEzNyw2ICsxMzcsNyBA
QCBzdHJ1Y3QgcGFnZV9wb29sOw0KICNkZWZpbmUgTUxYNUVfTUFYX05VTV9DSEFOTkVMUyAgICAg
ICAgIChNTFg1RV9JTkRJUl9SUVRfU0laRSA+PiAxKQ0KICNkZWZpbmUgTUxYNUVfTUFYX05VTV9T
UVMgICAgICAgICAgICAgIChNTFg1RV9NQVhfTlVNX0NIQU5ORUxTICogTUxYNUVfTUFYX05VTV9U
QykNCiAjZGVmaW5lIE1MWDVFX1RYX0NRX1BPTExfQlVER0VUICAgICAgICAxMjgNCisjZGVmaW5l
IE1MWDVFX1RYX1hTS19QT0xMX0JVREdFVCAgICAgICA2NA0KICNkZWZpbmUgTUxYNUVfU1FfUkVD
T1ZFUl9NSU5fSU5URVJWQUwgIDUwMCAvKiBtc2VjcyAqLw0KIA0KICNkZWZpbmUgTUxYNUVfVU1S
X1dRRV9JTkxJTkVfU1ogXA0KQEAgLTI1MCw2ICsyNTEsNyBAQCBzdHJ1Y3QgbWx4NWVfcGFyYW1z
IHsNCiAJdTMyIGxyb190aW1lb3V0Ow0KIAl1MzIgcGZsYWdzOw0KIAlzdHJ1Y3QgYnBmX3Byb2cg
KnhkcF9wcm9nOw0KKwlzdHJ1Y3QgbWx4NWVfeHNrICp4c2s7DQogCXVuc2lnbmVkIGludCBzd19t
dHU7DQogCWludCBoYXJkX210dTsNCiB9Ow0KQEAgLTM5OCw4ICs0MDAsMTQgQEAgc3RydWN0IG1s
eDVlX3R4cXNxIHsNCiB9IF9fX19jYWNoZWxpbmVfYWxpZ25lZF9pbl9zbXA7DQogDQogc3RydWN0
IG1seDVlX2RtYV9pbmZvIHsNCi0Jc3RydWN0IHBhZ2UgICAgICpwYWdlOw0KLQlkbWFfYWRkcl90
ICAgICAgYWRkcjsNCisJZG1hX2FkZHJfdCBhZGRyOw0KKwl1bmlvbiB7DQorCQlzdHJ1Y3QgcGFn
ZSAqcGFnZTsNCisJCXN0cnVjdCB7DQorCQkJdTY0IGhhbmRsZTsNCisJCQl2b2lkICpkYXRhOw0K
KwkJfSB4c2s7DQorCX07DQogfTsNCiANCiAvKiBYRFAgcGFja2V0cyBjYW4gYmUgdHJhbnNtaXR0
ZWQgaW4gZGlmZmVyZW50IHdheXMuIE9uIGNvbXBsZXRpb24sIHdlIG5lZWQgdG8NCkBAIC00NjYs
OSArNDc0LDExIEBAIHN0cnVjdCBtbHg1ZV94ZHBfbXB3cWUgew0KIH07DQogDQogc3RydWN0IG1s
eDVlX3hkcHNxOw0KK3R5cGVkZWYgaW50ICgqbWx4NWVfZnBfeG1pdF94ZHBfZnJhbWVfY2hlY2sp
KHN0cnVjdCBtbHg1ZV94ZHBzcSAqKTsNCiB0eXBlZGVmIGJvb2wgKCptbHg1ZV9mcF94bWl0X3hk
cF9mcmFtZSkoc3RydWN0IG1seDVlX3hkcHNxICosDQogCQkJCQlzdHJ1Y3QgbWx4NWVfeGRwX3ht
aXRfZGF0YSAqLA0KLQkJCQkJc3RydWN0IG1seDVlX3hkcF9pbmZvICopOw0KKwkJCQkJc3RydWN0
IG1seDVlX3hkcF9pbmZvICosDQorCQkJCQlpbnQpOw0KIA0KIHN0cnVjdCBtbHg1ZV94ZHBzcSB7
DQogCS8qIGRhdGEgcGF0aCAqLw0KQEAgLTQ4Niw4ICs0OTYsMTAgQEAgc3RydWN0IG1seDVlX3hk
cHNxIHsNCiAJc3RydWN0IG1seDVlX2NxICAgICAgICAgICAgY3E7DQogDQogCS8qIHJlYWQgb25s
eSAqLw0KKwlzdHJ1Y3QgeGRwX3VtZW0gICAgICAgICAgICp1bWVtOw0KIAlzdHJ1Y3QgbWx4NV93
cV9jeWMgICAgICAgICB3cTsNCiAJc3RydWN0IG1seDVlX3hkcHNxX3N0YXRzICAqc3RhdHM7DQor
CW1seDVlX2ZwX3htaXRfeGRwX2ZyYW1lX2NoZWNrIHhtaXRfeGRwX2ZyYW1lX2NoZWNrOw0KIAlt
bHg1ZV9mcF94bWl0X3hkcF9mcmFtZSAgICB4bWl0X3hkcF9mcmFtZTsNCiAJc3RydWN0IHsNCiAJ
CXN0cnVjdCBtbHg1ZV94ZHBfd3FlX2luZm8gKndxZV9pbmZvOw0KQEAgLTYxOCw2ICs2MzAsNyBA
QCBzdHJ1Y3QgbWx4NWVfcnEgew0KIAkJfSBtcHdxZTsNCiAJfTsNCiAJc3RydWN0IHsNCisJCXUx
NiAgICAgICAgICAgIHVtZW1faGVhZHJvb207DQogCQl1MTYgICAgICAgICAgICBoZWFkcm9vbTsN
CiAJCXU4ICAgICAgICAgICAgIG1hcF9kaXI7ICAgLyogZG1hIG1hcCBkaXJlY3Rpb24gKi8NCiAJ
fSBidWZmOw0KQEAgLTY0OCw2ICs2NjEsMTAgQEAgc3RydWN0IG1seDVlX3JxIHsNCiAJREVDTEFS
RV9CSVRNQVAoZmxhZ3MsIDgpOw0KIAlzdHJ1Y3QgcGFnZV9wb29sICAgICAgKnBhZ2VfcG9vbDsN
CiANCisJLyogQUZfWERQIHplcm8tY29weSAqLw0KKwlzdHJ1Y3QgemVyb19jb3B5X2FsbG9jYXRv
ciB6Y2E7DQorCXN0cnVjdCB4ZHBfdW1lbSAgICAgICAqdW1lbTsNCisNCiAJLyogY29udHJvbCAq
Lw0KIAlzdHJ1Y3QgbWx4NV93cV9jdHJsICAgIHdxX2N0cmw7DQogCV9fYmUzMiAgICAgICAgICAg
ICAgICAgbWtleV9iZTsNCkBAIC02NjAsNiArNjc3LDExIEBAIHN0cnVjdCBtbHg1ZV9ycSB7DQog
CXN0cnVjdCB4ZHBfcnhxX2luZm8gICAgeGRwX3J4cTsNCiB9IF9fX19jYWNoZWxpbmVfYWxpZ25l
ZF9pbl9zbXA7DQogDQorZW51bSBtbHg1ZV9jaGFubmVsX3N0YXRlIHsNCisJTUxYNUVfQ0hBTk5F
TF9TVEFURV9YU0ssDQorCU1MWDVFX0NIQU5ORUxfTlVNX1NUQVRFUw0KK307DQorDQogc3RydWN0
IG1seDVlX2NoYW5uZWwgew0KIAkvKiBkYXRhIHBhdGggKi8NCiAJc3RydWN0IG1seDVlX3JxICAg
ICAgICAgICAgcnE7DQpAQCAtNjc2LDYgKzY5OCwxMyBAQCBzdHJ1Y3QgbWx4NWVfY2hhbm5lbCB7
DQogCS8qIFhEUF9SRURJUkVDVCAqLw0KIAlzdHJ1Y3QgbWx4NWVfeGRwc3EgICAgICAgICB4ZHBz
cTsNCiANCisJLyogQUZfWERQIHplcm8tY29weSAqLw0KKwlzdHJ1Y3QgbWx4NWVfcnEgICAgICAg
ICAgICB4c2tycTsNCisJc3RydWN0IG1seDVlX3hkcHNxICAgICAgICAgeHNrc3E7DQorCXN0cnVj
dCBtbHg1ZV9pY29zcSAgICAgICAgIHhza2ljb3NxOw0KKwkvKiB4c2tpY29zcSBjYW4gYmUgYWNj
ZXNzZWQgZnJvbSBhbnkgQ1BVIC0gdGhlIHNwaW5sb2NrIHByb3RlY3RzIGl0LiAqLw0KKwlzcGlu
bG9ja190ICAgICAgICAgICAgICAgICB4c2tpY29zcV9sb2NrOw0KKw0KIAkvKiBkYXRhIHBhdGgg
LSBhY2Nlc3NlZCBwZXIgbmFwaSBwb2xsICovDQogCXN0cnVjdCBpcnFfZGVzYyAqaXJxX2Rlc2M7
DQogCXN0cnVjdCBtbHg1ZV9jaF9zdGF0cyAgICAgKnN0YXRzOw0KQEAgLTY4NCw2ICs3MTMsNyBA
QCBzdHJ1Y3QgbWx4NWVfY2hhbm5lbCB7DQogCXN0cnVjdCBtbHg1ZV9wcml2ICAgICAgICAgKnBy
aXY7DQogCXN0cnVjdCBtbHg1X2NvcmVfZGV2ICAgICAgKm1kZXY7DQogCXN0cnVjdCBod3RzdGFt
cF9jb25maWcgICAgKnRzdGFtcDsNCisJREVDTEFSRV9CSVRNQVAoc3RhdGUsIE1MWDVFX0NIQU5O
RUxfTlVNX1NUQVRFUyk7DQogCWludCAgICAgICAgICAgICAgICAgICAgICAgIGl4Ow0KIAlpbnQg
ICAgICAgICAgICAgICAgICAgICAgICBjcHU7DQogCWNwdW1hc2tfdmFyX3QgICAgICAgICAgICAg
IHhwc19jcHVtYXNrOw0KQEAgLTY5OSwxNCArNzI5LDE3IEBAIHN0cnVjdCBtbHg1ZV9jaGFubmVs
X3N0YXRzIHsNCiAJc3RydWN0IG1seDVlX2NoX3N0YXRzIGNoOw0KIAlzdHJ1Y3QgbWx4NWVfc3Ff
c3RhdHMgc3FbTUxYNUVfTUFYX05VTV9UQ107DQogCXN0cnVjdCBtbHg1ZV9ycV9zdGF0cyBycTsN
CisJc3RydWN0IG1seDVlX3JxX3N0YXRzIHhza3JxOw0KIAlzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3Rh
dHMgcnFfeGRwc3E7DQogCXN0cnVjdCBtbHg1ZV94ZHBzcV9zdGF0cyB4ZHBzcTsNCisJc3RydWN0
IG1seDVlX3hkcHNxX3N0YXRzIHhza3NxOw0KIH0gX19fX2NhY2hlbGluZV9hbGlnbmVkX2luX3Nt
cDsNCiANCiBlbnVtIHsNCiAJTUxYNUVfU1RBVEVfT1BFTkVELA0KIAlNTFg1RV9TVEFURV9ERVNU
Uk9ZSU5HLA0KIAlNTFg1RV9TVEFURV9YRFBfVFhfRU5BQkxFRCwNCisJTUxYNUVfU1RBVEVfWERQ
X09QRU4sDQogfTsNCiANCiBzdHJ1Y3QgbWx4NWVfcnF0IHsNCkBAIC03MzksNiArNzcyLDE3IEBA
IHN0cnVjdCBtbHg1ZV9tb2RpZnlfc3FfcGFyYW0gew0KIAlpbnQgcmxfaW5kZXg7DQogfTsNCiAN
CitzdHJ1Y3QgbWx4NWVfeHNrIHsNCisJLyogVU1FTXMgYXJlIHN0b3JlZCBzZXBhcmF0ZWx5IGZy
b20gY2hhbm5lbHMsIGJlY2F1c2Ugd2UgZG9uJ3Qgd2FudCB0bw0KKwkgKiBsb3NlIHRoZW0gd2hl
biBjaGFubmVscyBhcmUgcmVjcmVhdGVkLiBUaGUga2VybmVsIGFsc28gc3RvcmVzIFVNRU1zLA0K
KwkgKiBidXQgaXQgZG9lc24ndCBkaXN0aW5ndWlzaCBiZXR3ZWVuIHplcm8tY29weSBhbmQgbm9u
LXplcm8tY29weSBVTUVNcywNCisJICogc28gcmVseSBvbiBvdXIgbWVjaGFuaXNtLg0KKwkgKi8N
CisJc3RydWN0IHhkcF91bWVtICoqdW1lbXM7DQorCXUxNiByZWZjbnQ7DQorCWJvb2wgZXZlcl91
c2VkOw0KK307DQorDQogc3RydWN0IG1seDVlX3ByaXYgew0KIAkvKiBwcml2IGRhdGEgcGF0aCBm
aWVsZHMgLSBzdGFydCAqLw0KIAlzdHJ1Y3QgbWx4NWVfdHhxc3EgKnR4cTJzcVtNTFg1RV9NQVhf
TlVNX0NIQU5ORUxTICogTUxYNUVfTUFYX05VTV9UQ107DQpAQCAtNzU5LDYgKzgwMyw3IEBAIHN0
cnVjdCBtbHg1ZV9wcml2IHsNCiAJc3RydWN0IG1seDVlX3RpciAgICAgICAgICAgaW5kaXJfdGly
W01MWDVFX05VTV9JTkRJUl9USVJTXTsNCiAJc3RydWN0IG1seDVlX3RpciAgICAgICAgICAgaW5u
ZXJfaW5kaXJfdGlyW01MWDVFX05VTV9JTkRJUl9USVJTXTsNCiAJc3RydWN0IG1seDVlX3RpciAg
ICAgICAgICAgZGlyZWN0X3RpcltNTFg1RV9NQVhfTlVNX0NIQU5ORUxTXTsNCisJc3RydWN0IG1s
eDVlX3RpciAgICAgICAgICAgeHNrX3RpcltNTFg1RV9NQVhfTlVNX0NIQU5ORUxTXTsNCiAJc3Ry
dWN0IG1seDVlX3Jzc19wYXJhbXMgICAgcnNzX3BhcmFtczsNCiAJdTMyICAgICAgICAgICAgICAg
ICAgICAgICAgdHhfcmF0ZXNbTUxYNUVfTUFYX05VTV9TUVNdOw0KIA0KQEAgLTc5NSw2ICs4NDAs
NyBAQCBzdHJ1Y3QgbWx4NWVfcHJpdiB7DQogCXN0cnVjdCBtbHg1ZV90bHMgICAgICAgICAgKnRs
czsNCiAjZW5kaWYNCiAJc3RydWN0IGRldmxpbmtfaGVhbHRoX3JlcG9ydGVyICp0eF9yZXBvcnRl
cjsNCisJc3RydWN0IG1seDVlX3hzayAgICAgICAgICAgeHNrOw0KIH07DQogDQogc3RydWN0IG1s
eDVlX3Byb2ZpbGUgew0KQEAgLTgzOCw4ICs4ODQsOSBAQCBib29sIG1seDVlX3N0cmlkaW5nX3Jx
X3Bvc3NpYmxlKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KIAkJCQlzdHJ1Y3QgbWx4NWVf
cGFyYW1zICpwYXJhbXMpOw0KIA0KIHZvaWQgbWx4NWVfcGFnZV9kbWFfdW5tYXAoc3RydWN0IG1s
eDVlX3JxICpycSwgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbyk7DQotdm9pZCBtbHg1
ZV9wYWdlX3JlbGVhc2Uoc3RydWN0IG1seDVlX3JxICpycSwgc3RydWN0IG1seDVlX2RtYV9pbmZv
ICpkbWFfaW5mbywNCi0JCQlib29sIHJlY3ljbGUpOw0KK3ZvaWQgbWx4NWVfcGFnZV9yZWxlYXNl
X2R5bmFtaWMoc3RydWN0IG1seDVlX3JxICpycSwNCisJCQkJc3RydWN0IG1seDVlX2RtYV9pbmZv
ICpkbWFfaW5mbywNCisJCQkJYm9vbCByZWN5Y2xlKTsNCiB2b2lkIG1seDVlX2hhbmRsZV9yeF9j
cWUoc3RydWN0IG1seDVlX3JxICpycSwgc3RydWN0IG1seDVfY3FlNjQgKmNxZSk7DQogdm9pZCBt
bHg1ZV9oYW5kbGVfcnhfY3FlX21wd3JxKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHN0cnVjdCBtbHg1
X2NxZTY0ICpjcWUpOw0KIGJvb2wgbWx4NWVfcG9zdF9yeF93cWVzKHN0cnVjdCBtbHg1ZV9ycSAq
cnEpOw0KQEAgLTg5OSw2ICs5NDYsMzAgQEAgdm9pZCBtbHg1ZV9idWlsZF9pbmRpcl90aXJfY3R4
X2hhc2goc3RydWN0IG1seDVlX3Jzc19wYXJhbXMgKnJzc19wYXJhbXMsDQogdm9pZCBtbHg1ZV9t
b2RpZnlfdGlyc19oYXNoKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB2b2lkICppbiwgaW50IGlu
bGVuKTsNCiBzdHJ1Y3QgbWx4NWVfdGlyY19jb25maWcgbWx4NWVfdGlyY19nZXRfZGVmYXVsdF9j
b25maWcoZW51bSBtbHg1ZV90cmFmZmljX3R5cGVzIHR0KTsNCiANCitzdHJ1Y3QgbWx4NWVfeHNr
X3BhcmFtOw0KKw0KK3N0cnVjdCBtbHg1ZV9ycV9wYXJhbTsNCitpbnQgbWx4NWVfb3Blbl9ycShz
dHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJ
ICBzdHJ1Y3QgbWx4NWVfcnFfcGFyYW0gKnBhcmFtLCBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4
c2ssDQorCQkgIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwgc3RydWN0IG1seDVlX3JxICpycSk7DQor
aW50IG1seDVlX3dhaXRfZm9yX21pbl9yeF93cWVzKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIGludCB3
YWl0X3RpbWUpOw0KK3ZvaWQgbWx4NWVfZGVhY3RpdmF0ZV9ycShzdHJ1Y3QgbWx4NWVfcnEgKnJx
KTsNCit2b2lkIG1seDVlX2Nsb3NlX3JxKHN0cnVjdCBtbHg1ZV9ycSAqcnEpOw0KKw0KK3N0cnVj
dCBtbHg1ZV9zcV9wYXJhbTsNCitpbnQgbWx4NWVfb3Blbl9pY29zcShzdHJ1Y3QgbWx4NWVfY2hh
bm5lbCAqYywgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJICAgICBzdHJ1Y3QgbWx4
NWVfc3FfcGFyYW0gKnBhcmFtLCBzdHJ1Y3QgbWx4NWVfaWNvc3EgKnNxKTsNCit2b2lkIG1seDVl
X2Nsb3NlX2ljb3NxKHN0cnVjdCBtbHg1ZV9pY29zcSAqc3EpOw0KK2ludCBtbHg1ZV9vcGVuX3hk
cHNxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLCBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMs
DQorCQkgICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0sIHN0cnVjdCB4ZHBfdW1lbSAq
dW1lbSwNCisJCSAgICAgc3RydWN0IG1seDVlX3hkcHNxICpzcSwgYm9vbCBpc19yZWRpcmVjdCk7
DQordm9pZCBtbHg1ZV9jbG9zZV94ZHBzcShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxKTsNCisNCitz
dHJ1Y3QgbWx4NWVfY3FfcGFyYW07DQoraW50IG1seDVlX29wZW5fY3Eoc3RydWN0IG1seDVlX2No
YW5uZWwgKmMsIHN0cnVjdCBuZXRfZGltX2NxX21vZGVyIG1vZGVyLA0KKwkJICBzdHJ1Y3QgbWx4
NWVfY3FfcGFyYW0gKnBhcmFtLCBzdHJ1Y3QgbWx4NWVfY3EgKmNxKTsNCit2b2lkIG1seDVlX2Ns
b3NlX2NxKHN0cnVjdCBtbHg1ZV9jcSAqY3EpOw0KKw0KIGludCBtbHg1ZV9vcGVuX2xvY2tlZChz
dHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2KTsNCiBpbnQgbWx4NWVfY2xvc2VfbG9ja2VkKHN0cnVj
dCBuZXRfZGV2aWNlICpuZXRkZXYpOw0KIA0KQEAgLTEwNjksMTAgKzExNDAsMTAgQEAgaW50IG1s
eDVlX2NyZWF0ZV9pbmRpcmVjdF9ycXQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpOw0KIGludCBt
bHg1ZV9jcmVhdGVfaW5kaXJlY3RfdGlycyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgYm9vbCBp
bm5lcl90dGMpOw0KIHZvaWQgbWx4NWVfZGVzdHJveV9pbmRpcmVjdF90aXJzKHN0cnVjdCBtbHg1
ZV9wcml2ICpwcml2LCBib29sIGlubmVyX3R0Yyk7DQogDQotaW50IG1seDVlX2NyZWF0ZV9kaXJl
Y3RfcnF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdik7DQotdm9pZCBtbHg1ZV9kZXN0cm95X2Rp
cmVjdF9ycXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KTsNCi1pbnQgbWx4NWVfY3JlYXRlX2Rp
cmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KTsNCi12b2lkIG1seDVlX2Rlc3Ryb3lf
ZGlyZWN0X3RpcnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpOw0KK2ludCBtbHg1ZV9jcmVhdGVf
ZGlyZWN0X3JxdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV90aXIgKnRp
cnMpOw0KK3ZvaWQgbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAq
cHJpdiwgc3RydWN0IG1seDVlX3RpciAqdGlycyk7DQoraW50IG1seDVlX2NyZWF0ZV9kaXJlY3Rf
dGlycyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX3RpciAqdGlycyk7DQor
dm9pZCBtbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBz
dHJ1Y3QgbWx4NWVfdGlyICp0aXJzKTsNCiB2b2lkIG1seDVlX2Rlc3Ryb3lfcnF0KHN0cnVjdCBt
bHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfcnF0ICpycXQpOw0KIA0KIGludCBtbHg1ZV9j
cmVhdGVfdGlzKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LCBpbnQgdGMsDQpAQCAtMTE0Myw2
ICsxMjE0LDcgQEAgdm9pZCBtbHg1ZV9kZXRhY2hfbmV0ZGV2KHN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2KTsNCiB2b2lkIG1seDVlX2Rlc3Ryb3lfbmV0ZGV2KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
KTsNCiB2b2lkIG1seDVlX3NldF9uZXRkZXZfbXR1X2JvdW5kYXJpZXMoc3RydWN0IG1seDVlX3By
aXYgKnByaXYpOw0KIHZvaWQgbWx4NWVfYnVpbGRfbmljX3BhcmFtcyhzdHJ1Y3QgbWx4NV9jb3Jl
X2RldiAqbWRldiwNCisJCQkgICAgc3RydWN0IG1seDVlX3hzayAqeHNrLA0KIAkJCSAgICBzdHJ1
Y3QgbWx4NWVfcnNzX3BhcmFtcyAqcnNzX3BhcmFtcywNCiAJCQkgICAgc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zLA0KIAkJCSAgICB1MTYgbWF4X2NoYW5uZWxzLCB1MTYgbXR1KTsNCmRpZmYg
LS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFyYW1z
LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFyYW1zLmMN
CmluZGV4IDBkZTkwOGIxMmZjYy4uNzkzMDFkMTE2NjY3IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9u
ZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5jDQorKysgYi9kcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4vcGFyYW1zLmMNCkBAIC00OSw0OCAr
NDksNTYgQEAgdTMyIG1seDVlX3J4X2dldF9saW5lYXJfZnJhZ19zeihzdHJ1Y3QgbWx4NWVfcGFy
YW1zICpwYXJhbXMsDQogCXJldHVybiBmcmFnX3N6Ow0KIH0NCiANCi11OCBtbHg1ZV9tcHdxZV9s
b2dfcGt0c19wZXJfd3FlKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcykNCit1OCBtbHg1ZV9t
cHdxZV9sb2dfcGt0c19wZXJfd3FlKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJ
c3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrKQ0KIHsNCi0JdTMyIGxpbmVhcl9mcmFnX3N6ID0g
bWx4NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgTlVMTCk7DQorCXUzMiBsaW5lYXJf
ZnJhZ19zeiA9IG1seDVlX3J4X2dldF9saW5lYXJfZnJhZ19zeihwYXJhbXMsIHhzayk7DQogDQog
CXJldHVybiBNTFg1X01QV1JRX0xPR19XUUVfU1ogLSBvcmRlcl9iYXNlXzIobGluZWFyX2ZyYWdf
c3opOw0KIH0NCiANCi1ib29sIG1seDVlX3J4X2lzX2xpbmVhcl9za2Ioc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zKQ0KK2Jvb2wgbWx4NWVfcnhfaXNfbGluZWFyX3NrYihzdHJ1Y3QgbWx4NWVf
cGFyYW1zICpwYXJhbXMsDQorCQkJICAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaykNCiB7
DQotCXUzMiBmcmFnX3N6ID0gbWx4NWVfcnhfZ2V0X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgTlVM
TCk7DQorCS8qIEFGX1hEUCBhbGxvY2F0ZXMgU0tCcyBvbiBYRFBfUEFTUyAtIGVuc3VyZSB0aGV5
IGRvbid0IG9jY3VweSBtb3JlDQorCSAqIHRoYW4gb25lIHBhZ2UuIEZvciB0aGlzLCBjaGVjayBi
b3RoIHdpdGggYW5kIHdpdGhvdXQgeHNrLg0KKwkgKi8NCisJdTMyIGxpbmVhcl9mcmFnX3N6ID0g
bWF4KG1seDVlX3J4X2dldF9saW5lYXJfZnJhZ19zeihwYXJhbXMsIHhzayksDQorCQkJCSBtbHg1
ZV9yeF9nZXRfbGluZWFyX2ZyYWdfc3oocGFyYW1zLCBOVUxMKSk7DQogDQotCXJldHVybiAhcGFy
YW1zLT5scm9fZW4gJiYgZnJhZ19zeiA8PSBQQUdFX1NJWkU7DQorCXJldHVybiAhcGFyYW1zLT5s
cm9fZW4gJiYgbGluZWFyX2ZyYWdfc3ogPD0gUEFHRV9TSVpFOw0KIH0NCiANCiAjZGVmaW5lIE1M
WDVfTUFYX01QV1FFX0xPR19XUUVfU1RSSURFX1NaICgoQklUKF9fbWx4NV9iaXRfc3ood3EsIGxv
Z193cWVfc3RyaWRlX3NpemUpKSAtIDEpICsgXA0KIAkJCQkJICBNTFg1X01QV1FFX0xPR19TVFJJ
REVfU1pfQkFTRSkNCiBib29sIG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2Ioc3RydWN0IG1s
eDVfY29yZV9kZXYgKm1kZXYsDQotCQkJCSAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0K
KwkJCQkgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJICBzdHJ1Y3QgbWx4NWVf
eHNrX3BhcmFtICp4c2spDQogew0KLQl1MzIgZnJhZ19zeiA9IG1seDVlX3J4X2dldF9saW5lYXJf
ZnJhZ19zeihwYXJhbXMsIE5VTEwpOw0KKwl1MzIgbGluZWFyX2ZyYWdfc3ogPSBtbHg1ZV9yeF9n
ZXRfbGluZWFyX2ZyYWdfc3oocGFyYW1zLCB4c2spOw0KIAlzOCBzaWduZWRfbG9nX251bV9zdHJp
ZGVzX3BhcmFtOw0KIAl1OCBsb2dfbnVtX3N0cmlkZXM7DQogDQotCWlmICghbWx4NWVfcnhfaXNf
bGluZWFyX3NrYihwYXJhbXMpKQ0KKwlpZiAoIW1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1z
LCB4c2spKQ0KIAkJcmV0dXJuIGZhbHNlOw0KIA0KLQlpZiAob3JkZXJfYmFzZV8yKGZyYWdfc3op
ID4gTUxYNV9NQVhfTVBXUUVfTE9HX1dRRV9TVFJJREVfU1opDQorCWlmIChvcmRlcl9iYXNlXzIo
bGluZWFyX2ZyYWdfc3opID4gTUxYNV9NQVhfTVBXUUVfTE9HX1dRRV9TVFJJREVfU1opDQogCQly
ZXR1cm4gZmFsc2U7DQogDQogCWlmIChNTFg1X0NBUF9HRU4obWRldiwgZXh0X3N0cmlkZV9udW1f
cmFuZ2UpKQ0KIAkJcmV0dXJuIHRydWU7DQogDQotCWxvZ19udW1fc3RyaWRlcyA9IE1MWDVfTVBX
UlFfTE9HX1dRRV9TWiAtIG9yZGVyX2Jhc2VfMihmcmFnX3N6KTsNCisJbG9nX251bV9zdHJpZGVz
ID0gTUxYNV9NUFdSUV9MT0dfV1FFX1NaIC0gb3JkZXJfYmFzZV8yKGxpbmVhcl9mcmFnX3N6KTsN
CiAJc2lnbmVkX2xvZ19udW1fc3RyaWRlc19wYXJhbSA9DQogCQkoczgpbG9nX251bV9zdHJpZGVz
IC0gTUxYNV9NUFdRRV9MT0dfTlVNX1NUUklERVNfQkFTRTsNCiANCiAJcmV0dXJuIHNpZ25lZF9s
b2dfbnVtX3N0cmlkZXNfcGFyYW0gPj0gMDsNCiB9DQogDQotdTggbWx4NWVfbXB3cWVfZ2V0X2xv
Z19ycV9zaXplKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcykNCit1OCBtbHg1ZV9tcHdxZV9n
ZXRfbG9nX3JxX3NpemUoc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgICAgICBz
dHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2spDQogew0KLQl1OCBsb2dfcGt0c19wZXJfd3FlID0g
bWx4NWVfbXB3cWVfbG9nX3BrdHNfcGVyX3dxZShwYXJhbXMpOw0KKwl1OCBsb2dfcGt0c19wZXJf
d3FlID0gbWx4NWVfbXB3cWVfbG9nX3BrdHNfcGVyX3dxZShwYXJhbXMsIHhzayk7DQogDQogCS8q
IE51bWJlcnMgYXJlIHVuc2lnbmVkLCBkb24ndCBzdWJ0cmFjdCB0byBhdm9pZCB1bmRlcmZsb3cu
ICovDQogCWlmIChwYXJhbXMtPmxvZ19ycV9tdHVfZnJhbWVzIDwNCkBAIC0xMDEsMjcgKzEwOSwz
MCBAQCB1OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUoc3RydWN0IG1seDVlX3BhcmFtcyAq
cGFyYW1zKQ0KIH0NCiANCiB1OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKHN0cnVj
dCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KLQkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJh
bXMpDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkJICAgc3RydWN0
IG1seDVlX3hza19wYXJhbSAqeHNrKQ0KIHsNCi0JaWYgKG1seDVlX3J4X21wd3FlX2lzX2xpbmVh
cl9za2IobWRldiwgcGFyYW1zKSkNCi0JCXJldHVybiBvcmRlcl9iYXNlXzIobWx4NWVfcnhfZ2V0
X2xpbmVhcl9mcmFnX3N6KHBhcmFtcywgTlVMTCkpOw0KKwlpZiAobWx4NWVfcnhfbXB3cWVfaXNf
bGluZWFyX3NrYihtZGV2LCBwYXJhbXMsIHhzaykpDQorCQlyZXR1cm4gb3JkZXJfYmFzZV8yKG1s
eDVlX3J4X2dldF9saW5lYXJfZnJhZ19zeihwYXJhbXMsIHhzaykpOw0KIA0KIAlyZXR1cm4gTUxY
NV9NUFdSUV9ERUZfTE9HX1NUUklERV9TWihtZGV2KTsNCiB9DQogDQogdTggbWx4NWVfbXB3cWVf
Z2V0X2xvZ19udW1fc3RyaWRlcyhzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCi0JCQkJICAg
c3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1z
ICpwYXJhbXMsDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaykNCiB7DQogCXJl
dHVybiBNTFg1X01QV1JRX0xPR19XUUVfU1ogLQ0KLQkJbWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJp
ZGVfc2l6ZShtZGV2LCBwYXJhbXMpOw0KKwkJbWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJpZGVfc2l6
ZShtZGV2LCBwYXJhbXMsIHhzayk7DQogfQ0KIA0KIHUxNiBtbHg1ZV9nZXRfcnFfaGVhZHJvb20o
c3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYsDQotCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpw
YXJhbXMpDQorCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICBzdHJ1Y3Qg
bWx4NWVfeHNrX3BhcmFtICp4c2spDQogew0KIAlib29sIGlzX2xpbmVhcl9za2IgPSAocGFyYW1z
LT5ycV93cV90eXBlID09IE1MWDVfV1FfVFlQRV9DWUNMSUMpID8NCi0JCW1seDVlX3J4X2lzX2xp
bmVhcl9za2IocGFyYW1zKSA6DQotCQltbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYs
IHBhcmFtcyk7DQorCQltbHg1ZV9yeF9pc19saW5lYXJfc2tiKHBhcmFtcywgeHNrKSA6DQorCQlt
bHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYsIHBhcmFtcywgeHNrKTsNCiANCi0JcmV0
dXJuIGlzX2xpbmVhcl9za2IgPyBtbHg1ZV9nZXRfbGluZWFyX3JxX2hlYWRyb29tKHBhcmFtcywg
TlVMTCkgOiAwOw0KKwlyZXR1cm4gaXNfbGluZWFyX3NrYiA/IG1seDVlX2dldF9saW5lYXJfcnFf
aGVhZHJvb20ocGFyYW1zLCB4c2spIDogMDsNCiB9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5oIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5oDQppbmRleCBmODM0MTdiODIyYmYu
LjM1MmU0ODBmYTQ2OSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94
L21seDUvY29yZS9lbi9wYXJhbXMuaA0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuL3BhcmFtcy5oDQpAQCAtNDYsMTYgKzQ2LDQ4IEBAIHUxNiBtbHg1ZV9n
ZXRfbGluZWFyX3JxX2hlYWRyb29tKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCiAJCQkJ
IHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzayk7DQogdTMyIG1seDVlX3J4X2dldF9saW5lYXJf
ZnJhZ19zeihzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQogCQkJCXN0cnVjdCBtbHg1ZV94
c2tfcGFyYW0gKnhzayk7DQotdTggbWx4NWVfbXB3cWVfbG9nX3BrdHNfcGVyX3dxZShzdHJ1Y3Qg
bWx4NWVfcGFyYW1zICpwYXJhbXMpOw0KLWJvb2wgbWx4NWVfcnhfaXNfbGluZWFyX3NrYihzdHJ1
Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMpOw0KK3U4IG1seDVlX21wd3FlX2xvZ19wa3RzX3Blcl93
cWUoc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQlzdHJ1Y3QgbWx4NWVfeHNrX3Bh
cmFtICp4c2spOw0KK2Jvb2wgbWx4NWVfcnhfaXNfbGluZWFyX3NrYihzdHJ1Y3QgbWx4NWVfcGFy
YW1zICpwYXJhbXMsDQorCQkJICAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzayk7DQogYm9v
bCBtbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2
LA0KLQkJCQkgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyk7DQotdTggbWx4NWVfbXB3cWVf
Z2V0X2xvZ19ycV9zaXplKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcyk7DQorCQkJCSAgc3Ry
dWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0g
Knhzayk7DQordTggbWx4NWVfbXB3cWVfZ2V0X2xvZ19ycV9zaXplKHN0cnVjdCBtbHg1ZV9wYXJh
bXMgKnBhcmFtcywNCisJCQkgICAgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrKTsNCiB1
OCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICpt
ZGV2LA0KLQkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMpOw0KKwkJCQkgICBzdHJ1
Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0g
Knhzayk7DQogdTggbWx4NWVfbXB3cWVfZ2V0X2xvZ19udW1fc3RyaWRlcyhzdHJ1Y3QgbWx4NV9j
b3JlX2RldiAqbWRldiwNCi0JCQkJICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKTsNCisJ
CQkJICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVf
eHNrX3BhcmFtICp4c2spOw0KIHUxNiBtbHg1ZV9nZXRfcnFfaGVhZHJvb20oc3RydWN0IG1seDVf
Y29yZV9kZXYgKm1kZXYsDQotCQkJICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMpOw0KKwkJ
CSAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgc3RydWN0IG1seDVlX3hza19w
YXJhbSAqeHNrKTsNCisNCisvKiBCdWlsZCBxdWV1ZSBwYXJhbWV0ZXJzICovDQorDQordm9pZCBt
bHg1ZV9idWlsZF9ycV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgIHN0cnVj
dCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhz
aywNCisJCQkgIHN0cnVjdCBtbHg1ZV9ycV9wYXJhbSAqcGFyYW0pOw0KK3ZvaWQgbWx4NWVfYnVp
bGRfc3FfcGFyYW1fY29tbW9uKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCQkgc3RydWN0
IG1seDVlX3NxX3BhcmFtICpwYXJhbSk7DQordm9pZCBtbHg1ZV9idWlsZF9yeF9jcV9wYXJhbShz
dHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgICAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBh
cmFtcywNCisJCQkgICAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywNCisJCQkgICAgIHN0
cnVjdCBtbHg1ZV9jcV9wYXJhbSAqcGFyYW0pOw0KK3ZvaWQgbWx4NWVfYnVpbGRfdHhfY3FfcGFy
YW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfcGFyYW1z
ICpwYXJhbXMsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gKnBhcmFtKTsNCit2b2lk
IG1seDVlX2J1aWxkX2ljb19jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkg
ICAgICB1OCBsb2dfd3Ffc2l6ZSwNCisJCQkgICAgICBzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gKnBh
cmFtKTsNCit2b2lkIG1seDVlX2J1aWxkX2ljb3NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2LA0KKwkJCSAgICAgdTggbG9nX3dxX3NpemUsDQorCQkJICAgICBzdHJ1Y3QgbWx4NWVfc3Ff
cGFyYW0gKnBhcmFtKTsNCit2b2lkIG1seDVlX2J1aWxkX3hkcHNxX3BhcmFtKHN0cnVjdCBtbHg1
ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJ
CSAgICAgc3RydWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSk7DQogDQogI2VuZGlmIC8qIF9fTUxY
NV9FTl9QQVJBTVNfSF9fICovDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL2VuL3hkcC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gv
bWx4NS9jb3JlL2VuL3hkcC5jDQppbmRleCBlZTk5ZWZkZTkxNDMuLmIwYjk4MmNmNjliYiAxMDA2
NDQNCi0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94ZHAu
Yw0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hkcC5j
DQpAQCAtMzEsNiArMzEsNyBAQA0KICAqLw0KIA0KICNpbmNsdWRlIDxsaW51eC9icGZfdHJhY2Uu
aD4NCisjaW5jbHVkZSA8bmV0L3hkcF9zb2NrLmg+DQogI2luY2x1ZGUgImVuL3hkcC5oIg0KICNp
bmNsdWRlICJlbi9wYXJhbXMuaCINCiANCkBAIC0xMTMsMTIgKzExNCwxMiBAQCBtbHg1ZV94bWl0
X3hkcF9idWZmKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsIHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQog
CQl4ZHBpLnBhZ2UuZGkgICAgPSAqZGk7DQogCX0NCiANCi0JcmV0dXJuIHNxLT54bWl0X3hkcF9m
cmFtZShzcSwgJnhkcHR4ZCwgJnhkcGkpOw0KKwlyZXR1cm4gc3EtPnhtaXRfeGRwX2ZyYW1lKHNx
LCAmeGRwdHhkLCAmeGRwaSwgMCk7DQogfQ0KIA0KIC8qIHJldHVybnMgdHJ1ZSBpZiBwYWNrZXQg
d2FzIGNvbnN1bWVkIGJ5IHhkcCAqLw0KIGJvb2wgbWx4NWVfeGRwX2hhbmRsZShzdHJ1Y3QgbWx4
NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRpLA0KLQkJICAgICAgdm9pZCAqdmEs
IHUxNiAqcnhfaGVhZHJvb20sIHUzMiAqbGVuKQ0KKwkJICAgICAgdm9pZCAqdmEsIHUxNiAqcnhf
aGVhZHJvb20sIHUzMiAqbGVuLCBib29sIHhzaykNCiB7DQogCXN0cnVjdCBicGZfcHJvZyAqcHJv
ZyA9IFJFQURfT05DRShycS0+eGRwX3Byb2cpOw0KIAlzdHJ1Y3QgeGRwX2J1ZmYgeGRwOw0KQEAg
LTEzMiw5ICsxMzMsMTMgQEAgYm9vbCBtbHg1ZV94ZHBfaGFuZGxlKHN0cnVjdCBtbHg1ZV9ycSAq
cnEsIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZGksDQogCXhkcF9zZXRfZGF0YV9tZXRhX2ludmFs
aWQoJnhkcCk7DQogCXhkcC5kYXRhX2VuZCA9IHhkcC5kYXRhICsgKmxlbjsNCiAJeGRwLmRhdGFf
aGFyZF9zdGFydCA9IHZhOw0KKwlpZiAoeHNrKQ0KKwkJeGRwLmhhbmRsZSA9IGRpLT54c2suaGFu
ZGxlOw0KIAl4ZHAucnhxID0gJnJxLT54ZHBfcnhxOw0KIA0KIAlhY3QgPSBicGZfcHJvZ19ydW5f
eGRwKHByb2csICZ4ZHApOw0KKwlpZiAoeHNrKQ0KKwkJeGRwLmhhbmRsZSArPSB4ZHAuZGF0YSAt
IHhkcC5kYXRhX2hhcmRfc3RhcnQ7DQogCXN3aXRjaCAoYWN0KSB7DQogCWNhc2UgWERQX1BBU1M6
DQogCQkqcnhfaGVhZHJvb20gPSB4ZHAuZGF0YSAtIHhkcC5kYXRhX2hhcmRfc3RhcnQ7DQpAQCAt
MTUyLDcgKzE1Nyw4IEBAIGJvb2wgbWx4NWVfeGRwX2hhbmRsZShzdHJ1Y3QgbWx4NWVfcnEgKnJx
LCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRpLA0KIAkJCWdvdG8geGRwX2Fib3J0Ow0KIAkJX19z
ZXRfYml0KE1MWDVFX1JRX0ZMQUdfWERQX1hNSVQsIHJxLT5mbGFncyk7DQogCQlfX3NldF9iaXQo
TUxYNUVfUlFfRkxBR19YRFBfUkVESVJFQ1QsIHJxLT5mbGFncyk7DQotCQltbHg1ZV9wYWdlX2Rt
YV91bm1hcChycSwgZGkpOw0KKwkJaWYgKCF4c2spDQorCQkJbWx4NWVfcGFnZV9kbWFfdW5tYXAo
cnEsIGRpKTsNCiAJCXJxLT5zdGF0cy0+eGRwX3JlZGlyZWN0Kys7DQogCQlyZXR1cm4gdHJ1ZTsN
CiAJZGVmYXVsdDoNCkBAIC0yMDYsNyArMjEyLDcgQEAgc3RhdGljIHZvaWQgbWx4NWVfeGRwX21w
d3FlX3Nlc3Npb25fc3RhcnQoc3RydWN0IG1seDVlX3hkcHNxICpzcSkNCiAJc3RhdHMtPm1wd3Fl
Kys7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX3hkcF9tcHdxZV9jb21wbGV0ZShzdHJ1Y3Qg
bWx4NWVfeGRwc3EgKnNxKQ0KK3ZvaWQgbWx4NWVfeGRwX21wd3FlX2NvbXBsZXRlKHN0cnVjdCBt
bHg1ZV94ZHBzcSAqc3EpDQogew0KIAlzdHJ1Y3QgbWx4NV93cV9jeWMgICAgICAgKndxICAgID0g
JnNxLT53cTsNCiAJc3RydWN0IG1seDVlX3hkcF9tcHdxZSAqc2Vzc2lvbiA9ICZzcS0+bXB3cWU7
DQpAQCAtMjI5LDkgKzIzNSwzMiBAQCBzdGF0aWMgdm9pZCBtbHg1ZV94ZHBfbXB3cWVfY29tcGxl
dGUoc3RydWN0IG1seDVlX3hkcHNxICpzcSkNCiAJc2Vzc2lvbi0+d3FlID0gTlVMTDsgLyogQ2xv
c2Ugc2Vzc2lvbiAqLw0KIH0NCiANCitlbnVtIHsNCisJTUxYNUVfWERQX0NIRUNLX09LID0gMSwN
CisJTUxYNUVfWERQX0NIRUNLX1NUQVJUX01QV1FFID0gMiwNCit9Ow0KKw0KK3N0YXRpYyBpbnQg
bWx4NWVfeG1pdF94ZHBfZnJhbWVfY2hlY2tfbXB3cWUoc3RydWN0IG1seDVlX3hkcHNxICpzcSkN
Cit7DQorCWlmICh1bmxpa2VseSghc3EtPm1wd3FlLndxZSkpIHsNCisJCWlmICh1bmxpa2VseSgh
bWx4NWVfd3FjX2hhc19yb29tX2Zvcigmc3EtPndxLCBzcS0+Y2MsIHNxLT5wYywNCisJCQkJCQkg
ICAgIE1MWDVfU0VORF9XUUVfTUFYX1dRRUJCUykpKSB7DQorCQkJLyogU1EgaXMgZnVsbCwgcmlu
ZyBkb29yYmVsbCAqLw0KKwkJCW1seDVlX3htaXRfeGRwX2Rvb3JiZWxsKHNxKTsNCisJCQlzcS0+
c3RhdHMtPmZ1bGwrKzsNCisJCQlyZXR1cm4gLUVCVVNZOw0KKwkJfQ0KKw0KKwkJcmV0dXJuIE1M
WDVFX1hEUF9DSEVDS19TVEFSVF9NUFdRRTsNCisJfQ0KKw0KKwlyZXR1cm4gTUxYNUVfWERQX0NI
RUNLX09LOw0KK30NCisNCiBzdGF0aWMgYm9vbCBtbHg1ZV94bWl0X3hkcF9mcmFtZV9tcHdxZShz
dHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIAkJCQkgICAgICAgc3RydWN0IG1seDVlX3hkcF94bWl0
X2RhdGEgKnhkcHR4ZCwNCi0JCQkJICAgICAgIHN0cnVjdCBtbHg1ZV94ZHBfaW5mbyAqeGRwaSkN
CisJCQkJICAgICAgIHN0cnVjdCBtbHg1ZV94ZHBfaW5mbyAqeGRwaSwNCisJCQkJICAgICAgIGlu
dCBjaGVja19yZXN1bHQpDQogew0KIAlzdHJ1Y3QgbWx4NWVfeGRwX21wd3FlICpzZXNzaW9uID0g
JnNxLT5tcHdxZTsNCiAJc3RydWN0IG1seDVlX3hkcHNxX3N0YXRzICpzdGF0cyA9IHNxLT5zdGF0
czsNCkBAIC0yNDEsMTUgKzI3MCwxNiBAQCBzdGF0aWMgYm9vbCBtbHg1ZV94bWl0X3hkcF9mcmFt
ZV9tcHdxZShzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLA0KIAkJcmV0dXJuIGZhbHNlOw0KIAl9DQog
DQotCWlmICh1bmxpa2VseSghc2Vzc2lvbi0+d3FlKSkgew0KLQkJaWYgKHVubGlrZWx5KCFtbHg1
ZV93cWNfaGFzX3Jvb21fZm9yKCZzcS0+d3EsIHNxLT5jYywgc3EtPnBjLA0KLQkJCQkJCSAgICAg
TUxYNV9TRU5EX1dRRV9NQVhfV1FFQkJTKSkpIHsNCi0JCQkvKiBTUSBpcyBmdWxsLCByaW5nIGRv
b3JiZWxsICovDQotCQkJbWx4NWVfeG1pdF94ZHBfZG9vcmJlbGwoc3EpOw0KLQkJCXN0YXRzLT5m
dWxsKys7DQotCQkJcmV0dXJuIGZhbHNlOw0KLQkJfQ0KKwlpZiAoIWNoZWNrX3Jlc3VsdCkNCisJ
CWNoZWNrX3Jlc3VsdCA9IG1seDVlX3htaXRfeGRwX2ZyYW1lX2NoZWNrX21wd3FlKHNxKTsNCisJ
aWYgKHVubGlrZWx5KGNoZWNrX3Jlc3VsdCA8IDApKQ0KKwkJcmV0dXJuIGZhbHNlOw0KIA0KKwlp
ZiAoY2hlY2tfcmVzdWx0ID09IE1MWDVFX1hEUF9DSEVDS19TVEFSVF9NUFdRRSkgew0KKwkJLyog
U3RhcnQgdGhlIHNlc3Npb24gd2hlbiBub3RoaW5nIGNhbiBmYWlsLCBzbyBpdCdzIGd1YXJhbnRl
ZWQNCisJCSAqIHRoYXQgaWYgdGhlcmUgaXMgYW4gYWN0aXZlIHNlc3Npb24sIGl0IGhhcyBhdCBs
ZWFzdCBvbmUgZHNlZywNCisJCSAqIGFuZCBpdCdzIHNhZmUgdG8gY29tcGxldGUgaXQgYXQgYW55
IHRpbWUuDQorCQkgKi8NCiAJCW1seDVlX3hkcF9tcHdxZV9zZXNzaW9uX3N0YXJ0KHNxKTsNCiAJ
fQ0KIA0KQEAgLTI2NCw5ICsyOTQsMjIgQEAgc3RhdGljIGJvb2wgbWx4NWVfeG1pdF94ZHBfZnJh
bWVfbXB3cWUoc3RydWN0IG1seDVlX3hkcHNxICpzcSwNCiAJcmV0dXJuIHRydWU7DQogfQ0KIA0K
K3N0YXRpYyBpbnQgbWx4NWVfeG1pdF94ZHBfZnJhbWVfY2hlY2soc3RydWN0IG1seDVlX3hkcHNx
ICpzcSkNCit7DQorCWlmICh1bmxpa2VseSghbWx4NWVfd3FjX2hhc19yb29tX2Zvcigmc3EtPndx
LCBzcS0+Y2MsIHNxLT5wYywgMSkpKSB7DQorCQkvKiBTUSBpcyBmdWxsLCByaW5nIGRvb3JiZWxs
ICovDQorCQltbHg1ZV94bWl0X3hkcF9kb29yYmVsbChzcSk7DQorCQlzcS0+c3RhdHMtPmZ1bGwr
KzsNCisJCXJldHVybiAtRUJVU1k7DQorCX0NCisNCisJcmV0dXJuIE1MWDVFX1hEUF9DSEVDS19P
SzsNCit9DQorDQogc3RhdGljIGJvb2wgbWx4NWVfeG1pdF94ZHBfZnJhbWUoc3RydWN0IG1seDVl
X3hkcHNxICpzcSwNCiAJCQkJIHN0cnVjdCBtbHg1ZV94ZHBfeG1pdF9kYXRhICp4ZHB0eGQsDQot
CQkJCSBzdHJ1Y3QgbWx4NWVfeGRwX2luZm8gKnhkcGkpDQorCQkJCSBzdHJ1Y3QgbWx4NWVfeGRw
X2luZm8gKnhkcGksDQorCQkJCSBpbnQgY2hlY2tfcmVzdWx0KQ0KIHsNCiAJc3RydWN0IG1seDVf
d3FfY3ljICAgICAgICp3cSAgID0gJnNxLT53cTsNCiAJdTE2ICAgICAgICAgICAgICAgICAgICAg
ICBwaSAgID0gbWx4NV93cV9jeWNfY3RyMml4KHdxLCBzcS0+cGMpOw0KQEAgLTI4OCwxMiArMzMx
LDEwIEBAIHN0YXRpYyBib29sIG1seDVlX3htaXRfeGRwX2ZyYW1lKHN0cnVjdCBtbHg1ZV94ZHBz
cSAqc3EsDQogCQlyZXR1cm4gZmFsc2U7DQogCX0NCiANCi0JaWYgKHVubGlrZWx5KCFtbHg1ZV93
cWNfaGFzX3Jvb21fZm9yKHdxLCBzcS0+Y2MsIHNxLT5wYywgMSkpKSB7DQotCQkvKiBTUSBpcyBm
dWxsLCByaW5nIGRvb3JiZWxsICovDQotCQltbHg1ZV94bWl0X3hkcF9kb29yYmVsbChzcSk7DQot
CQlzdGF0cy0+ZnVsbCsrOw0KKwlpZiAoIWNoZWNrX3Jlc3VsdCkNCisJCWNoZWNrX3Jlc3VsdCA9
IG1seDVlX3htaXRfeGRwX2ZyYW1lX2NoZWNrKHNxKTsNCisJaWYgKHVubGlrZWx5KGNoZWNrX3Jl
c3VsdCA8IDApKQ0KIAkJcmV0dXJuIGZhbHNlOw0KLQl9DQogDQogCWNzZWctPmZtX2NlX3NlID0g
MDsNCiANCkBAIC0zMjMsNiArMzY0LDcgQEAgc3RhdGljIGJvb2wgbWx4NWVfeG1pdF94ZHBfZnJh
bWUoc3RydWN0IG1seDVlX3hkcHNxICpzcSwNCiANCiBzdGF0aWMgdm9pZCBtbHg1ZV9mcmVlX3hk
cHNxX2Rlc2Moc3RydWN0IG1seDVlX3hkcHNxICpzcSwNCiAJCQkJICBzdHJ1Y3QgbWx4NWVfeGRw
X3dxZV9pbmZvICp3aSwNCisJCQkJICB1MzIgKnhza19mcmFtZXMsDQogCQkJCSAgYm9vbCByZWN5
Y2xlKQ0KIHsNCiAJc3RydWN0IG1seDVlX3hkcF9pbmZvX2ZpZm8gKnhkcGlfZmlmbyA9ICZzcS0+
ZGIueGRwaV9maWZvOw0KQEAgLTM0MCw3ICszODIsMTEgQEAgc3RhdGljIHZvaWQgbWx4NWVfZnJl
ZV94ZHBzcV9kZXNjKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsDQogCQkJYnJlYWs7DQogCQljYXNl
IE1MWDVFX1hEUF9YTUlUX01PREVfUEFHRToNCiAJCQkvKiBYRFBfVFggZnJvbSB0aGUgcmVndWxh
ciBSUSAqLw0KLQkJCW1seDVlX3BhZ2VfcmVsZWFzZSh4ZHBpLnBhZ2UucnEsICZ4ZHBpLnBhZ2Uu
ZGksIHJlY3ljbGUpOw0KKwkJCW1seDVlX3BhZ2VfcmVsZWFzZV9keW5hbWljKHhkcGkucGFnZS5y
cSwgJnhkcGkucGFnZS5kaSwgcmVjeWNsZSk7DQorCQkJYnJlYWs7DQorCQljYXNlIE1MWDVFX1hE
UF9YTUlUX01PREVfWFNLOg0KKwkJCS8qIEFGX1hEUCBzZW5kICovDQorCQkJKCp4c2tfZnJhbWVz
KSsrOw0KIAkJCWJyZWFrOw0KIAkJZGVmYXVsdDoNCiAJCQlXQVJOX09OX09OQ0UodHJ1ZSk7DQpA
QCAtMzUyLDYgKzM5OCw3IEBAIGJvb2wgbWx4NWVfcG9sbF94ZHBzcV9jcShzdHJ1Y3QgbWx4NWVf
Y3EgKmNxKQ0KIHsNCiAJc3RydWN0IG1seDVlX3hkcHNxICpzcTsNCiAJc3RydWN0IG1seDVfY3Fl
NjQgKmNxZTsNCisJdTMyIHhza19mcmFtZXMgPSAwOw0KIAl1MTYgc3FjYzsNCiAJaW50IGk7DQog
DQpAQCAtMzkzLDEwICs0NDAsMTMgQEAgYm9vbCBtbHg1ZV9wb2xsX3hkcHNxX2NxKHN0cnVjdCBt
bHg1ZV9jcSAqY3EpDQogDQogCQkJc3FjYyArPSB3aS0+bnVtX3dxZWJiczsNCiANCi0JCQltbHg1
ZV9mcmVlX3hkcHNxX2Rlc2Moc3EsIHdpLCB0cnVlKTsNCisJCQltbHg1ZV9mcmVlX3hkcHNxX2Rl
c2Moc3EsIHdpLCAmeHNrX2ZyYW1lcywgdHJ1ZSk7DQogCQl9IHdoaWxlICghbGFzdF93cWUpOw0K
IAl9IHdoaWxlICgoKytpIDwgTUxYNUVfVFhfQ1FfUE9MTF9CVURHRVQpICYmIChjcWUgPSBtbHg1
X2Nxd3FfZ2V0X2NxZSgmY3EtPndxKSkpOw0KIA0KKwlpZiAoeHNrX2ZyYW1lcykNCisJCXhza191
bWVtX2NvbXBsZXRlX3R4KHNxLT51bWVtLCB4c2tfZnJhbWVzKTsNCisNCiAJc3EtPnN0YXRzLT5j
cWVzICs9IGk7DQogDQogCW1seDVfY3F3cV91cGRhdGVfZGJfcmVjb3JkKCZjcS0+d3EpOw0KQEAg
LTQxMCw2ICs0NjAsOCBAQCBib29sIG1seDVlX3BvbGxfeGRwc3FfY3Eoc3RydWN0IG1seDVlX2Nx
ICpjcSkNCiANCiB2b2lkIG1seDVlX2ZyZWVfeGRwc3FfZGVzY3Moc3RydWN0IG1seDVlX3hkcHNx
ICpzcSkNCiB7DQorCXUzMiB4c2tfZnJhbWVzID0gMDsNCisNCiAJd2hpbGUgKHNxLT5jYyAhPSBz
cS0+cGMpIHsNCiAJCXN0cnVjdCBtbHg1ZV94ZHBfd3FlX2luZm8gKndpOw0KIAkJdTE2IGNpOw0K
QEAgLTQxOSw4ICs0NzEsMTEgQEAgdm9pZCBtbHg1ZV9mcmVlX3hkcHNxX2Rlc2NzKHN0cnVjdCBt
bHg1ZV94ZHBzcSAqc3EpDQogDQogCQlzcS0+Y2MgKz0gd2ktPm51bV93cWViYnM7DQogDQotCQlt
bHg1ZV9mcmVlX3hkcHNxX2Rlc2Moc3EsIHdpLCBmYWxzZSk7DQorCQltbHg1ZV9mcmVlX3hkcHNx
X2Rlc2Moc3EsIHdpLCAmeHNrX2ZyYW1lcywgZmFsc2UpOw0KIAl9DQorDQorCWlmICh4c2tfZnJh
bWVzKQ0KKwkJeHNrX3VtZW1fY29tcGxldGVfdHgoc3EtPnVtZW0sIHhza19mcmFtZXMpOw0KIH0N
CiANCiBpbnQgbWx4NWVfeGRwX3htaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgaW50IG4sIHN0
cnVjdCB4ZHBfZnJhbWUgKipmcmFtZXMsDQpAQCAtNDY2LDcgKzUyMSw3IEBAIGludCBtbHg1ZV94
ZHBfeG1pdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBpbnQgbiwgc3RydWN0IHhkcF9mcmFtZSAq
KmZyYW1lcywNCiAJCXhkcGkuZnJhbWUueGRwZiAgICAgPSB4ZHBmOw0KIAkJeGRwaS5mcmFtZS5k
bWFfYWRkciA9IHhkcHR4ZC5kbWFfYWRkcjsNCiANCi0JCWlmICh1bmxpa2VseSghc3EtPnhtaXRf
eGRwX2ZyYW1lKHNxLCAmeGRwdHhkLCAmeGRwaSkpKSB7DQorCQlpZiAodW5saWtlbHkoIXNxLT54
bWl0X3hkcF9mcmFtZShzcSwgJnhkcHR4ZCwgJnhkcGksIDApKSkgew0KIAkJCWRtYV91bm1hcF9z
aW5nbGUoc3EtPnBkZXYsIHhkcHR4ZC5kbWFfYWRkciwNCiAJCQkJCSB4ZHB0eGQubGVuLCBETUFf
VE9fREVWSUNFKTsNCiAJCQl4ZHBfcmV0dXJuX2ZyYW1lX3J4X25hcGkoeGRwZik7DQpAQCAtNTAw
LDYgKzU1NSw4IEBAIHZvaWQgbWx4NWVfeGRwX3J4X3BvbGxfY29tcGxldGUoc3RydWN0IG1seDVl
X3JxICpycSkNCiANCiB2b2lkIG1seDVlX3NldF94bWl0X2ZwKHN0cnVjdCBtbHg1ZV94ZHBzcSAq
c3EsIGJvb2wgaXNfbXB3KQ0KIHsNCisJc3EtPnhtaXRfeGRwX2ZyYW1lX2NoZWNrID0gaXNfbXB3
ID8NCisJCW1seDVlX3htaXRfeGRwX2ZyYW1lX2NoZWNrX21wd3FlIDogbWx4NWVfeG1pdF94ZHBf
ZnJhbWVfY2hlY2s7DQogCXNxLT54bWl0X3hkcF9mcmFtZSA9IGlzX21wdyA/DQogCQltbHg1ZV94
bWl0X3hkcF9mcmFtZV9tcHdxZSA6IG1seDVlX3htaXRfeGRwX2ZyYW1lOw0KIH0NCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmggYi9k
cml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmgNCmluZGV4IDky
MDBjYjlmNDk5Yi4uMmQ5MzRjOGQzODA3IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hkcC5oDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veGRwLmgNCkBAIC00Miw3ICs0Miw4IEBADQogc3RydWN0
IG1seDVlX3hza19wYXJhbTsNCiBpbnQgbWx4NWVfeGRwX21heF9tdHUoc3RydWN0IG1seDVlX3Bh
cmFtcyAqcGFyYW1zLCBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2spOw0KIGJvb2wgbWx4NWVf
eGRwX2hhbmRsZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRp
LA0KLQkJICAgICAgdm9pZCAqdmEsIHUxNiAqcnhfaGVhZHJvb20sIHUzMiAqbGVuKTsNCisJCSAg
ICAgIHZvaWQgKnZhLCB1MTYgKnJ4X2hlYWRyb29tLCB1MzIgKmxlbiwgYm9vbCB4c2spOw0KK3Zv
aWQgbWx4NWVfeGRwX21wd3FlX2NvbXBsZXRlKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EpOw0KIGJv
b2wgbWx4NWVfcG9sbF94ZHBzcV9jcShzdHJ1Y3QgbWx4NWVfY3EgKmNxKTsNCiB2b2lkIG1seDVl
X2ZyZWVfeGRwc3FfZGVzY3Moc3RydWN0IG1seDVlX3hkcHNxICpzcSk7DQogdm9pZCBtbHg1ZV9z
ZXRfeG1pdF9mcChzdHJ1Y3QgbWx4NWVfeGRwc3EgKnNxLCBib29sIGlzX21wdyk7DQpAQCAtNjcs
NiArNjgsMjEgQEAgc3RhdGljIGlubGluZSBib29sIG1seDVlX3hkcF90eF9pc19lbmFibGVkKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlyZXR1cm4gdGVzdF9iaXQoTUxYNUVfU1RBVEVfWERQ
X1RYX0VOQUJMRUQsICZwcml2LT5zdGF0ZSk7DQogfQ0KIA0KK3N0YXRpYyBpbmxpbmUgdm9pZCBt
bHg1ZV94ZHBfc2V0X29wZW4oc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQorew0KKwlzZXRfYml0
KE1MWDVFX1NUQVRFX1hEUF9PUEVOLCAmcHJpdi0+c3RhdGUpOw0KK30NCisNCitzdGF0aWMgaW5s
aW5lIHZvaWQgbWx4NWVfeGRwX3NldF9jbG9zZWQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQor
ew0KKwljbGVhcl9iaXQoTUxYNUVfU1RBVEVfWERQX09QRU4sICZwcml2LT5zdGF0ZSk7DQorfQ0K
Kw0KK3N0YXRpYyBpbmxpbmUgYm9vbCBtbHg1ZV94ZHBfaXNfb3BlbihzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdikNCit7DQorCXJldHVybiB0ZXN0X2JpdChNTFg1RV9TVEFURV9YRFBfT1BFTiwgJnBy
aXYtPnN0YXRlKTsNCit9DQorDQogc3RhdGljIGlubGluZSB2b2lkIG1seDVlX3htaXRfeGRwX2Rv
b3JiZWxsKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EpDQogew0KIAlpZiAoc3EtPmRvb3JiZWxsX2Nz
ZWcpIHsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2Nv
cmUvZW4veHNrL01ha2VmaWxlIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9j
b3JlL2VuL3hzay9NYWtlZmlsZQ0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAw
MDAwMC4uNWVlNDI5OTE5MDBhDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL25ldC9ldGhl
cm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL01ha2VmaWxlDQpAQCAtMCwwICsxIEBADQor
c3ViZGlyLWNjZmxhZ3MteSArPSAtSSQoc3JjKS8uLi8uLg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguYyBiL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguYw0KbmV3IGZpbGUgbW9kZSAx
MDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uNmE1NTU3M2VjOGYyDQotLS0gL2Rldi9udWxsDQor
KysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3J4LmMN
CkBAIC0wLDAgKzEsMTkyIEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAg
T1IgTGludXgtT3BlbklCDQorLyogQ29weXJpZ2h0IChjKSAyMDE5IE1lbGxhbm94IFRlY2hub2xv
Z2llcy4gKi8NCisNCisjaW5jbHVkZSAicnguaCINCisjaW5jbHVkZSAiZW4veGRwLmgiDQorI2lu
Y2x1ZGUgPG5ldC94ZHBfc29jay5oPg0KKw0KKy8qIFJYIGRhdGEgcGF0aCAqLw0KKw0KK2Jvb2wg
bWx4NWVfeHNrX3BhZ2VzX2Vub3VnaF91bWVtKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIGludCBjb3Vu
dCkNCit7DQorCS8qIENoZWNrIGluIGFkdmFuY2UgdGhhdCB3ZSBoYXZlIGVub3VnaCBmcmFtZXMs
IGluc3RlYWQgb2YgYWxsb2NhdGluZw0KKwkgKiBvbmUtYnktb25lLCBmYWlsaW5nIGFuZCBtb3Zp
bmcgZnJhbWVzIHRvIHRoZSBSZXVzZSBSaW5nLg0KKwkgKi8NCisJcmV0dXJuIHhza191bWVtX2hh
c19hZGRyc19ycShycS0+dW1lbSwgY291bnQpOw0KK30NCisNCitpbnQgbWx4NWVfeHNrX3BhZ2Vf
YWxsb2NfdW1lbShzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCSAgICAgIHN0cnVjdCBtbHg1ZV9k
bWFfaW5mbyAqZG1hX2luZm8pDQorew0KKwlzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0gPSBycS0+dW1l
bTsNCisJdTY0IGhhbmRsZTsNCisNCisJaWYgKCF4c2tfdW1lbV9wZWVrX2FkZHJfcnEodW1lbSwg
JmhhbmRsZSkpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJZG1hX2luZm8tPnhzay5oYW5kbGUg
PSBoYW5kbGUgKyBycS0+YnVmZi51bWVtX2hlYWRyb29tOw0KKwlkbWFfaW5mby0+eHNrLmRhdGEg
PSB4ZHBfdW1lbV9nZXRfZGF0YSh1bWVtLCBkbWFfaW5mby0+eHNrLmhhbmRsZSk7DQorDQorCS8q
IE5vIG5lZWQgdG8gYWRkIGhlYWRyb29tIHRvIHRoZSBETUEgYWRkcmVzcy4gSW4gc3RyaWRpbmcg
UlEgY2FzZSwgd2UNCisJICoganVzdCBwcm92aWRlIHBhZ2VzIGZvciBVTVIsIGFuZCBoZWFkcm9v
bSBpcyBjb3VudGVkIGF0IHRoZSBzZXR1cA0KKwkgKiBzdGFnZSB3aGVuIGNyZWF0aW5nIGEgV1FF
LiBJbiBub24tc3RyaWRpbmcgUlEgY2FzZSwgaGVhZHJvb20gaXMNCisJICogYWNjb3VudGVkIGlu
IG1seDVlX2FsbG9jX3J4X3dxZS4NCisJICovDQorCWRtYV9pbmZvLT5hZGRyID0geGRwX3VtZW1f
Z2V0X2RtYSh1bWVtLCBoYW5kbGUpOw0KKw0KKwl4c2tfdW1lbV9kaXNjYXJkX2FkZHJfcnEodW1l
bSk7DQorDQorCWRtYV9zeW5jX3NpbmdsZV9mb3JfZGV2aWNlKHJxLT5wZGV2LCBkbWFfaW5mby0+
YWRkciwgUEFHRV9TSVpFLA0KKwkJCQkgICBETUFfQklESVJFQ1RJT05BTCk7DQorDQorCXJldHVy
biAwOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgbWx4NWVfeHNrX3JlY3ljbGVfZnJhbWUo
c3RydWN0IG1seDVlX3JxICpycSwgdTY0IGhhbmRsZSkNCit7DQorCXhza191bWVtX2ZxX3JldXNl
KHJxLT51bWVtLCBoYW5kbGUgJiBycS0+dW1lbS0+Y2h1bmtfbWFzayk7DQorfQ0KKw0KKy8qIFhT
S1JRIHVzZXMgcGFnZXMgZnJvbSBVTUVNLCB0aGV5IG11c3Qgbm90IGJlIHJlbGVhc2VkLiBUaGV5
IGFyZSByZXR1cm5lZCB0bw0KKyAqIHRoZSB1c2Vyc3BhY2UgaWYgcG9zc2libGUsIGFuZCBpZiBu
b3QsIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHRvIHJldXNlIHRoZW0NCisgKiBpbiB0aGUgZHJp
dmVyLg0KKyAqLw0KK3ZvaWQgbWx4NWVfeHNrX3BhZ2VfcmVsZWFzZShzdHJ1Y3QgbWx4NWVfcnEg
KnJxLA0KKwkJCSAgICBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvKQ0KK3sNCisJbWx4
NWVfeHNrX3JlY3ljbGVfZnJhbWUocnEsIGRtYV9pbmZvLT54c2suaGFuZGxlKTsNCit9DQorDQor
LyogUmV0dXJuIGEgZnJhbWUgYmFjayB0byB0aGUgaGFyZHdhcmUgdG8gZmlsbCBpbiBhZ2Fpbi4g
SXQgaXMgdXNlZCBieSBYRFAgd2hlbg0KKyAqIHRoZSBYRFAgcHJvZ3JhbSByZXR1cm5zIFhEUF9U
WCBvciBYRFBfUkVESVJFQ1Qgbm90IHRvIGFuIFhTS01BUC4NCisgKi8NCit2b2lkIG1seDVlX3hz
a196Y2FfZnJlZShzdHJ1Y3QgemVyb19jb3B5X2FsbG9jYXRvciAqemNhLCB1bnNpZ25lZCBsb25n
IGhhbmRsZSkNCit7DQorCXN0cnVjdCBtbHg1ZV9ycSAqcnEgPSBjb250YWluZXJfb2YoemNhLCBz
dHJ1Y3QgbWx4NWVfcnEsIHpjYSk7DQorDQorCW1seDVlX3hza19yZWN5Y2xlX2ZyYW1lKHJxLCBo
YW5kbGUpOw0KK30NCisNCitzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKm1seDVlX3hza19jb25zdHJ1
Y3Rfc2tiKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHZvaWQgKmRhdGEsDQorCQkJCQkgICAgICAgdTMy
IGNxZV9iY250KQ0KK3sNCisJc3RydWN0IHNrX2J1ZmYgKnNrYjsNCisNCisJc2tiID0gbmFwaV9h
bGxvY19za2IocnEtPmNxLm5hcGksIGNxZV9iY250KTsNCisJaWYgKHVubGlrZWx5KCFza2IpKSB7
DQorCQlycS0+c3RhdHMtPmJ1ZmZfYWxsb2NfZXJyKys7DQorCQlyZXR1cm4gTlVMTDsNCisJfQ0K
Kw0KKwlza2JfcHV0X2RhdGEoc2tiLCBkYXRhLCBjcWVfYmNudCk7DQorDQorCXJldHVybiBza2I7
DQorfQ0KKw0KK3N0cnVjdCBza19idWZmICptbHg1ZV94c2tfc2tiX2Zyb21fY3FlX21wd3JxX2xp
bmVhcihzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQkJCSAgICBzdHJ1Y3QgbWx4NWVfbXB3X2lu
Zm8gKndpLA0KKwkJCQkJCSAgICB1MTYgY3FlX2JjbnQsDQorCQkJCQkJICAgIHUzMiBoZWFkX29m
ZnNldCwNCisJCQkJCQkgICAgdTMyIHBhZ2VfaWR4KQ0KK3sNCisJc3RydWN0IG1seDVlX2RtYV9p
bmZvICpkaSA9ICZ3aS0+dW1yLmRtYV9pbmZvW3BhZ2VfaWR4XTsNCisJdTE2IHJ4X2hlYWRyb29t
ID0gcnEtPmJ1ZmYuaGVhZHJvb20gLSBycS0+YnVmZi51bWVtX2hlYWRyb29tOw0KKwl1MzIgY3Fl
X2JjbnQzMiA9IGNxZV9iY250Ow0KKwl2b2lkICp2YSwgKmRhdGE7DQorCXUzMiBmcmFnX3NpemU7
DQorCWJvb2wgY29uc3VtZWQ7DQorDQorCS8qIENoZWNrIHBhY2tldCBzaXplLiBOb3RlIExSTyBk
b2Vzbid0IHVzZSBsaW5lYXIgU0tCICovDQorCWlmICh1bmxpa2VseShjcWVfYmNudCA+IHJxLT5o
d19tdHUpKSB7DQorCQlycS0+c3RhdHMtPm92ZXJzaXplX3BrdHNfc3dfZHJvcCsrOw0KKwkJcmV0
dXJuIE5VTEw7DQorCX0NCisNCisJLyogaGVhZF9vZmZzZXQgaXMgbm90IHVzZWQgaW4gdGhpcyBm
dW5jdGlvbiwgYmVjYXVzZSBkaS0+eHNrLmRhdGEgYW5kDQorCSAqIGRpLT5hZGRyIHBvaW50IGRp
cmVjdGx5IHRvIHRoZSBuZWNlc3NhcnkgcGxhY2UuIEZ1cnRoZXJtb3JlLCBpbiB0aGUNCisJICog
Y3VycmVudCBpbXBsZW1lbnRhdGlvbiwgb25lIHBhZ2UgPSBvbmUgcGFja2V0ID0gb25lIGZyYW1l
LCBzbw0KKwkgKiBoZWFkX29mZnNldCBzaG91bGQgYWx3YXlzIGJlIDAuDQorCSAqLw0KKwlXQVJO
X09OX09OQ0UoaGVhZF9vZmZzZXQpOw0KKw0KKwl2YSAgICAgICAgICAgICA9IGRpLT54c2suZGF0
YTsNCisJZGF0YSAgICAgICAgICAgPSB2YSArIHJ4X2hlYWRyb29tOw0KKwlmcmFnX3NpemUgICAg
ICA9IHJxLT5idWZmLmhlYWRyb29tICsgY3FlX2JjbnQzMjsNCisNCisJZG1hX3N5bmNfc2luZ2xl
X2Zvcl9jcHUocnEtPnBkZXYsIGRpLT5hZGRyLCBmcmFnX3NpemUsIERNQV9CSURJUkVDVElPTkFM
KTsNCisJcHJlZmV0Y2goZGF0YSk7DQorDQorCXJjdV9yZWFkX2xvY2soKTsNCisJY29uc3VtZWQg
PSBtbHg1ZV94ZHBfaGFuZGxlKHJxLCBkaSwgdmEsICZyeF9oZWFkcm9vbSwgJmNxZV9iY250MzIs
IHRydWUpOw0KKwlyY3VfcmVhZF91bmxvY2soKTsNCisNCisJLyogUG9zc2libGUgZmxvd3M6DQor
CSAqIC0gWERQX1JFRElSRUNUIHRvIFhTS01BUDoNCisJICogICBUaGUgcGFnZSBpcyBvd25lZCBi
eSB0aGUgdXNlcnNwYWNlIGZyb20gbm93Lg0KKwkgKiAtIFhEUF9UWCBhbmQgb3RoZXIgWERQX1JF
RElSRUNUczoNCisJICogICBUaGUgcGFnZSB3YXMgcmV0dXJuZWQgYnkgWkNBIGFuZCByZWN5Y2xl
ZC4NCisJICogLSBYRFBfRFJPUDoNCisJICogICBSZWN5Y2xlIHRoZSBwYWdlLg0KKwkgKiAtIFhE
UF9QQVNTOg0KKwkgKiAgIEFsbG9jYXRlIGFuIFNLQiwgY29weSB0aGUgZGF0YSBhbmQgcmVjeWNs
ZSB0aGUgcGFnZS4NCisJICoNCisJICogUGFnZXMgdG8gYmUgcmVjeWNsZWQgZ28gdG8gdGhlIFJl
dXNlIFJpbmcgb24gTVBXUUUgZGVhbGxvY2F0aW9uLiBJdHMNCisJICogc2l6ZSBpcyB0aGUgc2Ft
ZSBhcyB0aGUgRHJpdmVyIFJYIFJpbmcncyBzaXplLCBhbmQgcGFnZXMgZm9yIFdRRXMgYXJlDQor
CSAqIGFsbG9jYXRlZCBmaXJzdCBmcm9tIHRoZSBSZXVzZSBSaW5nLCBzbyBpdCBoYXMgZW5vdWdo
IHNwYWNlLg0KKwkgKi8NCisNCisJaWYgKGxpa2VseShjb25zdW1lZCkpIHsNCisJCWlmIChsaWtl
bHkoX190ZXN0X2FuZF9jbGVhcl9iaXQoTUxYNUVfUlFfRkxBR19YRFBfWE1JVCwgcnEtPmZsYWdz
KSkpDQorCQkJX19zZXRfYml0KHBhZ2VfaWR4LCB3aS0+eGRwX3htaXRfYml0bWFwKTsgLyogbm9u
LWF0b21pYyAqLw0KKwkJcmV0dXJuIE5VTEw7IC8qIHBhZ2UvcGFja2V0IHdhcyBjb25zdW1lZCBi
eSBYRFAgKi8NCisJfQ0KKw0KKwkvKiBYRFBfUEFTUzogY29weSB0aGUgZGF0YSBmcm9tIHRoZSBV
TUVNIHRvIGEgbmV3IFNLQiBhbmQgcmV1c2UgdGhlDQorCSAqIGZyYW1lLiBPbiBTS0IgYWxsb2Nh
dGlvbiBmYWlsdXJlLCBOVUxMIGlzIHJldHVybmVkLg0KKwkgKi8NCisJcmV0dXJuIG1seDVlX3hz
a19jb25zdHJ1Y3Rfc2tiKHJxLCBkYXRhLCBjcWVfYmNudDMyKTsNCit9DQorDQorc3RydWN0IHNr
X2J1ZmYgKm1seDVlX3hza19za2JfZnJvbV9jcWVfbGluZWFyKHN0cnVjdCBtbHg1ZV9ycSAqcnEs
DQorCQkJCQkgICAgICBzdHJ1Y3QgbWx4NV9jcWU2NCAqY3FlLA0KKwkJCQkJICAgICAgc3RydWN0
IG1seDVlX3dxZV9mcmFnX2luZm8gKndpLA0KKwkJCQkJICAgICAgdTMyIGNxZV9iY250KQ0KK3sN
CisJc3RydWN0IG1seDVlX2RtYV9pbmZvICpkaSA9IHdpLT5kaTsNCisJdTE2IHJ4X2hlYWRyb29t
ID0gcnEtPmJ1ZmYuaGVhZHJvb20gLSBycS0+YnVmZi51bWVtX2hlYWRyb29tOw0KKwl2b2lkICp2
YSwgKmRhdGE7DQorCWJvb2wgY29uc3VtZWQ7DQorCXUzMiBmcmFnX3NpemU7DQorDQorCS8qIHdp
LT5vZmZzZXQgaXMgbm90IHVzZWQgaW4gdGhpcyBmdW5jdGlvbiwgYmVjYXVzZSBkaS0+eHNrLmRh
dGEgYW5kDQorCSAqIGRpLT5hZGRyIHBvaW50IGRpcmVjdGx5IHRvIHRoZSBuZWNlc3NhcnkgcGxh
Y2UuIEZ1cnRoZXJtb3JlLCBpbiB0aGUNCisJICogY3VycmVudCBpbXBsZW1lbnRhdGlvbiwgb25l
IHBhZ2UgPSBvbmUgcGFja2V0ID0gb25lIGZyYW1lLCBzbw0KKwkgKiB3aS0+b2Zmc2V0IHNob3Vs
ZCBhbHdheXMgYmUgMC4NCisJICovDQorCVdBUk5fT05fT05DRSh3aS0+b2Zmc2V0KTsNCisNCisJ
dmEgICAgICAgICAgICAgPSBkaS0+eHNrLmRhdGE7DQorCWRhdGEgICAgICAgICAgID0gdmEgKyBy
eF9oZWFkcm9vbTsNCisJZnJhZ19zaXplICAgICAgPSBycS0+YnVmZi5oZWFkcm9vbSArIGNxZV9i
Y250Ow0KKw0KKwlkbWFfc3luY19zaW5nbGVfZm9yX2NwdShycS0+cGRldiwgZGktPmFkZHIsIGZy
YWdfc2l6ZSwgRE1BX0JJRElSRUNUSU9OQUwpOw0KKwlwcmVmZXRjaChkYXRhKTsNCisNCisJaWYg
KHVubGlrZWx5KGdldF9jcWVfb3Bjb2RlKGNxZSkgIT0gTUxYNV9DUUVfUkVTUF9TRU5EKSkgew0K
KwkJcnEtPnN0YXRzLT53cWVfZXJyKys7DQorCQlyZXR1cm4gTlVMTDsNCisJfQ0KKw0KKwlyY3Vf
cmVhZF9sb2NrKCk7DQorCWNvbnN1bWVkID0gbWx4NWVfeGRwX2hhbmRsZShycSwgZGksIHZhLCAm
cnhfaGVhZHJvb20sICZjcWVfYmNudCwgdHJ1ZSk7DQorCXJjdV9yZWFkX3VubG9jaygpOw0KKw0K
KwlpZiAobGlrZWx5KGNvbnN1bWVkKSkNCisJCXJldHVybiBOVUxMOyAvKiBwYWdlL3BhY2tldCB3
YXMgY29uc3VtZWQgYnkgWERQICovDQorDQorCS8qIFhEUF9QQVNTOiBjb3B5IHRoZSBkYXRhIGZy
b20gdGhlIFVNRU0gdG8gYSBuZXcgU0tCLiBUaGUgZnJhbWUgcmV1c2UNCisJICogd2lsbCBiZSBo
YW5kbGVkIGJ5IG1seDVlX3B1dF9yeF9mcmFnLg0KKwkgKiBPbiBTS0IgYWxsb2NhdGlvbiBmYWls
dXJlLCBOVUxMIGlzIHJldHVybmVkLg0KKwkgKi8NCisJcmV0dXJuIG1seDVlX3hza19jb25zdHJ1
Y3Rfc2tiKHJxLCBkYXRhLCBjcWVfYmNudCk7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguaCBiL2RyaXZlcnMvbmV0L2V0
aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svcnguaA0KbmV3IGZpbGUgbW9kZSAxMDA2
NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uMzA3YjkyM2ExMzYxDQotLS0gL2Rldi9udWxsDQorKysg
Yi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3J4LmgNCkBA
IC0wLDAgKzEsMjcgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBM
aW51eC1PcGVuSUIgKi8NCisvKiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFub3ggVGVjaG5vbG9n
aWVzLiAqLw0KKw0KKyNpZm5kZWYgX19NTFg1X0VOX1hTS19SWF9IX18NCisjZGVmaW5lIF9fTUxY
NV9FTl9YU0tfUlhfSF9fDQorDQorI2luY2x1ZGUgImVuLmgiDQorDQorLyogUlggZGF0YSBwYXRo
ICovDQorDQorYm9vbCBtbHg1ZV94c2tfcGFnZXNfZW5vdWdoX3VtZW0oc3RydWN0IG1seDVlX3Jx
ICpycSwgaW50IGNvdW50KTsNCitpbnQgbWx4NWVfeHNrX3BhZ2VfYWxsb2NfdW1lbShzdHJ1Y3Qg
bWx4NWVfcnEgKnJxLA0KKwkJCSAgICAgIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8p
Ow0KK3ZvaWQgbWx4NWVfeHNrX3BhZ2VfcmVsZWFzZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJ
CSAgICBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvKTsNCit2b2lkIG1seDVlX3hza196
Y2FfZnJlZShzdHJ1Y3QgemVyb19jb3B5X2FsbG9jYXRvciAqemNhLCB1bnNpZ25lZCBsb25nIGhh
bmRsZSk7DQorc3RydWN0IHNrX2J1ZmYgKm1seDVlX3hza19za2JfZnJvbV9jcWVfbXB3cnFfbGlu
ZWFyKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQorCQkJCQkJICAgIHN0cnVjdCBtbHg1ZV9tcHdfaW5m
byAqd2ksDQorCQkJCQkJICAgIHUxNiBjcWVfYmNudCwNCisJCQkJCQkgICAgdTMyIGhlYWRfb2Zm
c2V0LA0KKwkJCQkJCSAgICB1MzIgcGFnZV9pZHgpOw0KK3N0cnVjdCBza19idWZmICptbHg1ZV94
c2tfc2tiX2Zyb21fY3FlX2xpbmVhcihzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQkJICAgICAg
c3RydWN0IG1seDVfY3FlNjQgKmNxZSwNCisJCQkJCSAgICAgIHN0cnVjdCBtbHg1ZV93cWVfZnJh
Z19pbmZvICp3aSwNCisJCQkJCSAgICAgIHUzMiBjcWVfYmNudCk7DQorDQorI2VuZGlmIC8qIF9f
TUxYNV9FTl9YU0tfUlhfSF9fICovDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9zZXR1cC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuL3hzay9zZXR1cC5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0K
aW5kZXggMDAwMDAwMDAwMDAwLi45YjRkNDdjNDdjOTINCi0tLSAvZGV2L251bGwNCisrKyBiL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svc2V0dXAuYw0KQEAg
LTAsMCArMSwyMjMgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBM
aW51eC1PcGVuSUINCisvKiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFub3ggVGVjaG5vbG9naWVz
LiAqLw0KKw0KKyNpbmNsdWRlICJzZXR1cC5oIg0KKyNpbmNsdWRlICJlbi9wYXJhbXMuaCINCisN
Citib29sIG1seDVlX3ZhbGlkYXRlX3hza19wYXJhbShzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJh
bXMsDQorCQkJICAgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNrLA0KKwkJCSAgICAgIHN0
cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2KQ0KK3sNCisJLyogQUZfWERQIGRvZXNuJ3Qgc3VwcG9y
dCBmcmFtZXMgbGFyZ2VyIHRoYW4gUEFHRV9TSVpFLCBhbmQgdGhlIGN1cnJlbnQNCisJICogbWx4
NWUgWERQIGltcGxlbWVudGF0aW9uIGRvZXNuJ3Qgc3VwcG9ydCBtdWx0aXBsZSBwYWNrZXRzIHBl
ciBwYWdlLg0KKwkgKi8NCisJaWYgKHhzay0+Y2h1bmtfc2l6ZSAhPSBQQUdFX1NJWkUpDQorCQly
ZXR1cm4gZmFsc2U7DQorDQorCS8qIEN1cnJlbnQgTVRVIGFuZCBYU0sgaGVhZHJvb20gZG9uJ3Qg
YWxsb3cgcGFja2V0cyB0byBmaXQgdGhlIGZyYW1lcy4gKi8NCisJaWYgKG1seDVlX3J4X2dldF9s
aW5lYXJfZnJhZ19zeihwYXJhbXMsIHhzaykgPiB4c2stPmNodW5rX3NpemUpDQorCQlyZXR1cm4g
ZmFsc2U7DQorDQorCS8qIGZyYWdfc3ogaXMgZGlmZmVyZW50IGZvciByZWd1bGFyIGFuZCBYU0sg
UlFzLCBzbyBlbnN1cmUgdGhhdCBsaW5lYXINCisJICogU0tCIG1vZGUgaXMgcG9zc2libGUuDQor
CSAqLw0KKwlzd2l0Y2ggKHBhcmFtcy0+cnFfd3FfdHlwZSkgew0KKwljYXNlIE1MWDVfV1FfVFlQ
RV9MSU5LRURfTElTVF9TVFJJRElOR19SUToNCisJCXJldHVybiBtbHg1ZV9yeF9tcHdxZV9pc19s
aW5lYXJfc2tiKG1kZXYsIHBhcmFtcywgeHNrKTsNCisJZGVmYXVsdDogLyogTUxYNV9XUV9UWVBF
X0NZQ0xJQyAqLw0KKwkJcmV0dXJuIG1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1zLCB4c2sp
Ow0KKwl9DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3hza2ljb3NxX3BhcmFtKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCQkgICAgICAgdTggbG9nX3dxX3NpemUsDQorCQkJ
CSAgICAgICBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtKQ0KK3sNCisJdm9pZCAqc3FjID0g
cGFyYW0tPnNxYzsNCisJdm9pZCAqd3EgPSBNTFg1X0FERFJfT0Yoc3FjLCBzcWMsIHdxKTsNCisN
CisJbWx4NWVfYnVpbGRfc3FfcGFyYW1fY29tbW9uKHByaXYsIHBhcmFtKTsNCisNCisJTUxYNV9T
RVQod3EsIHdxLCBsb2dfd3Ffc3osIGxvZ193cV9zaXplKTsNCit9DQorDQorc3RhdGljIHZvaWQg
bWx4NWVfYnVpbGRfeHNrX2NwYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkJICAg
c3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfeHNrX3Bh
cmFtICp4c2ssDQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9jaGFubmVsX3BhcmFtICpjcGFyYW0pDQor
ew0KKwljb25zdCB1OCB4c2tpY29zcV9zaXplID0gTUxYNUVfUEFSQU1TX01JTklNVU1fTE9HX1NR
X1NJWkU7DQorDQorCW1seDVlX2J1aWxkX3JxX3BhcmFtKHByaXYsIHBhcmFtcywgeHNrLCAmY3Bh
cmFtLT5ycSk7DQorCW1seDVlX2J1aWxkX3hkcHNxX3BhcmFtKHByaXYsIHBhcmFtcywgJmNwYXJh
bS0+eGRwX3NxKTsNCisJbWx4NWVfYnVpbGRfeHNraWNvc3FfcGFyYW0ocHJpdiwgeHNraWNvc3Ff
c2l6ZSwgJmNwYXJhbS0+aWNvc3EpOw0KKwltbHg1ZV9idWlsZF9yeF9jcV9wYXJhbShwcml2LCBw
YXJhbXMsIHhzaywgJmNwYXJhbS0+cnhfY3EpOw0KKwltbHg1ZV9idWlsZF90eF9jcV9wYXJhbShw
cml2LCBwYXJhbXMsICZjcGFyYW0tPnR4X2NxKTsNCisJbWx4NWVfYnVpbGRfaWNvX2NxX3BhcmFt
KHByaXYsIHhza2ljb3NxX3NpemUsICZjcGFyYW0tPmljb3NxX2NxKTsNCit9DQorDQoraW50IG1s
eDVlX29wZW5feHNrKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfcGFyYW1z
ICpwYXJhbXMsDQorCQkgICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2ssIHN0cnVjdCB4ZHBf
dW1lbSAqdW1lbSwNCisJCSAgIHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0KK3sNCisJc3RydWN0
IG1seDVlX2NoYW5uZWxfcGFyYW0gY3BhcmFtID0ge307DQorCXN0cnVjdCBuZXRfZGltX2NxX21v
ZGVyIGljb2NxX21vZGVyID0ge307DQorCWludCBlcnI7DQorDQorCWlmICghbWx4NWVfdmFsaWRh
dGVfeHNrX3BhcmFtKHBhcmFtcywgeHNrLCBwcml2LT5tZGV2KSkNCisJCXJldHVybiAtRUlOVkFM
Ow0KKw0KKwltbHg1ZV9idWlsZF94c2tfY3BhcmFtKHByaXYsIHBhcmFtcywgeHNrLCAmY3BhcmFt
KTsNCisNCisJZXJyID0gbWx4NWVfb3Blbl9jcShjLCBwYXJhbXMtPnJ4X2NxX21vZGVyYXRpb24s
ICZjcGFyYW0ucnhfY3EsICZjLT54c2tycS5jcSk7DQorCWlmICh1bmxpa2VseShlcnIpKQ0KKwkJ
cmV0dXJuIGVycjsNCisNCisJZXJyID0gbWx4NWVfb3Blbl9ycShjLCBwYXJhbXMsICZjcGFyYW0u
cnEsIHhzaywgdW1lbSwgJmMtPnhza3JxKTsNCisJaWYgKHVubGlrZWx5KGVycikpDQorCQlnb3Rv
IGVycl9jbG9zZV9yeF9jcTsNCisNCisJZXJyID0gbWx4NWVfb3Blbl9jcShjLCBwYXJhbXMtPnR4
X2NxX21vZGVyYXRpb24sICZjcGFyYW0udHhfY3EsICZjLT54c2tzcS5jcSk7DQorCWlmICh1bmxp
a2VseShlcnIpKQ0KKwkJZ290byBlcnJfY2xvc2VfcnE7DQorDQorCS8qIENyZWF0ZSBhIHNlcGFy
YXRlIFNRLCBzbyB0aGF0IHdoZW4gdGhlIFVNRU0gaXMgZGlzYWJsZWQsIHdlIGNvdWxkDQorCSAq
IGNsb3NlIHRoaXMgU1Egc2FmZWx5IGFuZCBzdG9wIHJlY2VpdmluZyBDUUVzLiBJbiBvdGhlciBj
YXNlLCBlLmcuLCBpZg0KKwkgKiB0aGUgWERQU1Egd2FzIHVzZWQgaW5zdGVhZCwgd2UgbWlnaHQg
cnVuIGludG8gdHJvdWJsZSB3aGVuIHRoZSBVTUVNDQorCSAqIGlzIGRpc2FibGVkIGFuZCB0aGVu
IHJlZW5hYmxlZCwgYnV0IHRoZSBTUSBjb250aW51ZXMgcmVjZWl2aW5nIENRRXMNCisJICogZnJv
bSB0aGUgb2xkIFVNRU0uDQorCSAqLw0KKwllcnIgPSBtbHg1ZV9vcGVuX3hkcHNxKGMsIHBhcmFt
cywgJmNwYXJhbS54ZHBfc3EsIHVtZW0sICZjLT54c2tzcSwgdHJ1ZSk7DQorCWlmICh1bmxpa2Vs
eShlcnIpKQ0KKwkJZ290byBlcnJfY2xvc2VfdHhfY3E7DQorDQorCWVyciA9IG1seDVlX29wZW5f
Y3EoYywgaWNvY3FfbW9kZXIsICZjcGFyYW0uaWNvc3FfY3EsICZjLT54c2tpY29zcS5jcSk7DQor
CWlmICh1bmxpa2VseShlcnIpKQ0KKwkJZ290byBlcnJfY2xvc2Vfc3E7DQorDQorCS8qIENyZWF0
ZSBhIGRlZGljYXRlZCBTUSBmb3IgcG9zdGluZyBOT1BzIHdoZW5ldmVyIHdlIG5lZWQgYW4gSVJR
IHRvIGJlDQorCSAqIHRyaWdnZXJlZCBhbmQgTkFQSSB0byBiZSBjYWxsZWQgb24gdGhlIGNvcnJl
Y3QgQ1BVLg0KKwkgKi8NCisJZXJyID0gbWx4NWVfb3Blbl9pY29zcShjLCBwYXJhbXMsICZjcGFy
YW0uaWNvc3EsICZjLT54c2tpY29zcSk7DQorCWlmICh1bmxpa2VseShlcnIpKQ0KKwkJZ290byBl
cnJfY2xvc2VfaWNvY3E7DQorDQorCXNwaW5fbG9ja19pbml0KCZjLT54c2tpY29zcV9sb2NrKTsN
CisNCisJc2V0X2JpdChNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywgYy0+c3RhdGUpOw0KKw0KKwly
ZXR1cm4gMDsNCisNCitlcnJfY2xvc2VfaWNvY3E6DQorCW1seDVlX2Nsb3NlX2NxKCZjLT54c2tp
Y29zcS5jcSk7DQorDQorZXJyX2Nsb3NlX3NxOg0KKwltbHg1ZV9jbG9zZV94ZHBzcSgmYy0+eHNr
c3EpOw0KKw0KK2Vycl9jbG9zZV90eF9jcToNCisJbWx4NWVfY2xvc2VfY3EoJmMtPnhza3NxLmNx
KTsNCisNCitlcnJfY2xvc2VfcnE6DQorCW1seDVlX2Nsb3NlX3JxKCZjLT54c2tycSk7DQorDQor
ZXJyX2Nsb3NlX3J4X2NxOg0KKwltbHg1ZV9jbG9zZV9jcSgmYy0+eHNrcnEuY3EpOw0KKw0KKwly
ZXR1cm4gZXJyOw0KK30NCisNCit2b2lkIG1seDVlX2Nsb3NlX3hzayhzdHJ1Y3QgbWx4NWVfY2hh
bm5lbCAqYykNCit7DQorCWNsZWFyX2JpdChNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywgYy0+c3Rh
dGUpOw0KKwluYXBpX3N5bmNocm9uaXplKCZjLT5uYXBpKTsNCisNCisJbWx4NWVfY2xvc2VfcnEo
JmMtPnhza3JxKTsNCisJbWx4NWVfY2xvc2VfY3EoJmMtPnhza3JxLmNxKTsNCisJbWx4NWVfY2xv
c2VfaWNvc3EoJmMtPnhza2ljb3NxKTsNCisJbWx4NWVfY2xvc2VfY3EoJmMtPnhza2ljb3NxLmNx
KTsNCisJbWx4NWVfY2xvc2VfeGRwc3EoJmMtPnhza3NxKTsNCisJbWx4NWVfY2xvc2VfY3EoJmMt
Pnhza3NxLmNxKTsNCit9DQorDQordm9pZCBtbHg1ZV9hY3RpdmF0ZV94c2soc3RydWN0IG1seDVl
X2NoYW5uZWwgKmMpDQorew0KKwlzZXRfYml0KE1MWDVFX1JRX1NUQVRFX0VOQUJMRUQsICZjLT54
c2tycS5zdGF0ZSk7DQorCS8qIFRYIHF1ZXVlIGlzIGNyZWF0ZWQgYWN0aXZlLiAqLw0KKwltbHg1
ZV90cmlnZ2VyX2lycSgmYy0+eHNraWNvc3EpOw0KK30NCisNCit2b2lkIG1seDVlX2RlYWN0aXZh
dGVfeHNrKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0KK3sNCisJbWx4NWVfZGVhY3RpdmF0ZV9y
cSgmYy0+eHNrcnEpOw0KKwkvKiBUWCBxdWV1ZSBpcyBkaXNhYmxlZCBvbiBjbG9zZS4gKi8NCit9
DQorDQorc3RhdGljIGludCBtbHg1ZV9yZWRpcmVjdF94c2tfcnF0KHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2LCB1MTYgaXgsIHUzMiBycW4pDQorew0KKwlzdHJ1Y3QgbWx4NWVfcmVkaXJlY3RfcnF0
X3BhcmFtIGRpcmVjdF9ycnAgPSB7DQorCQkuaXNfcnNzID0gZmFsc2UsDQorCQl7DQorCQkJLnJx
biA9IHJxbiwNCisJCX0sDQorCX07DQorDQorCXUzMiBycXRuID0gcHJpdi0+eHNrX3RpcltpeF0u
cnF0LnJxdG47DQorDQorCXJldHVybiBtbHg1ZV9yZWRpcmVjdF9ycXQocHJpdiwgcnF0biwgMSwg
ZGlyZWN0X3JycCk7DQorfQ0KKw0KK2ludCBtbHg1ZV94c2tfcmVkaXJlY3RfcnF0X3RvX2NoYW5u
ZWwoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKQ0KK3sN
CisJcmV0dXJuIG1seDVlX3JlZGlyZWN0X3hza19ycXQocHJpdiwgYy0+aXgsIGMtPnhza3JxLnJx
bik7DQorfQ0KKw0KK2ludCBtbHg1ZV94c2tfcmVkaXJlY3RfcnF0X3RvX2Ryb3Aoc3RydWN0IG1s
eDVlX3ByaXYgKnByaXYsIHUxNiBpeCkNCit7DQorCXJldHVybiBtbHg1ZV9yZWRpcmVjdF94c2tf
cnF0KHByaXYsIGl4LCBwcml2LT5kcm9wX3JxLnJxbik7DQorfQ0KKw0KK2ludCBtbHg1ZV94c2tf
cmVkaXJlY3RfcnF0c190b19jaGFubmVscyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0
IG1seDVlX2NoYW5uZWxzICpjaHMpDQorew0KKwlpbnQgZXJyLCBpOw0KKw0KKwlpZiAoIXByaXYt
Pnhzay5yZWZjbnQpDQorCQlyZXR1cm4gMDsNCisNCisJZm9yIChpID0gMDsgaSA8IGNocy0+bnVt
OyBpKyspIHsNCisJCXN0cnVjdCBtbHg1ZV9jaGFubmVsICpjID0gY2hzLT5jW2ldOw0KKw0KKwkJ
aWYgKCF0ZXN0X2JpdChNTFg1RV9DSEFOTkVMX1NUQVRFX1hTSywgYy0+c3RhdGUpKQ0KKwkJCWNv
bnRpbnVlOw0KKw0KKwkJZXJyID0gbWx4NWVfeHNrX3JlZGlyZWN0X3JxdF90b19jaGFubmVsKHBy
aXYsIGMpOw0KKwkJaWYgKHVubGlrZWx5KGVycikpDQorCQkJZ290byBlcnJfc3RvcDsNCisJfQ0K
Kw0KKwlyZXR1cm4gMDsNCisNCitlcnJfc3RvcDoNCisJZm9yIChpLS07IGkgPj0gMDsgaS0tKSB7
DQorCQlpZiAoIXRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjaHMtPmNbaV0tPnN0
YXRlKSkNCisJCQljb250aW51ZTsNCisNCisJCW1seDVlX3hza19yZWRpcmVjdF9ycXRfdG9fZHJv
cChwcml2LCBpKTsNCisJfQ0KKw0KKwlyZXR1cm4gZXJyOw0KK30NCisNCit2b2lkIG1seDVlX3hz
a19yZWRpcmVjdF9ycXRzX3RvX2Ryb3Aoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBt
bHg1ZV9jaGFubmVscyAqY2hzKQ0KK3sNCisJaW50IGk7DQorDQorCWlmICghcHJpdi0+eHNrLnJl
ZmNudCkNCisJCXJldHVybjsNCisNCisJZm9yIChpID0gMDsgaSA8IGNocy0+bnVtOyBpKyspIHsN
CisJCWlmICghdGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGNocy0+Y1tpXS0+c3Rh
dGUpKQ0KKwkJCWNvbnRpbnVlOw0KKw0KKwkJbWx4NWVfeHNrX3JlZGlyZWN0X3JxdF90b19kcm9w
KHByaXYsIGkpOw0KKwl9DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbi94c2svc2V0dXAuaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21l
bGxhbm94L21seDUvY29yZS9lbi94c2svc2V0dXAuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmlu
ZGV4IDAwMDAwMDAwMDAwMC4uMGRkMTFiODFjMDQ2DQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2
ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3NldHVwLmgNCkBAIC0w
LDAgKzEsMjUgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51
eC1PcGVuSUIgKi8NCisvKiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFub3ggVGVjaG5vbG9naWVz
LiAqLw0KKw0KKyNpZm5kZWYgX19NTFg1X0VOX1hTS19TRVRVUF9IX18NCisjZGVmaW5lIF9fTUxY
NV9FTl9YU0tfU0VUVVBfSF9fDQorDQorI2luY2x1ZGUgImVuLmgiDQorDQorc3RydWN0IG1seDVl
X3hza19wYXJhbTsNCisNCitib29sIG1seDVlX3ZhbGlkYXRlX3hza19wYXJhbShzdHJ1Y3QgbWx4
NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICAgICAgc3RydWN0IG1seDVlX3hza19wYXJhbSAqeHNr
LA0KKwkJCSAgICAgIHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2KTsNCitpbnQgbWx4NWVfb3Bl
bl94c2soc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFt
cywNCisJCSAgIHN0cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywgc3RydWN0IHhkcF91bWVtICp1
bWVtLA0KKwkJICAgc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpOw0KK3ZvaWQgbWx4NWVfY2xvc2Vf
eHNrKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjKTsNCit2b2lkIG1seDVlX2FjdGl2YXRlX3hzayhz
dHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYyk7DQordm9pZCBtbHg1ZV9kZWFjdGl2YXRlX3hzayhzdHJ1
Y3QgbWx4NWVfY2hhbm5lbCAqYyk7DQoraW50IG1seDVlX3hza19yZWRpcmVjdF9ycXRfdG9fY2hh
bm5lbChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpOw0K
K2ludCBtbHg1ZV94c2tfcmVkaXJlY3RfcnF0X3RvX2Ryb3Aoc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsIHUxNiBpeCk7DQoraW50IG1seDVlX3hza19yZWRpcmVjdF9ycXRzX3RvX2NoYW5uZWxzKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgKmNocyk7DQordm9p
ZCBtbHg1ZV94c2tfcmVkaXJlY3RfcnF0c190b19kcm9wKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
LCBzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgKmNocyk7DQorDQorI2VuZGlmIC8qIF9fTUxYNV9FTl9Y
U0tfU0VUVVBfSF9fICovDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuL3hzay90eC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gv
bWx4NS9jb3JlL2VuL3hzay90eC5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAw
MDAwMDAwLi45YTcyYjU5ODM5YmENCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvbmV0L2V0
aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdHguYw0KQEAgLTAsMCArMSwxMDggQEAN
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51eC1PcGVuSUINCisv
KiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFub3ggVGVjaG5vbG9naWVzLiAqLw0KKw0KKyNpbmNs
dWRlICJ0eC5oIg0KKyNpbmNsdWRlICJ1bWVtLmgiDQorI2luY2x1ZGUgImVuL3hkcC5oIg0KKyNp
bmNsdWRlIDxuZXQveGRwX3NvY2suaD4NCisNCitpbnQgbWx4NWVfeHNrX2FzeW5jX3htaXQoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwgdTMyIHFpZCkNCit7DQorCXN0cnVjdCBtbHg1ZV9wcml2ICpw
cml2ID0gbmV0ZGV2X3ByaXYoZGV2KTsNCisJc3RydWN0IG1seDVlX2NoYW5uZWwgKmM7DQorDQor
CWlmICh1bmxpa2VseSghbWx4NWVfeGRwX2lzX29wZW4ocHJpdikpKQ0KKwkJcmV0dXJuIC1FTkVU
RE9XTjsNCisNCisJaWYgKHVubGlrZWx5KCFtbHg1ZV94c2tfaXNfdmFsaWRfcWlkKHByaXYsIHFp
ZCkpKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCWMgPSBwcml2LT5jaGFubmVscy5jW3FpZF07
DQorDQorCWlmICh1bmxpa2VseSghdGVzdF9iaXQoTUxYNUVfQ0hBTk5FTF9TVEFURV9YU0ssIGMt
PnN0YXRlKSkpDQorCQlyZXR1cm4gLUVOWElPOw0KKw0KKwlpZiAoIW5hcGlfaWZfc2NoZWR1bGVk
X21hcmtfbWlzc2VkKCZjLT5uYXBpKSkgew0KKwkJc3Bpbl9sb2NrKCZjLT54c2tpY29zcV9sb2Nr
KTsNCisJCW1seDVlX3RyaWdnZXJfaXJxKCZjLT54c2tpY29zcSk7DQorCQlzcGluX3VubG9jaygm
Yy0+eHNraWNvc3FfbG9jayk7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KKy8qIFdoZW4g
VFggZmFpbHMgKGJlY2F1c2Ugb2YgdGhlIHNpemUgb2YgdGhlIHBhY2tldCksIHdlIG5lZWQgdG8g
Z2V0IGNvbXBsZXRpb25zDQorICogaW4gb3JkZXIsIHNvIHBvc3QgYSBOT1AgdG8gZ2V0IGEgQ1FF
LiBTaW5jZSBBRl9YRFAgZG9lc24ndCBkaXN0aW5ndWlzaA0KKyAqIGJldHdlZW4gc3VjY2Vzc2Z1
bCBUWCBhbmQgZXJyb3JzLCBoYW5kbGluZyBpbiBtbHg1ZV9wb2xsX3hkcHNxX2NxIGlzIHRoZQ0K
KyAqIHNhbWUuDQorICovDQorc3RhdGljIHZvaWQgbWx4NWVfeHNrX3R4X3Bvc3RfZXJyKHN0cnVj
dCBtbHg1ZV94ZHBzcSAqc3EsDQorCQkJCSAgc3RydWN0IG1seDVlX3hkcF9pbmZvICp4ZHBpKQ0K
K3sNCisJdTE2IHBpID0gbWx4NV93cV9jeWNfY3RyMml4KCZzcS0+d3EsIHNxLT5wYyk7DQorCXN0
cnVjdCBtbHg1ZV94ZHBfd3FlX2luZm8gKndpID0gJnNxLT5kYi53cWVfaW5mb1twaV07DQorCXN0
cnVjdCBtbHg1ZV90eF93cWUgKm5vcHdxZTsNCisNCisJd2ktPm51bV93cWViYnMgPSAxOw0KKwl3
aS0+bnVtX3BrdHMgPSAxOw0KKw0KKwlub3B3cWUgPSBtbHg1ZV9wb3N0X25vcCgmc3EtPndxLCBz
cS0+c3FuLCAmc3EtPnBjKTsNCisJbWx4NWVfeGRwaV9maWZvX3B1c2goJnNxLT5kYi54ZHBpX2Zp
Zm8sIHhkcGkpOw0KKwlzcS0+ZG9vcmJlbGxfY3NlZyA9ICZub3B3cWUtPmN0cmw7DQorfQ0KKw0K
K2Jvb2wgbWx4NWVfeHNrX3R4KHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsIHVuc2lnbmVkIGludCBi
dWRnZXQpDQorew0KKwlzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0gPSBzcS0+dW1lbTsNCisJc3RydWN0
IG1seDVlX3hkcF9pbmZvIHhkcGk7DQorCXN0cnVjdCBtbHg1ZV94ZHBfeG1pdF9kYXRhIHhkcHR4
ZDsNCisJYm9vbCB3b3JrX2RvbmUgPSB0cnVlOw0KKwlib29sIGZsdXNoID0gZmFsc2U7DQorDQor
CXhkcGkubW9kZSA9IE1MWDVFX1hEUF9YTUlUX01PREVfWFNLOw0KKw0KKwlmb3IgKDsgYnVkZ2V0
OyBidWRnZXQtLSkgew0KKwkJaW50IGNoZWNrX3Jlc3VsdCA9IHNxLT54bWl0X3hkcF9mcmFtZV9j
aGVjayhzcSk7DQorCQlzdHJ1Y3QgeGRwX2Rlc2MgZGVzYzsNCisNCisJCWlmICh1bmxpa2VseShj
aGVja19yZXN1bHQgPCAwKSkgew0KKwkJCXdvcmtfZG9uZSA9IGZhbHNlOw0KKwkJCWJyZWFrOw0K
KwkJfQ0KKw0KKwkJaWYgKCF4c2tfdW1lbV9jb25zdW1lX3R4KHVtZW0sICZkZXNjKSkgew0KKwkJ
CS8qIFRYIHdpbGwgZ2V0IHN0dWNrIHVudGlsIHNvbWV0aGluZyB3YWtlcyBpdCB1cCBieQ0KKwkJ
CSAqIHRyaWdnZXJpbmcgTkFQSS4gQ3VycmVudGx5IGl0J3MgZXhwZWN0ZWQgdGhhdCB0aGUNCisJ
CQkgKiBhcHBsaWNhdGlvbiBjYWxscyBzZW5kdG8oKSBpZiB0aGVyZSBhcmUgY29uc3VtZWQsIGJ1
dA0KKwkJCSAqIG5vdCBjb21wbGV0ZWQgZnJhbWVzLg0KKwkJCSAqLw0KKwkJCWJyZWFrOw0KKwkJ
fQ0KKw0KKwkJeGRwdHhkLmRtYV9hZGRyID0geGRwX3VtZW1fZ2V0X2RtYSh1bWVtLCBkZXNjLmFk
ZHIpOw0KKwkJeGRwdHhkLmRhdGEgPSB4ZHBfdW1lbV9nZXRfZGF0YSh1bWVtLCBkZXNjLmFkZHIp
Ow0KKwkJeGRwdHhkLmxlbiA9IGRlc2MubGVuOw0KKw0KKwkJZG1hX3N5bmNfc2luZ2xlX2Zvcl9k
ZXZpY2Uoc3EtPnBkZXYsIHhkcHR4ZC5kbWFfYWRkciwNCisJCQkJCSAgIHhkcHR4ZC5sZW4sIERN
QV9CSURJUkVDVElPTkFMKTsNCisNCisJCWlmICh1bmxpa2VseSghc3EtPnhtaXRfeGRwX2ZyYW1l
KHNxLCAmeGRwdHhkLCAmeGRwaSwgY2hlY2tfcmVzdWx0KSkpIHsNCisJCQlpZiAoc3EtPm1wd3Fl
LndxZSkNCisJCQkJbWx4NWVfeGRwX21wd3FlX2NvbXBsZXRlKHNxKTsNCisNCisJCQltbHg1ZV94
c2tfdHhfcG9zdF9lcnIoc3EsICZ4ZHBpKTsNCisJCX0NCisNCisJCWZsdXNoID0gdHJ1ZTsNCisJ
fQ0KKw0KKwlpZiAoZmx1c2gpIHsNCisJCWlmIChzcS0+bXB3cWUud3FlKQ0KKwkJCW1seDVlX3hk
cF9tcHdxZV9jb21wbGV0ZShzcSk7DQorCQltbHg1ZV94bWl0X3hkcF9kb29yYmVsbChzcSk7DQor
DQorCQl4c2tfdW1lbV9jb25zdW1lX3R4X2RvbmUodW1lbSk7DQorCX0NCisNCisJcmV0dXJuICEo
YnVkZ2V0ICYmIHdvcmtfZG9uZSk7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdHguaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0
L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdHguaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmlu
ZGV4IDAwMDAwMDAwMDAwMC4uN2FkZDE4YmY3OGQ4DQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2
ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3R4LmgNCkBAIC0wLDAg
KzEsMTUgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51eC1P
cGVuSUIgKi8NCisvKiBDb3B5cmlnaHQgKGMpIDIwMTkgTWVsbGFub3ggVGVjaG5vbG9naWVzLiAq
Lw0KKw0KKyNpZm5kZWYgX19NTFg1X0VOX1hTS19UWF9IX18NCisjZGVmaW5lIF9fTUxYNV9FTl9Y
U0tfVFhfSF9fDQorDQorI2luY2x1ZGUgImVuLmgiDQorDQorLyogVFggZGF0YSBwYXRoICovDQor
DQoraW50IG1seDVlX3hza19hc3luY194bWl0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHUzMiBx
aWQpOw0KKw0KK2Jvb2wgbWx4NWVfeHNrX3R4KHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsIHVuc2ln
bmVkIGludCBidWRnZXQpOw0KKw0KKyNlbmRpZiAvKiBfX01MWDVfRU5fWFNLX1RYX0hfXyAqLw0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94
c2svdW1lbS5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuL3hz
ay91bWVtLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmM5OTE3
YzU3ZjA1NA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuL3hzay91bWVtLmMNCkBAIC0wLDAgKzEsMjUyIEBADQorLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgT1IgTGludXgtT3BlbklCDQorLyogQ29weXJpZ2h0
IChjKSAyMDE5IE1lbGxhbm94IFRlY2hub2xvZ2llcy4gKi8NCisNCisjaW5jbHVkZSA8bmV0L3hk
cF9zb2NrLmg+DQorI2luY2x1ZGUgInVtZW0uaCINCisjaW5jbHVkZSAic2V0dXAuaCINCisjaW5j
bHVkZSAiZW4vcGFyYW1zLmgiDQorDQorc3RhdGljIGludCBtbHg1ZV94c2tfbWFwX3VtZW0oc3Ry
dWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJICAgICAgc3RydWN0IHhkcF91bWVtICp1bWVtKQ0K
K3sNCisJc3RydWN0IGRldmljZSAqZGV2ID0gcHJpdi0+bWRldi0+ZGV2aWNlOw0KKwl1MzIgaTsN
CisNCisJZm9yIChpID0gMDsgaSA8IHVtZW0tPm5wZ3M7IGkrKykgew0KKwkJZG1hX2FkZHJfdCBk
bWEgPSBkbWFfbWFwX3BhZ2UoZGV2LCB1bWVtLT5wZ3NbaV0sIDAsIFBBR0VfU0laRSwNCisJCQkJ
CSAgICAgIERNQV9CSURJUkVDVElPTkFMKTsNCisNCisJCWlmICh1bmxpa2VseShkbWFfbWFwcGlu
Z19lcnJvcihkZXYsIGRtYSkpKQ0KKwkJCWdvdG8gZXJyX3VubWFwOw0KKwkJdW1lbS0+cGFnZXNb
aV0uZG1hID0gZG1hOw0KKwl9DQorDQorCXJldHVybiAwOw0KKw0KK2Vycl91bm1hcDoNCisJd2hp
bGUgKGktLSkgew0KKwkJZG1hX3VubWFwX3BhZ2UoZGV2LCB1bWVtLT5wYWdlc1tpXS5kbWEsIFBB
R0VfU0laRSwNCisJCQkgICAgICAgRE1BX0JJRElSRUNUSU9OQUwpOw0KKwkJdW1lbS0+cGFnZXNb
aV0uZG1hID0gMDsNCisJfQ0KKw0KKwlyZXR1cm4gLUVOT01FTTsNCit9DQorDQorc3RhdGljIHZv
aWQgbWx4NWVfeHNrX3VubWFwX3VtZW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJCSBz
dHJ1Y3QgeGRwX3VtZW0gKnVtZW0pDQorew0KKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBwcml2LT5t
ZGV2LT5kZXZpY2U7DQorCXUzMiBpOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgdW1lbS0+bnBnczsg
aSsrKSB7DQorCQlkbWFfdW5tYXBfcGFnZShkZXYsIHVtZW0tPnBhZ2VzW2ldLmRtYSwgUEFHRV9T
SVpFLA0KKwkJCSAgICAgICBETUFfQklESVJFQ1RJT05BTCk7DQorCQl1bWVtLT5wYWdlc1tpXS5k
bWEgPSAwOw0KKwl9DQorfQ0KKw0KK3N0YXRpYyBpbnQgbWx4NWVfeHNrX2dldF91bWVtcyhzdHJ1
Y3QgbWx4NWVfeHNrICp4c2spDQorew0KKwlpZiAoIXhzay0+dW1lbXMpIHsNCisJCXhzay0+dW1l
bXMgPSBrY2FsbG9jKE1MWDVFX01BWF9OVU1fQ0hBTk5FTFMsDQorCQkJCSAgICAgc2l6ZW9mKCp4
c2stPnVtZW1zKSwgR0ZQX0tFUk5FTCk7DQorCQlpZiAodW5saWtlbHkoIXhzay0+dW1lbXMpKQ0K
KwkJCXJldHVybiAtRU5PTUVNOw0KKwl9DQorDQorCXhzay0+cmVmY250Kys7DQorCXhzay0+ZXZl
cl91c2VkID0gdHJ1ZTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1seDVl
X3hza19wdXRfdW1lbXMoc3RydWN0IG1seDVlX3hzayAqeHNrKQ0KK3sNCisJaWYgKCEtLXhzay0+
cmVmY250KSB7DQorCQlrZnJlZSh4c2stPnVtZW1zKTsNCisJCXhzay0+dW1lbXMgPSBOVUxMOw0K
Kwl9DQorfQ0KKw0KK3N0YXRpYyBpbnQgbWx4NWVfeHNrX2FkZF91bWVtKHN0cnVjdCBtbHg1ZV94
c2sgKnhzaywgc3RydWN0IHhkcF91bWVtICp1bWVtLCB1MTYgaXgpDQorew0KKwlpbnQgZXJyOw0K
Kw0KKwllcnIgPSBtbHg1ZV94c2tfZ2V0X3VtZW1zKHhzayk7DQorCWlmICh1bmxpa2VseShlcnIp
KQ0KKwkJcmV0dXJuIGVycjsNCisNCisJeHNrLT51bWVtc1tpeF0gPSB1bWVtOw0KKwlyZXR1cm4g
MDsNCit9DQorDQorc3RhdGljIHZvaWQgbWx4NWVfeHNrX3JlbW92ZV91bWVtKHN0cnVjdCBtbHg1
ZV94c2sgKnhzaywgdTE2IGl4KQ0KK3sNCisJeHNrLT51bWVtc1tpeF0gPSBOVUxMOw0KKw0KKwlt
bHg1ZV94c2tfcHV0X3VtZW1zKHhzayk7DQorfQ0KKw0KK3N0YXRpYyBib29sIG1seDVlX3hza19p
c191bWVtX3NhbmUoc3RydWN0IHhkcF91bWVtICp1bWVtKQ0KK3sNCisJcmV0dXJuIHVtZW0tPmhl
YWRyb29tIDw9IDB4ZmZmZiAmJiB1bWVtLT5jaHVua19zaXplX25vaHIgPD0gMHhmZmZmOw0KK30N
CisNCit2b2lkIG1seDVlX2J1aWxkX3hza19wYXJhbShzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sIHN0
cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaykNCit7DQorCXhzay0+aGVhZHJvb20gPSB1bWVtLT5o
ZWFkcm9vbTsNCisJeHNrLT5jaHVua19zaXplID0gdW1lbS0+Y2h1bmtfc2l6ZV9ub2hyICsgdW1l
bS0+aGVhZHJvb207DQorfQ0KKw0KK3N0YXRpYyBpbnQgbWx4NWVfeHNrX2VuYWJsZV9sb2NrZWQo
c3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJCSAgIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwg
dTE2IGl4KQ0KK3sNCisJc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zID0gJnByaXYtPmNoYW5u
ZWxzLnBhcmFtczsNCisJc3RydWN0IG1seDVlX3hza19wYXJhbSB4c2s7DQorCXN0cnVjdCBtbHg1
ZV9jaGFubmVsICpjOw0KKwlpbnQgZXJyOw0KKw0KKwlpZiAodW5saWtlbHkobWx4NWVfeHNrX2dl
dF91bWVtKCZwcml2LT5jaGFubmVscy5wYXJhbXMsICZwcml2LT54c2ssIGl4KSkpDQorCQlyZXR1
cm4gLUVCVVNZOw0KKw0KKwlpZiAodW5saWtlbHkoIW1seDVlX3hza19pc191bWVtX3NhbmUodW1l
bSkpKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCWVyciA9IG1seDVlX3hza19tYXBfdW1lbShw
cml2LCB1bWVtKTsNCisJaWYgKHVubGlrZWx5KGVycikpDQorCQlyZXR1cm4gZXJyOw0KKw0KKwll
cnIgPSBtbHg1ZV94c2tfYWRkX3VtZW0oJnByaXYtPnhzaywgdW1lbSwgaXgpOw0KKwlpZiAodW5s
aWtlbHkoZXJyKSkNCisJCWdvdG8gZXJyX3VubWFwX3VtZW07DQorDQorCW1seDVlX2J1aWxkX3hz
a19wYXJhbSh1bWVtLCAmeHNrKTsNCisNCisJaWYgKCF0ZXN0X2JpdChNTFg1RV9TVEFURV9PUEVO
RUQsICZwcml2LT5zdGF0ZSkpIHsNCisJCS8qIFhTSyBvYmplY3RzIHdpbGwgYmUgY3JlYXRlZCBv
biBvcGVuLiAqLw0KKwkJZ290byB2YWxpZGF0ZV9jbG9zZWQ7DQorCX0NCisNCisJaWYgKCFwYXJh
bXMtPnhkcF9wcm9nKSB7DQorCQkvKiBYU0sgb2JqZWN0cyB3aWxsIGJlIGNyZWF0ZWQgd2hlbiBh
biBYRFAgcHJvZ3JhbSBpcyBzZXQsDQorCQkgKiBhbmQgdGhlIGNoYW5uZWxzIGFyZSByZW9wZW5l
ZC4NCisJCSAqLw0KKwkJZ290byB2YWxpZGF0ZV9jbG9zZWQ7DQorCX0NCisNCisJYyA9IHByaXYt
PmNoYW5uZWxzLmNbaXhdOw0KKw0KKwllcnIgPSBtbHg1ZV9vcGVuX3hzayhwcml2LCBwYXJhbXMs
ICZ4c2ssIHVtZW0sIGMpOw0KKwlpZiAodW5saWtlbHkoZXJyKSkNCisJCWdvdG8gZXJyX3JlbW92
ZV91bWVtOw0KKw0KKwltbHg1ZV9hY3RpdmF0ZV94c2soYyk7DQorDQorCS8qIERvbid0IHdhaXQg
Zm9yIFdRRXMsIGJlY2F1c2UgdGhlIG5ld2VyIHhkcHNvY2sgc2FtcGxlIGRvZXNuJ3QgcHJvdmlk
ZQ0KKwkgKiBhbnkgRmlsbCBSaW5nIGVudHJpZXMgYXQgdGhlIHNldHVwIHN0YWdlLg0KKwkgKi8N
CisNCisJZXJyID0gbWx4NWVfeHNrX3JlZGlyZWN0X3JxdF90b19jaGFubmVsKHByaXYsIHByaXYt
PmNoYW5uZWxzLmNbaXhdKTsNCisJaWYgKHVubGlrZWx5KGVycikpDQorCQlnb3RvIGVycl9kZWFj
dGl2YXRlOw0KKw0KKwlyZXR1cm4gMDsNCisNCitlcnJfZGVhY3RpdmF0ZToNCisJbWx4NWVfZGVh
Y3RpdmF0ZV94c2soYyk7DQorCW1seDVlX2Nsb3NlX3hzayhjKTsNCisNCitlcnJfcmVtb3ZlX3Vt
ZW06DQorCW1seDVlX3hza19yZW1vdmVfdW1lbSgmcHJpdi0+eHNrLCBpeCk7DQorDQorZXJyX3Vu
bWFwX3VtZW06DQorCW1seDVlX3hza191bm1hcF91bWVtKHByaXYsIHVtZW0pOw0KKw0KKwlyZXR1
cm4gZXJyOw0KKw0KK3ZhbGlkYXRlX2Nsb3NlZDoNCisJLyogQ2hlY2sgdGhlIGNvbmZpZ3VyYXRp
b24gaW4gYWR2YW5jZSwgcmF0aGVyIHRoYW4gZmFpbCBhdCBhIGxhdGVyIHN0YWdlDQorCSAqIChp
biBtbHg1ZV94ZHBfc2V0IG9yIG9uIG9wZW4pIGFuZCBlbmQgdXAgd2l0aCBubyBjaGFubmVscy4N
CisJICovDQorCWlmICghbWx4NWVfdmFsaWRhdGVfeHNrX3BhcmFtKHBhcmFtcywgJnhzaywgcHJp
di0+bWRldikpIHsNCisJCWVyciA9IC1FSU5WQUw7DQorCQlnb3RvIGVycl9yZW1vdmVfdW1lbTsN
CisJfQ0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBtbHg1ZV94c2tfZGlzYWJs
ZV9sb2NrZWQoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHUxNiBpeCkNCit7DQorCXN0cnVjdCB4
ZHBfdW1lbSAqdW1lbSA9IG1seDVlX3hza19nZXRfdW1lbSgmcHJpdi0+Y2hhbm5lbHMucGFyYW1z
LA0KKwkJCQkJCSAgICZwcml2LT54c2ssIGl4KTsNCisJc3RydWN0IG1seDVlX2NoYW5uZWwgKmM7
DQorDQorCWlmICh1bmxpa2VseSghdW1lbSkpDQorCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJaWYg
KCF0ZXN0X2JpdChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSkpDQorCQlnb3RvIHJl
bW92ZV91bWVtOw0KKw0KKwkvKiBYU0sgUlEgYW5kIFNRIGFyZSBvbmx5IGNyZWF0ZWQgaWYgWERQ
IHByb2dyYW0gaXMgc2V0LiAqLw0KKwlpZiAoIXByaXYtPmNoYW5uZWxzLnBhcmFtcy54ZHBfcHJv
ZykNCisJCWdvdG8gcmVtb3ZlX3VtZW07DQorDQorCWMgPSBwcml2LT5jaGFubmVscy5jW2l4XTsN
CisJbWx4NWVfeHNrX3JlZGlyZWN0X3JxdF90b19kcm9wKHByaXYsIGl4KTsNCisJbWx4NWVfZGVh
Y3RpdmF0ZV94c2soYyk7DQorCW1seDVlX2Nsb3NlX3hzayhjKTsNCisNCityZW1vdmVfdW1lbToN
CisJbWx4NWVfeHNrX3JlbW92ZV91bWVtKCZwcml2LT54c2ssIGl4KTsNCisJbWx4NWVfeHNrX3Vu
bWFwX3VtZW0ocHJpdiwgdW1lbSk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50
IG1seDVlX3hza19lbmFibGVfdW1lbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IHhk
cF91bWVtICp1bWVtLA0KKwkJCQkgdTE2IGl4KQ0KK3sNCisJaW50IGVycjsNCisNCisJbXV0ZXhf
bG9jaygmcHJpdi0+c3RhdGVfbG9jayk7DQorCWVyciA9IG1seDVlX3hza19lbmFibGVfbG9ja2Vk
KHByaXYsIHVtZW0sIGl4KTsNCisJbXV0ZXhfdW5sb2NrKCZwcml2LT5zdGF0ZV9sb2NrKTsNCisN
CisJcmV0dXJuIGVycjsNCit9DQorDQorc3RhdGljIGludCBtbHg1ZV94c2tfZGlzYWJsZV91bWVt
KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB1MTYgaXgpDQorew0KKwlpbnQgZXJyOw0KKw0KKwlt
dXRleF9sb2NrKCZwcml2LT5zdGF0ZV9sb2NrKTsNCisJZXJyID0gbWx4NWVfeHNrX2Rpc2FibGVf
bG9ja2VkKHByaXYsIGl4KTsNCisJbXV0ZXhfdW5sb2NrKCZwcml2LT5zdGF0ZV9sb2NrKTsNCisN
CisJcmV0dXJuIGVycjsNCit9DQorDQoraW50IG1seDVlX3hza19zZXR1cF91bWVtKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsIHN0cnVjdCB4ZHBfdW1lbSAqdW1lbSwgdTE2IHFpZCkNCit7DQorCXN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYoZGV2KTsNCisNCisJaWYgKHVubGlr
ZWx5KCFtbHg1ZV94c2tfaXNfdmFsaWRfcWlkKHByaXYsIHFpZCkpKQ0KKwkJcmV0dXJuIC1FSU5W
QUw7DQorDQorCXJldHVybiB1bWVtID8gbWx4NWVfeHNrX2VuYWJsZV91bWVtKHByaXYsIHVtZW0s
IHFpZCkgOg0KKwkJICAgICAgbWx4NWVfeHNrX2Rpc2FibGVfdW1lbShwcml2LCBxaWQpOw0KK30N
CisNCitpbnQgbWx4NWVfeHNrX3Jlc2l6ZV9yZXVzZXEoc3RydWN0IHhkcF91bWVtICp1bWVtLCB1
MzIgbmVudHJpZXMpDQorew0KKwlzdHJ1Y3QgeGRwX3VtZW1fZnFfcmV1c2UgKnJldXNlcTsNCisN
CisJcmV1c2VxID0geHNrX3JldXNlcV9wcmVwYXJlKG5lbnRyaWVzKTsNCisJaWYgKHVubGlrZWx5
KCFyZXVzZXEpKQ0KKwkJcmV0dXJuIC1FTk9NRU07DQorCXhza19yZXVzZXFfZnJlZSh4c2tfcmV1
c2VxX3N3YXAodW1lbSwgcmV1c2VxKSk7DQorDQorCXJldHVybiAwOw0KK30NCmRpZmYgLS1naXQg
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW4veHNrL3VtZW0uaCBi
L2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbi94c2svdW1lbS5oDQpu
ZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4xMDUzZWNkZjFkODgNCi0t
LSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29y
ZS9lbi94c2svdW1lbS5oDQpAQCAtMCwwICsxLDM0IEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjAgT1IgTGludXgtT3BlbklCICovDQorLyogQ29weXJpZ2h0IChjKSAyMDE5
IE1lbGxhbm94IFRlY2hub2xvZ2llcy4gKi8NCisNCisjaWZuZGVmIF9fTUxYNV9FTl9YU0tfVU1F
TV9IX18NCisjZGVmaW5lIF9fTUxYNV9FTl9YU0tfVU1FTV9IX18NCisNCisjaW5jbHVkZSAiZW4u
aCINCisNCitzdGF0aWMgaW5saW5lIGJvb2wgbWx4NWVfeHNrX2lzX3ZhbGlkX3FpZChzdHJ1Y3Qg
bWx4NWVfcHJpdiAqcHJpdiwgdTE2IHFpZCkNCit7DQorCXJldHVybiBxaWQgPCBwcml2LT5jaGFu
bmVscy5wYXJhbXMubnVtX2NoYW5uZWxzOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCB4
ZHBfdW1lbSAqbWx4NWVfeHNrX2dldF91bWVtKHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywN
CisJCQkJCQkgIHN0cnVjdCBtbHg1ZV94c2sgKnhzaywgdTE2IGl4KQ0KK3sNCisJaWYgKCF4c2sg
fHwgIXhzay0+dW1lbXMpDQorCQlyZXR1cm4gTlVMTDsNCisNCisJaWYgKHVubGlrZWx5KGl4ID49
IHBhcmFtcy0+bnVtX2NoYW5uZWxzKSkNCisJCXJldHVybiBOVUxMOw0KKw0KKwlyZXR1cm4geHNr
LT51bWVtc1tpeF07DQorfQ0KKw0KK3N0cnVjdCBtbHg1ZV94c2tfcGFyYW07DQordm9pZCBtbHg1
ZV9idWlsZF94c2tfcGFyYW0oc3RydWN0IHhkcF91bWVtICp1bWVtLCBzdHJ1Y3QgbWx4NWVfeHNr
X3BhcmFtICp4c2spOw0KKw0KKy8qIC5uZG9fYnBmIGNhbGxiYWNrLiAqLw0KK2ludCBtbHg1ZV94
c2tfc2V0dXBfdW1lbShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgeGRwX3VtZW0gKnVt
ZW0sIHUxNiBxaWQpOw0KKw0KK2ludCBtbHg1ZV94c2tfcmVzaXplX3JldXNlcShzdHJ1Y3QgeGRw
X3VtZW0gKnVtZW0sIHUzMiBuZW50cmllcyk7DQorDQorI2VuZGlmIC8qIF9fTUxYNV9FTl9YU0tf
VU1FTV9IX18gKi8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9t
bHg1L2NvcmUvZW5fZXRodG9vbC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4
NS9jb3JlL2VuX2V0aHRvb2wuYw0KaW5kZXggZGQ3NjRlMDQ3MWYyLi41ODEwNmQ1NmZkYmUgMTAw
NjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fZXRo
dG9vbC5jDQorKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5f
ZXRodG9vbC5jDQpAQCAtMzIsNiArMzIsNyBAQA0KIA0KICNpbmNsdWRlICJlbi5oIg0KICNpbmNs
dWRlICJlbi9wb3J0LmgiDQorI2luY2x1ZGUgImVuL3hzay91bWVtLmgiDQogI2luY2x1ZGUgImxp
Yi9jbG9jay5oIg0KIA0KIHZvaWQgbWx4NWVfZXRodG9vbF9nZXRfZHJ2aW5mbyhzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwNCkBAIC00MDMsNiArNDA0LDcgQEAgc3RhdGljIHZvaWQgbWx4NWVfZ2V0
X2NoYW5uZWxzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsDQogaW50IG1seDVlX2V0aHRvb2xfc2V0
X2NoYW5uZWxzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAkJCSAgICAgICBzdHJ1Y3QgZXRo
dG9vbF9jaGFubmVscyAqY2gpDQogew0KKwlzdHJ1Y3QgbWx4NWVfcGFyYW1zICpjdXJfcGFyYW1z
ID0gJnByaXYtPmNoYW5uZWxzLnBhcmFtczsNCiAJdW5zaWduZWQgaW50IGNvdW50ID0gY2gtPmNv
bWJpbmVkX2NvdW50Ow0KIAlzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgbmV3X2NoYW5uZWxzID0ge307
DQogCWJvb2wgYXJmc19lbmFibGVkOw0KQEAgLTQxNCwxNiArNDE2LDMxIEBAIGludCBtbHg1ZV9l
dGh0b29sX3NldF9jaGFubmVscyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJCXJldHVybiAt
RUlOVkFMOw0KIAl9DQogDQotCWlmIChwcml2LT5jaGFubmVscy5wYXJhbXMubnVtX2NoYW5uZWxz
ID09IGNvdW50KQ0KKwlpZiAoY3VyX3BhcmFtcy0+bnVtX2NoYW5uZWxzID09IGNvdW50KQ0KIAkJ
cmV0dXJuIDA7DQogDQogCW11dGV4X2xvY2soJnByaXYtPnN0YXRlX2xvY2spOw0KIA0KKwkvKiBE
b24ndCBhbGxvdyBjbG9zaW5nIHRoZSBjaGFubmVscyBpZiB0aGV5IGhhdmUgYW4gYWN0aXZlIFhT
Sy4gKi8NCisJaWYgKHByaXYtPnhzay5yZWZjbnQpIHsNCisJCXUxNiBpeDsNCisNCisJCS8qIENo
ZWNrIHRoZSBjaGFubmVscyB0aGF0IGFyZSBnb2luZyB0byBiZSBjbG9zZWQuICovDQorCQlmb3Ig
KGl4ID0gY3VyX3BhcmFtcy0+bnVtX2NoYW5uZWxzIC0gMTsgaXggPj0gY291bnQ7IGl4LS0pIHsN
CisJCQlpZiAobWx4NWVfeHNrX2dldF91bWVtKGN1cl9wYXJhbXMsICZwcml2LT54c2ssIGl4KSkg
ew0KKwkJCQllcnIgPSAtRUlOVkFMOw0KKwkJCQluZXRkZXZfZXJyKHByaXYtPm5ldGRldiwgIiVz
OiBBRl9YRFAgaXMgYWN0aXZlIG9uIGNoYW5uZWwgJWh1LCBjYW5ub3QgcmVkdWNlIHRoZSBudW1i
ZXIgb2YgY2hhbm5lbHNcbiIsDQorCQkJCQkgICBfX2Z1bmNfXywgaXgpOw0KKwkJCQlnb3RvIG91
dDsNCisJCQl9DQorCQl9DQorCX0NCisNCiAJbmV3X2NoYW5uZWxzLnBhcmFtcyA9IHByaXYtPmNo
YW5uZWxzLnBhcmFtczsNCiAJbmV3X2NoYW5uZWxzLnBhcmFtcy5udW1fY2hhbm5lbHMgPSBjb3Vu
dDsNCiANCiAJaWYgKCF0ZXN0X2JpdChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSkp
IHsNCi0JCXByaXYtPmNoYW5uZWxzLnBhcmFtcyA9IG5ld19jaGFubmVscy5wYXJhbXM7DQorCQkq
Y3VyX3BhcmFtcyA9IG5ld19jaGFubmVscy5wYXJhbXM7DQogCQlpZiAoIW5ldGlmX2lzX3J4Zmhf
Y29uZmlndXJlZChwcml2LT5uZXRkZXYpKQ0KIAkJCW1seDVlX2J1aWxkX2RlZmF1bHRfaW5kaXJf
cnF0KHByaXYtPnJzc19wYXJhbXMuaW5kaXJlY3Rpb25fcnF0LA0KIAkJCQkJCSAgICAgIE1MWDVF
X0lORElSX1JRVF9TSVpFLCBjb3VudCk7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX2ZzX2V0aHRvb2wuYyBiL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbl9mc19ldGh0b29sLmMNCmluZGV4IDQ0MjFjMTBmNThh
ZS4uOTI0MWU2NDBjOGU0IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFu
b3gvbWx4NS9jb3JlL2VuX2ZzX2V0aHRvb2wuYw0KKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVsbGFub3gvbWx4NS9jb3JlL2VuX2ZzX2V0aHRvb2wuYw0KQEAgLTM5Miw2ICszOTIsMjAgQEAg
c3RhdGljIGJvb2wgb3V0ZXJfaGVhZGVyX3plcm8odTMyICptYXRjaF9jcml0ZXJpYSkNCiAJCQkJ
CQkgIHNpemUgLSAxKTsNCiB9DQogDQorI2RlZmluZSBNTFg1RV9VU0VSREVGX0ZMQUdfWFNLIEJJ
VF9VTEwoMCkNCisNCitzdGF0aWMgYm9vbCBpc19ydWxlX3hzayhzdHJ1Y3QgZXRodG9vbF9yeF9m
bG93X3NwZWMgKmZzKQ0KK3sNCisJdTY0IHVzZXJkZWY7DQorDQorCWlmICghKGZzLT5mbG93X3R5
cGUgJiBGTE9XX0VYVCkpDQorCQlyZXR1cm4gZmFsc2U7DQorDQorCXVzZXJkZWYgPSBiZTY0X3Rv
X2NwdSgqKChfX2JlNjQgKilmcy0+aF9leHQuZGF0YSkpOw0KKw0KKwlyZXR1cm4gdXNlcmRlZiAm
IE1MWDVFX1VTRVJERUZfRkxBR19YU0s7DQorfQ0KKw0KIHN0YXRpYyBzdHJ1Y3QgbWx4NV9mbG93
X2hhbmRsZSAqDQogYWRkX2V0aHRvb2xfZmxvd19ydWxlKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
LA0KIAkJICAgICAgc3RydWN0IG1seDVfZmxvd190YWJsZSAqZnQsDQpAQCAtNDE0LDYgKzQyOCw5
IEBAIGFkZF9ldGh0b29sX2Zsb3dfcnVsZShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJaWYg
KGZzLT5yaW5nX2Nvb2tpZSA9PSBSWF9DTFNfRkxPV19ESVNDKSB7DQogCQlmbG93X2FjdC5hY3Rp
b24gPSBNTFg1X0ZMT1dfQ09OVEVYVF9BQ1RJT05fRFJPUDsNCiAJfSBlbHNlIHsNCisJCXN0cnVj
dCBtbHg1ZV90aXIgKnRpciA9IGlzX3J1bGVfeHNrKGZzKSA/IHByaXYtPnhza190aXINCisJCQkJ
CQkJOiBwcml2LT5kaXJlY3RfdGlyOw0KKw0KIAkJZHN0ID0ga3phbGxvYyhzaXplb2YoKmRzdCks
IEdGUF9LRVJORUwpOw0KIAkJaWYgKCFkc3QpIHsNCiAJCQllcnIgPSAtRU5PTUVNOw0KQEAgLTQy
MSw3ICs0MzgsNyBAQCBhZGRfZXRodG9vbF9mbG93X3J1bGUoc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsDQogCQl9DQogDQogCQlkc3QtPnR5cGUgPSBNTFg1X0ZMT1dfREVTVElOQVRJT05fVFlQRV9U
SVI7DQotCQlkc3QtPnRpcl9udW0gPSBwcml2LT5kaXJlY3RfdGlyW2ZzLT5yaW5nX2Nvb2tpZV0u
dGlybjsNCisJCWRzdC0+dGlyX251bSA9IHRpcltmcy0+cmluZ19jb29raWVdLnRpcm47DQogCQlm
bG93X2FjdC5hY3Rpb24gPSBNTFg1X0ZMT1dfQ09OVEVYVF9BQ1RJT05fRldEX0RFU1Q7DQogCX0N
CiANCkBAIC01NzgsMTQgKzU5NSwyNyBAQCBzdGF0aWMgaW50IHZhbGlkYXRlX3RjcHVkcDYoc3Ry
dWN0IGV0aHRvb2xfcnhfZmxvd19zcGVjICpmcykNCiAJcmV0dXJuICsrbnR1cGxlczsNCiB9DQog
DQotc3RhdGljIGludCB2YWxpZGF0ZV92bGFuKHN0cnVjdCBldGh0b29sX3J4X2Zsb3dfc3BlYyAq
ZnMpDQorc3RhdGljIGludCB2YWxpZGF0ZV9leHQoc3RydWN0IGV0aHRvb2xfcnhfZmxvd19zcGVj
ICpmcykNCiB7DQotCWlmIChmcy0+bV9leHQudmxhbl9ldHlwZSB8fA0KLQkgICAgZnMtPm1fZXh0
LnZsYW5fdGNpICE9IGNwdV90b19iZTE2KFZMQU5fVklEX01BU0spKQ0KKwl1NjQgdXNlcmRlZl9t
YXNrOw0KKwl1NjQgdXNlcmRlZjsNCisNCisJaWYgKGZzLT5tX2V4dC52bGFuX2V0eXBlKQ0KIAkJ
cmV0dXJuIC1FSU5WQUw7DQogDQotCWlmIChmcy0+bV9leHQudmxhbl90Y2kgJiYNCi0JICAgIChi
ZTE2X3RvX2NwdShmcy0+aF9leHQudmxhbl90Y2kpID49IFZMQU5fTl9WSUQpKQ0KKwlpZiAoZnMt
Pm1fZXh0LnZsYW5fdGNpKSB7DQorCQlpZiAoZnMtPm1fZXh0LnZsYW5fdGNpICE9IGNwdV90b19i
ZTE2KFZMQU5fVklEX01BU0spKQ0KKwkJCXJldHVybiAtRUlOVkFMOw0KKw0KKwkJaWYgKGJlMTZf
dG9fY3B1KGZzLT5oX2V4dC52bGFuX3RjaSkgPj0gVkxBTl9OX1ZJRCkNCisJCQlyZXR1cm4gLUVJ
TlZBTDsNCisJfQ0KKw0KKwl1c2VyZGVmID0gYmU2NF90b19jcHUoKigoX19iZTY0ICopZnMtPmhf
ZXh0LmRhdGEpKTsNCisJdXNlcmRlZl9tYXNrID0gYmU2NF90b19jcHUoKigoX19iZTY0ICopZnMt
Pm1fZXh0LmRhdGEpKTsNCisJaWYgKHVzZXJkZWYgJiB+TUxYNUVfVVNFUkRFRl9GTEFHX1hTSykN
CisJCXJldHVybiAtRUlOVkFMOw0KKwlpZiAodXNlcmRlZl9tYXNrICE9IH4oMFVMTCkpDQogCQly
ZXR1cm4gLUVJTlZBTDsNCiANCiAJcmV0dXJuIDE7DQpAQCAtNjM4LDcgKzY2OCw3IEBAIHN0YXRp
YyBpbnQgdmFsaWRhdGVfZmxvdyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJCXJldHVybiAt
RU5PVFNVUFA7DQogCX0NCiAJaWYgKChmcy0+Zmxvd190eXBlICYgRkxPV19FWFQpKSB7DQotCQly
ZXQgPSB2YWxpZGF0ZV92bGFuKGZzKTsNCisJCXJldCA9IHZhbGlkYXRlX2V4dChmcyk7DQogCQlp
ZiAocmV0IDwgMCkNCiAJCQlyZXR1cm4gcmV0Ow0KIAkJbnVtX3R1cGxlcyArPSByZXQ7DQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX21haW4u
YyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9tYWluLmMNCmlu
ZGV4IDNiMmQ3YTFmYTdkZi4uMWY3ZjUwY2E2MWQyIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX21haW4uYw0KKysrIGIvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX21haW4uYw0KQEAgLTM4LDYgKzM4LDcgQEAN
CiAjaW5jbHVkZSA8bGludXgvYnBmLmg+DQogI2luY2x1ZGUgPGxpbnV4L2lmX2JyaWRnZS5oPg0K
ICNpbmNsdWRlIDxuZXQvcGFnZV9wb29sLmg+DQorI2luY2x1ZGUgPG5ldC94ZHBfc29jay5oPg0K
ICNpbmNsdWRlICJlc3dpdGNoLmgiDQogI2luY2x1ZGUgImVuLmgiDQogI2luY2x1ZGUgImVuX3Rj
LmgiDQpAQCAtNTYsNiArNTcsMTAgQEANCiAjaW5jbHVkZSAiZW4vbW9uaXRvcl9zdGF0cy5oIg0K
ICNpbmNsdWRlICJlbi9yZXBvcnRlci5oIg0KICNpbmNsdWRlICJlbi9wYXJhbXMuaCINCisjaW5j
bHVkZSAiZW4veHNrL3VtZW0uaCINCisjaW5jbHVkZSAiZW4veHNrL3NldHVwLmgiDQorI2luY2x1
ZGUgImVuL3hzay9yeC5oIg0KKyNpbmNsdWRlICJlbi94c2svdHguaCINCiANCiBib29sIG1seDVl
X2NoZWNrX2ZyYWdtZW50ZWRfc3RyaWRpbmdfcnFfY2FwKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICpt
ZGV2KQ0KIHsNCkBAIC04NSwxOCArOTAsMzEgQEAgdm9pZCBtbHg1ZV9pbml0X3JxX3R5cGVfcGFy
YW1zKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KIAltbHg1X2NvcmVfaW5mbyhtZGV2LCAi
TUxYNUU6IFN0cmRScSglZCkgUnFTeiglbGQpIFN0cmRTeiglbGQpIFJ4Q3FlQ21wcnNzKCVkKVxu
IiwNCiAJCSAgICAgICBwYXJhbXMtPnJxX3dxX3R5cGUgPT0gTUxYNV9XUV9UWVBFX0xJTktFRF9M
SVNUX1NUUklESU5HX1JRLA0KIAkJICAgICAgIHBhcmFtcy0+cnFfd3FfdHlwZSA9PSBNTFg1X1dR
X1RZUEVfTElOS0VEX0xJU1RfU1RSSURJTkdfUlEgPw0KLQkJICAgICAgIEJJVChtbHg1ZV9tcHdx
ZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zKSkgOg0KKwkJICAgICAgIEJJVChtbHg1ZV9tcHdxZV9n
ZXRfbG9nX3JxX3NpemUocGFyYW1zLCBOVUxMKSkgOg0KIAkJICAgICAgIEJJVChwYXJhbXMtPmxv
Z19ycV9tdHVfZnJhbWVzKSwNCi0JCSAgICAgICBCSVQobWx4NWVfbXB3cWVfZ2V0X2xvZ19zdHJp
ZGVfc2l6ZShtZGV2LCBwYXJhbXMpKSwNCisJCSAgICAgICBCSVQobWx4NWVfbXB3cWVfZ2V0X2xv
Z19zdHJpZGVfc2l6ZShtZGV2LCBwYXJhbXMsIE5VTEwpKSwNCiAJCSAgICAgICBNTFg1RV9HRVRf
UEZMQUcocGFyYW1zLCBNTFg1RV9QRkxBR19SWF9DUUVfQ09NUFJFU1MpKTsNCiB9DQogDQogYm9v
bCBtbHg1ZV9zdHJpZGluZ19ycV9wb3NzaWJsZShzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwN
CiAJCQkJc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0KIHsNCi0JcmV0dXJuIG1seDVlX2No
ZWNrX2ZyYWdtZW50ZWRfc3RyaWRpbmdfcnFfY2FwKG1kZXYpICYmDQotCQkhTUxYNV9JUFNFQ19E
RVYobWRldikgJiYNCi0JCSEocGFyYW1zLT54ZHBfcHJvZyAmJiAhbWx4NWVfcnhfbXB3cWVfaXNf
bGluZWFyX3NrYihtZGV2LCBwYXJhbXMpKTsNCisJaWYgKCFtbHg1ZV9jaGVja19mcmFnbWVudGVk
X3N0cmlkaW5nX3JxX2NhcChtZGV2KSkNCisJCXJldHVybiBmYWxzZTsNCisNCisJaWYgKE1MWDVf
SVBTRUNfREVWKG1kZXYpKQ0KKwkJcmV0dXJuIGZhbHNlOw0KKw0KKwlpZiAocGFyYW1zLT54ZHBf
cHJvZykgew0KKwkJLyogWFNLIHBhcmFtcyBhcmUgbm90IGNvbnNpZGVyZWQgaGVyZS4gSWYgc3Ry
aWRpbmcgUlEgaXMgaW4gdXNlLA0KKwkJICogYW5kIGFuIFhTSyBpcyBiZWluZyBvcGVuZWQsIG1s
eDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2Igd2lsbA0KKwkJICogYmUgY2FsbGVkIHdpdGggdGhl
IGtub3duIFhTSyBwYXJhbXMuDQorCQkgKi8NCisJCWlmICghbWx4NWVfcnhfbXB3cWVfaXNfbGlu
ZWFyX3NrYihtZGV2LCBwYXJhbXMsIE5VTEwpKQ0KKwkJCXJldHVybiBmYWxzZTsNCisJfQ0KKw0K
KwlyZXR1cm4gdHJ1ZTsNCiB9DQogDQogdm9pZCBtbHg1ZV9zZXRfcnFfdHlwZShzdHJ1Y3QgbWx4
NV9jb3JlX2RldiAqbWRldiwgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zKQ0KQEAgLTM2NSw2
ICszODMsOCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9mcmVlX2RpX2xpc3Qoc3RydWN0IG1seDVlX3Jx
ICpycSkNCiANCiBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVs
ICpjLA0KIAkJCSAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgc3RydWN0IG1s
eDVlX3hza19wYXJhbSAqeHNrLA0KKwkJCSAgc3RydWN0IHhkcF91bWVtICp1bWVtLA0KIAkJCSAg
c3RydWN0IG1seDVlX3JxX3BhcmFtICpycXAsDQogCQkJICBzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0K
IHsNCkBAIC0zNzIsNiArMzkyLDggQEAgc3RhdGljIGludCBtbHg1ZV9hbGxvY19ycShzdHJ1Y3Qg
bWx4NWVfY2hhbm5lbCAqYywNCiAJc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYgPSBjLT5tZGV2
Ow0KIAl2b2lkICpycWMgPSBycXAtPnJxYzsNCiAJdm9pZCAqcnFjX3dxID0gTUxYNV9BRERSX09G
KHJxYywgcnFjLCB3cSk7DQorCXUzMiBudW1feHNrX2ZyYW1lcyA9IDA7DQorCXUzMiBycV94ZHBf
aXg7DQogCXUzMiBwb29sX3NpemU7DQogCWludCB3cV9zejsNCiAJaW50IGVycjsNCkBAIC0zODgs
OCArNDEwLDEzIEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfcnEoc3RydWN0IG1seDVlX2NoYW5u
ZWwgKmMsDQogCXJxLT5peCAgICAgID0gYy0+aXg7DQogCXJxLT5tZGV2ICAgID0gbWRldjsNCiAJ
cnEtPmh3X210dSAgPSBNTFg1RV9TVzJIV19NVFUocGFyYW1zLCBwYXJhbXMtPnN3X210dSk7DQot
CXJxLT5zdGF0cyAgID0gJmMtPnByaXYtPmNoYW5uZWxfc3RhdHNbYy0+aXhdLnJxOw0KIAlycS0+
eGRwc3EgICA9ICZjLT5ycV94ZHBzcTsNCisJcnEtPnVtZW0gICAgPSB1bWVtOw0KKw0KKwlpZiAo
cnEtPnVtZW0pDQorCQlycS0+c3RhdHMgPSAmYy0+cHJpdi0+Y2hhbm5lbF9zdGF0c1tjLT5peF0u
eHNrcnE7DQorCWVsc2UNCisJCXJxLT5zdGF0cyA9ICZjLT5wcml2LT5jaGFubmVsX3N0YXRzW2Mt
Pml4XS5ycTsNCiANCiAJcnEtPnhkcF9wcm9nID0gcGFyYW1zLT54ZHBfcHJvZyA/IGJwZl9wcm9n
X2luYyhwYXJhbXMtPnhkcF9wcm9nKSA6IE5VTEw7DQogCWlmIChJU19FUlIocnEtPnhkcF9wcm9n
KSkgew0KQEAgLTM5OCwxMiArNDI1LDE2IEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfcnEoc3Ry
dWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCQlnb3RvIGVycl9ycV93cV9kZXN0cm95Ow0KIAl9DQog
DQotCWVyciA9IHhkcF9yeHFfaW5mb19yZWcoJnJxLT54ZHBfcnhxLCBycS0+bmV0ZGV2LCBycS0+
aXgpOw0KKwlycV94ZHBfaXggPSBycS0+aXg7DQorCWlmICh4c2spDQorCQlycV94ZHBfaXggfD0g
WERQX1FJRF9GTEFHX1hTS1JROw0KKwllcnIgPSB4ZHBfcnhxX2luZm9fcmVnKCZycS0+eGRwX3J4
cSwgcnEtPm5ldGRldiwgcnFfeGRwX2l4KTsNCiAJaWYgKGVyciA8IDApDQogCQlnb3RvIGVycl9y
cV93cV9kZXN0cm95Ow0KIA0KIAlycS0+YnVmZi5tYXBfZGlyID0gcnEtPnhkcF9wcm9nID8gRE1B
X0JJRElSRUNUSU9OQUwgOiBETUFfRlJPTV9ERVZJQ0U7DQotCXJxLT5idWZmLmhlYWRyb29tID0g
bWx4NWVfZ2V0X3JxX2hlYWRyb29tKG1kZXYsIHBhcmFtcyk7DQorCXJxLT5idWZmLmhlYWRyb29t
ID0gbWx4NWVfZ2V0X3JxX2hlYWRyb29tKG1kZXYsIHBhcmFtcywgeHNrKTsNCisJcnEtPmJ1ZmYu
dW1lbV9oZWFkcm9vbSA9IHhzayA/IHhzay0+aGVhZHJvb20gOiAwOw0KIAlwb29sX3NpemUgPSAx
IDw8IHBhcmFtcy0+bG9nX3JxX210dV9mcmFtZXM7DQogDQogCXN3aXRjaCAocnEtPndxX3R5cGUp
IHsNCkBAIC00MTcsNyArNDQ4LDEyIEBAIHN0YXRpYyBpbnQgbWx4NWVfYWxsb2NfcnEoc3RydWN0
IG1seDVlX2NoYW5uZWwgKmMsDQogDQogCQl3cV9zeiA9IG1seDVfd3FfbGxfZ2V0X3NpemUoJnJx
LT5tcHdxZS53cSk7DQogDQotCQlwb29sX3NpemUgPSBNTFg1X01QV1JRX1BBR0VTX1BFUl9XUUUg
PDwgbWx4NWVfbXB3cWVfZ2V0X2xvZ19ycV9zaXplKHBhcmFtcyk7DQorCQlpZiAoeHNrKQ0KKwkJ
CW51bV94c2tfZnJhbWVzID0gd3Ffc3ogPDwNCisJCQkJbWx4NWVfbXB3cWVfZ2V0X2xvZ19udW1f
c3RyaWRlcyhtZGV2LCBwYXJhbXMsIHhzayk7DQorDQorCQlwb29sX3NpemUgPSBNTFg1X01QV1JR
X1BBR0VTX1BFUl9XUUUgPDwNCisJCQltbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1z
LCB4c2spOw0KIA0KIAkJcnEtPnBvc3Rfd3FlcyA9IG1seDVlX3Bvc3RfcnhfbXB3cWVzOw0KIAkJ
cnEtPmRlYWxsb2Nfd3FlID0gbWx4NWVfZGVhbGxvY19yeF9tcHdxZTsNCkBAIC00MzYsMTIgKzQ3
MiwxNSBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpj
LA0KIAkJCWdvdG8gZXJyX3JxX3dxX2Rlc3Ryb3k7DQogCQl9DQogDQotCQlycS0+bXB3cWUuc2ti
X2Zyb21fY3FlX21wd3JxID0NCi0JCQltbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYs
IHBhcmFtcykgPw0KLQkJCW1seDVlX3NrYl9mcm9tX2NxZV9tcHdycV9saW5lYXIgOg0KLQkJCW1s
eDVlX3NrYl9mcm9tX2NxZV9tcHdycV9ub25saW5lYXI7DQotCQlycS0+bXB3cWUubG9nX3N0cmlk
ZV9zeiA9IG1seDVlX21wd3FlX2dldF9sb2dfc3RyaWRlX3NpemUobWRldiwgcGFyYW1zKTsNCi0J
CXJxLT5tcHdxZS5udW1fc3RyaWRlcyA9IEJJVChtbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9zdHJp
ZGVzKG1kZXYsIHBhcmFtcykpOw0KKwkJcnEtPm1wd3FlLnNrYl9mcm9tX2NxZV9tcHdycSA9IHhz
ayA/DQorCQkJbWx4NWVfeHNrX3NrYl9mcm9tX2NxZV9tcHdycV9saW5lYXIgOg0KKwkJCW1seDVl
X3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zLCBOVUxMKSA/DQorCQkJCW1seDVl
X3NrYl9mcm9tX2NxZV9tcHdycV9saW5lYXIgOg0KKwkJCQltbHg1ZV9za2JfZnJvbV9jcWVfbXB3
cnFfbm9ubGluZWFyOw0KKw0KKwkJcnEtPm1wd3FlLmxvZ19zdHJpZGVfc3ogPSBtbHg1ZV9tcHdx
ZV9nZXRfbG9nX3N0cmlkZV9zaXplKG1kZXYsIHBhcmFtcywgeHNrKTsNCisJCXJxLT5tcHdxZS5u
dW1fc3RyaWRlcyA9DQorCQkJQklUKG1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0cmlkZXMobWRl
diwgcGFyYW1zLCB4c2spKTsNCiANCiAJCWVyciA9IG1seDVlX2NyZWF0ZV9ycV91bXJfbWtleSht
ZGV2LCBycSk7DQogCQlpZiAoZXJyKQ0KQEAgLTQ2Miw2ICs1MDEsOSBAQCBzdGF0aWMgaW50IG1s
eDVlX2FsbG9jX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KIA0KIAkJd3Ffc3ogPSBtbHg1
X3dxX2N5Y19nZXRfc2l6ZSgmcnEtPndxZS53cSk7DQogDQorCQlpZiAoeHNrKQ0KKwkJCW51bV94
c2tfZnJhbWVzID0gd3Ffc3ogPDwgcnEtPndxZS5pbmZvLmxvZ19udW1fZnJhZ3M7DQorDQogCQly
cS0+d3FlLmluZm8gPSBycXAtPmZyYWdzX2luZm87DQogCQlycS0+d3FlLmZyYWdzID0NCiAJCQlr
dnphbGxvY19ub2RlKGFycmF5X3NpemUoc2l6ZW9mKCpycS0+d3FlLmZyYWdzKSwNCkBAIC00NzUs
NiArNTE3LDcgQEAgc3RhdGljIGludCBtbHg1ZV9hbGxvY19ycShzdHJ1Y3QgbWx4NWVfY2hhbm5l
bCAqYywNCiAJCWVyciA9IG1seDVlX2luaXRfZGlfbGlzdChycSwgd3Ffc3osIGMtPmNwdSk7DQog
CQlpZiAoZXJyKQ0KIAkJCWdvdG8gZXJyX2ZyZWU7DQorDQogCQlycS0+cG9zdF93cWVzID0gbWx4
NWVfcG9zdF9yeF93cWVzOw0KIAkJcnEtPmRlYWxsb2Nfd3FlID0gbWx4NWVfZGVhbGxvY19yeF93
cWU7DQogDQpAQCAtNDkwLDMzICs1MzMsNTEgQEAgc3RhdGljIGludCBtbHg1ZV9hbGxvY19ycShz
dHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywNCiAJCQlnb3RvIGVycl9mcmVlOw0KIAkJfQ0KIA0KLQkJ
cnEtPndxZS5za2JfZnJvbV9jcWUgPSBtbHg1ZV9yeF9pc19saW5lYXJfc2tiKHBhcmFtcykgPw0K
LQkJCW1seDVlX3NrYl9mcm9tX2NxZV9saW5lYXIgOg0KLQkJCW1seDVlX3NrYl9mcm9tX2NxZV9u
b25saW5lYXI7DQorCQlycS0+d3FlLnNrYl9mcm9tX2NxZSA9IHhzayA/DQorCQkJbWx4NWVfeHNr
X3NrYl9mcm9tX2NxZV9saW5lYXIgOg0KKwkJCW1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1z
LCBOVUxMKSA/DQorCQkJCW1seDVlX3NrYl9mcm9tX2NxZV9saW5lYXIgOg0KKwkJCQltbHg1ZV9z
a2JfZnJvbV9jcWVfbm9ubGluZWFyOw0KKw0KIAkJcnEtPm1rZXlfYmUgPSBjLT5ta2V5X2JlOw0K
IAl9DQogDQotCS8qIENyZWF0ZSBhIHBhZ2VfcG9vbCBhbmQgcmVnaXN0ZXIgaXQgd2l0aCByeHEg
Ki8NCi0JcHBfcGFyYW1zLm9yZGVyICAgICA9IDA7DQotCXBwX3BhcmFtcy5mbGFncyAgICAgPSAw
OyAvKiBOby1pbnRlcm5hbCBETUEgbWFwcGluZyBpbiBwYWdlX3Bvb2wgKi8NCi0JcHBfcGFyYW1z
LnBvb2xfc2l6ZSA9IHBvb2xfc2l6ZTsNCi0JcHBfcGFyYW1zLm5pZCAgICAgICA9IGNwdV90b19u
b2RlKGMtPmNwdSk7DQotCXBwX3BhcmFtcy5kZXYgICAgICAgPSBjLT5wZGV2Ow0KLQlwcF9wYXJh
bXMuZG1hX2RpciAgID0gcnEtPmJ1ZmYubWFwX2RpcjsNCi0NCi0JLyogcGFnZV9wb29sIGNhbiBi
ZSB1c2VkIGV2ZW4gd2hlbiB0aGVyZSBpcyBubyBycS0+eGRwX3Byb2csDQotCSAqIGdpdmVuIHBh
Z2VfcG9vbCBkb2VzIG5vdCBoYW5kbGUgRE1BIG1hcHBpbmcgdGhlcmUgaXMgbm8NCi0JICogcmVx
dWlyZWQgc3RhdGUgdG8gY2xlYXIuIEFuZCBwYWdlX3Bvb2wgZ3JhY2VmdWxseSBoYW5kbGUNCi0J
ICogZWxldmF0ZWQgcmVmY250Lg0KLQkgKi8NCi0JcnEtPnBhZ2VfcG9vbCA9IHBhZ2VfcG9vbF9j
cmVhdGUoJnBwX3BhcmFtcyk7DQotCWlmIChJU19FUlIocnEtPnBhZ2VfcG9vbCkpIHsNCi0JCWVy
ciA9IFBUUl9FUlIocnEtPnBhZ2VfcG9vbCk7DQotCQlycS0+cGFnZV9wb29sID0gTlVMTDsNCi0J
CWdvdG8gZXJyX2ZyZWU7DQorCWlmICh4c2spIHsNCisJCWVyciA9IG1seDVlX3hza19yZXNpemVf
cmV1c2VxKHVtZW0sIG51bV94c2tfZnJhbWVzKTsNCisJCWlmICh1bmxpa2VseShlcnIpKSB7DQor
CQkJbWx4NV9jb3JlX2VycihtZGV2LCAiVW5hYmxlIHRvIGFsbG9jYXRlIHRoZSBSZXVzZSBSaW5n
IGZvciAldSBmcmFtZXNcbiIsDQorCQkJCSAgICAgIG51bV94c2tfZnJhbWVzKTsNCisJCQlnb3Rv
IGVycl9mcmVlOw0KKwkJfQ0KKw0KKwkJcnEtPnpjYS5mcmVlID0gbWx4NWVfeHNrX3pjYV9mcmVl
Ow0KKwkJZXJyID0geGRwX3J4cV9pbmZvX3JlZ19tZW1fbW9kZWwoJnJxLT54ZHBfcnhxLA0KKwkJ
CQkJCSBNRU1fVFlQRV9aRVJPX0NPUFksDQorCQkJCQkJICZycS0+emNhKTsNCisJfSBlbHNlIHsN
CisJCS8qIENyZWF0ZSBhIHBhZ2VfcG9vbCBhbmQgcmVnaXN0ZXIgaXQgd2l0aCByeHEgKi8NCisJ
CXBwX3BhcmFtcy5vcmRlciAgICAgPSAwOw0KKwkJcHBfcGFyYW1zLmZsYWdzICAgICA9IDA7IC8q
IE5vLWludGVybmFsIERNQSBtYXBwaW5nIGluIHBhZ2VfcG9vbCAqLw0KKwkJcHBfcGFyYW1zLnBv
b2xfc2l6ZSA9IHBvb2xfc2l6ZTsNCisJCXBwX3BhcmFtcy5uaWQgICAgICAgPSBjcHVfdG9fbm9k
ZShjLT5jcHUpOw0KKwkJcHBfcGFyYW1zLmRldiAgICAgICA9IGMtPnBkZXY7DQorCQlwcF9wYXJh
bXMuZG1hX2RpciAgID0gcnEtPmJ1ZmYubWFwX2RpcjsNCisNCisJCS8qIHBhZ2VfcG9vbCBjYW4g
YmUgdXNlZCBldmVuIHdoZW4gdGhlcmUgaXMgbm8gcnEtPnhkcF9wcm9nLA0KKwkJICogZ2l2ZW4g
cGFnZV9wb29sIGRvZXMgbm90IGhhbmRsZSBETUEgbWFwcGluZyB0aGVyZSBpcyBubw0KKwkJICog
cmVxdWlyZWQgc3RhdGUgdG8gY2xlYXIuIEFuZCBwYWdlX3Bvb2wgZ3JhY2VmdWxseSBoYW5kbGUN
CisJCSAqIGVsZXZhdGVkIHJlZmNudC4NCisJCSAqLw0KKwkJcnEtPnBhZ2VfcG9vbCA9IHBhZ2Vf
cG9vbF9jcmVhdGUoJnBwX3BhcmFtcyk7DQorCQlpZiAoSVNfRVJSKHJxLT5wYWdlX3Bvb2wpKSB7
DQorCQkJZXJyID0gUFRSX0VSUihycS0+cGFnZV9wb29sKTsNCisJCQlycS0+cGFnZV9wb29sID0g
TlVMTDsNCisJCQlnb3RvIGVycl9mcmVlOw0KKwkJfQ0KKwkJZXJyID0geGRwX3J4cV9pbmZvX3Jl
Z19tZW1fbW9kZWwoJnJxLT54ZHBfcnhxLA0KKwkJCQkJCSBNRU1fVFlQRV9QQUdFX1BPT0wsDQor
CQkJCQkJIHJxLT5wYWdlX3Bvb2wpOw0KIAl9DQotCWVyciA9IHhkcF9yeHFfaW5mb19yZWdfbWVt
X21vZGVsKCZycS0+eGRwX3J4cSwNCi0JCQkJCSBNRU1fVFlQRV9QQUdFX1BPT0wsIHJxLT5wYWdl
X3Bvb2wpOw0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZnJlZTsNCiANCkBAIC02MTUsNyArNjc2
LDExIEBAIHN0YXRpYyB2b2lkIG1seDVlX2ZyZWVfcnEoc3RydWN0IG1seDVlX3JxICpycSkNCiAJ
ICAgICBpID0gKGkgKyAxKSAmIChNTFg1RV9DQUNIRV9TSVpFIC0gMSkpIHsNCiAJCXN0cnVjdCBt
bHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8gPSAmcnEtPnBhZ2VfY2FjaGUucGFnZV9jYWNoZVtpXTsN
CiANCi0JCW1seDVlX3BhZ2VfcmVsZWFzZShycSwgZG1hX2luZm8sIGZhbHNlKTsNCisJCS8qIFdp
dGggQUZfWERQLCBwYWdlX2NhY2hlIGlzIG5vdCB1c2VkLCBzbyB0aGlzIGxvb3AgaXMgbm90DQor
CQkgKiBlbnRlcmVkLCBhbmQgaXQncyBzYWZlIHRvIGNhbGwgbWx4NWVfcGFnZV9yZWxlYXNlX2R5
bmFtaWMNCisJCSAqIGRpcmVjdGx5Lg0KKwkJICovDQorCQltbHg1ZV9wYWdlX3JlbGVhc2VfZHlu
YW1pYyhycSwgZG1hX2luZm8sIGZhbHNlKTsNCiAJfQ0KIAltbHg1X3dxX2Rlc3Ryb3koJnJxLT53
cV9jdHJsKTsNCiB9DQpAQCAtNzUwLDcgKzgxNSw3IEBAIHN0YXRpYyB2b2lkIG1seDVlX2Rlc3Ry
b3lfcnEoc3RydWN0IG1seDVlX3JxICpycSkNCiAJbWx4NV9jb3JlX2Rlc3Ryb3lfcnEocnEtPm1k
ZXYsIHJxLT5ycW4pOw0KIH0NCiANCi1zdGF0aWMgaW50IG1seDVlX3dhaXRfZm9yX21pbl9yeF93
cWVzKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIGludCB3YWl0X3RpbWUpDQoraW50IG1seDVlX3dhaXRf
Zm9yX21pbl9yeF93cWVzKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIGludCB3YWl0X3RpbWUpDQogew0K
IAl1bnNpZ25lZCBsb25nIGV4cF90aW1lID0gamlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMod2Fp
dF90aW1lKTsNCiAJc3RydWN0IG1seDVlX2NoYW5uZWwgKmMgPSBycS0+Y2hhbm5lbDsNCkBAIC04
MDgsMTQgKzg3MywxMyBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9mcmVlX3J4X2Rlc2NzKHN0cnVjdCBt
bHg1ZV9ycSAqcnEpDQogDQogfQ0KIA0KLXN0YXRpYyBpbnQgbWx4NWVfb3Blbl9ycShzdHJ1Y3Qg
bWx4NWVfY2hhbm5lbCAqYywNCi0JCQkgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KLQkJ
CSBzdHJ1Y3QgbWx4NWVfcnFfcGFyYW0gKnBhcmFtLA0KLQkJCSBzdHJ1Y3QgbWx4NWVfcnEgKnJx
KQ0KK2ludCBtbHg1ZV9vcGVuX3JxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLCBzdHJ1Y3QgbWx4
NWVfcGFyYW1zICpwYXJhbXMsDQorCQkgIHN0cnVjdCBtbHg1ZV9ycV9wYXJhbSAqcGFyYW0sIHN0
cnVjdCBtbHg1ZV94c2tfcGFyYW0gKnhzaywNCisJCSAgc3RydWN0IHhkcF91bWVtICp1bWVtLCBz
dHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIHsNCiAJaW50IGVycjsNCiANCi0JZXJyID0gbWx4NWVfYWxs
b2NfcnEoYywgcGFyYW1zLCBwYXJhbSwgcnEpOw0KKwllcnIgPSBtbHg1ZV9hbGxvY19ycShjLCBw
YXJhbXMsIHhzaywgdW1lbSwgcGFyYW0sIHJxKTsNCiAJaWYgKGVycikNCiAJCXJldHVybiBlcnI7
DQogDQpAQCAtODUzLDEzICs5MTcsMTMgQEAgc3RhdGljIHZvaWQgbWx4NWVfYWN0aXZhdGVfcnEo
c3RydWN0IG1seDVlX3JxICpycSkNCiAJbWx4NWVfdHJpZ2dlcl9pcnEoJnJxLT5jaGFubmVsLT5p
Y29zcSk7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2RlYWN0aXZhdGVfcnEoc3RydWN0IG1s
eDVlX3JxICpycSkNCit2b2lkIG1seDVlX2RlYWN0aXZhdGVfcnEoc3RydWN0IG1seDVlX3JxICpy
cSkNCiB7DQogCWNsZWFyX2JpdChNTFg1RV9SUV9TVEFURV9FTkFCTEVELCAmcnEtPnN0YXRlKTsN
CiAJbmFwaV9zeW5jaHJvbml6ZSgmcnEtPmNoYW5uZWwtPm5hcGkpOyAvKiBwcmV2ZW50IG1seDVl
X3Bvc3Rfcnhfd3FlcyAqLw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9jbG9zZV9ycShzdHJ1
Y3QgbWx4NWVfcnEgKnJxKQ0KK3ZvaWQgbWx4NWVfY2xvc2VfcnEoc3RydWN0IG1seDVlX3JxICpy
cSkNCiB7DQogCWNhbmNlbF93b3JrX3N5bmMoJnJxLT5kaW0ud29yayk7DQogCW1seDVlX2Rlc3Ry
b3lfcnEocnEpOw0KQEAgLTkxMiw2ICs5NzYsNyBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3hk
cHNxX2RiKHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsIGludCBudW1hKQ0KIA0KIHN0YXRpYyBpbnQg
bWx4NWVfYWxsb2NfeGRwc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCQkJICAgICBzdHJ1
Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQorCQkJICAgICBzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0s
DQogCQkJICAgICBzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtLA0KIAkJCSAgICAgc3RydWN0
IG1seDVlX3hkcHNxICpzcSwNCiAJCQkgICAgIGJvb2wgaXNfcmVkaXJlY3QpDQpAQCAtOTI3LDkg
Kzk5MiwxMyBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9jX3hkcHNxKHN0cnVjdCBtbHg1ZV9jaGFu
bmVsICpjLA0KIAlzcS0+dWFyX21hcCAgID0gbWRldi0+bWx4NWVfcmVzLmJmcmVnLm1hcDsNCiAJ
c3EtPm1pbl9pbmxpbmVfbW9kZSA9IHBhcmFtcy0+dHhfbWluX2lubGluZV9tb2RlOw0KIAlzcS0+
aHdfbXR1ICAgID0gTUxYNUVfU1cySFdfTVRVKHBhcmFtcywgcGFyYW1zLT5zd19tdHUpOw0KLQlz
cS0+c3RhdHMgICAgID0gaXNfcmVkaXJlY3QgPw0KLQkJJmMtPnByaXYtPmNoYW5uZWxfc3RhdHNb
Yy0+aXhdLnhkcHNxIDoNCi0JCSZjLT5wcml2LT5jaGFubmVsX3N0YXRzW2MtPml4XS5ycV94ZHBz
cTsNCisJc3EtPnVtZW0gICAgICA9IHVtZW07DQorDQorCXNxLT5zdGF0cyA9IHNxLT51bWVtID8N
CisJCSZjLT5wcml2LT5jaGFubmVsX3N0YXRzW2MtPml4XS54c2tzcSA6DQorCQlpc19yZWRpcmVj
dCA/DQorCQkJJmMtPnByaXYtPmNoYW5uZWxfc3RhdHNbYy0+aXhdLnhkcHNxIDoNCisJCQkmYy0+
cHJpdi0+Y2hhbm5lbF9zdGF0c1tjLT5peF0ucnFfeGRwc3E7DQogDQogCXBhcmFtLT53cS5kYl9u
dW1hX25vZGUgPSBjcHVfdG9fbm9kZShjLT5jcHUpOw0KIAllcnIgPSBtbHg1X3dxX2N5Y19jcmVh
dGUobWRldiwgJnBhcmFtLT53cSwgc3FjX3dxLCB3cSwgJnNxLT53cV9jdHJsKTsNCkBAIC0xMzA4
LDEwICsxMzc3LDggQEAgc3RhdGljIHZvaWQgbWx4NWVfdHhfZXJyX2NxZV93b3JrKHN0cnVjdCB3
b3JrX3N0cnVjdCAqcmVjb3Zlcl93b3JrKQ0KIAltbHg1ZV90eF9yZXBvcnRlcl9lcnJfY3FlKHNx
KTsNCiB9DQogDQotc3RhdGljIGludCBtbHg1ZV9vcGVuX2ljb3NxKHN0cnVjdCBtbHg1ZV9jaGFu
bmVsICpjLA0KLQkJCSAgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQotCQkJICAgIHN0
cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0sDQotCQkJICAgIHN0cnVjdCBtbHg1ZV9pY29zcSAq
c3EpDQoraW50IG1seDVlX29wZW5faWNvc3Eoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsIHN0cnVj
dCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCSAgICAgc3RydWN0IG1seDVlX3NxX3BhcmFtICpw
YXJhbSwgc3RydWN0IG1seDVlX2ljb3NxICpzcSkNCiB7DQogCXN0cnVjdCBtbHg1ZV9jcmVhdGVf
c3FfcGFyYW0gY3NwID0ge307DQogCWludCBlcnI7DQpAQCAtMTMzNyw3ICsxNDA0LDcgQEAgc3Rh
dGljIGludCBtbHg1ZV9vcGVuX2ljb3NxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KIAlyZXR1
cm4gZXJyOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9jbG9zZV9pY29zcShzdHJ1Y3QgbWx4
NWVfaWNvc3EgKnNxKQ0KK3ZvaWQgbWx4NWVfY2xvc2VfaWNvc3Eoc3RydWN0IG1seDVlX2ljb3Nx
ICpzcSkNCiB7DQogCXN0cnVjdCBtbHg1ZV9jaGFubmVsICpjID0gc3EtPmNoYW5uZWw7DQogDQpA
QCAtMTM0OCwxNiArMTQxNSwxNCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9jbG9zZV9pY29zcShzdHJ1
Y3QgbWx4NWVfaWNvc3EgKnNxKQ0KIAltbHg1ZV9mcmVlX2ljb3NxKHNxKTsNCiB9DQogDQotc3Rh
dGljIGludCBtbHg1ZV9vcGVuX3hkcHNxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KLQkJCSAg
ICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQotCQkJICAgIHN0cnVjdCBtbHg1ZV9zcV9w
YXJhbSAqcGFyYW0sDQotCQkJICAgIHN0cnVjdCBtbHg1ZV94ZHBzcSAqc3EsDQotCQkJICAgIGJv
b2wgaXNfcmVkaXJlY3QpDQoraW50IG1seDVlX29wZW5feGRwc3Eoc3RydWN0IG1seDVlX2NoYW5u
ZWwgKmMsIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCSAgICAgc3RydWN0IG1seDVl
X3NxX3BhcmFtICpwYXJhbSwgc3RydWN0IHhkcF91bWVtICp1bWVtLA0KKwkJICAgICBzdHJ1Y3Qg
bWx4NWVfeGRwc3EgKnNxLCBib29sIGlzX3JlZGlyZWN0KQ0KIHsNCiAJc3RydWN0IG1seDVlX2Ny
ZWF0ZV9zcV9wYXJhbSBjc3AgPSB7fTsNCiAJaW50IGVycjsNCiANCi0JZXJyID0gbWx4NWVfYWxs
b2NfeGRwc3EoYywgcGFyYW1zLCBwYXJhbSwgc3EsIGlzX3JlZGlyZWN0KTsNCisJZXJyID0gbWx4
NWVfYWxsb2NfeGRwc3EoYywgcGFyYW1zLCB1bWVtLCBwYXJhbSwgc3EsIGlzX3JlZGlyZWN0KTsN
CiAJaWYgKGVycikNCiAJCXJldHVybiBlcnI7DQogDQpAQCAtMTQxMSw3ICsxNDc2LDcgQEAgc3Rh
dGljIGludCBtbHg1ZV9vcGVuX3hkcHNxKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KIAlyZXR1
cm4gZXJyOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9jbG9zZV94ZHBzcShzdHJ1Y3QgbWx4
NWVfeGRwc3EgKnNxKQ0KK3ZvaWQgbWx4NWVfY2xvc2VfeGRwc3Eoc3RydWN0IG1seDVlX3hkcHNx
ICpzcSkNCiB7DQogCXN0cnVjdCBtbHg1ZV9jaGFubmVsICpjID0gc3EtPmNoYW5uZWw7DQogDQpA
QCAtMTU0MCwxMCArMTYwNSw4IEBAIHN0YXRpYyB2b2lkIG1seDVlX2Rlc3Ryb3lfY3Eoc3RydWN0
IG1seDVlX2NxICpjcSkNCiAJbWx4NV9jb3JlX2Rlc3Ryb3lfY3EoY3EtPm1kZXYsICZjcS0+bWNx
KTsNCiB9DQogDQotc3RhdGljIGludCBtbHg1ZV9vcGVuX2NxKHN0cnVjdCBtbHg1ZV9jaGFubmVs
ICpjLA0KLQkJCSBzdHJ1Y3QgbmV0X2RpbV9jcV9tb2RlciBtb2RlciwNCi0JCQkgc3RydWN0IG1s
eDVlX2NxX3BhcmFtICpwYXJhbSwNCi0JCQkgc3RydWN0IG1seDVlX2NxICpjcSkNCitpbnQgbWx4
NWVfb3Blbl9jcShzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYywgc3RydWN0IG5ldF9kaW1fY3FfbW9k
ZXIgbW9kZXIsDQorCQkgIHN0cnVjdCBtbHg1ZV9jcV9wYXJhbSAqcGFyYW0sIHN0cnVjdCBtbHg1
ZV9jcSAqY3EpDQogew0KIAlzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiA9IGMtPm1kZXY7DQog
CWludCBlcnI7DQpAQCAtMTU2Niw3ICsxNjI5LDcgQEAgc3RhdGljIGludCBtbHg1ZV9vcGVuX2Nx
KHN0cnVjdCBtbHg1ZV9jaGFubmVsICpjLA0KIAlyZXR1cm4gZXJyOw0KIH0NCiANCi1zdGF0aWMg
dm9pZCBtbHg1ZV9jbG9zZV9jcShzdHJ1Y3QgbWx4NWVfY3EgKmNxKQ0KK3ZvaWQgbWx4NWVfY2xv
c2VfY3Eoc3RydWN0IG1seDVlX2NxICpjcSkNCiB7DQogCW1seDVlX2Rlc3Ryb3lfY3EoY3EpOw0K
IAltbHg1ZV9mcmVlX2NxKGNxKTsNCkBAIC0xNzgwLDE3ICsxODQzLDE3IEBAIHN0YXRpYyBpbnQg
bWx4NWVfb3Blbl9xdWV1ZXMoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMsDQogCQlnb3RvIGVycl9j
bG9zZV9pY29zcTsNCiANCiAJaWYgKGMtPnhkcCkgew0KLQkJZXJyID0gbWx4NWVfb3Blbl94ZHBz
cShjLCBwYXJhbXMsICZjcGFyYW0tPnhkcF9zcSwNCisJCWVyciA9IG1seDVlX29wZW5feGRwc3Eo
YywgcGFyYW1zLCAmY3BhcmFtLT54ZHBfc3EsIE5VTEwsDQogCQkJCSAgICAgICAmYy0+cnFfeGRw
c3EsIGZhbHNlKTsNCiAJCWlmIChlcnIpDQogCQkJZ290byBlcnJfY2xvc2Vfc3FzOw0KIAl9DQog
DQotCWVyciA9IG1seDVlX29wZW5fcnEoYywgcGFyYW1zLCAmY3BhcmFtLT5ycSwgJmMtPnJxKTsN
CisJZXJyID0gbWx4NWVfb3Blbl9ycShjLCBwYXJhbXMsICZjcGFyYW0tPnJxLCBOVUxMLCBOVUxM
LCAmYy0+cnEpOw0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfY2xvc2VfeGRwX3NxOw0KIA0KLQll
cnIgPSBtbHg1ZV9vcGVuX3hkcHNxKGMsIHBhcmFtcywgJmNwYXJhbS0+eGRwX3NxLCAmYy0+eGRw
c3EsIHRydWUpOw0KKwllcnIgPSBtbHg1ZV9vcGVuX3hkcHNxKGMsIHBhcmFtcywgJmNwYXJhbS0+
eGRwX3NxLCBOVUxMLCAmYy0+eGRwc3EsIHRydWUpOw0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJf
Y2xvc2VfcnE7DQogDQpAQCAtMTg1MCwxMCArMTkxMywxMiBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9j
bG9zZV9xdWV1ZXMoc3RydWN0IG1seDVlX2NoYW5uZWwgKmMpDQogc3RhdGljIGludCBtbHg1ZV9v
cGVuX2NoYW5uZWwoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIGludCBpeCwNCiAJCQkgICAgICBz
dHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJhbXMsDQogCQkJICAgICAgc3RydWN0IG1seDVlX2NoYW5u
ZWxfcGFyYW0gKmNwYXJhbSwNCisJCQkgICAgICBzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0sDQogCQkJ
ICAgICAgc3RydWN0IG1seDVlX2NoYW5uZWwgKipjcCkNCiB7DQogCWludCBjcHUgPSBjcHVtYXNr
X2ZpcnN0KG1seDVfY29tcF9pcnFfZ2V0X2FmZmluaXR5X21hc2socHJpdi0+bWRldiwgaXgpKTsN
CiAJc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiA9IHByaXYtPm5ldGRldjsNCisJc3RydWN0IG1s
eDVlX3hza19wYXJhbSB4c2s7DQogCXN0cnVjdCBtbHg1ZV9jaGFubmVsICpjOw0KIAl1bnNpZ25l
ZCBpbnQgaXJxOw0KIAlpbnQgZXJyOw0KQEAgLTE4OTAsMTAgKzE5NTUsMjAgQEAgc3RhdGljIGlu
dCBtbHg1ZV9vcGVuX2NoYW5uZWwoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIGludCBpeCwNCiAJ
aWYgKHVubGlrZWx5KGVycikpDQogCQlnb3RvIGVycl9uYXBpX2RlbDsNCiANCisJaWYgKHVtZW0p
IHsNCisJCW1seDVlX2J1aWxkX3hza19wYXJhbSh1bWVtLCAmeHNrKTsNCisJCWVyciA9IG1seDVl
X29wZW5feHNrKHByaXYsIHBhcmFtcywgJnhzaywgdW1lbSwgYyk7DQorCQlpZiAodW5saWtlbHko
ZXJyKSkNCisJCQlnb3RvIGVycl9jbG9zZV9xdWV1ZXM7DQorCX0NCisNCiAJKmNwID0gYzsNCiAN
CiAJcmV0dXJuIDA7DQogDQorZXJyX2Nsb3NlX3F1ZXVlczoNCisJbWx4NWVfY2xvc2VfcXVldWVz
KGMpOw0KKw0KIGVycl9uYXBpX2RlbDoNCiAJbmV0aWZfbmFwaV9kZWwoJmMtPm5hcGkpOw0KIAlt
bHg1ZV9mcmVlX3hwc19jcHVtYXNrKGMpOw0KQEAgLTE5MTIsMTIgKzE5ODcsMTggQEAgc3RhdGlj
IHZvaWQgbWx4NWVfYWN0aXZhdGVfY2hhbm5lbChzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYykNCiAJ
CW1seDVlX2FjdGl2YXRlX3R4cXNxKCZjLT5zcVt0Y10pOw0KIAltbHg1ZV9hY3RpdmF0ZV9ycSgm
Yy0+cnEpOw0KIAluZXRpZl9zZXRfeHBzX3F1ZXVlKGMtPm5ldGRldiwgYy0+eHBzX2NwdW1hc2ss
IGMtPml4KTsNCisNCisJaWYgKHRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5z
dGF0ZSkpDQorCQltbHg1ZV9hY3RpdmF0ZV94c2soYyk7DQogfQ0KIA0KIHN0YXRpYyB2b2lkIG1s
eDVlX2RlYWN0aXZhdGVfY2hhbm5lbChzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYykNCiB7DQogCWlu
dCB0YzsNCiANCisJaWYgKHRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5zdGF0
ZSkpDQorCQltbHg1ZV9kZWFjdGl2YXRlX3hzayhjKTsNCisNCiAJbWx4NWVfZGVhY3RpdmF0ZV9y
cSgmYy0+cnEpOw0KIAlmb3IgKHRjID0gMDsgdGMgPCBjLT5udW1fdGM7IHRjKyspDQogCQltbHg1
ZV9kZWFjdGl2YXRlX3R4cXNxKCZjLT5zcVt0Y10pOw0KQEAgLTE5MjUsNiArMjAwNiw4IEBAIHN0
YXRpYyB2b2lkIG1seDVlX2RlYWN0aXZhdGVfY2hhbm5lbChzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAq
YykNCiANCiBzdGF0aWMgdm9pZCBtbHg1ZV9jbG9zZV9jaGFubmVsKHN0cnVjdCBtbHg1ZV9jaGFu
bmVsICpjKQ0KIHsNCisJaWYgKHRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5z
dGF0ZSkpDQorCQltbHg1ZV9jbG9zZV94c2soYyk7DQogCW1seDVlX2Nsb3NlX3F1ZXVlcyhjKTsN
CiAJbmV0aWZfbmFwaV9kZWwoJmMtPm5hcGkpOw0KIAltbHg1ZV9mcmVlX3hwc19jcHVtYXNrKGMp
Ow0KQEAgLTE5MzYsNiArMjAxOSw3IEBAIHN0YXRpYyB2b2lkIG1seDVlX2Nsb3NlX2NoYW5uZWwo
c3RydWN0IG1seDVlX2NoYW5uZWwgKmMpDQogDQogc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfcnFf
ZnJhZ3NfaW5mbyhzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCiAJCQkJICAgICAgc3RydWN0
IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCQkgICAgICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFt
ICp4c2ssDQogCQkJCSAgICAgIHN0cnVjdCBtbHg1ZV9ycV9mcmFnc19pbmZvICppbmZvKQ0KIHsN
CiAJdTMyIGJ5dGVfY291bnQgPSBNTFg1RV9TVzJIV19NVFUocGFyYW1zLCBwYXJhbXMtPnN3X210
dSk7DQpAQCAtMTk0OCwxMCArMjAzMiwxMCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9ycV9m
cmFnc19pbmZvKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KIAkJYnl0ZV9jb3VudCArPSBN
TFg1RV9NRVRBREFUQV9FVEhFUl9MRU47DQogI2VuZGlmDQogDQotCWlmIChtbHg1ZV9yeF9pc19s
aW5lYXJfc2tiKHBhcmFtcykpIHsNCisJaWYgKG1seDVlX3J4X2lzX2xpbmVhcl9za2IocGFyYW1z
LCB4c2spKSB7DQogCQlpbnQgZnJhZ19zdHJpZGU7DQogDQotCQlmcmFnX3N0cmlkZSA9IG1seDVl
X3J4X2dldF9saW5lYXJfZnJhZ19zeihwYXJhbXMsIE5VTEwpOw0KKwkJZnJhZ19zdHJpZGUgPSBt
bHg1ZV9yeF9nZXRfbGluZWFyX2ZyYWdfc3oocGFyYW1zLCB4c2spOw0KIAkJZnJhZ19zdHJpZGUg
PSByb3VuZHVwX3Bvd19vZl90d28oZnJhZ19zdHJpZGUpOw0KIA0KIAkJaW5mby0+YXJyWzBdLmZy
YWdfc2l6ZSA9IGJ5dGVfY291bnQ7DQpAQCAtMjAwOSw5ICsyMDkzLDEwIEBAIHN0YXRpYyB1OCBt
bHg1ZV9nZXRfcnFfbG9nX3dxX3N6KHZvaWQgKnJxYykNCiAJcmV0dXJuIE1MWDVfR0VUKHdxLCB3
cSwgbG9nX3dxX3N6KTsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfcnFfcGFyYW0o
c3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQotCQkJCSBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpwYXJh
bXMsDQotCQkJCSBzdHJ1Y3QgbWx4NWVfcnFfcGFyYW0gKnBhcmFtKQ0KK3ZvaWQgbWx4NWVfYnVp
bGRfcnFfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQorCQkJICBzdHJ1Y3QgbWx4NWVf
cGFyYW1zICpwYXJhbXMsDQorCQkJICBzdHJ1Y3QgbWx4NWVfeHNrX3BhcmFtICp4c2ssDQorCQkJ
ICBzdHJ1Y3QgbWx4NWVfcnFfcGFyYW0gKnBhcmFtKQ0KIHsNCiAJc3RydWN0IG1seDVfY29yZV9k
ZXYgKm1kZXYgPSBwcml2LT5tZGV2Ow0KIAl2b2lkICpycWMgPSBwYXJhbS0+cnFjOw0KQEAgLTIw
MjEsMTYgKzIxMDYsMTYgQEAgc3RhdGljIHZvaWQgbWx4NWVfYnVpbGRfcnFfcGFyYW0oc3RydWN0
IG1seDVlX3ByaXYgKnByaXYsDQogCXN3aXRjaCAocGFyYW1zLT5ycV93cV90eXBlKSB7DQogCWNh
c2UgTUxYNV9XUV9UWVBFX0xJTktFRF9MSVNUX1NUUklESU5HX1JROg0KIAkJTUxYNV9TRVQod3Es
IHdxLCBsb2dfd3FlX251bV9vZl9zdHJpZGVzLA0KLQkJCSBtbHg1ZV9tcHdxZV9nZXRfbG9nX251
bV9zdHJpZGVzKG1kZXYsIHBhcmFtcykgLQ0KKwkJCSBtbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9z
dHJpZGVzKG1kZXYsIHBhcmFtcywgeHNrKSAtDQogCQkJIE1MWDVfTVBXUUVfTE9HX05VTV9TVFJJ
REVTX0JBU0UpOw0KIAkJTUxYNV9TRVQod3EsIHdxLCBsb2dfd3FlX3N0cmlkZV9zaXplLA0KLQkJ
CSBtbHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKG1kZXYsIHBhcmFtcykgLQ0KKwkJCSBt
bHg1ZV9tcHdxZV9nZXRfbG9nX3N0cmlkZV9zaXplKG1kZXYsIHBhcmFtcywgeHNrKSAtDQogCQkJ
IE1MWDVfTVBXUUVfTE9HX1NUUklERV9TWl9CQVNFKTsNCi0JCU1MWDVfU0VUKHdxLCB3cSwgbG9n
X3dxX3N6LCBtbHg1ZV9tcHdxZV9nZXRfbG9nX3JxX3NpemUocGFyYW1zKSk7DQorCQlNTFg1X1NF
VCh3cSwgd3EsIGxvZ193cV9zeiwgbWx4NWVfbXB3cWVfZ2V0X2xvZ19ycV9zaXplKHBhcmFtcywg
eHNrKSk7DQogCQlicmVhazsNCiAJZGVmYXVsdDogLyogTUxYNV9XUV9UWVBFX0NZQ0xJQyAqLw0K
IAkJTUxYNV9TRVQod3EsIHdxLCBsb2dfd3Ffc3osIHBhcmFtcy0+bG9nX3JxX210dV9mcmFtZXMp
Ow0KLQkJbWx4NWVfYnVpbGRfcnFfZnJhZ3NfaW5mbyhtZGV2LCBwYXJhbXMsICZwYXJhbS0+ZnJh
Z3NfaW5mbyk7DQorCQltbHg1ZV9idWlsZF9ycV9mcmFnc19pbmZvKG1kZXYsIHBhcmFtcywgeHNr
LCAmcGFyYW0tPmZyYWdzX2luZm8pOw0KIAkJbmRzZWdzID0gcGFyYW0tPmZyYWdzX2luZm8ubnVt
X2ZyYWdzOw0KIAl9DQogDQpAQCAtMjA2MSw4ICsyMTQ2LDggQEAgc3RhdGljIHZvaWQgbWx4NWVf
YnVpbGRfZHJvcF9ycV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiAJcGFyYW0tPndx
LmJ1Zl9udW1hX25vZGUgPSBkZXZfdG9fbm9kZShtZGV2LT5kZXZpY2UpOw0KIH0NCiANCi1zdGF0
aWMgdm9pZCBtbHg1ZV9idWlsZF9zcV9wYXJhbV9jb21tb24oc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsDQotCQkJCQlzdHJ1Y3QgbWx4NWVfc3FfcGFyYW0gKnBhcmFtKQ0KK3ZvaWQgbWx4NWVfYnVp
bGRfc3FfcGFyYW1fY29tbW9uKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCQkgc3RydWN0
IG1seDVlX3NxX3BhcmFtICpwYXJhbSkNCiB7DQogCXZvaWQgKnNxYyA9IHBhcmFtLT5zcWM7DQog
CXZvaWQgKndxID0gTUxYNV9BRERSX09GKHNxYywgc3FjLCB3cSk7DQpAQCAtMjA5OCw5ICsyMTgz
LDEwIEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX2NvbW1vbl9jcV9wYXJhbShzdHJ1Y3QgbWx4
NWVfcHJpdiAqcHJpdiwNCiAJCU1MWDVfU0VUKGNxYywgY3FjLCBjcWVfc3osIENRRV9TVFJJREVf
MTI4X1BBRCk7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3J4X2NxX3BhcmFtKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KLQkJCQkgICAgc3RydWN0IG1seDVlX3BhcmFtcyAqcGFy
YW1zLA0KLQkJCQkgICAgc3RydWN0IG1seDVlX2NxX3BhcmFtICpwYXJhbSkNCit2b2lkIG1seDVl
X2J1aWxkX3J4X2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KKwkJCSAgICAgc3Ry
dWN0IG1seDVlX3BhcmFtcyAqcGFyYW1zLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3hza19wYXJh
bSAqeHNrLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX2NxX3BhcmFtICpwYXJhbSkNCiB7DQogCXN0
cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2ID0gcHJpdi0+bWRldjsNCiAJdm9pZCAqY3FjID0gcGFy
YW0tPmNxYzsNCkBAIC0yMTA4LDggKzIxOTQsOCBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9y
eF9jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiANCiAJc3dpdGNoIChwYXJhbXMt
PnJxX3dxX3R5cGUpIHsNCiAJY2FzZSBNTFg1X1dRX1RZUEVfTElOS0VEX0xJU1RfU1RSSURJTkdf
UlE6DQotCQlsb2dfY3Ffc2l6ZSA9IG1seDVlX21wd3FlX2dldF9sb2dfcnFfc2l6ZShwYXJhbXMp
ICsNCi0JCQltbHg1ZV9tcHdxZV9nZXRfbG9nX251bV9zdHJpZGVzKG1kZXYsIHBhcmFtcyk7DQor
CQlsb2dfY3Ffc2l6ZSA9IG1seDVlX21wd3FlX2dldF9sb2dfcnFfc2l6ZShwYXJhbXMsIHhzaykg
Kw0KKwkJCW1seDVlX21wd3FlX2dldF9sb2dfbnVtX3N0cmlkZXMobWRldiwgcGFyYW1zLCB4c2sp
Ow0KIAkJYnJlYWs7DQogCWRlZmF1bHQ6IC8qIE1MWDVfV1FfVFlQRV9DWUNMSUMgKi8NCiAJCWxv
Z19jcV9zaXplID0gcGFyYW1zLT5sb2dfcnFfbXR1X2ZyYW1lczsNCkBAIC0yMTI1LDkgKzIyMTEs
OSBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF9yeF9jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJp
diAqcHJpdiwNCiAJcGFyYW0tPmNxX3BlcmlvZF9tb2RlID0gcGFyYW1zLT5yeF9jcV9tb2RlcmF0
aW9uLmNxX3BlcmlvZF9tb2RlOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF90eF9j
cV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCi0JCQkJICAgIHN0cnVjdCBtbHg1ZV9w
YXJhbXMgKnBhcmFtcywNCi0JCQkJICAgIHN0cnVjdCBtbHg1ZV9jcV9wYXJhbSAqcGFyYW0pDQor
dm9pZCBtbHg1ZV9idWlsZF90eF9jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJ
CQkgICAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCisJCQkgICAgIHN0cnVjdCBtbHg1
ZV9jcV9wYXJhbSAqcGFyYW0pDQogew0KIAl2b2lkICpjcWMgPSBwYXJhbS0+Y3FjOw0KIA0KQEAg
LTIxMzcsOSArMjIyMyw5IEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX3R4X2NxX3BhcmFtKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LA0KIAlwYXJhbS0+Y3FfcGVyaW9kX21vZGUgPSBwYXJhbXMt
PnR4X2NxX21vZGVyYXRpb24uY3FfcGVyaW9kX21vZGU7DQogfQ0KIA0KLXN0YXRpYyB2b2lkIG1s
eDVlX2J1aWxkX2ljb19jcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCi0JCQkJICAg
ICB1OCBsb2dfd3Ffc2l6ZSwNCi0JCQkJICAgICBzdHJ1Y3QgbWx4NWVfY3FfcGFyYW0gKnBhcmFt
KQ0KK3ZvaWQgbWx4NWVfYnVpbGRfaWNvX2NxX3BhcmFtKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
LA0KKwkJCSAgICAgIHU4IGxvZ193cV9zaXplLA0KKwkJCSAgICAgIHN0cnVjdCBtbHg1ZV9jcV9w
YXJhbSAqcGFyYW0pDQogew0KIAl2b2lkICpjcWMgPSBwYXJhbS0+Y3FjOw0KIA0KQEAgLTIxNTAs
OSArMjIzNiw5IEBAIHN0YXRpYyB2b2lkIG1seDVlX2J1aWxkX2ljb19jcV9wYXJhbShzdHJ1Y3Qg
bWx4NWVfcHJpdiAqcHJpdiwNCiAJcGFyYW0tPmNxX3BlcmlvZF9tb2RlID0gTkVUX0RJTV9DUV9Q
RVJJT0RfTU9ERV9TVEFSVF9GUk9NX0VRRTsNCiB9DQogDQotc3RhdGljIHZvaWQgbWx4NWVfYnVp
bGRfaWNvc3FfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQotCQkJCSAgICB1OCBsb2df
d3Ffc2l6ZSwNCi0JCQkJICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pDQordm9pZCBt
bHg1ZV9idWlsZF9pY29zcV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgICAg
IHU4IGxvZ193cV9zaXplLA0KKwkJCSAgICAgc3RydWN0IG1seDVlX3NxX3BhcmFtICpwYXJhbSkN
CiB7DQogCXZvaWQgKnNxYyA9IHBhcmFtLT5zcWM7DQogCXZvaWQgKndxID0gTUxYNV9BRERSX09G
KHNxYywgc3FjLCB3cSk7DQpAQCAtMjE2Myw5ICsyMjQ5LDkgQEAgc3RhdGljIHZvaWQgbWx4NWVf
YnVpbGRfaWNvc3FfcGFyYW0oc3RydWN0IG1seDVlX3ByaXYgKnByaXYsDQogCU1MWDVfU0VUKHNx
Yywgc3FjLCByZWdfdW1yLCBNTFg1X0NBUF9FVEgocHJpdi0+bWRldiwgcmVnX3Vtcl9zcSkpOw0K
IH0NCiANCi1zdGF0aWMgdm9pZCBtbHg1ZV9idWlsZF94ZHBzcV9wYXJhbShzdHJ1Y3QgbWx4NWVf
cHJpdiAqcHJpdiwNCi0JCQkJICAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCi0JCQkJ
ICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pDQordm9pZCBtbHg1ZV9idWlsZF94ZHBz
cV9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCisJCQkgICAgIHN0cnVjdCBtbHg1ZV9w
YXJhbXMgKnBhcmFtcywNCisJCQkgICAgIHN0cnVjdCBtbHg1ZV9zcV9wYXJhbSAqcGFyYW0pDQog
ew0KIAl2b2lkICpzcWMgPSBwYXJhbS0+c3FjOw0KIAl2b2lkICp3cSA9IE1MWDVfQUREUl9PRihz
cWMsIHNxYywgd3EpOw0KQEAgLTIxOTMsMTQgKzIyNzksMTQgQEAgc3RhdGljIHZvaWQgbWx4NWVf
YnVpbGRfY2hhbm5lbF9wYXJhbShzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiB7DQogCXU4IGlj
b3NxX2xvZ193cV9zejsNCiANCi0JbWx4NWVfYnVpbGRfcnFfcGFyYW0ocHJpdiwgcGFyYW1zLCAm
Y3BhcmFtLT5ycSk7DQorCW1seDVlX2J1aWxkX3JxX3BhcmFtKHByaXYsIHBhcmFtcywgTlVMTCwg
JmNwYXJhbS0+cnEpOw0KIA0KIAlpY29zcV9sb2dfd3Ffc3ogPSBtbHg1ZV9idWlsZF9pY29zcV9s
b2dfd3Ffc3oocGFyYW1zLCAmY3BhcmFtLT5ycSk7DQogDQogCW1seDVlX2J1aWxkX3NxX3BhcmFt
KHByaXYsIHBhcmFtcywgJmNwYXJhbS0+c3EpOw0KIAltbHg1ZV9idWlsZF94ZHBzcV9wYXJhbShw
cml2LCBwYXJhbXMsICZjcGFyYW0tPnhkcF9zcSk7DQogCW1seDVlX2J1aWxkX2ljb3NxX3BhcmFt
KHByaXYsIGljb3NxX2xvZ193cV9zeiwgJmNwYXJhbS0+aWNvc3EpOw0KLQltbHg1ZV9idWlsZF9y
eF9jcV9wYXJhbShwcml2LCBwYXJhbXMsICZjcGFyYW0tPnJ4X2NxKTsNCisJbWx4NWVfYnVpbGRf
cnhfY3FfcGFyYW0ocHJpdiwgcGFyYW1zLCBOVUxMLCAmY3BhcmFtLT5yeF9jcSk7DQogCW1seDVl
X2J1aWxkX3R4X2NxX3BhcmFtKHByaXYsIHBhcmFtcywgJmNwYXJhbS0+dHhfY3EpOw0KIAltbHg1
ZV9idWlsZF9pY29fY3FfcGFyYW0ocHJpdiwgaWNvc3FfbG9nX3dxX3N6LCAmY3BhcmFtLT5pY29z
cV9jcSk7DQogfQ0KQEAgLTIyMjEsNyArMjMwNywxMiBAQCBpbnQgbWx4NWVfb3Blbl9jaGFubmVs
cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdiwNCiANCiAJbWx4NWVfYnVpbGRfY2hhbm5lbF9wYXJh
bShwcml2LCAmY2hzLT5wYXJhbXMsIGNwYXJhbSk7DQogCWZvciAoaSA9IDA7IGkgPCBjaHMtPm51
bTsgaSsrKSB7DQotCQllcnIgPSBtbHg1ZV9vcGVuX2NoYW5uZWwocHJpdiwgaSwgJmNocy0+cGFy
YW1zLCBjcGFyYW0sICZjaHMtPmNbaV0pOw0KKwkJc3RydWN0IHhkcF91bWVtICp1bWVtID0gTlVM
TDsNCisNCisJCWlmIChjaHMtPnBhcmFtcy54ZHBfcHJvZykNCisJCQl1bWVtID0gbWx4NWVfeHNr
X2dldF91bWVtKCZjaHMtPnBhcmFtcywgY2hzLT5wYXJhbXMueHNrLCBpKTsNCisNCisJCWVyciA9
IG1seDVlX29wZW5fY2hhbm5lbChwcml2LCBpLCAmY2hzLT5wYXJhbXMsIGNwYXJhbSwgdW1lbSwg
JmNocy0+Y1tpXSk7DQogCQlpZiAoZXJyKQ0KIAkJCWdvdG8gZXJyX2Nsb3NlX2NoYW5uZWxzOw0K
IAl9DQpAQCAtMjI2Myw2ICsyMzU0LDEwIEBAIHN0YXRpYyBpbnQgbWx4NWVfd2FpdF9jaGFubmVs
c19taW5fcnhfd3FlcyhzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgKmNocykNCiAJCWludCB0aW1lb3V0
ID0gZXJyID8gMCA6IE1MWDVFX1JRX1dRRVNfVElNRU9VVDsNCiANCiAJCWVyciB8PSBtbHg1ZV93
YWl0X2Zvcl9taW5fcnhfd3FlcygmY2hzLT5jW2ldLT5ycSwgdGltZW91dCk7DQorDQorCQkvKiBE
b24ndCB3YWl0IG9uIHRoZSBYU0sgUlEsIGJlY2F1c2UgdGhlIG5ld2VyIHhkcHNvY2sgc2FtcGxl
DQorCQkgKiBkb2Vzbid0IHByb3ZpZGUgYW55IEZpbGwgUmluZyBlbnRyaWVzIGF0IHRoZSBzZXR1
cCBzdGFnZS4NCisJCSAqLw0KIAl9DQogDQogCXJldHVybiBlcnIgPyAtRVRJTUVET1VUIDogMDsN
CkBAIC0yMzM1LDM1ICsyNDMwLDM1IEBAIGludCBtbHg1ZV9jcmVhdGVfaW5kaXJlY3RfcnF0KHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlyZXR1cm4gZXJyOw0KIH0NCiANCi1pbnQgbWx4NWVf
Y3JlYXRlX2RpcmVjdF9ycXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KK2ludCBtbHg1ZV9j
cmVhdGVfZGlyZWN0X3JxdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV90
aXIgKnRpcnMpDQogew0KLQlzdHJ1Y3QgbWx4NWVfcnF0ICpycXQ7DQorCWNvbnN0IGludCBtYXhf
bmNoID0gbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCiAJaW50
IGVycjsNCiAJaW50IGl4Ow0KIA0KLQlmb3IgKGl4ID0gMDsgaXggPCBtbHg1ZV9nZXRfbmV0ZGV2
X21heF9jaGFubmVscyhwcml2LT5uZXRkZXYpOyBpeCsrKSB7DQotCQlycXQgPSAmcHJpdi0+ZGly
ZWN0X3RpcltpeF0ucnF0Ow0KLQkJZXJyID0gbWx4NWVfY3JlYXRlX3JxdChwcml2LCAxIC8qc2l6
ZSAqLywgcnF0KTsNCi0JCWlmIChlcnIpDQorCWZvciAoaXggPSAwOyBpeCA8IG1heF9uY2g7IGl4
KyspIHsNCisJCWVyciA9IG1seDVlX2NyZWF0ZV9ycXQocHJpdiwgMSAvKnNpemUgKi8sICZ0aXJz
W2l4XS5ycXQpOw0KKwkJaWYgKHVubGlrZWx5KGVycikpDQogCQkJZ290byBlcnJfZGVzdHJveV9y
cXRzOw0KIAl9DQogDQogCXJldHVybiAwOw0KIA0KIGVycl9kZXN0cm95X3JxdHM6DQotCW1seDVf
Y29yZV93YXJuKHByaXYtPm1kZXYsICJjcmVhdGUgZGlyZWN0IHJxdHMgZmFpbGVkLCAlZFxuIiwg
ZXJyKTsNCisJbWx4NV9jb3JlX3dhcm4ocHJpdi0+bWRldiwgImNyZWF0ZSBycXRzIGZhaWxlZCwg
JWRcbiIsIGVycik7DQogCWZvciAoaXgtLTsgaXggPj0gMDsgaXgtLSkNCi0JCW1seDVlX2Rlc3Ry
b3lfcnF0KHByaXYsICZwcml2LT5kaXJlY3RfdGlyW2l4XS5ycXQpOw0KKwkJbWx4NWVfZGVzdHJv
eV9ycXQocHJpdiwgJnRpcnNbaXhdLnJxdCk7DQogDQogCXJldHVybiBlcnI7DQogfQ0KIA0KLXZv
aWQgbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCit2
b2lkIG1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0
cnVjdCBtbHg1ZV90aXIgKnRpcnMpDQogew0KKwljb25zdCBpbnQgbWF4X25jaCA9IG1seDVlX2dl
dF9uZXRkZXZfbWF4X2NoYW5uZWxzKHByaXYtPm5ldGRldik7DQogCWludCBpOw0KIA0KLQlmb3Ig
KGkgPSAwOyBpIDwgbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsg
aSsrKQ0KLQkJbWx4NWVfZGVzdHJveV9ycXQocHJpdiwgJnByaXYtPmRpcmVjdF90aXJbaV0ucnF0
KTsNCisJZm9yIChpID0gMDsgaSA8IG1heF9uY2g7IGkrKykNCisJCW1seDVlX2Rlc3Ryb3lfcnF0
KHByaXYsICZ0aXJzW2ldLnJxdCk7DQogfQ0KIA0KIHN0YXRpYyBpbnQgbWx4NWVfcnhfaGFzaF9m
bihpbnQgaGZ1bmMpDQpAQCAtMjc5OSwxMCArMjg5NCwxNCBAQCB2b2lkIG1seDVlX2FjdGl2YXRl
X3ByaXZfY2hhbm5lbHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogDQogCW1seDVlX3dhaXRf
Y2hhbm5lbHNfbWluX3J4X3dxZXMoJnByaXYtPmNoYW5uZWxzKTsNCiAJbWx4NWVfcmVkaXJlY3Rf
cnF0c190b19jaGFubmVscyhwcml2LCAmcHJpdi0+Y2hhbm5lbHMpOw0KKw0KKwltbHg1ZV94c2tf
cmVkaXJlY3RfcnF0c190b19jaGFubmVscyhwcml2LCAmcHJpdi0+Y2hhbm5lbHMpOw0KIH0NCiAN
CiB2b2lkIG1seDVlX2RlYWN0aXZhdGVfcHJpdl9jaGFubmVscyhzdHJ1Y3QgbWx4NWVfcHJpdiAq
cHJpdikNCiB7DQorCW1seDVlX3hza19yZWRpcmVjdF9ycXRzX3RvX2Ryb3AocHJpdiwgJnByaXYt
PmNoYW5uZWxzKTsNCisNCiAJbWx4NWVfcmVkaXJlY3RfcnF0c190b19kcm9wKHByaXYpOw0KIA0K
IAlpZiAobWx4NWVfaXNfdnBvcnRfcmVwKHByaXYpKQ0KQEAgLTI4ODEsOSArMjk4MCwxMiBAQCB2
b2lkIG1seDVlX3RpbWVzdGFtcF9pbml0KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIGludCBt
bHg1ZV9vcGVuX2xvY2tlZChzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2KQ0KIHsNCiAJc3RydWN0
IG1seDVlX3ByaXYgKnByaXYgPSBuZXRkZXZfcHJpdihuZXRkZXYpOw0KKwlib29sIGlzX3hkcCA9
IHByaXYtPmNoYW5uZWxzLnBhcmFtcy54ZHBfcHJvZzsNCiAJaW50IGVycjsNCiANCiAJc2V0X2Jp
dChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSk7DQorCWlmIChpc194ZHApDQorCQlt
bHg1ZV94ZHBfc2V0X29wZW4ocHJpdik7DQogDQogCWVyciA9IG1seDVlX29wZW5fY2hhbm5lbHMo
cHJpdiwgJnByaXYtPmNoYW5uZWxzKTsNCiAJaWYgKGVycikNCkBAIC0yODk4LDYgKzMwMDAsOCBA
QCBpbnQgbWx4NWVfb3Blbl9sb2NrZWQoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldikNCiAJcmV0
dXJuIDA7DQogDQogZXJyX2NsZWFyX3N0YXRlX29wZW5lZF9mbGFnOg0KKwlpZiAoaXNfeGRwKQ0K
KwkJbWx4NWVfeGRwX3NldF9jbG9zZWQocHJpdik7DQogCWNsZWFyX2JpdChNTFg1RV9TVEFURV9P
UEVORUQsICZwcml2LT5zdGF0ZSk7DQogCXJldHVybiBlcnI7DQogfQ0KQEAgLTI5MjksNiArMzAz
Myw4IEBAIGludCBtbHg1ZV9jbG9zZV9sb2NrZWQoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldikN
CiAJaWYgKCF0ZXN0X2JpdChNTFg1RV9TVEFURV9PUEVORUQsICZwcml2LT5zdGF0ZSkpDQogCQly
ZXR1cm4gMDsNCiANCisJaWYgKHByaXYtPmNoYW5uZWxzLnBhcmFtcy54ZHBfcHJvZykNCisJCW1s
eDVlX3hkcF9zZXRfY2xvc2VkKHByaXYpOw0KIAljbGVhcl9iaXQoTUxYNUVfU1RBVEVfT1BFTkVE
LCAmcHJpdi0+c3RhdGUpOw0KIA0KIAluZXRpZl9jYXJyaWVyX29mZihwcml2LT5uZXRkZXYpOw0K
QEAgLTMxODUsMTMgKzMyOTEsMTMgQEAgaW50IG1seDVlX2NyZWF0ZV9pbmRpcmVjdF90aXJzKHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2LCBib29sIGlubmVyX3R0YykNCiAJcmV0dXJuIGVycjsNCiB9
DQogDQotaW50IG1seDVlX2NyZWF0ZV9kaXJlY3RfdGlycyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJp
dikNCitpbnQgbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
LCBzdHJ1Y3QgbWx4NWVfdGlyICp0aXJzKQ0KIHsNCi0JaW50IG5jaCA9IG1seDVlX2dldF9uZXRk
ZXZfbWF4X2NoYW5uZWxzKHByaXYtPm5ldGRldik7DQorCWNvbnN0IGludCBtYXhfbmNoID0gbWx4
NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCiAJc3RydWN0IG1seDVl
X3RpciAqdGlyOw0KIAl2b2lkICp0aXJjOw0KIAlpbnQgaW5sZW47DQotCWludCBlcnI7DQorCWlu
dCBlcnIgPSAwOw0KIAl1MzIgKmluOw0KIAlpbnQgaXg7DQogDQpAQCAtMzIwMCwyNSArMzMwNiwy
NCBAQCBpbnQgbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2
KQ0KIAlpZiAoIWluKQ0KIAkJcmV0dXJuIC1FTk9NRU07DQogDQotCWZvciAoaXggPSAwOyBpeCA8
IG5jaDsgaXgrKykgew0KKwlmb3IgKGl4ID0gMDsgaXggPCBtYXhfbmNoOyBpeCsrKSB7DQogCQlt
ZW1zZXQoaW4sIDAsIGlubGVuKTsNCi0JCXRpciA9ICZwcml2LT5kaXJlY3RfdGlyW2l4XTsNCisJ
CXRpciA9ICZ0aXJzW2l4XTsNCiAJCXRpcmMgPSBNTFg1X0FERFJfT0YoY3JlYXRlX3Rpcl9pbiwg
aW4sIGN0eCk7DQotCQltbHg1ZV9idWlsZF9kaXJlY3RfdGlyX2N0eChwcml2LCBwcml2LT5kaXJl
Y3RfdGlyW2l4XS5ycXQucnF0biwgdGlyYyk7DQorCQltbHg1ZV9idWlsZF9kaXJlY3RfdGlyX2N0
eChwcml2LCB0aXItPnJxdC5ycXRuLCB0aXJjKTsNCiAJCWVyciA9IG1seDVlX2NyZWF0ZV90aXIo
cHJpdi0+bWRldiwgdGlyLCBpbiwgaW5sZW4pOw0KLQkJaWYgKGVycikNCisJCWlmICh1bmxpa2Vs
eShlcnIpKQ0KIAkJCWdvdG8gZXJyX2Rlc3Ryb3lfY2hfdGlyczsNCiAJfQ0KIA0KLQlrdmZyZWUo
aW4pOw0KLQ0KLQlyZXR1cm4gMDsNCisJZ290byBvdXQ7DQogDQogZXJyX2Rlc3Ryb3lfY2hfdGly
czoNCi0JbWx4NV9jb3JlX3dhcm4ocHJpdi0+bWRldiwgImNyZWF0ZSBkaXJlY3QgdGlycyBmYWls
ZWQsICVkXG4iLCBlcnIpOw0KKwltbHg1X2NvcmVfd2Fybihwcml2LT5tZGV2LCAiY3JlYXRlIHRp
cnMgZmFpbGVkLCAlZFxuIiwgZXJyKTsNCiAJZm9yIChpeC0tOyBpeCA+PSAwOyBpeC0tKQ0KLQkJ
bWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRldiwgJnByaXYtPmRpcmVjdF90aXJbaXhdKTsNCisJ
CW1seDVlX2Rlc3Ryb3lfdGlyKHByaXYtPm1kZXYsICZ0aXJzW2l4XSk7DQogDQorb3V0Og0KIAlr
dmZyZWUoaW4pOw0KIA0KIAlyZXR1cm4gZXJyOw0KQEAgLTMyMzgsMTMgKzMzNDMsMTMgQEAgdm9p
ZCBtbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIGJv
b2wgaW5uZXJfdHRjKQ0KIAkJbWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRldiwgJnByaXYtPmlu
bmVyX2luZGlyX3RpcltpXSk7DQogfQ0KIA0KLXZvaWQgbWx4NWVfZGVzdHJveV9kaXJlY3RfdGly
cyhzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCit2b2lkIG1seDVlX2Rlc3Ryb3lfZGlyZWN0X3Rp
cnMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHN0cnVjdCBtbHg1ZV90aXIgKnRpcnMpDQogew0K
LQlpbnQgbmNoID0gbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsN
CisJY29uc3QgaW50IG1heF9uY2ggPSBtbHg1ZV9nZXRfbmV0ZGV2X21heF9jaGFubmVscyhwcml2
LT5uZXRkZXYpOw0KIAlpbnQgaTsNCiANCi0JZm9yIChpID0gMDsgaSA8IG5jaDsgaSsrKQ0KLQkJ
bWx4NWVfZGVzdHJveV90aXIocHJpdi0+bWRldiwgJnByaXYtPmRpcmVjdF90aXJbaV0pOw0KKwlm
b3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKQ0KKwkJbWx4NWVfZGVzdHJveV90aXIocHJpdi0+
bWRldiwgJnRpcnNbaV0pOw0KIH0NCiANCiBzdGF0aWMgaW50IG1seDVlX21vZGlmeV9jaGFubmVs
c19zY2F0dGVyX2ZjcyhzdHJ1Y3QgbWx4NWVfY2hhbm5lbHMgKmNocywgYm9vbCBlbmFibGUpDQpA
QCAtMzM4NiwxMSArMzQ5MSwxMiBAQCB2b2lkIG1seDVlX2ZvbGRfc3dfc3RhdHM2NChzdHJ1Y3Qg
bWx4NWVfcHJpdiAqcHJpdiwgc3RydWN0IHJ0bmxfbGlua19zdGF0czY0ICpzKQ0KIA0KIAlmb3Ig
KGkgPSAwOyBpIDwgbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsg
aSsrKSB7DQogCQlzdHJ1Y3QgbWx4NWVfY2hhbm5lbF9zdGF0cyAqY2hhbm5lbF9zdGF0cyA9ICZw
cml2LT5jaGFubmVsX3N0YXRzW2ldOw0KKwkJc3RydWN0IG1seDVlX3JxX3N0YXRzICp4c2tycV9z
dGF0cyA9ICZjaGFubmVsX3N0YXRzLT54c2tycTsNCiAJCXN0cnVjdCBtbHg1ZV9ycV9zdGF0cyAq
cnFfc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+cnE7DQogCQlpbnQgajsNCiANCi0JCXMtPnJ4X3Bh
Y2tldHMgICArPSBycV9zdGF0cy0+cGFja2V0czsNCi0JCXMtPnJ4X2J5dGVzICAgICArPSBycV9z
dGF0cy0+Ynl0ZXM7DQorCQlzLT5yeF9wYWNrZXRzICAgKz0gcnFfc3RhdHMtPnBhY2tldHMgKyB4
c2tycV9zdGF0cy0+cGFja2V0czsNCisJCXMtPnJ4X2J5dGVzICAgICArPSBycV9zdGF0cy0+Ynl0
ZXMgKyB4c2tycV9zdGF0cy0+Ynl0ZXM7DQogDQogCQlmb3IgKGogPSAwOyBqIDwgcHJpdi0+bWF4
X29wZW5lZF90YzsgaisrKSB7DQogCQkJc3RydWN0IG1seDVlX3NxX3N0YXRzICpzcV9zdGF0cyA9
ICZjaGFubmVsX3N0YXRzLT5zcVtqXTsNCkBAIC0zNDg5LDYgKzM1OTUsMTMgQEAgc3RhdGljIGlu
dCBzZXRfZmVhdHVyZV9scm8oc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgYm9vbCBlbmFibGUp
DQogDQogCW11dGV4X2xvY2soJnByaXYtPnN0YXRlX2xvY2spOw0KIA0KKwlpZiAoZW5hYmxlICYm
IHByaXYtPnhzay5yZWZjbnQpIHsNCisJCW5ldGRldl93YXJuKG5ldGRldiwgIkxSTyBpcyBpbmNv
bXBhdGlibGUgd2l0aCBBRl9YRFAgKCVodSBYU0tzIGFyZSBhY3RpdmUpXG4iLA0KKwkJCSAgICBw
cml2LT54c2sucmVmY250KTsNCisJCWVyciA9IC1FSU5WQUw7DQorCQlnb3RvIG91dDsNCisJfQ0K
Kw0KIAlvbGRfcGFyYW1zID0gJnByaXYtPmNoYW5uZWxzLnBhcmFtczsNCiAJaWYgKGVuYWJsZSAm
JiAhTUxYNUVfR0VUX1BGTEFHKG9sZF9wYXJhbXMsIE1MWDVFX1BGTEFHX1JYX1NUUklESU5HX1JR
KSkgew0KIAkJbmV0ZGV2X3dhcm4obmV0ZGV2LCAiY2FuJ3Qgc2V0IExSTyB3aXRoIGxlZ2FjeSBS
UVxuIik7DQpAQCAtMzUwMiw4ICszNjE1LDggQEAgc3RhdGljIGludCBzZXRfZmVhdHVyZV9scm8o
c3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgYm9vbCBlbmFibGUpDQogCW5ld19jaGFubmVscy5w
YXJhbXMubHJvX2VuID0gZW5hYmxlOw0KIA0KIAlpZiAob2xkX3BhcmFtcy0+cnFfd3FfdHlwZSAh
PSBNTFg1X1dRX1RZUEVfQ1lDTElDKSB7DQotCQlpZiAobWx4NWVfcnhfbXB3cWVfaXNfbGluZWFy
X3NrYihtZGV2LCBvbGRfcGFyYW1zKSA9PQ0KLQkJICAgIG1seDVlX3J4X21wd3FlX2lzX2xpbmVh
cl9za2IobWRldiwgJm5ld19jaGFubmVscy5wYXJhbXMpKQ0KKwkJaWYgKG1seDVlX3J4X21wd3Fl
X2lzX2xpbmVhcl9za2IobWRldiwgb2xkX3BhcmFtcywgTlVMTCkgPT0NCisJCSAgICBtbHg1ZV9y
eF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYsICZuZXdfY2hhbm5lbHMucGFyYW1zLCBOVUxMKSkN
CiAJCQlyZXNldCA9IGZhbHNlOw0KIAl9DQogDQpAQCAtMzY4OCw2ICszODAxLDQzIEBAIHN0YXRp
YyBuZXRkZXZfZmVhdHVyZXNfdCBtbHg1ZV9maXhfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2Ug
Km5ldGRldiwNCiAJcmV0dXJuIGZlYXR1cmVzOw0KIH0NCiANCitzdGF0aWMgYm9vbCBtbHg1ZV94
c2tfdmFsaWRhdGVfbXR1KHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsDQorCQkJCSAgIHN0cnVj
dCBtbHg1ZV9jaGFubmVscyAqY2hzLA0KKwkJCQkgICBzdHJ1Y3QgbWx4NWVfcGFyYW1zICpuZXdf
cGFyYW1zLA0KKwkJCQkgICBzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldikNCit7DQorCXUxNiBp
eDsNCisNCisJZm9yIChpeCA9IDA7IGl4IDwgY2hzLT5wYXJhbXMubnVtX2NoYW5uZWxzOyBpeCsr
KSB7DQorCQlzdHJ1Y3QgeGRwX3VtZW0gKnVtZW0gPSBtbHg1ZV94c2tfZ2V0X3VtZW0oJmNocy0+
cGFyYW1zLCBjaHMtPnBhcmFtcy54c2ssIGl4KTsNCisJCXN0cnVjdCBtbHg1ZV94c2tfcGFyYW0g
eHNrOw0KKw0KKwkJaWYgKCF1bWVtKQ0KKwkJCWNvbnRpbnVlOw0KKw0KKwkJbWx4NWVfYnVpbGRf
eHNrX3BhcmFtKHVtZW0sICZ4c2spOw0KKw0KKwkJaWYgKCFtbHg1ZV92YWxpZGF0ZV94c2tfcGFy
YW0obmV3X3BhcmFtcywgJnhzaywgbWRldikpIHsNCisJCQl1MzIgaHIgPSBtbHg1ZV9nZXRfbGlu
ZWFyX3JxX2hlYWRyb29tKG5ld19wYXJhbXMsICZ4c2spOw0KKwkJCWludCBtYXhfbXR1X2ZyYW1l
LCBtYXhfbXR1X3BhZ2UsIG1heF9tdHU7DQorDQorCQkJLyogVHdvIGNyaXRlcmlhIG11c3QgYmUg
bWV0Og0KKwkJCSAqIDEuIEhXIE1UVSArIGFsbCBoZWFkcm9vbXMgPD0gWFNLIGZyYW1lIHNpemUu
DQorCQkJICogMi4gU2l6ZSBvZiBTS0JzIGFsbG9jYXRlZCBvbiBYRFBfUEFTUyA8PSBQQUdFX1NJ
WkUuDQorCQkJICovDQorCQkJbWF4X210dV9mcmFtZSA9IE1MWDVFX0hXMlNXX01UVShuZXdfcGFy
YW1zLCB4c2suY2h1bmtfc2l6ZSAtIGhyKTsNCisJCQltYXhfbXR1X3BhZ2UgPSBtbHg1ZV94ZHBf
bWF4X210dShuZXdfcGFyYW1zLCAmeHNrKTsNCisJCQltYXhfbXR1ID0gbWluKG1heF9tdHVfZnJh
bWUsIG1heF9tdHVfcGFnZSk7DQorDQorCQkJbmV0ZGV2X2VycihuZXRkZXYsICJNVFUgJWQgaXMg
dG9vIGJpZyBmb3IgYW4gWFNLIHJ1bm5pbmcgb24gY2hhbm5lbCAlaHUuIFRyeSBNVFUgPD0gJWRc
biIsDQorCQkJCSAgIG5ld19wYXJhbXMtPnN3X210dSwgaXgsIG1heF9tdHUpOw0KKwkJCXJldHVy
biBmYWxzZTsNCisJCX0NCisJfQ0KKw0KKwlyZXR1cm4gdHJ1ZTsNCit9DQorDQogaW50IG1seDVl
X2NoYW5nZV9tdHUoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgaW50IG5ld19tdHUsDQogCQkg
ICAgIGNoYW5nZV9od19tdHVfY2Igc2V0X210dV9jYikNCiB7DQpAQCAtMzcwOCwxOCArMzg1OCwz
MSBAQCBpbnQgbWx4NWVfY2hhbmdlX210dShzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LCBpbnQg
bmV3X210dSwNCiAJbmV3X2NoYW5uZWxzLnBhcmFtcy5zd19tdHUgPSBuZXdfbXR1Ow0KIA0KIAlp
ZiAocGFyYW1zLT54ZHBfcHJvZyAmJg0KLQkgICAgIW1seDVlX3J4X2lzX2xpbmVhcl9za2IoJm5l
d19jaGFubmVscy5wYXJhbXMpKSB7DQorCSAgICAhbWx4NWVfcnhfaXNfbGluZWFyX3NrYigmbmV3
X2NoYW5uZWxzLnBhcmFtcywgTlVMTCkpIHsNCiAJCW5ldGRldl9lcnIobmV0ZGV2LCAiTVRVKCVk
KSA+ICVkIGlzIG5vdCBhbGxvd2VkIHdoaWxlIFhEUCBlbmFibGVkXG4iLA0KIAkJCSAgIG5ld19t
dHUsIG1seDVlX3hkcF9tYXhfbXR1KHBhcmFtcywgTlVMTCkpOw0KIAkJZXJyID0gLUVJTlZBTDsN
CiAJCWdvdG8gb3V0Ow0KIAl9DQogDQorCWlmIChwcml2LT54c2sucmVmY250ICYmDQorCSAgICAh
bWx4NWVfeHNrX3ZhbGlkYXRlX210dShuZXRkZXYsICZwcml2LT5jaGFubmVscywNCisJCQkJICAg
ICZuZXdfY2hhbm5lbHMucGFyYW1zLCBwcml2LT5tZGV2KSkgew0KKwkJZXJyID0gLUVJTlZBTDsN
CisJCWdvdG8gb3V0Ow0KKwl9DQorDQogCWlmIChwYXJhbXMtPnJxX3dxX3R5cGUgPT0gTUxYNV9X
UV9UWVBFX0xJTktFRF9MSVNUX1NUUklESU5HX1JRKSB7DQotCQlib29sIGlzX2xpbmVhciA9IG1s
eDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IocHJpdi0+bWRldiwgJm5ld19jaGFubmVscy5wYXJh
bXMpOw0KLQkJdTggcHB3X29sZCA9IG1seDVlX21wd3FlX2xvZ19wa3RzX3Blcl93cWUocGFyYW1z
KTsNCi0JCXU4IHBwd19uZXcgPSBtbHg1ZV9tcHdxZV9sb2dfcGt0c19wZXJfd3FlKCZuZXdfY2hh
bm5lbHMucGFyYW1zKTsNCisJCWJvb2wgaXNfbGluZWFyID0gbWx4NWVfcnhfbXB3cWVfaXNfbGlu
ZWFyX3NrYihwcml2LT5tZGV2LA0KKwkJCQkJCQkgICAgICAmbmV3X2NoYW5uZWxzLnBhcmFtcywN
CisJCQkJCQkJICAgICAgTlVMTCk7DQorCQl1OCBwcHdfb2xkID0gbWx4NWVfbXB3cWVfbG9nX3Br
dHNfcGVyX3dxZShwYXJhbXMsIE5VTEwpOw0KKwkJdTggcHB3X25ldyA9IG1seDVlX21wd3FlX2xv
Z19wa3RzX3Blcl93cWUoJm5ld19jaGFubmVscy5wYXJhbXMsIE5VTEwpOw0KIA0KKwkJLyogSWYg
WFNLIGlzIGFjdGl2ZSwgWFNLIFJRcyBhcmUgbGluZWFyLiAqLw0KKwkJaXNfbGluZWFyIHw9IHBy
aXYtPnhzay5yZWZjbnQ7DQorDQorCQkvKiBBbHdheXMgcmVzZXQgaW4gbGluZWFyIG1vZGUgLSBo
d19tdHUgaXMgdXNlZCBpbiBkYXRhIHBhdGguICovDQogCQlyZXNldCA9IHJlc2V0ICYmIChpc19s
aW5lYXIgfHwgKHBwd19vbGQgIT0gcHB3X25ldykpOw0KIAl9DQogDQpAQCAtNDE0OSw3ICs0MzEy
LDEwIEBAIHN0YXRpYyBpbnQgbWx4NWVfeGRwX2FsbG93ZWQoc3RydWN0IG1seDVlX3ByaXYgKnBy
aXYsIHN0cnVjdCBicGZfcHJvZyAqcHJvZykNCiAJbmV3X2NoYW5uZWxzLnBhcmFtcyA9IHByaXYt
PmNoYW5uZWxzLnBhcmFtczsNCiAJbmV3X2NoYW5uZWxzLnBhcmFtcy54ZHBfcHJvZyA9IHByb2c7
DQogDQotCWlmICghbWx4NWVfcnhfaXNfbGluZWFyX3NrYigmbmV3X2NoYW5uZWxzLnBhcmFtcykp
IHsNCisJLyogTm8gWFNLIHBhcmFtczogQUZfWERQIGNhbid0IGJlIGVuYWJsZWQgeWV0IGF0IHRo
ZSBwb2ludCBvZiBzZXR0aW5nDQorCSAqIHRoZSBYRFAgcHJvZ3JhbS4NCisJICovDQorCWlmICgh
bWx4NWVfcnhfaXNfbGluZWFyX3NrYigmbmV3X2NoYW5uZWxzLnBhcmFtcywgTlVMTCkpIHsNCiAJ
CW5ldGRldl93YXJuKG5ldGRldiwgIlhEUCBpcyBub3QgYWxsb3dlZCB3aXRoIE1UVSglZCkgPiAl
ZFxuIiwNCiAJCQkgICAgbmV3X2NoYW5uZWxzLnBhcmFtcy5zd19tdHUsDQogCQkJICAgIG1seDVl
X3hkcF9tYXhfbXR1KCZuZXdfY2hhbm5lbHMucGFyYW1zLCBOVUxMKSk7DQpAQCAtNDIxMywxOSAr
NDM3OSwyOSBAQCBzdGF0aWMgaW50IG1seDVlX3hkcF9zZXQoc3RydWN0IG5ldF9kZXZpY2UgKm5l
dGRldiwgc3RydWN0IGJwZl9wcm9nICpwcm9nKQ0KIAkgKi8NCiAJZm9yIChpID0gMDsgaSA8IHBy
aXYtPmNoYW5uZWxzLm51bTsgaSsrKSB7DQogCQlzdHJ1Y3QgbWx4NWVfY2hhbm5lbCAqYyA9IHBy
aXYtPmNoYW5uZWxzLmNbaV07DQorCQlib29sIHhza19vcGVuID0gdGVzdF9iaXQoTUxYNUVfQ0hB
Tk5FTF9TVEFURV9YU0ssIGMtPnN0YXRlKTsNCiANCiAJCWNsZWFyX2JpdChNTFg1RV9SUV9TVEFU
RV9FTkFCTEVELCAmYy0+cnEuc3RhdGUpOw0KKwkJaWYgKHhza19vcGVuKQ0KKwkJCWNsZWFyX2Jp
dChNTFg1RV9SUV9TVEFURV9FTkFCTEVELCAmYy0+eHNrcnEuc3RhdGUpOw0KIAkJbmFwaV9zeW5j
aHJvbml6ZSgmYy0+bmFwaSk7DQogCQkvKiBwcmV2ZW50IG1seDVlX3BvbGxfcnhfY3EgZnJvbSBh
Y2Nlc3NpbmcgcnEtPnhkcF9wcm9nICovDQogDQogCQlvbGRfcHJvZyA9IHhjaGcoJmMtPnJxLnhk
cF9wcm9nLCBwcm9nKTsNCisJCWlmIChvbGRfcHJvZykNCisJCQlicGZfcHJvZ19wdXQob2xkX3By
b2cpOw0KKw0KKwkJaWYgKHhza19vcGVuKSB7DQorCQkJb2xkX3Byb2cgPSB4Y2hnKCZjLT54c2ty
cS54ZHBfcHJvZywgcHJvZyk7DQorCQkJaWYgKG9sZF9wcm9nKQ0KKwkJCQlicGZfcHJvZ19wdXQo
b2xkX3Byb2cpOw0KKwkJfQ0KIA0KIAkJc2V0X2JpdChNTFg1RV9SUV9TVEFURV9FTkFCTEVELCAm
Yy0+cnEuc3RhdGUpOw0KKwkJaWYgKHhza19vcGVuKQ0KKwkJCXNldF9iaXQoTUxYNUVfUlFfU1RB
VEVfRU5BQkxFRCwgJmMtPnhza3JxLnN0YXRlKTsNCiAJCS8qIG5hcGlfc2NoZWR1bGUgaW4gY2Fz
ZSB3ZSBoYXZlIG1pc3NlZCBhbnl0aGluZyAqLw0KIAkJbmFwaV9zY2hlZHVsZSgmYy0+bmFwaSk7
DQotDQotCQlpZiAob2xkX3Byb2cpDQotCQkJYnBmX3Byb2dfcHV0KG9sZF9wcm9nKTsNCiAJfQ0K
IA0KIHVubG9jazoNCkBAIC00MjU2LDYgKzQ0MzIsOSBAQCBzdGF0aWMgaW50IG1seDVlX3hkcChz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgbmV0ZGV2X2JwZiAqeGRwKQ0KIAljYXNlIFhE
UF9RVUVSWV9QUk9HOg0KIAkJeGRwLT5wcm9nX2lkID0gbWx4NWVfeGRwX3F1ZXJ5KGRldik7DQog
CQlyZXR1cm4gMDsNCisJY2FzZSBYRFBfU0VUVVBfWFNLX1VNRU06DQorCQlyZXR1cm4gbWx4NWVf
eHNrX3NldHVwX3VtZW0oZGV2LCB4ZHAtPnhzay51bWVtLA0KKwkJCQkJICAgIHhkcC0+eHNrLnF1
ZXVlX2lkKTsNCiAJZGVmYXVsdDoNCiAJCXJldHVybiAtRUlOVkFMOw0KIAl9DQpAQCAtNDMzOCw2
ICs0NTE3LDcgQEAgY29uc3Qgc3RydWN0IG5ldF9kZXZpY2Vfb3BzIG1seDVlX25ldGRldl9vcHMg
PSB7DQogCS5uZG9fdHhfdGltZW91dCAgICAgICAgICA9IG1seDVlX3R4X3RpbWVvdXQsDQogCS5u
ZG9fYnBmCQkgPSBtbHg1ZV94ZHAsDQogCS5uZG9feGRwX3htaXQgICAgICAgICAgICA9IG1seDVl
X3hkcF94bWl0LA0KKwkubmRvX3hza19hc3luY194bWl0ICAgICAgPSBtbHg1ZV94c2tfYXN5bmNf
eG1pdCwNCiAjaWZkZWYgQ09ORklHX01MWDVfRU5fQVJGUw0KIAkubmRvX3J4X2Zsb3dfc3RlZXIJ
ID0gbWx4NWVfcnhfZmxvd19zdGVlciwNCiAjZW5kaWYNCkBAIC00NDg5LDExICs0NjY5LDEzIEBA
IHZvaWQgbWx4NWVfYnVpbGRfcnFfcGFyYW1zKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0K
IAkgKiAtIFN0cmlkaW5nIFJRIGNvbmZpZ3VyYXRpb24gaXMgbm90IHBvc3NpYmxlL3N1cHBvcnRl
ZC4NCiAJICogLSBTbG93IFBDSSBoZXVyaXN0aWMuDQogCSAqIC0gTGVnYWN5IFJRIHdvdWxkIHVz
ZSBsaW5lYXIgU0tCIHdoaWxlIFN0cmlkaW5nIFJRIHdvdWxkIHVzZSBub24tbGluZWFyLg0KKwkg
Kg0KKwkgKiBObyBYU0sgcGFyYW1zOiBjaGVja2luZyB0aGUgYXZhaWxhYmlsaXR5IG9mIHN0cmlk
aW5nIFJRIGluIGdlbmVyYWwuDQogCSAqLw0KIAlpZiAoIXNsb3dfcGNpX2hldXJpc3RpYyhtZGV2
KSAmJg0KIAkgICAgbWx4NWVfc3RyaWRpbmdfcnFfcG9zc2libGUobWRldiwgcGFyYW1zKSAmJg0K
LQkgICAgKG1seDVlX3J4X21wd3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zKSB8fA0KLQkg
ICAgICFtbHg1ZV9yeF9pc19saW5lYXJfc2tiKHBhcmFtcykpKQ0KKwkgICAgKG1seDVlX3J4X21w
d3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zLCBOVUxMKSB8fA0KKwkgICAgICFtbHg1ZV9y
eF9pc19saW5lYXJfc2tiKHBhcmFtcywgTlVMTCkpKQ0KIAkJTUxYNUVfU0VUX1BGTEFHKHBhcmFt
cywgTUxYNUVfUEZMQUdfUlhfU1RSSURJTkdfUlEsIHRydWUpOw0KIAltbHg1ZV9zZXRfcnFfdHlw
ZShtZGV2LCBwYXJhbXMpOw0KIAltbHg1ZV9pbml0X3JxX3R5cGVfcGFyYW1zKG1kZXYsIHBhcmFt
cyk7DQpAQCAtNDUxNSw2ICs0Njk3LDcgQEAgdm9pZCBtbHg1ZV9idWlsZF9yc3NfcGFyYW1zKHN0
cnVjdCBtbHg1ZV9yc3NfcGFyYW1zICpyc3NfcGFyYW1zLA0KIH0NCiANCiB2b2lkIG1seDVlX2J1
aWxkX25pY19wYXJhbXMoc3RydWN0IG1seDVfY29yZV9kZXYgKm1kZXYsDQorCQkJICAgIHN0cnVj
dCBtbHg1ZV94c2sgKnhzaywNCiAJCQkgICAgc3RydWN0IG1seDVlX3Jzc19wYXJhbXMgKnJzc19w
YXJhbXMsDQogCQkJICAgIHN0cnVjdCBtbHg1ZV9wYXJhbXMgKnBhcmFtcywNCiAJCQkgICAgdTE2
IG1heF9jaGFubmVscywgdTE2IG10dSkNCkBAIC00NTUwLDkgKzQ3MzMsMTEgQEAgdm9pZCBtbHg1
ZV9idWlsZF9uaWNfcGFyYW1zKHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0KIAkvKiBIVyBM
Uk8gKi8NCiANCiAJLyogVE9ETzogJiYgTUxYNV9DQVBfRVRIKG1kZXYsIGxyb19jYXApICovDQot
CWlmIChwYXJhbXMtPnJxX3dxX3R5cGUgPT0gTUxYNV9XUV9UWVBFX0xJTktFRF9MSVNUX1NUUklE
SU5HX1JRKQ0KLQkJaWYgKCFtbHg1ZV9yeF9tcHdxZV9pc19saW5lYXJfc2tiKG1kZXYsIHBhcmFt
cykpDQorCWlmIChwYXJhbXMtPnJxX3dxX3R5cGUgPT0gTUxYNV9XUV9UWVBFX0xJTktFRF9MSVNU
X1NUUklESU5HX1JRKSB7DQorCQkvKiBObyBYU0sgcGFyYW1zOiBjaGVja2luZyB0aGUgYXZhaWxh
YmlsaXR5IG9mIHN0cmlkaW5nIFJRIGluIGdlbmVyYWwuICovDQorCQlpZiAoIW1seDVlX3J4X21w
d3FlX2lzX2xpbmVhcl9za2IobWRldiwgcGFyYW1zLCBOVUxMKSkNCiAJCQlwYXJhbXMtPmxyb19l
biA9ICFzbG93X3BjaV9oZXVyaXN0aWMobWRldik7DQorCX0NCiAJcGFyYW1zLT5scm9fdGltZW91
dCA9IG1seDVlX2Nob29zZV9scm9fdGltZW91dChtZGV2LCBNTFg1RV9ERUZBVUxUX0xST19USU1F
T1VUKTsNCiANCiAJLyogQ1EgbW9kZXJhdGlvbiBwYXJhbXMgKi8NCkBAIC00NTcxLDYgKzQ3NTYs
OSBAQCB2b2lkIG1seDVlX2J1aWxkX25pY19wYXJhbXMoc3RydWN0IG1seDVfY29yZV9kZXYgKm1k
ZXYsDQogCW1seDVlX2J1aWxkX3Jzc19wYXJhbXMocnNzX3BhcmFtcywgcGFyYW1zLT5udW1fY2hh
bm5lbHMpOw0KIAlwYXJhbXMtPnR1bm5lbGVkX29mZmxvYWRfZW4gPQ0KIAkJbWx4NWVfdHVubmVs
X2lubmVyX2Z0X3N1cHBvcnRlZChtZGV2KTsNCisNCisJLyogQUZfWERQICovDQorCXBhcmFtcy0+
eHNrID0geHNrOw0KIH0NCiANCiBzdGF0aWMgdm9pZCBtbHg1ZV9zZXRfbmV0ZGV2X2Rldl9hZGRy
KHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYpDQpAQCAtNDczOSw3ICs0OTI3LDcgQEAgc3RhdGlj
IGludCBtbHg1ZV9uaWNfaW5pdChzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldiwNCiAJaWYgKGVy
cikNCiAJCXJldHVybiBlcnI7DQogDQotCW1seDVlX2J1aWxkX25pY19wYXJhbXMobWRldiwgcnNz
LCAmcHJpdi0+Y2hhbm5lbHMucGFyYW1zLA0KKwltbHg1ZV9idWlsZF9uaWNfcGFyYW1zKG1kZXYs
ICZwcml2LT54c2ssIHJzcywgJnByaXYtPmNoYW5uZWxzLnBhcmFtcywNCiAJCQkgICAgICAgbWx4
NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMobmV0ZGV2KSwNCiAJCQkgICAgICAgbmV0ZGV2LT5t
dHUpOw0KIA0KQEAgLTQ3ODEsNyArNDk2OSw3IEBAIHN0YXRpYyBpbnQgbWx4NWVfaW5pdF9uaWNf
cngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9jbG9z
ZV9kcm9wX3JxOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3JxdHMocHJpdik7DQor
CWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsN
CiAJaWYgKGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lfaW5kaXJlY3RfcnF0czsNCiANCkBAIC00
Nzg5LDE0ICs0OTc3LDIyIEBAIHN0YXRpYyBpbnQgbWx4NWVfaW5pdF9uaWNfcngoc3RydWN0IG1s
eDVlX3ByaXYgKnByaXYpDQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9kZXN0cm95X2RpcmVjdF9y
cXRzOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMocHJpdik7DQorCWVyciA9
IG1seDVlX2NyZWF0ZV9kaXJlY3RfdGlycyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiAJaWYg
KGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lfaW5kaXJlY3RfdGlyczsNCiANCisJZXJyID0gbWx4
NWVfY3JlYXRlX2RpcmVjdF9ycXRzKHByaXYsIHByaXYtPnhza190aXIpOw0KKwlpZiAodW5saWtl
bHkoZXJyKSkNCisJCWdvdG8gZXJyX2Rlc3Ryb3lfZGlyZWN0X3RpcnM7DQorDQorCWVyciA9IG1s
eDVlX2NyZWF0ZV9kaXJlY3RfdGlycyhwcml2LCBwcml2LT54c2tfdGlyKTsNCisJaWYgKHVubGlr
ZWx5KGVycikpDQorCQlnb3RvIGVycl9kZXN0cm95X3hza19ycXRzOw0KKw0KIAllcnIgPSBtbHg1
ZV9jcmVhdGVfZmxvd19zdGVlcmluZyhwcml2KTsNCiAJaWYgKGVycikgew0KIAkJbWx4NV9jb3Jl
X3dhcm4obWRldiwgImNyZWF0ZSBmbG93IHN0ZWVyaW5nIGZhaWxlZCwgJWRcbiIsIGVycik7DQot
CQlnb3RvIGVycl9kZXN0cm95X2RpcmVjdF90aXJzOw0KKwkJZ290byBlcnJfZGVzdHJveV94c2tf
dGlyczsNCiAJfQ0KIA0KIAllcnIgPSBtbHg1ZV90Y19uaWNfaW5pdChwcml2KTsNCkBAIC00ODA3
LDEyICs1MDAzLDE2IEBAIHN0YXRpYyBpbnQgbWx4NWVfaW5pdF9uaWNfcngoc3RydWN0IG1seDVl
X3ByaXYgKnByaXYpDQogDQogZXJyX2Rlc3Ryb3lfZmxvd19zdGVlcmluZzoNCiAJbWx4NWVfZGVz
dHJveV9mbG93X3N0ZWVyaW5nKHByaXYpOw0KK2Vycl9kZXN0cm95X3hza190aXJzOg0KKwltbHg1
ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYsIHByaXYtPnhza190aXIpOw0KK2Vycl9kZXN0cm95
X3hza19ycXRzOg0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYsIHByaXYtPnhza190
aXIpOw0KIGVycl9kZXN0cm95X2RpcmVjdF90aXJzOg0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF90
aXJzKHByaXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYsIHByaXYtPmRpcmVj
dF90aXIpOw0KIGVycl9kZXN0cm95X2luZGlyZWN0X3RpcnM6DQogCW1seDVlX2Rlc3Ryb3lfaW5k
aXJlY3RfdGlycyhwcml2LCB0cnVlKTsNCiBlcnJfZGVzdHJveV9kaXJlY3RfcnF0czoNCi0JbWx4
NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhwcml2KTsNCisJbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0
cyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiBlcnJfZGVzdHJveV9pbmRpcmVjdF9ycXRzOg0K
IAltbHg1ZV9kZXN0cm95X3JxdChwcml2LCAmcHJpdi0+aW5kaXJfcnF0KTsNCiBlcnJfY2xvc2Vf
ZHJvcF9ycToNCkBAIC00ODI2LDkgKzUwMjYsMTEgQEAgc3RhdGljIHZvaWQgbWx4NWVfY2xlYW51
cF9uaWNfcngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogew0KIAltbHg1ZV90Y19uaWNfY2xl
YW51cChwcml2KTsNCiAJbWx4NWVfZGVzdHJveV9mbG93X3N0ZWVyaW5nKHByaXYpOw0KLQltbHg1
ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJz
KHByaXYsIHByaXYtPnhza190aXIpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYs
IHByaXYtPnhza190aXIpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYsIHByaXYt
PmRpcmVjdF90aXIpOw0KIAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMocHJpdiwgdHJ1ZSk7
DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdik7DQorCW1seDVlX2Rlc3Ryb3lfZGly
ZWN0X3JxdHMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogCW1seDVlX2Rlc3Ryb3lfcnF0KHBy
aXYsICZwcml2LT5pbmRpcl9ycXQpOw0KIAltbHg1ZV9jbG9zZV9kcm9wX3JxKCZwcml2LT5kcm9w
X3JxKTsNCiAJbWx4NWVfZGVzdHJveV9xX2NvdW50ZXJzKHByaXYpOw0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuYyBiL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yZXAuYw0KaW5kZXggNTI4M2UxNmM2
OWU0Li43ZTI1NjNlZWFlNjMgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxs
YW5veC9tbHg1L2NvcmUvZW5fcmVwLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9lbl9yZXAuYw0KQEAgLTE1MjgsNyArMTUyOCw3IEBAIHN0YXRpYyBpbnQg
bWx4NWVfaW5pdF9yZXBfcngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCWlmIChlcnIpDQog
CQlnb3RvIGVycl9jbG9zZV9kcm9wX3JxOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0
X3JxdHMocHJpdik7DQorCWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhwcml2LCBwcml2
LT5kaXJlY3RfdGlyKTsNCiAJaWYgKGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lfaW5kaXJlY3Rf
cnF0czsNCiANCkBAIC0xNTM2LDcgKzE1MzYsNyBAQCBzdGF0aWMgaW50IG1seDVlX2luaXRfcmVw
X3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZGVz
dHJveV9kaXJlY3RfcnF0czsNCiANCi0JZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHBy
aXYpOw0KKwllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0
X3Rpcik7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl9kZXN0cm95X2luZGlyZWN0X3RpcnM7DQog
DQpAQCAtMTU1MywxMSArMTU1MywxMSBAQCBzdGF0aWMgaW50IG1seDVlX2luaXRfcmVwX3J4KHN0
cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIGVycl9kZXN0cm95X3R0Y190YWJsZToNCiAJbWx4NWVf
ZGVzdHJveV90dGNfdGFibGUocHJpdiwgJnByaXYtPmZzLnR0Yyk7DQogZXJyX2Rlc3Ryb3lfZGly
ZWN0X3RpcnM6DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3RpcnMocHJpdik7DQorCW1seDVlX2Rl
c3Ryb3lfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogZXJyX2Rlc3Ryb3lf
aW5kaXJlY3RfdGlyczoNCiAJbWx4NWVfZGVzdHJveV9pbmRpcmVjdF90aXJzKHByaXYsIGZhbHNl
KTsNCiBlcnJfZGVzdHJveV9kaXJlY3RfcnF0czoNCi0JbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0
cyhwcml2KTsNCisJbWx4NWVfZGVzdHJveV9kaXJlY3RfcnF0cyhwcml2LCBwcml2LT5kaXJlY3Rf
dGlyKTsNCiBlcnJfZGVzdHJveV9pbmRpcmVjdF9ycXRzOg0KIAltbHg1ZV9kZXN0cm95X3JxdChw
cml2LCAmcHJpdi0+aW5kaXJfcnF0KTsNCiBlcnJfY2xvc2VfZHJvcF9ycToNCkBAIC0xNTcxLDkg
KzE1NzEsOSBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9jbGVhbnVwX3JlcF9yeChzdHJ1Y3QgbWx4NWVf
cHJpdiAqcHJpdikNCiANCiAJbWx4NV9kZWxfZmxvd19ydWxlcyhycHJpdi0+dnBvcnRfcnhfcnVs
ZSk7DQogCW1seDVlX2Rlc3Ryb3lfdHRjX3RhYmxlKHByaXYsICZwcml2LT5mcy50dGMpOw0KLQlt
bHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90
aXJzKHByaXYsIHByaXYtPmRpcmVjdF90aXIpOw0KIAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3Rp
cnMocHJpdiwgZmFsc2UpOw0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYpOw0KKwlt
bHg1ZV9kZXN0cm95X2RpcmVjdF9ycXRzKHByaXYsIHByaXYtPmRpcmVjdF90aXIpOw0KIAltbHg1
ZV9kZXN0cm95X3JxdChwcml2LCAmcHJpdi0+aW5kaXJfcnF0KTsNCiAJbWx4NWVfY2xvc2VfZHJv
cF9ycSgmcHJpdi0+ZHJvcF9ycSk7DQogfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbl9yeC5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVs
bGFub3gvbWx4NS9jb3JlL2VuX3J4LmMNCmluZGV4IDVkNzYyZGE2YmY5Yi4uOWVlZGM2NzkzOTg0
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2Vu
X3J4LmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9y
eC5jDQpAQCAtNDYsNiArNDYsNyBAQA0KICNpbmNsdWRlICJlbl9hY2NlbC90bHNfcnh0eC5oIg0K
ICNpbmNsdWRlICJsaWIvY2xvY2suaCINCiAjaW5jbHVkZSAiZW4veGRwLmgiDQorI2luY2x1ZGUg
ImVuL3hzay9yeC5oIg0KIA0KIHN0YXRpYyBpbmxpbmUgYm9vbCBtbHg1ZV9yeF9od19zdGFtcChz
dHJ1Y3QgaHd0c3RhbXBfY29uZmlnICpjb25maWcpDQogew0KQEAgLTIzNCw4ICsyMzUsOCBAQCBz
dGF0aWMgaW5saW5lIGJvb2wgbWx4NWVfcnhfY2FjaGVfZ2V0KHN0cnVjdCBtbHg1ZV9ycSAqcnEs
DQogCXJldHVybiB0cnVlOw0KIH0NCiANCi1zdGF0aWMgaW5saW5lIGludCBtbHg1ZV9wYWdlX2Fs
bG9jX21hcHBlZChzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KLQkJCQkJICBzdHJ1Y3QgbWx4NWVfZG1h
X2luZm8gKmRtYV9pbmZvKQ0KK3N0YXRpYyBpbmxpbmUgaW50IG1seDVlX3BhZ2VfYWxsb2NfcG9v
bChzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQkJc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFf
aW5mbykNCiB7DQogCWlmIChtbHg1ZV9yeF9jYWNoZV9nZXQocnEsIGRtYV9pbmZvKSkNCiAJCXJl
dHVybiAwOw0KQEAgLTI1NSwxMyArMjU2LDIzIEBAIHN0YXRpYyBpbmxpbmUgaW50IG1seDVlX3Bh
Z2VfYWxsb2NfbWFwcGVkKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQogCXJldHVybiAwOw0KIH0NCiAN
CitzdGF0aWMgaW5saW5lIGludCBtbHg1ZV9wYWdlX2FsbG9jKHN0cnVjdCBtbHg1ZV9ycSAqcnEs
DQorCQkJCSAgIHN0cnVjdCBtbHg1ZV9kbWFfaW5mbyAqZG1hX2luZm8pDQorew0KKwlpZiAocnEt
PnVtZW0pDQorCQlyZXR1cm4gbWx4NWVfeHNrX3BhZ2VfYWxsb2NfdW1lbShycSwgZG1hX2luZm8p
Ow0KKwllbHNlDQorCQlyZXR1cm4gbWx4NWVfcGFnZV9hbGxvY19wb29sKHJxLCBkbWFfaW5mbyk7
DQorfQ0KKw0KIHZvaWQgbWx4NWVfcGFnZV9kbWFfdW5tYXAoc3RydWN0IG1seDVlX3JxICpycSwg
c3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbykNCiB7DQogCWRtYV91bm1hcF9wYWdlKHJx
LT5wZGV2LCBkbWFfaW5mby0+YWRkciwgUEFHRV9TSVpFLCBycS0+YnVmZi5tYXBfZGlyKTsNCiB9
DQogDQotdm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2Uoc3RydWN0IG1seDVlX3JxICpycSwgc3RydWN0
IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbywNCi0JCQlib29sIHJlY3ljbGUpDQordm9pZCBtbHg1
ZV9wYWdlX3JlbGVhc2VfZHluYW1pYyhzdHJ1Y3QgbWx4NWVfcnEgKnJxLA0KKwkJCQlzdHJ1Y3Qg
bWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0KKwkJCQlib29sIHJlY3ljbGUpDQogew0KIAlpZiAo
bGlrZWx5KHJlY3ljbGUpKSB7DQogCQlpZiAobWx4NWVfcnhfY2FjaGVfcHV0KHJxLCBkbWFfaW5m
bykpDQpAQCAtMjc1LDYgKzI4NiwyMCBAQCB2b2lkIG1seDVlX3BhZ2VfcmVsZWFzZShzdHJ1Y3Qg
bWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfZG1hX2luZm8gKmRtYV9pbmZvLA0KIAl9DQogfQ0K
IA0KK3N0YXRpYyBpbmxpbmUgdm9pZCBtbHg1ZV9wYWdlX3JlbGVhc2Uoc3RydWN0IG1seDVlX3Jx
ICpycSwNCisJCQkJICAgICAgc3RydWN0IG1seDVlX2RtYV9pbmZvICpkbWFfaW5mbywNCisJCQkJ
ICAgICAgYm9vbCByZWN5Y2xlKQ0KK3sNCisJaWYgKHJxLT51bWVtKQ0KKwkJLyogVGhlIGByZWN5
Y2xlYCBwYXJhbWV0ZXIgaXMgaWdub3JlZCwgYW5kIHRoZSBwYWdlIGlzIGFsd2F5cw0KKwkJICog
cHV0IGludG8gdGhlIFJldXNlIFJpbmcsIGJlY2F1c2UgdGhlcmUgaXMgbm8gd2F5IHRvIHJldHVy
bg0KKwkJICogdGhlIHBhZ2UgdG8gdGhlIHVzZXJzcGFjZSB3aGVuIHRoZSBpbnRlcmZhY2UgZ29l
cyBkb3duLg0KKwkJICovDQorCQltbHg1ZV94c2tfcGFnZV9yZWxlYXNlKHJxLCBkbWFfaW5mbyk7
DQorCWVsc2UNCisJCW1seDVlX3BhZ2VfcmVsZWFzZV9keW5hbWljKHJxLCBkbWFfaW5mbywgcmVj
eWNsZSk7DQorfQ0KKw0KIHN0YXRpYyBpbmxpbmUgaW50IG1seDVlX2dldF9yeF9mcmFnKHN0cnVj
dCBtbHg1ZV9ycSAqcnEsDQogCQkJCSAgICBzdHJ1Y3QgbWx4NWVfd3FlX2ZyYWdfaW5mbyAqZnJh
ZykNCiB7DQpAQCAtMjg2LDcgKzMxMSw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IG1seDVlX2dldF9y
eF9mcmFnKHN0cnVjdCBtbHg1ZV9ycSAqcnEsDQogCQkgKiBvZmZzZXQpIHNob3VsZCBqdXN0IHVz
ZSB0aGUgbmV3IG9uZSB3aXRob3V0IHJlcGxlbmlzaGluZyBhZ2Fpbg0KIAkJICogYnkgdGhlbXNl
bHZlcy4NCiAJCSAqLw0KLQkJZXJyID0gbWx4NWVfcGFnZV9hbGxvY19tYXBwZWQocnEsIGZyYWct
PmRpKTsNCisJCWVyciA9IG1seDVlX3BhZ2VfYWxsb2MocnEsIGZyYWctPmRpKTsNCiANCiAJcmV0
dXJuIGVycjsNCiB9DQpAQCAtMzUyLDYgKzM3NywxMyBAQCBzdGF0aWMgaW50IG1seDVlX2FsbG9j
X3J4X3dxZXMoc3RydWN0IG1seDVlX3JxICpycSwgdTE2IGl4LCB1OCB3cWVfYnVsaykNCiAJaW50
IGVycjsNCiAJaW50IGk7DQogDQorCWlmIChycS0+dW1lbSkgew0KKwkJaW50IHBhZ2VzX2Rlc2ly
ZWQgPSB3cWVfYnVsayA8PCBycS0+d3FlLmluZm8ubG9nX251bV9mcmFnczsNCisNCisJCWlmICh1
bmxpa2VseSghbWx4NWVfeHNrX3BhZ2VzX2Vub3VnaF91bWVtKHJxLCBwYWdlc19kZXNpcmVkKSkp
DQorCQkJcmV0dXJuIC1FTk9NRU07DQorCX0NCisNCiAJZm9yIChpID0gMDsgaSA8IHdxZV9idWxr
OyBpKyspIHsNCiAJCXN0cnVjdCBtbHg1ZV9yeF93cWVfY3ljICp3cWUgPSBtbHg1X3dxX2N5Y19n
ZXRfd3FlKHdxLCBpeCArIGkpOw0KIA0KQEAgLTM5OSwxMSArNDMxLDE3IEBAIG1seDVlX2NvcHlf
c2tiX2hlYWRlcihzdHJ1Y3QgZGV2aWNlICpwZGV2LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLA0KIHN0
YXRpYyB2b2lkDQogbWx4NWVfZnJlZV9yeF9tcHdxZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1
Y3QgbWx4NWVfbXB3X2luZm8gKndpLCBib29sIHJlY3ljbGUpDQogew0KLQljb25zdCBib29sIG5v
X3hkcF94bWl0ID0NCi0JCWJpdG1hcF9lbXB0eSh3aS0+eGRwX3htaXRfYml0bWFwLCBNTFg1X01Q
V1JRX1BBR0VTX1BFUl9XUUUpOw0KKwlib29sIG5vX3hkcF94bWl0Ow0KIAlzdHJ1Y3QgbWx4NWVf
ZG1hX2luZm8gKmRtYV9pbmZvID0gd2ktPnVtci5kbWFfaW5mbzsNCiAJaW50IGk7DQogDQorCS8q
IEEgY29tbW9uIGNhc2UgZm9yIEFGX1hEUC4gKi8NCisJaWYgKGJpdG1hcF9mdWxsKHdpLT54ZHBf
eG1pdF9iaXRtYXAsIE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSkpDQorCQlyZXR1cm47DQorDQor
CW5vX3hkcF94bWl0ID0gYml0bWFwX2VtcHR5KHdpLT54ZHBfeG1pdF9iaXRtYXAsDQorCQkJCSAg
IE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSk7DQorDQogCWZvciAoaSA9IDA7IGkgPCBNTFg1X01Q
V1JRX1BBR0VTX1BFUl9XUUU7IGkrKykNCiAJCWlmIChub194ZHBfeG1pdCB8fCAhdGVzdF9iaXQo
aSwgd2ktPnhkcF94bWl0X2JpdG1hcCkpDQogCQkJbWx4NWVfcGFnZV9yZWxlYXNlKHJxLCAmZG1h
X2luZm9baV0sIHJlY3ljbGUpOw0KQEAgLTQ1Miw2ICs0OTAsMTIgQEAgc3RhdGljIGludCBtbHg1
ZV9hbGxvY19yeF9tcHdxZShzdHJ1Y3QgbWx4NWVfcnEgKnJxLCB1MTYgaXgpDQogCWludCBlcnI7
DQogCWludCBpOw0KIA0KKwlpZiAocnEtPnVtZW0gJiYNCisJICAgIHVubGlrZWx5KCFtbHg1ZV94
c2tfcGFnZXNfZW5vdWdoX3VtZW0ocnEsIE1MWDVfTVBXUlFfUEFHRVNfUEVSX1dRRSkpKSB7DQor
CQllcnIgPSAtRU5PTUVNOw0KKwkJZ290byBlcnI7DQorCX0NCisNCiAJcGkgPSBtbHg1X3dxX2N5
Y19jdHIyaXgod3EsIHNxLT5wYyk7DQogCWNvbnRpZ193cWViYnNfcm9vbSA9IG1seDVfd3FfY3lj
X2dldF9jb250aWdfd3FlYmJzKHdxLCBwaSk7DQogCWlmICh1bmxpa2VseShjb250aWdfd3FlYmJz
X3Jvb20gPCBNTFg1RV9VTVJfV1FFQkJTKSkgew0KQEAgLTQ2Myw3ICs1MDcsNyBAQCBzdGF0aWMg
aW50IG1seDVlX2FsbG9jX3J4X21wd3FlKHN0cnVjdCBtbHg1ZV9ycSAqcnEsIHUxNiBpeCkNCiAJ
bWVtY3B5KHVtcl93cWUsICZycS0+bXB3cWUudW1yX3dxZSwgb2Zmc2V0b2Yoc3RydWN0IG1seDVl
X3Vtcl93cWUsIGlubGluZV9tdHRzKSk7DQogDQogCWZvciAoaSA9IDA7IGkgPCBNTFg1X01QV1JR
X1BBR0VTX1BFUl9XUUU7IGkrKywgZG1hX2luZm8rKykgew0KLQkJZXJyID0gbWx4NWVfcGFnZV9h
bGxvY19tYXBwZWQocnEsIGRtYV9pbmZvKTsNCisJCWVyciA9IG1seDVlX3BhZ2VfYWxsb2MocnEs
IGRtYV9pbmZvKTsNCiAJCWlmICh1bmxpa2VseShlcnIpKQ0KIAkJCWdvdG8gZXJyX3VubWFwOw0K
IAkJdW1yX3dxZS0+aW5saW5lX210dHNbaV0ucHRhZyA9IGNwdV90b19iZTY0KGRtYV9pbmZvLT5h
ZGRyIHwgTUxYNV9FTl9XUik7DQpAQCAtNDkwLDYgKzUzNCw4IEBAIHN0YXRpYyBpbnQgbWx4NWVf
YWxsb2NfcnhfbXB3cWUoc3RydWN0IG1seDVlX3JxICpycSwgdTE2IGl4KQ0KIAkJZG1hX2luZm8t
LTsNCiAJCW1seDVlX3BhZ2VfcmVsZWFzZShycSwgZG1hX2luZm8sIHRydWUpOw0KIAl9DQorDQor
ZXJyOg0KIAlycS0+c3RhdHMtPmJ1ZmZfYWxsb2NfZXJyKys7DQogDQogCXJldHVybiBlcnI7DQpA
QCAtNjAzLDYgKzY0OSw3IEBAIGJvb2wgbWx4NWVfcG9zdF9yeF9tcHdxZXMoc3RydWN0IG1seDVl
X3JxICpycSkNCiAJc3RydWN0IG1seDVlX2ljb3NxICpzcSA9ICZycS0+Y2hhbm5lbC0+aWNvc3E7
DQogCXN0cnVjdCBtbHg1X3dxX2xsICp3cSA9ICZycS0+bXB3cWUud3E7DQogCXU4ICB1bXJfY29t
cGxldGVkID0gcnEtPm1wd3FlLnVtcl9jb21wbGV0ZWQ7DQorCWludCBhbGxvY19lcnIgPSAwOw0K
IAl1OCAgbWlzc2luZywgaTsNCiAJdTE2IGhlYWQ7DQogDQpAQCAtNjI3LDcgKzY3NCw5IEBAIGJv
b2wgbWx4NWVfcG9zdF9yeF9tcHdxZXMoc3RydWN0IG1seDVlX3JxICpycSkNCiAJaGVhZCA9IHJx
LT5tcHdxZS5hY3R1YWxfd3FfaGVhZDsNCiAJaSA9IG1pc3Npbmc7DQogCWRvIHsNCi0JCWlmICh1
bmxpa2VseShtbHg1ZV9hbGxvY19yeF9tcHdxZShycSwgaGVhZCkpKQ0KKwkJYWxsb2NfZXJyID0g
bWx4NWVfYWxsb2NfcnhfbXB3cWUocnEsIGhlYWQpOw0KKw0KKwkJaWYgKHVubGlrZWx5KGFsbG9j
X2VycikpDQogCQkJYnJlYWs7DQogCQloZWFkID0gbWx4NV93cV9sbF9nZXRfd3FlX25leHRfaXgo
d3EsIGhlYWQpOw0KIAl9IHdoaWxlICgtLWkpOw0KQEAgLTY0MSw2ICs2OTAsMTIgQEAgYm9vbCBt
bHg1ZV9wb3N0X3J4X21wd3FlcyhzdHJ1Y3QgbWx4NWVfcnEgKnJxKQ0KIAlycS0+bXB3cWUudW1y
X2luX3Byb2dyZXNzICs9IHJxLT5tcHdxZS51bXJfbGFzdF9idWxrOw0KIAlycS0+bXB3cWUuYWN0
dWFsX3dxX2hlYWQgICA9IGhlYWQ7DQogDQorCS8qIElmIFhTSyBGaWxsIFJpbmcgZG9lc24ndCBo
YXZlIGVub3VnaCBmcmFtZXMsIGJ1c3kgcG9sbCBieQ0KKwkgKiByZXNjaGVkdWxpbmcgdGhlIE5B
UEkgcG9sbC4NCisJICovDQorCWlmICh1bmxpa2VseShhbGxvY19lcnIgPT0gLUVOT01FTSAmJiBy
cS0+dW1lbSkpDQorCQlyZXR1cm4gdHJ1ZTsNCisNCiAJcmV0dXJuIGZhbHNlOw0KIH0NCiANCkBA
IC0xMDA5LDcgKzEwNjQsNyBAQCBtbHg1ZV9za2JfZnJvbV9jcWVfbGluZWFyKHN0cnVjdCBtbHg1
ZV9ycSAqcnEsIHN0cnVjdCBtbHg1X2NxZTY0ICpjcWUsDQogCX0NCiANCiAJcmN1X3JlYWRfbG9j
aygpOw0KLQljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2YSwgJnJ4X2hlYWRy
b29tLCAmY3FlX2JjbnQpOw0KKwljb25zdW1lZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2
YSwgJnJ4X2hlYWRyb29tLCAmY3FlX2JjbnQsIGZhbHNlKTsNCiAJcmN1X3JlYWRfdW5sb2NrKCk7
DQogCWlmIChjb25zdW1lZCkNCiAJCXJldHVybiBOVUxMOyAvKiBwYWdlL3BhY2tldCB3YXMgY29u
c3VtZWQgYnkgWERQICovDQpAQCAtMTIyMyw3ICsxMjc4LDcgQEAgbWx4NWVfc2tiX2Zyb21fY3Fl
X21wd3JxX2xpbmVhcihzdHJ1Y3QgbWx4NWVfcnEgKnJxLCBzdHJ1Y3QgbWx4NWVfbXB3X2luZm8g
KndpLA0KIAlwcmVmZXRjaChkYXRhKTsNCiANCiAJcmN1X3JlYWRfbG9jaygpOw0KLQljb25zdW1l
ZCA9IG1seDVlX3hkcF9oYW5kbGUocnEsIGRpLCB2YSwgJnJ4X2hlYWRyb29tLCAmY3FlX2JjbnQz
Mik7DQorCWNvbnN1bWVkID0gbWx4NWVfeGRwX2hhbmRsZShycSwgZGksIHZhLCAmcnhfaGVhZHJv
b20sICZjcWVfYmNudDMyLCBmYWxzZSk7DQogCXJjdV9yZWFkX3VubG9jaygpOw0KIAlpZiAoY29u
c3VtZWQpIHsNCiAJCWlmIChfX3Rlc3RfYW5kX2NsZWFyX2JpdChNTFg1RV9SUV9GTEFHX1hEUF9Y
TUlULCBycS0+ZmxhZ3MpKQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxh
bm94L21seDUvY29yZS9lbl9zdGF0cy5jIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gv
bWx4NS9jb3JlL2VuX3N0YXRzLmMNCmluZGV4IDQ4M2QzMjFkMjE1MS4uNWY1NDBkYjQ3Y2M5IDEw
MDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0
YXRzLmMNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9z
dGF0cy5jDQpAQCAtMTA0LDcgKzEwNCwzMyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJf
ZGVzYyBzd19zdGF0c19kZXNjW10gPSB7DQogCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBt
bHg1ZV9zd19zdGF0cywgY2hfcG9sbCkgfSwNCiAJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0
IG1seDVlX3N3X3N0YXRzLCBjaF9hcm0pIH0sDQogCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVj
dCBtbHg1ZV9zd19zdGF0cywgY2hfYWZmX2NoYW5nZSkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NU
QVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCBjaF9mb3JjZV9pcnEpIH0sDQogCXsgTUxYNUVfREVD
TEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgY2hfZXFfcmVhcm0pIH0sDQorCXsgTUxY
NUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX3BhY2tldHMpIH0s
DQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2J5
dGVzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4
X3hza19jc3VtX2NvbXBsZXRlKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4
NWVfc3dfc3RhdHMsIHJ4X3hza19jc3VtX3VubmVjZXNzYXJ5KSB9LA0KKwl7IE1MWDVFX0RFQ0xB
UkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19jc3VtX3VubmVjZXNzYXJ5X2lu
bmVyKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4
X3hza19jc3VtX25vbmUpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9z
d19zdGF0cywgcnhfeHNrX2Vjbl9tYXJrKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1
Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19yZW1vdmVkX3ZsYW5fcGFja2V0cykgfSwNCisJeyBN
TFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCByeF94c2tfeGRwX2Ryb3Ap
IH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNr
X3hkcF9yZWRpcmVjdCkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3
X3N0YXRzLCByeF94c2tfd3FlX2VycikgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0
IG1seDVlX3N3X3N0YXRzLCByeF94c2tfbXB3cWVfZmlsbGVyX2NxZXMpIH0sDQorCXsgTUxYNUVf
REVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX21wd3FlX2ZpbGxlcl9z
dHJpZGVzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMs
IHJ4X3hza19vdmVyc2l6ZV9wa3RzX3N3X2Ryb3ApIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFU
KHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2J1ZmZfYWxsb2NfZXJyKSB9LA0KKwl7IE1M
WDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHJ4X3hza19jcWVfY29tcHJl
c3NfYmxrcykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3X3N0YXRz
LCByeF94c2tfY3FlX2NvbXByZXNzX3BrdHMpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0
cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2NvbmdzdF91bXIpIH0sDQorCXsgTUxYNUVfREVD
TEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19zdGF0cywgcnhfeHNrX2FyZnNfZXJyKSB9LA0KKwl7
IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHR4X3hza194bWl0KSB9
LA0KKwl7IE1MWDVFX0RFQ0xBUkVfU1RBVChzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMsIHR4X3hza19t
cHdxZSkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0IG1seDVlX3N3X3N0YXRzLCB0
eF94c2tfaW5sbncpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1ZV9zd19z
dGF0cywgdHhfeHNrX2Z1bGwpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9TVEFUKHN0cnVjdCBtbHg1
ZV9zd19zdGF0cywgdHhfeHNrX2VycikgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1NUQVQoc3RydWN0
IG1seDVlX3N3X3N0YXRzLCB0eF94c2tfY3FlcykgfSwNCiB9Ow0KIA0KICNkZWZpbmUgTlVNX1NX
X0NPVU5URVJTCQkJQVJSQVlfU0laRShzd19zdGF0c19kZXNjKQ0KQEAgLTE0NCw2ICsxNzAsOCBA
QCBzdGF0aWMgdm9pZCBtbHg1ZV9ncnBfc3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2KQ0KIAkJCSZwcml2LT5jaGFubmVsX3N0YXRzW2ldOw0KIAkJc3RydWN0IG1seDVlX3hk
cHNxX3N0YXRzICp4ZHBzcV9yZWRfc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+eGRwc3E7DQogCQlz
dHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMgKnhkcHNxX3N0YXRzID0gJmNoYW5uZWxfc3RhdHMtPnJx
X3hkcHNxOw0KKwkJc3RydWN0IG1seDVlX3hkcHNxX3N0YXRzICp4c2tzcV9zdGF0cyA9ICZjaGFu
bmVsX3N0YXRzLT54c2tzcTsNCisJCXN0cnVjdCBtbHg1ZV9ycV9zdGF0cyAqeHNrcnFfc3RhdHMg
PSAmY2hhbm5lbF9zdGF0cy0+eHNrcnE7DQogCQlzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMgKnJxX3N0
YXRzID0gJmNoYW5uZWxfc3RhdHMtPnJxOw0KIAkJc3RydWN0IG1seDVlX2NoX3N0YXRzICpjaF9z
dGF0cyA9ICZjaGFubmVsX3N0YXRzLT5jaDsNCiAJCWludCBqOw0KQEAgLTE4Niw2ICsyMTQsNyBA
QCBzdGF0aWMgdm9pZCBtbHg1ZV9ncnBfc3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2KQ0KIAkJcy0+Y2hfcG9sbCAgICAgICAgKz0gY2hfc3RhdHMtPnBvbGw7DQogCQlzLT5j
aF9hcm0gICAgICAgICArPSBjaF9zdGF0cy0+YXJtOw0KIAkJcy0+Y2hfYWZmX2NoYW5nZSAgKz0g
Y2hfc3RhdHMtPmFmZl9jaGFuZ2U7DQorCQlzLT5jaF9mb3JjZV9pcnEgICArPSBjaF9zdGF0cy0+
Zm9yY2VfaXJxOw0KIAkJcy0+Y2hfZXFfcmVhcm0gICAgKz0gY2hfc3RhdHMtPmVxX3JlYXJtOw0K
IAkJLyogeGRwIHJlZGlyZWN0ICovDQogCQlzLT50eF94ZHBfeG1pdCAgICArPSB4ZHBzcV9yZWRf
c3RhdHMtPnhtaXQ7DQpAQCAtMTk0LDYgKzIyMywzMiBAQCBzdGF0aWMgdm9pZCBtbHg1ZV9ncnBf
c3dfdXBkYXRlX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIAkJcy0+dHhfeGRwX2Z1
bGwgICAgKz0geGRwc3FfcmVkX3N0YXRzLT5mdWxsOw0KIAkJcy0+dHhfeGRwX2VyciAgICAgKz0g
eGRwc3FfcmVkX3N0YXRzLT5lcnI7DQogCQlzLT50eF94ZHBfY3FlcyAgICArPSB4ZHBzcV9yZWRf
c3RhdHMtPmNxZXM7DQorCQkvKiBBRl9YRFAgemVyby1jb3B5ICovDQorCQlzLT5yeF94c2tfcGFj
a2V0cyAgICAgICAgICAgICAgICArPSB4c2tycV9zdGF0cy0+cGFja2V0czsNCisJCXMtPnJ4X3hz
a19ieXRlcyAgICAgICAgICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5ieXRlczsNCisJCXMtPnJ4
X3hza19jc3VtX2NvbXBsZXRlICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5jc3VtX2NvbXBsZXRl
Ow0KKwkJcy0+cnhfeHNrX2NzdW1fdW5uZWNlc3NhcnkgICAgICAgKz0geHNrcnFfc3RhdHMtPmNz
dW1fdW5uZWNlc3Nhcnk7DQorCQlzLT5yeF94c2tfY3N1bV91bm5lY2Vzc2FyeV9pbm5lciArPSB4
c2tycV9zdGF0cy0+Y3N1bV91bm5lY2Vzc2FyeV9pbm5lcjsNCisJCXMtPnJ4X3hza19jc3VtX25v
bmUgICAgICAgICAgICAgICs9IHhza3JxX3N0YXRzLT5jc3VtX25vbmU7DQorCQlzLT5yeF94c2tf
ZWNuX21hcmsgICAgICAgICAgICAgICArPSB4c2tycV9zdGF0cy0+ZWNuX21hcms7DQorCQlzLT5y
eF94c2tfcmVtb3ZlZF92bGFuX3BhY2tldHMgICArPSB4c2tycV9zdGF0cy0+cmVtb3ZlZF92bGFu
X3BhY2tldHM7DQorCQlzLT5yeF94c2tfeGRwX2Ryb3AgICAgICAgICAgICAgICArPSB4c2tycV9z
dGF0cy0+eGRwX2Ryb3A7DQorCQlzLT5yeF94c2tfeGRwX3JlZGlyZWN0ICAgICAgICAgICArPSB4
c2tycV9zdGF0cy0+eGRwX3JlZGlyZWN0Ow0KKwkJcy0+cnhfeHNrX3dxZV9lcnIgICAgICAgICAg
ICAgICAgKz0geHNrcnFfc3RhdHMtPndxZV9lcnI7DQorCQlzLT5yeF94c2tfbXB3cWVfZmlsbGVy
X2NxZXMgICAgICArPSB4c2tycV9zdGF0cy0+bXB3cWVfZmlsbGVyX2NxZXM7DQorCQlzLT5yeF94
c2tfbXB3cWVfZmlsbGVyX3N0cmlkZXMgICArPSB4c2tycV9zdGF0cy0+bXB3cWVfZmlsbGVyX3N0
cmlkZXM7DQorCQlzLT5yeF94c2tfb3ZlcnNpemVfcGt0c19zd19kcm9wICArPSB4c2tycV9zdGF0
cy0+b3ZlcnNpemVfcGt0c19zd19kcm9wOw0KKwkJcy0+cnhfeHNrX2J1ZmZfYWxsb2NfZXJyICAg
ICAgICAgKz0geHNrcnFfc3RhdHMtPmJ1ZmZfYWxsb2NfZXJyOw0KKwkJcy0+cnhfeHNrX2NxZV9j
b21wcmVzc19ibGtzICAgICAgKz0geHNrcnFfc3RhdHMtPmNxZV9jb21wcmVzc19ibGtzOw0KKwkJ
cy0+cnhfeHNrX2NxZV9jb21wcmVzc19wa3RzICAgICAgKz0geHNrcnFfc3RhdHMtPmNxZV9jb21w
cmVzc19wa3RzOw0KKwkJcy0+cnhfeHNrX2NvbmdzdF91bXIgICAgICAgICAgICAgKz0geHNrcnFf
c3RhdHMtPmNvbmdzdF91bXI7DQorCQlzLT5yeF94c2tfYXJmc19lcnIgICAgICAgICAgICAgICAr
PSB4c2tycV9zdGF0cy0+YXJmc19lcnI7DQorCQlzLT50eF94c2tfeG1pdCAgICAgICAgICAgICAg
ICAgICArPSB4c2tzcV9zdGF0cy0+eG1pdDsNCisJCXMtPnR4X3hza19tcHdxZSAgICAgICAgICAg
ICAgICAgICs9IHhza3NxX3N0YXRzLT5tcHdxZTsNCisJCXMtPnR4X3hza19pbmxudyAgICAgICAg
ICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5pbmxudzsNCisJCXMtPnR4X3hza19mdWxsICAgICAg
ICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5mdWxsOw0KKwkJcy0+dHhfeHNrX2VyciAgICAg
ICAgICAgICAgICAgICAgKz0geHNrc3Ffc3RhdHMtPmVycjsNCisJCXMtPnR4X3hza19jcWVzICAg
ICAgICAgICAgICAgICAgICs9IHhza3NxX3N0YXRzLT5jcWVzOw0KIA0KIAkJZm9yIChqID0gMDsg
aiA8IHByaXYtPm1heF9vcGVuZWRfdGM7IGorKykgew0KIAkJCXN0cnVjdCBtbHg1ZV9zcV9zdGF0
cyAqc3Ffc3RhdHMgPSAmY2hhbm5lbF9zdGF0cy0+c3Fbal07DQpAQCAtMTI2NiwxMSArMTMyMSw0
MyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGVzYyB4ZHBzcV9zdGF0c19kZXNjW10g
PSB7DQogCXsgTUxYNUVfREVDTEFSRV9YRFBTUV9TVEFUKHN0cnVjdCBtbHg1ZV94ZHBzcV9zdGF0
cywgY3FlcykgfSwNCiB9Ow0KIA0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXNjIHhz
a3JxX3N0YXRzX2Rlc2NbXSA9IHsNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0
IG1seDVlX3JxX3N0YXRzLCBwYWNrZXRzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLUlFfU1RB
VChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGJ5dGVzKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNL
UlFfU1RBVChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGNzdW1fY29tcGxldGUpIH0sDQorCXsgTUxY
NUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgY3N1bV91bm5lY2Vz
c2FyeSkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0
YXRzLCBjc3VtX3VubmVjZXNzYXJ5X2lubmVyKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLUlFf
U1RBVChzdHJ1Y3QgbWx4NWVfcnFfc3RhdHMsIGNzdW1fbm9uZSkgfSwNCisJeyBNTFg1RV9ERUNM
QVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBlY25fbWFyaykgfSwNCisJeyBN
TFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCByZW1vdmVkX3Zs
YW5fcGFja2V0cykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVl
X3JxX3N0YXRzLCB4ZHBfZHJvcCkgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3Ry
dWN0IG1seDVlX3JxX3N0YXRzLCB4ZHBfcmVkaXJlY3QpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9Y
U0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgd3FlX2VycikgfSwNCisJeyBNTFg1RV9E
RUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBtcHdxZV9maWxsZXJfY3Fl
cykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRz
LCBtcHdxZV9maWxsZXJfc3RyaWRlcykgfSwNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQo
c3RydWN0IG1seDVlX3JxX3N0YXRzLCBvdmVyc2l6ZV9wa3RzX3N3X2Ryb3ApIH0sDQorCXsgTUxY
NUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgYnVmZl9hbGxvY19l
cnIpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0
cywgY3FlX2NvbXByZXNzX2Jsa3MpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9YU0tSUV9TVEFUKHN0
cnVjdCBtbHg1ZV9ycV9zdGF0cywgY3FlX2NvbXByZXNzX3BrdHMpIH0sDQorCXsgTUxYNUVfREVD
TEFSRV9YU0tSUV9TVEFUKHN0cnVjdCBtbHg1ZV9ycV9zdGF0cywgY29uZ3N0X3VtcikgfSwNCisJ
eyBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQoc3RydWN0IG1seDVlX3JxX3N0YXRzLCBhcmZzX2Vy
cikgfSwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXNjIHhza3NxX3N0
YXRzX2Rlc2NbXSA9IHsNCisJeyBNTFg1RV9ERUNMQVJFX1hTS1NRX1NUQVQoc3RydWN0IG1seDVl
X3hkcHNxX3N0YXRzLCB4bWl0KSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLU1FfU1RBVChzdHJ1
Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIG1wd3FlKSB9LA0KKwl7IE1MWDVFX0RFQ0xBUkVfWFNLU1Ff
U1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIGlubG53KSB9LA0KKwl7IE1MWDVFX0RFQ0xB
UkVfWFNLU1FfU1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIGZ1bGwpIH0sDQorCXsgTUxY
NUVfREVDTEFSRV9YU0tTUV9TVEFUKHN0cnVjdCBtbHg1ZV94ZHBzcV9zdGF0cywgZXJyKSB9LA0K
Kwl7IE1MWDVFX0RFQ0xBUkVfWFNLU1FfU1RBVChzdHJ1Y3QgbWx4NWVfeGRwc3Ffc3RhdHMsIGNx
ZXMpIH0sDQorfTsNCisNCiBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGVzYyBjaF9zdGF0
c19kZXNjW10gPSB7DQogCXsgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHN0cnVjdCBtbHg1ZV9jaF9z
dGF0cywgZXZlbnRzKSB9LA0KIAl7IE1MWDVFX0RFQ0xBUkVfQ0hfU1RBVChzdHJ1Y3QgbWx4NWVf
Y2hfc3RhdHMsIHBvbGwpIH0sDQogCXsgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHN0cnVjdCBtbHg1
ZV9jaF9zdGF0cywgYXJtKSB9LA0KIAl7IE1MWDVFX0RFQ0xBUkVfQ0hfU1RBVChzdHJ1Y3QgbWx4
NWVfY2hfc3RhdHMsIGFmZl9jaGFuZ2UpIH0sDQorCXsgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHN0
cnVjdCBtbHg1ZV9jaF9zdGF0cywgZm9yY2VfaXJxKSB9LA0KIAl7IE1MWDVFX0RFQ0xBUkVfQ0hf
U1RBVChzdHJ1Y3QgbWx4NWVfY2hfc3RhdHMsIGVxX3JlYXJtKSB9LA0KIH07DQogDQpAQCAtMTI3
OCw2ICsxMzY1LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2Rlc2MgY2hfc3RhdHNf
ZGVzY1tdID0gew0KICNkZWZpbmUgTlVNX1NRX1NUQVRTCQkJQVJSQVlfU0laRShzcV9zdGF0c19k
ZXNjKQ0KICNkZWZpbmUgTlVNX1hEUFNRX1NUQVRTCQkJQVJSQVlfU0laRSh4ZHBzcV9zdGF0c19k
ZXNjKQ0KICNkZWZpbmUgTlVNX1JRX1hEUFNRX1NUQVRTCQlBUlJBWV9TSVpFKHJxX3hkcHNxX3N0
YXRzX2Rlc2MpDQorI2RlZmluZSBOVU1fWFNLUlFfU1RBVFMJCQlBUlJBWV9TSVpFKHhza3JxX3N0
YXRzX2Rlc2MpDQorI2RlZmluZSBOVU1fWFNLU1FfU1RBVFMJCQlBUlJBWV9TSVpFKHhza3NxX3N0
YXRzX2Rlc2MpDQogI2RlZmluZSBOVU1fQ0hfU1RBVFMJCQlBUlJBWV9TSVpFKGNoX3N0YXRzX2Rl
c2MpDQogDQogc3RhdGljIGludCBtbHg1ZV9ncnBfY2hhbm5lbHNfZ2V0X251bV9zdGF0cyhzdHJ1
Y3QgbWx4NWVfcHJpdiAqcHJpdikNCkBAIC0xMjg4LDEzICsxMzc3LDE2IEBAIHN0YXRpYyBpbnQg
bWx4NWVfZ3JwX2NoYW5uZWxzX2dldF9udW1fc3RhdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYp
DQogCSAgICAgICAoTlVNX0NIX1NUQVRTICogbWF4X25jaCkgKw0KIAkgICAgICAgKE5VTV9TUV9T
VEFUUyAqIG1heF9uY2ggKiBwcml2LT5tYXhfb3BlbmVkX3RjKSArDQogCSAgICAgICAoTlVNX1JR
X1hEUFNRX1NUQVRTICogbWF4X25jaCkgKw0KLQkgICAgICAgKE5VTV9YRFBTUV9TVEFUUyAqIG1h
eF9uY2gpOw0KKwkgICAgICAgKE5VTV9YRFBTUV9TVEFUUyAqIG1heF9uY2gpICsNCisJICAgICAg
IChOVU1fWFNLUlFfU1RBVFMgKiBtYXhfbmNoICogcHJpdi0+eHNrLmV2ZXJfdXNlZCkgKw0KKwkg
ICAgICAgKE5VTV9YU0tTUV9TVEFUUyAqIG1heF9uY2ggKiBwcml2LT54c2suZXZlcl91c2VkKTsN
CiB9DQogDQogc3RhdGljIGludCBtbHg1ZV9ncnBfY2hhbm5lbHNfZmlsbF9zdHJpbmdzKHN0cnVj
dCBtbHg1ZV9wcml2ICpwcml2LCB1OCAqZGF0YSwNCiAJCQkJCSAgIGludCBpZHgpDQogew0KIAlp
bnQgbWF4X25jaCA9IG1seDVlX2dldF9uZXRkZXZfbWF4X2NoYW5uZWxzKHByaXYtPm5ldGRldik7
DQorCWJvb2wgaXNfeHNrID0gcHJpdi0+eHNrLmV2ZXJfdXNlZDsNCiAJaW50IGksIGosIHRjOw0K
IA0KIAlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKQ0KQEAgLTEzMDYsNiArMTM5OCw5IEBA
IHN0YXRpYyBpbnQgbWx4NWVfZ3JwX2NoYW5uZWxzX2ZpbGxfc3RyaW5ncyhzdHJ1Y3QgbWx4NWVf
cHJpdiAqcHJpdiwgdTggKmRhdGEsDQogCQlmb3IgKGogPSAwOyBqIDwgTlVNX1JRX1NUQVRTOyBq
KyspDQogCQkJc3ByaW50ZihkYXRhICsgKGlkeCsrKSAqIEVUSF9HU1RSSU5HX0xFTiwNCiAJCQkJ
cnFfc3RhdHNfZGVzY1tqXS5mb3JtYXQsIGkpOw0KKwkJZm9yIChqID0gMDsgaiA8IE5VTV9YU0tS
UV9TVEFUUyAqIGlzX3hzazsgaisrKQ0KKwkJCXNwcmludGYoZGF0YSArIChpZHgrKykgKiBFVEhf
R1NUUklOR19MRU4sDQorCQkJCXhza3JxX3N0YXRzX2Rlc2Nbal0uZm9ybWF0LCBpKTsNCiAJCWZv
ciAoaiA9IDA7IGogPCBOVU1fUlFfWERQU1FfU1RBVFM7IGorKykNCiAJCQlzcHJpbnRmKGRhdGEg
KyAoaWR4KyspICogRVRIX0dTVFJJTkdfTEVOLA0KIAkJCQlycV94ZHBzcV9zdGF0c19kZXNjW2pd
LmZvcm1hdCwgaSk7DQpAQCAtMTMxOCwxMCArMTQxMywxNCBAQCBzdGF0aWMgaW50IG1seDVlX2dy
cF9jaGFubmVsc19maWxsX3N0cmluZ3Moc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHU4ICpkYXRh
LA0KIAkJCQkJc3Ffc3RhdHNfZGVzY1tqXS5mb3JtYXQsDQogCQkJCQlwcml2LT5jaGFubmVsX3Rj
MnR4cVtpXVt0Y10pOw0KIA0KLQlmb3IgKGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKQ0KKwlmb3Ig
KGkgPSAwOyBpIDwgbWF4X25jaDsgaSsrKSB7DQorCQlmb3IgKGogPSAwOyBqIDwgTlVNX1hTS1NR
X1NUQVRTICogaXNfeHNrOyBqKyspDQorCQkJc3ByaW50ZihkYXRhICsgKGlkeCsrKSAqIEVUSF9H
U1RSSU5HX0xFTiwNCisJCQkJeHNrc3Ffc3RhdHNfZGVzY1tqXS5mb3JtYXQsIGkpOw0KIAkJZm9y
IChqID0gMDsgaiA8IE5VTV9YRFBTUV9TVEFUUzsgaisrKQ0KIAkJCXNwcmludGYoZGF0YSArIChp
ZHgrKykgKiBFVEhfR1NUUklOR19MRU4sDQogCQkJCXhkcHNxX3N0YXRzX2Rlc2Nbal0uZm9ybWF0
LCBpKTsNCisJfQ0KIA0KIAlyZXR1cm4gaWR4Ow0KIH0NCkBAIC0xMzMwLDYgKzE0MjksNyBAQCBz
dGF0aWMgaW50IG1seDVlX2dycF9jaGFubmVsc19maWxsX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2LCB1NjQgKmRhdGEsDQogCQkJCQkgaW50IGlkeCkNCiB7DQogCWludCBtYXhfbmNoID0g
bWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMocHJpdi0+bmV0ZGV2KTsNCisJYm9vbCBpc194
c2sgPSBwcml2LT54c2suZXZlcl91c2VkOw0KIAlpbnQgaSwgaiwgdGM7DQogDQogCWZvciAoaSA9
IDA7IGkgPCBtYXhfbmNoOyBpKyspDQpAQCAtMTM0Myw2ICsxNDQzLDEwIEBAIHN0YXRpYyBpbnQg
bWx4NWVfZ3JwX2NoYW5uZWxzX2ZpbGxfc3RhdHMoc3RydWN0IG1seDVlX3ByaXYgKnByaXYsIHU2
NCAqZGF0YSwNCiAJCQlkYXRhW2lkeCsrXSA9DQogCQkJCU1MWDVFX1JFQURfQ1RSNjRfQ1BVKCZw
cml2LT5jaGFubmVsX3N0YXRzW2ldLnJxLA0KIAkJCQkJCSAgICAgcnFfc3RhdHNfZGVzYywgaik7
DQorCQlmb3IgKGogPSAwOyBqIDwgTlVNX1hTS1JRX1NUQVRTICogaXNfeHNrOyBqKyspDQorCQkJ
ZGF0YVtpZHgrK10gPQ0KKwkJCQlNTFg1RV9SRUFEX0NUUjY0X0NQVSgmcHJpdi0+Y2hhbm5lbF9z
dGF0c1tpXS54c2tycSwNCisJCQkJCQkgICAgIHhza3JxX3N0YXRzX2Rlc2MsIGopOw0KIAkJZm9y
IChqID0gMDsgaiA8IE5VTV9SUV9YRFBTUV9TVEFUUzsgaisrKQ0KIAkJCWRhdGFbaWR4KytdID0N
CiAJCQkJTUxYNUVfUkVBRF9DVFI2NF9DUFUoJnByaXYtPmNoYW5uZWxfc3RhdHNbaV0ucnFfeGRw
c3EsDQpAQCAtMTM1NiwxMSArMTQ2MCwxNiBAQCBzdGF0aWMgaW50IG1seDVlX2dycF9jaGFubmVs
c19maWxsX3N0YXRzKHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2LCB1NjQgKmRhdGEsDQogCQkJCQlN
TFg1RV9SRUFEX0NUUjY0X0NQVSgmcHJpdi0+Y2hhbm5lbF9zdGF0c1tpXS5zcVt0Y10sDQogCQkJ
CQkJCSAgICAgc3Ffc3RhdHNfZGVzYywgaik7DQogDQotCWZvciAoaSA9IDA7IGkgPCBtYXhfbmNo
OyBpKyspDQorCWZvciAoaSA9IDA7IGkgPCBtYXhfbmNoOyBpKyspIHsNCisJCWZvciAoaiA9IDA7
IGogPCBOVU1fWFNLU1FfU1RBVFMgKiBpc194c2s7IGorKykNCisJCQlkYXRhW2lkeCsrXSA9DQor
CQkJCU1MWDVFX1JFQURfQ1RSNjRfQ1BVKCZwcml2LT5jaGFubmVsX3N0YXRzW2ldLnhza3NxLA0K
KwkJCQkJCSAgICAgeHNrc3Ffc3RhdHNfZGVzYywgaik7DQogCQlmb3IgKGogPSAwOyBqIDwgTlVN
X1hEUFNRX1NUQVRTOyBqKyspDQogCQkJZGF0YVtpZHgrK10gPQ0KIAkJCQlNTFg1RV9SRUFEX0NU
UjY0X0NQVSgmcHJpdi0+Y2hhbm5lbF9zdGF0c1tpXS54ZHBzcSwNCiAJCQkJCQkgICAgIHhkcHNx
X3N0YXRzX2Rlc2MsIGopOw0KKwl9DQogDQogCXJldHVybiBpZHg7DQogfQ0KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0cy5oIGIvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0YXRzLmgNCmluZGV4IGNk
ZGRjYzQ2OTcxYi4uZmIzYWQ3MjMxZTExIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVsbGFub3gvbWx4NS9jb3JlL2VuX3N0YXRzLmgNCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVy
bmV0L21lbGxhbm94L21seDUvY29yZS9lbl9zdGF0cy5oDQpAQCAtNDYsNiArNDYsOCBAQA0KICNk
ZWZpbmUgTUxYNUVfREVDTEFSRV9UWF9TVEFUKHR5cGUsIGZsZCkgInR4JWRfIiNmbGQsIG9mZnNl
dG9mKHR5cGUsIGZsZCkNCiAjZGVmaW5lIE1MWDVFX0RFQ0xBUkVfWERQU1FfU1RBVCh0eXBlLCBm
bGQpICJ0eCVkX3hkcF8iI2ZsZCwgb2Zmc2V0b2YodHlwZSwgZmxkKQ0KICNkZWZpbmUgTUxYNUVf
REVDTEFSRV9SUV9YRFBTUV9TVEFUKHR5cGUsIGZsZCkgInJ4JWRfeGRwX3R4XyIjZmxkLCBvZmZz
ZXRvZih0eXBlLCBmbGQpDQorI2RlZmluZSBNTFg1RV9ERUNMQVJFX1hTS1JRX1NUQVQodHlwZSwg
ZmxkKSAicnglZF94c2tfIiNmbGQsIG9mZnNldG9mKHR5cGUsIGZsZCkNCisjZGVmaW5lIE1MWDVF
X0RFQ0xBUkVfWFNLU1FfU1RBVCh0eXBlLCBmbGQpICJ0eCVkX3hza18iI2ZsZCwgb2Zmc2V0b2Yo
dHlwZSwgZmxkKQ0KICNkZWZpbmUgTUxYNUVfREVDTEFSRV9DSF9TVEFUKHR5cGUsIGZsZCkgImNo
JWRfIiNmbGQsIG9mZnNldG9mKHR5cGUsIGZsZCkNCiANCiBzdHJ1Y3QgY291bnRlcl9kZXNjIHsN
CkBAIC0xMTYsMTIgKzExOCwzOSBAQCBzdHJ1Y3QgbWx4NWVfc3dfc3RhdHMgew0KIAl1NjQgY2hf
cG9sbDsNCiAJdTY0IGNoX2FybTsNCiAJdTY0IGNoX2FmZl9jaGFuZ2U7DQorCXU2NCBjaF9mb3Jj
ZV9pcnE7DQogCXU2NCBjaF9lcV9yZWFybTsNCiANCiAjaWZkZWYgQ09ORklHX01MWDVfRU5fVExT
DQogCXU2NCB0eF90bHNfb29vOw0KIAl1NjQgdHhfdGxzX3Jlc3luY19ieXRlczsNCiAjZW5kaWYN
CisNCisJdTY0IHJ4X3hza19wYWNrZXRzOw0KKwl1NjQgcnhfeHNrX2J5dGVzOw0KKwl1NjQgcnhf
eHNrX2NzdW1fY29tcGxldGU7DQorCXU2NCByeF94c2tfY3N1bV91bm5lY2Vzc2FyeTsNCisJdTY0
IHJ4X3hza19jc3VtX3VubmVjZXNzYXJ5X2lubmVyOw0KKwl1NjQgcnhfeHNrX2NzdW1fbm9uZTsN
CisJdTY0IHJ4X3hza19lY25fbWFyazsNCisJdTY0IHJ4X3hza19yZW1vdmVkX3ZsYW5fcGFja2V0
czsNCisJdTY0IHJ4X3hza194ZHBfZHJvcDsNCisJdTY0IHJ4X3hza194ZHBfcmVkaXJlY3Q7DQor
CXU2NCByeF94c2tfd3FlX2VycjsNCisJdTY0IHJ4X3hza19tcHdxZV9maWxsZXJfY3FlczsNCisJ
dTY0IHJ4X3hza19tcHdxZV9maWxsZXJfc3RyaWRlczsNCisJdTY0IHJ4X3hza19vdmVyc2l6ZV9w
a3RzX3N3X2Ryb3A7DQorCXU2NCByeF94c2tfYnVmZl9hbGxvY19lcnI7DQorCXU2NCByeF94c2tf
Y3FlX2NvbXByZXNzX2Jsa3M7DQorCXU2NCByeF94c2tfY3FlX2NvbXByZXNzX3BrdHM7DQorCXU2
NCByeF94c2tfY29uZ3N0X3VtcjsNCisJdTY0IHJ4X3hza19hcmZzX2VycjsNCisJdTY0IHR4X3hz
a194bWl0Ow0KKwl1NjQgdHhfeHNrX21wd3FlOw0KKwl1NjQgdHhfeHNrX2lubG53Ow0KKwl1NjQg
dHhfeHNrX2Z1bGw7DQorCXU2NCB0eF94c2tfZXJyOw0KKwl1NjQgdHhfeHNrX2NxZXM7DQogfTsN
CiANCiBzdHJ1Y3QgbWx4NWVfcWNvdW50ZXJfc3RhdHMgew0KQEAgLTI1Niw2ICsyODUsNyBAQCBz
dHJ1Y3QgbWx4NWVfY2hfc3RhdHMgew0KIAl1NjQgcG9sbDsNCiAJdTY0IGFybTsNCiAJdTY0IGFm
Zl9jaGFuZ2U7DQorCXU2NCBmb3JjZV9pcnE7DQogCXU2NCBlcV9yZWFybTsNCiB9Ow0KIA0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4
LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvZW5fdHhyeC5jDQpp
bmRleCBkMmI4Y2U1ZGY1OWMuLjlhZTMyN2U4MGQ2ZCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4LmMNCisrKyBiL2RyaXZlcnMvbmV0
L2V0aGVybmV0L21lbGxhbm94L21seDUvY29yZS9lbl90eHJ4LmMNCkBAIC0zMyw2ICszMyw3IEBA
DQogI2luY2x1ZGUgPGxpbnV4L2lycS5oPg0KICNpbmNsdWRlICJlbi5oIg0KICNpbmNsdWRlICJl
bi94ZHAuaCINCisjaW5jbHVkZSAiZW4veHNrL3R4LmgiDQogDQogc3RhdGljIGlubGluZSBib29s
IG1seDVlX2NoYW5uZWxfbm9fYWZmaW5pdHlfY2hhbmdlKHN0cnVjdCBtbHg1ZV9jaGFubmVsICpj
KQ0KIHsNCkBAIC04Nyw3ICs4OCwxMiBAQCBpbnQgbWx4NWVfbmFwaV9wb2xsKHN0cnVjdCBuYXBp
X3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCkNCiAJc3RydWN0IG1seDVlX2NoYW5uZWwgKmMgPSBj
b250YWluZXJfb2YobmFwaSwgc3RydWN0IG1seDVlX2NoYW5uZWwsDQogCQkJCQkgICAgICAgbmFw
aSk7DQogCXN0cnVjdCBtbHg1ZV9jaF9zdGF0cyAqY2hfc3RhdHMgPSBjLT5zdGF0czsNCisJc3Ry
dWN0IG1seDVlX3hkcHNxICp4c2tzcSA9ICZjLT54c2tzcTsNCisJc3RydWN0IG1seDVlX3JxICp4
c2tycSA9ICZjLT54c2tycTsNCiAJc3RydWN0IG1seDVlX3JxICpycSA9ICZjLT5ycTsNCisJYm9v
bCB4c2tfb3BlbiA9IHRlc3RfYml0KE1MWDVFX0NIQU5ORUxfU1RBVEVfWFNLLCBjLT5zdGF0ZSk7
DQorCWJvb2wgYWZmX2NoYW5nZSA9IGZhbHNlOw0KKwlib29sIGJ1c3lfeHNrID0gZmFsc2U7DQog
CWJvb2wgYnVzeSA9IGZhbHNlOw0KIAlpbnQgd29ya19kb25lID0gMDsNCiAJaW50IGk7DQpAQCAt
MTAzLDE4ICsxMDksMzIgQEAgaW50IG1seDVlX25hcGlfcG9sbChzdHJ1Y3QgbmFwaV9zdHJ1Y3Qg
Km5hcGksIGludCBidWRnZXQpDQogCQlidXN5IHw9IG1seDVlX3BvbGxfeGRwc3FfY3EoJmMtPnJx
X3hkcHNxLmNxKTsNCiANCiAJaWYgKGxpa2VseShidWRnZXQpKSB7IC8qIGJ1ZGdldD0wIG1lYW5z
OiBkb24ndCBwb2xsIHJ4IHJpbmdzICovDQotCQl3b3JrX2RvbmUgPSBtbHg1ZV9wb2xsX3J4X2Nx
KCZycS0+Y3EsIGJ1ZGdldCk7DQorCQlpZiAoeHNrX29wZW4pDQorCQkJd29ya19kb25lID0gbWx4
NWVfcG9sbF9yeF9jcSgmeHNrcnEtPmNxLCBidWRnZXQpOw0KKw0KKwkJaWYgKGxpa2VseShidWRn
ZXQgLSB3b3JrX2RvbmUpKQ0KKwkJCXdvcmtfZG9uZSArPSBtbHg1ZV9wb2xsX3J4X2NxKCZycS0+
Y3EsIGJ1ZGdldCAtIHdvcmtfZG9uZSk7DQorDQogCQlidXN5IHw9IHdvcmtfZG9uZSA9PSBidWRn
ZXQ7DQogCX0NCiANCiAJbWx4NWVfcG9sbF9pY29fY3EoJmMtPmljb3NxLmNxKTsNCiANCiAJYnVz
eSB8PSBycS0+cG9zdF93cWVzKHJxKTsNCisJaWYgKHhza19vcGVuKSB7DQorCQltbHg1ZV9wb2xs
X2ljb19jcSgmYy0+eHNraWNvc3EuY3EpOw0KKwkJYnVzeSB8PSBtbHg1ZV9wb2xsX3hkcHNxX2Nx
KCZ4c2tzcS0+Y3EpOw0KKwkJYnVzeV94c2sgfD0gbWx4NWVfeHNrX3R4KHhza3NxLCBNTFg1RV9U
WF9YU0tfUE9MTF9CVURHRVQpOw0KKwkJYnVzeV94c2sgfD0geHNrcnEtPnBvc3Rfd3Flcyh4c2ty
cSk7DQorCX0NCisNCisJYnVzeSB8PSBidXN5X3hzazsNCiANCiAJaWYgKGJ1c3kpIHsNCiAJCWlm
IChsaWtlbHkobWx4NWVfY2hhbm5lbF9ub19hZmZpbml0eV9jaGFuZ2UoYykpKQ0KIAkJCXJldHVy
biBidWRnZXQ7DQogCQljaF9zdGF0cy0+YWZmX2NoYW5nZSsrOw0KKwkJYWZmX2NoYW5nZSA9IHRy
dWU7DQogCQlpZiAoYnVkZ2V0ICYmIHdvcmtfZG9uZSA9PSBidWRnZXQpDQogCQkJd29ya19kb25l
LS07DQogCX0NCkBAIC0xMzUsNiArMTU1LDE4IEBAIGludCBtbHg1ZV9uYXBpX3BvbGwoc3RydWN0
IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0KQ0KIAltbHg1ZV9jcV9hcm0oJmMtPmljb3Nx
LmNxKTsNCiAJbWx4NWVfY3FfYXJtKCZjLT54ZHBzcS5jcSk7DQogDQorCWlmICh4c2tfb3Blbikg
ew0KKwkJbWx4NWVfaGFuZGxlX3J4X2RpbSh4c2tycSk7DQorCQltbHg1ZV9jcV9hcm0oJmMtPnhz
a2ljb3NxLmNxKTsNCisJCW1seDVlX2NxX2FybSgmeHNrc3EtPmNxKTsNCisJCW1seDVlX2NxX2Fy
bSgmeHNrcnEtPmNxKTsNCisJfQ0KKw0KKwlpZiAodW5saWtlbHkoYWZmX2NoYW5nZSAmJiBidXN5
X3hzaykpIHsNCisJCW1seDVlX3RyaWdnZXJfaXJxKCZjLT5pY29zcSk7DQorCQljaF9zdGF0cy0+
Zm9yY2VfaXJxKys7DQorCX0NCisNCiAJcmV0dXJuIHdvcmtfZG9uZTsNCiB9DQogDQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2lwb2liL2lwb2li
LmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvaXBvaWIvaXBvaWIu
Yw0KaW5kZXggOWNhNDkyYjQzMGQ4Li5kYTgxYTVhN2I4ZTkgMTAwNjQ0DQotLS0gYS9kcml2ZXJz
L25ldC9ldGhlcm5ldC9tZWxsYW5veC9tbHg1L2NvcmUvaXBvaWIvaXBvaWIuYw0KKysrIGIvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVsbGFub3gvbWx4NS9jb3JlL2lwb2liL2lwb2liLmMNCkBAIC04
Nyw3ICs4Nyw3IEBAIGludCBtbHg1aV9pbml0KHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2LA0K
IAltbHg1ZV9zZXRfbmV0ZGV2X210dV9ib3VuZGFyaWVzKHByaXYpOw0KIAluZXRkZXYtPm10dSA9
IG5ldGRldi0+bWF4X210dTsNCiANCi0JbWx4NWVfYnVpbGRfbmljX3BhcmFtcyhtZGV2LCAmcHJp
di0+cnNzX3BhcmFtcywgJnByaXYtPmNoYW5uZWxzLnBhcmFtcywNCisJbWx4NWVfYnVpbGRfbmlj
X3BhcmFtcyhtZGV2LCBOVUxMLCAmcHJpdi0+cnNzX3BhcmFtcywgJnByaXYtPmNoYW5uZWxzLnBh
cmFtcywNCiAJCQkgICAgICAgbWx4NWVfZ2V0X25ldGRldl9tYXhfY2hhbm5lbHMobmV0ZGV2KSwN
CiAJCQkgICAgICAgbmV0ZGV2LT5tdHUpOw0KIAltbHg1aV9idWlsZF9uaWNfcGFyYW1zKG1kZXYs
ICZwcml2LT5jaGFubmVscy5wYXJhbXMpOw0KQEAgLTM2NSw3ICszNjUsNyBAQCBzdGF0aWMgaW50
IG1seDVpX2luaXRfcngoc3RydWN0IG1seDVlX3ByaXYgKnByaXYpDQogCWlmIChlcnIpDQogCQln
b3RvIGVycl9jbG9zZV9kcm9wX3JxOw0KIA0KLQllcnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3Jx
dHMocHJpdik7DQorCWVyciA9IG1seDVlX2NyZWF0ZV9kaXJlY3RfcnF0cyhwcml2LCBwcml2LT5k
aXJlY3RfdGlyKTsNCiAJaWYgKGVycikNCiAJCWdvdG8gZXJyX2Rlc3Ryb3lfaW5kaXJlY3RfcnF0
czsNCiANCkBAIC0zNzMsNyArMzczLDcgQEAgc3RhdGljIGludCBtbHg1aV9pbml0X3J4KHN0cnVj
dCBtbHg1ZV9wcml2ICpwcml2KQ0KIAlpZiAoZXJyKQ0KIAkJZ290byBlcnJfZGVzdHJveV9kaXJl
Y3RfcnF0czsNCiANCi0JZXJyID0gbWx4NWVfY3JlYXRlX2RpcmVjdF90aXJzKHByaXYpOw0KKwll
cnIgPSBtbHg1ZV9jcmVhdGVfZGlyZWN0X3RpcnMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQog
CWlmIChlcnIpDQogCQlnb3RvIGVycl9kZXN0cm95X2luZGlyZWN0X3RpcnM7DQogDQpAQCAtMzg0
LDExICszODQsMTEgQEAgc3RhdGljIGludCBtbHg1aV9pbml0X3J4KHN0cnVjdCBtbHg1ZV9wcml2
ICpwcml2KQ0KIAlyZXR1cm4gMDsNCiANCiBlcnJfZGVzdHJveV9kaXJlY3RfdGlyczoNCi0JbWx4
NWVfZGVzdHJveV9kaXJlY3RfdGlycyhwcml2KTsNCisJbWx4NWVfZGVzdHJveV9kaXJlY3RfdGly
cyhwcml2LCBwcml2LT5kaXJlY3RfdGlyKTsNCiBlcnJfZGVzdHJveV9pbmRpcmVjdF90aXJzOg0K
IAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMocHJpdiwgdHJ1ZSk7DQogZXJyX2Rlc3Ryb3lf
ZGlyZWN0X3JxdHM6DQotCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdik7DQorCW1seDVl
X2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJpdiwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogZXJyX2Rlc3Ry
b3lfaW5kaXJlY3RfcnF0czoNCiAJbWx4NWVfZGVzdHJveV9ycXQocHJpdiwgJnByaXYtPmluZGly
X3JxdCk7DQogZXJyX2Nsb3NlX2Ryb3BfcnE6DQpAQCAtNDAxLDkgKzQwMSw5IEBAIHN0YXRpYyBp
bnQgbWx4NWlfaW5pdF9yeChzdHJ1Y3QgbWx4NWVfcHJpdiAqcHJpdikNCiBzdGF0aWMgdm9pZCBt
bHg1aV9jbGVhbnVwX3J4KHN0cnVjdCBtbHg1ZV9wcml2ICpwcml2KQ0KIHsNCiAJbWx4NWlfZGVz
dHJveV9mbG93X3N0ZWVyaW5nKHByaXYpOw0KLQltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHBy
aXYpOw0KKwltbHg1ZV9kZXN0cm95X2RpcmVjdF90aXJzKHByaXYsIHByaXYtPmRpcmVjdF90aXIp
Ow0KIAltbHg1ZV9kZXN0cm95X2luZGlyZWN0X3RpcnMocHJpdiwgdHJ1ZSk7DQotCW1seDVlX2Rl
c3Ryb3lfZGlyZWN0X3JxdHMocHJpdik7DQorCW1seDVlX2Rlc3Ryb3lfZGlyZWN0X3JxdHMocHJp
diwgcHJpdi0+ZGlyZWN0X3Rpcik7DQogCW1seDVlX2Rlc3Ryb3lfcnF0KHByaXYsICZwcml2LT5p
bmRpcl9ycXQpOw0KIAltbHg1ZV9jbG9zZV9kcm9wX3JxKCZwcml2LT5kcm9wX3JxKTsNCiAJbWx4
NWVfZGVzdHJveV9xX2NvdW50ZXJzKHByaXYpOw0KLS0gDQoyLjE5LjENCg0K
